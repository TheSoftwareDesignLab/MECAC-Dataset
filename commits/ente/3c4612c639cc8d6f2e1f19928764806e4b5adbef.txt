update UI progress logic and add error handling