RTL support

Closes #4916
Fixes #4714