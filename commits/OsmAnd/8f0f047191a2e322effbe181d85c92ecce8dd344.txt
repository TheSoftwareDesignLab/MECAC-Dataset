Code & UI refactoring and improvements