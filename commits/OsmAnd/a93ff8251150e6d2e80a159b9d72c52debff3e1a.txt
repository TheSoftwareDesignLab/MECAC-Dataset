Fix widget IDs and use widget type instead where possible