Final fix #1887 and fix #1804. With saving scroll position.