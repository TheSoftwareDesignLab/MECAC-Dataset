More work on custom theme