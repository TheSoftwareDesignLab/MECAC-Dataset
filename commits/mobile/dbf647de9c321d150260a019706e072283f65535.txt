More wip: analysis and explorer widget refactoring