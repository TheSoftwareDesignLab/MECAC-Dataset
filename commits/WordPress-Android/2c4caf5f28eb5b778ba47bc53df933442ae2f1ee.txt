Emit to migration flow when prefs are migrated and refresh app theme

This enables the migration to apply the theme preference, which can
otherwise be inconsistent when the migration is attempted more than once
(i.e. after an interruption).