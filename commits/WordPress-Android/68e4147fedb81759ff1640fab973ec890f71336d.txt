Implement local migration states

This provides for a single mutable state flow to be consumed by the UI,
encapsulating the possible states of the data migration.