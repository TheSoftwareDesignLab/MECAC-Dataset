Refactor: group logic for error with retry UI