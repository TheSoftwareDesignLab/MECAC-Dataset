refactor use case for better readability and smaller methods