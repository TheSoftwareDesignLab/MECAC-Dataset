Changing algorithm and splitting out to its own method to test scaling