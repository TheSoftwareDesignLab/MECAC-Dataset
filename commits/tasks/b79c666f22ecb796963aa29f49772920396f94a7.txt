Cleaned up  / consolidated fragment logic, implemented three-pane layout