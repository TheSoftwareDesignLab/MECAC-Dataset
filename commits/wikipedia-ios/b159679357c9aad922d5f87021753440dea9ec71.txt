better fix for popover layout logic