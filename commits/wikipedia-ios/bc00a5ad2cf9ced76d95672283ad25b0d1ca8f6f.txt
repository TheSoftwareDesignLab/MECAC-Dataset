Fix RTL and last character cursor selection state bugs