Fix popover theme warnings by rewriting to Swift