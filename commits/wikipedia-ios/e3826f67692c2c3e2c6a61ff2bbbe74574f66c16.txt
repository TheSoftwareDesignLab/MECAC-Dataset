fix preferred layout attribute calculation