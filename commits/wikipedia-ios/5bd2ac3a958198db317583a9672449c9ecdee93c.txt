make tap method more robust