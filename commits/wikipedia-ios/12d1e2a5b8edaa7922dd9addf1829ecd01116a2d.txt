Core data performance improvements. Bug T99260

Separate core data fetches into batches.
Reset context in-between fetches to reduce memory.
Move to async operations to allow UI to update progress during saves.

Change-Id: Iffdb31166dacde1caef5d89f2050f11b404a85c7