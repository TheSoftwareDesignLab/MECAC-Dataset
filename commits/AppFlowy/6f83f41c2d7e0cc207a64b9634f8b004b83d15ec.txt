refactor: use dependency injection to adapt the theme on mobile. (#3957)