basic widget functionality + misc cleanup