group: Maintain user-group membership on events

Fixes #1687.

We'll add tests for this after an upcoming commit provides a way of
accessing group membership that's more relevant for the app's needs.
That way we can write the tests to that interface.