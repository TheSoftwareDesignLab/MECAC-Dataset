Make the widget type calculation generic