Handle progress in UI thread