Make `DebugLogUploader` stateless and use promises

Now that its users are all in Swift, we can make it stateless. We can
also use promises for its interface.