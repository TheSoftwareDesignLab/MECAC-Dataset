Sender key decryption failure handling

Most of the work for message resend requests. Includes some rudimentary
failure UI.