New registration: show (most of) remaining UI on PIN screen

All user-visible changes are on the "existing PIN" operation, but the
other two operations needed some refactors.