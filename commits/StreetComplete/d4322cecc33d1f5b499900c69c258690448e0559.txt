Code review + improved thread handling in UI code