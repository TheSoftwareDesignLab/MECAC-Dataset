sort code into collapsible regions, fix #2161

don't complete close/open bottom sheet when selecting a new quest while the sheet for the old quest is open because the animation seems to have a problem with that