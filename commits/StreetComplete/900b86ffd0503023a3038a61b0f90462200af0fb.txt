Clean up LastPickedValueStore interface, part 2

Make "smart" sorting of recently-picked elements work on any sequence.
It's more flexible now, and has a simpler type signature.