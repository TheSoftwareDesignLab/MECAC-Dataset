various fixes for right-to-left layout direction (Arabic, Persian,...) (fixes #3181)