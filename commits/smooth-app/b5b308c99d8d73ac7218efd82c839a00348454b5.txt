fix: `ThemeProvider` properly resync the theme (#5363)

* Fix theme internals

* Also fix the animation