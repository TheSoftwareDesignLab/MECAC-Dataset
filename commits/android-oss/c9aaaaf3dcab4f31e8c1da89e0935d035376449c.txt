wip, functional with UI weirdness