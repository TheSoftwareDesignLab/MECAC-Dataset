fix: Create destination directory before renaming files

Ensure the parent directory of the destination file exists before attempting to rename a file. This prevents potential rename failures if the target directory does not yet exist.