diff --git a/app/build.gradle b/app/build.gradle
index 2f7e6fb7c45..7815ca2ef07 100644
--- a/app/build.gradle
+++ b/app/build.gradle
@@ -82,7 +82,7 @@ dependencies {
     implementation project(':common')
     implementation project(':domain')
 
-    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
     implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutinesVersion"
     implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:$coroutinesVersion"
 
diff --git a/app/src/main/java/io/homeassistant/companion/android/HomeAssistantApplication.kt b/app/src/main/java/io/homeassistant/companion/android/HomeAssistantApplication.kt
index bee708bac09..259cb7f5272 100644
--- a/app/src/main/java/io/homeassistant/companion/android/HomeAssistantApplication.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/HomeAssistantApplication.kt
@@ -23,8 +23,4 @@ class HomeAssistantApplication : Application(), GraphComponentAccessor {
 
     override val appComponent: AppComponent
         get() = graph.appComponent
-
-    override fun urlUpdated() {
-        graph.urlUpdated()
-    }
 }
diff --git a/app/src/main/java/io/homeassistant/companion/android/onboarding/discovery/DiscoveryFragment.kt b/app/src/main/java/io/homeassistant/companion/android/onboarding/discovery/DiscoveryFragment.kt
index 7c742e3d8c6..314453003d7 100644
--- a/app/src/main/java/io/homeassistant/companion/android/onboarding/discovery/DiscoveryFragment.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/onboarding/discovery/DiscoveryFragment.kt
@@ -100,7 +100,6 @@ class DiscoveryFragment : Fragment(), DiscoveryView {
     }
 
     override fun onUrlSaved() {
-        (activity?.application as GraphComponentAccessor).urlUpdated()
         (activity as DiscoveryListener).onHomeAssistantDiscover()
     }
 
diff --git a/app/src/main/java/io/homeassistant/companion/android/onboarding/manual/ManualSetupFragment.kt b/app/src/main/java/io/homeassistant/companion/android/onboarding/manual/ManualSetupFragment.kt
index 2b05160f444..4401f44e61a 100644
--- a/app/src/main/java/io/homeassistant/companion/android/onboarding/manual/ManualSetupFragment.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/onboarding/manual/ManualSetupFragment.kt
@@ -62,7 +62,6 @@ class ManualSetupFragment : Fragment(), ManualSetupView {
     }
 
     override fun urlSaved() {
-        (activity?.application as GraphComponentAccessor).urlUpdated()
         (activity as ManualSetupListener).onSelectUrl()
     }
 
diff --git a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsFragment.kt b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsFragment.kt
index 4b6db0d4cd7..1ac778d184a 100644
--- a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsFragment.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsFragment.kt
@@ -64,10 +64,6 @@ class SettingsFragment : PreferenceFragmentCompat(), SettingsView {
         PermissionManager.restartLocationTracking(context!!, activity!!)
     }
 
-    override fun onUrlChanged() {
-        (activity?.application as GraphComponentAccessor).urlUpdated()
-    }
-
     override fun disableInternalConnection() {
         findPreference<EditTextPreference>("connection_internal")?.let {
             it.isEnabled = false
diff --git a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsPresenterImpl.kt b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsPresenterImpl.kt
index 3e17b8a5d56..99c6698b8ae 100644
--- a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsPresenterImpl.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsPresenterImpl.kt
@@ -57,7 +57,6 @@ class SettingsPresenterImpl @Inject constructor(
             when (key) {
                 "connection_internal" -> {
                     urlUseCase.saveUrl(value ?: "", true)
-                    settingsView.onUrlChanged()
                 }
                 "connection_internal_wifi" -> {
                     urlUseCase.saveHomeWifiSsid(value)
@@ -65,7 +64,6 @@ class SettingsPresenterImpl @Inject constructor(
                 }
                 "connection_external" -> {
                     urlUseCase.saveUrl(value ?: "", false)
-                    settingsView.onUrlChanged()
                 }
                 "registration_name" -> integrationUseCase.updateRegistration(deviceName = value!!)
                 else -> throw Exception()
@@ -91,7 +89,6 @@ class SettingsPresenterImpl @Inject constructor(
         if (ssid.isNullOrBlank()) {
             settingsView.disableInternalConnection()
             urlUseCase.saveUrl("", true)
-            settingsView.onUrlChanged()
         } else {
             settingsView.enableInternalConnection()
         }
diff --git a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsView.kt b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsView.kt
index 127d9950356..0a4abdd139c 100644
--- a/app/src/main/java/io/homeassistant/companion/android/settings/SettingsView.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/settings/SettingsView.kt
@@ -3,8 +3,6 @@ package io.homeassistant.companion.android.settings
 interface SettingsView {
     fun onLocationSettingChanged()
 
-    fun onUrlChanged()
-
     fun disableInternalConnection()
 
     fun enableInternalConnection()
diff --git a/app/src/main/java/io/homeassistant/companion/android/webview/WebViewActivity.kt b/app/src/main/java/io/homeassistant/companion/android/webview/WebViewActivity.kt
index 3f15814c8c9..41dfd573276 100644
--- a/app/src/main/java/io/homeassistant/companion/android/webview/WebViewActivity.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/webview/WebViewActivity.kt
@@ -226,8 +226,13 @@ class WebViewActivity : AppCompatActivity(), io.homeassistant.companion.android.
                 }
             }, "externalApp")
         }
+    }
 
-        presenter.onViewReady()
+    override fun onWindowFocusChanged(hasFocus: Boolean) {
+        super.onWindowFocusChanged(hasFocus)
+        if (hasFocus) {
+            presenter.onViewReady()
+        }
     }
 
     override fun attachBaseContext(newBase: Context) {
diff --git a/app/src/main/java/io/homeassistant/companion/android/webview/WebViewPresenterImpl.kt b/app/src/main/java/io/homeassistant/companion/android/webview/WebViewPresenterImpl.kt
index 76ea0377737..f134e26dd17 100644
--- a/app/src/main/java/io/homeassistant/companion/android/webview/WebViewPresenterImpl.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/webview/WebViewPresenterImpl.kt
@@ -7,6 +7,7 @@ import io.homeassistant.companion.android.domain.authentication.AuthenticationUs
 import io.homeassistant.companion.android.domain.authentication.SessionState
 import io.homeassistant.companion.android.domain.integration.IntegrationUseCase
 import io.homeassistant.companion.android.domain.url.UrlUseCase
+import java.net.URL
 import javax.inject.Inject
 import kotlinx.coroutines.CoroutineScope
 import kotlinx.coroutines.Dispatchers
@@ -27,17 +28,28 @@ class WebViewPresenterImpl @Inject constructor(
 
     private val mainScope: CoroutineScope = CoroutineScope(Dispatchers.Main + Job())
 
+    private var url: URL? = null
+
     override fun onViewReady() {
         mainScope.launch {
-            val url = urlUseCase.getUrl()
+            val oldUrl = url
+            url = urlUseCase.getUrl()
 
-            view.loadUrl(
-                Uri.parse(url.toString())
-                    .buildUpon()
-                    .appendQueryParameter("external_auth", "1")
-                    .build()
-                    .toString()
-            )
+            /*
+            We only want to cause the UI to reload if the URL that we need to load has changed.  An
+            example of this would be opening the app on wifi with a local url then loosing wifi
+            signal and reopening app.  Without this we would still be trying to use the internal
+            url externally.
+             */
+            if (oldUrl != url) {
+                view.loadUrl(
+                    Uri.parse(url.toString())
+                        .buildUpon()
+                        .appendQueryParameter("external_auth", "1")
+                        .build()
+                        .toString()
+                )
+            }
 
             try {
                 view.setStatusBarColor(Color.parseColor(integrationUseCase.getThemeColor()))
diff --git a/build.gradle b/build.gradle
index c76b1535478..b0a1ac8f1db 100644
--- a/build.gradle
+++ b/build.gradle
@@ -1,7 +1,7 @@
 apply from: "gradle/dependencies.gradle"
 
 buildscript {
-    ext.kotlin_version = '1.3.60'
+    ext.kotlin_version = '1.3.61'
     repositories {
         google()
         jcenter()
@@ -26,6 +26,12 @@ allprojects {
         maven { url 'https://maven.lokalise.co' }
     }
     apply plugin: "org.jlleitschuh.gradle.ktlint"
+
+    tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).configureEach {
+        kotlinOptions {
+            jvmTarget = "1.8"
+        }
+    }
 }
 
 task clean(type: Delete, group: 'build') {
diff --git a/common/build.gradle b/common/build.gradle
index 8c94b87e00e..2b394e015b5 100644
--- a/common/build.gradle
+++ b/common/build.gradle
@@ -15,7 +15,7 @@ dependencies {
     implementation project(':domain')
     implementation project(':data')
 
-    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
     implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutinesVersion"
 
     implementation "com.google.dagger:dagger:${daggerVersion}"
diff --git a/common/src/main/java/io/homeassistant/companion/android/common/dagger/DataModule.kt b/common/src/main/java/io/homeassistant/companion/android/common/dagger/DataModule.kt
index c442d64ba79..07b51d56ba5 100644
--- a/common/src/main/java/io/homeassistant/companion/android/common/dagger/DataModule.kt
+++ b/common/src/main/java/io/homeassistant/companion/android/common/dagger/DataModule.kt
@@ -19,7 +19,6 @@ import javax.inject.Named
 
 @Module(includes = [DataModule.Declaration::class])
 class DataModule(
-    private val url: String,
     private val urlStorage: LocalStorage,
     private val sessionLocalStorage: LocalStorage,
     private val integrationLocalStorage: LocalStorage,
@@ -27,9 +26,6 @@ class DataModule(
     private val deviceId: String
 ) {
 
-    @Provides
-    fun provideEndPoint() = url
-
     @Provides
     fun provideAuthenticationService(homeAssistantRetrofit: HomeAssistantRetrofit): AuthenticationService =
         homeAssistantRetrofit.retrofit.create(AuthenticationService::class.java)
diff --git a/common/src/main/java/io/homeassistant/companion/android/common/dagger/Graph.kt b/common/src/main/java/io/homeassistant/companion/android/common/dagger/Graph.kt
index 730356a0b08..6b77be43cf4 100644
--- a/common/src/main/java/io/homeassistant/companion/android/common/dagger/Graph.kt
+++ b/common/src/main/java/io/homeassistant/companion/android/common/dagger/Graph.kt
@@ -8,7 +8,6 @@ import android.provider.Settings
 import io.homeassistant.companion.android.common.LocalStorageImpl
 import io.homeassistant.companion.android.common.migrations.Migrations
 import io.homeassistant.companion.android.common.wifi.WifiHelperImpl
-import kotlinx.coroutines.runBlocking
 
 class Graph(
     private val application: Application,
@@ -18,23 +17,12 @@ class Graph(
     lateinit var appComponent: AppComponent
     private lateinit var dataComponent: DataComponent
     private lateinit var domainComponent: DomainComponent
-    private var url = "http://localhost/"
 
     init {
         Migrations(application)
             .migrate()
 
         buildComponent()
-        urlUpdated()
-    }
-
-    fun urlUpdated() {
-        runBlocking {
-            if (dataComponent.urlRepository().getUrl() != null) {
-                this@Graph.url = dataComponent.urlRepository().getUrl().toString()
-                buildComponent()
-            }
-        }
     }
 
     @SuppressLint("HardwareIds")
@@ -43,7 +31,6 @@ class Graph(
             .builder()
             .dataModule(
                 DataModule(
-                    url,
                     LocalStorageImpl(
                         application.getSharedPreferences(
                             "url_$instanceId",
diff --git a/common/src/main/java/io/homeassistant/companion/android/common/dagger/GraphComponentAccessor.kt b/common/src/main/java/io/homeassistant/companion/android/common/dagger/GraphComponentAccessor.kt
index db661dcd403..4dd85a11a06 100644
--- a/common/src/main/java/io/homeassistant/companion/android/common/dagger/GraphComponentAccessor.kt
+++ b/common/src/main/java/io/homeassistant/companion/android/common/dagger/GraphComponentAccessor.kt
@@ -3,6 +3,4 @@ package io.homeassistant.companion.android.common.dagger
 interface GraphComponentAccessor {
 
     val appComponent: AppComponent
-
-    fun urlUpdated()
 }
diff --git a/data/build.gradle b/data/build.gradle
index fd87594db5c..487e6cf9bb3 100644
--- a/data/build.gradle
+++ b/data/build.gradle
@@ -13,7 +13,7 @@ test {
 dependencies {
     implementation project(':domain')
 
-    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
     implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutinesVersion"
 
     implementation 'javax.inject:javax.inject:1'
diff --git a/data/src/main/java/io/homeassistant/companion/android/data/HomeAssistantRetrofit.kt b/data/src/main/java/io/homeassistant/companion/android/data/HomeAssistantRetrofit.kt
index 22c2aa6f9e2..a2668fbf1b8 100644
--- a/data/src/main/java/io/homeassistant/companion/android/data/HomeAssistantRetrofit.kt
+++ b/data/src/main/java/io/homeassistant/companion/android/data/HomeAssistantRetrofit.kt
@@ -4,13 +4,18 @@ import com.fasterxml.jackson.databind.DeserializationFeature
 import com.fasterxml.jackson.databind.ObjectMapper
 import com.fasterxml.jackson.databind.PropertyNamingStrategy
 import com.fasterxml.jackson.module.kotlin.registerKotlinModule
+import io.homeassistant.companion.android.domain.url.UrlRepository
 import javax.inject.Inject
+import kotlinx.coroutines.runBlocking
 import okhttp3.OkHttpClient
 import okhttp3.logging.HttpLoggingInterceptor
 import retrofit2.Retrofit
 import retrofit2.converter.jackson.JacksonConverterFactory
 
-class HomeAssistantRetrofit @Inject constructor(url: String) {
+class HomeAssistantRetrofit @Inject constructor(urlRepository: UrlRepository) {
+    companion object {
+        private const val LOCAL_HOST = "http://localhost/"
+    }
 
     val retrofit: Retrofit = Retrofit
         .Builder()
@@ -27,8 +32,20 @@ class HomeAssistantRetrofit @Inject constructor(url: String) {
                 .addInterceptor(HttpLoggingInterceptor().apply {
                     level = HttpLoggingInterceptor.Level.BODY
                 })
+                .addInterceptor {
+                    return@addInterceptor if (it.request().url.toString().contains(LOCAL_HOST)) {
+                        val newRequest = runBlocking {
+                            it.request().newBuilder()
+                                .url(it.request().url.toString().replace(LOCAL_HOST, urlRepository.getUrl().toString()))
+                                .build()
+                        }
+                        it.proceed(newRequest)
+                    } else {
+                        it.proceed(it.request())
+                    }
+                }
                 .build()
         )
-        .baseUrl(url)
+        .baseUrl(LOCAL_HOST)
         .build()
 }
diff --git a/data/src/test/java/io/homeassistant/companion/android/data/HomeAssistantMockService.kt b/data/src/test/java/io/homeassistant/companion/android/data/HomeAssistantMockService.kt
index 11179091c46..846f01dbef6 100644
--- a/data/src/test/java/io/homeassistant/companion/android/data/HomeAssistantMockService.kt
+++ b/data/src/test/java/io/homeassistant/companion/android/data/HomeAssistantMockService.kt
@@ -1,14 +1,40 @@
 package io.homeassistant.companion.android.data
 
+import io.homeassistant.companion.android.domain.url.UrlRepository
 import java.io.IOException
+import java.net.URL
 import okhttp3.mockwebserver.MockResponse
 import okhttp3.mockwebserver.MockWebServer
 
 class HomeAssistantMockService<T>(private val c: Class<T>) {
 
     private val mockServer: MockWebServer = MockWebServer()
-    private val homeAssistantRetrofit =
-        HomeAssistantRetrofit(mockServer.url("/").toString()).retrofit
+    private val homeAssistantRetrofit = HomeAssistantRetrofit(object : UrlRepository {
+        override suspend fun getApiUrls(): Array<URL> {
+            return arrayOf(getUrl()!!)
+        }
+
+        override suspend fun saveRegistrationUrls(
+            cloudHookUrl: String?,
+            remoteUiUrl: String?,
+            webhookId: String
+        ) {
+        }
+
+        override suspend fun getUrl(isInternal: Boolean?): URL? {
+            return mockServer.url("/").toUrl()
+        }
+
+        override suspend fun saveUrl(url: String, isInternal: Boolean?) {
+        }
+
+        override suspend fun getHomeWifiSsid(): String? {
+            return null
+        }
+
+        override suspend fun saveHomeWifiSsid(ssid: String?) {
+        }
+    }).retrofit
 
     fun get(): T {
         return homeAssistantRetrofit.create(c)
diff --git a/domain/build.gradle b/domain/build.gradle
index b377aebe6e0..5fb0a55b1d2 100644
--- a/domain/build.gradle
+++ b/domain/build.gradle
@@ -11,7 +11,7 @@ test {
 }
 
 dependencies {
-    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
+    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
     implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutinesVersion"
 
     implementation 'javax.inject:javax.inject:1'
