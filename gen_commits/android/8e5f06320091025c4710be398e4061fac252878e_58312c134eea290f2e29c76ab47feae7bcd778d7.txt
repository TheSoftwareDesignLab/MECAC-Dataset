diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
index ddd2b6b0aac..4a30263e342 100644
--- a/app/src/main/AndroidManifest.xml
+++ b/app/src/main/AndroidManifest.xml
@@ -38,6 +38,18 @@
         android:networkSecurityConfig="@xml/network_security_config"
         tools:ignore="GoogleAppIndexingWarning">
 
+        <!-- Start things like SensorWorker on device boot -->
+        <receiver android:name=".sensors.SensorReceiver">
+            <intent-filter>
+                <action android:name="android.intent.action.BOOT_COMPLETED" />
+                <action android:name="android.intent.action.QUICKBOOT_POWERON" />
+                <action android:name="com.htc.intent.action.QUICKBOOT_POWERON" />
+                <action android:name="android.app.action.NEXT_ALARM_CLOCK_CHANGED" />
+                <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />
+                <action android:name="android.bluetooth.device.action.ACL_DISCONNECTED" />
+            </intent-filter>
+        </receiver>
+
         <receiver android:name=".widgets.ButtonWidget" android:label="@string/widget_button_image_description">
             <intent-filter>
                 <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
@@ -61,16 +73,15 @@
                 android:resource="@xml/static_widget_info" />
         </receiver>
 
-        <!-- Start things like SensorWorker on device boot -->
-        <receiver android:name=".sensors.SensorReceiver">
+        <receiver android:name=".widgets.template.TemplateWidget" android:label="Template Widget">
             <intent-filter>
-                <action android:name="android.intent.action.BOOT_COMPLETED" />
-                <action android:name="android.intent.action.QUICKBOOT_POWERON" />
-                <action android:name="com.htc.intent.action.QUICKBOOT_POWERON" />
-                <action android:name="android.app.action.NEXT_ALARM_CLOCK_CHANGED" />
-                <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />
-                <action android:name="android.bluetooth.device.action.ACL_DISCONNECTED" />
+                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
+                <action android:name="io.homeassistant.companion.android.widgets.template.TemplateWidget.RECEIVE_DATA" />
             </intent-filter>
+
+            <meta-data
+                android:name="android.appwidget.provider"
+                android:resource="@xml/template_widget_info" />
         </receiver>
 
         <activity android:name=".widgets.ButtonWidgetConfigureActivity">
@@ -85,6 +96,12 @@
             </intent-filter>
         </activity>
 
+        <activity android:name=".widgets.template.TemplateWidgetConfigureActivity">
+            <intent-filter>
+                <action android:name="android.appwidget.action.APPWIDGET_CONFIGURE" />
+            </intent-filter>
+        </activity>
+
         <receiver
             android:name=".sensors.LocationBroadcastReceiver"
             android:enabled="true"
diff --git a/app/src/main/java/io/homeassistant/companion/android/database/AppDatabase.kt b/app/src/main/java/io/homeassistant/companion/android/database/AppDatabase.kt
index a819f2e5699..0bec72b1454 100644
--- a/app/src/main/java/io/homeassistant/companion/android/database/AppDatabase.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/database/AppDatabase.kt
@@ -14,21 +14,25 @@ import io.homeassistant.companion.android.database.widget.ButtonWidgetDao
 import io.homeassistant.companion.android.database.widget.ButtonWidgetEntity
 import io.homeassistant.companion.android.database.widget.StaticWidgetDao
 import io.homeassistant.companion.android.database.widget.StaticWidgetEntity
+import io.homeassistant.companion.android.database.widget.TemplateWidgetDao
+import io.homeassistant.companion.android.database.widget.TemplateWidgetEntity
 
 @Database(
     entities = [
         Authentication::class,
         Sensor::class,
         ButtonWidgetEntity::class,
-        StaticWidgetEntity::class
+        StaticWidgetEntity::class,
+        TemplateWidgetEntity::class
     ],
-    version = 4
+    version = 5
 )
 abstract class AppDatabase : RoomDatabase() {
     abstract fun authenticationDao(): AuthenticationDao
     abstract fun sensorDao(): SensorDao
     abstract fun buttonWidgetDao(): ButtonWidgetDao
     abstract fun staticWidgetDao(): StaticWidgetDao
+    abstract fun templateWidgetDao(): TemplateWidgetDao
 
     companion object {
         private const val DATABASE_NAME = "HomeAssistantDB"
@@ -49,7 +53,8 @@ abstract class AppDatabase : RoomDatabase() {
                 .addMigrations(
                     MIGRATION_1_2,
                     MIGRATION_2_3,
-                    MIGRATION_3_4
+                    MIGRATION_3_4,
+                    MIGRATION_4_5
                 )
                 .build()
         }
@@ -74,5 +79,11 @@ abstract class AppDatabase : RoomDatabase() {
                 database.execSQL("ALTER TABLE `static_widget` ADD `separator` TEXT NOT NULL DEFAULT ' '")
             }
         }
+
+        private val MIGRATION_4_5 = object : Migration(4, 5) {
+            override fun migrate(database: SupportSQLiteDatabase) {
+                database.execSQL("CREATE TABLE IF NOT EXISTS `template_widgets` (`id` INTEGER NOT NULL, `template` TEXT NOT NULL, PRIMARY KEY(`id`))")
+            }
+        }
     }
 }
diff --git a/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt b/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt
new file mode 100644
index 00000000000..51a6edecad8
--- /dev/null
+++ b/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt
@@ -0,0 +1,23 @@
+package io.homeassistant.companion.android.database.widget
+
+import androidx.room.Dao
+import androidx.room.Insert
+import androidx.room.OnConflictStrategy
+import androidx.room.Query
+import androidx.room.Update
+
+@Dao
+interface TemplateWidgetDao {
+
+    @Query("SELECT * FROM template_widgets WHERE id = :id")
+    fun get(id: Int): TemplateWidgetEntity?
+
+    @Insert(onConflict = OnConflictStrategy.REPLACE)
+    fun add(templateWidgetEntity: TemplateWidgetEntity)
+
+    @Update
+    fun update(templateWidgetEntity: TemplateWidgetEntity)
+
+    @Query("DELETE FROM template_widgets WHERE id = :id")
+    fun delete(id: Int)
+}
diff --git a/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt b/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt
new file mode 100644
index 00000000000..b791acc48fe
--- /dev/null
+++ b/app/src/main/java/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt
@@ -0,0 +1,13 @@
+package io.homeassistant.companion.android.database.widget
+
+import androidx.room.ColumnInfo
+import androidx.room.Entity
+import androidx.room.PrimaryKey
+
+@Entity(tableName = "template_widgets")
+data class TemplateWidgetEntity(
+    @PrimaryKey
+    val id: Int,
+    @ColumnInfo(name = "template")
+    val template: String
+)
diff --git a/app/src/main/java/io/homeassistant/companion/android/widgets/ProviderComponent.kt b/app/src/main/java/io/homeassistant/companion/android/widgets/ProviderComponent.kt
index 388d3a8e5c1..b0fd2be48b8 100644
--- a/app/src/main/java/io/homeassistant/companion/android/widgets/ProviderComponent.kt
+++ b/app/src/main/java/io/homeassistant/companion/android/widgets/ProviderComponent.kt
@@ -2,6 +2,8 @@ package io.homeassistant.companion.android.widgets
 
 import dagger.Component
 import io.homeassistant.companion.android.common.dagger.AppComponent
+import io.homeassistant.companion.android.widgets.template.TemplateWidget
+import io.homeassistant.companion.android.widgets.template.TemplateWidgetConfigureActivity
 
 @Component(dependencies = [AppComponent::class])
 interface ProviderComponent {
@@ -13,4 +15,8 @@ interface ProviderComponent {
     fun inject(receiver: StaticWidget)
 
     fun inject(activity: StaticWidgetConfigureActivity)
+
+    fun inject(receiver: TemplateWidget)
+
+    fun inject(activity: TemplateWidgetConfigureActivity)
 }
diff --git a/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidget.kt b/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidget.kt
new file mode 100644
index 00000000000..244ae5ce3c5
--- /dev/null
+++ b/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidget.kt
@@ -0,0 +1,176 @@
+package io.homeassistant.companion.android.widgets.template
+
+import android.app.PendingIntent
+import android.appwidget.AppWidgetManager
+import android.appwidget.AppWidgetProvider
+import android.content.Context
+import android.content.Intent
+import android.os.Bundle
+import android.util.Log
+import android.widget.RemoteViews
+import io.homeassistant.companion.android.R
+import io.homeassistant.companion.android.common.dagger.GraphComponentAccessor
+import io.homeassistant.companion.android.database.AppDatabase
+import io.homeassistant.companion.android.database.widget.TemplateWidgetDao
+import io.homeassistant.companion.android.database.widget.TemplateWidgetEntity
+import io.homeassistant.companion.android.domain.integration.IntegrationUseCase
+import io.homeassistant.companion.android.widgets.DaggerProviderComponent
+import javax.inject.Inject
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.Job
+import kotlinx.coroutines.launch
+
+class TemplateWidget : AppWidgetProvider() {
+    companion object {
+        private const val TAG = "TemplateWidget"
+        private const val UPDATE_VIEW =
+            "io.homeassistant.companion.android.widgets.template.TemplateWidget.UPDATE_VIEW"
+        internal const val RECEIVE_DATA =
+            "io.homeassistant.companion.android.widgets.template.TemplateWidget.RECEIVE_DATA"
+
+        internal const val EXTRA_TEMPLATE = "extra_template"
+    }
+
+    @Inject
+    lateinit var integrationUseCase: IntegrationUseCase
+
+    private lateinit var templateWidgetDao: TemplateWidgetDao
+
+    private val mainScope: CoroutineScope = CoroutineScope(Dispatchers.Main + Job())
+
+    override fun onUpdate(
+        context: Context,
+        appWidgetManager: AppWidgetManager,
+        appWidgetIds: IntArray
+    ) {
+        templateWidgetDao = AppDatabase.getInstance(context).templateWidgetDao()
+        // There may be multiple widgets active, so update all of them
+        for (appWidgetId in appWidgetIds) {
+            mainScope.launch {
+                val views = getWidgetRemoteViews(context, appWidgetId)
+                appWidgetManager.updateAppWidget(appWidgetId, views)
+            }
+        }
+    }
+
+    override fun onDeleted(context: Context, appWidgetIds: IntArray) {
+        templateWidgetDao = AppDatabase.getInstance(context).templateWidgetDao()
+        // When the user deletes the widget, delete the preference associated with it.
+        for (appWidgetId in appWidgetIds) {
+            templateWidgetDao.delete(appWidgetId)
+        }
+    }
+
+    override fun onEnabled(context: Context) {
+        // Enter relevant functionality for when the first widget is created
+    }
+
+    override fun onDisabled(context: Context) {
+        // Enter relevant functionality for when the last widget is disabled
+    }
+
+    override fun onReceive(context: Context, intent: Intent) {
+        val action = intent.action
+        val appWidgetId = intent.getIntExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, -1)
+
+        Log.d(
+            TAG, "Broadcast received: " + System.lineSeparator() +
+                    "Broadcast action: " + action + System.lineSeparator() +
+                    "AppWidgetId: " + appWidgetId
+        )
+
+        ensureInjected(context)
+
+        templateWidgetDao = AppDatabase.getInstance(context).templateWidgetDao()
+
+        super.onReceive(context, intent)
+        when (action) {
+            UPDATE_VIEW -> updateView(context, appWidgetId)
+            RECEIVE_DATA -> saveEntityConfiguration(context, intent.extras, appWidgetId)
+        }
+    }
+
+    private suspend fun getWidgetRemoteViews(context: Context, appWidgetId: Int): RemoteViews {
+        // Every time AppWidgetManager.updateAppWidget(...) is called, the button listener
+        // and label need to be re-assigned, or the next time the layout updates
+        // (e.g home screen rotation) the widget will fall back on its default layout
+        // without any click listener being applied
+
+        val intent = Intent(context, TemplateWidget::class.java).apply {
+            action = UPDATE_VIEW
+            putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)
+        }
+
+        val widget = templateWidgetDao.get(appWidgetId)
+
+        return RemoteViews(context.packageName, R.layout.widget_template).apply {
+
+            setOnClickPendingIntent(
+                R.id.widgetLayout,
+                PendingIntent.getBroadcast(
+                    context,
+                    appWidgetId,
+                    intent,
+                    PendingIntent.FLAG_UPDATE_CURRENT
+                )
+            )
+            if (widget != null) {
+                var renderedTemplate = "Loading"
+                try {
+                    renderedTemplate = integrationUseCase.renderTemplate(widget.template)
+                } catch (e: Exception) {
+                    Log.e(TAG, "Unable to render template: ${widget.template}", e)
+                }
+                setTextViewText(
+                    R.id.widgetTemplateText,
+                    renderedTemplate
+                )
+            }
+        }
+    }
+
+    private fun updateView(
+        context: Context,
+        appWidgetId: Int,
+        appWidgetManager: AppWidgetManager = AppWidgetManager.getInstance(context)
+    ) {
+        Log.d(TAG, "Updating Template Widget View: $appWidgetId")
+        mainScope.launch {
+            val views = getWidgetRemoteViews(context, appWidgetId)
+            appWidgetManager.updateAppWidget(appWidgetId, views)
+        }
+    }
+
+    private fun saveEntityConfiguration(context: Context, extras: Bundle?, appWidgetId: Int) {
+        if (extras == null) return
+
+        val template: String? = extras.getString(EXTRA_TEMPLATE)
+
+        if (template == null) {
+            Log.e(TAG, "Did not receive complete widget data")
+            return
+        }
+
+        mainScope.launch {
+            templateWidgetDao.add(
+                TemplateWidgetEntity(
+                    appWidgetId,
+                    template
+                )
+            )
+            onUpdate(context, AppWidgetManager.getInstance(context), intArrayOf(appWidgetId))
+        }
+    }
+
+    private fun ensureInjected(context: Context) {
+        if (context.applicationContext is GraphComponentAccessor) {
+            DaggerProviderComponent.builder()
+                .appComponent((context.applicationContext as GraphComponentAccessor).appComponent)
+                .build()
+                .inject(this)
+        } else {
+            throw Exception("Application Context passed is not of our application!")
+        }
+    }
+}
diff --git a/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidgetConfigureActivity.kt b/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidgetConfigureActivity.kt
new file mode 100644
index 00000000000..b009e44f6e3
--- /dev/null
+++ b/app/src/main/java/io/homeassistant/companion/android/widgets/template/TemplateWidgetConfigureActivity.kt
@@ -0,0 +1,107 @@
+package io.homeassistant.companion.android.widgets.template
+
+import android.appwidget.AppWidgetManager
+import android.content.ComponentName
+import android.content.Intent
+import android.os.Bundle
+import androidx.appcompat.app.AppCompatActivity
+import androidx.core.widget.doAfterTextChanged
+import io.homeassistant.companion.android.R
+import io.homeassistant.companion.android.common.dagger.GraphComponentAccessor
+import io.homeassistant.companion.android.domain.integration.IntegrationUseCase
+import io.homeassistant.companion.android.widgets.DaggerProviderComponent
+import javax.inject.Inject
+import kotlinx.android.synthetic.main.widget_template_configure.*
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.Job
+import kotlinx.coroutines.cancel
+import kotlinx.coroutines.launch
+
+class TemplateWidgetConfigureActivity : AppCompatActivity() {
+    companion object {
+        private const val TAG: String = "TemplateWidgetConfigAct"
+    }
+
+    @Inject
+    lateinit var integrationUseCase: IntegrationUseCase
+
+    private val ioScope: CoroutineScope = CoroutineScope(Dispatchers.IO)
+
+    private val mainScope: CoroutineScope = CoroutineScope(Dispatchers.Main + Job())
+
+    private var appWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID
+
+    public override fun onCreate(icicle: Bundle?) {
+        super.onCreate(icicle)
+
+        // Set the result to CANCELED.  This will cause the widget host to cancel
+        // out of the widget placement if the user presses the back button.
+        setResult(RESULT_CANCELED)
+
+        setContentView(R.layout.widget_template_configure)
+
+        // Find the widget id from the intent.
+        val intent = intent
+        val extras = intent.extras
+        if (extras != null) {
+            appWidgetId = extras.getInt(
+                AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID
+            )
+        }
+
+        // If this activity was started with an intent without an app widget ID, finish with an error.
+        if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
+            finish()
+            return
+        }
+
+        // Inject components
+        DaggerProviderComponent
+            .builder()
+            .appComponent((application as GraphComponentAccessor).appComponent)
+            .build()
+            .inject(this)
+
+        templateText.doAfterTextChanged { editableText ->
+            if (editableText == null)
+                return@doAfterTextChanged
+            ioScope.launch {
+                var templateText: String?
+                var enabled: Boolean
+                try {
+                    templateText = integrationUseCase.renderTemplate(editableText.toString())
+                    enabled = true
+                } catch (e: Exception) {
+                    templateText = "Error in template"
+                    enabled = false
+                }
+                runOnUiThread {
+                    renderedTemplate.text = templateText
+                    add_button.isEnabled = enabled
+                }
+            }
+        }
+
+        add_button.setOnClickListener {
+            val createIntent = Intent().apply {
+                action = TemplateWidget.RECEIVE_DATA
+                component = ComponentName(applicationContext, TemplateWidget::class.java)
+                putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)
+                putExtra(TemplateWidget.EXTRA_TEMPLATE, templateText.text.toString())
+            }
+            applicationContext.sendBroadcast(createIntent)
+
+            setResult(
+                RESULT_OK,
+                Intent().putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)
+            )
+            finish()
+        }
+    }
+
+    override fun onDestroy() {
+        mainScope.cancel()
+        super.onDestroy()
+    }
+}
diff --git a/app/src/main/res/layout/widget_template.xml b/app/src/main/res/layout/widget_template.xml
new file mode 100644
index 00000000000..7ea196b90cd
--- /dev/null
+++ b/app/src/main/res/layout/widget_template.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/widgetLayout"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@drawable/widget_button_background"
+    android:minWidth="40dp"
+    android:minHeight="40dp"
+    android:padding="4dp">
+
+    <TextView
+        android:id="@+id/widgetTemplateText"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_gravity="center"
+        android:gravity="center"
+        android:textAlignment="center"
+        android:textColor="@color/colorWidgetButtonLabel"
+        android:textSize="12sp" />
+</FrameLayout>
\ No newline at end of file
diff --git a/app/src/main/res/layout/widget_template_configure.xml b/app/src/main/res/layout/widget_template_configure.xml
new file mode 100644
index 00000000000..158071d7cbf
--- /dev/null
+++ b/app/src/main/res/layout/widget_template_configure.xml
@@ -0,0 +1,44 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.core.widget.NestedScrollView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical"
+        android:padding="16dp">
+
+        <TextView
+            style="@style/TextAppearance.HomeAssistant.Headline"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="@string/create_template" />
+
+
+        <androidx.appcompat.widget.AppCompatEditText
+            android:id="@+id/templateText"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="@string/template_widget_default"
+            android:gravity="top"
+            android:minLines="4"
+            android:inputType="textMultiLine" />
+
+        <androidx.appcompat.widget.AppCompatTextView
+            android:id="@+id/renderedTemplate"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="@string/template_widget_default" />
+
+        <androidx.appcompat.widget.AppCompatButton
+            android:id="@+id/add_button"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="end"
+            android:layout_marginTop="8dp"
+            android:text="@string/add_widget" />
+
+    </LinearLayout>
+</androidx.core.widget.NestedScrollView>
\ No newline at end of file
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index df033688f2c..26ed45298de 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -169,4 +169,6 @@ like to connect to:</string>
   <string name="widget_text_size_default">30</string>
   <string name="widget_separator_label">State and attribute separator:</string>
   <string name="widget_separator_input_hint">No separator</string>
+  <string name="create_template">Create Template</string>
+  <string name="template_widget_default">Enter Template Here</string>
 </resources>
diff --git a/app/src/main/res/xml/template_widget_info.xml b/app/src/main/res/xml/template_widget_info.xml
new file mode 100644
index 00000000000..9db8f53cb59
--- /dev/null
+++ b/app/src/main/res/xml/template_widget_info.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="utf-8"?>
+<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
+    android:configure="io.homeassistant.companion.android.widgets.template.TemplateWidgetConfigureActivity"
+    android:initialKeyguardLayout="@layout/widget_template"
+    android:initialLayout="@layout/widget_template"
+    android:minWidth="40dp"
+    android:minHeight="40dp"
+    android:minResizeWidth="40dp"
+    android:minResizeHeight="40dp"
+    android:resizeMode="vertical|horizontal"
+    android:updatePeriodMillis="1800000"
+    android:widgetCategory="home_screen" />
\ No newline at end of file
diff --git a/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImpl.kt b/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImpl.kt
index 9bdc5e41953..e8f540fdc16 100644
--- a/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImpl.kt
+++ b/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImpl.kt
@@ -8,6 +8,7 @@ import io.homeassistant.companion.android.data.integration.entities.IntegrationR
 import io.homeassistant.companion.android.data.integration.entities.RegisterDeviceRequest
 import io.homeassistant.companion.android.data.integration.entities.SensorRequest
 import io.homeassistant.companion.android.data.integration.entities.ServiceCallRequest
+import io.homeassistant.companion.android.data.integration.entities.Template
 import io.homeassistant.companion.android.data.integration.entities.UpdateLocationRequest
 import io.homeassistant.companion.android.domain.authentication.AuthenticationRepository
 import io.homeassistant.companion.android.domain.integration.DeviceRegistration
@@ -46,9 +47,6 @@ class IntegrationRepositoryImpl @Inject constructor(
 
         private const val PREF_SECRET = "secret"
 
-        private const val PREF_ZONE_ENABLED = "zone_enabled"
-        private const val PREF_BACKGROUND_ENABLED = "background_enabled"
-        private const val PREF_CALL_ENABLED = "call_enabled"
         private const val PREF_FULLSCREEN_ENABLED = "fullscreen_enabled"
         private const val PREF_SESSION_TIMEOUT = "session_timeout"
         private const val PREF_SESSION_EXPIRE = "session_expire"
@@ -80,7 +78,11 @@ class IntegrationRepositoryImpl @Inject constructor(
                 request
             )
         persistDeviceRegistration(deviceRegistration)
-        urlRepository.saveRegistrationUrls(response.cloudhookUrl, response.remoteUiUrl, response.webhookId)
+        urlRepository.saveRegistrationUrls(
+            response.cloudhookUrl,
+            response.remoteUiUrl,
+            response.webhookId
+        )
         localStorage.putString(PREF_SECRET, response.secret)
     }
 
@@ -92,7 +94,7 @@ class IntegrationRepositoryImpl @Inject constructor(
             )
         for (it in urlRepository.getApiUrls()) {
             try {
-                if (integrationService.updateRegistration(it.toHttpUrlOrNull()!!, request).isSuccessful) {
+                if (integrationService.callWebhook(it.toHttpUrlOrNull()!!, request).isSuccessful) {
                     persistDeviceRegistration(deviceRegistration)
                     return
                 }
@@ -125,13 +127,34 @@ class IntegrationRepositoryImpl @Inject constructor(
         return urlRepository.getApiUrls().isNotEmpty()
     }
 
+    override suspend fun renderTemplate(template: String, variables: Map<String, String>): String {
+        for (it in urlRepository.getApiUrls()) {
+            try {
+                return integrationService.getTemplate(
+                    it.toHttpUrlOrNull()!!,
+                    IntegrationRequest(
+                        "render_template",
+                        mapOf("template" to Template(template, variables))
+                    )
+                ).getValue("template")
+            } catch (e: Exception) {
+                // Ignore failure until we are out of URLS to try!
+            }
+        }
+
+        throw IntegrationException()
+    }
+
     override suspend fun updateLocation(updateLocation: UpdateLocation) {
         val updateLocationRequest = createUpdateLocation(updateLocation)
         for (it in urlRepository.getApiUrls()) {
             var wasSuccess = false
             try {
                 wasSuccess =
-                    integrationService.updateLocation(it.toHttpUrlOrNull()!!, updateLocationRequest).isSuccessful
+                    integrationService.callWebhook(
+                        it.toHttpUrlOrNull()!!,
+                        updateLocationRequest
+                    ).isSuccessful
             } catch (e: Exception) {
                 // Ignore failure until we are out of URLS to try!
             }
@@ -143,7 +166,11 @@ class IntegrationRepositoryImpl @Inject constructor(
         throw IntegrationException()
     }
 
-    override suspend fun callService(domain: String, service: String, serviceData: HashMap<String, Any>) {
+    override suspend fun callService(
+        domain: String,
+        service: String,
+        serviceData: HashMap<String, Any>
+    ) {
         var wasSuccess = false
 
         val serviceCallRequest =
@@ -156,7 +183,7 @@ class IntegrationRepositoryImpl @Inject constructor(
         for (it in urlRepository.getApiUrls()) {
             try {
                 wasSuccess =
-                    integrationService.callService(
+                    integrationService.callWebhook(
                         it.toHttpUrlOrNull()!!,
                         IntegrationRequest(
                             "call_service",
@@ -180,7 +207,7 @@ class IntegrationRepositoryImpl @Inject constructor(
         for (it in urlRepository.getApiUrls()) {
             try {
                 wasSuccess =
-                    integrationService.scanTag(
+                    integrationService.callWebhook(
                         it.toHttpUrlOrNull()!!,
                         IntegrationRequest(
                             "scan_tag",
@@ -209,7 +236,7 @@ class IntegrationRepositoryImpl @Inject constructor(
         for (it in urlRepository.getApiUrls()) {
             try {
                 wasSuccess =
-                    integrationService.fireEvent(
+                    integrationService.callWebhook(
                         it.toHttpUrlOrNull()!!,
                         IntegrationRequest(
                             "fire_event",
@@ -366,7 +393,7 @@ class IntegrationRepositoryImpl @Inject constructor(
         )
         for (it in urlRepository.getApiUrls()) {
             try {
-                integrationService.registerSensor(it.toHttpUrlOrNull()!!, integrationRequest).let {
+                integrationService.callWebhook(it.toHttpUrlOrNull()!!, integrationRequest).let {
                     // If we created sensor or it already exists
                     if (it.isSuccessful || it.code() == 409) {
                         localStorage.putStringSet(
diff --git a/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationService.kt b/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationService.kt
index d1461bad855..7c1b9980431 100644
--- a/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationService.kt
+++ b/data/src/main/java/io/homeassistant/companion/android/data/integration/IntegrationService.kt
@@ -42,34 +42,16 @@ interface IntegrationService {
     ): Array<EntityResponse<Any>>
 
     @POST
-    suspend fun updateRegistration(
+    suspend fun callWebhook(
         @Url url: HttpUrl,
         @Body request: IntegrationRequest
     ): Response<ResponseBody>
 
     @POST
-    suspend fun updateLocation(
+    suspend fun getTemplate(
         @Url url: HttpUrl,
         @Body request: IntegrationRequest
-    ): Response<ResponseBody>
-
-    @POST
-    suspend fun callService(
-        @Url url: HttpUrl,
-        @Body request: IntegrationRequest
-    ): Response<ResponseBody>
-
-    @POST
-    suspend fun scanTag(
-        @Url url: HttpUrl,
-        @Body request: IntegrationRequest
-    ): Response<ResponseBody>
-
-    @POST
-    suspend fun fireEvent(
-        @Url url: HttpUrl,
-        @Body request: IntegrationRequest
-    ): Response<ResponseBody>
+    ): Map<String, String>
 
     @POST
     suspend fun getZones(
@@ -89,12 +71,6 @@ interface IntegrationService {
         @Body request: IntegrationRequest
     ): Array<Panel>
 
-    @POST
-    suspend fun registerSensor(
-        @Url url: HttpUrl,
-        @Body request: IntegrationRequest
-    ): Response<ResponseBody>
-
     @POST
     suspend fun updateSensors(
         @Url url: HttpUrl,
diff --git a/data/src/main/java/io/homeassistant/companion/android/data/integration/entities/Template.kt b/data/src/main/java/io/homeassistant/companion/android/data/integration/entities/Template.kt
new file mode 100644
index 00000000000..782e5afefbe
--- /dev/null
+++ b/data/src/main/java/io/homeassistant/companion/android/data/integration/entities/Template.kt
@@ -0,0 +1,6 @@
+package io.homeassistant.companion.android.data.integration.entities
+
+data class Template(
+    val template: String,
+    val variables: Map<String, String>
+)
diff --git a/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImplSpec.kt b/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImplSpec.kt
index bb4e3084487..ee1b2a32c67 100644
--- a/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImplSpec.kt
+++ b/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationRepositoryImplSpec.kt
@@ -208,7 +208,7 @@ object IntegrationRepositoryImplSpec : Spek({
                 )
             beforeEachTest {
                 coEvery {
-                    integrationService.updateRegistration(any(),
+                    integrationService.callWebhook(any(),
                         IntegrationRequest(
                             "update_registration",
                             registerDeviceRequest
@@ -233,7 +233,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
             it("should call the service") {
                 coVerify {
-                    integrationService.updateRegistration(
+                    integrationService.callWebhook(
                         "http://best.com/hook/id".toHttpUrl(),
                         IntegrationRequest(
                             "update_registration",
@@ -318,7 +318,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -328,7 +328,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             integrationRequest
                         )
@@ -365,7 +365,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -375,7 +375,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -411,7 +411,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com/api/webhook/FGHIJ")
                     )
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -421,7 +421,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://example.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -460,7 +460,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -468,7 +468,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -479,11 +479,11 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call service 2 times") {
                     coVerifyAll {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             integrationRequest
                         )
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -511,7 +511,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -519,7 +519,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -527,7 +527,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.updateLocation(
+                        integrationService.callWebhook(
                             "http://example.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -571,7 +571,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -581,7 +581,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             integrationRequest
                         )
@@ -613,7 +613,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -623,7 +623,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -654,7 +654,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com/api/webhook/FGHIJ")
                     )
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             any(), // "http://example.com/api/webhook/FGHIJ",
                             any() // integrationRequest
                         )
@@ -664,7 +664,7 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call the service.") {
                     coVerify {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://example.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -697,7 +697,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -705,7 +705,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -715,11 +715,11 @@ object IntegrationRepositoryImplSpec : Spek({
 
                 it("should call service 2 times") {
                     coVerifyAll {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             integrationRequest
                         )
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             integrationRequest
                         )
@@ -741,7 +741,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         URL("http://example.com")
                     )
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://best.com/hook/id".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -749,7 +749,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://better.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
@@ -757,7 +757,7 @@ object IntegrationRepositoryImplSpec : Spek({
                         every { isSuccessful } returns false
                     }
                     coEvery {
-                        integrationService.callService(
+                        integrationService.callWebhook(
                             "http://example.com/api/webhook/FGHIJ".toHttpUrl(),
                             any() // integrationRequest
                         )
diff --git a/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationServiceSpec.kt b/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationServiceSpec.kt
index e38127192f2..726117b1420 100644
--- a/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationServiceSpec.kt
+++ b/data/src/test/java/io/homeassistant/companion/android/data/integration/IntegrationServiceSpec.kt
@@ -75,7 +75,7 @@ object IntegrationServiceSpec : Spek({
                     )
                 mockService.enqueueResponse(200, "integration/empty.json")
                 response = runBlocking {
-                    mockService.get().updateLocation(mockService.getMockServer().url("/path/to/hook"), integrationRequest)
+                    mockService.get().callWebhook(mockService.getMockServer().url("/path/to/hook"), integrationRequest)
                 }
                 request = mockService.takeRequest()
             }
@@ -111,7 +111,7 @@ object IntegrationServiceSpec : Spek({
 
                 mockService.enqueueResponse(200, "integration/empty.json")
                 response = runBlocking {
-                    mockService.get().callService(mockService.getMockServer().url("/path/to/hook"), integrationRequest)
+                    mockService.get().callWebhook(mockService.getMockServer().url("/path/to/hook"), integrationRequest)
                 }
                 request = mockService.takeRequest()
             }
diff --git a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationRepository.kt b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationRepository.kt
index 55fb90275fb..3b563e289f4 100644
--- a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationRepository.kt
+++ b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationRepository.kt
@@ -8,6 +8,8 @@ interface IntegrationRepository {
 
     suspend fun isRegistered(): Boolean
 
+    suspend fun renderTemplate(template: String, variables: Map<String, String>): String
+
     suspend fun updateLocation(updateLocation: UpdateLocation)
 
     suspend fun getZones(): Array<Entity<ZoneAttributes>>
diff --git a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCase.kt b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCase.kt
index 6b925099329..14200a3810c 100644
--- a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCase.kt
+++ b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCase.kt
@@ -17,6 +17,8 @@ interface IntegrationUseCase {
 
     suspend fun isRegistered(): Boolean
 
+    suspend fun renderTemplate(template: String, variables: Map<String, String> = mapOf()): String
+
     suspend fun updateLocation(updateLocation: UpdateLocation)
 
     suspend fun callService(domain: String, service: String, serviceData: HashMap<String, Any>)
diff --git a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCaseImpl.kt b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCaseImpl.kt
index 77ee400f0f4..95ee509af08 100644
--- a/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCaseImpl.kt
+++ b/domain/src/main/java/io/homeassistant/companion/android/domain/integration/IntegrationUseCaseImpl.kt
@@ -36,6 +36,10 @@ class IntegrationUseCaseImpl @Inject constructor(
         return integrationRepository.isRegistered()
     }
 
+    override suspend fun renderTemplate(template: String, variables: Map<String, String>): String {
+        return integrationRepository.renderTemplate(template, variables)
+    }
+
     override suspend fun updateLocation(updateLocation: UpdateLocation) {
         return integrationRepository.updateLocation(updateLocation)
     }
