diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/settings/widgets/views/ManageWidgetsView.kt b/app/src/main/kotlin/io/homeassistant/companion/android/settings/widgets/views/ManageWidgetsView.kt
index 27d6ecf2f48..7c3b9e64d64 100755
--- a/app/src/main/kotlin/io/homeassistant/companion/android/settings/widgets/views/ManageWidgetsView.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/settings/widgets/views/ManageWidgetsView.kt
@@ -182,7 +182,7 @@ fun ManageWidgetsView(viewModel: ManageWidgetsViewModel) {
     }
 }
 
-private fun <T : WidgetEntity> LazyListScope.widgetItems(
+private fun <T : WidgetEntity<T>> LazyListScope.widgetItems(
     widgetList: List<T>,
     @StringRes title: Int,
     widgetLabel: @Composable (T) -> String,
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiver.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiver.kt
index ef075da739f..b678667006c 100644
--- a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiver.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiver.kt
@@ -11,7 +11,9 @@ import androidx.glance.appwidget.GlanceAppWidgetReceiver
 import androidx.glance.appwidget.updateAll
 import io.homeassistant.companion.android.common.data.integration.Entity
 import io.homeassistant.companion.android.common.data.servers.ServerManager
+import io.homeassistant.companion.android.common.util.FailFast
 import io.homeassistant.companion.android.database.widget.WidgetDao
+import io.homeassistant.companion.android.database.widget.WidgetEntity
 import javax.inject.Inject
 import kotlinx.coroutines.CoroutineExceptionHandler
 import kotlinx.coroutines.CoroutineScope
@@ -33,12 +35,14 @@ private fun newCoroutineScopeProvider(): () -> CoroutineScope {
 data class EntitiesPerServer(val serverId: Int, val entityIds: List<String>)
 
 /**
- * Base class for Glance widgets that update based on entity state changes.
+ * Base class for Glance widgets that handles the persistence in the database of a created widget and update of the
+ * widget based on entity state changes.
  *
  * This class provides the foundational functionality for managing widget updates, handling lifecycle events,
  * and observing entity state changes. It is designed to be extended by specific widget implementations.
  *
  * ### Key Features:
+ * - **Widget entity persistence**: Persist the [WidgetEntity] given while creating the widget using [EXTRA_WIDGET_ENTITY] inside the [DAO].
  * - **Entity state observation**: Watches for updates to specific entities and triggers widget updates accordingly.
  * - **Lifecycle management**: Handles widget lifecycle action [Intent.ACTION_SCREEN_ON], [Intent.ACTION_SCREEN_OFF] and [AppWidgetManager.ACTION_APPWIDGET_UPDATE].
  * - **Real-time updates**: Supports real-time updates for widgets when the user grants the necessary permissions.
@@ -86,7 +90,7 @@ data class EntitiesPerServer(val serverId: Int, val entityIds: List<String>)
  * @param DAO The type of the DAO used for managing widget data in the database. It must implement [WidgetDao] and
  *            be injectable with Hilt.
  */
-abstract class BaseGlanceEntityWidgetReceiver<DAO : WidgetDao> @VisibleForTesting constructor(
+abstract class BaseGlanceEntityWidgetReceiver<T : WidgetEntity<T>, DAO : WidgetDao<T>> @VisibleForTesting constructor(
     private val widgetScopeProvider: () -> CoroutineScope,
     private val glanceManagerProvider: (Context) -> GlanceAppWidgetManager,
 ) : GlanceAppWidgetReceiver() {
@@ -131,6 +135,20 @@ abstract class BaseGlanceEntityWidgetReceiver<DAO : WidgetDao> @VisibleForTestin
                     glanceAppWidget.updateAll(context)
                 }
             }
+            ACTION_APPWIDGET_CREATED -> {
+                if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
+                    FailFast.fail { "Missing appWidgetId in intent to add widget in DAO" }
+                } else {
+                    widgetScope.launch {
+                        // Use deprecated function to not have to specify the class of T
+                        @Suppress("DEPRECATION", "UNCHECKED_CAST")
+                        val entity = intent.getSerializableExtra(EXTRA_WIDGET_ENTITY) as? T
+                        entity?.let {
+                            dao.add(entity.copyWithWidgetId(appWidgetId))
+                        } ?: FailFast.fail { "Missing $EXTRA_WIDGET_ENTITY or it's of the wrong type in intent." }
+                    }
+                }
+            }
         }
     }
 
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseWidgetConfigureActivity.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseWidgetConfigureActivity.kt
index eba49da6d82..5e5d889bbdc 100644
--- a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseWidgetConfigureActivity.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/BaseWidgetConfigureActivity.kt
@@ -22,7 +22,7 @@ abstract class BaseWidgetConfigureActivity : BaseActivity() {
 
     protected var appWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID
 
-    abstract val dao: WidgetDao
+    abstract val dao: WidgetDao<*>
 
     abstract val serverSelect: View
     abstract val serverSelectList: Spinner
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/WidgetIntent.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/WidgetIntent.kt
new file mode 100644
index 00000000000..afb80a35f58
--- /dev/null
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/WidgetIntent.kt
@@ -0,0 +1,18 @@
+package io.homeassistant.companion.android.widgets
+
+/**
+ * Sent when the system has created a widget.
+ *
+ * The intent will contain the following extras:
+ * - [android.appwidget.AppWidgetManager.EXTRA_APPWIDGET_ID] The appWidgetIds of the created widget
+ * - [EXTRA_WIDGET_ENTITY] The WidgetEntity to create inside the application database.
+ *
+ * This action needs to be used when invoking [androidx.glance.appwidget.GlanceAppWidgetManager.requestPinGlanceAppWidget].
+ */
+const val ACTION_APPWIDGET_CREATED = "io.homeassistant.companion.android.widgets.APPWIDGET_CREATED"
+
+/**
+ * Should be a subtype of [io.homeassistant.companion.android.database.widget.WidgetEntity] to inject in the DAO with the
+ * ID of the widget. It will be retrieved using [java.io.Serializable].
+ */
+const val EXTRA_WIDGET_ENTITY = "widget_entity_id_to_update"
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidget.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidget.kt
index a3a940bbbb8..16745ee5f71 100644
--- a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidget.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidget.kt
@@ -4,6 +4,7 @@ import android.content.Context
 import androidx.glance.appwidget.GlanceAppWidget
 import dagger.hilt.android.AndroidEntryPoint
 import io.homeassistant.companion.android.database.widget.TodoWidgetDao
+import io.homeassistant.companion.android.database.widget.TodoWidgetEntity
 import io.homeassistant.companion.android.widgets.BaseGlanceEntityWidgetReceiver
 import io.homeassistant.companion.android.widgets.EntitiesPerServer
 
@@ -17,7 +18,7 @@ import io.homeassistant.companion.android.widgets.EntitiesPerServer
  * Otherwise the widgets won't update at all after the composition ends.
  */
 @AndroidEntryPoint
-class TodoWidget : BaseGlanceEntityWidgetReceiver<TodoWidgetDao>() {
+class TodoWidget : BaseGlanceEntityWidgetReceiver<TodoWidgetEntity, TodoWidgetDao>() {
     override val glanceAppWidget: GlanceAppWidget = TodoGlanceAppWidget()
 
     override suspend fun getWidgetEntitiesByServer(context: Context): Map<Int, EntitiesPerServer> {
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureActivity.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureActivity.kt
index 77d5dce7d06..cf118b313aa 100644
--- a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureActivity.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureActivity.kt
@@ -1,9 +1,7 @@
 package io.homeassistant.companion.android.widgets.todo
 
 import android.annotation.SuppressLint
-import android.app.PendingIntent
 import android.appwidget.AppWidgetManager
-import android.content.Intent
 import android.os.Build
 import android.os.Bundle
 import android.widget.Toast
@@ -34,7 +32,6 @@ import androidx.compose.ui.res.colorResource
 import androidx.compose.ui.res.stringResource
 import androidx.compose.ui.tooling.preview.Preview
 import androidx.compose.ui.unit.dp
-import androidx.glance.appwidget.GlanceAppWidgetManager
 import androidx.lifecycle.compose.collectAsStateWithLifecycle
 import androidx.lifecycle.lifecycleScope
 import dagger.hilt.android.AndroidEntryPoint
@@ -57,15 +54,9 @@ import io.homeassistant.companion.android.util.previewServer2
 import io.homeassistant.companion.android.util.safeBottomWindowInsets
 import io.homeassistant.companion.android.util.safeTopWindowInsets
 import kotlinx.coroutines.launch
-import timber.log.Timber
 
 @AndroidEntryPoint
 class TodoWidgetConfigureActivity : BaseActivity() {
-    companion object {
-        @Suppress("ktlint:standard:max-line-length")
-        private const val PIN_WIDGET_CALLBACK = "io.homeassistant.companion.android.widgets.todo.TodoWidgetConfigureActivity.PIN_WIDGET_CALLBACK"
-    }
-
     private val viewModel: TodoWidgetConfigureViewModel by viewModels()
     private val supportedTextColors: List<String>
         get() = listOf(
@@ -91,31 +82,14 @@ class TodoWidgetConfigureActivity : BaseActivity() {
             HomeAssistantAppTheme {
                 TodoWidgetConfigureScreen(
                     viewModel = viewModel,
-                    onAddWidget = { onSetupWidget() },
+                    onActionClick = { onActionClick() },
                 )
             }
         }
     }
 
-    override fun onNewIntent(intent: Intent) {
-        super.onNewIntent(intent)
-        val extras = intent.extras
-        if (extras == null) {
-            Timber.d("Received new intent without data")
-            return
-        }
-        val widgetId = extras.getInt(
-            AppWidgetManager.EXTRA_APPWIDGET_ID,
-            AppWidgetManager.INVALID_APPWIDGET_ID,
-        )
-        if (extras.getBoolean(PIN_WIDGET_CALLBACK, false)) {
-            viewModel.onSetup(widgetId, supportedTextColors)
-            onAddWidget()
-        }
-    }
-
     @SuppressLint("ObsoleteSdkInt")
-    private fun onSetupWidget() {
+    private fun onActionClick() {
         lifecycleScope.launch {
             if (intent.extras?.getBoolean(ManageWidgetsViewModel.CONFIGURE_REQUEST_LAUNCHER, false) == true) {
                 if (
@@ -127,7 +101,7 @@ class TodoWidgetConfigureActivity : BaseActivity() {
                     showAddWidgetError()
                 }
             } else {
-                onAddWidget()
+                onUpdateWidget()
             }
         }
     }
@@ -137,39 +111,33 @@ class TodoWidgetConfigureActivity : BaseActivity() {
     private fun requestPinWidget() {
         val context = this@TodoWidgetConfigureActivity
         lifecycleScope.launch {
-            GlanceAppWidgetManager(context)
-                .requestPinGlanceAppWidget(
-                    TodoWidget::class.java,
-                    successCallback = PendingIntent.getActivity(
-                        context,
-                        System.currentTimeMillis().toInt(),
-                        Intent(context, TodoWidgetConfigureActivity::class.java)
-                            .putExtra(PIN_WIDGET_CALLBACK, true)
-                            .setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP),
-                        PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_MUTABLE,
-                    ),
-                )
+            viewModel.requestWidgetCreation(context)
+            finish()
         }
     }
 
-    private fun onAddWidget() {
+    private suspend fun onUpdateWidget() {
         try {
-            viewModel.addWidgetConfiguration()
+            viewModel.updateWidgetConfiguration()
             setResult(RESULT_OK)
-            viewModel.updateWidget(this)
+            viewModel.updateWidget(this@TodoWidgetConfigureActivity)
             finish()
-        } catch (_: IllegalStateException) {
-            showAddWidgetError()
+        } catch (_: Exception) {
+            showUpdateWidgetError()
         }
     }
 
     private fun showAddWidgetError() {
         Toast.makeText(applicationContext, R.string.widget_creation_error, Toast.LENGTH_LONG).show()
     }
+
+    private fun showUpdateWidgetError() {
+        Toast.makeText(applicationContext, R.string.widget_update_error, Toast.LENGTH_LONG).show()
+    }
 }
 
 @Composable
-private fun TodoWidgetConfigureScreen(viewModel: TodoWidgetConfigureViewModel, onAddWidget: () -> Unit) {
+private fun TodoWidgetConfigureScreen(viewModel: TodoWidgetConfigureViewModel, onActionClick: () -> Unit) {
     val servers by viewModel.servers.collectAsStateWithLifecycle()
     val entities by viewModel.entities.collectAsStateWithLifecycle()
 
@@ -187,7 +155,7 @@ private fun TodoWidgetConfigureScreen(viewModel: TodoWidgetConfigureViewModel, o
         textColorIndex = viewModel.textColorIndex,
         onTextColorSelected = { viewModel.textColorIndex = it },
         isUpdateWidget = viewModel.isUpdateWidget,
-        onAddWidget = onAddWidget,
+        onActionClick = onActionClick,
     )
 }
 
@@ -206,7 +174,7 @@ private fun TodoWidgetConfigureView(
     textColorIndex: Int,
     onTextColorSelected: (Int) -> Unit,
     isUpdateWidget: Boolean,
-    onAddWidget: () -> Unit,
+    onActionClick: () -> Unit,
 ) {
     Scaffold(
         topBar = {
@@ -285,7 +253,7 @@ private fun TodoWidgetConfigureView(
 
             Button(
                 modifier = Modifier.fillMaxWidth(),
-                onClick = { onAddWidget() },
+                onClick = { onActionClick() },
             ) {
                 Text(stringResource(if (isUpdateWidget) R.string.update_widget else R.string.add_widget))
             }
@@ -317,7 +285,7 @@ private fun TodoWidgetConfigureViewPreview() {
             textColorIndex = 0,
             onTextColorSelected = {},
             isUpdateWidget = true,
-            onAddWidget = {},
+            onActionClick = {},
         )
     }
 }
diff --git a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureViewModel.kt b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureViewModel.kt
index ed5a1be8c37..681b1473d44 100644
--- a/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureViewModel.kt
+++ b/app/src/main/kotlin/io/homeassistant/companion/android/widgets/todo/TodoWidgetConfigureViewModel.kt
@@ -1,7 +1,9 @@
 package io.homeassistant.companion.android.widgets.todo
 
+import android.app.PendingIntent
 import android.appwidget.AppWidgetManager
 import android.content.Context
+import android.content.Intent
 import androidx.compose.runtime.getValue
 import androidx.compose.runtime.mutableIntStateOf
 import androidx.compose.runtime.mutableStateOf
@@ -20,6 +22,8 @@ import io.homeassistant.companion.android.common.data.servers.ServerManager
 import io.homeassistant.companion.android.database.widget.TodoWidgetDao
 import io.homeassistant.companion.android.database.widget.TodoWidgetEntity
 import io.homeassistant.companion.android.database.widget.WidgetBackgroundType
+import io.homeassistant.companion.android.widgets.ACTION_APPWIDGET_CREATED
+import io.homeassistant.companion.android.widgets.EXTRA_WIDGET_ENTITY
 import javax.inject.Inject
 import kotlin.time.Duration.Companion.milliseconds
 import kotlinx.coroutines.ExperimentalCoroutinesApi
@@ -27,7 +31,10 @@ import kotlinx.coroutines.flow.SharingStarted
 import kotlinx.coroutines.flow.StateFlow
 import kotlinx.coroutines.flow.WhileSubscribed
 import kotlinx.coroutines.flow.distinctUntilChanged
+import kotlinx.coroutines.flow.drop
+import kotlinx.coroutines.flow.first
 import kotlinx.coroutines.flow.mapLatest
+import kotlinx.coroutines.flow.onStart
 import kotlinx.coroutines.flow.stateIn
 import kotlinx.coroutines.launch
 import timber.log.Timber
@@ -101,49 +108,81 @@ class TodoWidgetConfigureViewModel @Inject constructor(
             selectedEntityId in entities.value.map { it.entityId }
     }
 
-    fun addWidgetConfiguration() {
-        viewModelScope.launch {
-            if (!isValidSelection()) {
-                Timber.d("Widget data is invalid")
-                throw IllegalArgumentException("Widget data is invalid")
-            }
-            if (widgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
-                Timber.w("Widget ID is invalid")
-                throw IllegalArgumentException("Widget ID is invalid")
-            }
+    suspend fun updateWidgetConfiguration() {
+        if (!isValidSelection()) {
+            Timber.d("Widget data is invalid")
+            throw IllegalArgumentException("Widget data is invalid")
+        }
+        if (widgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
+            Timber.w("Widget ID is invalid")
+            throw IllegalArgumentException("Widget ID is invalid")
+        }
 
-            val textColor = if (selectedBackgroundType == WidgetBackgroundType.TRANSPARENT) {
-                supportedTextColors.getOrNull(textColorIndex) ?: supportedTextColors.first()
-            } else {
-                ""
-            }
+        val entity = getPendingDaoEntity()
+        todoWidgetDao.add(entity)
+    }
+
+    /**
+     * Return a [TodoWidgetEntity] with the current selection, but without pushing this to the [todoWidgetDao]
+     */
+    private suspend fun getPendingDaoEntity(): TodoWidgetEntity {
+        val textColor = if (selectedBackgroundType == WidgetBackgroundType.TRANSPARENT) {
+            supportedTextColors.getOrNull(textColorIndex) ?: supportedTextColors.first()
+        } else {
+            ""
+        }
+        val listEntityId = selectedEntityId!!
+        val integrationRepository = serverManager.integrationRepository(selectedServerId)
+        val webSocketRepository = serverManager.webSocketRepository(selectedServerId)
+        val name = integrationRepository.getEntity(listEntityId)?.friendlyName
+        val todos = webSocketRepository.getTodos(listEntityId)?.response?.get(listEntityId)?.items.orEmpty()
 
-            val listEntityId = selectedEntityId!!
-            val integrationRepository = serverManager.integrationRepository(selectedServerId)
-            val webSocketRepository = serverManager.webSocketRepository(selectedServerId)
-            val name = integrationRepository.getEntity(listEntityId)?.friendlyName
-            val todos = webSocketRepository.getTodos(listEntityId)?.response?.get(listEntityId)?.items.orEmpty()
-            todoWidgetDao.add(
-                TodoWidgetEntity(
-                    id = widgetId,
-                    serverId = selectedServerId,
-                    entityId = selectedEntityId!!,
-                    backgroundType = selectedBackgroundType,
-                    textColor = textColor,
-                    showCompleted = showCompletedState,
-                    latestUpdateData = TodoWidgetEntity.LastUpdateData(
-                        entityName = name,
-                        todos = todos.map {
-                            TodoWidgetEntity.TodoItem(
-                                uid = it.uid,
-                                summary = it.summary,
-                                status = it.status,
-                            )
+        return TodoWidgetEntity(
+            id = widgetId,
+            serverId = selectedServerId,
+            entityId = selectedEntityId!!,
+            backgroundType = selectedBackgroundType,
+            textColor = textColor,
+            showCompleted = showCompletedState,
+            latestUpdateData = TodoWidgetEntity.LastUpdateData(
+                entityName = name,
+                todos = todos.map {
+                    TodoWidgetEntity.TodoItem(
+                        uid = it.uid,
+                        summary = it.summary,
+                        status = it.status,
+                    )
+                },
+            ),
+        )
+    }
+
+    /**
+     * Requests the widget to be created and waits until it has been saved to the DAO.
+     *
+     * **WARNING**: This function does not handle user cancellation. If a user cancels the widget creation,
+     * this function will not return. If this function is called again and the user does not cancel,
+     * both calls to the function will return. While this behavior could be avoided,
+     * it does not cause issues in the current implementation as returning multiple times has no adverse effects.
+     */
+    suspend fun requestWidgetCreation(context: Context) {
+        // We drop the first value since we only care about knowing when the widget is actually added
+        todoWidgetDao.getWidgetCountFlow().drop(1).onStart {
+            GlanceAppWidgetManager(context)
+                .requestPinGlanceAppWidget(
+                    TodoWidget::class.java,
+                    successCallback = PendingIntent.getBroadcast(
+                        context,
+                        System.currentTimeMillis().toInt(),
+                        Intent(context, TodoWidget::class.java).apply {
+                            action = ACTION_APPWIDGET_CREATED
+                            putExtra(EXTRA_WIDGET_ENTITY, getPendingDaoEntity())
                         },
+                        // We need the PendingIntent to be mutable so the system inject the EXTRA_APPWIDGET_ID of the created widget
+                        PendingIntent.FLAG_MUTABLE,
                     ),
-                ),
-            )
-        }
+                )
+        }.first()
     }
 
     fun updateWidget(context: Context) {
diff --git a/app/src/test/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiverTest.kt b/app/src/test/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiverTest.kt
index 18e17f3d9a3..7f680452b24 100644
--- a/app/src/test/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiverTest.kt
+++ b/app/src/test/kotlin/io/homeassistant/companion/android/widgets/BaseGlanceEntityWidgetReceiverTest.kt
@@ -10,7 +10,9 @@ import androidx.glance.appwidget.updateAll
 import io.homeassistant.companion.android.common.data.integration.Entity
 import io.homeassistant.companion.android.common.data.integration.IntegrationRepository
 import io.homeassistant.companion.android.common.data.servers.ServerManager
-import io.homeassistant.companion.android.database.widget.WidgetDao
+import io.homeassistant.companion.android.common.util.FailFast
+import io.homeassistant.companion.android.database.widget.TodoWidgetDao
+import io.homeassistant.companion.android.database.widget.TodoWidgetEntity
 import io.homeassistant.companion.android.testing.unit.ConsoleLogTree
 import io.mockk.Called
 import io.mockk.coEvery
@@ -42,7 +44,7 @@ private data class FakeGlanceId(val id: Int) : GlanceId
 @OptIn(ExperimentalCoroutinesApi::class)
 class BaseGlanceEntityWidgetReceiverTest {
 
-    val mockedDao: WidgetDao = mockk()
+    val mockedDao: TodoWidgetDao = mockk()
     val mockedServerManager: ServerManager = mockk()
     val mockedWidget: GlanceAppWidget = mockk()
     val glanceManager: GlanceAppWidgetManager = mockk()
@@ -51,8 +53,8 @@ class BaseGlanceEntityWidgetReceiverTest {
         widgetEntitiesByServer: Map<Int, EntitiesPerServer> = emptyMap<Int, EntitiesPerServer>(),
         coroutineScopeProvider: () -> CoroutineScope = { this },
         onEntityUpdateCallback: suspend (Context, Int, Entity) -> Unit = { _, _, _ -> },
-    ): BaseGlanceEntityWidgetReceiver<WidgetDao> {
-        return object : BaseGlanceEntityWidgetReceiver<WidgetDao>(widgetScopeProvider = coroutineScopeProvider, glanceManagerProvider = { glanceManager }) {
+    ): BaseGlanceEntityWidgetReceiver<TodoWidgetEntity, TodoWidgetDao> {
+        return object : BaseGlanceEntityWidgetReceiver<TodoWidgetEntity, TodoWidgetDao>(widgetScopeProvider = coroutineScopeProvider, glanceManagerProvider = { glanceManager }) {
             override suspend fun getWidgetEntitiesByServer(context: Context): Map<Int, EntitiesPerServer> = widgetEntitiesByServer
             override val glanceAppWidget: GlanceAppWidget = mockedWidget
             override suspend fun onEntityUpdate(context: Context, appWidgetId: Int, entity: Entity) {
@@ -242,4 +244,60 @@ class BaseGlanceEntityWidgetReceiverTest {
 
         assertFalse(producer.isActive)
     }
+
+    @Test
+    fun `Given valid intent with ACTION_APPWIDGET_CREATED when onReceive is called then persist WidgetEntity in DAO`() = runTest {
+        val receiver = getReceiver()
+        val context: Context = mockk()
+        val appWidgetId = 42
+        val intent = mockIntent(ACTION_APPWIDGET_CREATED, appWidgetId)
+        val rawEntity = TodoWidgetEntity(-1, 43, "entity")
+        val updatedEntity = TodoWidgetEntity(42, 43, "entity")
+
+        every { intent.getSerializableExtra(EXTRA_WIDGET_ENTITY) } returns rawEntity
+        coJustRun { mockedDao.add(updatedEntity) }
+
+        receiver.onReceive(context, intent)
+
+        advanceUntilIdle()
+
+        coVerify(exactly = 1) { mockedDao.add(updatedEntity) }
+    }
+
+    @Test
+    fun `Given intent with ACTION_APPWIDGET_CREATED without EXTRA_WIDGET_ENTITY when onReceive is called then do nothing`() = runTest {
+        FailFast.setHandler { _, _ ->
+            // No-op
+        }
+        val receiver = getReceiver()
+        val context: Context = mockk()
+        val appWidgetId = 42
+        val intent = mockIntent(ACTION_APPWIDGET_CREATED, appWidgetId)
+
+        every { intent.getSerializableExtra(EXTRA_WIDGET_ENTITY) } returns null
+
+        receiver.onReceive(context, intent)
+
+        advanceUntilIdle()
+
+        coVerify(exactly = 0) { mockedDao wasNot Called }
+    }
+
+    @Test
+    fun `Given intent with ACTION_APPWIDGET_CREATED without EXTRA_APPWIDGET_ID when onReceive is called then do nothing`() = runTest {
+        FailFast.setHandler { _, _ ->
+            // No-op
+        }
+        val receiver = getReceiver()
+        val context: Context = mockk()
+        val intent = mockIntent(ACTION_APPWIDGET_CREATED)
+
+        every { intent.getSerializableExtra(EXTRA_WIDGET_ENTITY) } returns null
+
+        receiver.onReceive(context, intent)
+
+        advanceUntilIdle()
+
+        coVerify(exactly = 0) { mockedDao wasNot Called }
+    }
 }
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetDao.kt
index 030eebe5e13..890d679e03d 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetDao.kt
@@ -7,13 +7,12 @@ import androidx.room.Query
 import kotlinx.coroutines.flow.Flow
 
 @Dao
-interface ButtonWidgetDao : WidgetDao {
-
+interface ButtonWidgetDao : WidgetDao<ButtonWidgetEntity> {
     @Query("SELECT * FROM button_widgets WHERE id = :id")
     suspend fun get(id: Int): ButtonWidgetEntity?
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(buttonWidgetEntity: ButtonWidgetEntity)
+    override suspend fun add(entity: ButtonWidgetEntity)
 
     @Query("DELETE FROM button_widgets WHERE id = :id")
     override suspend fun delete(id: Int)
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetEntity.kt
index 69b3417c0b6..f885f3ac34b 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/ButtonWidgetEntity.kt
@@ -26,5 +26,9 @@ data class ButtonWidgetEntity(
     override val textColor: String? = null,
     @ColumnInfo(name = "require_authentication", defaultValue = "0")
     val requireAuthentication: Boolean,
-) : WidgetEntity,
-    ThemeableWidgetEntity
+) : WidgetEntity<ButtonWidgetEntity>,
+    ThemeableWidgetEntity {
+    override fun copyWithWidgetId(appWidgetId: Int): ButtonWidgetEntity {
+        return copy(id = appWidgetId)
+    }
+}
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetDao.kt
index e638d8814be..b42c0e801aa 100755
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetDao.kt
@@ -7,13 +7,13 @@ import androidx.room.Query
 import kotlinx.coroutines.flow.Flow
 
 @Dao
-interface CameraWidgetDao : WidgetDao {
+interface CameraWidgetDao : WidgetDao<CameraWidgetEntity> {
 
     @Query("SELECT * FROM camera_widgets WHERE id = :id")
     suspend fun get(id: Int): CameraWidgetEntity?
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(cameraWidgetEntity: CameraWidgetEntity)
+    override suspend fun add(entity: CameraWidgetEntity)
 
     @Query("DELETE FROM camera_widgets WHERE id = :id")
     override suspend fun delete(id: Int)
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetEntity.kt
index 9ffbf00e23f..e643d6dc38a 100755
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/CameraWidgetEntity.kt
@@ -14,4 +14,8 @@ data class CameraWidgetEntity(
     val entityId: String,
     @ColumnInfo(name = "tap_action", defaultValue = "REFRESH")
     val tapAction: WidgetTapAction,
-) : WidgetEntity
+) : WidgetEntity<CameraWidgetEntity> {
+    override fun copyWithWidgetId(appWidgetId: Int): CameraWidgetEntity {
+        return copy(id = appWidgetId)
+    }
+}
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetDao.kt
index 22235322177..823919c9bb3 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetDao.kt
@@ -7,13 +7,12 @@ import androidx.room.Query
 import kotlinx.coroutines.flow.Flow
 
 @Dao
-interface MediaPlayerControlsWidgetDao : WidgetDao {
-
+interface MediaPlayerControlsWidgetDao : WidgetDao<MediaPlayerControlsWidgetEntity> {
     @Query("SELECT * FROM media_player_controls_widgets WHERE id = :id")
     suspend fun get(id: Int): MediaPlayerControlsWidgetEntity?
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(mediaPlayCtrlWidgetEntity: MediaPlayerControlsWidgetEntity)
+    override suspend fun add(entity: MediaPlayerControlsWidgetEntity)
 
     @Query("DELETE FROM media_player_controls_widgets WHERE id = :id")
     override suspend fun delete(id: Int)
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetEntity.kt
index 9e25826e48c..703e128899d 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/MediaPlayerControlsWidgetEntity.kt
@@ -26,5 +26,9 @@ data class MediaPlayerControlsWidgetEntity(
     override val backgroundType: WidgetBackgroundType = WidgetBackgroundType.DAYNIGHT,
     @ColumnInfo(name = "text_color")
     override val textColor: String? = null,
-) : WidgetEntity,
-    ThemeableWidgetEntity
+) : WidgetEntity<MediaPlayerControlsWidgetEntity>,
+    ThemeableWidgetEntity {
+    override fun copyWithWidgetId(appWidgetId: Int): MediaPlayerControlsWidgetEntity {
+        return copy(id = appWidgetId)
+    }
+}
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetDao.kt
index 0dc7af84390..cfee7d24c3f 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetDao.kt
@@ -7,13 +7,13 @@ import androidx.room.Query
 import kotlinx.coroutines.flow.Flow
 
 @Dao
-interface StaticWidgetDao : WidgetDao {
+interface StaticWidgetDao : WidgetDao<StaticWidgetEntity> {
 
     @Query("SELECT * FROM static_widget WHERE id = :id")
     suspend fun get(id: Int): StaticWidgetEntity?
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(staticWidgetEntity: StaticWidgetEntity)
+    override suspend fun add(entity: StaticWidgetEntity)
 
     @Query("DELETE FROM static_widget WHERE id = :id")
     override suspend fun delete(id: Int)
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetEntity.kt
index d35e182d44e..3db424f7d3f 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/StaticWidgetEntity.kt
@@ -30,5 +30,9 @@ data class StaticWidgetEntity(
     override val backgroundType: WidgetBackgroundType = WidgetBackgroundType.DAYNIGHT,
     @ColumnInfo(name = "text_color")
     override val textColor: String? = null,
-) : WidgetEntity,
-    ThemeableWidgetEntity
+) : WidgetEntity<StaticWidgetEntity>,
+    ThemeableWidgetEntity {
+    override fun copyWithWidgetId(appWidgetId: Int): StaticWidgetEntity {
+        return copy(id = appWidgetId)
+    }
+}
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt
index 8eeb6c2e249..8b8c4536d01 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetDao.kt
@@ -7,13 +7,13 @@ import androidx.room.Query
 import kotlinx.coroutines.flow.Flow
 
 @Dao
-interface TemplateWidgetDao : WidgetDao {
+interface TemplateWidgetDao : WidgetDao<TemplateWidgetEntity> {
 
     @Query("SELECT * FROM template_widgets WHERE id = :id")
     suspend fun get(id: Int): TemplateWidgetEntity?
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(templateWidgetEntity: TemplateWidgetEntity)
+    override suspend fun add(entity: TemplateWidgetEntity)
 
     @Query("DELETE FROM template_widgets WHERE id = :id")
     override suspend fun delete(id: Int)
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt
index 1dfd71b54cb..12473e01dc8 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TemplateWidgetEntity.kt
@@ -20,5 +20,9 @@ data class TemplateWidgetEntity(
     override val backgroundType: WidgetBackgroundType = WidgetBackgroundType.DAYNIGHT,
     @ColumnInfo(name = "text_color")
     override val textColor: String? = null,
-) : WidgetEntity,
-    ThemeableWidgetEntity
+) : WidgetEntity<TemplateWidgetEntity>,
+    ThemeableWidgetEntity {
+    override fun copyWithWidgetId(appWidgetId: Int): TemplateWidgetEntity {
+        return copy(id = appWidgetId)
+    }
+}
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetDao.kt
index 215f83f5e84..3c362eaf15a 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetDao.kt
@@ -10,7 +10,7 @@ import kotlinx.coroutines.flow.Flow
 
 @Dao
 @TypeConverters(TodoLastUpdateDataConverter::class)
-interface TodoWidgetDao : WidgetDao {
+interface TodoWidgetDao : WidgetDao<TodoWidgetEntity> {
 
     @Query("SELECT * FROM todo_widget WHERE id = :id")
     suspend fun get(id: Int): TodoWidgetEntity?
@@ -22,7 +22,7 @@ interface TodoWidgetDao : WidgetDao {
     suspend fun getAll(): List<TodoWidgetEntity>
 
     @Insert(onConflict = OnConflictStrategy.REPLACE)
-    suspend fun add(todoWidgetEntity: TodoWidgetEntity)
+    override suspend fun add(entity: TodoWidgetEntity)
 
     @Query("DELETE FROM todo_widget WHERE id = :id")
     override suspend fun delete(id: Int)
@@ -35,4 +35,7 @@ interface TodoWidgetDao : WidgetDao {
 
     @Query("UPDATE todo_widget SET latest_update_data = :lastUpdateData WHERE id = :widgetId")
     suspend fun updateWidgetLastUpdate(widgetId: Int, lastUpdateData: TodoWidgetEntity.LastUpdateData)
+
+    @Query("SELECT COUNT(*) FROM todo_widget")
+    fun getWidgetCountFlow(): Flow<Int>
 }
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetEntity.kt
index ac5604b3a38..d1d34e2dd2c 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/TodoWidgetEntity.kt
@@ -25,7 +25,7 @@ data class TodoWidgetEntity(
     @ColumnInfo(name = "show_completed", defaultValue = "true")
     val showCompleted: Boolean = true,
     @ColumnInfo(name = "latest_update_data") val latestUpdateData: LastUpdateData? = null,
-) : WidgetEntity,
+) : WidgetEntity<TodoWidgetEntity>,
     ThemeableWidgetEntity {
 
     @Serializable
@@ -35,10 +35,11 @@ data class TodoWidgetEntity(
         @JsonNames("entityName")
         val entityName: String? = null,
         val todos: List<TodoItem>,
-    )
+    ) : java.io.Serializable
 
     @Serializable
-    data class TodoItem(val uid: String? = null, val summary: String? = null, val status: String? = null)
+    data class TodoItem(val uid: String? = null, val summary: String? = null, val status: String? = null) :
+        java.io.Serializable
 
     fun isSameConfiguration(other: TodoWidgetEntity): Boolean {
         /**
@@ -48,4 +49,8 @@ data class TodoWidgetEntity(
          */
         return other.copy(latestUpdateData = null) == this.copy(latestUpdateData = null)
     }
+
+    override fun copyWithWidgetId(appWidgetId: Int): TodoWidgetEntity {
+        return copy(id = appWidgetId)
+    }
 }
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetDao.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetDao.kt
index 747feb6f338..1ec027dab92 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetDao.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetDao.kt
@@ -1,6 +1,7 @@
 package io.homeassistant.companion.android.database.widget
 
-interface WidgetDao {
+interface WidgetDao<T : WidgetEntity<T>> {
+    suspend fun add(entity: T)
     suspend fun delete(id: Int)
     suspend fun deleteAll(ids: IntArray)
 }
diff --git a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetEntity.kt b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetEntity.kt
index dafd23fe02a..fe10be900c9 100644
--- a/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetEntity.kt
+++ b/common/src/main/kotlin/io/homeassistant/companion/android/database/widget/WidgetEntity.kt
@@ -1,6 +1,10 @@
 package io.homeassistant.companion.android.database.widget
 
-interface WidgetEntity {
+import java.io.Serializable
+
+sealed interface WidgetEntity<T : WidgetEntity<T>> : Serializable {
     val id: Int
     val serverId: Int
+
+    fun copyWithWidgetId(appWidgetId: Int): T
 }
diff --git a/common/src/main/res/values/strings.xml b/common/src/main/res/values/strings.xml
index cb3f28aedac..642dd180a96 100644
--- a/common/src/main/res/values/strings.xml
+++ b/common/src/main/res/values/strings.xml
@@ -1104,6 +1104,7 @@
     <string name="widget_text_color_label">Widget text color:</string>
     <string name="widget_text_color_label_icon">Widget text/icon color:</string>
     <string name="widget_text_color_white">White</string>
+    <string name="widget_update_error">Unable to update widget.</string>
     <string name="widgets">Widgets</string>
     <string name="zone_event_failure">Unable to send zone event to Home Assistant</string>
     <string name="companion_app">Companion app</string>
