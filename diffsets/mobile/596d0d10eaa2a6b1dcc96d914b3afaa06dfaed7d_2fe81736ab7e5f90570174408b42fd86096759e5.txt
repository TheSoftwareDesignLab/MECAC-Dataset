diff --git a/lib/src/view/analysis/analysis_layout.dart b/lib/src/view/analysis/analysis_layout.dart
index 80f76e7595..cda6f0b664 100644
--- a/lib/src/view/analysis/analysis_layout.dart
+++ b/lib/src/view/analysis/analysis_layout.dart
@@ -4,6 +4,7 @@ import 'package:lichess_mobile/src/constants.dart';
 import 'package:lichess_mobile/src/styles/lichess_icons.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/screen.dart';
+import 'package:lichess_mobile/src/view/engine/engine_gauge.dart';
 import 'package:lichess_mobile/src/widgets/adaptive_action_sheet.dart';
 import 'package:lichess_mobile/src/widgets/buttons.dart';
 import 'package:lichess_mobile/src/widgets/platform.dart';
@@ -145,52 +146,53 @@ class AnalysisLayout extends StatelessWidget {
         Expanded(
           child: SafeArea(
             bottom: false,
-            child: LayoutBuilder(
-              builder: (context, constraints) {
-                final aspectRatio = constraints.biggest.aspectRatio;
-                final defaultBoardSize = constraints.biggest.shortestSide;
+            child: OrientationBuilder(
+              builder: (context, orientation) {
                 final isTablet = isTabletOrLarger(context);
-                final remainingHeight =
-                    constraints.maxHeight - defaultBoardSize;
-                final isSmallScreen =
-                    remainingHeight < kSmallRemainingHeightLeftBoardThreshold;
-                final boardSize = isTablet || isSmallScreen
-                    ? defaultBoardSize - kTabletBoardTableSidePadding * 2
-                    : defaultBoardSize;
-
                 const tabletBoardRadius =
                     BorderRadius.all(Radius.circular(4.0));
 
-                // If the aspect ratio is greater than 1, we are in landscape mode.
-                if (aspectRatio > 1) {
+                if (orientation == Orientation.landscape) {
                   return Row(
                     mainAxisSize: MainAxisSize.max,
                     children: [
-                      Padding(
-                        padding: const EdgeInsets.only(
-                          left: kTabletBoardTableSidePadding,
-                          top: kTabletBoardTableSidePadding,
-                          bottom: kTabletBoardTableSidePadding,
-                        ),
-                        child: Row(
-                          children: [
-                            boardBuilder(
-                              context,
-                              boardSize,
-                              isTablet ? tabletBoardRadius : null,
-                            ),
-                            if (engineGaugeBuilder != null) ...[
-                              const SizedBox(width: 4.0),
-                              engineGaugeBuilder!(
-                                context,
-                                Orientation.landscape,
-                              ),
-                            ],
-                          ],
+                      Expanded(
+                        flex: kFlexGoldenRatio,
+                        child: Padding(
+                          padding: const EdgeInsets.only(
+                            left: kTabletBoardTableSidePadding,
+                            top: kTabletBoardTableSidePadding,
+                            bottom: kTabletBoardTableSidePadding,
+                          ),
+                          child: LayoutBuilder(
+                            builder: (context, constraints) {
+                              final boardSize =
+                                  constraints.biggest.shortestSide -
+                                      (engineGaugeBuilder != null
+                                          ? kEvalGaugeSize + 4.0
+                                          : 0);
+                              return Row(
+                                children: [
+                                  boardBuilder(
+                                    context,
+                                    boardSize,
+                                    isTablet ? tabletBoardRadius : null,
+                                  ),
+                                  if (engineGaugeBuilder != null) ...[
+                                    const SizedBox(width: 4.0),
+                                    engineGaugeBuilder!(
+                                      context,
+                                      Orientation.landscape,
+                                    ),
+                                  ],
+                                ],
+                              );
+                            },
+                          ),
                         ),
                       ),
                       Flexible(
-                        fit: FlexFit.loose,
+                        flex: kFlexGoldenRatioBase,
                         child: Column(
                           mainAxisAlignment: MainAxisAlignment.start,
                           children: [
@@ -224,47 +226,57 @@ class AnalysisLayout extends StatelessWidget {
                       ),
                     ],
                   );
-                }
-                // If the aspect ratio is less than 1, we are in portrait mode.
-                else {
-                  return Column(
-                    mainAxisAlignment: MainAxisAlignment.center,
-                    mainAxisSize: MainAxisSize.max,
-                    crossAxisAlignment: CrossAxisAlignment.center,
-                    children: [
-                      if (engineGaugeBuilder != null)
-                        engineGaugeBuilder!(
-                          context,
-                          Orientation.portrait,
-                        ),
-                      if (engineLines != null) engineLines!,
-                      if (isTablet)
-                        Padding(
-                          padding: const EdgeInsets.all(
-                            kTabletBoardTableSidePadding,
-                          ),
-                          child: boardBuilder(
-                            context,
-                            boardSize,
-                            tabletBoardRadius,
+                } else {
+                  return LayoutBuilder(
+                    builder: (context, constraints) {
+                      final defaultBoardSize = constraints.biggest.shortestSide;
+                      final remainingHeight =
+                          constraints.maxHeight - defaultBoardSize;
+                      final isSmallScreen = remainingHeight <
+                          kSmallRemainingHeightLeftBoardThreshold;
+                      final boardSize = isTablet || isSmallScreen
+                          ? defaultBoardSize - kTabletBoardTableSidePadding * 2
+                          : defaultBoardSize;
+
+                      return Column(
+                        mainAxisAlignment: MainAxisAlignment.center,
+                        mainAxisSize: MainAxisSize.max,
+                        crossAxisAlignment: CrossAxisAlignment.center,
+                        children: [
+                          if (engineGaugeBuilder != null)
+                            engineGaugeBuilder!(
+                              context,
+                              Orientation.portrait,
+                            ),
+                          if (engineLines != null) engineLines!,
+                          Padding(
+                            padding: isTablet
+                                ? const EdgeInsets.all(
+                                    kTabletBoardTableSidePadding,
+                                  )
+                                : EdgeInsets.zero,
+                            child: boardBuilder(
+                              context,
+                              boardSize,
+                              tabletBoardRadius,
+                            ),
                           ),
-                        )
-                      else
-                        boardBuilder(context, boardSize, null),
-                      Expanded(
-                        child: Padding(
-                          padding: isTablet
-                              ? const EdgeInsets.symmetric(
-                                  horizontal: kTabletBoardTableSidePadding,
-                                )
-                              : EdgeInsets.zero,
-                          child: TabBarView(
-                            controller: tabController,
-                            children: children,
+                          Expanded(
+                            child: Padding(
+                              padding: isTablet
+                                  ? const EdgeInsets.symmetric(
+                                      horizontal: kTabletBoardTableSidePadding,
+                                    )
+                                  : EdgeInsets.zero,
+                              child: TabBarView(
+                                controller: tabController,
+                                children: children,
+                              ),
+                            ),
                           ),
-                        ),
-                      ),
-                    ],
+                        ],
+                      );
+                    },
                   );
                 }
               },
diff --git a/lib/src/view/puzzle/puzzle_tab_screen.dart b/lib/src/view/puzzle/puzzle_tab_screen.dart
index a8d4e61ba2..43645c36b5 100644
--- a/lib/src/view/puzzle/puzzle_tab_screen.dart
+++ b/lib/src/view/puzzle/puzzle_tab_screen.dart
@@ -62,7 +62,6 @@ Widget _buildMainListItem(
   int index,
   Animation<double> animation,
   PuzzleAngle Function(int index) getAngle,
-  VoidCallback? onGoingBackFromPuzzleScreen,
 ) {
   switch (index) {
     case 0:
@@ -91,7 +90,7 @@ Widget _buildMainListItem(
             builder: (context) => const PuzzleScreen(
               angle: PuzzleTheme(PuzzleThemeKey.mix),
             ),
-          ).then((_) => onGoingBackFromPuzzleScreen?.call());
+          );
         },
       );
     default:
@@ -103,7 +102,7 @@ Widget _buildMainListItem(
             context,
             rootNavigator: true,
             builder: (context) => PuzzleScreen(angle: angle),
-          ).then((_) => onGoingBackFromPuzzleScreen?.call());
+          );
         },
       );
   }
@@ -187,12 +186,6 @@ class _CupertinoTabBodyState extends ConsumerState<_CupertinoTabBody> {
           index,
           animation,
           (index) => _angles[index],
-          isTablet
-              ? () {
-                  ref.read(currentBottomTabProvider.notifier).state =
-                      BottomTab.home;
-                }
-              : null,
         );
 
     if (isTablet) {
@@ -352,12 +345,6 @@ class _MaterialTabBodyState extends ConsumerState<_MaterialTabBody> {
           index,
           animation,
           (index) => _angles[index],
-          isTablet
-              ? () {
-                  ref.read(currentBottomTabProvider.notifier).state =
-                      BottomTab.home;
-                }
-              : null,
         );
 
     return PopScope(
diff --git a/lib/src/widgets/board_table.dart b/lib/src/widgets/board_table.dart
index 0f01a91920..34e34fb8d6 100644
--- a/lib/src/widgets/board_table.dart
+++ b/lib/src/widgets/board_table.dart
@@ -130,21 +130,10 @@ class _BoardTableState extends ConsumerState<BoardTable> {
   Widget build(BuildContext context) {
     final boardPrefs = ref.watch(boardPreferencesProvider);
 
-    return LayoutBuilder(
-      builder: (context, constraints) {
-        final aspectRatio = constraints.biggest.aspectRatio;
-        final defaultBoardSize = constraints.biggest.shortestSide;
+    return OrientationBuilder(
+      builder: (context, orientation) {
         final isTablet = isTabletOrLarger(context);
 
-        final double boardSize = isTablet
-            ? defaultBoardSize - kTabletBoardTableSidePadding * 2
-            : defaultBoardSize;
-
-        // vertical space left on portrait mode to check if we can display the
-        // move list
-        final verticalSpaceLeftBoardOnPortrait =
-            constraints.biggest.height - boardSize;
-
         final defaultSettings = boardPrefs.toBoardSettings().copyWith(
               borderRadius: isTablet
                   ? const BorderRadius.all(Radius.circular(4.0))
@@ -163,35 +152,9 @@ class _BoardTableState extends ConsumerState<BoardTable> {
             : defaultSettings;
 
         final shapes = userShapes.union(widget.shapes ?? ISet());
-
-        final error = widget.errorMessage != null
-            ? SizedBox.square(
-                dimension: boardSize,
-                child: Center(
-                  child: Padding(
-                    padding: const EdgeInsets.all(16.0),
-                    child: Container(
-                      decoration: BoxDecoration(
-                        color: Theme.of(context).platform == TargetPlatform.iOS
-                            ? CupertinoColors.secondarySystemBackground
-                                .resolveFrom(context)
-                            : Theme.of(context).colorScheme.surface,
-                        borderRadius:
-                            const BorderRadius.all(Radius.circular(10.0)),
-                      ),
-                      child: Padding(
-                        padding: const EdgeInsets.all(10.0),
-                        child: Text(widget.errorMessage!),
-                      ),
-                    ),
-                  ),
-                ),
-              )
-            : null;
-
         final slicedMoves = widget.moves?.asMap().entries.slices(2);
 
-        return aspectRatio >= 1.0
+        return orientation == Orientation.landscape
             ? Row(
                 mainAxisSize: MainAxisSize.max,
                 children: [
@@ -225,7 +188,7 @@ class _BoardTableState extends ConsumerState<BoardTable> {
                                 settings: settings,
                                 boardKey: widget.boardKey ?? GlobalKey(),
                                 boardOverlay: widget.boardOverlay,
-                                error: error,
+                                error: widget.errorMessage,
                               ),
                               if (widget.engineGauge != null)
                                 EngineGauge(
@@ -242,7 +205,6 @@ class _BoardTableState extends ConsumerState<BoardTable> {
                   ),
                   Flexible(
                     flex: kFlexGoldenRatioBase,
-                    fit: FlexFit.loose,
                     child: Padding(
                       padding: isTablet
                           ? const EdgeInsets.all(kTabletBoardTableSidePadding)
@@ -274,68 +236,89 @@ class _BoardTableState extends ConsumerState<BoardTable> {
                   ),
                 ],
               )
-            : Column(
-                mainAxisSize: MainAxisSize.max,
-                mainAxisAlignment: MainAxisAlignment.center,
-                children: [
-                  if (!widget.zenMode &&
-                      slicedMoves != null &&
-                      verticalSpaceLeftBoardOnPortrait >= 130)
-                    MoveList(
-                      type: MoveListType.inline,
-                      slicedMoves: slicedMoves,
-                      currentMoveIndex: widget.currentMoveIndex ?? 0,
-                      onSelectMove: widget.onSelectMove,
-                    )
-                  else if (widget.showMoveListPlaceholder &&
-                      verticalSpaceLeftBoardOnPortrait >= 130)
-                    const SizedBox(height: 40),
-                  Expanded(
-                    child: Padding(
-                      padding: EdgeInsets.symmetric(
-                        horizontal:
-                            isTablet ? kTabletBoardTableSidePadding : 12.0,
+            : LayoutBuilder(
+                builder: (context, constraints) {
+                  final defaultBoardSize = constraints.biggest.shortestSide;
+                  final double boardSize = isTablet
+                      ? defaultBoardSize - kTabletBoardTableSidePadding * 2
+                      : defaultBoardSize;
+
+                  // vertical space left on portrait mode to check if we can display the
+                  // move list
+                  final verticalSpaceLeftBoardOnPortrait =
+                      constraints.biggest.height - boardSize;
+
+                  return Column(
+                    mainAxisSize: MainAxisSize.max,
+                    mainAxisAlignment: MainAxisAlignment.center,
+                    children: [
+                      if (!widget.zenMode &&
+                          slicedMoves != null &&
+                          verticalSpaceLeftBoardOnPortrait >= 130)
+                        MoveList(
+                          type: MoveListType.inline,
+                          slicedMoves: slicedMoves,
+                          currentMoveIndex: widget.currentMoveIndex ?? 0,
+                          onSelectMove: widget.onSelectMove,
+                        )
+                      else if (widget.showMoveListPlaceholder &&
+                          verticalSpaceLeftBoardOnPortrait >= 130)
+                        const SizedBox(height: 40),
+                      Expanded(
+                        child: Padding(
+                          padding: EdgeInsets.symmetric(
+                            horizontal:
+                                isTablet ? kTabletBoardTableSidePadding : 12.0,
+                          ),
+                          child: widget.topTable,
+                        ),
                       ),
-                      child: widget.topTable,
-                    ),
-                  ),
-                  if (widget.engineGauge != null)
-                    Padding(
-                      padding: isTablet
-                          ? const EdgeInsets.symmetric(
-                              horizontal: kTabletBoardTableSidePadding,
-                            )
-                          : EdgeInsets.zero,
-                      child: EngineGauge(
-                        params: widget.engineGauge!,
-                        displayMode: EngineGaugeDisplayMode.horizontal,
+                      if (widget.engineGauge != null)
+                        Padding(
+                          padding: isTablet
+                              ? const EdgeInsets.symmetric(
+                                  horizontal: kTabletBoardTableSidePadding,
+                                )
+                              : EdgeInsets.zero,
+                          child: EngineGauge(
+                            params: widget.engineGauge!,
+                            displayMode: EngineGaugeDisplayMode.horizontal,
+                          ),
+                        )
+                      else if (widget.showEngineGaugePlaceholder)
+                        const SizedBox(height: kEvalGaugeSize),
+                      Padding(
+                        padding: isTablet
+                            ? const EdgeInsets.symmetric(
+                                horizontal: kTabletBoardTableSidePadding,
+                              )
+                            : EdgeInsets.zero,
+                        child: _BoardWidget(
+                          size: boardSize,
+                          boardPrefs: boardPrefs,
+                          fen: widget.fen,
+                          orientation: widget.orientation,
+                          gameData: widget.gameData,
+                          lastMove: widget.lastMove,
+                          shapes: shapes,
+                          settings: settings,
+                          boardKey: widget.boardKey ?? GlobalKey(),
+                          boardOverlay: widget.boardOverlay,
+                          error: widget.errorMessage,
+                        ),
                       ),
-                    )
-                  else if (widget.showEngineGaugePlaceholder)
-                    const SizedBox(height: kEvalGaugeSize),
-                  _BoardWidget(
-                    size: boardSize,
-                    boardPrefs: boardPrefs,
-                    fen: widget.fen,
-                    orientation: widget.orientation,
-                    gameData: widget.gameData,
-                    lastMove: widget.lastMove,
-                    shapes: shapes,
-                    settings: settings,
-                    boardKey: widget.boardKey ?? GlobalKey(),
-                    boardOverlay: widget.boardOverlay,
-                    error: error,
-                  ),
-                  Expanded(
-                    child: Padding(
-                      padding: EdgeInsets.symmetric(
-                        horizontal:
-                            isTablet ? kTabletBoardTableSidePadding : 12.0,
+                      Expanded(
+                        child: Padding(
+                          padding: EdgeInsets.symmetric(
+                            horizontal:
+                                isTablet ? kTabletBoardTableSidePadding : 12.0,
+                          ),
+                          child: widget.bottomTable,
+                        ),
                       ),
-                      child: widget.bottomTable,
-                    ),
-                  ),
-                ],
+                    ],
+                  );
+                },
               );
       },
     );
@@ -384,7 +367,7 @@ class _BoardWidget extends StatelessWidget {
   final Move? lastMove;
   final ISet<Shape> shapes;
   final ChessboardSettings settings;
-  final Widget? error;
+  final String? error;
   final Widget? boardOverlay;
   final GlobalKey boardKey;
 
@@ -428,7 +411,10 @@ class _BoardWidget extends StatelessWidget {
         child: Stack(
           children: [
             board,
-            error!,
+            _ErrorWidget(
+              errorMessage: error!,
+              boardSize: size,
+            ),
           ],
         ),
       );
@@ -438,6 +424,40 @@ class _BoardWidget extends StatelessWidget {
   }
 }
 
+class _ErrorWidget extends StatelessWidget {
+  const _ErrorWidget({
+    required this.errorMessage,
+    required this.boardSize,
+  });
+  final double boardSize;
+  final String errorMessage;
+
+  @override
+  Widget build(BuildContext context) {
+    return SizedBox.square(
+      dimension: boardSize,
+      child: Center(
+        child: Padding(
+          padding: const EdgeInsets.all(16.0),
+          child: Container(
+            decoration: BoxDecoration(
+              color: Theme.of(context).platform == TargetPlatform.iOS
+                  ? CupertinoColors.secondarySystemBackground
+                      .resolveFrom(context)
+                  : Theme.of(context).colorScheme.surface,
+              borderRadius: const BorderRadius.all(Radius.circular(10.0)),
+            ),
+            child: Padding(
+              padding: const EdgeInsets.all(10.0),
+              child: Text(errorMessage),
+            ),
+          ),
+        ),
+      ),
+    );
+  }
+}
+
 class BoardSettingsOverrides {
   const BoardSettingsOverrides({
     this.animationDuration,
diff --git a/test/widgets/board_table_test.dart b/test/widgets/board_table_test.dart
index afbc518529..d9d1b7b3ad 100644
--- a/test/widgets/board_table_test.dart
+++ b/test/widgets/board_table_test.dart
@@ -25,6 +25,8 @@ const surfaces = [
   Size(601, 962),
   // folded motorola
   Size(564.7, 482.6),
+  // pixel fold unfolded
+  Size(701.0, 640.8),
 ];
 
 void main() {
@@ -77,21 +79,17 @@ void main() {
           reason: 'Board size should match background size',
         );
 
-        final isLandscape = surface.aspectRatio > 1.0;
+        final isPortrait = surface.aspectRatio < 1.0;
         final isTablet = surface.shortestSide > 600;
 
-        final expectedBoardSize = isLandscape
-            ? isTablet
-                ? surface.height - 32.0
-                : surface.height
-            : isTablet
-                ? surface.width - 32.0
-                : surface.width;
-
-        expect(
-          boardSize,
-          Size(expectedBoardSize, expectedBoardSize),
-        );
+        if (isPortrait) {
+          final expectedBoardSize =
+              isTablet ? surface.width - 32.0 : surface.width;
+          expect(
+            boardSize,
+            Size(expectedBoardSize, expectedBoardSize),
+          );
+        }
       }
     },
     variant: kPlatformVariant,
