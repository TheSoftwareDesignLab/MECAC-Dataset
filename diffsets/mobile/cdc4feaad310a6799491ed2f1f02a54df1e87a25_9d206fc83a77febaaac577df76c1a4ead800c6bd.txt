diff --git a/lib/src/model/analysis/analysis_controller.dart b/lib/src/model/analysis/analysis_controller.dart
index 98c1faec70..adfe306369 100644
--- a/lib/src/model/analysis/analysis_controller.dart
+++ b/lib/src/model/analysis/analysis_controller.dart
@@ -7,6 +7,7 @@ import 'package:freezed_annotation/freezed_annotation.dart';
 import 'package:intl/intl.dart';
 import 'package:lichess_mobile/src/model/account/account_service.dart';
 import 'package:lichess_mobile/src/model/analysis/analysis_preferences.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_state.dart';
 import 'package:lichess_mobile/src/model/analysis/opening_service.dart';
 import 'package:lichess_mobile/src/model/analysis/server_analysis_service.dart';
 import 'package:lichess_mobile/src/model/common/chess.dart';
@@ -646,7 +647,9 @@ class AnalysisController extends _$AnalysisController
 }
 
 @freezed
-sealed class AnalysisState with _$AnalysisState implements EvaluationMixinState {
+sealed class AnalysisState
+    with _$AnalysisState
+    implements EvaluationMixinState, CommonAnalysisState {
   const AnalysisState._();
 
   const factory AnalysisState({
@@ -770,7 +773,9 @@ sealed class AnalysisState with _$AnalysisState implements EvaluationMixinState
 }
 
 @freezed
-sealed class AnalysisCurrentNode with _$AnalysisCurrentNode {
+sealed class AnalysisCurrentNode
+    with _$AnalysisCurrentNode
+    implements AnalysisCurrentNodeInterface {
   const AnalysisCurrentNode._();
 
   const factory AnalysisCurrentNode({
diff --git a/lib/src/model/analysis/analysis_preferences.dart b/lib/src/model/analysis/analysis_preferences.dart
index 8b4e12d498..1a7acd456c 100644
--- a/lib/src/model/analysis/analysis_preferences.dart
+++ b/lib/src/model/analysis/analysis_preferences.dart
@@ -1,4 +1,5 @@
 import 'package:freezed_annotation/freezed_annotation.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_prefs.dart';
 import 'package:lichess_mobile/src/model/settings/preferences_storage.dart';
 import 'package:riverpod_annotation/riverpod_annotation.dart';
 
@@ -57,7 +58,7 @@ class AnalysisPreferences extends _$AnalysisPreferences with PreferencesStorage<
 }
 
 @Freezed(fromJson: true, toJson: true)
-sealed class AnalysisPrefs with _$AnalysisPrefs implements Serializable {
+sealed class AnalysisPrefs with _$AnalysisPrefs implements Serializable, CommonAnalysisPrefs {
   const AnalysisPrefs._();
 
   const factory AnalysisPrefs({
diff --git a/lib/src/model/analysis/common_analysis_prefs.dart b/lib/src/model/analysis/common_analysis_prefs.dart
new file mode 100644
index 0000000000..89dfb1dc6c
--- /dev/null
+++ b/lib/src/model/analysis/common_analysis_prefs.dart
@@ -0,0 +1,8 @@
+/// Interface for Analysis's prefs.
+abstract class CommonAnalysisPrefs {
+  /// Whether to show the best move arrows.
+  bool get showBestMoveArrow;
+
+  /// Whether to show the annotations.
+  bool get showAnnotations;
+}
diff --git a/lib/src/model/analysis/common_analysis_state.dart b/lib/src/model/analysis/common_analysis_state.dart
new file mode 100644
index 0000000000..1df3faf04d
--- /dev/null
+++ b/lib/src/model/analysis/common_analysis_state.dart
@@ -0,0 +1,39 @@
+import 'package:dartchess/dartchess.dart';
+import 'package:fast_immutable_collections/fast_immutable_collections.dart';
+import 'package:lichess_mobile/src/model/common/chess.dart';
+import 'package:lichess_mobile/src/model/common/eval.dart';
+import 'package:lichess_mobile/src/model/engine/evaluation_preferences.dart';
+
+/// Interface for Analysis's State.
+abstract class CommonAnalysisState {
+  /// Returns `true` if the engine evaluation is available (for both local and cloud).
+  ///
+  /// This value may depend on the current state and the user preferences.
+  bool isEngineAvailable(EngineEvaluationPrefState prefs);
+
+  /// The variant of the analysis.
+  Variant get variant;
+
+  /// Current position in the position tree. Can be `null` to support illegal position that are
+  /// found in studies.
+  Position? get currentPosition;
+
+  /// The current node in the analysis view.
+  AnalysisCurrentNodeInterface get currentNode;
+
+  /// The last move played.
+  Move? get lastMove;
+
+  /// The side to display the board from.
+  Side get pov;
+
+  /// Possible promotion move to be played.
+  NormalMove? get promotionMove;
+}
+
+/// Interface for Analysis's current node.
+abstract class AnalysisCurrentNodeInterface {
+  SanMove? get sanMove;
+  IList<int>? get nags;
+  ClientEval? get eval;
+}
diff --git a/lib/src/model/broadcast/broadcast_analysis_controller.dart b/lib/src/model/broadcast/broadcast_analysis_controller.dart
index acac3faf5f..c40a7405da 100644
--- a/lib/src/model/broadcast/broadcast_analysis_controller.dart
+++ b/lib/src/model/broadcast/broadcast_analysis_controller.dart
@@ -6,6 +6,7 @@ import 'package:fast_immutable_collections/fast_immutable_collections.dart';
 import 'package:flutter/widgets.dart';
 import 'package:freezed_annotation/freezed_annotation.dart';
 import 'package:lichess_mobile/src/model/analysis/analysis_controller.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_state.dart';
 import 'package:lichess_mobile/src/model/broadcast/broadcast_preferences.dart';
 import 'package:lichess_mobile/src/model/broadcast/broadcast_repository.dart';
 import 'package:lichess_mobile/src/model/common/chess.dart';
@@ -294,9 +295,9 @@ class BroadcastAnalysisController extends _$BroadcastAnalysisController
   void onUserMove(NormalMove move) {
     if (!state.hasValue) return;
 
-    if (!state.requireValue.position.isLegal(move)) return;
+    if (!state.requireValue.currentPosition.isLegal(move)) return;
 
-    if (isPromotionPawnMove(state.requireValue.position, move)) {
+    if (isPromotionPawnMove(state.requireValue.currentPosition, move)) {
       state = AsyncData(state.requireValue.copyWith(promotionMove: move));
       return;
     }
@@ -506,7 +507,9 @@ class BroadcastAnalysisController extends _$BroadcastAnalysisController
 }
 
 @freezed
-sealed class BroadcastAnalysisState with _$BroadcastAnalysisState implements EvaluationMixinState {
+sealed class BroadcastAnalysisState
+    with _$BroadcastAnalysisState
+    implements EvaluationMixinState, CommonAnalysisState {
   const BroadcastAnalysisState._();
 
   const factory BroadcastAnalysisState({
@@ -558,10 +561,6 @@ sealed class BroadcastAnalysisState with _$BroadcastAnalysisState implements Eva
     IList<PgnComment>? pgnRootComments,
   }) = _BroadcastGameState;
 
-  Position get position => currentNode.position;
-  bool get canGoNext => currentNode.hasChild;
-  bool get canGoBack => currentPath.size > UciPath.empty.size;
-
   /// Whether the game is new or ongoing
   bool get isNewOrOngoing => pgnHeaders['Result'] == '*';
 
@@ -574,6 +573,12 @@ sealed class BroadcastAnalysisState with _$BroadcastAnalysisState implements Eva
   @override
   bool get alwaysRequestCloudEval => true;
 
+  /// We currently assume that all broadcast games are standard but this is incorrect as there are
+  /// Chess960 tournaments broadcasted on Lichess.
+  /// TODO: use the correct variant for broadcast game.
+  @override
+  Variant get variant => Variant.standard;
+
   /// Whether an evaluation can be available
   bool hasAvailableEval(EngineEvaluationPrefState prefs) =>
       isEngineAvailable(prefs) || (isServerAnalysisEnabled && currentNode.serverEval != null);
@@ -584,10 +589,13 @@ sealed class BroadcastAnalysisState with _$BroadcastAnalysisState implements Eva
   @override
   Position get currentPosition => currentNode.position;
 
+  bool get canGoNext => currentNode.hasChild;
+  bool get canGoBack => currentPath.size > UciPath.empty.size;
+
   EngineGaugeParams engineGaugeParams(EngineEvaluationPrefState prefs) => (
     isLocalEngineAvailable: isEngineAvailable(prefs),
     orientation: pov,
-    position: position,
+    position: currentPosition,
     savedEval: currentNode.eval,
     serverEval: currentNode.serverEval,
   );
diff --git a/lib/src/model/broadcast/broadcast_preferences.dart b/lib/src/model/broadcast/broadcast_preferences.dart
index 3bbdff14d3..536fe283cb 100644
--- a/lib/src/model/broadcast/broadcast_preferences.dart
+++ b/lib/src/model/broadcast/broadcast_preferences.dart
@@ -1,5 +1,6 @@
 import 'package:flutter/foundation.dart';
 import 'package:freezed_annotation/freezed_annotation.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_prefs.dart';
 import 'package:lichess_mobile/src/model/settings/preferences_storage.dart';
 import 'package:riverpod_annotation/riverpod_annotation.dart';
 
@@ -62,7 +63,7 @@ class BroadcastPreferences extends _$BroadcastPreferences with PreferencesStorag
 }
 
 @Freezed(fromJson: true, toJson: true)
-sealed class BroadcastPrefs with _$BroadcastPrefs implements Serializable {
+sealed class BroadcastPrefs with _$BroadcastPrefs implements Serializable, CommonAnalysisPrefs {
   const factory BroadcastPrefs({
     required bool showEvaluationBar,
     @JsonKey(defaultValue: true) required bool enableServerAnalysis,
diff --git a/lib/src/model/study/study_controller.dart b/lib/src/model/study/study_controller.dart
index 38a4a5d1a4..2e4477ac5b 100644
--- a/lib/src/model/study/study_controller.dart
+++ b/lib/src/model/study/study_controller.dart
@@ -5,6 +5,7 @@ import 'package:collection/collection.dart';
 import 'package:dartchess/dartchess.dart';
 import 'package:fast_immutable_collections/fast_immutable_collections.dart';
 import 'package:freezed_annotation/freezed_annotation.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_state.dart';
 import 'package:lichess_mobile/src/model/common/chess.dart';
 import 'package:lichess_mobile/src/model/common/eval.dart';
 import 'package:lichess_mobile/src/model/common/id.dart';
@@ -460,7 +461,7 @@ class StudyController extends _$StudyController
 enum GamebookState { startLesson, findTheMove, correctMove, incorrectMove, lessonComplete }
 
 @freezed
-sealed class StudyState with _$StudyState implements EvaluationMixinState {
+sealed class StudyState with _$StudyState implements EvaluationMixinState, CommonAnalysisState {
   const StudyState._();
 
   const factory StudyState({
@@ -588,7 +589,7 @@ sealed class StudyState with _$StudyState implements EvaluationMixinState {
 }
 
 @freezed
-sealed class StudyCurrentNode with _$StudyCurrentNode {
+sealed class StudyCurrentNode with _$StudyCurrentNode implements AnalysisCurrentNodeInterface {
   const StudyCurrentNode._();
 
   const factory StudyCurrentNode({
diff --git a/lib/src/model/study/study_preferences.dart b/lib/src/model/study/study_preferences.dart
index 2e3dbaa510..f2acd8edf4 100644
--- a/lib/src/model/study/study_preferences.dart
+++ b/lib/src/model/study/study_preferences.dart
@@ -1,4 +1,5 @@
 import 'package:freezed_annotation/freezed_annotation.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_prefs.dart';
 import 'package:lichess_mobile/src/model/settings/preferences_storage.dart';
 import 'package:riverpod_annotation/riverpod_annotation.dart';
 
@@ -57,7 +58,7 @@ class StudyPreferences extends _$StudyPreferences with PreferencesStorage<StudyP
 }
 
 @Freezed(fromJson: true, toJson: true)
-sealed class StudyPrefs with _$StudyPrefs implements Serializable {
+sealed class StudyPrefs with _$StudyPrefs implements Serializable, CommonAnalysisPrefs {
   const StudyPrefs._();
 
   const factory StudyPrefs({
diff --git a/lib/src/view/analysis/analysis_board.dart b/lib/src/view/analysis/analysis_board.dart
index 977df5f2e8..271edbb3d1 100644
--- a/lib/src/view/analysis/analysis_board.dart
+++ b/lib/src/view/analysis/analysis_board.dart
@@ -1,57 +1,69 @@
 import 'package:chessground/chessground.dart';
 import 'package:dartchess/dartchess.dart';
 import 'package:fast_immutable_collections/fast_immutable_collections.dart';
-import 'package:flutter/material.dart';
+import 'package:flutter/widgets.dart';
 import 'package:flutter_riverpod/flutter_riverpod.dart';
 import 'package:lichess_mobile/src/constants.dart';
-import 'package:lichess_mobile/src/model/analysis/analysis_controller.dart';
-import 'package:lichess_mobile/src/model/analysis/analysis_preferences.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_prefs.dart';
+import 'package:lichess_mobile/src/model/analysis/common_analysis_state.dart';
 import 'package:lichess_mobile/src/model/common/chess.dart';
 import 'package:lichess_mobile/src/model/common/eval.dart';
 import 'package:lichess_mobile/src/model/engine/evaluation_preferences.dart';
 import 'package:lichess_mobile/src/model/engine/evaluation_service.dart';
 import 'package:lichess_mobile/src/model/settings/board_preferences.dart';
+import 'package:lichess_mobile/src/view/analysis/game_analysis_board.dart';
+import 'package:lichess_mobile/src/view/broadcast/broadcast_game_screen.dart';
+import 'package:lichess_mobile/src/view/study/study_screen.dart';
 import 'package:lichess_mobile/src/widgets/pgn.dart';
 
-class AnalysisBoard extends ConsumerStatefulWidget {
-  const AnalysisBoard(
-    this.options,
-    this.boardSize, {
-    this.borderRadius,
-    this.enableDrawingShapes = true,
-    this.shouldReplaceChildOnUserMove = false,
-  });
+/// An abstract widget that provides the common interface for three types of analysis boards:
+/// - [GameAnalysisBoard]
+/// - [BroadcastAnalysisBoard]
+/// - [StudyAnalysisBoard]
+abstract class AnalysisBoard extends ConsumerStatefulWidget {
+  const AnalysisBoard({super.key, required this.boardSize, this.boardRadius});
 
-  final AnalysisOptions options;
   final double boardSize;
-  final BorderRadiusGeometry? borderRadius;
+  final BorderRadiusGeometry? boardRadius;
+}
 
-  final bool enableDrawingShapes;
-  final bool shouldReplaceChildOnUserMove;
+/// Abstract state class for analysis board widgets.
+abstract class AnalysisBoardState<
+  T extends AnalysisBoard,
+  AnalysisState extends CommonAnalysisState,
+  AnalysisPrefs extends CommonAnalysisPrefs
+>
+    extends ConsumerState<T> {
+  AnalysisState get analysisState;
 
-  @override
-  ConsumerState<AnalysisBoard> createState() => AnalysisBoardState();
-}
+  AnalysisPrefs get analysisPrefs;
+
+  /// Whether the annotations should be shown on the board.
+  bool get showAnnotations;
+
+  void onUserMove(NormalMove move);
+
+  void onPromotionSelection(Role? role);
+
+  /// For the study board to set a different fen if the position is `null`.
+  String get fen => analysisState.currentPosition!.fen;
+
+  /// For the study board to add pgn shapes and variations arrows.
+  ISet<Shape> get extraShapes => ISet();
 
-class AnalysisBoardState extends ConsumerState<AnalysisBoard> {
+  /// Set of shapes drawn by the user on the board (arrows, circle).
   ISet<Shape> userShapes = ISet();
 
   @override
   Widget build(BuildContext context) {
-    final ctrlProvider = analysisControllerProvider(widget.options);
-    final analysisState = ref.watch(ctrlProvider).requireValue;
     final boardPrefs = ref.watch(boardPreferencesProvider);
-    final analysisPrefs = ref.watch(analysisPreferencesProvider);
     final enginePrefs = ref.watch(engineEvaluationPreferencesProvider);
 
-    final showBestMoveArrow =
-        analysisState.isEngineAvailable(enginePrefs) && analysisPrefs.showBestMoveArrow;
-    final showAnnotations =
-        analysisState.isComputerAnalysisAllowed &&
-        analysisState.isServerAnalysisEnabled &&
-        analysisPrefs.showAnnotations;
     final currentNode = analysisState.currentNode;
+    final currentPosition = analysisState.currentPosition;
 
+    final showBestMoveArrow =
+        analysisState.isEngineAvailable(enginePrefs) && analysisPrefs.showBestMoveArrow;
     final bestMoves = showBestMoveArrow
         ? pickBestClientEval(
             localEval: ref.watch(engineEvaluationProvider.select((value) => value.eval)),
@@ -59,7 +71,11 @@ class AnalysisBoardState extends ConsumerState<AnalysisBoard> {
           )?.bestMoves
         : null;
     final ISet<Shape> bestMoveShapes = bestMoves != null
-        ? computeBestMoveShapes(bestMoves, currentNode.position.turn, boardPrefs.pieceSet.assets)
+        ? computeBestMoveShapes(
+            bestMoves,
+            analysisState.currentPosition!.turn,
+            boardPrefs.pieceSet.assets,
+          )
         : ISet();
 
     final annotation = showAnnotations ? makeAnnotation(currentNode.nags) : null;
@@ -67,34 +83,34 @@ class AnalysisBoardState extends ConsumerState<AnalysisBoard> {
 
     return Chessboard(
       size: widget.boardSize,
-      fen: analysisState.currentPosition.fen,
-      lastMove: analysisState.lastMove as NormalMove?,
       orientation: analysisState.pov,
-      game: boardPrefs.toGameData(
-        variant: analysisState.variant,
-        position: analysisState.currentPosition,
-        playerSide: analysisState.currentPosition.isGameOver
-            ? PlayerSide.none
-            : analysisState.currentPosition.turn == Side.white
-            ? PlayerSide.white
-            : PlayerSide.black,
-        promotionMove: analysisState.promotionMove,
-        onMove: (move, {isDrop, captured}) => ref
-            .read(ctrlProvider.notifier)
-            .onUserMove(move, shouldReplace: widget.shouldReplaceChildOnUserMove),
-        onPromotionSelection: (role) => ref.read(ctrlProvider.notifier).onPromotionSelection(role),
-      ),
-      shapes: userShapes.union(bestMoveShapes),
+      fen: fen,
+      lastMove: analysisState.lastMove as NormalMove?,
+      game: (currentPosition != null)
+          ? boardPrefs.toGameData(
+              variant: analysisState.variant,
+              position: currentPosition,
+              playerSide: analysisState.currentPosition!.isGameOver
+                  ? PlayerSide.none
+                  : analysisState.currentPosition!.turn == Side.white
+                  ? PlayerSide.white
+                  : PlayerSide.black,
+              promotionMove: analysisState.promotionMove,
+              onMove: (move, {isDrop}) => onUserMove(move),
+              onPromotionSelection: onPromotionSelection,
+            )
+          : null,
+      shapes: userShapes.union(bestMoveShapes).union(extraShapes),
       annotations: sanMove != null && annotation != null
           ? altCastles.containsKey(sanMove.move.uci)
                 ? IMap({Move.parse(altCastles[sanMove.move.uci]!)!.to: annotation})
                 : IMap({sanMove.move.to: annotation})
           : null,
       settings: boardPrefs.toBoardSettings().copyWith(
-        borderRadius: widget.borderRadius,
-        boxShadow: widget.borderRadius != null ? boardShadows : const <BoxShadow>[],
+        borderRadius: widget.boardRadius,
+        boxShadow: widget.boardRadius != null ? boardShadows : const <BoxShadow>[],
         drawShape: DrawShapeOptions(
-          enable: widget.enableDrawingShapes,
+          enable: boardPrefs.enableShapeDrawings,
           onCompleteShape: _onCompleteShape,
           onClearShapes: _onClearShapes,
           newShapeColor: boardPrefs.shapeColor.color,
diff --git a/lib/src/view/analysis/analysis_screen.dart b/lib/src/view/analysis/analysis_screen.dart
index 5d8fbdbc09..761aaac4b6 100644
--- a/lib/src/view/analysis/analysis_screen.dart
+++ b/lib/src/view/analysis/analysis_screen.dart
@@ -12,10 +12,10 @@ import 'package:lichess_mobile/src/utils/duration.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/navigation.dart';
 import 'package:lichess_mobile/src/utils/share.dart';
-import 'package:lichess_mobile/src/view/analysis/analysis_board.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_layout.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_settings_screen.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_share_screen.dart';
+import 'package:lichess_mobile/src/view/analysis/game_analysis_board.dart';
 import 'package:lichess_mobile/src/view/analysis/server_analysis.dart';
 import 'package:lichess_mobile/src/view/analysis/tree_view.dart';
 import 'package:lichess_mobile/src/view/board_editor/board_editor_screen.dart';
@@ -38,10 +38,9 @@ import 'package:share_plus/share_plus.dart';
 final _logger = Logger('AnalysisScreen');
 
 class AnalysisScreen extends StatelessWidget {
-  const AnalysisScreen({required this.options, this.enableDrawingShapes = true, super.key});
+  const AnalysisScreen({required this.options, super.key});
 
   final AnalysisOptions options;
-  final bool enableDrawingShapes;
 
   static Route<dynamic> buildRoute(BuildContext context, AnalysisOptions options) {
     return buildScreenRoute(context, screen: AnalysisScreen(options: options));
@@ -49,17 +48,15 @@ class AnalysisScreen extends StatelessWidget {
 
   @override
   Widget build(BuildContext context) {
-    return _AnalysisScreen(options: options, enableDrawingShapes: enableDrawingShapes);
+    return _AnalysisScreen(options: options);
   }
 }
 
 class _AnalysisScreen extends ConsumerStatefulWidget {
-  const _AnalysisScreen({required this.options, this.enableDrawingShapes = true});
+  const _AnalysisScreen({required this.options});
 
   final AnalysisOptions options;
 
-  final bool enableDrawingShapes;
-
   @override
   ConsumerState<_AnalysisScreen> createState() => _AnalysisScreenState();
 }
@@ -113,11 +110,7 @@ class _AnalysisScreenState extends ConsumerState<_AnalysisScreen>
             title: _Title(variant: value.variant),
             actions: appBarActions,
           ),
-          body: _Body(
-            options: widget.options,
-            controller: _tabController,
-            enableDrawingShapes: widget.enableDrawingShapes,
-          ),
+          body: _Body(options: widget.options, controller: _tabController),
         );
       case AsyncError(:final error, :final stackTrace):
         _logger.severe('Cannot load analysis: $error', stackTrace);
@@ -205,11 +198,10 @@ class _Title extends StatelessWidget {
 }
 
 class _Body extends ConsumerWidget {
-  const _Body({required this.options, required this.controller, required this.enableDrawingShapes});
+  const _Body({required this.options, required this.controller});
 
   final TabController controller;
   final AnalysisOptions options;
-  final bool enableDrawingShapes;
 
   @override
   Widget build(BuildContext context, WidgetRef ref) {
@@ -258,12 +250,8 @@ class _Body extends ConsumerWidget {
       smallBoard: analysisPrefs.smallBoard,
       tabController: controller,
       pov: pov,
-      boardBuilder: (context, boardSize, borderRadius) => AnalysisBoard(
-        options,
-        boardSize,
-        borderRadius: borderRadius,
-        enableDrawingShapes: enableDrawingShapes,
-      ),
+      boardBuilder: (context, boardSize, borderRadius) =>
+          GameAnalysisBoard(options: options, boardSize: boardSize, boardRadius: borderRadius),
       boardHeader: boardHeader,
       boardFooter: boardFooter,
       engineGaugeBuilder: analysisState.hasAvailableEval(enginePrefs) && showEvaluationGauge
diff --git a/lib/src/view/analysis/game_analysis_board.dart b/lib/src/view/analysis/game_analysis_board.dart
new file mode 100644
index 0000000000..5c9c0c91bc
--- /dev/null
+++ b/lib/src/view/analysis/game_analysis_board.dart
@@ -0,0 +1,46 @@
+import 'package:dartchess/dartchess.dart';
+import 'package:flutter_riverpod/flutter_riverpod.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_controller.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_preferences.dart';
+import 'package:lichess_mobile/src/view/analysis/analysis_board.dart';
+
+class GameAnalysisBoard extends AnalysisBoard {
+  const GameAnalysisBoard({
+    required this.options,
+    required super.boardSize,
+    super.boardRadius,
+    this.shouldReplaceChildOnUserMove = false,
+  });
+
+  final AnalysisOptions options;
+
+  final bool shouldReplaceChildOnUserMove;
+
+  @override
+  ConsumerState<GameAnalysisBoard> createState() => _GameAnalysisBoardState();
+}
+
+class _GameAnalysisBoardState
+    extends AnalysisBoardState<GameAnalysisBoard, AnalysisState, AnalysisPrefs> {
+  @override
+  AnalysisState get analysisState =>
+      ref.watch(analysisControllerProvider(widget.options)).requireValue;
+
+  @override
+  AnalysisPrefs get analysisPrefs => ref.watch(analysisPreferencesProvider);
+
+  @override
+  bool get showAnnotations =>
+      analysisState.isComputerAnalysisAllowed &&
+      analysisState.isServerAnalysisEnabled &&
+      analysisPrefs.showAnnotations;
+
+  @override
+  void onUserMove(NormalMove move) => ref
+      .read(analysisControllerProvider(widget.options).notifier)
+      .onUserMove(move, shouldReplace: widget.shouldReplaceChildOnUserMove);
+
+  @override
+  void onPromotionSelection(Role? role) =>
+      ref.read(analysisControllerProvider(widget.options).notifier).onPromotionSelection(role);
+}
diff --git a/lib/src/view/broadcast/broadcast_game_screen.dart b/lib/src/view/broadcast/broadcast_game_screen.dart
index 199b6389c2..5a258b791b 100644
--- a/lib/src/view/broadcast/broadcast_game_screen.dart
+++ b/lib/src/view/broadcast/broadcast_game_screen.dart
@@ -1,26 +1,20 @@
-import 'package:chessground/chessground.dart';
 import 'package:dartchess/dartchess.dart';
-import 'package:fast_immutable_collections/fast_immutable_collections.dart';
 import 'package:flutter/cupertino.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter_riverpod/flutter_riverpod.dart';
-import 'package:lichess_mobile/src/constants.dart';
 import 'package:lichess_mobile/src/model/broadcast/broadcast_analysis_controller.dart';
 import 'package:lichess_mobile/src/model/broadcast/broadcast_preferences.dart';
 import 'package:lichess_mobile/src/model/broadcast/broadcast_repository.dart';
-import 'package:lichess_mobile/src/model/common/chess.dart';
-import 'package:lichess_mobile/src/model/common/eval.dart';
 import 'package:lichess_mobile/src/model/common/id.dart';
 import 'package:lichess_mobile/src/model/engine/evaluation_preferences.dart';
-import 'package:lichess_mobile/src/model/engine/evaluation_service.dart';
 import 'package:lichess_mobile/src/model/game/game_share_service.dart';
-import 'package:lichess_mobile/src/model/settings/board_preferences.dart';
 import 'package:lichess_mobile/src/model/settings/general_preferences.dart';
 import 'package:lichess_mobile/src/network/http.dart';
 import 'package:lichess_mobile/src/utils/duration.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/navigation.dart';
 import 'package:lichess_mobile/src/utils/share.dart';
+import 'package:lichess_mobile/src/view/analysis/analysis_board.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_layout.dart';
 import 'package:lichess_mobile/src/view/broadcast/broadcast_game_screen_providers.dart';
 import 'package:lichess_mobile/src/view/broadcast/broadcast_game_settings_screen.dart';
@@ -272,8 +266,12 @@ class _Body extends ConsumerWidget {
           smallBoard: broadcastPrefs.smallBoard,
           pov: pov,
           tabController: tabController,
-          boardBuilder: (context, boardSize, borderRadius) =>
-              _BroadcastBoard(roundId, gameId, boardSize, borderRadius),
+          boardBuilder: (context, boardSize, borderRadius) => BroadcastAnalysisBoard(
+            roundId: roundId,
+            gameId: gameId,
+            boardSize: boardSize,
+            boardRadius: borderRadius,
+          ),
           boardHeader: _PlayerWidget(
             tournamentId: tournamentId,
             roundId: roundId,
@@ -387,101 +385,43 @@ class _OpeningExplorerTab extends ConsumerWidget {
   }
 }
 
-class _BroadcastBoard extends ConsumerStatefulWidget {
-  const _BroadcastBoard(this.roundId, this.gameId, this.boardSize, this.borderRadius);
+class BroadcastAnalysisBoard extends AnalysisBoard {
+  const BroadcastAnalysisBoard({
+    required this.roundId,
+    required this.gameId,
+    required super.boardSize,
+    super.boardRadius,
+  });
 
   final BroadcastRoundId roundId;
   final BroadcastGameId gameId;
-  final double boardSize;
-  final BorderRadiusGeometry? borderRadius;
 
   @override
-  ConsumerState<_BroadcastBoard> createState() => _BroadcastBoardState();
+  ConsumerState<BroadcastAnalysisBoard> createState() => _BroadcastAnalysisBoardState();
 }
 
-class _BroadcastBoardState extends ConsumerState<_BroadcastBoard> {
-  ISet<Shape> userShapes = ISet();
+class _BroadcastAnalysisBoardState
+    extends AnalysisBoardState<BroadcastAnalysisBoard, BroadcastAnalysisState, BroadcastPrefs> {
+  @override
+  BroadcastAnalysisState get analysisState =>
+      ref.watch(broadcastAnalysisControllerProvider(widget.roundId, widget.gameId)).requireValue;
 
   @override
-  Widget build(BuildContext context) {
-    final ctrlProvider = broadcastAnalysisControllerProvider(widget.roundId, widget.gameId);
-    final broadcastAnalysisState = ref.watch(ctrlProvider).requireValue;
-    final boardPrefs = ref.watch(boardPreferencesProvider);
-    final broadcastPrefs = ref.watch(broadcastPreferencesProvider);
-    final enginePrefs = ref.watch(engineEvaluationPreferencesProvider);
+  BroadcastPrefs get analysisPrefs => ref.watch(broadcastPreferencesProvider);
 
-    final showBestMoveArrow =
-        broadcastAnalysisState.isEngineAvailable(enginePrefs) && broadcastPrefs.showBestMoveArrow;
-    final showAnnotations =
-        broadcastAnalysisState.isServerAnalysisEnabled && broadcastPrefs.showAnnotations;
-    final currentNode = broadcastAnalysisState.currentNode;
-
-    final bestMoves = showBestMoveArrow
-        ? pickBestClientEval(
-            localEval: ref.watch(engineEvaluationProvider.select((value) => value.eval)),
-            savedEval: currentNode.eval,
-          )?.bestMoves
-        : null;
-    final ISet<Shape> bestMoveShapes = bestMoves != null
-        ? computeBestMoveShapes(bestMoves, currentNode.position.turn, boardPrefs.pieceSet.assets)
-        : ISet();
-
-    final annotation = showAnnotations ? makeAnnotation(currentNode.nags) : null;
-    final sanMove = currentNode.sanMove;
-
-    return Chessboard(
-      size: widget.boardSize,
-      fen: broadcastAnalysisState.position.fen,
-      lastMove: broadcastAnalysisState.lastMove as NormalMove?,
-      orientation: broadcastAnalysisState.pov,
-      game: boardPrefs.toGameData(
-        variant: Variant.standard,
-        position: broadcastAnalysisState.position,
-        playerSide: broadcastAnalysisState.position.isGameOver
-            ? PlayerSide.none
-            : broadcastAnalysisState.position.turn == Side.white
-            ? PlayerSide.white
-            : PlayerSide.black,
-        promotionMove: broadcastAnalysisState.promotionMove,
-        onMove: (move, {isDrop, captured}) => ref.read(ctrlProvider.notifier).onUserMove(move),
-        onPromotionSelection: (role) => ref.read(ctrlProvider.notifier).onPromotionSelection(role),
-      ),
-      shapes: userShapes.union(bestMoveShapes),
-      annotations: sanMove != null && annotation != null
-          ? altCastles.containsKey(sanMove.move.uci)
-                ? IMap({Move.parse(altCastles[sanMove.move.uci]!)!.to: annotation})
-                : IMap({sanMove.move.to: annotation})
-          : null,
-      settings: boardPrefs.toBoardSettings().copyWith(
-        borderRadius: widget.borderRadius,
-        boxShadow: widget.borderRadius != null ? boardShadows : const <BoxShadow>[],
-        drawShape: DrawShapeOptions(
-          enable: boardPrefs.enableShapeDrawings,
-          onCompleteShape: _onCompleteShape,
-          onClearShapes: _onClearShapes,
-          newShapeColor: boardPrefs.shapeColor.color,
-        ),
-      ),
-    );
-  }
+  @override
+  bool get showAnnotations =>
+      analysisState.isServerAnalysisEnabled && analysisPrefs.showAnnotations;
 
-  void _onCompleteShape(Shape shape) {
-    if (userShapes.any((element) => element == shape)) {
-      setState(() {
-        userShapes = userShapes.remove(shape);
-      });
-    } else {
-      setState(() {
-        userShapes = userShapes.add(shape);
-      });
-    }
-  }
+  @override
+  void onUserMove(NormalMove move) => ref
+      .read(broadcastAnalysisControllerProvider(widget.roundId, widget.gameId).notifier)
+      .onUserMove(move);
 
-  void _onClearShapes() {
-    setState(() {
-      userShapes = ISet();
-    });
-  }
+  @override
+  void onPromotionSelection(Role? role) => ref
+      .read(broadcastAnalysisControllerProvider(widget.roundId, widget.gameId).notifier)
+      .onPromotionSelection(role);
 }
 
 enum _PlayerWidgetPosition { bottom, top }
@@ -509,7 +449,7 @@ class _PlayerWidget extends ConsumerWidget {
 
         final isCursorOnLiveMove =
             broadcastAnalysisState.currentPath == broadcastAnalysisState.broadcastLivePath;
-        final sideToMove = broadcastAnalysisState.position.turn;
+        final sideToMove = broadcastAnalysisState.currentPosition.turn;
         final side = switch (widgetPosition) {
           _PlayerWidgetPosition.bottom => broadcastAnalysisState.pov,
           _PlayerWidgetPosition.top => broadcastAnalysisState.pov.opposite,
diff --git a/lib/src/view/opening_explorer/opening_explorer_screen.dart b/lib/src/view/opening_explorer/opening_explorer_screen.dart
index e6e2b5be02..b2e05510e2 100644
--- a/lib/src/view/opening_explorer/opening_explorer_screen.dart
+++ b/lib/src/view/opening_explorer/opening_explorer_screen.dart
@@ -11,7 +11,7 @@ import 'package:lichess_mobile/src/styles/styles.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/navigation.dart';
 import 'package:lichess_mobile/src/utils/screen.dart';
-import 'package:lichess_mobile/src/view/analysis/analysis_board.dart';
+import 'package:lichess_mobile/src/view/analysis/game_analysis_board.dart';
 import 'package:lichess_mobile/src/view/opening_explorer/opening_explorer_settings.dart';
 import 'package:lichess_mobile/src/view/opening_explorer/opening_explorer_view.dart';
 import 'package:lichess_mobile/src/widgets/bottom_bar.dart';
@@ -87,10 +87,10 @@ class _Body extends ConsumerWidget {
                           top: kTabletBoardTableSidePadding,
                           bottom: kTabletBoardTableSidePadding,
                         ),
-                        child: AnalysisBoard(
-                          options,
-                          boardSize,
-                          borderRadius: isTablet ? Styles.boardBorderRadius : null,
+                        child: GameAnalysisBoard(
+                          options: options,
+                          boardSize: boardSize,
+                          boardRadius: isTablet ? Styles.boardBorderRadius : null,
                           shouldReplaceChildOnUserMove: true,
                         ),
                       ),
@@ -139,9 +139,9 @@ class _Body extends ConsumerWidget {
                         child: GestureDetector(
                           // disable scrolling when dragging the board
                           onVerticalDragStart: (_) {},
-                          child: AnalysisBoard(
-                            options,
-                            boardSize,
+                          child: GameAnalysisBoard(
+                            options: options,
+                            boardSize: boardSize,
                             shouldReplaceChildOnUserMove: true,
                           ),
                         ),
diff --git a/lib/src/view/study/study_screen.dart b/lib/src/view/study/study_screen.dart
index 06e56b5b50..d2ee66c8e0 100644
--- a/lib/src/view/study/study_screen.dart
+++ b/lib/src/view/study/study_screen.dart
@@ -6,11 +6,8 @@ import 'package:flutter/material.dart';
 import 'package:flutter_riverpod/flutter_riverpod.dart';
 import 'package:lichess_mobile/src/constants.dart';
 import 'package:lichess_mobile/src/model/auth/auth_session.dart';
-import 'package:lichess_mobile/src/model/common/chess.dart';
-import 'package:lichess_mobile/src/model/common/eval.dart';
 import 'package:lichess_mobile/src/model/common/id.dart';
 import 'package:lichess_mobile/src/model/engine/evaluation_preferences.dart';
-import 'package:lichess_mobile/src/model/engine/evaluation_service.dart';
 import 'package:lichess_mobile/src/model/game/game_share_service.dart';
 import 'package:lichess_mobile/src/model/settings/board_preferences.dart';
 import 'package:lichess_mobile/src/model/study/study_controller.dart';
@@ -20,6 +17,7 @@ import 'package:lichess_mobile/src/network/http.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/navigation.dart';
 import 'package:lichess_mobile/src/utils/share.dart';
+import 'package:lichess_mobile/src/view/analysis/analysis_board.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_layout.dart';
 import 'package:lichess_mobile/src/view/engine/engine_depth.dart';
 import 'package:lichess_mobile/src/view/engine/engine_gauge.dart';
@@ -32,7 +30,6 @@ import 'package:lichess_mobile/src/view/study/study_tree_view.dart';
 import 'package:lichess_mobile/src/widgets/adaptive_action_sheet.dart';
 import 'package:lichess_mobile/src/widgets/feedback.dart';
 import 'package:lichess_mobile/src/widgets/misc.dart';
-import 'package:lichess_mobile/src/widgets/pgn.dart';
 import 'package:lichess_mobile/src/widgets/platform_context_menu_button.dart';
 import 'package:lichess_mobile/src/widgets/shimmer.dart';
 import 'package:logging/logging.dart';
@@ -394,7 +391,7 @@ class _Body extends ConsumerWidget {
       tabController: tabController,
       pov: pov,
       boardBuilder: (context, boardSize, borderRadius) =>
-          _StudyBoard(id: id, boardSize: boardSize, borderRadius: borderRadius),
+          StudyAnalysisBoard(id: id, boardSize: boardSize, boardRadius: borderRadius),
       engineGaugeBuilder:
           isComputerAnalysisAllowed && showEvaluationGauge && engineGaugeParams != null
           ? (context, orientation) {
@@ -468,132 +465,75 @@ extension on PgnCommentShape {
   }
 }
 
-class _StudyBoard extends ConsumerStatefulWidget {
-  const _StudyBoard({required this.id, required this.boardSize, this.borderRadius});
+class StudyAnalysisBoard extends AnalysisBoard {
+  const StudyAnalysisBoard({required this.id, required super.boardSize, super.boardRadius});
 
   final StudyId id;
 
-  final double boardSize;
+  @override
+  ConsumerState<StudyAnalysisBoard> createState() => _StudyAnalysisBoardState();
+}
 
-  final BorderRadiusGeometry? borderRadius;
+class _StudyAnalysisBoardState
+    extends AnalysisBoardState<StudyAnalysisBoard, StudyState, StudyPrefs> {
+  @override
+  StudyState get analysisState => ref.watch(studyControllerProvider(widget.id)).requireValue;
 
   @override
-  ConsumerState<_StudyBoard> createState() => _StudyBoardState();
-}
+  StudyPrefs get analysisPrefs => ref.watch(studyPreferencesProvider);
 
-class _StudyBoardState extends ConsumerState<_StudyBoard> {
-  ISet<Shape> userShapes = ISet();
+  @override
+  bool get showAnnotations => analysisPrefs.showAnnotations;
 
   @override
-  Widget build(BuildContext context) {
-    // Clear shapes when switching to a new chapter.
-    // This avoids "leftover" shapes from the previous chapter when the engine has not evaluated the new position yet.
-    ref.listen(studyControllerProvider(widget.id).select((state) => state.hasValue), (prev, next) {
-      if (prev != next) {
-        setState(() {
-          userShapes = ISet();
-        });
-      }
-    });
-    final boardPrefs = ref.watch(boardPreferencesProvider);
-    final enginePrefs = ref.watch(engineEvaluationPreferencesProvider);
-    final studyPrefs = ref.watch(studyPreferencesProvider);
-    final studyState = ref.watch(studyControllerProvider(widget.id)).requireValue;
+  void onUserMove(NormalMove move) {
+    ref.read(studyControllerProvider(widget.id).notifier).onUserMove(move);
+  }
 
-    final currentNode = studyState.currentNode;
-    final position = currentNode.position;
+  @override
+  void onPromotionSelection(Role? role) {
+    ref.read(studyControllerProvider(widget.id).notifier).onPromotionSelection(role);
+  }
 
+  @override
+  String get fen =>
+      analysisState.currentPosition?.board.fen ??
+      analysisState.study.currentChapterMeta.fen ??
+      kInitialFEN;
+
+  @override
+  ISet<Shape> get extraShapes {
     final showVariationArrows =
         ref.watch(studyPreferencesProvider.select((prefs) => prefs.showVariationArrows)) &&
-        !studyState.gamebookActive &&
-        currentNode.children.length > 1;
+        !analysisState.gamebookActive &&
+        analysisState.currentNode.children.length > 1;
 
-    final pgnShapes = ISet(studyState.pgnShapes.map((shape) => shape.chessground));
+    final pgnShapes = ISet(analysisState.pgnShapes.map((shape) => shape.chessground));
 
     final variationArrows = ISet<Shape>(
       showVariationArrows
-          ? currentNode.children.mapIndexed((i, move) {
+          ? analysisState.currentNode.children.mapIndexed((i, move) {
               final color = Colors.white.withValues(alpha: i == 0 ? 0.9 : 0.5);
               return Arrow(color: color, orig: (move as NormalMove).from, dest: move.to);
             }).toList()
           : [],
     );
 
-    final showAnnotationsOnBoard = studyPrefs.showAnnotations;
-
-    final showBestMoveArrow =
-        studyState.isEngineAvailable(enginePrefs) && studyPrefs.showBestMoveArrow;
-
-    final bestMoves = showBestMoveArrow
-        ? pickBestClientEval(
-            localEval: ref.watch(engineEvaluationProvider.select((value) => value.eval)),
-            savedEval: currentNode.eval,
-          )?.bestMoves
-        : null;
-    final ISet<Shape> bestMoveShapes = bestMoves != null
-        ? computeBestMoveShapes(bestMoves, currentNode.position!.turn, boardPrefs.pieceSet.assets)
-        : ISet();
-
-    final sanMove = currentNode.sanMove;
-    final annotation = makeAnnotation(studyState.currentNode.nags);
-
-    return Chessboard(
-      size: widget.boardSize,
-      settings: boardPrefs.toBoardSettings().copyWith(
-        borderRadius: widget.borderRadius,
-        boxShadow: widget.borderRadius != null ? boardShadows : const <BoxShadow>[],
-        drawShape: DrawShapeOptions(
-          enable: true,
-          onCompleteShape: _onCompleteShape,
-          onClearShapes: _onClearShapes,
-          newShapeColor: boardPrefs.shapeColor.color,
-        ),
-      ),
-      fen:
-          studyState.currentPosition?.board.fen ??
-          studyState.study.currentChapterMeta.fen ??
-          kInitialFEN,
-      lastMove: studyState.lastMove as NormalMove?,
-      orientation: studyState.pov,
-      shapes: pgnShapes.union(userShapes).union(variationArrows).union(bestMoveShapes),
-      annotations: showAnnotationsOnBoard && sanMove != null && annotation != null
-          ? altCastles.containsKey(sanMove.move.uci)
-                ? IMap({Move.parse(altCastles[sanMove.move.uci]!)!.to: annotation})
-                : IMap({sanMove.move.to: annotation})
-          : null,
-      game: position != null
-          ? boardPrefs.toGameData(
-              variant: studyState.variant,
-              position: position,
-              playerSide: studyState.playerSide,
-              promotionMove: studyState.promotionMove,
-              onMove: (move, {isDrop, captured}) {
-                ref.read(studyControllerProvider(widget.id).notifier).onUserMove(move);
-              },
-              onPromotionSelection: (role) {
-                ref.read(studyControllerProvider(widget.id).notifier).onPromotionSelection(role);
-              },
-            )
-          : null,
-    );
-  }
-
-  void _onCompleteShape(Shape shape) {
-    if (userShapes.any((element) => element == shape)) {
-      setState(() {
-        userShapes = userShapes.remove(shape);
-      });
-      return;
-    } else {
-      setState(() {
-        userShapes = userShapes.add(shape);
-      });
-    }
+    return pgnShapes.union(variationArrows);
   }
 
-  void _onClearShapes() {
-    setState(() {
-      userShapes = ISet();
+  @override
+  Widget build(BuildContext context) {
+    // Clear shapes when switching to a new chapter.
+    // This avoids "leftover" shapes from the previous chapter when the engine has not evaluated the new position yet.
+    ref.listen(studyControllerProvider(widget.id).select((state) => state.hasValue), (prev, next) {
+      if (prev != next) {
+        setState(() {
+          userShapes = ISet();
+        });
+      }
     });
+
+    return super.build(context);
   }
 }
diff --git a/test/view/analysis/analysis_screen_test.dart b/test/view/analysis/analysis_screen_test.dart
index 719d339f76..7e05b33df2 100644
--- a/test/view/analysis/analysis_screen_test.dart
+++ b/test/view/analysis/analysis_screen_test.dart
@@ -114,7 +114,6 @@ void main() {
             isComputerAnalysisAllowed: false,
             variant: Variant.standard,
           ),
-          enableDrawingShapes: false,
         ),
       );
 
