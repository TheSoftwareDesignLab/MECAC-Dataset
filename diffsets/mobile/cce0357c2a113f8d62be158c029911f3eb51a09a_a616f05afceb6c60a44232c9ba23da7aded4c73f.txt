diff --git a/lib/src/model/analysis/analysis_ctrl.dart b/lib/src/model/analysis/analysis_ctrl.dart
index d16d15f58b..e328a424aa 100644
--- a/lib/src/model/analysis/analysis_ctrl.dart
+++ b/lib/src/model/analysis/analysis_ctrl.dart
@@ -1,3 +1,4 @@
+import 'dart:async';
 import 'package:dartchess/dartchess.dart';
 import 'package:fast_immutable_collections/fast_immutable_collections.dart';
 import 'package:freezed_annotation/freezed_annotation.dart';
@@ -19,30 +20,40 @@ import 'package:lichess_mobile/src/model/analysis/opening_service.dart';
 part 'analysis_ctrl.g.dart';
 part 'analysis_ctrl.freezed.dart';
 
+@freezed
+class AnalysisOptions with _$AnalysisOptions {
+  const factory AnalysisOptions({
+    required ID id,
+    required bool isLocalEvaluationAllowed,
+    required Variant variant,
+    required IList<GameStep> steps,
+    required Side orientation,
+    LightOpening? opening,
+  }) = _AnalysisOptions;
+}
+
 @riverpod
 class AnalysisCtrl extends _$AnalysisCtrl {
   late Root _root;
 
   final _engineEvalDebounce = Debouncer(const Duration(milliseconds: 150));
 
+  Timer? _startEngineEvalTimer;
+
   @override
-  AnalysisCtrlState build(
-    Variant variant,
-    IList<GameStep> steps,
-    Side orientation,
-    ID id,
-  ) {
+  AnalysisCtrlState build(AnalysisOptions options) {
     ref.onDispose(() {
+      _startEngineEvalTimer?.cancel();
       _engineEvalDebounce.dispose();
     });
     _root = Root(
-      ply: steps[0].ply,
-      fen: steps[0].position.fen,
-      position: steps[0].position,
+      ply: options.steps[0].ply,
+      fen: options.steps[0].position.fen,
+      position: options.steps[0].position,
     );
 
     Node current = _root;
-    steps.skip(1).forEach((step) {
+    options.steps.skip(1).forEach((step) {
       final nextNode = Branch(
         ply: step.ply,
         sanMove: step.sanMove!,
@@ -55,45 +66,34 @@ class AnalysisCtrl extends _$AnalysisCtrl {
 
     final currentPath = _root.mainlinePath;
 
-    // don't use ref.watch here: we don't want to clear all state when the
+    // don't use ref.watch here: we don't want to invalidate state when the
     // analysis preferences change
     final prefs = ref.read(analysisPreferencesProvider);
 
     final evalContext = EvaluationContext(
-      variant: variant,
+      variant: options.variant,
       initialFen: _root.fen,
-      contextId: id,
+      contextId: options.id,
       multiPv: prefs.numEvalLines,
       cores: prefs.numEngineCores,
     );
 
-    _engineEvalDebounce(
-      () => ref
-          .read(
-            engineEvaluationProvider(
-              evalContext,
-            ).notifier,
-          )
-          .start(
-            currentPath,
-            _root.mainline.map(Step.fromNode),
-            current.position,
-            shouldEmit: (work) => work.path == currentPath,
-          )
-          ?.forEach(
-            (t) => _root.updateAt(t.$1.path, (node) => node.eval = t.$2),
-          ),
-    );
+    _startEngineEvalTimer = Timer(const Duration(milliseconds: 200), () {
+      _startEngineEval();
+    });
 
     return AnalysisCtrlState(
-      id: id,
+      id: options.id,
+      isLocalEvaluationAllowed: options.isLocalEvaluationAllowed,
+      isLocalEvaluationEnabled: prefs.enableLocalEvaluation,
       initialFen: _root.fen,
       initialPath: UciPath.empty,
       currentPath: currentPath,
       root: _root.view,
       currentNode: current.view,
-      pov: orientation,
+      pov: options.orientation,
       evaluationContext: evalContext,
+      contextOpening: options.opening,
     );
   }
 
@@ -125,6 +125,20 @@ class AnalysisCtrl extends _$AnalysisCtrl {
     _setPath(path);
   }
 
+  void toggleLocalEvaluation(bool value) {
+    ref
+        .read(analysisPreferencesProvider.notifier)
+        .toggleEnableLocalEvaluation();
+
+    state = state.copyWith(isLocalEvaluationEnabled: value);
+
+    if (value) {
+      _startEngineEval();
+    } else {
+      _stopEngineEval();
+    }
+  }
+
   void setNumEvalLines(int numEvalLines) {
     ref
         .read(analysisPreferencesProvider.notifier)
@@ -229,7 +243,7 @@ class AnalysisCtrl extends _$AnalysisCtrl {
   }
 
   Future<void> _fetchOpening(UciPath path) async {
-    if (!kOpeningAllowedVariants.contains(variant)) return;
+    if (!kOpeningAllowedVariants.contains(options.variant)) return;
 
     final moves = _root.nodesOn(path).map((node) => node.sanMove.move);
     if (moves.isEmpty) return;
@@ -247,8 +261,11 @@ class AnalysisCtrl extends _$AnalysisCtrl {
     }
   }
 
+  bool get _isEngineEnabled =>
+      ref.read(analysisPreferencesProvider).enableLocalEvaluation;
+
   void _startEngineEval() {
-    if (!state.isEngineAvailable) return;
+    if (!_isEngineEnabled || !state.isEngineAvailable) return;
     _engineEvalDebounce(
       () => ref
           .read(
@@ -284,14 +301,20 @@ class AnalysisCtrlState with _$AnalysisCtrlState {
     required ID id,
     required Side pov,
     required EvaluationContext evaluationContext,
+    required bool isLocalEvaluationAllowed,
+    required bool isLocalEvaluationEnabled,
     Move? lastMove,
+    Opening? contextOpening,
     Opening? currentBranchOpening,
   }) = _AnalysisCtrlState;
 
   IMap<String, ISet<String>> get validMoves =>
       algebraicLegalMoves(currentNode.position);
 
-  bool get isEngineAvailable => engineSupportedVariants.contains(
+  bool get isEngineAvailable =>
+      isLocalEvaluationAllowed &&
+      isLocalEvaluationEnabled &&
+      engineSupportedVariants.contains(
         evaluationContext.variant,
       );
 
diff --git a/lib/src/model/analysis/opening_service.dart b/lib/src/model/analysis/opening_service.dart
index 233e95326b..5a3e43a262 100644
--- a/lib/src/model/analysis/opening_service.dart
+++ b/lib/src/model/analysis/opening_service.dart
@@ -27,7 +27,7 @@ class OpeningService {
 
   Future<Database> get _db => ref.read(openingsDatabaseProvider.future);
 
-  Future<Opening?> fetchFromMoves(Iterable<Move> moves) async {
+  Future<FullOpening?> fetchFromMoves(Iterable<Move> moves) async {
     final db = await _db;
     final movesString = moves.map((move) => move.uci).join(' ');
     final list = await db.query(
@@ -39,7 +39,7 @@ class OpeningService {
     final first = list.firstOrNull;
 
     if (first != null) {
-      return Opening(
+      return FullOpening(
         eco: first['eco']! as String,
         name: first['name']! as String,
         fen: first['epd']! as String,
diff --git a/lib/src/model/common/chess.dart b/lib/src/model/common/chess.dart
index 3005284062..8117860376 100644
--- a/lib/src/model/common/chess.dart
+++ b/lib/src/model/common/chess.dart
@@ -121,15 +121,31 @@ enum Variant {
   }
 }
 
+/// Represents a chess opening.
+sealed class Opening {
+  String get eco;
+  String get name;
+}
+
+@freezed
+class LightOpening with _$LightOpening implements Opening {
+  const LightOpening._();
+  const factory LightOpening({
+    required String eco,
+    required String name,
+  }) = _LightOpening;
+}
+
 @freezed
-class Opening with _$Opening {
-  const factory Opening({
+class FullOpening with _$FullOpening implements Opening {
+  const FullOpening._();
+  const factory FullOpening({
     required String eco,
     required String name,
     required String fen,
     required String pgnMoves,
     required String uciMoves,
-  }) = _Opening;
+  }) = _FullOpening;
 }
 
 extension ChessExtension on Pick {
diff --git a/lib/src/model/game/game.dart b/lib/src/model/game/game.dart
index a9932d1a6f..48f679193f 100644
--- a/lib/src/model/game/game.dart
+++ b/lib/src/model/game/game.dart
@@ -192,7 +192,7 @@ class ArchivedGameData with _$ArchivedGameData {
     required Player white,
     required Player black,
     required Variant variant,
-    ({String eco, String name})? opening,
+    LightOpening? opening,
     String? initialFen,
     String? lastFen,
     Side? winner,
diff --git a/lib/src/model/game/game_repository.dart b/lib/src/model/game/game_repository.dart
index f49a70c673..8ae975d82b 100644
--- a/lib/src/model/game/game_repository.dart
+++ b/lib/src/model/game/game_repository.dart
@@ -43,7 +43,7 @@ class GameRepository {
   FutureResult<IList<ArchivedGameData>> getUserGames(UserId userId) {
     return apiClient.get(
       Uri.parse(
-        '$kLichessHost/api/games/user/$userId?max=10&moves=false&lastFen=true&accuracy=true',
+        '$kLichessHost/api/games/user/$userId?max=10&moves=false&lastFen=true&accuracy=true&opening=true',
       ),
       headers: {'Accept': 'application/x-ndjson'},
     ).flatMap(
@@ -139,6 +139,14 @@ ArchivedGameData _archivedGameDataFromPick(RequiredPick pick) {
     initialFen: pick('initialFen').asStringOrNull(),
     lastFen: pick('lastFen').asStringOrNull(),
     clock: pick('clock').letOrNull(_clockDataFromPick),
+    opening: pick('opening').letOrNull(_openingFromPick),
+  );
+}
+
+LightOpening _openingFromPick(RequiredPick pick) {
+  return LightOpening(
+    eco: pick('eco').asStringOrThrow(),
+    name: pick('name').asStringOrThrow(),
   );
 }
 
diff --git a/lib/src/model/settings/analysis_preferences.dart b/lib/src/model/settings/analysis_preferences.dart
index 1256868032..e10e4dc075 100644
--- a/lib/src/model/settings/analysis_preferences.dart
+++ b/lib/src/model/settings/analysis_preferences.dart
@@ -8,17 +8,17 @@ import 'package:lichess_mobile/src/db/shared_preferences.dart';
 part 'analysis_preferences.freezed.dart';
 part 'analysis_preferences.g.dart';
 
-const _prefKey = 'preferences.analysis';
-
 final maxEngineCores = Platform.numberOfProcessors - 1;
 
 @Riverpod(keepAlive: true)
 class AnalysisPreferences extends _$AnalysisPreferences {
+  static const prefKey = 'preferences.analysis';
+
   @override
   AnalysisPrefState build() {
     final prefs = ref.watch(sharedPreferencesProvider);
 
-    final stored = prefs.getString(_prefKey);
+    final stored = prefs.getString(prefKey);
     return stored != null
         ? AnalysisPrefState.fromJson(
             jsonDecode(stored) as Map<String, dynamic>,
@@ -26,6 +26,14 @@ class AnalysisPreferences extends _$AnalysisPreferences {
         : AnalysisPrefState.defaults;
   }
 
+  Future<void> toggleEnableLocalEvaluation() {
+    return _save(
+      state.copyWith(
+        enableLocalEvaluation: !state.enableLocalEvaluation,
+      ),
+    );
+  }
+
   Future<void> toggleShowEvaluationGauge() {
     return _save(
       state.copyWith(
@@ -63,7 +71,7 @@ class AnalysisPreferences extends _$AnalysisPreferences {
   Future<void> _save(AnalysisPrefState newState) async {
     final prefs = ref.read(sharedPreferencesProvider);
     await prefs.setString(
-      _prefKey,
+      prefKey,
       jsonEncode(newState.toJson()),
     );
     state = newState;
@@ -75,6 +83,7 @@ class AnalysisPrefState with _$AnalysisPrefState {
   const AnalysisPrefState._();
 
   const factory AnalysisPrefState({
+    required bool enableLocalEvaluation,
     required bool showEvaluationGauge,
     required bool showBestMoveArrow,
     @Assert('numEvalLines >= 1 && numEvalLines <= 3') required int numEvalLines,
@@ -83,6 +92,7 @@ class AnalysisPrefState with _$AnalysisPrefState {
   }) = _AnalysisPrefState;
 
   static final defaults = AnalysisPrefState(
+    enableLocalEvaluation: true,
     showEvaluationGauge: true,
     showBestMoveArrow: true,
     numEvalLines: 2,
diff --git a/lib/src/view/analysis/analysis_screen.dart b/lib/src/view/analysis/analysis_screen.dart
index 4c985a4a05..c8a91cffa3 100644
--- a/lib/src/view/analysis/analysis_screen.dart
+++ b/lib/src/view/analysis/analysis_screen.dart
@@ -11,11 +11,8 @@ import 'package:flutter_riverpod/flutter_riverpod.dart';
 import 'package:popover/popover.dart';
 
 import 'package:lichess_mobile/src/constants.dart';
-import 'package:lichess_mobile/src/model/common/chess.dart';
 import 'package:lichess_mobile/src/model/common/eval.dart';
-import 'package:lichess_mobile/src/model/common/id.dart';
 import 'package:lichess_mobile/src/model/common/node.dart';
-import 'package:lichess_mobile/src/model/common/uci.dart';
 import 'package:lichess_mobile/src/model/engine/engine_evaluation.dart';
 import 'package:lichess_mobile/src/model/analysis/analysis_ctrl.dart';
 import 'package:lichess_mobile/src/model/settings/board_preferences.dart';
@@ -23,7 +20,6 @@ import 'package:lichess_mobile/src/model/settings/general_preferences.dart';
 import 'package:lichess_mobile/src/model/settings/brightness.dart';
 import 'package:lichess_mobile/src/model/settings/analysis_preferences.dart';
 import 'package:lichess_mobile/src/styles/styles.dart';
-import 'package:lichess_mobile/src/utils/rate_limit.dart';
 import 'package:lichess_mobile/src/view/engine/engine_gauge.dart';
 import 'package:lichess_mobile/src/widgets/adaptive_action_sheet.dart';
 import 'package:lichess_mobile/src/widgets/adaptive_bottom_sheet.dart';
@@ -33,25 +29,17 @@ import 'package:lichess_mobile/src/widgets/non_linear_slider.dart';
 import 'package:lichess_mobile/src/widgets/platform.dart';
 import 'package:lichess_mobile/src/utils/l10n_context.dart';
 import 'package:lichess_mobile/src/utils/chessground_compat.dart';
-import 'package:lichess_mobile/src/model/game/game.dart';
 import 'package:lichess_mobile/src/widgets/settings.dart';
 
-const kChessNotationFontSize = 13.0;
-const kFastReplayDebounceDelay = Duration(milliseconds: 100);
+import 'tree_view.dart';
 
 class AnalysisScreen extends ConsumerWidget {
   const AnalysisScreen({
-    required this.variant,
-    required this.steps,
-    required this.orientation,
-    required this.id,
+    required this.options,
     this.title,
   });
 
-  final Variant variant;
-  final IList<GameStep> steps;
-  final Side orientation;
-  final ID id;
+  final AnalysisOptions options;
   final String? title;
 
   @override
@@ -64,7 +52,7 @@ class AnalysisScreen extends ConsumerWidget {
   }
 
   Widget _androidBuilder(BuildContext context, WidgetRef ref) {
-    final ctrlProvider = analysisCtrlProvider(variant, steps, orientation, id);
+    final ctrlProvider = analysisCtrlProvider(options);
 
     return Scaffold(
       appBar: AppBar(
@@ -85,7 +73,7 @@ class AnalysisScreen extends ConsumerWidget {
   }
 
   Widget _iosBuilder(BuildContext context, WidgetRef ref) {
-    final ctrlProvider = analysisCtrlProvider(variant, steps, orientation, id);
+    final ctrlProvider = analysisCtrlProvider(options);
 
     return CupertinoPageScaffold(
       navigationBar: CupertinoNavigationBar(
@@ -140,7 +128,7 @@ class _BodyState extends ConsumerState<_Body> {
                 final isSmallScreen =
                     constraints.maxHeight < kSmallHeightScreenThreshold;
                 final boardSize = isTablet || isSmallScreen
-                    ? defaultBoardSize - 16.0 * 2
+                    ? defaultBoardSize - kTabletBoardTableSidePadding * 2
                     : defaultBoardSize;
 
                 return aspectRatio > 1
@@ -168,15 +156,17 @@ class _BodyState extends ConsumerState<_Body> {
                               children: [
                                 _EngineLines(
                                   widget.ctrlProvider,
-                                  isTablet: true,
+                                  isLandscape: true,
                                 ),
                                 Expanded(
                                   child: PlatformCard(
-                                    margin: const EdgeInsets.all(16.0),
+                                    margin: const EdgeInsets.all(
+                                      kTabletBoardTableSidePadding,
+                                    ),
                                     semanticContainer: false,
-                                    child: _Moves(
+                                    child: AnalysisTreeView(
                                       widget.ctrlProvider,
-                                      _MovesDisplayMode.tablet,
+                                      Orientation.landscape,
                                     ),
                                   ),
                                 ),
@@ -188,13 +178,22 @@ class _BodyState extends ConsumerState<_Body> {
                     : Column(
                         mainAxisAlignment: MainAxisAlignment.center,
                         mainAxisSize: MainAxisSize.max,
-                        // don't use stretch here because board background size would be wrong
                         crossAxisAlignment: CrossAxisAlignment.center,
                         children: [
                           _ColumnTopTable(widget.ctrlProvider),
-                          _Board(widget.ctrlProvider, boardSize),
-                          _Opening(widget.ctrlProvider),
-                          _Moves(widget.ctrlProvider, _MovesDisplayMode.normal),
+                          if (isTablet)
+                            Padding(
+                              padding: const EdgeInsets.all(
+                                kTabletBoardTableSidePadding,
+                              ),
+                              child: _Board(widget.ctrlProvider, boardSize),
+                            )
+                          else
+                            _Board(widget.ctrlProvider, boardSize),
+                          AnalysisTreeView(
+                            widget.ctrlProvider,
+                            Orientation.portrait,
+                          ),
                         ],
                       );
               },
@@ -274,40 +273,6 @@ class _Board extends ConsumerWidget {
   }
 }
 
-class _Opening extends ConsumerWidget {
-  const _Opening(this.ctrlProvider);
-
-  final AnalysisCtrlProvider ctrlProvider;
-
-  @override
-  Widget build(BuildContext context, WidgetRef ref) {
-    final nodeOpening =
-        ref.watch(ctrlProvider.select((s) => s.currentNode.opening));
-
-    final branchOpening =
-        ref.watch(ctrlProvider.select((s) => s.currentBranchOpening));
-    final opening = nodeOpening ?? branchOpening;
-    return opening != null
-        ? Container(
-            height: kEvalGaugeSize,
-            width: double.infinity,
-            color: defaultTargetPlatform == TargetPlatform.iOS
-                ? CupertinoDynamicColor.resolve(
-                    CupertinoColors.secondarySystemBackground,
-                    context,
-                  )
-                : Theme.of(context).colorScheme.secondaryContainer,
-            child: Center(
-              child: Text(
-                opening.name,
-                style: const TextStyle(fontSize: kChessNotationFontSize),
-              ),
-            ),
-          )
-        : const SizedBox.shrink();
-  }
-}
-
 class _EngineGaugeVertical extends ConsumerWidget {
   const _EngineGaugeVertical(this.ctrlProvider);
 
@@ -358,7 +323,7 @@ class _ColumnTopTable extends ConsumerWidget {
                     savedEval: analysisState.currentNode.eval,
                   ),
                 ),
-              _EngineLines(ctrlProvider, isTablet: false),
+              _EngineLines(ctrlProvider, isLandscape: false),
             ],
           )
         : kEmptyWidget;
@@ -366,9 +331,9 @@ class _ColumnTopTable extends ConsumerWidget {
 }
 
 class _EngineLines extends ConsumerWidget {
-  const _EngineLines(this.ctrlProvider, {required this.isTablet});
+  const _EngineLines(this.ctrlProvider, {required this.isLandscape});
   final AnalysisCtrlProvider ctrlProvider;
-  final bool isTablet;
+  final bool isLandscape;
 
   @override
   Widget build(BuildContext context, WidgetRef ref) {
@@ -413,8 +378,8 @@ class _EngineLines extends ConsumerWidget {
 
     return Padding(
       padding: EdgeInsets.symmetric(
-        vertical: isTablet ? 16.0 : 0.0,
-        horizontal: isTablet ? 16.0 : 0.0,
+        vertical: isLandscape ? kTabletBoardTableSidePadding : 0.0,
+        horizontal: isLandscape ? kTabletBoardTableSidePadding : 0.0,
       ),
       child: Column(
         crossAxisAlignment: CrossAxisAlignment.start,
@@ -526,292 +491,6 @@ class _Engineline extends ConsumerWidget {
   }
 }
 
-enum _MovesDisplayMode {
-  tablet,
-  normal,
-}
-
-class _Moves extends ConsumerWidget {
-  const _Moves(this.ctrlProvider, this.displayMode);
-
-  final AnalysisCtrlProvider ctrlProvider;
-  final _MovesDisplayMode displayMode;
-
-  @override
-  Widget build(BuildContext context, WidgetRef ref) {
-    final root = ref.watch(ctrlProvider.select((value) => value.root));
-    final currentPath =
-        ref.watch(ctrlProvider.select((value) => value.currentPath));
-
-    return _InlineTreeView(
-      ctrlProvider,
-      root,
-      currentPath,
-      displayMode,
-    );
-  }
-}
-
-const kInlineMoveSpacing = 5.0;
-
-class _InlineTreeView extends ConsumerStatefulWidget {
-  const _InlineTreeView(
-    this.ctrlProvider,
-    this.root,
-    this.currentPath,
-    this.displayMode,
-  );
-
-  final AnalysisCtrlProvider ctrlProvider;
-  final ViewRoot root;
-  final UciPath currentPath;
-  final _MovesDisplayMode displayMode;
-
-  @override
-  ConsumerState<_InlineTreeView> createState() => _InlineTreeViewState();
-}
-
-class _InlineTreeViewState extends ConsumerState<_InlineTreeView> {
-  final currentMoveKey = GlobalKey();
-  final _debounce = Debouncer(kFastReplayDebounceDelay);
-
-  @override
-  void initState() {
-    super.initState();
-    WidgetsBinding.instance.addPostFrameCallback((_) {
-      if (currentMoveKey.currentContext != null) {
-        Scrollable.ensureVisible(
-          currentMoveKey.currentContext!,
-          alignment: 0.5,
-          alignmentPolicy: ScrollPositionAlignmentPolicy.keepVisibleAtEnd,
-        );
-      }
-    });
-  }
-
-  @override
-  void dispose() {
-    _debounce.dispose();
-    super.dispose();
-  }
-
-  @override
-  void didUpdateWidget(covariant _InlineTreeView oldWidget) {
-    super.didUpdateWidget(oldWidget);
-    _debounce(() {
-      if (currentMoveKey.currentContext != null) {
-        Scrollable.ensureVisible(
-          currentMoveKey.currentContext!,
-          duration: const Duration(milliseconds: 200),
-          curve: Curves.easeIn,
-          alignment: 0.5,
-          alignmentPolicy: ScrollPositionAlignmentPolicy.explicit,
-        );
-      }
-    });
-  }
-
-  @override
-  Widget build(BuildContext context) {
-    final content = SingleChildScrollView(
-      padding: const EdgeInsets.symmetric(vertical: 10, horizontal: 10),
-      child: Wrap(
-        spacing: kInlineMoveSpacing,
-        children: _buildTreeWidget(
-          widget.ctrlProvider,
-          nodes: widget.root.children,
-          inMainline: true,
-          startSideline: false,
-          initialPath: UciPath.empty,
-          currentPath: widget.currentPath,
-        ),
-      ),
-    );
-
-    return switch (widget.displayMode) {
-      _MovesDisplayMode.tablet => content,
-      _MovesDisplayMode.normal => Expanded(child: content)
-    };
-  }
-
-  List<Widget> _buildTreeWidget(
-    AnalysisCtrlProvider ctrlProvider, {
-    required IList<ViewBranch> nodes,
-    required bool inMainline,
-    required bool startSideline,
-    required UciPath initialPath,
-    required UciPath currentPath,
-  }) {
-    if (nodes.isEmpty) return [];
-    final List<Widget> widgets = [];
-
-    // add the node[0]
-    final newPath = initialPath + nodes[0].id;
-    final currentMove = newPath == currentPath;
-    widgets.add(
-      InlineMove(
-        ctrlProvider,
-        path: newPath,
-        move: nodes[0].sanMove,
-        ply: nodes[0].ply,
-        isCurrentMove: currentMove,
-        key: currentMove ? currentMoveKey : null,
-        isSideline: !inMainline,
-        startSideline: startSideline,
-        endSideline: !inMainline && nodes[0].children.isEmpty,
-      ),
-    );
-
-    // add the sidelines if present
-    for (var i = 1; i < nodes.length; i++) {
-      // start new sideline from mainline on a new line
-      if (inMainline) {
-        widgets.add(
-          SizedBox(
-            width: double.infinity,
-            child: Wrap(
-              spacing: kInlineMoveSpacing,
-              children: _buildTreeWidget(
-                ctrlProvider,
-                nodes: IList([nodes[i]]),
-                inMainline: false,
-                startSideline: true,
-                initialPath: initialPath,
-                currentPath: currentPath,
-              ),
-            ),
-          ),
-        );
-      } else {
-        widgets.addAll(
-          _buildTreeWidget(
-            ctrlProvider,
-            nodes: IList([nodes[i]]),
-            inMainline: false,
-            startSideline: true,
-            initialPath: initialPath,
-            currentPath: currentPath,
-          ),
-        );
-      }
-    }
-
-    // add the children of the first child
-    widgets.addAll(
-      _buildTreeWidget(
-        ctrlProvider,
-        nodes: nodes[0].children,
-        inMainline: inMainline,
-        startSideline: false,
-        initialPath: newPath,
-        currentPath: currentPath,
-      ),
-    );
-
-    return widgets;
-  }
-}
-
-class InlineMove extends ConsumerWidget {
-  const InlineMove(
-    this.ctrlProvider, {
-    required this.path,
-    required this.move,
-    required this.ply,
-    required this.isCurrentMove,
-    required this.isSideline,
-    super.key,
-    this.startSideline = false,
-    this.endSideline = false,
-  });
-
-  final AnalysisCtrlProvider ctrlProvider;
-  final UciPath path;
-  final SanMove move;
-  final int ply;
-  final bool isCurrentMove;
-  final bool isSideline;
-  final bool startSideline;
-  final bool endSideline;
-
-  static const borderRadius = BorderRadius.all(Radius.circular(4.0));
-  static const baseTextStyle = TextStyle(
-    fontFamily: 'ChessFont',
-    fontSize: kChessNotationFontSize,
-    height: 1.5,
-  );
-
-  Color? _textColor(BuildContext context, double opacity) {
-    return defaultTargetPlatform == TargetPlatform.android
-        ? Theme.of(context).textTheme.bodyLarge?.color?.withOpacity(opacity)
-        : CupertinoTheme.of(context)
-            .textTheme
-            .textStyle
-            .color
-            ?.withOpacity(opacity);
-  }
-
-  @override
-  Widget build(BuildContext context, WidgetRef ref) {
-    final textStyle = isSideline
-        ? TextStyle(
-            fontFamily: 'ChessFont',
-            fontSize: kChessNotationFontSize,
-            color: _textColor(context, 0.6),
-          )
-        : baseTextStyle;
-
-    final indexTextStyle = baseTextStyle.copyWith(
-      color: _textColor(context, 0.6),
-    );
-
-    final indexWidget = ply.isOdd
-        ? Text(
-            '${(ply / 2).ceil()}.',
-            style: indexTextStyle,
-          )
-        : (startSideline
-            ? Text(
-                '${(ply / 2).ceil()}...',
-                style: indexTextStyle,
-              )
-            : null);
-
-    return Row(
-      mainAxisSize: MainAxisSize.min,
-      children: [
-        if (startSideline) Text('(', style: textStyle),
-        if (indexWidget != null) indexWidget,
-        if (indexWidget != null) const SizedBox(width: 1),
-        AdaptiveInkWell(
-          borderRadius: borderRadius,
-          onTap: () => ref.read(ctrlProvider.notifier).userJump(path),
-          child: Container(
-            padding: const EdgeInsets.symmetric(horizontal: 1, vertical: 2),
-            decoration: isCurrentMove
-                ? BoxDecoration(
-                    color: Theme.of(context).focusColor,
-                    shape: BoxShape.rectangle,
-                    borderRadius: borderRadius,
-                  )
-                : null,
-            child: Text(
-              move.san,
-              style: isCurrentMove
-                  ? textStyle.copyWith(
-                      color: _textColor(context, 1),
-                      fontWeight: FontWeight.w600,
-                    )
-                  : textStyle,
-            ),
-          ),
-        ),
-        if (endSideline) Text(')', style: textStyle),
-      ],
-    );
-  }
-}
-
 class _BottomBar extends ConsumerWidget {
   const _BottomBar({
     required this.ctrlProvider,
@@ -1015,6 +694,13 @@ class _Preferences extends ConsumerWidget {
               style: Styles.title,
             ),
           ),
+          SwitchSettingTile(
+            title: Text(context.l10n.toggleLocalEvaluation),
+            value: prefs.enableLocalEvaluation,
+            onChanged: (value) {
+              ref.read(ctrlProvider.notifier).toggleLocalEvaluation(value);
+            },
+          ),
           Opacity(
             opacity: state.isEngineAvailable ? 1.0 : 0.5,
             child: PlatformListTile(
diff --git a/lib/src/view/analysis/tree_view.dart b/lib/src/view/analysis/tree_view.dart
new file mode 100644
index 0000000000..781f26e2f9
--- /dev/null
+++ b/lib/src/view/analysis/tree_view.dart
@@ -0,0 +1,387 @@
+import 'package:flutter/cupertino.dart';
+import 'package:flutter/foundation.dart';
+import 'package:flutter/material.dart';
+import 'package:flutter_riverpod/flutter_riverpod.dart';
+import 'package:fast_immutable_collections/fast_immutable_collections.dart';
+
+import 'package:lichess_mobile/src/model/common/chess.dart';
+import 'package:lichess_mobile/src/model/common/node.dart';
+import 'package:lichess_mobile/src/model/common/uci.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_ctrl.dart';
+import 'package:lichess_mobile/src/utils/rate_limit.dart';
+import 'package:lichess_mobile/src/widgets/buttons.dart';
+
+const kChessNotationFontSize = 13.0;
+const kFastReplayDebounceDelay = Duration(milliseconds: 100);
+const kOpeningHeaderHeight = 32.0;
+const kInlineMoveSpacing = 5.0;
+
+class AnalysisTreeView extends ConsumerWidget {
+  const AnalysisTreeView(this.ctrlProvider, this.displayMode);
+
+  final AnalysisCtrlProvider ctrlProvider;
+  final Orientation displayMode;
+
+  @override
+  Widget build(BuildContext context, WidgetRef ref) {
+    final root = ref.watch(ctrlProvider.select((value) => value.root));
+    final currentPath =
+        ref.watch(ctrlProvider.select((value) => value.currentPath));
+
+    return _InlineTreeView(
+      ctrlProvider,
+      root,
+      currentPath,
+      displayMode,
+    );
+  }
+}
+
+class _InlineTreeView extends ConsumerStatefulWidget {
+  const _InlineTreeView(
+    this.ctrlProvider,
+    this.root,
+    this.currentPath,
+    this.displayMode,
+  );
+
+  final AnalysisCtrlProvider ctrlProvider;
+  final ViewRoot root;
+  final UciPath currentPath;
+  final Orientation displayMode;
+
+  @override
+  ConsumerState<_InlineTreeView> createState() => _InlineTreeViewState();
+}
+
+class _InlineTreeViewState extends ConsumerState<_InlineTreeView> {
+  final currentMoveKey = GlobalKey();
+  final _debounce = Debouncer(kFastReplayDebounceDelay);
+
+  @override
+  void initState() {
+    super.initState();
+    WidgetsBinding.instance.addPostFrameCallback((_) {
+      if (currentMoveKey.currentContext != null) {
+        Scrollable.ensureVisible(
+          currentMoveKey.currentContext!,
+          alignment: 0.5,
+          alignmentPolicy: ScrollPositionAlignmentPolicy.keepVisibleAtEnd,
+        );
+      }
+    });
+  }
+
+  @override
+  void dispose() {
+    _debounce.dispose();
+    super.dispose();
+  }
+
+  @override
+  void didUpdateWidget(covariant _InlineTreeView oldWidget) {
+    super.didUpdateWidget(oldWidget);
+    _debounce(() {
+      if (currentMoveKey.currentContext != null) {
+        Scrollable.ensureVisible(
+          currentMoveKey.currentContext!,
+          duration: const Duration(milliseconds: 200),
+          curve: Curves.easeIn,
+          alignment: 0.5,
+          alignmentPolicy: ScrollPositionAlignmentPolicy.explicit,
+        );
+      }
+    });
+  }
+
+  @override
+  Widget build(BuildContext context) {
+    final content = CustomScrollView(
+      slivers: [
+        SliverPersistentHeader(
+          delegate: _OpeningHeaderDelegate(
+            widget.ctrlProvider,
+            displayMode: widget.displayMode,
+          ),
+        ),
+        SliverFillRemaining(
+          hasScrollBody: false,
+          child: Padding(
+            padding: const EdgeInsets.symmetric(vertical: 10, horizontal: 10),
+            child: Wrap(
+              spacing: kInlineMoveSpacing,
+              children: _buildTreeWidget(
+                widget.ctrlProvider,
+                nodes: widget.root.children,
+                inMainline: true,
+                startSideline: false,
+                initialPath: UciPath.empty,
+                currentPath: widget.currentPath,
+              ),
+            ),
+          ),
+        ),
+      ],
+    );
+
+    return switch (widget.displayMode) {
+      Orientation.landscape => content,
+      Orientation.portrait => Expanded(child: content)
+    };
+  }
+
+  List<Widget> _buildTreeWidget(
+    AnalysisCtrlProvider ctrlProvider, {
+    required IList<ViewBranch> nodes,
+    required bool inMainline,
+    required bool startSideline,
+    required UciPath initialPath,
+    required UciPath currentPath,
+  }) {
+    if (nodes.isEmpty) return [];
+    final List<Widget> widgets = [];
+
+    // add the node[0]
+    final newPath = initialPath + nodes[0].id;
+    final currentMove = newPath == currentPath;
+    widgets.add(
+      InlineMove(
+        ctrlProvider,
+        path: newPath,
+        move: nodes[0].sanMove,
+        ply: nodes[0].ply,
+        isCurrentMove: currentMove,
+        key: currentMove ? currentMoveKey : null,
+        isSideline: !inMainline,
+        startSideline: startSideline,
+        endSideline: !inMainline && nodes[0].children.isEmpty,
+      ),
+    );
+
+    // add the sidelines if present
+    for (var i = 1; i < nodes.length; i++) {
+      // start new sideline from mainline on a new line
+      if (inMainline) {
+        widgets.add(
+          SizedBox(
+            width: double.infinity,
+            child: Wrap(
+              spacing: kInlineMoveSpacing,
+              children: _buildTreeWidget(
+                ctrlProvider,
+                nodes: IList([nodes[i]]),
+                inMainline: false,
+                startSideline: true,
+                initialPath: initialPath,
+                currentPath: currentPath,
+              ),
+            ),
+          ),
+        );
+      } else {
+        widgets.addAll(
+          _buildTreeWidget(
+            ctrlProvider,
+            nodes: IList([nodes[i]]),
+            inMainline: false,
+            startSideline: true,
+            initialPath: initialPath,
+            currentPath: currentPath,
+          ),
+        );
+      }
+    }
+
+    // add the children of the first child
+    widgets.addAll(
+      _buildTreeWidget(
+        ctrlProvider,
+        nodes: nodes[0].children,
+        inMainline: inMainline,
+        startSideline: false,
+        initialPath: newPath,
+        currentPath: currentPath,
+      ),
+    );
+
+    return widgets;
+  }
+}
+
+class InlineMove extends ConsumerWidget {
+  const InlineMove(
+    this.ctrlProvider, {
+    required this.path,
+    required this.move,
+    required this.ply,
+    required this.isCurrentMove,
+    required this.isSideline,
+    super.key,
+    this.startSideline = false,
+    this.endSideline = false,
+  });
+
+  final AnalysisCtrlProvider ctrlProvider;
+  final UciPath path;
+  final SanMove move;
+  final int ply;
+  final bool isCurrentMove;
+  final bool isSideline;
+  final bool startSideline;
+  final bool endSideline;
+
+  static const borderRadius = BorderRadius.all(Radius.circular(4.0));
+  static const baseTextStyle = TextStyle(
+    fontFamily: 'ChessFont',
+    fontSize: kChessNotationFontSize,
+    height: 1.5,
+  );
+
+  Color? _textColor(BuildContext context, double opacity) {
+    return defaultTargetPlatform == TargetPlatform.android
+        ? Theme.of(context).textTheme.bodyLarge?.color?.withOpacity(opacity)
+        : CupertinoTheme.of(context)
+            .textTheme
+            .textStyle
+            .color
+            ?.withOpacity(opacity);
+  }
+
+  @override
+  Widget build(BuildContext context, WidgetRef ref) {
+    final textStyle = isSideline
+        ? TextStyle(
+            fontFamily: 'ChessFont',
+            fontSize: kChessNotationFontSize,
+            color: _textColor(context, 0.6),
+          )
+        : baseTextStyle;
+
+    final indexTextStyle = baseTextStyle.copyWith(
+      color: _textColor(context, 0.6),
+    );
+
+    final indexWidget = ply.isOdd
+        ? Text(
+            '${(ply / 2).ceil()}.',
+            style: indexTextStyle,
+          )
+        : (startSideline
+            ? Text(
+                '${(ply / 2).ceil()}...',
+                style: indexTextStyle,
+              )
+            : null);
+
+    return Row(
+      mainAxisSize: MainAxisSize.min,
+      children: [
+        if (startSideline) Text('(', style: textStyle),
+        if (indexWidget != null) indexWidget,
+        if (indexWidget != null) const SizedBox(width: 1),
+        AdaptiveInkWell(
+          borderRadius: borderRadius,
+          onTap: () => ref.read(ctrlProvider.notifier).userJump(path),
+          child: Container(
+            padding: const EdgeInsets.symmetric(horizontal: 1, vertical: 2),
+            decoration: isCurrentMove
+                ? BoxDecoration(
+                    color: Theme.of(context).focusColor,
+                    shape: BoxShape.rectangle,
+                    borderRadius: borderRadius,
+                  )
+                : null,
+            child: Text(
+              move.san,
+              style: isCurrentMove
+                  ? textStyle.copyWith(
+                      color: _textColor(context, 1),
+                      fontWeight: FontWeight.w600,
+                    )
+                  : textStyle,
+            ),
+          ),
+        ),
+        if (endSideline) Text(')', style: textStyle),
+      ],
+    );
+  }
+}
+
+class _OpeningHeaderDelegate extends SliverPersistentHeaderDelegate {
+  const _OpeningHeaderDelegate(
+    this.ctrlProvider, {
+    required this.displayMode,
+  });
+
+  final AnalysisCtrlProvider ctrlProvider;
+  final Orientation displayMode;
+
+  @override
+  Widget build(
+    BuildContext context,
+    double shrinkOffset,
+    bool overlapsContent,
+  ) {
+    return _Opening(ctrlProvider, displayMode);
+  }
+
+  @override
+  double get minExtent => kOpeningHeaderHeight;
+
+  @override
+  double get maxExtent => kOpeningHeaderHeight;
+
+  @override
+  bool shouldRebuild(covariant SliverPersistentHeaderDelegate oldDelegate) =>
+      true;
+}
+
+class _Opening extends ConsumerWidget {
+  const _Opening(this.ctrlProvider, this.displayMode);
+
+  final AnalysisCtrlProvider ctrlProvider;
+  final Orientation displayMode;
+
+  @override
+  Widget build(BuildContext context, WidgetRef ref) {
+    final nodeOpening =
+        ref.watch(ctrlProvider.select((s) => s.currentNode.opening));
+    final branchOpening =
+        ref.watch(ctrlProvider.select((s) => s.currentBranchOpening));
+    final contextOpening =
+        ref.watch(ctrlProvider.select((s) => s.contextOpening));
+    final opening = nodeOpening ?? branchOpening ?? contextOpening;
+
+    return opening != null
+        ? Container(
+            height: kOpeningHeaderHeight,
+            width: double.infinity,
+            decoration: BoxDecoration(
+              color: defaultTargetPlatform == TargetPlatform.iOS
+                  ? CupertinoDynamicColor.resolve(
+                      CupertinoColors.systemGrey5,
+                      context,
+                    )
+                  : Theme.of(context).colorScheme.secondaryContainer,
+              borderRadius: displayMode == Orientation.landscape
+                  ? const BorderRadius.only(
+                      topLeft: Radius.circular(10.0),
+                      topRight: Radius.circular(10.0),
+                    )
+                  : null,
+            ),
+            child: Padding(
+              padding: const EdgeInsets.symmetric(horizontal: 8.0),
+              child: Center(
+                child: Text(
+                  opening.name,
+                  style: const TextStyle(fontSize: kChessNotationFontSize),
+                  overflow: TextOverflow.ellipsis,
+                ),
+              ),
+            ),
+          )
+        : const SizedBox.shrink();
+  }
+}
diff --git a/lib/src/view/game/archived_game_screen.dart b/lib/src/view/game/archived_game_screen.dart
index 2a23579c67..b095d6bf5d 100644
--- a/lib/src/view/game/archived_game_screen.dart
+++ b/lib/src/view/game/archived_game_screen.dart
@@ -15,6 +15,7 @@ import 'package:lichess_mobile/src/widgets/player.dart';
 import 'package:lichess_mobile/src/widgets/countdown_clock.dart';
 import 'package:lichess_mobile/src/widgets/adaptive_action_sheet.dart';
 import 'package:lichess_mobile/src/model/game/game.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_ctrl.dart';
 import 'package:lichess_mobile/src/view/settings/toggle_sound_button.dart';
 
 import 'archived_game_screen_providers.dart';
@@ -235,15 +236,19 @@ class _BottomBar extends ConsumerWidget {
                       context,
                       fullscreenDialog: true,
                       builder: (context) => AnalysisScreen(
-                        variant: gameData.variant,
-                        steps: ref
-                            .read(gameCursorProvider(gameData.id))
-                            .requireValue
-                            .$1
-                            .steps,
-                        orientation: orientation,
-                        id: gameData.id,
                         title: context.l10n.gameAnalysis,
+                        options: AnalysisOptions(
+                          isLocalEvaluationAllowed: true,
+                          variant: gameData.variant,
+                          steps: ref
+                              .read(gameCursorProvider(gameData.id))
+                              .requireValue
+                              .$1
+                              .steps,
+                          orientation: orientation,
+                          id: gameData.id,
+                          opening: gameData.opening,
+                        ),
                       ),
                     )
                 : null,
diff --git a/lib/src/view/game/game_screen.dart b/lib/src/view/game/game_screen.dart
index 35a2f80b2d..e79864f8f1 100644
--- a/lib/src/view/game/game_screen.dart
+++ b/lib/src/view/game/game_screen.dart
@@ -8,6 +8,7 @@ import 'package:chessground/chessground.dart' as cg;
 
 import 'package:lichess_mobile/src/model/auth/auth_socket.dart';
 import 'package:lichess_mobile/src/model/account/account_repository.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_ctrl.dart';
 import 'package:lichess_mobile/src/model/game/game_ctrl.dart';
 import 'package:lichess_mobile/src/model/game/game_status.dart';
 import 'package:lichess_mobile/src/model/game/game_repository_providers.dart';
@@ -504,10 +505,13 @@ class _GameBottomBar extends ConsumerWidget {
                   context,
                   fullscreenDialog: true,
                   builder: (_) => AnalysisScreen(
-                    variant: gameState.game.meta.variant,
-                    steps: gameState.game.steps,
-                    orientation: gameState.game.youAre ?? Side.white,
-                    id: gameState.game.meta.id,
+                    options: AnalysisOptions(
+                      isLocalEvaluationAllowed: true,
+                      variant: gameState.game.meta.variant,
+                      steps: gameState.game.steps,
+                      orientation: gameState.game.youAre ?? Side.white,
+                      id: gameState.game.meta.id,
+                    ),
                     title: context.l10n.gameAnalysis,
                   ),
                 ),
diff --git a/test/model/game/game_repository_test.dart b/test/model/game/game_repository_test.dart
index b08091d0bd..1db3fe5992 100644
--- a/test/model/game/game_repository_test.dart
+++ b/test/model/game/game_repository_test.dart
@@ -36,7 +36,7 @@ void main() {
       when(
         () => mockAuthClient.get(
           Uri.parse(
-            '$kLichessHost/api/games/user/testUser?max=10&moves=false&lastFen=true&accuracy=true',
+            '$kLichessHost/api/games/user/testUser?max=10&moves=false&lastFen=true&accuracy=true&opening=true',
           ),
           headers: {'Accept': 'application/x-ndjson'},
         ),
@@ -96,6 +96,11 @@ void main() {
       final result = await repo.getGame(const GameId('qVChCOTc'));
 
       expect(result.isValue, true);
+
+      final game = result.asValue!.value;
+
+      expect(game.data.id, const GameId('qVChCOTc'));
+      expect(game.data.opening?.eco, 'C20');
     });
 
     test('game with analysis', () async {
diff --git a/test/test_app.dart b/test/test_app.dart
index 95275b355d..3d77c021db 100644
--- a/test/test_app.dart
+++ b/test/test_app.dart
@@ -43,7 +43,10 @@ Future<Widget> buildTestApp(
   AuthSessionState? userSession,
 }) async {
   await tester.binding.setSurfaceSize(kTestSurfaceSize);
+
+  // disable stockfish in analysis screen tests
   SharedPreferences.setMockInitialValues({});
+
   final sharedPreferences = await SharedPreferences.getInstance();
 
   FlutterSecureStorage.setMockInitialValues({
diff --git a/test/ui/analysis/analysis_screen_test.dart b/test/ui/analysis/analysis_screen_test.dart
index d5bbdeb676..6e3107d892 100644
--- a/test/ui/analysis/analysis_screen_test.dart
+++ b/test/ui/analysis/analysis_screen_test.dart
@@ -12,7 +12,9 @@ import 'package:lichess_mobile/src/model/common/speed.dart';
 import 'package:lichess_mobile/src/model/game/game.dart';
 import 'package:lichess_mobile/src/model/game/game_status.dart';
 import 'package:lichess_mobile/src/model/game/player.dart';
+import 'package:lichess_mobile/src/model/analysis/analysis_ctrl.dart';
 import 'package:lichess_mobile/src/view/analysis/analysis_screen.dart';
+import 'package:lichess_mobile/src/view/analysis/tree_view.dart';
 import 'package:lichess_mobile/src/widgets/buttons.dart';
 
 import '../../test_app.dart';
@@ -44,10 +46,13 @@ void main() {
       final app = await buildTestApp(
         tester,
         home: AnalysisScreen(
-          variant: Variant.standard,
-          steps: gameStep,
-          orientation: Side.white,
-          id: gameData.id,
+          options: AnalysisOptions(
+            isLocalEvaluationAllowed: false,
+            variant: Variant.standard,
+            steps: gameStep,
+            orientation: Side.white,
+            id: gameData.id,
+          ),
         ),
       );
 
@@ -62,14 +67,18 @@ void main() {
         isTrue,
       );
     });
+
     testWidgets('move backwards and forward', (tester) async {
       final app = await buildTestApp(
         tester,
         home: AnalysisScreen(
-          variant: Variant.standard,
-          steps: gameStep,
-          orientation: Side.white,
-          id: gameData.id,
+          options: AnalysisOptions(
+            isLocalEvaluationAllowed: false,
+            variant: Variant.standard,
+            steps: gameStep,
+            orientation: Side.white,
+            id: gameData.id,
+          ),
         ),
       );
 
