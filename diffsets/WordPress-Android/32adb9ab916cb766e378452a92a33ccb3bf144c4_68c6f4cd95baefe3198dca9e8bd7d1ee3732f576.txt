diff --git a/WordPressEditor/build.gradle b/WordPressEditor/build.gradle
index bb309fceca76..f7f2fa7d1849 100644
--- a/WordPressEditor/build.gradle
+++ b/WordPressEditor/build.gradle
@@ -3,7 +3,7 @@ buildscript {
         jcenter()
     }
     dependencies {
-        classpath 'com.android.tools.build:gradle:1.5.0'
+        classpath 'com.android.tools.build:gradle:2.0.0-beta4'
     }
 }
 
@@ -48,7 +48,7 @@ android {
 dependencies {
     compile 'com.android.support:appcompat-v7:23.1.1'
     compile 'com.android.support:support-v4:23.1.1'
-    compile 'org.wordpress:utils:1.7.0'
+    compile 'org.wordpress:utils:1.9.0'
 
     // Test libraries
     testCompile 'junit:junit:4.11'
diff --git a/WordPressEditor/src/androidTest/java/org.wordpress.android.editor/MockEditorActivity.java b/WordPressEditor/src/androidTest/java/org.wordpress.android.editor/MockEditorActivity.java
index fed7a083739d..716c3590f17d 100644
--- a/WordPressEditor/src/androidTest/java/org.wordpress.android.editor/MockEditorActivity.java
+++ b/WordPressEditor/src/androidTest/java/org.wordpress.android.editor/MockEditorActivity.java
@@ -6,6 +6,7 @@
 import android.support.v7.app.AppCompatActivity;
 import android.widget.LinearLayout;
 
+import org.wordpress.android.editor.EditorFragmentAbstract.TrackableEvent;
 import org.wordpress.android.util.helpers.MediaFile;
 
 public class MockEditorActivity extends AppCompatActivity implements EditorFragmentAbstract.EditorFragmentListener {
@@ -75,5 +76,10 @@ public String onAuthHeaderRequested(String url) {
     public void saveMediaFile(MediaFile mediaFile) {
 
     }
+
+    @Override
+    public void onTrackableEvent(TrackableEvent event) {
+
+    }
 }
 
diff --git a/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragment.java b/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragment.java
index ad019edb4e84..6667308d0063 100755
--- a/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragment.java
+++ b/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragment.java
@@ -36,6 +36,7 @@
 import org.wordpress.android.util.AppLog;
 import org.wordpress.android.util.AppLog.T;
 import org.wordpress.android.util.JSONUtils;
+import org.wordpress.android.util.ShortcodeUtils;
 import org.wordpress.android.util.StringUtils;
 import org.wordpress.android.util.ToastUtils;
 import org.wordpress.android.util.UrlUtils;
@@ -94,7 +95,7 @@ public class EditorFragment extends EditorFragmentAbstract implements View.OnCli
 
     private ConcurrentHashMap<String, MediaFile> mWaitingMediaFiles;
     private Set<MediaGallery> mWaitingGalleries;
-    private Set<String> mUploadingMediaIds;
+    private Map<String, MediaType> mUploadingMedia;
     private Set<String> mFailedMediaIds;
     private MediaGallery mUploadingMediaGallery;
 
@@ -135,7 +136,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa
 
         mWaitingMediaFiles = new ConcurrentHashMap<>();
         mWaitingGalleries = Collections.newSetFromMap(new ConcurrentHashMap<MediaGallery, Boolean>());
-        mUploadingMediaIds = new HashSet<>();
+        mUploadingMedia = new HashMap<>();
         mFailedMediaIds = new HashSet<>();
 
         // -- WebView configuration
@@ -232,7 +233,7 @@ public void onResume() {
     @Override
     public void onDetach() {
         // Soft cancel (delete flag off) all media uploads currently in progress
-        for (String mediaId : mUploadingMediaIds) {
+        for (String mediaId : mUploadingMedia.keySet()) {
             mEditorFragmentListener.onMediaUploadCancelClicked(mediaId, false);
         }
         super.onDetach();
@@ -397,7 +398,7 @@ public void onClick(View v) {
             mEditorFragmentListener.onTrackableEvent(TrackableEvent.HTML_BUTTON_TAPPED);
 
             // Don't switch to HTML mode if currently uploading media
-            if (!mUploadingMediaIds.isEmpty()) {
+            if (!mUploadingMedia.isEmpty()) {
                 ((ToggleButton) v).setChecked(false);
 
                 if (isAdded()) {
@@ -744,14 +745,30 @@ public void appendMediaFile(final MediaFile mediaFile, final String mediaUrl, Im
             public void run() {
                 if (URLUtil.isNetworkUrl(mediaUrl)) {
                     String mediaId = mediaFile.getMediaId();
-                    mWebView.execJavaScriptFromString("ZSSEditor.insertImage('" + mediaUrl + "', '" + mediaId + "');");
-                    mEditorFragmentListener.onTrackableEvent(TrackableEvent.NETWORK_IMAGE_ADDED);
+                    if (mediaFile.isVideo()) {
+                        String videoPressId = ShortcodeUtils.getVideoPressIdFromShortCode(
+                                mediaFile.getVideoPressShortCode());
+
+                        mWebView.execJavaScriptFromString("ZSSEditor.insertVideo('" + mediaUrl + "', '" +
+                                mediaFile.getThumbnailURL() + "', '" + videoPressId +  "');");
+                    } else {
+                        mWebView.execJavaScriptFromString("ZSSEditor.insertImage('" + mediaUrl + "', '" + mediaId +
+                                "');");
+                    }
                 } else {
                     String id = mediaFile.getMediaId();
-                    mWebView.execJavaScriptFromString("ZSSEditor.insertLocalImage(" + id + ", '" + mediaUrl + "');");
-                    mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + id + ", " + 0 + ");");
-                    mUploadingMediaIds.add(id);
-                    mEditorFragmentListener.onTrackableEvent(TrackableEvent.LOCAL_IMAGE_ADDED);
+                    if (mediaFile.isVideo()) {
+                        String posterUrl = StringUtils.notNullStr(mediaFile.getThumbnailURL());
+                        mWebView.execJavaScriptFromString("ZSSEditor.insertLocalVideo(" + id + ", '" + posterUrl +
+                                "');");
+                        mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnVideo(" + id + ", " + 0 + ");");
+                        mUploadingMedia.put(id, MediaType.VIDEO);
+                    } else {
+                        mWebView.execJavaScriptFromString("ZSSEditor.insertLocalImage(" + id + ", '" + mediaUrl +
+                                "');");
+                        mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + id + ", " + 0 + ");");
+                        mUploadingMedia.put(id, MediaType.IMAGE);
+                    }
                 }
             }
         });
@@ -812,26 +829,43 @@ public void setContentPlaceholder(CharSequence placeholderText) {
 
     @Override
     public void onMediaUploadSucceeded(final String mediaId, final String remoteId, final String remoteUrl) {
-        mWebView.post(new Runnable() {
-            @Override
-            public void run() {
-                mWebView.execJavaScriptFromString("ZSSEditor.replaceLocalImageWithRemoteImage(" + mediaId + ", '" +
-                        remoteId + "', '" + remoteUrl + "');");
-                mUploadingMediaIds.remove(mediaId);
-            }
-        });
+        final MediaType mediaType = mUploadingMedia.get(mediaId);
+        if (mediaType != null) {
+            mWebView.post(new Runnable() {
+                @Override
+                public void run() {
+                    if (mediaType.equals(MediaType.IMAGE)) {
+                        mWebView.execJavaScriptFromString("ZSSEditor.replaceLocalImageWithRemoteImage(" + mediaId +
+                                ", '" + remoteId + "', '" + remoteUrl + "');");
+                    } else if (mediaType.equals(MediaType.VIDEO)) {
+                        // TODO: Obtain the poster URL and the VideoPress id (where applicable) and pass them here
+                        mWebView.execJavaScriptFromString("ZSSEditor.replaceLocalVideoWithRemoteVideo(" + mediaId +
+                                ", '" + remoteUrl + "', '" + "', '');");
+                    }
+                    mUploadingMedia.remove(mediaId);
+                }
+            });
+        }
     }
 
     @Override
     public void onMediaUploadProgress(final String mediaId, final float progress) {
-        mWebView.post(new Runnable() {
-            @Override
-            public void run() {
-                String progressString = String.format(Locale.US, "%.1f", progress);
-                mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + mediaId + ", " +
-                        progressString + ");");
-            }
-        });
+        final MediaType mediaType = mUploadingMedia.get(mediaId);
+        if (mediaType != null) {
+            mWebView.post(new Runnable() {
+                @Override
+                public void run() {
+                    String progressString = String.format(Locale.US, "%.1f", progress);
+                    if (mediaType.equals(MediaType.IMAGE)) {
+                        mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + mediaId + ", " +
+                                progressString + ");");
+                    } else if (mediaType.equals(MediaType.VIDEO)) {
+                        mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnVideo(" + mediaId + ", " +
+                                progressString + ");");
+                    }
+                }
+            });
+        }
     }
 
     @Override
@@ -839,10 +873,16 @@ public void onMediaUploadFailed(final String mediaId) {
         mWebView.post(new Runnable() {
             @Override
             public void run() {
-                mEditorFragmentListener.onTrackableEvent(TrackableEvent.UPLOAD_IMAGE_FAILED);
-                mWebView.execJavaScriptFromString("ZSSEditor.markImageUploadFailed(" + mediaId + ");");
+                MediaType mediaType = mUploadingMedia.get(mediaId);
+                switch (mediaType) {
+                    case IMAGE:
+                        mWebView.execJavaScriptFromString("ZSSEditor.markImageUploadFailed(" + mediaId + ");");
+                        break;
+                    case VIDEO:
+                        mWebView.execJavaScriptFromString("ZSSEditor.markVideoUploadFailed(" + mediaId + ");");
+                }
                 mFailedMediaIds.add(mediaId);
-                mUploadingMediaIds.remove(mediaId);
+                mUploadingMedia.remove(mediaId);
             }
         });
     }
@@ -961,7 +1001,11 @@ public void run() {
         });
     }
 
-    public void onMediaTapped(final String mediaId, String url, final JSONObject meta, String uploadStatus) {
+    public void onMediaTapped(final String mediaId, final MediaType mediaType, final JSONObject meta, String uploadStatus) {
+        if (mediaType == null) {
+            return;
+        }
+
         switch (uploadStatus) {
             case "uploading":
                 // Display 'cancel upload' dialog
@@ -974,8 +1018,14 @@ public void onClick(DialogInterface dialog, int id) {
                         mWebView.post(new Runnable() {
                             @Override
                             public void run() {
-                                mWebView.execJavaScriptFromString("ZSSEditor.removeImage(" + mediaId + ");");
-                                mUploadingMediaIds.remove(mediaId);
+                                switch (mediaType) {
+                                    case IMAGE:
+                                        mWebView.execJavaScriptFromString("ZSSEditor.removeImage(" + mediaId + ");");
+                                        break;
+                                    case VIDEO:
+                                        mWebView.execJavaScriptFromString("ZSSEditor.removeVideo(" + mediaId + ");");
+                                }
+                                mUploadingMedia.remove(mediaId);
                             }
                         });
                         dialog.dismiss();
@@ -998,16 +1048,30 @@ public void onClick(DialogInterface dialog, int id) {
                 mWebView.post(new Runnable() {
                     @Override
                     public void run() {
-                        mEditorFragmentListener.onTrackableEvent(TrackableEvent.UPLOAD_IMAGE_RETRIED);
-                        mWebView.execJavaScriptFromString("ZSSEditor.unmarkImageUploadFailed(" + mediaId + ");");
-                        mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + mediaId + ", " + 0 + ");");
+                        switch (mediaType) {
+                            case IMAGE:
+                                mWebView.execJavaScriptFromString("ZSSEditor.unmarkImageUploadFailed(" + mediaId
+                                        + ");");
+                                mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnImage(" + mediaId + ", "
+                                        + 0 + ");");
+                                break;
+                            case VIDEO:
+                                mWebView.execJavaScriptFromString("ZSSEditor.unmarkVideoUploadFailed(" + mediaId
+                                        + ");");
+                                mWebView.execJavaScriptFromString("ZSSEditor.setProgressOnVideo(" + mediaId + ", "
+                                        + 0 + ");");
+                        }
                         mFailedMediaIds.remove(mediaId);
-                        mUploadingMediaIds.add(mediaId);
+                        mUploadingMedia.put(mediaId, mediaType);
                     }
                 });
                 break;
             default:
-                // Show media options fragment
+                if (!mediaType.equals(MediaType.IMAGE)) {
+                    return;
+                }
+
+                // Only show image options fragment for image taps
                 FragmentManager fragmentManager = getFragmentManager();
 
                 if (fragmentManager.findFragmentByTag(ImageSettingsDialogFragment.IMAGE_SETTINGS_DIALOG_TAG) != null) {
diff --git a/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragmentAbstract.java b/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragmentAbstract.java
index d32294200e49..d2eb0d011709 100644
--- a/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragmentAbstract.java
+++ b/WordPressEditor/src/main/java/org/wordpress/android/editor/EditorFragmentAbstract.java
@@ -27,6 +27,21 @@ public abstract class EditorFragmentAbstract extends Fragment {
     // TODO: remove this as soon as we can (we'll need to drop the legacy editor or fix html2spanned translation)
     public abstract Spanned getSpannedContent();
 
+    public enum MediaType {
+        IMAGE, VIDEO;
+
+        public static MediaType fromString(String value) {
+            if (value != null) {
+                for (MediaType mediaType : MediaType.values()) {
+                    if (value.equalsIgnoreCase(mediaType.toString())) {
+                        return mediaType;
+                    }
+                }
+            }
+            return null;
+        }
+    }
+
     private static final String FEATURED_IMAGE_SUPPORT_KEY = "featured-image-supported";
     private static final String FEATURED_IMAGE_WIDTH_KEY   = "featured-image-width";
 
@@ -137,10 +152,6 @@ public enum TrackableEvent {
         UNLINK_BUTTON_TAPPED,
         LINK_BUTTON_TAPPED,
         MEDIA_BUTTON_TAPPED,
-        NETWORK_IMAGE_ADDED,
-        LOCAL_IMAGE_ADDED,
-        UPLOAD_IMAGE_FAILED,
-        UPLOAD_IMAGE_RETRIED,
         IMAGE_EDITED,
         BOLD_BUTTON_TAPPED,
         ITALIC_BUTTON_TAPPED,
diff --git a/WordPressEditor/src/main/java/org/wordpress/android/editor/JsCallbackReceiver.java b/WordPressEditor/src/main/java/org/wordpress/android/editor/JsCallbackReceiver.java
index 6e74071c66a4..afdc129f53a3 100755
--- a/WordPressEditor/src/main/java/org/wordpress/android/editor/JsCallbackReceiver.java
+++ b/WordPressEditor/src/main/java/org/wordpress/android/editor/JsCallbackReceiver.java
@@ -13,6 +13,8 @@
 import java.util.Map;
 import java.util.Set;
 
+import static org.wordpress.android.editor.EditorFragmentAbstract.MediaType;
+
 public class JsCallbackReceiver {
     private static final String JS_CALLBACK_DELIMITER = "~";
 
@@ -103,6 +105,7 @@ public void executeCallback(String callbackId, String params) {
                 mediaIds.add("id");
                 mediaIds.add("url");
                 mediaIds.add("meta");
+                mediaIds.add("type");
 
                 Set<String> mediaDataSet = Utils.splitValuePairDelimitedString(params, JS_CALLBACK_DELIMITER, mediaIds);
                 Map<String, String> mediaDataMap = Utils.buildMapFromKeyValuePairs(mediaDataSet);
@@ -114,6 +117,8 @@ public void executeCallback(String callbackId, String params) {
                     mediaUrl = Utils.decodeHtml(mediaUrl);
                 }
 
+                MediaType mediaType = MediaType.fromString(mediaDataMap.get("type"));
+
                 String mediaMeta = mediaDataMap.get("meta");
                 JSONObject mediaMetaJson = new JSONObject();
 
@@ -136,7 +141,7 @@ public void executeCallback(String callbackId, String params) {
                     }
                 }
 
-                mListener.onMediaTapped(mediaId, mediaUrl, mediaMetaJson, uploadStatus);
+                mListener.onMediaTapped(mediaId, mediaType, mediaMetaJson, uploadStatus);
                 break;
             case CALLBACK_LINK_TAP:
                 // Extract and HTML-decode the link data from the callback params
diff --git a/WordPressEditor/src/main/java/org/wordpress/android/editor/OnJsEditorStateChangedListener.java b/WordPressEditor/src/main/java/org/wordpress/android/editor/OnJsEditorStateChangedListener.java
index 27d9b7fa5082..58de357ea496 100755
--- a/WordPressEditor/src/main/java/org/wordpress/android/editor/OnJsEditorStateChangedListener.java
+++ b/WordPressEditor/src/main/java/org/wordpress/android/editor/OnJsEditorStateChangedListener.java
@@ -4,11 +4,13 @@
 
 import java.util.Map;
 
+import static org.wordpress.android.editor.EditorFragmentAbstract.MediaType;
+
 public interface OnJsEditorStateChangedListener {
     void onDomLoaded();
     void onSelectionChanged(Map<String, String> selectionArgs);
     void onSelectionStyleChanged(Map<String, Boolean> changeSet);
-    void onMediaTapped(String mediaId, String url, JSONObject meta, String uploadStatus);
+    void onMediaTapped(String mediaId, MediaType mediaType, JSONObject meta, String uploadStatus);
     void onLinkTapped(String url, String title);
     void onVideoPressInfoRequested(String videoId);
     void onGetHtmlResponse(Map<String, String> responseArgs);
diff --git a/example/build.gradle b/example/build.gradle
index 092a0951d237..dca063454614 100644
--- a/example/build.gradle
+++ b/example/build.gradle
@@ -3,7 +3,7 @@ buildscript {
         jcenter()
     }
     dependencies {
-        classpath 'com.android.tools.build:gradle:1.5.0'
+        classpath 'com.android.tools.build:gradle:2.0.0-beta4'
     }
 }
 
diff --git a/example/src/main/java/org/wordpress/example/EditorExampleActivity.java b/example/src/main/java/org/wordpress/example/EditorExampleActivity.java
index cf7d0ed300d4..cea3d30c7883 100644
--- a/example/src/main/java/org/wordpress/example/EditorExampleActivity.java
+++ b/example/src/main/java/org/wordpress/example/EditorExampleActivity.java
@@ -37,8 +37,10 @@ public class EditorExampleActivity extends AppCompatActivity implements EditorFr
 
     public static final String MEDIA_REMOTE_ID_SAMPLE = "123";
 
-    private static final int SELECT_PHOTO_MENU_POSITION = 0;
-    private static final int SELECT_PHOTO_FAIL_MENU_POSITION = 1;
+    private static final int SELECT_IMAGE_MENU_POSITION = 0;
+    private static final int SELECT_IMAGE_FAIL_MENU_POSITION = 1;
+    private static final int SELECT_VIDEO_MENU_POSITION = 2;
+    private static final int SELECT_VIDEO_FAIL_MENU_POSITION = 3;
 
     private EditorFragmentAbstract mEditorFragment;
 
@@ -79,8 +81,10 @@ public void onBackPressed() {
 
     @Override
     public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {
-        menu.add(0, SELECT_PHOTO_MENU_POSITION, 0, getString(R.string.select_photo));
-        menu.add(0, SELECT_PHOTO_FAIL_MENU_POSITION, 0, getString(R.string.select_photo_fail));
+        menu.add(0, SELECT_IMAGE_MENU_POSITION, 0, getString(R.string.select_image));
+        menu.add(0, SELECT_IMAGE_FAIL_MENU_POSITION, 0, getString(R.string.select_image_fail));
+        menu.add(0, SELECT_VIDEO_MENU_POSITION, 0, getString(R.string.select_video));
+        menu.add(0, SELECT_VIDEO_FAIL_MENU_POSITION, 0, getString(R.string.select_video_fail));
     }
 
     @Override
@@ -88,17 +92,31 @@ public boolean onContextItemSelected(MenuItem item) {
         Intent intent = new Intent(Intent.ACTION_PICK);
 
         switch (item.getItemId()) {
-            case SELECT_PHOTO_MENU_POSITION:
+            case SELECT_IMAGE_MENU_POSITION:
                 intent.setType("image/*");
                 intent.setAction(Intent.ACTION_GET_CONTENT);
-                intent = Intent.createChooser(intent, getString(R.string.select_photo));
+                intent = Intent.createChooser(intent, getString(R.string.select_image));
 
                 startActivityForResult(intent, ADD_MEDIA_ACTIVITY_REQUEST_CODE);
                 return true;
-            case SELECT_PHOTO_FAIL_MENU_POSITION:
+            case SELECT_IMAGE_FAIL_MENU_POSITION:
                 intent.setType("image/*");
                 intent.setAction(Intent.ACTION_GET_CONTENT);
-                intent = Intent.createChooser(intent, getString(R.string.select_photo_fail));
+                intent = Intent.createChooser(intent, getString(R.string.select_image_fail));
+
+                startActivityForResult(intent, ADD_MEDIA_FAIL_ACTIVITY_REQUEST_CODE);
+                return true;
+            case SELECT_VIDEO_MENU_POSITION:
+                intent.setType("video/*");
+                intent.setAction(Intent.ACTION_GET_CONTENT);
+                intent = Intent.createChooser(intent, getString(R.string.select_video));
+
+                startActivityForResult(intent, ADD_MEDIA_ACTIVITY_REQUEST_CODE);
+                return true;
+            case SELECT_VIDEO_FAIL_MENU_POSITION:
+                intent.setType("video/*");
+                intent.setAction(Intent.ACTION_GET_CONTENT);
+                intent = Intent.createChooser(intent, getString(R.string.select_video_fail));
 
                 startActivityForResult(intent, ADD_MEDIA_FAIL_ACTIVITY_REQUEST_CODE);
                 return true;
@@ -120,6 +138,7 @@ public void onActivityResult(int requestCode, int resultCode, Intent data) {
         MediaFile mediaFile = new MediaFile();
         String mediaId = String.valueOf(System.currentTimeMillis());
         mediaFile.setMediaId(mediaId);
+        mediaFile.setVideo(imageUri.toString().contains("video"));
 
         switch (requestCode) {
             case ADD_MEDIA_ACTIVITY_REQUEST_CODE:
diff --git a/example/src/main/res/values/strings.xml b/example/src/main/res/values/strings.xml
index 753eff8d993f..bfffb0de8fb7 100644
--- a/example/src/main/res/values/strings.xml
+++ b/example/src/main/res/values/strings.xml
@@ -13,6 +13,8 @@
         <![CDATA[<p>Post 2 Content</p><blockquote>Quoted text</blockquote><br/>]]>
     </string>
 
-    <string name="select_photo">Select a photo</string>
-    <string name="select_photo_fail">Select a photo (failure demo)</string>
+    <string name="select_image">Select an image</string>
+    <string name="select_image_fail">Select an image (failure demo)</string>
+    <string name="select_video">Select a video</string>
+    <string name="select_video_fail">Select a video (failure demo)</string>
 </resources>
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index 0c71e760dc93..d57051703e32 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -3,4 +3,4 @@ distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-2.2.1-all.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-2.10-all.zip
diff --git a/libs/editor-common/assets/ZSSRichTextEditor.js b/libs/editor-common/assets/ZSSRichTextEditor.js
index 3e8b3109f468..b10a0742887c 100755
--- a/libs/editor-common/assets/ZSSRichTextEditor.js
+++ b/libs/editor-common/assets/ZSSRichTextEditor.js
@@ -1138,45 +1138,76 @@ ZSSEditor.removeImage = function(imageNodeIdentifier) {
  *  @brief Inserts a video tag using the videoURL as source and posterURL as the
  *  image to show while video is loading.
  *
- *  @param videoURL  the url of the video to present
- *  @param posterURL the url of an image to show while the video is loading
- *  @param alt       the alt description when the video is not supported.
+ *  @param videoURL     the url of the video
+ *  @param posterURL    the url of an image to show while the video is loading
+ *  @param videoPressID the VideoPress ID of the video, when applicable
  *
  */
-ZSSEditor.insertVideo = function(videoURL, posterURL, alt) {
-    var html = '<video controls webkit-playsinline poster="' + posterURL+ '"><source src="'
-    + videoURL + '" type="video/mp4"/>' + alt + '</video>';
+ZSSEditor.insertVideo = function(videoURL, posterURL, videopressID) {
+    var html = '<video webkit-playsinline src="' + videoURL + '" onclick="" controls="controls" preload="metadata"';
 
-    this.insertHTML(html);
+    if (posterURL != '') {
+        html += ' poster="' + posterURL + '"';
+    }
+
+    if (videopressID != '') {
+        html += ' data-wpvideopress="' + videopressID + '"';
+    }
+
+    html += '></video>';
+
+    this.insertHTML(this.wrapInParagraphTags(html));
     this.sendEnabledStyles();
 };
 
 /**
- *  @brief      Inserts a video tag marked with a identifier using only a poster image.  Useful for videos that need to be uploaded.
- *  @details    By inserting a video with only a porter URL, we can make sure the video element is shown to the user
- *              as soon as it's selected for uploading.  Once the video is successfully uploaded
- *              the application should call replaceLocalVideoWithRemoteVideo().
+ *  @brief      Inserts a placeholder image tag for in-progress video uploads, marked with an identifier.
+ *  @details    The image shown can be the video's poster if available - otherwise the default poster image is used.
+ *              Using an image instead of a video placeholder is a departure from iOS, necessary because the original
+ *              method caused occasional WebView freezes on Android.
+ *              Once the video is successfully uploaded, the application should call replaceLocalVideoWithRemoteVideo().
  *
  *  @param      videoNodeIdentifier     This is a unique ID provided by the caller.  It exists as
  *                                      a mechanism to update the video node with the remote URL
  *                                      when replaceLocalVideoWithRemoteVideo() is called.
  *  @param      posterURL               The URL of a poster image to display while the video is being uploaded.
  */
-ZSSEditor.insertInProgressVideoWithIDUsingPosterImage = function(videoNodeIdentifier, posterURL) {
-    var space = '&nbsp';
+ZSSEditor.insertLocalVideo = function(videoNodeIdentifier, posterURL) {
     var progressIdentifier = this.getVideoProgressIdentifier(videoNodeIdentifier);
     var videoContainerIdentifier = this.getVideoContainerIdentifier(videoNodeIdentifier);
-    var videoContainerStart = '<span id="' + videoContainerIdentifier + '" class="video_container">';
+
+    if (ZSSEditor.androidApiLevel > 18) {
+        var videoContainerClass = 'video_container';
+        var progressElement = '<progress id="' + progressIdentifier + '" value=0 class="wp_media_indicator"'
+                + 'contenteditable="false"></progress>';
+    } else {
+        // Before API 19, the WebView didn't support progress tags. Use an upload overlay instead of a progress bar
+        var videoContainerClass = 'video_container compat';
+        var progressElement = '<span class="upload-overlay" contenteditable="false">' + nativeState.getStringUploading()
+                + '</span><span class="upload-overlay-bg"></span>';
+    }
+
+    var videoContainerStart = '<span id="' + videoContainerIdentifier + '" class="' + videoContainerClass
+            + '" contenteditable="false" data-failed="' + nativeState.getStringTapToRetry() + '">';
     var videoContainerEnd = '</span>';
-    var progress = '<progress id="' + progressIdentifier + '" value=0  class="wp_media_indicator"  contenteditable="false"></progress>';
-    var video = '<video data-wpid="' + videoNodeIdentifier + '" webkit-playsinline poster="' + posterURL + '" onclick="" class="uploading"></video>';
-    var html =  space + videoContainerStart + progress + video + videoContainerEnd + space;
-    this.insertHTML(html);
+
+    if (posterURL == '') {
+       posterURL = "wpposter.svg";
+    }
+
+    var image = '<img data-video_wpid="' + videoNodeIdentifier + '" src="' + posterURL + '" alt="" />';
+    var html = videoContainerStart + progressElement + image + videoContainerEnd;
+
+    this.insertHTML(this.wrapInParagraphTags(html));
     this.sendEnabledStyles();
 };
 
 ZSSEditor.getVideoNodeWithIdentifier = function(videoNodeIdentifier) {
-    return $('video[data-wpid="' + videoNodeIdentifier+'"]');
+    var videoNode = $('img[data-video_wpid="' + videoNodeIdentifier+'"]');
+    if (videoNode.length == 0) {
+        videoNode = $('video[data-wpid="' + videoNodeIdentifier+'"]');
+    }
+    return videoNode;
 };
 
 ZSSEditor.getVideoProgressIdentifier = function(videoNodeIdentifier) {
@@ -1195,40 +1226,42 @@ ZSSEditor.getVideoContainerNodeWithIdentifier = function(videoNodeIdentifier) {
     return $('#'+this.getVideoContainerIdentifier(videoNodeIdentifier));
 };
 
-
 /**
- *  @brief      Replaces a local Video URL with a remote Video URL.  Useful for videos that have
- *              just finished uploading.
- *  @details    The remote Video can be available after a while, when uploading Videos.  This method
- *              allows for the remote URL to be loaded once the upload completes.
+ *  @brief      Replaces the image placeholder with a video element containing the uploaded video's attributes,
+ *              and removes the upload container.
  *
- *  @param      videoNodeIdentifier     This is a unique ID provided by the caller.  It exists as
- *                                      a mechanism to update the Video node with the remote URL
- *                                      when replaceLocalVideoWithRemoteVideo() is called.
- *  @param      remoteVideoUrl          The URL of the remote Video to display.
- *  @param      remotePosterUrl         The URL of thre remote poster image to display
- *  @param      videopressID          VideoPress Guid of the video if any
+ *  @param      videoNodeIdentifier     The unique id of the video upload
+ *  @param      remoteVideoUrl          The URL of the remote video to display
+ *  @param      remotePosterUrl         The URL of the remote poster image to display
+ *  @param      videopressID            The VideoPress ID of the video, where applicable
  */
 ZSSEditor.replaceLocalVideoWithRemoteVideo = function(videoNodeIdentifier, remoteVideoUrl, remotePosterUrl, videopressID) {
-    var videoNode = this.getVideoNodeWithIdentifier(videoNodeIdentifier);
+    var imagePlaceholderNode = this.getVideoNodeWithIdentifier(videoNodeIdentifier);
 
-    if (videoNode.length == 0) {
-        // even if the Video is not present anymore we must do callback
-        this.markVideoUploadDone(videoNodeIdentifier);
-        return;
-    }
-    videoNode.attr('src', remoteVideoUrl);
-    videoNode.attr('controls', '');
-    videoNode.attr('preload', 'metadata');
-    if (videopressID != '') {
-        videoNode.attr('data-wpvideopress', videopressID);
+    if (imagePlaceholderNode.length != 0) {
+        var videoNode = document.createElement("video");
+        videoNode.setAttribute('webkit-playsinline', '');
+        videoNode.setAttribute('onclick', '');
+        videoNode.setAttribute('src', remoteVideoUrl);
+        videoNode.setAttribute('controls', 'controls');
+        videoNode.setAttribute('preload', 'metadata');
+        videoNode.setAttribute('data-wpid', videoNodeIdentifier);
+        if (videopressID != '') {
+           videoNode.setAttribute('data-wpvideopress', videopressID);
+        }
+        videoNode.setAttribute('poster', remotePosterUrl);
+
+        // Replace upload container and placeholder image with the uploaded video node
+        var containerNode = imagePlaceholderNode.parent();
+        containerNode.replaceWith(videoNode);
     }
-    videoNode.attr('poster', remotePosterUrl);
+
+    var joinedArguments = ZSSEditor.getJoinedFocusedFieldIdAndCaretArguments();
+    ZSSEditor.callback("callback-input", joinedArguments);
+    // We invoke the sendVideoReplacedCallback with a delay to avoid for
+    // it to be ignored by the webview because of the previous callback being done.
     var thisObj = this;
-    videoNode.on('webkitbeginfullscreen', function (event){ thisObj.sendVideoFullScreenStarted(); } );
-    videoNode.on('webkitendfullscreen', function (event){ thisObj.sendVideoFullScreenEnded(); } );
-    videoNode.on('error', function(event) { videoNode.load()} );
-    this.markVideoUploadDone(videoNodeIdentifier);
+    setTimeout(function() { thisObj.sendVideoReplacedCallback(videoNodeIdentifier);}, 500);
 };
 
 /**
@@ -1253,37 +1286,6 @@ ZSSEditor.setProgressOnVideo = function(videoNodeIdentifier, progress) {
     videoProgressNode.attr("value",progress);
 };
 
-/**
- *  @brief      Notifies that the Video upload as finished
- *
- *  @param      VideoNodeIdentifier     The unique Video ID for the uploaded Video
- */
-ZSSEditor.markVideoUploadDone = function(videoNodeIdentifier) {
-    var videoNode = this.getVideoNodeWithIdentifier(videoNodeIdentifier);
-    if (videoNode.length > 0) {
-
-        // remove identifier attributed from Video
-        videoNode.removeAttr('data-wpid');
-
-        // remove uploading style
-        videoNode.removeClass("uploading");
-        videoNode.removeAttr("class");
-
-        // Remove all extra formatting nodes for progress
-        if (videoNode.parent().attr("id") == this.getVideoContainerIdentifier(videoNodeIdentifier)) {
-            // remove id from container to avoid to report a user removal
-            videoNode.parent().attr("id", "");
-            videoNode.parent().replaceWith(videoNode);
-        }
-    }
-    var joinedArguments = ZSSEditor.getJoinedFocusedFieldIdAndCaretArguments();
-    ZSSEditor.callback("callback-input", joinedArguments);
-    // We invoke the sendVideoReplacedCallback with a delay to avoid for
-    // it to be ignored by the webview because of the previous callback being done.
-    var thisObj = this;
-    setTimeout(function() { thisObj.sendVideoReplacedCallback(videoNodeIdentifier);}, 500);
-};
-
 /**
  *  @brief      Callbacks to native that the video upload as finished and the local url was replaced by the remote url
  *
@@ -1297,22 +1299,6 @@ ZSSEditor.sendVideoReplacedCallback = function( videoNodeIdentifier ) {
     this.callback("callback-video-replaced", joinedArguments);
 };
 
-/**
- *  @brief      Callbacks to native that the video entered full screen mode
- *
- */
-ZSSEditor.sendVideoFullScreenStarted = function() {
-    this.callback("callback-video-fullscreen-started", "empty");
-};
-
-/**
- *  @brief      Callbacks to native that the video entered full screen mode
- *
- */
-ZSSEditor.sendVideoFullScreenEnded = function() {
-    this.callback("callback-video-fullscreen-ended", "empty");
-};
-
 /**
  *  @brief      Callbacks to native that the video upload as finished and the local url was replaced by the remote url
  *
@@ -1498,7 +1484,7 @@ ZSSEditor.applyVideoFormattingCallback = function( match ) {
         out += ' preload="metadata"';
     }
 
-    out += ' onclick="" controls="controls"></video>';
+    out += ' onclick="" controls="controls"></video><br>';
 
     return out;
 }
@@ -1531,8 +1517,6 @@ ZSSEditor.setVideoPressLinks = function(videopressID, videoURL, posterURL ) {
     videoNode.attr('controls', '');
     videoNode.attr('poster', posterURL);
     var thisObj = this;
-    videoNode.on('webkitbeginfullscreen', function (event){ thisObj.sendVideoFullScreenStarted(); } );
-    videoNode.on('webkitendfullscreen', function (event){ thisObj.sendVideoFullScreenEnded(); } );
     videoNode.load();
 };
 
@@ -2785,7 +2769,7 @@ ZSSField.prototype.handleTapEvent = function(e) {
 
         if (targetNode.nodeName.toLowerCase() == 'img') {
             // If the image is uploading, or is a local image do not select it.
-            if ( targetNode.dataset.wpid ) {
+            if ( targetNode.dataset.wpid || targetNode.dataset.video_wpid ) {
                 this.sendImageTappedCallback( targetNode );
                 return;
             }
@@ -2858,17 +2842,21 @@ ZSSField.prototype.handleTapEvent = function(e) {
     }
 };
 
-ZSSField.prototype.sendImageTappedCallback = function( imageNode ) {
-    var meta = JSON.stringify( ZSSEditor.extractImageMeta( imageNode ) );
-    var imageId = "";
-    if ( imageNode.hasAttribute( 'data-wpid' ) ){
-        imageId = imageNode.getAttribute( 'data-wpid' )
+ZSSField.prototype.sendImageTappedCallback = function(imageNode) {
+    var meta = JSON.stringify(ZSSEditor.extractImageMeta(imageNode));
+    var imageId = "", mediaType = "image";
+    if (imageNode.hasAttribute('data-wpid')){
+        imageId = imageNode.getAttribute('data-wpid');
+    } else if (imageNode.hasAttribute('data-video_wpid')){
+        imageId = imageNode.getAttribute('data-video_wpid');
+        mediaType = "video";
     }
-    var arguments = ['id=' + encodeURIComponent( imageId ),
-                     'url=' + encodeURIComponent( imageNode.src ),
-                     'meta=' + encodeURIComponent( meta )];
+    var arguments = ['id=' + encodeURIComponent(imageId),
+                     'url=' + encodeURIComponent(imageNode.src),
+                     'meta=' + encodeURIComponent(meta),
+                     'type=' + mediaType];
 
-    var joinedArguments = arguments.join( defaultCallbackSeparator );
+    var joinedArguments = arguments.join(defaultCallbackSeparator);
 
     var thisObj = this;
 
@@ -2890,22 +2878,6 @@ ZSSField.prototype.sendVideoTappedCallback = function( videoNode ) {
     ZSSEditor.callback('callback-video-tap', joinedArguments);
 }
 
-/**
- *  @brief      Callbacks to native that the video entered full screen mode
- *
- */
-ZSSField.prototype.sendVideoFullScreenStarted = function() {
-    this.callback("callback-video-fullscreen-started", "empty");
-};
-
-/**
- *  @brief      Callbacks to native that the video entered full screen mode
- *
- */
-ZSSField.prototype.sendVideoFullScreenEnded = function() {
-    this.callback("callback-video-fullscreen-ended", "empty");
-};
-
 // MARK: - Callback Execution
 
 ZSSField.prototype.callback = function(callbackScheme, callbackPath) {
diff --git a/libs/editor-common/assets/editor-android.css b/libs/editor-common/assets/editor-android.css
index e3d0aef8701a..34d8dd54b6fe 100644
--- a/libs/editor-common/assets/editor-android.css
+++ b/libs/editor-common/assets/editor-android.css
@@ -30,13 +30,15 @@ video::-webkit-media-controls-fullscreen-button {
 }
 
 /* Used only on older APIs (API<19), where using inline-block is buggy and sometimes displays a very small container */
-span.img_container.compat {
+span.img_container.compat,
+span.video_container.compat {
     display: block;
 }
 
 /* Used on API<19 to darken the image so that the 'uploading' and 'retry' overlays can still be seen when the image is
 light */
-.img_container .upload-overlay-bg {
+.img_container .upload-overlay-bg,
+.video_container .upload-overlay-bg {
     position: absolute;
     width: 100%;
     height: 100%;
@@ -48,19 +50,22 @@ light */
 than its containing image. The upload-overlay-bg is larger as well, leaving a dark line below the image. By setting
 display:block on the image and setting a width limit we get around this issue. */
 
-.img_container .upload-overlay-bg ~ img.uploading {
+.img_container .upload-overlay-bg ~ img.uploading,
+.video_container .upload-overlay-bg ~ img.uploading {
     display:block;
     max-width:100%;
 }
 
-.img_container .upload-overlay-bg ~ img.failed {
+.img_container .upload-overlay-bg ~ img.failed,
+.video_container .upload-overlay-bg ~ img.failed{
     display:block;
     max-width:100%;
 }
 
 /* Used only on older APIs (API<19) instead of a progress bar for uploading images, since the WebView at those API
    levels does not support the progress tag */
-.img_container .upload-overlay {
+.img_container .upload-overlay,
+.video_container .upload-overlay{
     position: absolute;
     top: 50%;
     -webkit-transform: translateY(-50%);
@@ -75,6 +80,7 @@ display:block on the image and setting a width limit we get around this issue. *
     color: white;
 }
 
-.img_container .upload-overlay.failed {
+.img_container .upload-overlay.failed,
+.video_container .upload-overlay.failed{
     visibility: hidden;
 }
\ No newline at end of file
