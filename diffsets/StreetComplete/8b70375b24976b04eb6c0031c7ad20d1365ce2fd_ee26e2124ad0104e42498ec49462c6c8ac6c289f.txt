diff --git a/app/src/main/java/de/westnordost/streetcomplete/data/visiblequests/QuestsHiddenController.kt b/app/src/main/java/de/westnordost/streetcomplete/data/visiblequests/QuestsHiddenController.kt
index 0cea734c149..3cfab5919b8 100644
--- a/app/src/main/java/de/westnordost/streetcomplete/data/visiblequests/QuestsHiddenController.kt
+++ b/app/src/main/java/de/westnordost/streetcomplete/data/visiblequests/QuestsHiddenController.kt
@@ -45,12 +45,12 @@ class QuestsHiddenController(
     fun unhide(key: QuestKey): Boolean {
         val timestamp: Long
         synchronized(this) {
+            timestamp = getTimestamp(key) ?: return false
             val result = when (key) {
                 is OsmQuestKey -> osmDb.delete(key)
                 is OsmNoteQuestKey -> notesDb.delete(key.noteId)
             }
             if (!result) return false
-            timestamp = getTimestamp(key) ?: return false
             cache.remove(key)
         }
         listeners.forEach { it.onUnhid(key, timestamp) }
