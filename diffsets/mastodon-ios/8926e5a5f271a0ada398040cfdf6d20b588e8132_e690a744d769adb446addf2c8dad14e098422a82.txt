diff --git a/Localization/app.json b/Localization/app.json
index 44fa0d26fe..4a94bf35c2 100644
--- a/Localization/app.json
+++ b/Localization/app.json
@@ -312,7 +312,7 @@
         },
         "login": {
             "title": "Welcome Back",
-            "subtitle": "Log in with the server where you created your account.",
+            "subtitle": "Log in with the server where you created your account. For example, if your handle is @you@example.social, enter 'example.social'.",
             "server_search_field": {
                 "placeholder": "Enter URL or search for your server"
             }
diff --git a/Mastodon.xcodeproj/project.pbxproj b/Mastodon.xcodeproj/project.pbxproj
index 1d4d6019a5..65a245bde8 100644
--- a/Mastodon.xcodeproj/project.pbxproj
+++ b/Mastodon.xcodeproj/project.pbxproj
@@ -389,7 +389,6 @@
 		DB789A0B25F9F2950071ACA0 /* ComposeViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB789A0A25F9F2950071ACA0 /* ComposeViewController.swift */; };
 		DB789A1225F9F2CC0071ACA0 /* ComposeViewModel.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB789A1125F9F2CC0071ACA0 /* ComposeViewModel.swift */; };
 		DB7A9F912818EAF10016AF98 /* MastodonRegisterView.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB7A9F902818EAF10016AF98 /* MastodonRegisterView.swift */; };
-		DB7A9F932818F33C0016AF98 /* MastodonServerRulesViewController+Debug.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB7A9F922818F33C0016AF98 /* MastodonServerRulesViewController+Debug.swift */; };
 		DB7F48452620241000796008 /* ProfileHeaderViewModel.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB7F48442620241000796008 /* ProfileHeaderViewModel.swift */; };
 		DB848E33282B62A800A302CC /* ReportResultView.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB848E32282B62A800A302CC /* ReportResultView.swift */; };
 		DB852D1926FAEB6B00FC9D81 /* SidebarViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = DB852D1826FAEB6B00FC9D81 /* SidebarViewController.swift */; };
@@ -1092,7 +1091,6 @@
 		DB789A0A25F9F2950071ACA0 /* ComposeViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ComposeViewController.swift; sourceTree = "<group>"; };
 		DB789A1125F9F2CC0071ACA0 /* ComposeViewModel.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ComposeViewModel.swift; sourceTree = "<group>"; };
 		DB7A9F902818EAF10016AF98 /* MastodonRegisterView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MastodonRegisterView.swift; sourceTree = "<group>"; };
-		DB7A9F922818F33C0016AF98 /* MastodonServerRulesViewController+Debug.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = "MastodonServerRulesViewController+Debug.swift"; sourceTree = "<group>"; };
 		DB7F48442620241000796008 /* ProfileHeaderViewModel.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ProfileHeaderViewModel.swift; sourceTree = "<group>"; };
 		DB848E32282B62A800A302CC /* ReportResultView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ReportResultView.swift; sourceTree = "<group>"; };
 		DB852D1826FAEB6B00FC9D81 /* SidebarViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = SidebarViewController.swift; sourceTree = "<group>"; };
@@ -2525,7 +2523,6 @@
 			children = (
 				DB0618082785B2790030EE79 /* Cell */,
 				DB72601B25E36A2100235243 /* MastodonServerRulesViewController.swift */,
-				DB7A9F922818F33C0016AF98 /* MastodonServerRulesViewController+Debug.swift */,
 				DB72602625E36A6F00235243 /* MastodonServerRulesViewModel.swift */,
 				DB0617FE27855D6C0030EE79 /* MastodonServerRulesViewModel+Diffable.swift */,
 				DB0617F427855AB90030EE79 /* ServerRuleSection.swift */,
@@ -3867,7 +3864,6 @@
 				DB8AF54425C13647002E6C99 /* SceneCoordinator.swift in Sources */,
 				DB1D84382657B275000346B3 /* SegmentedControlNavigateable.swift in Sources */,
 				0F20220726134DA4000C64BF /* HashtagTimelineViewModel+Diffable.swift in Sources */,
-				DB7A9F932818F33C0016AF98 /* MastodonServerRulesViewController+Debug.swift in Sources */,
 				D85DF97E2C50EFA700A01408 /* AccountNotificationTimelineViewController.swift in Sources */,
 				2D5A3D2825CF8BC9002347D6 /* HomeTimelineViewModel+Diffable.swift in Sources */,
 				DB6B74FC272FF55800C70B6E /* UserSection.swift in Sources */,
diff --git a/Mastodon/Coordinator/SceneCoordinator.swift b/Mastodon/Coordinator/SceneCoordinator.swift
index 36e41dd4c4..f230caf1e5 100644
--- a/Mastodon/Coordinator/SceneCoordinator.swift
+++ b/Mastodon/Coordinator/SceneCoordinator.swift
@@ -168,11 +168,11 @@ extension SceneCoordinator {
         case mastodonPickServer(viewMode: MastodonPickServerViewModel)
         case mastodonRegister(viewModel: MastodonRegisterViewModel)
         case mastodonPrivacyPolicies(viewModel: PrivacyViewModel)
-        case mastodonServerRules(viewModel: MastodonServerRulesViewModel)
+        case mastodonServerRules(viewModel: MastodonServerRulesView.ViewModel)
         case mastodonConfirmEmail(viewModel: MastodonConfirmEmailViewModel)
         case mastodonResendEmail(viewModel: MastodonResendEmailViewModel)
         case mastodonWebView(viewModel: WebViewModel)
-        case mastodonLogin
+        case mastodonLogin(authenticationViewModel: AuthenticationViewModel, suggestedDomain: String?)
 
         // search
         case searchDetail(viewModel: SearchDetailViewModel)
@@ -395,9 +395,7 @@ private extension SceneCoordinator {
             let _viewController = WelcomeViewController()
             viewController = _viewController
         case .mastodonPickServer(let viewModel):
-            let _viewController = MastodonPickServerViewController()
-            _viewController.viewModel = viewModel
-            viewController = _viewController
+            viewController = MastodonPickServerViewController(coordinator: self, viewModel: viewModel)
         case .mastodonRegister(let viewModel):
             let _viewController = MastodonRegisterViewController()
             _viewController.viewModel = viewModel
@@ -409,15 +407,14 @@ private extension SceneCoordinator {
             let _viewController = MastodonConfirmEmailViewController()
             _viewController.viewModel = viewModel
             viewController = _viewController
-        case .mastodonLogin:
-            let loginViewController = MastodonLoginViewController(appContext: appContext,
-                                                                  authenticationViewModel: AuthenticationViewModel(context: appContext, coordinator: self, isAuthenticationExist: false),
-                                                                  sceneCoordinator: self)
+        case .mastodonLogin(let authenticationViewModel, let suggestedDomain):
+            let loginViewController = MastodonLoginViewController(authenticationViewModel: authenticationViewModel,
+                                                                  suggestedDomain: suggestedDomain)
             loginViewController.delegate = self
 
             viewController = loginViewController
         case .mastodonPrivacyPolicies(let viewModel):
-            let privacyViewController = PrivacyTableViewController(context: appContext, coordinator: self, viewModel: viewModel)
+            let privacyViewController = PrivacyTableViewController(coordinator: self, viewModel: viewModel)
             viewController = privacyViewController
         case .mastodonResendEmail(let viewModel):
             let _viewController = MastodonResendEmailViewController()
@@ -689,7 +686,7 @@ extension SceneCoordinator: SettingsCoordinatorDelegate {
         let domain = authenticationBox.domain
         let profileSettingsURL = Mastodon.API.profileSettingsURL(domain: domain)
 
-        let authenticationController = MastodonAuthenticationController(context: appContext, authenticateURL: profileSettingsURL)
+        let authenticationController = MastodonAuthenticationController(authenticateURL: profileSettingsURL)
 
         authenticationController.authenticationSession?.presentationContextProvider = settingsCoordinator
         authenticationController.authenticationSession?.start()
diff --git a/Mastodon/Scene/Onboarding/ConfirmEmail/MastodonConfirmEmailViewModel.swift b/Mastodon/Scene/Onboarding/ConfirmEmail/MastodonConfirmEmailViewModel.swift
index bbfbf706b5..f88a70c8cb 100644
--- a/Mastodon/Scene/Onboarding/ConfirmEmail/MastodonConfirmEmailViewModel.swift
+++ b/Mastodon/Scene/Onboarding/ConfirmEmail/MastodonConfirmEmailViewModel.swift
@@ -14,7 +14,6 @@ final class MastodonConfirmEmailViewModel {
     var disposeBag = Set<AnyCancellable>()
 
     // input
-    let context: AppContext
     var email: String
     let authenticateInfo: AuthenticationViewModel.AuthenticateInfo
     let userToken: Mastodon.Entity.Token
@@ -26,13 +25,11 @@ final class MastodonConfirmEmailViewModel {
         .eraseToAnyPublisher()
 
     init(
-        context: AppContext,
         email: String,
         authenticateInfo: AuthenticationViewModel.AuthenticateInfo,
         userToken: Mastodon.Entity.Token,
         updateCredentialQuery: Mastodon.API.Account.UpdateCredentialQuery
     ) {
-        self.context = context
         self.email = email
         self.authenticateInfo = authenticateInfo
         self.userToken = userToken
@@ -41,7 +38,6 @@ final class MastodonConfirmEmailViewModel {
 
     #if DEBUG || SNAPSHOT
     init() {
-        self.context = AppContext.shared
         self.email = "example.com"
         self.authenticateInfo = AuthenticationViewModel.AuthenticateInfo(
             domain: "",
diff --git a/Mastodon/Scene/Onboarding/Login/MastodonLoginViewController.swift b/Mastodon/Scene/Onboarding/Login/MastodonLoginViewController.swift
index 3d4067e9c7..73f71c3415 100644
--- a/Mastodon/Scene/Onboarding/Login/MastodonLoginViewController.swift
+++ b/Mastodon/Scene/Onboarding/Login/MastodonLoginViewController.swift
@@ -21,16 +21,14 @@ enum MastodonLoginViewSection: Hashable {
     case servers
 }
 
-class MastodonLoginViewController: UIViewController, NeedsDependency {
+class MastodonLoginViewController: UIViewController {
     
     weak var delegate: MastodonLoginViewControllerDelegate?
     var dataSource: UITableViewDiffableDataSource<MastodonLoginViewSection, Mastodon.Entity.Server>?
     let viewModel: MastodonLoginViewModel
     let authenticationViewModel: AuthenticationViewModel
     var mastodonAuthenticationController: MastodonAuthenticationController?
-    
-    weak var context: AppContext!
-    weak var coordinator: SceneCoordinator!
+    private let suggestedDomain: String?
     
     var disposeBag = Set<AnyCancellable>()
     
@@ -38,12 +36,11 @@ class MastodonLoginViewController: UIViewController, NeedsDependency {
         view as! MastodonLoginView
     }
     
-    init(appContext: AppContext, authenticationViewModel: AuthenticationViewModel, sceneCoordinator: SceneCoordinator) {
+    init(authenticationViewModel: AuthenticationViewModel, suggestedDomain: String?) {
         
-        viewModel = MastodonLoginViewModel(appContext: appContext)
+        viewModel = MastodonLoginViewModel()
         self.authenticationViewModel = authenticationViewModel
-        self.context = appContext
-        self.coordinator = sceneCoordinator
+        self.suggestedDomain = suggestedDomain
         
         super.init(nibName: nil, bundle: nil)
         viewModel.delegate = self
@@ -99,6 +96,8 @@ class MastodonLoginViewController: UIViewController, NeedsDependency {
         setupOnboardingAppearance()
         
         title = L10n.Scene.Login.title
+        
+        guard let view = view as? MastodonLoginView else { return }
     }
     
     override func viewWillAppear(_ animated: Bool) {
@@ -120,65 +119,6 @@ class MastodonLoginViewController: UIViewController, NeedsDependency {
         delegate?.backButtonPressed(self)
     }
     
-    func login(on server: Mastodon.Entity.Server) {
-        authenticationViewModel
-            .authenticated.sink { authBox in
-                Task { @MainActor in
-                    do {
-                        self.coordinator.setup()
-                    } catch {
-                        assertionFailure(error.localizedDescription)
-                    }
-                }
-            }
-            .store(in: &disposeBag)
-
-        authenticationViewModel.isAuthenticating.send(true)
-        APIService.shared.createApplication(domain: server.domain)
-            .tryMap { response -> AuthenticationViewModel.AuthenticateInfo in
-                let application = response.value
-                guard let info = AuthenticationViewModel.AuthenticateInfo(
-                    domain: server.domain,
-                    application: application,
-                    redirectURI: response.value.redirectURI ?? APIService.oauthCallbackURL
-                ) else {
-                    throw APIService.APIError.explicit(.badResponse)
-                }
-                return info
-            }
-            .receive(on: DispatchQueue.main)
-            .sink { [weak self] completion in
-                guard let self = self else { return }
-                self.authenticationViewModel.isAuthenticating.send(false)
-                
-                switch completion {
-                case .failure(let error):
-                    let alert = UIAlertController.standardAlert(of: error)
-                    self.present(alert, animated: true)
-                case .finished:
-                    break
-                }
-            } receiveValue: { [weak self] info in
-                guard let self else { return }
-                let authenticationController = MastodonAuthenticationController(
-                    context: self.context,
-                    authenticateURL: info.authorizeURL
-                )
-                
-                self.mastodonAuthenticationController = authenticationController
-                authenticationController.authenticationSession?.presentationContextProvider = self
-                
-                self.authenticationViewModel.authenticate(
-                    info: info,
-                    pinCodePublisher: authenticationController.resultStream
-                )
-                
-                authenticationController.authenticationSession?.start()
-                
-            }
-            .store(in: &disposeBag)
-    }
-    
     @objc func textfieldDidChange(_ textField: UITextField) {
         viewModel.filterServers(withText: textField.text)
 
@@ -227,7 +167,9 @@ extension MastodonLoginViewController: UITableViewDelegate {
         tableView.deselectRow(at: indexPath, animated: true)
 
         let selectedServer = viewModel.filteredServers[indexPath.row]
-        login(on: selectedServer)
+        Task {
+            await authenticationViewModel.logIn(on: selectedServer, withPresentationContextProvider: self)
+        }
     }
 }
 
diff --git a/Mastodon/Scene/Onboarding/Login/MastodonLoginViewModel.swift b/Mastodon/Scene/Onboarding/Login/MastodonLoginViewModel.swift
index 52fea42aa0..0c6a10db60 100644
--- a/Mastodon/Scene/Onboarding/Login/MastodonLoginViewModel.swift
+++ b/Mastodon/Scene/Onboarding/Login/MastodonLoginViewModel.swift
@@ -20,14 +20,9 @@ class MastodonLoginViewModel {
   private var serverList: [Mastodon.Entity.Server] = []
   var filteredServers: [Mastodon.Entity.Server] = []
 
-  weak var appContext: AppContext?
   weak var delegate: MastodonLoginViewModelDelegate?
   var disposeBag = Set<AnyCancellable>()
 
-  init(appContext: AppContext) {
-    self.appContext = appContext
-  }
-
   func updateServers() {
       APIService.shared.servers(registrations: "all").sink(receiveCompletion: { [weak self] completion in
       switch completion {
diff --git a/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewController.swift b/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewController.swift
index 2832b00c59..f1c33c887d 100644
--- a/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewController.swift
+++ b/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewController.swift
@@ -15,20 +15,28 @@ import MastodonUI
 import MastodonSDK
 
 final class MastodonPickServerViewController: UIViewController, NeedsDependency {
+    var context: AppContext! {
+        get { return AppContext.shared }
+        set {  }
+    }
+    
+    var coordinator: SceneCoordinator!
+    
+    init(coordinator: SceneCoordinator, viewModel: MastodonPickServerViewModel) {
+        self.coordinator = coordinator
+        self.viewModel = viewModel
+        super.init(nibName: nil, bundle: nil)
+    }
+    
+    @MainActor required dynamic init?(coder aDecoder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
     
     private var disposeBag = Set<AnyCancellable>()
     private var observations = Set<NSKeyValueObservation>()
     private var tableViewObservation: NSKeyValueObservation?
     
-    weak var context: AppContext! { willSet { precondition(!isViewLoaded) } }
-    weak var coordinator: SceneCoordinator! { willSet { precondition(!isViewLoaded) } }
-    
-    var viewModel: MastodonPickServerViewModel!
-    private(set) lazy var authenticationViewModel = AuthenticationViewModel(
-        context: context,
-        coordinator: coordinator,
-        isAuthenticationExist: false
-    )
+    let viewModel: MastodonPickServerViewModel
     
     private var expandServerDomainSet = Set<String>()
     
@@ -51,8 +59,6 @@ final class MastodonPickServerViewController: UIViewController, NeedsDependency
         onboardingNextView.backgroundColor = UIColor.secondarySystemBackground
         return onboardingNextView
     }()
-    
-    var mastodonAuthenticationController: MastodonAuthenticationController?
 
     let searchController: UISearchController = {
         let searchController = UISearchController(searchResultsController: nil)
@@ -88,9 +94,11 @@ extension MastodonPickServerViewController {
         
         onboardingNextView
             .observe(\.bounds, options: [.initial, .new]) { [weak self] _, _ in
-                guard let self = self else { return }
-                let inset = self.onboardingNextView.frame.height
-                self.viewModel.additionalTableViewInsets.bottom = inset
+                DispatchQueue.main.async {
+                    guard let self = self else { return }
+                    let inset = self.onboardingNextView.frame.height
+                    self.viewModel.additionalTableViewInsets.bottom = inset
+                }
             }
             .store(in: &observations)
 
@@ -120,25 +128,6 @@ extension MastodonPickServerViewController {
                 additionalSafeAreaInsets: viewModel.$additionalTableViewInsets.eraseToAnyPublisher()
             )
             .store(in: &disposeBag)
-
-        Publishers.Merge(
-            viewModel.error,
-            authenticationViewModel.error
-        )
-        .compactMap { $0 }
-        .receive(on: DispatchQueue.main)
-        .sink { [weak self] error in
-            guard let self = self else { return }
-            let alertController = UIAlertController(for: error, title: "Error", preferredStyle: .alert)
-            let okAction = UIAlertAction(title: L10n.Common.Controls.Actions.ok, style: .default, handler: nil)
-            alertController.addAction(okAction)
-            _ = self.coordinator.present(
-                scene: .alertController(alertController: alertController),
-                from: nil,
-                transition: .alertController(animated: true, completion: nil)
-            )
-        }
-        .store(in: &disposeBag)
         
         viewModel.scrollToTop
             .receive(on: DispatchQueue.main)
@@ -147,41 +136,7 @@ extension MastodonPickServerViewController {
             }
             .store(in: &disposeBag)
 
-        authenticationViewModel
-            .authenticated
-            .asyncMap { authBox -> Result<Bool, Error> in
-                do {
-                    let activated = AuthenticationServiceProvider.shared.activateExistingUser(authBox.userID, inDomain: authBox.domain)
-                    return .success(activated)
-                } catch {
-                    return .failure(error)
-                }
-            }
-            .receive(on: DispatchQueue.main)
-            .sink { [weak self] result in
-                guard let self = self else { return }
-                switch result {
-                case .failure(let error):
-                    assertionFailure(error.localizedDescription)
-                case .success(let isActived):
-                    assert(isActived)
-                    // self.dismiss(animated: true, completion: nil)
-                    self.coordinator.setup()
-                }
-            }
-            .store(in: &disposeBag)
 
-        authenticationViewModel.isAuthenticating
-            .receive(on: DispatchQueue.main)
-            .sink { [weak self] isAuthenticating in
-                guard let self = self else { return }
-                if isAuthenticating {
-                    self.onboardingNextView.showLoading()
-                } else {
-                    self.onboardingNextView.stopLoading()
-                }
-            }
-            .store(in: &disposeBag)
 
         viewModel.emptyStateViewState
             .receive(on: DispatchQueue.main)
@@ -218,7 +173,7 @@ extension MastodonPickServerViewController {
                 guard let snapshot = self?.viewModel.serverSectionHeaderView.diffableDataSource?.snapshot() else { return }
 
                 self?.viewModel.serverSectionHeaderView.diffableDataSource?.applySnapshotUsingReloadData(snapshot) {
-                    guard let self = self, let viewModel = self.viewModel else { return }
+                    guard let viewModel = self?.viewModel else { return }
                     guard let indexPath = viewModel.serverSectionHeaderView.diffableDataSource?.indexPath(for: .category(category: .init(category: Mastodon.Entity.Category.Kind.general.rawValue, serversCount: 0))) else { return }
 
                     viewModel.serverSectionHeaderView.collectionView.selectItem(at: indexPath, animated: false, scrollPosition: .right)
@@ -237,6 +192,7 @@ extension MastodonPickServerViewController {
     
     override func viewWillAppear(_ animated: Bool) {
         super.viewWillAppear(animated)
+        onboardingNextView.stopLoading()
         viewModel.viewWillAppear.send()
     }
     
@@ -269,87 +225,20 @@ extension MastodonPickServerViewController {
             return
         }
 
-        authenticationViewModel.isAuthenticating.send(true)
+        Task {
+            await tryToJoin(server: server)
+        }
         
-        APIService.shared.instance(domain: server.domain, authenticationBox: nil)
-            .compactMap { [weak self] response -> AnyPublisher<MastodonPickServerViewModel.SignUpResponseFirst, Error>? in
-                guard let self = self else { return nil }
-                guard response.value.registrations != false else {
-                    return Fail(error: AuthenticationViewModel.AuthenticationError.registrationClosed).eraseToAnyPublisher()
-                }
-                return APIService.shared.createApplication(domain: server.domain)
-                    .map { MastodonPickServerViewModel.SignUpResponseFirst(instance: response, application: $0) }
-                    .eraseToAnyPublisher()
-            }
-            .switchToLatest()
-            .tryMap { response -> MastodonPickServerViewModel.SignUpResponseSecond in
-                let application = response.application.value
-                guard let authenticateInfo = AuthenticationViewModel.AuthenticateInfo(
-                        domain: server.domain,
-                        application: application
-                ) else {
-                    throw APIService.APIError.explicit(.badResponse)
-                }
-                return MastodonPickServerViewModel.SignUpResponseSecond(
-                    instance: response.instance,
-                    authenticateInfo: authenticateInfo
-                )
-            }
-            .compactMap { [weak self] response -> AnyPublisher<MastodonPickServerViewModel.SignUpResponseThird, Error>? in
-                guard let self = self else { return nil }
-                let instance = response.instance
-                let authenticateInfo = response.authenticateInfo
-                return APIService.shared.applicationAccessToken(
-                    domain: server.domain,
-                    clientID: authenticateInfo.clientID,
-                    clientSecret: authenticateInfo.clientSecret,
-                    redirectURI: authenticateInfo.redirectURI
-                )
-                .map {
-                    MastodonPickServerViewModel.SignUpResponseThird(
-                        instance: instance,
-                        authenticateInfo: authenticateInfo,
-                        applicationToken: $0
-                    )
-                }
-                .eraseToAnyPublisher()
-            }
-            .switchToLatest()
-            .receive(on: DispatchQueue.main)
-            .sink { [weak self] completion in
-                guard let self = self else { return }
-                self.authenticationViewModel.isAuthenticating.send(false)
-                
-                switch completion {
-                case .failure(let error):
-                    self.viewModel.error.send(error)
-                case .finished:
-                    break
-                }
-            } receiveValue: { [weak self] response in
-                guard let self = self else { return }
-                if let rules = response.instance.value.rules, !rules.isEmpty {
-                    // show server rules before register
-                    let mastodonServerRulesViewModel = MastodonServerRulesViewModel(
-                        domain: server.domain,
-                        authenticateInfo: response.authenticateInfo,
-                        rules: rules,
-                        instance: response.instance.value,
-                        applicationToken: response.applicationToken.value
-                    )
-                    _ = self.coordinator.present(scene: .mastodonServerRules(viewModel: mastodonServerRulesViewModel), from: self, transition: .show)
-                } else {
-                    let mastodonRegisterViewModel = MastodonRegisterViewModel(
-                        context: self.context,
-                        domain: server.domain,
-                        authenticateInfo: response.authenticateInfo,
-                        instance: response.instance.value,
-                        applicationToken: response.applicationToken.value
-                    )
-                    _ = self.coordinator.present(scene: .mastodonRegister(viewModel: mastodonRegisterViewModel), from: nil, transition: .show)
-                }
-            }
-            .store(in: &disposeBag)
+    }
+    
+    private func tryToJoin(server: Mastodon.Entity.Server) async {
+        self.onboardingNextView.showLoading()
+        do {
+            try await viewModel.joinServer(server)
+        } catch let error {
+            viewModel.displayError(error)
+        }
+        self.onboardingNextView.stopLoading()
     }
 }
 
diff --git a/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewModel.swift b/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewModel.swift
index 0d653ffcc5..55cd230c7b 100644
--- a/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewModel.swift
+++ b/Mastodon/Scene/Onboarding/PickServer/MastodonPickServerViewModel.swift
@@ -30,8 +30,7 @@ class MastodonPickServerViewModel: NSObject {
     let serverSectionHeaderView = PickServerServerSectionTableHeaderView()
 
     // input
-    let context: AppContext
-    var categoryPickerItems: [CategoryPickerItem] = {
+    let categoryPickerItems: [CategoryPickerItem] = {
         var items: [CategoryPickerItem] = []
         items.append(.language(language: nil))
         items.append(.signupSpeed(manuallyReviewed: nil))
@@ -71,11 +70,14 @@ class MastodonPickServerViewModel: NSObject {
     let isLoadingIndexedServers = CurrentValueSubject<Bool, Never>(false)
     let loadingIndexedServersError = CurrentValueSubject<Error?, Never>(nil)
     let emptyStateViewState = CurrentValueSubject<EmptyStateViewState, Never>(.none)
+    
+    let joinServer: (Mastodon.Entity.Server) async throws ->()
+    let displayError: (Error)->()
         
-    init(context: AppContext) {
-        self.context = context
+    init(joinServer: @escaping (Mastodon.Entity.Server) async throws ->(), displayError: @escaping (Error)->()) {
+        self.joinServer = joinServer
+        self.displayError = displayError
         super.init()
-
         configure()
     }
     
@@ -276,28 +278,9 @@ extension MastodonPickServerViewModel {
     }
 }
 
-// MARK: - SignUp methods & structs
-extension MastodonPickServerViewModel {
-    struct SignUpResponseFirst {
-        let instance: Mastodon.Response.Content<Mastodon.Entity.Instance>
-        let application: Mastodon.Response.Content<Mastodon.Entity.Application>
-    }
-    
-    struct SignUpResponseSecond {
-        let instance: Mastodon.Response.Content<Mastodon.Entity.Instance>
-        let authenticateInfo: AuthenticationViewModel.AuthenticateInfo
-    }
-    
-    struct SignUpResponseThird {
-        let instance: Mastodon.Response.Content<Mastodon.Entity.Instance>
-        let authenticateInfo: AuthenticationViewModel.AuthenticateInfo
-        let applicationToken: Mastodon.Response.Content<Mastodon.Entity.Token>
-    }
-}
-
 // MARK: - TMBarDataSource
 extension MastodonPickServerViewModel: TMBarDataSource {
-    func barItem(for bar: TMBar, at index: Int) -> TMBarItemable {
+    nonisolated func barItem(for bar: TMBar, at index: Int) -> TMBarItemable {
         let item = categoryPickerItems[index]
         let barItem = TMBarItem(title: item.title)
         return barItem
diff --git a/Mastodon/Scene/Onboarding/Privacy/PrivacyTableViewController.swift b/Mastodon/Scene/Onboarding/Privacy/PrivacyTableViewController.swift
index 79fb9e1bc0..37baa62fa3 100644
--- a/Mastodon/Scene/Onboarding/Privacy/PrivacyTableViewController.swift
+++ b/Mastodon/Scene/Onboarding/Privacy/PrivacyTableViewController.swift
@@ -35,19 +35,14 @@ enum PrivacyRow {
     }
 }
 
-class PrivacyTableViewController: UIViewController, NeedsDependency {
-
-    var context: AppContext!
-    var coordinator: SceneCoordinator!
+class PrivacyTableViewController: UIViewController {
 
+    private let coordinator: SceneCoordinator
     private let tableView: UITableView
     let viewModel: PrivacyViewModel
 
-    init(context: AppContext, coordinator: SceneCoordinator, viewModel: PrivacyViewModel) {
-
-        self.context = context
+    init(coordinator: SceneCoordinator, viewModel: PrivacyViewModel) {
         self.coordinator = coordinator
-
         self.viewModel = viewModel
 
         tableView = UITableView(frame: .zero, style: .insetGrouped)
@@ -86,20 +81,8 @@ class PrivacyTableViewController: UIViewController, NeedsDependency {
         setupOnboardingAppearance()
     }
 
-    //MARK: - Actions
-    @objc private func backButtonPressed(_ sender: UIButton) {
-        navigationController?.popViewController(animated: true)
-    }
-
     @objc private func nextButtonPressed(_ sender: UIButton) {
-        let viewModel = MastodonRegisterViewModel(
-            context: context,
-            domain: viewModel.domain,
-            authenticateInfo: viewModel.authenticateInfo,
-            instance: viewModel.instance,
-            applicationToken: viewModel.applicationToken
-        )
-        _ = coordinator.present(scene: .mastodonRegister(viewModel: viewModel), from: self, transition: .show)
+        viewModel.didAccept()
     }
 }
 
diff --git a/Mastodon/Scene/Onboarding/Privacy/PrivacyViewModel.swift b/Mastodon/Scene/Onboarding/Privacy/PrivacyViewModel.swift
index 80215cc6c6..17221330f5 100644
--- a/Mastodon/Scene/Onboarding/Privacy/PrivacyViewModel.swift
+++ b/Mastodon/Scene/Onboarding/Privacy/PrivacyViewModel.swift
@@ -16,18 +16,21 @@ final class PrivacyViewModel {
     let rows: [PrivacyRow]
     let instance: Mastodon.Entity.Instance
     let applicationToken: Mastodon.Entity.Token
+    let didAccept: ()->()
 
     init(
         domain: String,
         authenticateInfo: AuthenticationViewModel.AuthenticateInfo,
         rows: [PrivacyRow],
         instance: Mastodon.Entity.Instance,
-        applicationToken: Mastodon.Entity.Token
+        applicationToken: Mastodon.Entity.Token,
+        didAccept: @escaping ()->()
     ) {
         self.domain = domain
         self.authenticateInfo = authenticateInfo
         self.rows = rows
         self.instance = instance
         self.applicationToken = applicationToken
+        self.didAccept = didAccept
     }
 }
diff --git a/Mastodon/Scene/Onboarding/Register/MastodonRegisterView.swift b/Mastodon/Scene/Onboarding/Register/MastodonRegisterView.swift
index a39a3e1775..f941cbbec4 100644
--- a/Mastodon/Scene/Onboarding/Register/MastodonRegisterView.swift
+++ b/Mastodon/Scene/Onboarding/Register/MastodonRegisterView.swift
@@ -21,6 +21,7 @@ struct MastodonRegisterView: View {
         ScrollView(.vertical) {
             let margin: CGFloat = 16
             VStack(alignment: .leading, spacing: 16) {
+                Spacer()
                 TextField(L10n.Scene.Register.Input.DisplayName.placeholder.localizedCapitalized, text: $viewModel.name)
                     .textContentType(.name)
                     .disableAutocorrection(true)
@@ -176,7 +177,6 @@ struct MastodonRegisterView_Previews: PreviewProvider {
     static var viewModel: MastodonRegisterViewModel {
         let domain = "mstdn.jp"
         return MastodonRegisterViewModel(
-            context: .shared,
             domain: domain,
             authenticateInfo: AuthenticationViewModel.AuthenticateInfo(
                 domain: domain,
@@ -196,7 +196,8 @@ struct MastodonRegisterView_Previews: PreviewProvider {
                 tokenType: "",
                 scope: "",
                 createdAt: Date()
-            )
+            ),
+            submitValidatedUserRegistration: { (_,_) in return }
         )
     }
             
diff --git a/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewController.swift b/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewController.swift
index fe7572bb69..5261fea464 100644
--- a/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewController.swift
+++ b/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewController.swift
@@ -131,126 +131,19 @@ extension MastodonRegisterViewController {
     
     //MARK: - Actions
     @objc private func nextButtonPressed(_ sender: UIButton) {
+        Task {
+            await doRegisterUser()
+        }
+    }
+    
+    private func doRegisterUser() async {
         guard viewModel.isAllValid else { return }
-
+        
         guard !viewModel.isRegistering else { return }
         viewModel.isRegistering = true
-
-        let username = viewModel.username
-        let email = viewModel.email
-        let password = viewModel.password
-        let reason = viewModel.reason
         
-        let locale: String = {
-            guard let url = Bundle.main.url(forResource: "local-codes", withExtension: "json"),
-                let data = try? Data(contentsOf: url),
-                let localCode = try? JSONDecoder().decode(MastodonLocalCode.self, from: data)
-            else {
-                assertionFailure()
-                return "en"
-            }
-            let fallbackLanguageCode: String = {
-                let code = Locale.current.language.languageCode?.identifier ?? "en"
-                guard localCode[code] != nil else { return "en" }
-                return code
-            }()
-
-            // pick device preferred language
-            guard let identifier = Locale.preferredLanguages.first else {
-                return fallbackLanguageCode
-            }
-            // prepare languageCode and validate then return fallback if needs
-            let local = Locale(identifier: identifier)
-            guard let languageCode = local.language.languageCode?.identifier,
-                  localCode[languageCode] != nil
-            else {
-                return fallbackLanguageCode
-            }
-            // prepare extendCode and validate then return fallback if needs
-            let extendCodes: [String] = {
-                let locales = Locale.preferredLanguages.map { Locale(identifier: $0) }
-                return locales.compactMap { locale in
-                    guard let languageCode = locale.language.languageCode?.identifier,
-                          let regionIdentifier = locale.region?.identifier
-                    else { return nil }
-                    return languageCode + "-" + regionIdentifier
-                }
-            }()
-            let _firstMatchExtendCode = extendCodes.first { code in
-                localCode[code] != nil
-            }
-            guard let firstMatchExtendCode = _firstMatchExtendCode else {
-                return languageCode
-            }
-            return firstMatchExtendCode
-
-        }()
-        let query = Mastodon.API.Account.RegisterQuery(
-            reason: reason,
-            username: username,
-            email: email,
-            password: password,
-            agreement: true, // user confirmed in the server rules scene
-            locale: locale
-        )
-
-        var retryCount = 0
-
-        // register without show server rules
-        APIService.shared.accountRegister(
-            domain: viewModel.domain,
-            query: query,
-            authorization: viewModel.applicationAuthorization
-        )
-        .tryCatch { [weak self] error -> AnyPublisher<Mastodon.Response.Content<Mastodon.Entity.Token>, Error> in
-            guard let self = self else { throw error }
-            guard let error = self.viewModel.error as? Mastodon.API.Error,
-                  case let .generic(errorEntity) = error.mastodonError,
-                  errorEntity.error == "Validation failed: Locale is not included in the list"
-            else {
-                throw error
-            }
-            guard retryCount == 0 else {
-                throw error
-            }
-            let retryQuery = Mastodon.API.Account.RegisterQuery(
-                reason: query.reason,
-                username: query.username,
-                email: query.email,
-                password: query.password,
-                agreement: query.agreement,
-                locale: self.viewModel.instance.languages?.first ?? "en"
-            )
-            retryCount += 1
-            return APIService.shared.accountRegister(
-                domain: self.viewModel.domain,
-                query: retryQuery,
-                authorization: self.viewModel.applicationAuthorization
-            )
-        }
-        .receive(on: DispatchQueue.main)
-        .sink { [weak self] completion in
-            guard let self = self else { return }
-            self.viewModel.isRegistering = false
-            switch completion {
-            case .failure(let error):
-                self.viewModel.error = error
-            case .finished:
-                break
-            }
-        } receiveValue: { [weak self] response in
-            guard let self = self else { return }
-            let userToken = response.value
-            let updateCredentialQuery: Mastodon.API.Account.UpdateCredentialQuery = {
-                let displayName: String? = self.viewModel.name.isEmpty ? nil : self.viewModel.name
-                return Mastodon.API.Account.UpdateCredentialQuery(
-                    displayName: displayName,
-                    avatar: nil
-                )
-            }()
-            let viewModel = MastodonConfirmEmailViewModel(context: self.context, email: email, authenticateInfo: self.viewModel.authenticateInfo, userToken: userToken, updateCredentialQuery: updateCredentialQuery)
-            _ = self.coordinator.present(scene: .mastodonConfirmEmail(viewModel: viewModel), from: self, transition: .show)
-        }
-        .store(in: &disposeBag)
+        await viewModel.submitValidatedUserRegistration(viewModel, true)
+        
+        viewModel.isRegistering = false
     }
 }
diff --git a/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewModel.swift b/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewModel.swift
index 25bf4cc9ea..1131ba98fa 100644
--- a/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewModel.swift
+++ b/Mastodon/Scene/Onboarding/Register/MastodonRegisterViewModel.swift
@@ -18,12 +18,12 @@ final class MastodonRegisterViewModel: ObservableObject {
     var disposeBag = Set<AnyCancellable>()
     
     // input
-    let context: AppContext
     let domain: String
     let authenticateInfo: AuthenticationViewModel.AuthenticateInfo
     let instance: Mastodon.Entity.Instance
     let applicationToken: Mastodon.Entity.Token
     let viewDidAppear = CurrentValueSubject<Void, Never>(Void())
+    let submitValidatedUserRegistration: (MastodonRegisterViewModel, Bool) async -> ()
 
     @Published var backgroundColor: UIColor = Asset.Scene.Onboarding.background.color
     @Published var name = ""
@@ -58,19 +58,19 @@ final class MastodonRegisterViewModel: ObservableObject {
     let endEditing = PassthroughSubject<Void, Never>()
 
     init(
-        context: AppContext,
         domain: String,
         authenticateInfo: AuthenticationViewModel.AuthenticateInfo,
         instance: Mastodon.Entity.Instance,
-        applicationToken: Mastodon.Entity.Token
+        applicationToken: Mastodon.Entity.Token,
+        submitValidatedUserRegistration: @escaping (MastodonRegisterViewModel, Bool) async ->()
     ) {
         self.domain = domain
-        self.context = context
         self.authenticateInfo = authenticateInfo
         self.instance = instance
         self.applicationToken = applicationToken
         self.approvalRequired = instance.approvalRequired ?? false
         self.applicationAuthorization = Mastodon.API.OAuth.Authorization(accessToken: applicationToken.accessToken)
+        self.submitValidatedUserRegistration = submitValidatedUserRegistration
         
         $name
             .map { name in
diff --git a/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController+Debug.swift b/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController+Debug.swift
deleted file mode 100644
index 166b94956d..0000000000
--- a/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController+Debug.swift
+++ /dev/null
@@ -1,51 +0,0 @@
-//
-//  MastodonServerRulesViewController+Debug.swift
-//  Mastodon
-//
-//  Created by MainasuK on 2022-4-27.
-//
-
-import UIKit
-import MastodonCore
-
-#if DEBUG
-
-extension MastodonRegisterViewController {
-    
-    @MainActor
-    static func create(
-        context: AppContext,
-        coordinator: SceneCoordinator,
-        domain: String
-    ) async throws -> MastodonRegisterViewController {
-        let viewController = MastodonRegisterViewController()
-        viewController.context = context
-        viewController.coordinator = coordinator
-        
-        let instanceResponse = try await APIService.shared.instance(domain: domain, authenticationBox: nil).singleOutput()
-        let applicationResponse = try await APIService.shared.createApplication(domain: domain).singleOutput()
-        let accessToken = try await APIService.shared.applicationAccessToken(
-            domain: domain,
-            clientID: applicationResponse.value.clientID!,
-            clientSecret: applicationResponse.value.clientSecret!,
-            redirectURI: applicationResponse.value.redirectURI!
-        )
-        
-        viewController.viewModel = MastodonRegisterViewModel(
-            context: context,
-            domain: domain,
-            authenticateInfo: .init(
-                domain: domain,
-                application: applicationResponse.value
-            )!,
-            instance: instanceResponse.value,
-            applicationToken: accessToken
-        )
-        
-        return viewController
-    }
-    
-}
-
-#endif
-
diff --git a/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController.swift b/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController.swift
index e32ad0929a..135ff638d1 100644
--- a/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController.swift
+++ b/Mastodon/Scene/Onboarding/ServerRules/MastodonServerRulesViewController.swift
@@ -108,21 +108,11 @@ private struct MastodonServerRulesButton: View {
     }
 }
 
-final class MastodonServerRulesViewController: UIHostingController<MastodonServerRulesView>, NeedsDependency {
-
-    weak var context: AppContext! { willSet { precondition(!isViewLoaded) } }
-    weak var coordinator: SceneCoordinator! { willSet { precondition(!isViewLoaded) } }
-    
-    private var viewModel: MastodonServerRulesViewModel!
+final class MastodonServerRulesViewController: UIHostingController<MastodonServerRulesView> {
     
-    init(viewModel: MastodonServerRulesViewModel) {
+    init(viewModel: MastodonServerRulesView.ViewModel) {
         super.init(rootView: MastodonServerRulesView())
-        self.viewModel = viewModel
-        self.rootView.viewModel = .init(
-            disclaimer: LocalizedStringKey(L10n.Scene.ServerRules.subtitle(viewModel.domain)),
-            rules: viewModel.rules.map({ $0.text }),
-            onAgree: { self.nextButtonPressed(nil) },
-            onDisagree: { self.backButtonPressed(nil) })
+        self.rootView.viewModel = viewModel
     }
     
     @MainActor required dynamic init?(coder aDecoder: NSCoder) {
@@ -143,18 +133,5 @@ extension MastodonServerRulesViewController {
     }
 }
 
-extension MastodonServerRulesViewController {
-    @objc private func backButtonPressed(_ sender: UIButton?) {
-        navigationController?.popViewController(animated: true)
-    }
-
-    @objc private func nextButtonPressed(_ sender: UIButton?) {
-        let domain = viewModel.domain
-        let viewModel = PrivacyViewModel(domain: domain, authenticateInfo: viewModel.authenticateInfo, rows: [.iOSApp, .server(domain: domain)], instance: viewModel.instance, applicationToken: viewModel.applicationToken)
-
-        _ = coordinator.present(scene: .mastodonPrivacyPolicies(viewModel: viewModel), from: self, transition: .show)
-    }
-}
-
 // MARK: - OnboardingViewControllerAppearance
 extension MastodonServerRulesViewController: OnboardingViewControllerAppearance { }
diff --git a/Mastodon/Scene/Onboarding/Share/AuthenticationViewModel.swift b/Mastodon/Scene/Onboarding/Share/AuthenticationViewModel.swift
index bf75a2eee7..9237781076 100644
--- a/Mastodon/Scene/Onboarding/Share/AuthenticationViewModel.swift
+++ b/Mastodon/Scene/Onboarding/Share/AuthenticationViewModel.swift
@@ -12,33 +12,31 @@ import Combine
 import MastodonSDK
 import MastodonCore
 import AuthenticationServices
+import MastodonLocalization
+import SwiftUICore
 
 @MainActor
 final class AuthenticationViewModel {
     
+    public let stateStream: AsyncStream<State>
+    private let stateStreamContinuation: AsyncStream<State>.Continuation
+    
     var disposeBag = Set<AnyCancellable>()
     
     // input
-    private let context: AppContext
-    private let coordinator: SceneCoordinator
-    let isAuthenticationExist: Bool
     let input = CurrentValueSubject<String, Never>("")
     
     // output
-    let viewHierarchyShouldReset: Bool
     let domain = CurrentValueSubject<String?, Never>(nil)
     let isDomainValid = CurrentValueSubject<Bool, Never>(false)
     let isAuthenticating = CurrentValueSubject<Bool, Never>(false)
     let isRegistering = CurrentValueSubject<Bool, Never>(false)
     let isIdle = CurrentValueSubject<Bool, Never>(true)
-    let authenticated = PassthroughSubject<MastodonAuthenticationBox, Never>()
     let error = CurrentValueSubject<Error?, Never>(nil)
         
-    init(context: AppContext, coordinator: SceneCoordinator, isAuthenticationExist: Bool) {
-        self.context = context
-        self.coordinator = coordinator
-        self.isAuthenticationExist = isAuthenticationExist
-        self.viewHierarchyShouldReset = isAuthenticationExist
+    init() {
+        
+        (stateStream, stateStreamContinuation) = AsyncStream<State>.makeStream()
         
         input
             .map { input in
@@ -63,6 +61,188 @@ final class AuthenticationViewModel {
     
 }
 
+
+extension AuthenticationViewModel {
+    // Sign in to existing account
+    public func logInRequested() {
+        stateStreamContinuation.yield(.logInToExistingAccountRequested)
+    }
+    
+    func logIn(on server: Mastodon.Entity.Server, withPresentationContextProvider contextProvider: ASWebAuthenticationPresentationContextProviding) async {
+
+        stateStreamContinuation.yield(.authenticatingUser)
+        
+        do {
+            let application = try await APIService.shared.createApplication(domain: server.domain)
+            guard let authenticateInfo = AuthenticateInfo(domain: server.domain, application: application) else { throw AuthenticationError.badCredentials }
+            let authenticationController = MastodonAuthenticationController(
+                authenticateURL: authenticateInfo.authorizeURL
+            )
+            authenticationController.authenticationSession?.presentationContextProvider = contextProvider
+            authenticate(
+                info: authenticateInfo,
+                pinCodePublisher: authenticationController.resultStream
+            )
+            authenticationController.authenticationSession?.start()
+        } catch let error {
+            stateStreamContinuation.yield(.error(error))
+        }
+    }
+}
+
+extension AuthenticationViewModel {
+    // Register a new account
+    
+    public func pickServer() {
+        stateStreamContinuation.yield(.pickingServer)
+    }
+    
+    public func joinServer(_ server: Mastodon.Entity.Server) async throws {
+        
+        stateStreamContinuation.yield(.joiningServer(server))
+        
+        let instance = try await APIService.shared.instance(domain: server.domain, authenticationBox: nil)
+        
+        guard instance.registrations != false else {
+            throw AuthenticationViewModel.AuthenticationError.registrationClosed
+        }
+        let application = try await APIService.shared.createApplication(domain: server.domain)
+        
+        guard let authenticateInfo = AuthenticationViewModel.AuthenticateInfo(
+            domain: server.domain,
+            application: application
+        ) else {
+            throw APIService.APIError.explicit(.badResponse)
+        }
+        
+        let applicationToken = try await APIService.shared.applicationAccessToken(
+            domain: server.domain,
+            clientID: authenticateInfo.clientID,
+            clientSecret: authenticateInfo.clientSecret,
+            redirectURI: authenticateInfo.redirectURI
+        )
+        
+        func doStartRegistration() {
+            let mastodonRegisterViewModel = MastodonRegisterViewModel(
+                domain: server.domain,
+                authenticateInfo: authenticateInfo,
+                instance: instance,
+                applicationToken: applicationToken,
+                submitValidatedUserRegistration: { [weak self] (registerInfo, hasAgreedToRules) in
+                    await self?.registerNewUser(info: registerInfo, instance: server, hasAgreedToRules: hasAgreedToRules, locale: nil)
+                }
+            )
+            stateStreamContinuation.yield(.registering(mastodonRegisterViewModel))
+        }
+        
+        if let rules = instance.rules, !rules.isEmpty {
+            // show server rules before registering
+            let serverRulesViewModel = MastodonServerRulesView.ViewModel(
+                disclaimer: LocalizedStringKey(L10n.Scene.ServerRules.subtitle(server.domain)),
+                rules: rules.map({ $0.text }),
+                onAgree: { [weak self] in
+                    let privacyViewModel = PrivacyViewModel(domain: server.domain, authenticateInfo: authenticateInfo, rows: [.iOSApp, .server(domain: server.domain)], instance: instance, applicationToken: applicationToken, didAccept: { doStartRegistration() })
+                    self?.stateStreamContinuation.yield(.showingPrivacyPolicy(privacyViewModel))
+                },
+                onDisagree: { [weak self] in self?.stateStreamContinuation.yield(.showingRules(nil)) })
+            stateStreamContinuation.yield(.showingRules(serverRulesViewModel))
+        } else {
+            doStartRegistration()
+        }
+    }
+    
+    public func registerNewUser(info: MastodonRegisterViewModel, instance: Mastodon.Entity.Server, hasAgreedToRules: Bool, locale: String?) async {
+        assert(hasAgreedToRules == true)
+        let query = Mastodon.API.Account.RegisterQuery(
+            reason: info.reason,
+            username: info.username,
+            email: info.email,
+            password: info.password,
+            agreement: hasAgreedToRules, 
+            locale: locale ?? self.locale
+        )
+
+        do {
+            // register without showing server rules again
+            let userToken = try await APIService.shared.accountRegister(
+                domain: info.domain,
+                query: query,
+                authorization: info.applicationAuthorization
+            )
+            
+            let updateCredentialQuery: Mastodon.API.Account.UpdateCredentialQuery = {
+                let displayName: String? = info.name.isEmpty ? nil : info.name
+                return Mastodon.API.Account.UpdateCredentialQuery(
+                    displayName: displayName,
+                    avatar: nil
+                )
+            }()
+            let viewModel = MastodonConfirmEmailViewModel(email: info.email, authenticateInfo: info.authenticateInfo, userToken: userToken, updateCredentialQuery: updateCredentialQuery)
+            stateStreamContinuation.yield(.confirmingEmail(viewModel))
+        } catch let error {
+            var errorDueToMissingLocale: Bool
+            if let error = error as? Mastodon.API.Error,
+                  case let .generic(errorEntity) = error.mastodonError,
+               errorEntity.error == "Validation failed: Locale is not included in the list" {
+                errorDueToMissingLocale = true
+            } else {
+                errorDueToMissingLocale = false
+            }
+            let fallbackLocale = instance.languages.first ?? "en"
+            let alreadyTriedFallback = locale == fallbackLocale
+            if errorDueToMissingLocale && !alreadyTriedFallback {
+                await registerNewUser(info: info, instance: instance, hasAgreedToRules: hasAgreedToRules, locale: fallbackLocale)
+            } else {
+                stateStreamContinuation.yield(.error(error))
+            }
+        }
+    }
+    
+    private var locale: String {
+        guard let url = Bundle.main.url(forResource: "local-codes", withExtension: "json"),
+              let data = try? Data(contentsOf: url),
+              let localCode = try? JSONDecoder().decode(MastodonLocalCode.self, from: data)
+        else {
+            assertionFailure()
+            return "en"
+        }
+        let fallbackLanguageCode: String = {
+            let code = Locale.current.language.languageCode?.identifier ?? "en"
+            guard localCode[code] != nil else { return "en" }
+            return code
+        }()
+        
+        // pick device preferred language
+        guard let identifier = Locale.preferredLanguages.first else {
+            return fallbackLanguageCode
+        }
+        // prepare languageCode and validate then return fallback if needs
+        let local = Locale(identifier: identifier)
+        guard let languageCode = local.language.languageCode?.identifier,
+              localCode[languageCode] != nil
+        else {
+            return fallbackLanguageCode
+        }
+        // prepare extendCode and validate then return fallback if needs
+        let extendCodes: [String] = {
+            let locales = Locale.preferredLanguages.map { Locale(identifier: $0) }
+            return locales.compactMap { locale in
+                guard let languageCode = locale.language.languageCode?.identifier,
+                      let regionIdentifier = locale.region?.identifier
+                else { return nil }
+                return languageCode + "-" + regionIdentifier
+            }
+        }()
+        let _firstMatchExtendCode = extendCodes.first { code in
+            localCode[code] != nil
+        }
+        guard let firstMatchExtendCode = _firstMatchExtendCode else {
+            return languageCode
+        }
+        return firstMatchExtendCode
+    }
+}
+
 extension AuthenticationViewModel {
     static func parseDomain(from input: String) -> String? {
         let trimmed = input.trimmingCharacters(in: .whitespacesAndNewlines).lowercased()
@@ -82,6 +262,20 @@ extension AuthenticationViewModel {
 }
 
 extension AuthenticationViewModel {
+    enum State {
+        case initial
+        case error(Error)
+        case logInToExistingAccountRequested
+        case pickingServer
+        case joiningServer(Mastodon.Entity.Server)
+        case showingRules(MastodonServerRulesView.ViewModel?) // nil when we're returning to a previously configured state
+        case registering(MastodonRegisterViewModel)
+        case showingPrivacyPolicy(PrivacyViewModel)
+        case confirmingEmail(MastodonConfirmEmailViewModel)
+        case authenticatingUser
+        case authenticatedUser(MastodonAuthenticationBox)
+    }
+    
     enum AuthenticationError: Error, LocalizedError {
         case badCredentials
         case registrationClosed
@@ -137,7 +331,7 @@ extension AuthenticationViewModel {
         }
     }
     
-    func authenticate(info: AuthenticateInfo, pinCodePublisher: AsyncThrowingStream<String, Error>) {
+    private func authenticate(info: AuthenticateInfo, pinCodePublisher: AsyncThrowingStream<String, Error>) {
         Task {
             do {
                 for try await code in pinCodePublisher {
@@ -154,19 +348,19 @@ extension AuthenticationViewModel {
                         info: info,
                         userToken: token
                     )
-                    self.authenticated.send(authBox)
-                    self.authenticated.send(completion: .finished)
+                    AuthenticationServiceProvider.shared.activateAuthentication(authBox)
+                    self.stateStreamContinuation.yield(.authenticatedUser(authBox))
+                    self.stateStreamContinuation.finish()
                 }
             } catch let error {
                 self.isAuthenticating.value = false
                 if let error = error as? ASWebAuthenticationSessionError {
                     if error.errorCode == ASWebAuthenticationSessionError.canceledLogin.rawValue {
-                        authenticated.send(completion: .finished)
                         return
                     }
                 } else {
                     self.error.value = error
-                    authenticated.send(completion: .finished)
+                    stateStreamContinuation.yield(.error(error))
                 }
             }
         }
diff --git a/Mastodon/Scene/Onboarding/Share/MastodonAuthenticationController.swift b/Mastodon/Scene/Onboarding/Share/MastodonAuthenticationController.swift
index 34ef11b31e..cfbcbd6038 100644
--- a/Mastodon/Scene/Onboarding/Share/MastodonAuthenticationController.swift
+++ b/Mastodon/Scene/Onboarding/Share/MastodonAuthenticationController.swift
@@ -16,7 +16,6 @@ final class MastodonAuthenticationController {
     var disposeBag = Set<AnyCancellable>()
     
     // input
-    var context: AppContext
     let authenticateURL: URL
     var authenticationSession: ASWebAuthenticationSession?
     
@@ -25,10 +24,8 @@ final class MastodonAuthenticationController {
     private let resultStreamContinuation: AsyncThrowingStream<String, Error>.Continuation
     
     init(
-        context: AppContext,
         authenticateURL: URL
     ) {
-        self.context = context
         self.authenticateURL = authenticateURL
         
         (resultStream, resultStreamContinuation) = AsyncThrowingStream<String, Error>.makeStream()
diff --git a/Mastodon/Scene/Onboarding/Welcome/WelcomeViewController.swift b/Mastodon/Scene/Onboarding/Welcome/WelcomeViewController.swift
index 8b3516ad49..07ba94564d 100644
--- a/Mastodon/Scene/Onboarding/Welcome/WelcomeViewController.swift
+++ b/Mastodon/Scene/Onboarding/Welcome/WelcomeViewController.swift
@@ -18,15 +18,23 @@ final class WelcomeViewController: UIViewController, NeedsDependency {
         static let topAnchorInset: CGFloat = 20
     }
     
+    init() {
+        super.init(nibName: nil, bundle: nil)
+        authenticationStateTask = Task { [weak self] in
+            guard let stateStream = self?.authenticationViewModel.stateStream else { return }
+            for await authenticationState in stateStream {
+                self?.didEnter(authenticationState)
+            }
+        }
+    }
+    required init?(coder: NSCoder) { fatalError("init(coder:) has not been implemented") }
+    
     weak var context: AppContext! { willSet { precondition(!isViewLoaded) } }
     weak var coordinator: SceneCoordinator! { willSet { precondition(!isViewLoaded) } }
 
-    private(set) lazy var authenticationViewModel = AuthenticationViewModel(
-        context: context,
-        coordinator: coordinator,
-        isAuthenticationExist: false
-    )
-
+    private let authenticationViewModel = AuthenticationViewModel()
+    private var authenticationStateTask: Task<(), Never>?
+    
     var disposeBag = Set<AnyCancellable>()
     var observations = Set<NSKeyValueObservation>()
     private(set) lazy var viewModel = WelcomeViewModel(context: context)
@@ -64,7 +72,7 @@ final class WelcomeViewController: UIViewController, NeedsDependency {
         return button
     }()
 
-    private(set) lazy var signUpButton: UIButton = {
+    private(set) lazy var pickOtherServerButton: UIButton = {
 
         var buttonConfiguration = UIButton.Configuration.borderedTinted()
         buttonConfiguration.attributedTitle = AttributedString(
@@ -124,6 +132,55 @@ final class WelcomeViewController: UIViewController, NeedsDependency {
     }()
 }
 
+extension WelcomeViewController {
+    private func displayError(_ error: Error) {
+        let alertController = UIAlertController(for: error, title: "Error", preferredStyle: .alert)
+        let okAction = UIAlertAction(title: L10n.Common.Controls.Actions.ok, style: .default, handler: nil)
+        alertController.addAction(okAction)
+        _ = self.coordinator.present(
+            scene: .alertController(alertController: alertController),
+            from: nil,
+            transition: .alertController(animated: true, completion: nil)
+        )
+    }
+    
+    private func didEnter(_ state: AuthenticationViewModel.State) {
+        switch state {
+        case .initial:
+            break
+        case .error(let error):
+            displayError(error)
+        case .logInToExistingAccountRequested:
+            _ = coordinator.present(scene: .mastodonLogin(authenticationViewModel: authenticationViewModel, suggestedDomain: viewModel.randomDefaultServer?.domain), from: self, transition: .show)
+        case .joiningServer:
+            break
+        case .showingRules(let viewModel):
+            if let viewModel {
+                _ = coordinator.present(scene: .mastodonServerRules(viewModel: viewModel), from: self, transition: .show)
+            } else {
+                popBack()
+            }
+        case .registering(let viewModel):
+            _ = coordinator.present(scene: .mastodonRegister(viewModel: viewModel), from: self, transition: .show)
+        case .showingPrivacyPolicy(let viewModel):
+            _ = coordinator.present(scene: .mastodonPrivacyPolicies(viewModel: viewModel), from: self, transition: .show)
+        case .pickingServer:
+            _ = coordinator.present(scene: .mastodonPickServer(viewMode: MastodonPickServerViewModel(joinServer: { [weak self] server in try await self?.authenticationViewModel.joinServer(server) }, displayError: { [weak self] error in self?.displayError(error) })), from: self, transition: .show)
+        case .confirmingEmail(let viewModel):
+            _ = coordinator.present(scene: .mastodonConfirmEmail(viewModel: viewModel), from: self, transition: .show)
+        case .authenticatedUser(let authBox):
+            coordinator.setup()
+            break
+        case .authenticatingUser:
+            break
+        }
+    }
+    
+    private func popBack() {
+        navigationController?.popViewController(animated: true)
+    }
+}
+
 extension WelcomeViewController {
     
     override func viewDidLoad() {
@@ -169,10 +226,10 @@ extension WelcomeViewController {
             joinDefaultServerButton.heightAnchor.constraint(greaterThanOrEqualToConstant: WelcomeViewController.actionButtonHeight)
         ])
         
-        signUpButton.translatesAutoresizingMaskIntoConstraints = false
-        buttonContainer.addArrangedSubview(signUpButton)
+        pickOtherServerButton.translatesAutoresizingMaskIntoConstraints = false
+        buttonContainer.addArrangedSubview(pickOtherServerButton)
         NSLayoutConstraint.activate([
-            signUpButton.heightAnchor.constraint(greaterThanOrEqualToConstant: WelcomeViewController.actionButtonHeight)
+            pickOtherServerButton.heightAnchor.constraint(greaterThanOrEqualToConstant: WelcomeViewController.actionButtonHeight)
         ])
 
         buttonContainer.addArrangedSubview(separatorView)
@@ -197,8 +254,8 @@ extension WelcomeViewController {
             separatorView.centerYAnchor.constraint(equalTo: welcomeIllustrationView.bottomAnchor)
         ])
 
-        joinDefaultServerButton.addTarget(self, action: #selector(joinDefaultServer(_:)), for: .touchUpInside)
-        signUpButton.addTarget(self, action: #selector(signUp(_:)), for: .touchUpInside)
+        joinDefaultServerButton.addTarget(self, action: #selector(joinDefaultServerTapped(_:)), for: .touchUpInside)
+        pickOtherServerButton.addTarget(self, action: #selector(pickOtherServerTapped(_:)), for: .touchUpInside)
         signInButton.addTarget(self, action: #selector(signIn(_:)), for: .touchUpInside)
         learnMoreButton.addTarget(self, action: #selector(learnMore(_:)), for: .touchUpInside)
 
@@ -214,20 +271,13 @@ extension WelcomeViewController {
 
         setupIllustrationLayout()
 
-        joinDefaultServerButton.configuration?.showsActivityIndicator = true
-        joinDefaultServerButton.isEnabled = false
-        joinDefaultServerButton.configuration?.title = nil
+        configureJoinDefaultServerButton(nil, isLoading: true)
 
         viewModel.downloadDefaultServer { [weak self] in
             guard let selectedDefaultServer = self?.viewModel.randomDefaultServer else { return }
 
             DispatchQueue.main.async {
-                self?.joinDefaultServerButton.configuration?.showsActivityIndicator = false
-                self?.joinDefaultServerButton.isEnabled = true
-                self?.joinDefaultServerButton.configuration?.attributedTitle = AttributedString(
-                    L10n.Scene.Welcome.joinDefaultServer(selectedDefaultServer.domain),
-                    attributes: .init([.font: UIFontMetrics(forTextStyle: .headline).scaledFont(for: .systemFont(ofSize: 17, weight: .semibold))])
-                )
+                self?.configureJoinDefaultServerButton(selectedDefaultServer.domain, isLoading: false)
             }
         }
     }
@@ -271,123 +321,72 @@ extension WelcomeViewController {
 }
 
 extension WelcomeViewController {
+    
+    private func joinServer(_ server: Mastodon.Entity.Server) {
+        Task {
+            do {
+                try await authenticationViewModel.joinServer(server)
+            } catch let error {
+                displayError(error)
+            }
+        }
+    }
 
     //MARK: - Actions
     @objc
-    private func joinDefaultServer(_ sender: UIButton) {
+    private func joinDefaultServerTapped(_ sender: UIButton) {
 
         guard let server = viewModel.randomDefaultServer else { return }
-        sender.configuration?.title = nil
-        sender.isEnabled = false
-        sender.configuration?.showsActivityIndicator = true
-
-        authenticationViewModel.isAuthenticating.send(true)
-
-        APIService.shared.instance(domain: server.domain, authenticationBox: nil)
-            .compactMap { [weak self] response -> AnyPublisher<MastodonPickServerViewModel.SignUpResponseFirst, Error>? in
-                guard let self = self else { return nil }
-                guard response.value.registrations != false else {
-                    return Fail(error: AuthenticationViewModel.AuthenticationError.registrationClosed).eraseToAnyPublisher()
-                }
-                return APIService.shared.createApplication(domain: server.domain)
-                    .map { MastodonPickServerViewModel.SignUpResponseFirst(instance: response, application: $0) }
-                    .eraseToAnyPublisher()
-            }
-            .switchToLatest()
-            .tryMap { response -> MastodonPickServerViewModel.SignUpResponseSecond in
-                let application = response.application.value
-                guard let authenticateInfo = AuthenticationViewModel.AuthenticateInfo(
-                        domain: server.domain,
-                        application: application
-                ) else {
-                    throw APIService.APIError.explicit(.badResponse)
-                }
-                return MastodonPickServerViewModel.SignUpResponseSecond(
-                    instance: response.instance,
-                    authenticateInfo: authenticateInfo
-                )
-            }
-            .compactMap { [weak self] response -> AnyPublisher<MastodonPickServerViewModel.SignUpResponseThird, Error>? in
-                guard let self = self else { return nil }
-                let instance = response.instance
-                let authenticateInfo = response.authenticateInfo
-                return APIService.shared.applicationAccessToken(
-                    domain: server.domain,
-                    clientID: authenticateInfo.clientID,
-                    clientSecret: authenticateInfo.clientSecret,
-                    redirectURI: authenticateInfo.redirectURI
-                )
-                .map {
-                    MastodonPickServerViewModel.SignUpResponseThird(
-                        instance: instance,
-                        authenticateInfo: authenticateInfo,
-                        applicationToken: $0
-                    )
-                }
-                .eraseToAnyPublisher()
-            }
-            .switchToLatest()
-            .receive(on: DispatchQueue.main)
-            .sink { [weak self] completion in
-                guard let self = self else { return }
-                self.authenticationViewModel.isAuthenticating.send(false)
-
-                switch completion {
-                case .failure(_):
-                    guard let randomServer = self.viewModel.pickRandomDefaultServer() else { return }
-
-                    self.viewModel.randomDefaultServer = randomServer
-
-                    sender.isEnabled = true
-                    sender.configuration?.showsActivityIndicator = false
-                    sender.configuration?.attributedTitle = AttributedString(
-                        L10n.Scene.Welcome.joinDefaultServer(randomServer.domain),
-                        attributes: .init([.font: UIFontMetrics(forTextStyle: .headline).scaledFont(for: .systemFont(ofSize: 17, weight: .semibold))])
-                    )
-                case .finished:
-                    sender.isEnabled = true
-                    sender.configuration?.showsActivityIndicator = false
-                    sender.configuration?.attributedTitle = AttributedString(
-                        L10n.Scene.Welcome.joinDefaultServer(server.domain),
-                        attributes: .init([.font: UIFontMetrics(forTextStyle: .headline).scaledFont(for: .systemFont(ofSize: 17, weight: .semibold))])
-                    )
-                }
-
-            } receiveValue: { [weak self] response in
-                guard let self = self else { return }
-                if let rules = response.instance.value.rules, !rules.isEmpty {
-                    // show server rules before register
-                    let mastodonServerRulesViewModel = MastodonServerRulesViewModel(
-                        domain: server.domain,
-                        authenticateInfo: response.authenticateInfo,
-                        rules: rules,
-                        instance: response.instance.value,
-                        applicationToken: response.applicationToken.value
-                    )
-                    _ = self.coordinator.present(scene: .mastodonServerRules(viewModel: mastodonServerRulesViewModel), from: self, transition: .show)
-                } else {
-                    let mastodonRegisterViewModel = MastodonRegisterViewModel(
-                        context: self.context,
-                        domain: server.domain,
-                        authenticateInfo: response.authenticateInfo,
-                        instance: response.instance.value,
-                        applicationToken: response.applicationToken.value
-                    )
-                    _ = self.coordinator.present(scene: .mastodonRegister(viewModel: mastodonRegisterViewModel), from: nil, transition: .show)
+       
+        configureJoinDefaultServerButton(server.domain, isLoading: true)
+        
+        Task {
+            do {
+                try await authenticationViewModel.joinServer(server)
+                // reset the button after successful completion (which is not completion of the full sign in process, only the first step of reaching the server and getting the rules)
+                configureJoinDefaultServerButton(server.domain, isLoading: false)
+            } catch {
+                // reset to try again with a potentially different random default server
+                guard let randomServer = self.viewModel.pickRandomDefaultServer() else {
+                    configureJoinDefaultServerButton(nil, isLoading: true)
+                    return
                 }
+                self.viewModel.randomDefaultServer = randomServer
+                configureJoinDefaultServerButton(randomServer.domain, isLoading: false)
             }
-            .store(in: &disposeBag)
-
+        }
+    }
+    
+    private func configureJoinDefaultServerButton(_ domain: String?, isLoading: Bool) {
+        guard let domain else {
+            joinDefaultServerButton.configuration?.showsActivityIndicator = isLoading
+            joinDefaultServerButton.isEnabled = false
+            joinDefaultServerButton.configuration?.title = nil
+            return
+        }
+        
+        if isLoading {
+            joinDefaultServerButton.configuration?.title = nil
+            joinDefaultServerButton.isEnabled = false
+            joinDefaultServerButton.configuration?.showsActivityIndicator = true
+        } else {
+            joinDefaultServerButton.isEnabled = true
+            joinDefaultServerButton.configuration?.showsActivityIndicator = false
+            joinDefaultServerButton.configuration?.attributedTitle = AttributedString(
+                L10n.Scene.Welcome.joinDefaultServer(domain),
+                attributes: .init([.font: UIFontMetrics(forTextStyle: .headline).scaledFont(for: .systemFont(ofSize: 17, weight: .semibold))])
+            )
+        }
     }
 
     @objc
-    private func signUp(_ sender: UIButton) {
-        _ = coordinator.present(scene: .mastodonPickServer(viewMode: MastodonPickServerViewModel(context: context)), from: self, transition: .show)
+    private func pickOtherServerTapped(_ sender: UIButton) {
+        authenticationViewModel.pickServer()
     }
     
     @objc
     private func signIn(_ sender: UIButton) {
-        _ = coordinator.present(scene: .mastodonLogin, from: self, transition: .show)
+        authenticationViewModel.logInRequested()
     }
 
     @objc
diff --git a/Mastodon/Scene/Settings/Server Details/InstanceRulesViewController.swift b/Mastodon/Scene/Settings/Server Details/InstanceRulesViewController.swift
index d1976dbcae..623ff0d5ac 100644
--- a/Mastodon/Scene/Settings/Server Details/InstanceRulesViewController.swift	
+++ b/Mastodon/Scene/Settings/Server Details/InstanceRulesViewController.swift	
@@ -31,8 +31,8 @@ class InstanceRulesViewController: UIHostingController<InstanceRulesView> {
         self.rootView.rulesView.viewModel = .init(
             disclaimer: nil,
             rules: instance.rules?.map({ $0.text }) ?? [],
-            onAgree: nil,
-            onDisagree: nil
+            onAgree: self.rootView.rulesView.viewModel.onAgree,
+            onDisagree: self.rootView.rulesView.viewModel.onDisagree
         )
     }
 }
diff --git a/MastodonSDK/Sources/MastodonCore/Service/API/APIService+Account.swift b/MastodonSDK/Sources/MastodonCore/Service/API/APIService+Account.swift
index 8e0caae50e..5b389f285f 100644
--- a/MastodonSDK/Sources/MastodonCore/Service/API/APIService+Account.swift
+++ b/MastodonSDK/Sources/MastodonCore/Service/API/APIService+Account.swift
@@ -104,8 +104,8 @@ extension APIService {
         domain: String,
         query: Mastodon.API.Account.RegisterQuery,
         authorization: Mastodon.API.OAuth.Authorization
-    ) -> AnyPublisher<Mastodon.Response.Content<Mastodon.Entity.Token>, Error> {
-        return Mastodon.API.Account.register(
+    ) async throws -> Mastodon.Entity.Token {
+        return try await Mastodon.API.Account.register(
             session: session,
             domain: domain,
             query: query,
diff --git a/MastodonSDK/Sources/MastodonCore/Service/API/APIService+App.swift b/MastodonSDK/Sources/MastodonCore/Service/API/APIService+App.swift
index 530d4288a7..9e370ee148 100644
--- a/MastodonSDK/Sources/MastodonCore/Service/API/APIService+App.swift
+++ b/MastodonSDK/Sources/MastodonCore/Service/API/APIService+App.swift
@@ -20,14 +20,14 @@ extension APIService {
     #endif
 
     private static let appWebsite = "https://app.joinmastodon.org/ios"
-
-    public func createApplication(domain: String) -> AnyPublisher<Mastodon.Response.Content<Mastodon.Entity.Application>, Error> {
+    
+    public func createApplication(domain: String) async throws -> Mastodon.Entity.Application {
         let query = Mastodon.API.App.CreateQuery(
             clientName: APIService.clientName,
             redirectURIs: APIService.oauthCallbackURL,
             website: APIService.appWebsite
         )
-        return Mastodon.API.App.create(
+        return try await Mastodon.API.App.create(
             session: session,
             domain: domain,
             query: query
diff --git a/MastodonSDK/Sources/MastodonLocalization/Generated/Strings.swift b/MastodonSDK/Sources/MastodonLocalization/Generated/Strings.swift
index fd7e16ff7b..74feb6b16a 100644
--- a/MastodonSDK/Sources/MastodonLocalization/Generated/Strings.swift
+++ b/MastodonSDK/Sources/MastodonLocalization/Generated/Strings.swift
@@ -919,8 +919,8 @@ public enum L10n {
       }
     }
     public enum Login {
-      /// Log in with the server where you created your account.
-      public static let subtitle = L10n.tr("Localizable", "Scene.Login.Subtitle", fallback: "Log in with the server where you created your account.")
+      /// Log in with the server where you created your account. For example, if your handle is @you@example.social, enter 'example.social'.
+      public static let subtitle = L10n.tr("Localizable", "Scene.Login.Subtitle", fallback: "Log in with the server where you created your account. For example, if your handle is @you@example.social, enter 'example.social'.")
       /// Welcome Back
       public static let title = L10n.tr("Localizable", "Scene.Login.Title", fallback: "Welcome Back")
       public enum ServerSearchField {
diff --git a/MastodonSDK/Sources/MastodonLocalization/Resources/Base.lproj/Localizable.strings b/MastodonSDK/Sources/MastodonLocalization/Resources/Base.lproj/Localizable.strings
index fc49cc2e6d..4f31f2892f 100644
--- a/MastodonSDK/Sources/MastodonLocalization/Resources/Base.lproj/Localizable.strings
+++ b/MastodonSDK/Sources/MastodonLocalization/Resources/Base.lproj/Localizable.strings
@@ -326,7 +326,7 @@ uploaded to Mastodon.";
 "Scene.HomeTimeline.TimelinePill.PostSent" = "Post Sent";
 "Scene.HomeTimeline.Title" = "Home";
 "Scene.Login.ServerSearchField.Placeholder" = "Enter URL or search for your server";
-"Scene.Login.Subtitle" = "Log in with the server where you created your account.";
+"Scene.Login.Subtitle" = "Log in with the server where you created your account. For example, if your handle is @you@example.social, enter 'example.social'.";
 "Scene.Login.Title" = "Welcome Back";
 "Scene.Notification.FilteredNotification.Accept" = "Accept";
 "Scene.Notification.FilteredNotification.Dismiss" = "Dismiss";
diff --git a/MastodonSDK/Sources/MastodonLocalization/Resources/en.lproj/Localizable.strings b/MastodonSDK/Sources/MastodonLocalization/Resources/en.lproj/Localizable.strings
index a5af043724..7efa6b1c28 100644
--- a/MastodonSDK/Sources/MastodonLocalization/Resources/en.lproj/Localizable.strings
+++ b/MastodonSDK/Sources/MastodonLocalization/Resources/en.lproj/Localizable.strings
@@ -315,7 +315,7 @@ uploaded to Mastodon.";
 "Scene.HomeTimeline.TimelinePill.PostSent" = "Post Sent";
 "Scene.HomeTimeline.Title" = "Home";
 "Scene.Login.ServerSearchField.Placeholder" = "Enter URL or search for your server";
-"Scene.Login.Subtitle" = "Log in with the server where you created your account.";
+"Scene.Login.Subtitle" = "Log in with the server where you created your account. For example, if your handle is @you@example.social, enter 'example.social'.";
 "Scene.Login.Title" = "Welcome Back";
 "Scene.Notification.FollowRequest.Accept" = "Accept";
 "Scene.Notification.FollowRequest.Accepted" = "Accepted";
diff --git a/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+Account+Credentials.swift b/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+Account+Credentials.swift
index ede4d9ace0..ecb4aafd2e 100644
--- a/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+Account+Credentials.swift
+++ b/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+Account+Credentials.swift
@@ -30,24 +30,21 @@ extension Mastodon.API.Account {
     ///   - domain: Mastodon instance domain. e.g. "example.com"
     ///   - query: `RegisterQuery` with account registration information
     ///   - authorization: App token
-    /// - Returns: `AnyPublisher` contains `Token` nested in the response
+    /// - Returns: `Token`
     public static func register(
         session: URLSession,
         domain: String,
         query: RegisterQuery,
         authorization: Mastodon.API.OAuth.Authorization
-    ) -> AnyPublisher<Mastodon.Response.Content<Mastodon.Entity.Token>, Error> {
+    ) async throws -> Mastodon.Entity.Token {
         let request = Mastodon.API.post(
             url: accountsEndpointURL(domain: domain),
             query: query,
             authorization: authorization
         )
-        return session.dataTaskPublisher(for: request)
-            .tryMap { data, response in
-                let value = try Mastodon.API.decode(type: Mastodon.Entity.Token.self, from: data, response: response)
-                return Mastodon.Response.Content(value: value, response: response)
-            }
-            .eraseToAnyPublisher()
+        let (data, response) = try await session.data(for: request)
+        let token = try Mastodon.API.decode(type: Mastodon.Entity.Token.self, from: data, response: response)
+        return token
     }
     
     public struct RegisterQuery: Codable, PostQuery {
diff --git a/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+App.swift b/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+App.swift
index 48d78d680c..5c547eaa7c 100644
--- a/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+App.swift
+++ b/MastodonSDK/Sources/MastodonSDK/API/Mastodon+API+App.swift
@@ -32,23 +32,20 @@ extension Mastodon.API.App {
     ///   - session: `URLSession`
     ///   - domain: Mastodon instance domain. e.g. "example.com"
     ///   - query: `CreateQuery`
-    /// - Returns: `AnyPublisher` contains `Application` nested in the response
+    /// - Returns: `Application`
     public static func create(
         session: URLSession,
         domain: String,
         query: CreateQuery
-    ) -> AnyPublisher<Mastodon.Response.Content<Mastodon.Entity.Application>, Error>  {
+    ) async throws -> Mastodon.Entity.Application  {
         let request = Mastodon.API.post(
             url: appEndpointURL(domain: domain),
             query: query,
             authorization: nil
         )
-        return session.dataTaskPublisher(for: request)
-            .tryMap { data, response in
-                let value = try Mastodon.API.decode(type: Mastodon.Entity.Application.self, from: data, response: response)
-                return Mastodon.Response.Content(value: value, response: response)
-            }
-            .eraseToAnyPublisher()
+        let (data, response) = try await session.data(for: request)
+        let value = try Mastodon.API.decode(type: Mastodon.Entity.Application.self, from: data, response: response)
+        return value
     }
     
     /// Verify application token
