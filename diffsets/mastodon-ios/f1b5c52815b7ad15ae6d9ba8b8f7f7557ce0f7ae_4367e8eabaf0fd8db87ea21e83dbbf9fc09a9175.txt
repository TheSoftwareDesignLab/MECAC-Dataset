diff --git a/Mastodon.xcodeproj/project.pbxproj b/Mastodon.xcodeproj/project.pbxproj
index d2eda9b898..66c28a3998 100644
--- a/Mastodon.xcodeproj/project.pbxproj
+++ b/Mastodon.xcodeproj/project.pbxproj
@@ -3048,7 +3048,7 @@
 		DB025B8E278D6448002F581E /* ShellScript */ = {
 			isa = PBXShellScriptBuildPhase;
 			alwaysOutOfDate = 1;
-			buildActionMask = 8;
+			buildActionMask = 12;
 			files = (
 			);
 			inputFileListPaths = (
@@ -3059,14 +3059,14 @@
 			);
 			outputPaths = (
 			);
-			runOnlyForDeploymentPostprocessing = 1;
+			runOnlyForDeploymentPostprocessing = 0;
 			shellPath = /bin/sh;
 			shellScript = "if [[ -f \"${PODS_ROOT}/Sourcery/bin/sourcery\" ]]; then\n  \"${PODS_ROOT}/Sourcery/bin/sourcery\" --config ./MastodonSDK/Sources/CoreDataStack\nelse\n  echo \"warning: Sourcery is not installed. Run 'pod install --repo-update' to install it.\"\nfi\n";
 		};
 		DB3D100425BAA71500EAA174 /* ShellScript */ = {
 			isa = PBXShellScriptBuildPhase;
 			alwaysOutOfDate = 1;
-			buildActionMask = 8;
+			buildActionMask = 12;
 			files = (
 			);
 			inputFileListPaths = (
@@ -3077,14 +3077,14 @@
 			);
 			outputPaths = (
 			);
-			runOnlyForDeploymentPostprocessing = 1;
+			runOnlyForDeploymentPostprocessing = 0;
 			shellPath = /bin/sh;
 			shellScript = "if [[ -f \"${PODS_ROOT}/SwiftGen/bin/swiftgen\" ]]; then\n  \"${PODS_ROOT}/SwiftGen/bin/swiftgen\" \nelse\n  echo \"warning: SwiftGen is not installed. Run 'pod install --repo-update' to install it.\"\nfi\n";
 		};
 		DB697DD2278F48D5004EF2F7 /* ShellScript */ = {
 			isa = PBXShellScriptBuildPhase;
 			alwaysOutOfDate = 1;
-			buildActionMask = 8;
+			buildActionMask = 12;
 			files = (
 			);
 			inputFileListPaths = (
@@ -3095,7 +3095,7 @@
 			);
 			outputPaths = (
 			);
-			runOnlyForDeploymentPostprocessing = 1;
+			runOnlyForDeploymentPostprocessing = 0;
 			shellPath = /bin/sh;
 			shellScript = "if [[ -f \"${PODS_ROOT}/Sourcery/bin/sourcery\" ]]; then\n  \"${PODS_ROOT}/Sourcery/bin/sourcery\" --config ./Mastodon\nelse\n  echo \"warning: Sourcery is not installed. Run 'pod install --repo-update' to install it.\"\nfi\n";
 		};
diff --git a/Mastodon.xcodeproj/xcuserdata/mainasuk.xcuserdatad/xcschemes/xcschememanagement.plist b/Mastodon.xcodeproj/xcuserdata/mainasuk.xcuserdatad/xcschemes/xcschememanagement.plist
index 33eda54f12..31423978e0 100644
--- a/Mastodon.xcodeproj/xcuserdata/mainasuk.xcuserdatad/xcschemes/xcschememanagement.plist
+++ b/Mastodon.xcodeproj/xcuserdata/mainasuk.xcuserdatad/xcschemes/xcschememanagement.plist
@@ -112,12 +112,12 @@
 		<key>NotificationService.xcscheme_^#shared#^_</key>
 		<dict>
 			<key>orderHint</key>
-			<integer>18</integer>
+			<integer>17</integer>
 		</dict>
 		<key>ShareActionExtension.xcscheme_^#shared#^_</key>
 		<dict>
 			<key>orderHint</key>
-			<integer>17</integer>
+			<integer>18</integer>
 		</dict>
 	</dict>
 	<key>SuppressBuildableAutocreation</key>
diff --git a/Mastodon/Scene/Compose/ComposeViewController.swift b/Mastodon/Scene/Compose/ComposeViewController.swift
index 1d847f040d..c94db4def5 100644
--- a/Mastodon/Scene/Compose/ComposeViewController.swift
+++ b/Mastodon/Scene/Compose/ComposeViewController.swift
@@ -207,24 +207,6 @@ extension ComposeViewController {
 //                self.title = title
 //            }
 //            .store(in: &disposeBag)
-//        self.setupBackgroundColor(theme: ThemeService.shared.currentTheme.value)
-//        ThemeService.shared.currentTheme
-//            .receive(on: RunLoop.main)
-//            .sink { [weak self] theme in
-//                guard let self = self else { return }
-//                self.setupBackgroundColor(theme: theme)
-//            }
-//            .store(in: &disposeBag)
-//
-//
-//        scrollView.translatesAutoresizingMaskIntoConstraints = false
-//        view.addSubview(scrollView)
-//        NSLayoutConstraint.activate([
-//            scrollView.topAnchor.constraint(equalTo: view.topAnchor),
-//            scrollView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
-//            scrollView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
-//            scrollView.bottomAnchor.constraint(equalTo: view.bottomAnchor),
-//        ])
 //
 //        composeToolbarView.translatesAutoresizingMaskIntoConstraints = false
 //        view.addSubview(composeToolbarView)
@@ -286,89 +268,7 @@ extension ComposeViewController {
 //        // update layout when keyboard show/dismiss
 //        view.layoutIfNeeded()
 //
-//        let keyboardHasShortcutBar = CurrentValueSubject<Bool, Never>(traitCollection.userInterfaceIdiom == .pad)       // update default value later
-//        let keyboardEventPublishers = Publishers.CombineLatest3(
-//            KeyboardResponderService.shared.isShow,
-//            KeyboardResponderService.shared.state,
-//            KeyboardResponderService.shared.endFrame
-//        )
-//        Publishers.CombineLatest3(
-//            keyboardEventPublishers,
-//            viewModel.$isCustomEmojiComposing,
-//            viewModel.$autoCompleteInfo
-//        )
-//        .sink(receiveValue: { [weak self] keyboardEvents, isCustomEmojiComposing, autoCompleteInfo in
-//            guard let self = self else { return }
-//
-//            let (isShow, state, endFrame) = keyboardEvents
-//
-//            switch self.traitCollection.userInterfaceIdiom {
-//            case .pad:
-//                keyboardHasShortcutBar.value = state != .floating
-//            default:
-//                keyboardHasShortcutBar.value = false
-//            }
-//
-//            let extraMargin: CGFloat = {
-//                var margin = self.composeToolbarView.frame.height
-//                if autoCompleteInfo != nil {
-//                    margin += ComposeViewController.minAutoCompleteVisibleHeight
-//                }
-//                return margin
-//            }()
-//
-//            guard isShow, state == .dock else {
-//                self.tableView.contentInset.bottom = extraMargin
-//                self.tableView.verticalScrollIndicatorInsets.bottom = extraMargin
-//
-//                if let superView = self.autoCompleteViewController.tableView.superview {
-//                    let autoCompleteTableViewBottomInset: CGFloat = {
-//                        let tableViewFrameInWindow = superView.convert(self.autoCompleteViewController.tableView.frame, to: nil)
-//                        let padding = tableViewFrameInWindow.maxY + self.composeToolbarView.frame.height + AutoCompleteViewController.chevronViewHeight - self.view.frame.maxY
-//                        return max(0, padding)
-//                    }()
-//                    self.autoCompleteViewController.tableView.contentInset.bottom = autoCompleteTableViewBottomInset
-//                    self.autoCompleteViewController.tableView.verticalScrollIndicatorInsets.bottom = autoCompleteTableViewBottomInset
-//                }
-//
-//                UIView.animate(withDuration: 0.3) {
-//                    self.composeToolbarViewBottomLayoutConstraint.constant = self.view.safeAreaInsets.bottom
-//                    if self.view.window != nil {
-//                        self.view.layoutIfNeeded()
-//                    }
-//                }
-//                return
-//            }
-//            // isShow AND dock state
-//            self.systemKeyboardHeight = endFrame.height
-//
-//            // adjust inset for auto-complete
-//            let autoCompleteTableViewBottomInset: CGFloat = {
-//                guard let superview = self.autoCompleteViewController.tableView.superview else { return .zero }
-//                let tableViewFrameInWindow = superview.convert(self.autoCompleteViewController.tableView.frame, to: nil)
-//                let padding = tableViewFrameInWindow.maxY + self.composeToolbarView.frame.height + AutoCompleteViewController.chevronViewHeight - endFrame.minY
-//                return max(0, padding)
-//            }()
-//            self.autoCompleteViewController.tableView.contentInset.bottom = autoCompleteTableViewBottomInset
-//            self.autoCompleteViewController.tableView.verticalScrollIndicatorInsets.bottom = autoCompleteTableViewBottomInset
-//
-//            // adjust inset for tableView
-//            let contentFrame = self.view.convert(self.tableView.frame, to: nil)
-//            let padding = contentFrame.maxY + extraMargin - endFrame.minY
-//            guard padding > 0 else {
-//                self.tableView.contentInset.bottom = self.view.safeAreaInsets.bottom + extraMargin
-//                self.tableView.verticalScrollIndicatorInsets.bottom = self.view.safeAreaInsets.bottom + extraMargin
-//                return
-//            }
-//
-//            self.tableView.contentInset.bottom = padding - self.view.safeAreaInsets.bottom
-//            self.tableView.verticalScrollIndicatorInsets.bottom = padding - self.view.safeAreaInsets.bottom
-//            UIView.animate(withDuration: 0.3) {
-//                self.composeToolbarViewBottomLayoutConstraint.constant = endFrame.height
-//                self.view.layoutIfNeeded()
-//            }
-//        })
-//        .store(in: &disposeBag)
+
 //
 //        // bind auto-complete
 //        viewModel.$autoCompleteInfo
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Contents.json
new file mode 100644
index 0000000000..6e965652df
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Contents.json
@@ -0,0 +1,9 @@
+{
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "provides-namespace" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Contents.json
new file mode 100644
index 0000000000..04f310f98c
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "Earth.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "preserves-vector-representation" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Earth.pdf b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Earth.pdf
new file mode 100644
index 0000000000..4f6b948a30
Binary files /dev/null and b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/Earth.imageset/Earth.pdf differ
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/button.tint.colorset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/button.tint.colorset/Contents.json
new file mode 100644
index 0000000000..9bdcecb671
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/button.tint.colorset/Contents.json
@@ -0,0 +1,38 @@
+{
+  "colors" : [
+    {
+      "color" : {
+        "color-space" : "srgb",
+        "components" : {
+          "alpha" : "1.000",
+          "blue" : "0x38",
+          "green" : "0x29",
+          "red" : "0x2B"
+        }
+      },
+      "idiom" : "universal"
+    },
+    {
+      "appearances" : [
+        {
+          "appearance" : "luminosity",
+          "value" : "dark"
+        }
+      ],
+      "color" : {
+        "color-space" : "srgb",
+        "components" : {
+          "alpha" : "1.000",
+          "blue" : "0xF9",
+          "green" : "0xF5",
+          "red" : "0xF5"
+        }
+      },
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/Contents.json
new file mode 100644
index 0000000000..7ed4f66e6d
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "chat.warning.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "preserves-vector-representation" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/chat.warning.pdf b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/chat.warning.pdf
new file mode 100644
index 0000000000..8b984cc826
Binary files /dev/null and b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/chat.warning.imageset/chat.warning.pdf differ
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/Contents.json
new file mode 100644
index 0000000000..26d6caeb6e
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "emoji.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "preserves-vector-representation" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/emoji.pdf b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/emoji.pdf
new file mode 100644
index 0000000000..59180776b2
Binary files /dev/null and b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/emoji.imageset/emoji.pdf differ
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/Contents.json
new file mode 100644
index 0000000000..aad419f8f6
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "media.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "preserves-vector-representation" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/media.pdf b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/media.pdf
new file mode 100644
index 0000000000..91bd4fa06e
Binary files /dev/null and b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/media.imageset/media.pdf differ
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/Contents.json b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/Contents.json
new file mode 100644
index 0000000000..0840327d8c
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "poll.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "preserves-vector-representation" : true
+  }
+}
diff --git a/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/poll.pdf b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/poll.pdf
new file mode 100644
index 0000000000..51f03cd123
Binary files /dev/null and b/MastodonSDK/Sources/MastodonAsset/Assets.xcassets/Scene/Compose/poll.imageset/poll.pdf differ
diff --git a/MastodonSDK/Sources/MastodonAsset/Generated/Assets.swift b/MastodonSDK/Sources/MastodonAsset/Generated/Assets.swift
index edbf78a0bb..efdc2164e5 100644
--- a/MastodonSDK/Sources/MastodonAsset/Generated/Assets.swift
+++ b/MastodonSDK/Sources/MastodonAsset/Generated/Assets.swift
@@ -129,6 +129,14 @@ public enum Asset {
     public static let star = ImageAsset(name: "ObjectsAndTools/star")
   }
   public enum Scene {
+    public enum Compose {
+      public static let buttonTint = ColorAsset(name: "Scene/Compose/button.tint")
+      public static let chatWarning = ImageAsset(name: "Scene/Compose/chat.warning")
+      public static let earth = ImageAsset(name: "Scene/Compose/earth")
+      public static let emoji = ImageAsset(name: "Scene/Compose/emoji")
+      public static let media = ImageAsset(name: "Scene/Compose/media")
+      public static let poll = ImageAsset(name: "Scene/Compose/poll")
+    }
     public enum Discovery {
       public static let profileCardBackground = ColorAsset(name: "Scene/Discovery/profile.card.background")
     }
diff --git a/MastodonSDK/Sources/MastodonSDK/Entity/Mastodon+Entity+Status.swift b/MastodonSDK/Sources/MastodonSDK/Entity/Mastodon+Entity+Status.swift
index 7f8a4fd4ee..29ffcbeb9f 100644
--- a/MastodonSDK/Sources/MastodonSDK/Entity/Mastodon+Entity+Status.swift
+++ b/MastodonSDK/Sources/MastodonSDK/Entity/Mastodon+Entity+Status.swift
@@ -102,7 +102,7 @@ extension Mastodon.Entity {
 }
 
 extension Mastodon.Entity.Status {
-    public enum Visibility: RawRepresentable, Codable {
+    public enum Visibility: RawRepresentable, Codable, Hashable {
         case `public`
         case unlisted
         case `private`
diff --git a/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/ComposeContentViewController.swift b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/ComposeContentViewController.swift
index 4c0a71f60d..51dfb3ace5 100644
--- a/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/ComposeContentViewController.swift
+++ b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/ComposeContentViewController.swift
@@ -9,6 +9,7 @@ import os.log
 import UIKit
 import SwiftUI
 import Combine
+import MastodonCore
 
 public final class ComposeContentViewController: UIViewController {
     
@@ -16,6 +17,7 @@ public final class ComposeContentViewController: UIViewController {
     
     var disposeBag = Set<AnyCancellable>()
     public var viewModel: ComposeContentViewModel!
+    let composeContentToolbarViewModel = ComposeContentToolbarView.ViewModel()
     
     let tableView: ComposeTableView = {
         let tableView = ComposeTableView()
@@ -25,6 +27,10 @@ public final class ComposeContentViewController: UIViewController {
         tableView.tableFooterView = UIView()
         return tableView
     }()
+    
+    lazy var composeContentToolbarView = ComposeContentToolbarView(viewModel: composeContentToolbarViewModel)
+    var composeContentToolbarViewBottomLayoutConstraint: NSLayoutConstraint!
+    let composeContentToolbarBackgroundView = UIView()
 
     deinit {
         os_log(.info, log: .debug, "%{public}s[%{public}ld], %{public}s", ((#file as NSString).lastPathComponent), #line, #function)
@@ -36,6 +42,17 @@ extension ComposeContentViewController {
     public override func viewDidLoad() {
         super.viewDidLoad()
         
+        // setup view
+        self.setupBackgroundColor(theme: ThemeService.shared.currentTheme.value)
+        ThemeService.shared.currentTheme
+            .receive(on: RunLoop.main)
+            .sink { [weak self] theme in
+                guard let self = self else { return }
+                self.setupBackgroundColor(theme: theme)
+            }
+            .store(in: &disposeBag)
+        
+        // setup tableView
         tableView.translatesAutoresizingMaskIntoConstraints = false
         view.addSubview(tableView)
         NSLayoutConstraint.activate([
@@ -48,6 +65,110 @@ extension ComposeContentViewController {
         tableView.delegate = self
         viewModel.setupDataSource(tableView: tableView)
         
+        let toolbarHostingView = UIHostingController(rootView: composeContentToolbarView)
+        toolbarHostingView.view.translatesAutoresizingMaskIntoConstraints = false
+        view.addSubview(toolbarHostingView.view)
+        composeContentToolbarViewBottomLayoutConstraint = view.bottomAnchor.constraint(equalTo: toolbarHostingView.view.bottomAnchor)
+        NSLayoutConstraint.activate([
+            toolbarHostingView.view.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            toolbarHostingView.view.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            composeContentToolbarViewBottomLayoutConstraint,
+            toolbarHostingView.view.heightAnchor.constraint(equalToConstant: ComposeContentToolbarView.toolbarHeight),
+        ])
+        toolbarHostingView.view.preservesSuperviewLayoutMargins = true
+        //composeToolbarView.delegate = self
+        
+        composeContentToolbarBackgroundView.translatesAutoresizingMaskIntoConstraints = false
+        view.insertSubview(composeContentToolbarBackgroundView, belowSubview: toolbarHostingView.view)
+        NSLayoutConstraint.activate([
+            composeContentToolbarBackgroundView.topAnchor.constraint(equalTo: toolbarHostingView.view.topAnchor),
+            composeContentToolbarBackgroundView.leadingAnchor.constraint(equalTo: toolbarHostingView.view.leadingAnchor),
+            composeContentToolbarBackgroundView.trailingAnchor.constraint(equalTo: toolbarHostingView.view.trailingAnchor),
+            view.bottomAnchor.constraint(equalTo: composeContentToolbarBackgroundView.bottomAnchor),
+        ])
+        
+        let keyboardHasShortcutBar = CurrentValueSubject<Bool, Never>(traitCollection.userInterfaceIdiom == .pad)       // update default value later
+        let keyboardEventPublishers = Publishers.CombineLatest3(
+            KeyboardResponderService.shared.isShow,
+            KeyboardResponderService.shared.state,
+            KeyboardResponderService.shared.endFrame
+        )
+//        Publishers.CombineLatest3(
+//            viewModel.$isCustomEmojiComposing,
+//        )
+        keyboardEventPublishers
+        .sink(receiveValue: { [weak self] keyboardEvents in
+            guard let self = self else { return }
+            
+            let (isShow, state, endFrame) = keyboardEvents
+            
+//            switch self.traitCollection.userInterfaceIdiom {
+//            case .pad:
+//                keyboardHasShortcutBar.value = state != .floating
+//            default:
+//                keyboardHasShortcutBar.value = false
+//            }
+//
+            let extraMargin: CGFloat = {
+                var margin = ComposeContentToolbarView.toolbarHeight
+//                if autoCompleteInfo != nil {
+////                    margin += ComposeViewController.minAutoCompleteVisibleHeight
+//                }
+                return margin
+            }()
+//
+            guard isShow, state == .dock else {
+                self.tableView.contentInset.bottom = extraMargin
+                self.tableView.verticalScrollIndicatorInsets.bottom = extraMargin
+
+//                if let superView = self.autoCompleteViewController.tableView.superview {
+//                    let autoCompleteTableViewBottomInset: CGFloat = {
+//                        let tableViewFrameInWindow = superView.convert(self.autoCompleteViewController.tableView.frame, to: nil)
+//                        let padding = tableViewFrameInWindow.maxY + self.composeToolbarView.frame.height + AutoCompleteViewController.chevronViewHeight - self.view.frame.maxY
+//                        return max(0, padding)
+//                    }()
+//                    self.autoCompleteViewController.tableView.contentInset.bottom = autoCompleteTableViewBottomInset
+//                    self.autoCompleteViewController.tableView.verticalScrollIndicatorInsets.bottom = autoCompleteTableViewBottomInset
+//                }
+
+                UIView.animate(withDuration: 0.3) {
+                    self.composeContentToolbarViewBottomLayoutConstraint.constant = self.view.safeAreaInsets.bottom
+                    if self.view.window != nil {
+                        self.view.layoutIfNeeded()
+                    }
+                }
+                return
+            }
+            // isShow AND dock state
+//            self.systemKeyboardHeight = endFrame.height
+
+            // adjust inset for auto-complete
+//            let autoCompleteTableViewBottomInset: CGFloat = {
+//                guard let superview = self.autoCompleteViewController.tableView.superview else { return .zero }
+//                let tableViewFrameInWindow = superview.convert(self.autoCompleteViewController.tableView.frame, to: nil)
+//                let padding = tableViewFrameInWindow.maxY + self.composeToolbarView.frame.height + AutoCompleteViewController.chevronViewHeight - endFrame.minY
+//                return max(0, padding)
+//            }()
+//            self.autoCompleteViewController.tableView.contentInset.bottom = autoCompleteTableViewBottomInset
+//            self.autoCompleteViewController.tableView.verticalScrollIndicatorInsets.bottom = autoCompleteTableViewBottomInset
+
+            // adjust inset for tableView
+            let contentFrame = self.view.convert(self.tableView.frame, to: nil)
+            let padding = contentFrame.maxY + extraMargin - endFrame.minY
+            guard padding > 0 else {
+                self.tableView.contentInset.bottom = self.view.safeAreaInsets.bottom + extraMargin
+                self.tableView.verticalScrollIndicatorInsets.bottom = self.view.safeAreaInsets.bottom + extraMargin
+                return
+            }
+
+            self.tableView.contentInset.bottom = padding - self.view.safeAreaInsets.bottom
+            self.tableView.verticalScrollIndicatorInsets.bottom = padding - self.view.safeAreaInsets.bottom
+            UIView.animate(withDuration: 0.3) {
+                self.composeContentToolbarViewBottomLayoutConstraint.constant = endFrame.height
+                self.view.layoutIfNeeded()
+            }
+        })
+        .store(in: &disposeBag)
         
         // setup snap behavior
         Publishers.CombineLatest(
@@ -90,6 +211,20 @@ extension ComposeContentViewController {
     }
 }
 
+extension ComposeContentViewController {
+    private func setupBackgroundColor(theme: Theme) {
+        let backgroundColor = UIColor(dynamicProvider: { traitCollection in
+            switch traitCollection.userInterfaceStyle {
+            case .light: return .systemBackground
+            default:     return theme.systemElevatedBackgroundColor
+            }
+        })
+        view.backgroundColor = backgroundColor
+        tableView.backgroundColor = backgroundColor
+        composeContentToolbarBackgroundView.backgroundColor = theme.composeToolbarBackgroundColor
+    }
+}
+
 // MARK: - UIScrollViewDelegate
 extension ComposeContentViewController {
     public func scrollViewWillEndDragging(_ scrollView: UIScrollView, withVelocity velocity: CGPoint, targetContentOffset: UnsafeMutablePointer<CGPoint>) {
diff --git a/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView+ViewModel.swift b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView+ViewModel.swift
new file mode 100644
index 0000000000..ed412fbea2
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView+ViewModel.swift
@@ -0,0 +1,57 @@
+//
+//  ComposeContentToolbarView.swift
+//  
+//
+//  Created by MainasuK on 22/10/18.
+//
+
+import SwiftUI
+import MastodonCore
+import MastodonAsset
+import MastodonSDK
+
+extension ComposeContentToolbarView {
+    class ViewModel: ObservableObject {
+        
+        // input
+        @Published var backgroundColor = ThemeService.shared.currentTheme.value.composeToolbarBackgroundColor
+        @Published var visibility: Mastodon.Entity.Status.Visibility = .public
+        var allVisibilities: [Mastodon.Entity.Status.Visibility] {
+            return [.public, .private, .direct]
+        }
+        
+        // output
+        
+        init() {
+            ThemeService.shared.currentTheme
+                .map { $0.composeToolbarBackgroundColor }
+                .assign(to: &$backgroundColor)
+        }
+        
+    }
+}
+
+extension ComposeContentToolbarView.ViewModel {
+    enum Action: CaseIterable {
+        case attachment
+        case poll
+        case emoji
+        case contentWarning
+        case visibility
+        
+        var image: UIImage {
+            switch self {
+            case .attachment:
+                return Asset.Scene.Compose.media.image
+            case .poll:
+                return Asset.Scene.Compose.poll.image
+            case .emoji:
+                return Asset.Scene.Compose.emoji.image
+            case .contentWarning:
+                return Asset.Scene.Compose.chatWarning.image
+            case .visibility:
+                return Asset.Scene.Compose.earth.image
+            }
+        }
+    }
+}
diff --git a/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView.swift b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView.swift
new file mode 100644
index 0000000000..775a6f4f09
--- /dev/null
+++ b/MastodonSDK/Sources/MastodonUI/Scene/ComposeContent/View/ComposeContentToolbarView.swift
@@ -0,0 +1,82 @@
+//
+//  ComposeContentToolbarView.swift
+//  
+//
+//  Created by MainasuK on 22/10/18.
+//
+
+import SwiftUI
+import MastodonAsset
+
+struct ComposeContentToolbarView: View {
+    
+    static var toolbarHeight: CGFloat { 48 }
+    
+    @ObservedObject var viewModel: ViewModel
+    
+    var body: some View {
+        HStack(spacing: .zero) {
+            ForEach(ComposeContentToolbarView.ViewModel.Action.allCases, id: \.self) { action in
+                switch action {
+                case .attachment:
+                    Menu {
+                        Button {
+                            
+                        } label: {
+                            Label("Photo Library", systemImage: "photo.on.rectangle")
+                        }
+                        Button {
+                            
+                        } label: {
+                            Label("Camera", systemImage: "camera")
+                        }
+                        Button {
+                            
+                        } label: {
+                            Label("Browse", systemImage: "ellipsis")
+                        }
+                    } label: {
+                        label(for: action)
+                    }
+                    .frame(width: 48, height: 48)
+                case .visibility:
+                    Menu {
+                        Picker(selection: $viewModel.visibility) {
+                            ForEach(viewModel.allVisibilities, id: \.self) { visibility in
+                                Label(visibility.rawValue, systemImage: "photo.on.rectangle")
+                            }
+                        } label: {
+                            Text("Select Visibility")
+                        }
+                    } label: {
+                        label(for: action)
+                    }
+                    .frame(width: 48, height: 48)
+                default:
+                    Button {
+                        
+                    } label: {
+                        label(for: action)
+                    }
+                    .frame(width: 48, height: 48)
+                }
+            }
+            Spacer()
+            Text("Hello")
+        }
+        .padding(.leading, 4)       // 4 + 12 = 16
+        .padding(.trailing, 16)
+        .frame(height: ComposeContentToolbarView.toolbarHeight)
+        .background(Color(viewModel.backgroundColor))
+    }
+    
+}
+
+
+extension ComposeContentToolbarView {
+    func label(for action: ComposeContentToolbarView.ViewModel.Action) -> some View {
+        Image(uiImage: action.image.withRenderingMode(.alwaysTemplate))
+            .foregroundColor(Color(Asset.Scene.Compose.buttonTint.color))
+            .frame(width: 24, height: 24, alignment: .center)
+    }
+}
