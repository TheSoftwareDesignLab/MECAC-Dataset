diff --git a/lib/constants.dart b/lib/constants.dart
index e0df5ce43b6..6e96e893541 100644
--- a/lib/constants.dart
+++ b/lib/constants.dart
@@ -48,7 +48,6 @@ const String kSharedPrefToken = 'checksum';
 
 // TODO remove these
 const String kSharedPrefAddDocumentsToInvoice = 'add_documents_to_invoice';
-const String kSharedPrefEmailPayment = 'email_payment';
 const String kSharedPrefAutoStartTasks = 'auto_start_tasks';
 
 const String kProductPlanPro = 'v1_pro_yearly';
diff --git a/lib/data/models/client_model.dart b/lib/data/models/client_model.dart
index eafec44cc4b..0ed9b158d85 100644
--- a/lib/data/models/client_model.dart
+++ b/lib/data/models/client_model.dart
@@ -285,6 +285,17 @@ abstract class ClientEntity extends Object
     }
   }
 
+  bool getManualPaymentEmail(
+      {@required CompanyEntity company, @required GroupEntity group}) {
+    if (settings.clientManualPaymentNotification != null) {
+      return settings.clientManualPaymentNotification;
+    } else if (group?.settings?.clientManualPaymentNotification != null) {
+      return group.settings.clientManualPaymentNotification;
+    } else {
+      return company.settings.clientManualPaymentNotification;
+    }
+  }
+
   Iterable<ActivityEntity> getActivities({String invoiceId, String typeId}) {
     return activities.where((activity) {
       if (invoiceId != null && activity.invoiceId != invoiceId) {
diff --git a/lib/data/models/payment_model.dart b/lib/data/models/payment_model.dart
index d7abd7c0463..d9934b49eab 100644
--- a/lib/data/models/payment_model.dart
+++ b/lib/data/models/payment_model.dart
@@ -102,6 +102,7 @@ abstract class PaymentEntity extends Object
       vendorId: '',
       projectId: '',
       number: '',
+      sendEmail: state?.company?.settings?.clientManualPaymentNotification,
     );
   }
 
@@ -175,6 +176,9 @@ abstract class PaymentEntity extends Object
   @nullable
   bool get isForInvoice;
 
+  @nullable
+  bool get sendEmail;
+
   BuiltList<PaymentableEntity> get paymentables;
 
   BuiltList<PaymentableEntity> get invoices;
diff --git a/lib/data/models/payment_model.g.dart b/lib/data/models/payment_model.g.dart
index 2f875e4c2c5..47e46142af0 100644
--- a/lib/data/models/payment_model.g.dart
+++ b/lib/data/models/payment_model.g.dart
@@ -212,6 +212,12 @@ class _$PaymentEntitySerializer implements StructuredSerializer<PaymentEntity> {
         ..add(serializers.serialize(object.isForInvoice,
             specifiedType: const FullType(bool)));
     }
+    if (object.sendEmail != null) {
+      result
+        ..add('sendEmail')
+        ..add(serializers.serialize(object.sendEmail,
+            specifiedType: const FullType(bool)));
+    }
     if (object.isChanged != null) {
       result
         ..add('isChanged')
@@ -331,6 +337,10 @@ class _$PaymentEntitySerializer implements StructuredSerializer<PaymentEntity> {
           result.isForInvoice = serializers.deserialize(value,
               specifiedType: const FullType(bool)) as bool;
           break;
+        case 'sendEmail':
+          result.sendEmail = serializers.deserialize(value,
+              specifiedType: const FullType(bool)) as bool;
+          break;
         case 'paymentables':
           result.paymentables.replace(serializers.deserialize(value,
                   specifiedType: const FullType(
@@ -708,6 +718,8 @@ class _$PaymentEntity extends PaymentEntity {
   @override
   final bool isForInvoice;
   @override
+  final bool sendEmail;
+  @override
   final BuiltList<PaymentableEntity> paymentables;
   @override
   final BuiltList<PaymentableEntity> invoices;
@@ -754,6 +766,7 @@ class _$PaymentEntity extends PaymentEntity {
       this.projectId,
       this.vendorId,
       this.isForInvoice,
+      this.sendEmail,
       this.paymentables,
       this.invoices,
       this.credits,
@@ -872,6 +885,7 @@ class _$PaymentEntity extends PaymentEntity {
         projectId == other.projectId &&
         vendorId == other.vendorId &&
         isForInvoice == other.isForInvoice &&
+        sendEmail == other.sendEmail &&
         paymentables == other.paymentables &&
         invoices == other.invoices &&
         credits == other.credits &&
@@ -906,15 +920,15 @@ class _$PaymentEntity extends PaymentEntity {
                                                                 $jc(
                                                                     $jc(
                                                                         $jc(
-                                                                            $jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc(0, amount.hashCode), applied.hashCode), refunded.hashCode), number.hashCode), clientId.hashCode), statusId.hashCode), transactionReference.hashCode), date.hashCode), typeId.hashCode), privateNotes.hashCode), customValue1.hashCode), customValue2.hashCode),
-                                                                                customValue3.hashCode),
-                                                                            customValue4.hashCode),
-                                                                        exchangeRate.hashCode),
-                                                                    exchangeCurrencyId.hashCode),
-                                                                isManual.hashCode),
-                                                            projectId.hashCode),
-                                                        vendorId.hashCode),
-                                                    isForInvoice.hashCode),
+                                                                            $jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc($jc(0, amount.hashCode), applied.hashCode), refunded.hashCode), number.hashCode), clientId.hashCode), statusId.hashCode), transactionReference.hashCode), date.hashCode), typeId.hashCode), privateNotes.hashCode), customValue1.hashCode), customValue2.hashCode), customValue3.hashCode),
+                                                                                customValue4.hashCode),
+                                                                            exchangeRate.hashCode),
+                                                                        exchangeCurrencyId.hashCode),
+                                                                    isManual.hashCode),
+                                                                projectId.hashCode),
+                                                            vendorId.hashCode),
+                                                        isForInvoice.hashCode),
+                                                    sendEmail.hashCode),
                                                 paymentables.hashCode),
                                             invoices.hashCode),
                                         credits.hashCode),
@@ -951,6 +965,7 @@ class _$PaymentEntity extends PaymentEntity {
           ..add('projectId', projectId)
           ..add('vendorId', vendorId)
           ..add('isForInvoice', isForInvoice)
+          ..add('sendEmail', sendEmail)
           ..add('paymentables', paymentables)
           ..add('invoices', invoices)
           ..add('credits', credits)
@@ -1052,6 +1067,10 @@ class PaymentEntityBuilder
   bool get isForInvoice => _$this._isForInvoice;
   set isForInvoice(bool isForInvoice) => _$this._isForInvoice = isForInvoice;
 
+  bool _sendEmail;
+  bool get sendEmail => _$this._sendEmail;
+  set sendEmail(bool sendEmail) => _$this._sendEmail = sendEmail;
+
   ListBuilder<PaymentableEntity> _paymentables;
   ListBuilder<PaymentableEntity> get paymentables =>
       _$this._paymentables ??= new ListBuilder<PaymentableEntity>();
@@ -1128,6 +1147,7 @@ class PaymentEntityBuilder
       _projectId = _$v.projectId;
       _vendorId = _$v.vendorId;
       _isForInvoice = _$v.isForInvoice;
+      _sendEmail = _$v.sendEmail;
       _paymentables = _$v.paymentables?.toBuilder();
       _invoices = _$v.invoices?.toBuilder();
       _credits = _$v.credits?.toBuilder();
@@ -1183,6 +1203,7 @@ class PaymentEntityBuilder
               projectId: projectId,
               vendorId: vendorId,
               isForInvoice: isForInvoice,
+              sendEmail: sendEmail,
               paymentables: paymentables.build(),
               invoices: invoices.build(),
               credits: credits.build(),
diff --git a/lib/redux/app/app_actions.dart b/lib/redux/app/app_actions.dart
index b217bc706bb..57bad9c1c59 100644
--- a/lib/redux/app/app_actions.dart
+++ b/lib/redux/app/app_actions.dart
@@ -96,7 +96,6 @@ class UserPreferencesChanged implements PersistPrefs {
     this.layout,
     this.sidebar,
     this.enableDarkMode,
-    this.emailPayment,
     this.requireAuthentication,
     this.autoStartTasks,
     this.longPressSelectionIsDefault,
@@ -115,7 +114,6 @@ class UserPreferencesChanged implements PersistPrefs {
   final AppSidebarMode historyMode;
   final bool enableDarkMode;
   final bool longPressSelectionIsDefault;
-  final bool emailPayment;
   final bool requireAuthentication;
   final bool autoStartTasks;
   final bool isPreviewVisible;
diff --git a/lib/redux/payment/payment_actions.dart b/lib/redux/payment/payment_actions.dart
index 0e6ecb06fc4..214a4f1195c 100644
--- a/lib/redux/payment/payment_actions.dart
+++ b/lib/redux/payment/payment_actions.dart
@@ -134,7 +134,10 @@ class LoadPaymentsSuccess implements StopLoading {
 }
 
 class SavePaymentRequest implements StartSaving {
-  SavePaymentRequest({this.completer, this.payment});
+  SavePaymentRequest({
+    @required this.completer,
+    @required this.payment,
+  });
 
   final Completer completer;
   final PaymentEntity payment;
@@ -159,7 +162,10 @@ class SavePaymentFailure implements StopSaving {
 }
 
 class RefundPaymentRequest implements StartSaving {
-  RefundPaymentRequest({this.completer, this.payment});
+  RefundPaymentRequest({
+    @required this.completer,
+    @required this.payment,
+  });
 
   final Completer completer;
   final PaymentEntity payment;
@@ -314,6 +320,7 @@ void handlePaymentAction(
   }
 
   final store = StoreProvider.of<AppState>(context);
+  final company = store.state.company;
   final localization = AppLocalization.of(context);
   final paymentIds = payments.map((payment) => payment.id).toList();
   var payment = payments.first as PaymentEntity;
@@ -329,7 +336,8 @@ void handlePaymentAction(
       }
       store.dispatch(ViewRefundPayment(
         navigator: Navigator.of(context),
-        payment: payment,
+        payment: payment.rebuild((b) =>
+            b..sendEmail = company.settings.clientManualPaymentNotification),
       ));
       break;
     case EntityAction.emailPayment:
diff --git a/lib/redux/payment/payment_middleware.dart b/lib/redux/payment/payment_middleware.dart
index 327f50a6739..38bc817ddc0 100644
--- a/lib/redux/payment/payment_middleware.dart
+++ b/lib/redux/payment/payment_middleware.dart
@@ -50,8 +50,6 @@ Middleware<AppState> _editPayment() {
   return (Store<AppState> store, dynamic dynamicAction, NextDispatcher next) {
     final action = dynamicAction as EditPayment;
 
-
-
     next(action);
 
     store.dispatch(UpdateCurrentRoute(PaymentEditScreen.route));
@@ -66,8 +64,6 @@ Middleware<AppState> _viewRefundPayment() {
   return (Store<AppState> store, dynamic dynamicAction, NextDispatcher next) {
     final action = dynamicAction as ViewRefundPayment;
 
-
-
     next(action);
 
     if (isMobile(action.context)) {
@@ -87,8 +83,6 @@ Middleware<AppState> _viewRefundPayment() {
 
 Middleware<AppState> _viewPayment() {
   return (Store<AppState> store, dynamic action, NextDispatcher next) async {
-
-
     next(action);
 
     store.dispatch(UpdateCurrentRoute(PaymentViewScreen.route));
@@ -103,8 +97,6 @@ Middleware<AppState> _viewPaymentList() {
   return (Store<AppState> store, dynamic dynamicAction, NextDispatcher next) {
     final action = dynamicAction as ViewPaymentList;
 
-
-
     next(action);
 
     if (store.state.isStale) {
@@ -204,8 +196,7 @@ Middleware<AppState> _savePayment(PaymentRepository repository) {
   return (Store<AppState> store, dynamic dynamicAction, NextDispatcher next) {
     final action = dynamicAction as SavePaymentRequest;
     final PaymentEntity payment = action.payment;
-    final bool sendEmail =
-        payment.isNew ? store.state.prefState.emailPayment : false;
+    final bool sendEmail = payment.isNew ? payment.sendEmail : false;
     repository
         .saveData(store.state.credentials, action.payment, sendEmail: sendEmail)
         .then((PaymentEntity payment) {
@@ -229,11 +220,10 @@ Middleware<AppState> _savePayment(PaymentRepository repository) {
 Middleware<AppState> _refundPayment(PaymentRepository repository) {
   return (Store<AppState> store, dynamic dynamicAction, NextDispatcher next) {
     final action = dynamicAction as RefundPaymentRequest;
-    final bool sendEmail = store.state.prefState.emailPayment;
 
     repository
         .refundPayment(store.state.credentials, action.payment,
-            sendEmail: sendEmail)
+            sendEmail: action.payment.sendEmail)
         .then((PaymentEntity payment) {
       store.dispatch(SavePaymentSuccess(payment));
       store.dispatch(RefundPaymentSuccess(payment));
diff --git a/lib/redux/ui/pref_reducer.dart b/lib/redux/ui/pref_reducer.dart
index 917d21227ae..8996b8e1762 100644
--- a/lib/redux/ui/pref_reducer.dart
+++ b/lib/redux/ui/pref_reducer.dart
@@ -57,7 +57,6 @@ PrefState prefReducer(
     ..autoStartTasks = autoStartTasksReducer(state.autoStartTasks, action)
     ..requireAuthentication =
         requireAuthenticationReducer(state.requireAuthentication, action)
-    ..emailPayment = emailPaymentReducer(state.emailPayment, action)
     ..addDocumentsToInvoice =
         addDocumentsToInvoiceReducer(state.addDocumentsToInvoice, action));
 }
@@ -132,12 +131,6 @@ Reducer<AppSidebarMode> historySidebarReducer = combineReducers([
   }),
 ]);
 
-Reducer<bool> emailPaymentReducer = combineReducers([
-  TypedReducer<bool, UserPreferencesChanged>((emailPayment, action) {
-    return action.emailPayment ?? emailPayment;
-  }),
-]);
-
 Reducer<bool> darkModeReducer = combineReducers([
   TypedReducer<bool, UserPreferencesChanged>((enableDarkMode, action) {
     return action.enableDarkMode ?? enableDarkMode;
diff --git a/lib/redux/ui/pref_state.dart b/lib/redux/ui/pref_state.dart
index 7afa9321d7f..a1fd68e504f 100644
--- a/lib/redux/ui/pref_state.dart
+++ b/lib/redux/ui/pref_state.dart
@@ -19,7 +19,6 @@ abstract class PrefState implements Built<PrefState, PrefStateBuilder> {
       isHistoryVisible: false,
       enableDarkMode: false,
       requireAuthentication: false,
-      emailPayment: false,
       autoStartTasks: false,
       showFilterSidebar: false,
       longPressSelectionIsDefault: false,
@@ -60,8 +59,6 @@ abstract class PrefState implements Built<PrefState, PrefStateBuilder> {
 
   bool get requireAuthentication;
 
-  bool get emailPayment;
-
   bool get autoStartTasks;
 
   bool get addDocumentsToInvoice;
diff --git a/lib/redux/ui/pref_state.g.dart b/lib/redux/ui/pref_state.g.dart
index 584123808cb..fbfa05dc6e3 100644
--- a/lib/redux/ui/pref_state.g.dart
+++ b/lib/redux/ui/pref_state.g.dart
@@ -144,9 +144,6 @@ class _$PrefStateSerializer implements StructuredSerializer<PrefState> {
       'requireAuthentication',
       serializers.serialize(object.requireAuthentication,
           specifiedType: const FullType(bool)),
-      'emailPayment',
-      serializers.serialize(object.emailPayment,
-          specifiedType: const FullType(bool)),
       'autoStartTasks',
       serializers.serialize(object.autoStartTasks,
           specifiedType: const FullType(bool)),
@@ -217,10 +214,6 @@ class _$PrefStateSerializer implements StructuredSerializer<PrefState> {
           result.requireAuthentication = serializers.deserialize(value,
               specifiedType: const FullType(bool)) as bool;
           break;
-        case 'emailPayment':
-          result.emailPayment = serializers.deserialize(value,
-              specifiedType: const FullType(bool)) as bool;
-          break;
         case 'autoStartTasks':
           result.autoStartTasks = serializers.deserialize(value,
               specifiedType: const FullType(bool)) as bool;
@@ -437,8 +430,6 @@ class _$PrefState extends PrefState {
   @override
   final bool requireAuthentication;
   @override
-  final bool emailPayment;
-  @override
   final bool autoStartTasks;
   @override
   final bool addDocumentsToInvoice;
@@ -460,7 +451,6 @@ class _$PrefState extends PrefState {
       this.showFilterSidebar,
       this.longPressSelectionIsDefault,
       this.requireAuthentication,
-      this.emailPayment,
       this.autoStartTasks,
       this.addDocumentsToInvoice,
       this.companyPrefs})
@@ -499,9 +489,6 @@ class _$PrefState extends PrefState {
     if (requireAuthentication == null) {
       throw new BuiltValueNullFieldError('PrefState', 'requireAuthentication');
     }
-    if (emailPayment == null) {
-      throw new BuiltValueNullFieldError('PrefState', 'emailPayment');
-    }
     if (autoStartTasks == null) {
       throw new BuiltValueNullFieldError('PrefState', 'autoStartTasks');
     }
@@ -535,7 +522,6 @@ class _$PrefState extends PrefState {
         showFilterSidebar == other.showFilterSidebar &&
         longPressSelectionIsDefault == other.longPressSelectionIsDefault &&
         requireAuthentication == other.requireAuthentication &&
-        emailPayment == other.emailPayment &&
         autoStartTasks == other.autoStartTasks &&
         addDocumentsToInvoice == other.addDocumentsToInvoice &&
         companyPrefs == other.companyPrefs;
@@ -557,25 +543,18 @@ class _$PrefState extends PrefState {
                                             $jc(
                                                 $jc(
                                                     $jc(
-                                                        $jc(
-                                                            $jc(
-                                                                0,
-                                                                appLayout
-                                                                    .hashCode),
-                                                            moduleLayout
-                                                                .hashCode),
-                                                        menuSidebarMode
-                                                            .hashCode),
-                                                    historySidebarMode
-                                                        .hashCode),
-                                                isPreviewVisible.hashCode),
-                                            isMenuVisible.hashCode),
-                                        isHistoryVisible.hashCode),
-                                    enableDarkMode.hashCode),
-                                showFilterSidebar.hashCode),
-                            longPressSelectionIsDefault.hashCode),
-                        requireAuthentication.hashCode),
-                    emailPayment.hashCode),
+                                                        $jc(0,
+                                                            appLayout.hashCode),
+                                                        moduleLayout.hashCode),
+                                                    menuSidebarMode.hashCode),
+                                                historySidebarMode.hashCode),
+                                            isPreviewVisible.hashCode),
+                                        isMenuVisible.hashCode),
+                                    isHistoryVisible.hashCode),
+                                enableDarkMode.hashCode),
+                            showFilterSidebar.hashCode),
+                        longPressSelectionIsDefault.hashCode),
+                    requireAuthentication.hashCode),
                 autoStartTasks.hashCode),
             addDocumentsToInvoice.hashCode),
         companyPrefs.hashCode));
@@ -595,7 +574,6 @@ class _$PrefState extends PrefState {
           ..add('showFilterSidebar', showFilterSidebar)
           ..add('longPressSelectionIsDefault', longPressSelectionIsDefault)
           ..add('requireAuthentication', requireAuthentication)
-          ..add('emailPayment', emailPayment)
           ..add('autoStartTasks', autoStartTasks)
           ..add('addDocumentsToInvoice', addDocumentsToInvoice)
           ..add('companyPrefs', companyPrefs))
@@ -660,10 +638,6 @@ class PrefStateBuilder implements Builder<PrefState, PrefStateBuilder> {
   set requireAuthentication(bool requireAuthentication) =>
       _$this._requireAuthentication = requireAuthentication;
 
-  bool _emailPayment;
-  bool get emailPayment => _$this._emailPayment;
-  set emailPayment(bool emailPayment) => _$this._emailPayment = emailPayment;
-
   bool _autoStartTasks;
   bool get autoStartTasks => _$this._autoStartTasks;
   set autoStartTasks(bool autoStartTasks) =>
@@ -695,7 +669,6 @@ class PrefStateBuilder implements Builder<PrefState, PrefStateBuilder> {
       _showFilterSidebar = _$v.showFilterSidebar;
       _longPressSelectionIsDefault = _$v.longPressSelectionIsDefault;
       _requireAuthentication = _$v.requireAuthentication;
-      _emailPayment = _$v.emailPayment;
       _autoStartTasks = _$v.autoStartTasks;
       _addDocumentsToInvoice = _$v.addDocumentsToInvoice;
       _companyPrefs = _$v.companyPrefs?.toBuilder();
@@ -734,7 +707,6 @@ class PrefStateBuilder implements Builder<PrefState, PrefStateBuilder> {
               showFilterSidebar: showFilterSidebar,
               longPressSelectionIsDefault: longPressSelectionIsDefault,
               requireAuthentication: requireAuthentication,
-              emailPayment: emailPayment,
               autoStartTasks: autoStartTasks,
               addDocumentsToInvoice: addDocumentsToInvoice,
               companyPrefs: companyPrefs.build());
diff --git a/lib/ui/expense/edit/expense_edit_vm.dart b/lib/ui/expense/edit/expense_edit_vm.dart
index 9f6bcd6ecdb..420b7aaefe1 100644
--- a/lib/ui/expense/edit/expense_edit_vm.dart
+++ b/lib/ui/expense/edit/expense_edit_vm.dart
@@ -2,7 +2,6 @@ import 'dart:async';
 import 'package:flutter/foundation.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter_redux/flutter_redux.dart';
-import 'package:invoiceninja_flutter/constants.dart';
 import 'package:invoiceninja_flutter/redux/app/app_actions.dart';
 import 'package:invoiceninja_flutter/redux/ui/ui_actions.dart';
 import 'package:invoiceninja_flutter/utils/platforms.dart';
@@ -14,7 +13,6 @@ import 'package:invoiceninja_flutter/redux/expense/expense_actions.dart';
 import 'package:invoiceninja_flutter/data/models/expense_model.dart';
 import 'package:invoiceninja_flutter/ui/expense/edit/expense_edit.dart';
 import 'package:invoiceninja_flutter/redux/app/app_state.dart';
-import 'package:shared_preferences/shared_preferences.dart';
 
 class ExpenseEditScreen extends StatelessWidget {
   const ExpenseEditScreen({Key key}) : super(key: key);
@@ -131,8 +129,6 @@ class ExpenseEditVM {
         if (expense.isOld) {
           return;
         }
-        final SharedPreferences prefs = await SharedPreferences.getInstance();
-        prefs.setBool(kSharedPrefEmailPayment, value);
         store.dispatch(UserPreferencesChanged(addDocumentsToInvoice: value));
       },
     );
diff --git a/lib/ui/payment/edit/payment_edit.dart b/lib/ui/payment/edit/payment_edit.dart
index da55323f04e..834a80211b1 100644
--- a/lib/ui/payment/edit/payment_edit.dart
+++ b/lib/ui/payment/edit/payment_edit.dart
@@ -259,9 +259,11 @@ class _PaymentEditState extends State<PaymentEdit> {
                     SwitchListTile(
                       activeColor: Theme.of(context).accentColor,
                       title: Text(localization.sendEmail),
-                      value: viewModel.prefState.emailPayment,
+                      value: payment.sendEmail,
                       subtitle: Text(localization.emailReceipt),
-                      onChanged: (value) => viewModel.onEmailChanged(value),
+                      onChanged: (value) => viewModel.onChanged(payment.rebuild((b) => b
+                          ..sendEmail = value
+                      )),
                     ),
                   ])
                 : Container(),
diff --git a/lib/ui/payment/edit/payment_edit_vm.dart b/lib/ui/payment/edit/payment_edit_vm.dart
index b3bab85dbe8..f36f7399012 100644
--- a/lib/ui/payment/edit/payment_edit_vm.dart
+++ b/lib/ui/payment/edit/payment_edit_vm.dart
@@ -2,7 +2,6 @@ import 'dart:async';
 import 'package:flutter/foundation.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter_redux/flutter_redux.dart';
-import 'package:invoiceninja_flutter/constants.dart';
 import 'package:invoiceninja_flutter/redux/app/app_actions.dart';
 import 'package:invoiceninja_flutter/redux/static/static_state.dart';
 import 'package:invoiceninja_flutter/redux/ui/pref_state.dart';
@@ -15,7 +14,6 @@ import 'package:invoiceninja_flutter/redux/payment/payment_actions.dart';
 import 'package:invoiceninja_flutter/data/models/payment_model.dart';
 import 'package:invoiceninja_flutter/ui/payment/edit/payment_edit.dart';
 import 'package:invoiceninja_flutter/redux/app/app_state.dart';
-import 'package:shared_preferences/shared_preferences.dart';
 
 class PaymentEditScreen extends StatelessWidget {
   const PaymentEditScreen({Key key}) : super(key: key);
@@ -45,7 +43,6 @@ class PaymentEditVM {
     @required this.origPayment,
     @required this.onChanged,
     @required this.onSavePressed,
-    @required this.onEmailChanged,
     @required this.prefState,
     @required this.staticState,
     @required this.onCancelPressed,
@@ -68,14 +65,6 @@ class PaymentEditVM {
       onChanged: (PaymentEntity payment) {
         store.dispatch(UpdatePayment(payment));
       },
-      onEmailChanged: (value) async {
-        if (payment.isOld) {
-          return;
-        }
-        final SharedPreferences prefs = await SharedPreferences.getInstance();
-        prefs.setBool(kSharedPrefEmailPayment, value);
-        store.dispatch(UserPreferencesChanged(emailPayment: value));
-      },
       onCancelPressed: (BuildContext context) {
         createEntity(context: context, entity: PaymentEntity(), force: true);
         store.dispatch(UpdateCurrentRoute(state.uiState.previousRoute));
@@ -113,7 +102,6 @@ class PaymentEditVM {
   final Function(PaymentEntity) onChanged;
   final Function(BuildContext) onSavePressed;
   final Function(BuildContext) onCancelPressed;
-  final Function(bool) onEmailChanged;
   final PrefState prefState;
   final StaticState staticState;
   final bool isSaving;
diff --git a/lib/ui/payment/refund/payment_refund.dart b/lib/ui/payment/refund/payment_refund.dart
index a77f14f2c12..40b5273d883 100644
--- a/lib/ui/payment/refund/payment_refund.dart
+++ b/lib/ui/payment/refund/payment_refund.dart
@@ -133,9 +133,10 @@ class _PaymentRefundState extends State<PaymentRefund> {
               SwitchListTile(
                 activeColor: Theme.of(context).accentColor,
                 title: Text(localization.sendEmail),
-                value: viewModel.prefState.emailPayment,
+                value: payment.sendEmail ?? false,
                 subtitle: Text(localization.emailReceipt),
-                onChanged: (value) => viewModel.onEmailChanged(value),
+                onChanged: (value) => viewModel
+                    .onChanged(payment.rebuild((b) => b..sendEmail = value)),
               ),
             ],
           ),
diff --git a/lib/ui/payment/refund/payment_refund_vm.dart b/lib/ui/payment/refund/payment_refund_vm.dart
index 1ab6abfea24..2bc8e8f4fab 100644
--- a/lib/ui/payment/refund/payment_refund_vm.dart
+++ b/lib/ui/payment/refund/payment_refund_vm.dart
@@ -4,7 +4,6 @@ import 'package:built_collection/built_collection.dart';
 import 'package:flutter/foundation.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter_redux/flutter_redux.dart';
-import 'package:invoiceninja_flutter/constants.dart';
 import 'package:invoiceninja_flutter/data/models/invoice_model.dart';
 import 'package:invoiceninja_flutter/redux/app/app_actions.dart';
 import 'package:invoiceninja_flutter/redux/static/static_state.dart';
@@ -18,7 +17,6 @@ import 'package:redux/redux.dart';
 import 'package:invoiceninja_flutter/redux/payment/payment_actions.dart';
 import 'package:invoiceninja_flutter/data/models/payment_model.dart';
 import 'package:invoiceninja_flutter/redux/app/app_state.dart';
-import 'package:shared_preferences/shared_preferences.dart';
 
 class PaymentRefundScreen extends StatelessWidget {
   const PaymentRefundScreen({Key key}) : super(key: key);
@@ -48,7 +46,6 @@ class PaymentRefundVM {
     @required this.origPayment,
     @required this.onChanged,
     @required this.onRefundPressed,
-    @required this.onEmailChanged,
     @required this.prefState,
     @required this.invoiceMap,
     @required this.invoiceList,
@@ -75,11 +72,6 @@ class PaymentRefundVM {
       onChanged: (PaymentEntity payment) {
         store.dispatch(UpdatePayment(payment));
       },
-      onEmailChanged: (value) async {
-        final SharedPreferences prefs = await SharedPreferences.getInstance();
-        prefs.setBool(kSharedPrefEmailPayment, value);
-        store.dispatch(UserPreferencesChanged(emailPayment: value));
-      },
       onCancelPressed: (BuildContext context) {
         createEntity(context: context, entity: PaymentEntity(), force: true);
         store.dispatch(UpdateCurrentRoute(state.uiState.previousRoute));
@@ -117,7 +109,6 @@ class PaymentRefundVM {
   final Function(PaymentEntity) onChanged;
   final Function(BuildContext, Completer<PaymentEntity>) onRefundPressed;
   final Function(BuildContext) onCancelPressed;
-  final Function(bool) onEmailChanged;
   final BuiltMap<String, InvoiceEntity> invoiceMap;
   final PrefState prefState;
   final BuiltList<String> invoiceList;
diff --git a/lib/ui/settings/company_details.dart b/lib/ui/settings/company_details.dart
index 5372052311b..fc5c4a98294 100644
--- a/lib/ui/settings/company_details.dart
+++ b/lib/ui/settings/company_details.dart
@@ -496,15 +496,16 @@ class _CompanyDetailsState extends State<CompanyDetails>
               FormCard(
                   crossAxisAlignment: CrossAxisAlignment.stretch,
                   children: <Widget>[
-                    BoolDropdownButton(
-                      value: settings.clientManualPaymentNotification,
-                      onChanged: (value) => viewModel.onSettingsChanged(
-                          settings.rebuild((b) =>
-                              b..clientManualPaymentNotification = value)),
-                      label: localization.manualPaymentEmail,
-                      helpLabel: localization.emailReceipt,
-                      iconData: Icons.email,
-                    ),
+                    if (!state.settingsUIState.isFiltered)
+                      BoolDropdownButton(
+                        value: settings.clientManualPaymentNotification,
+                        onChanged: (value) => viewModel.onSettingsChanged(
+                            settings.rebuild((b) =>
+                                b..clientManualPaymentNotification = value)),
+                        label: localization.manualPaymentEmail,
+                        helpLabel: localization.emailReceipt,
+                        iconData: Icons.email,
+                      ),
                     BoolDropdownButton(
                       value: settings.clientOnlinePaymentNotification,
                       onChanged: (value) => viewModel.onSettingsChanged(
