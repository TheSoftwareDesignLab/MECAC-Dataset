diff --git a/src/components/pages/gallery/Upload.tsx b/src/components/pages/gallery/Upload.tsx
index 4110ee0c4b8..051aade3100 100644
--- a/src/components/pages/gallery/Upload.tsx
+++ b/src/components/pages/gallery/Upload.tsx
@@ -1,7 +1,7 @@
 import React, { useContext, useEffect, useState } from 'react';
 import UploadService, { FileWithCollection, UPLOAD_STAGES } from 'services/uploadService';
 import { createAlbum } from 'services/collectionService';
-import { File } from 'services/fileService';
+import { File, getLocalFiles } from 'services/fileService';
 import constants from 'utils/strings/constants';
 import { SetDialogMessage } from 'components/MessageDialog';
 import UploadProgress from './UploadProgress';
@@ -9,10 +9,9 @@ import UploadProgress from './UploadProgress';
 import ChoiceModal from './ChoiceModal';
 import { SetCollectionNamerAttributes } from './CollectionNamer';
 import { SetCollectionSelectorAttributes } from './CollectionSelector';
-import { SetLoading } from 'pages/gallery';
+import { SetFiles, SetLoading } from 'pages/gallery';
 import { AppContext } from 'pages/_app';
 import { logError } from 'utils/sentry';
-import { sortFilesIntoCollections } from 'utils/file';
 import { FileRejection } from 'react-dropzone';
 
 interface Props {
@@ -28,7 +27,8 @@ interface Props {
     setDialogMessage: SetDialogMessage;
     setUploadInProgress: any;
     showCollectionSelector: () => void;
-    fileRejections:FileRejection[]
+    fileRejections:FileRejection[];
+    setFiles:SetFiles;
 }
 
 export enum UPLOAD_STRATEGY {
@@ -204,13 +204,14 @@ export default function Upload(props: Props) {
             await props.syncInProgress;
             await UploadService.uploadFiles(
                 filesWithCollectionToUpload,
-                sortFilesIntoCollections(props.existingFiles),
+                props.existingFiles,
                 {
                     setPercentComplete,
                     setFileCounter,
                     setUploadStage,
                     setFileProgress,
                 },
+                props.setFiles,
             );
         } catch (err) {
             props.setBannerMessage(err.message);
@@ -228,7 +229,8 @@ export default function Upload(props: Props) {
             props.setUploadInProgress(true);
             setFileProgress(null);
             await props.syncInProgress;
-            await UploadService.retryFailedFiles();
+            const localFiles= await getLocalFiles();
+            await UploadService.retryFailedFiles(localFiles);
         } catch (err) {
             props.setBannerMessage(err.message);
             setProgressView(false);
diff --git a/src/pages/gallery/index.tsx b/src/pages/gallery/index.tsx
index 5aca5995fa1..a557caea767 100644
--- a/src/pages/gallery/index.tsx
+++ b/src/pages/gallery/index.tsx
@@ -426,6 +426,7 @@ export default function Gallery() {
                     setDialogMessage={setDialogMessage}
                     setUploadInProgress={setUploadInProgress}
                     fileRejections={fileRejections}
+                    setFiles={setFiles}
                 />
                 <Sidebar
                     collections={collections}
diff --git a/src/services/fileService.ts b/src/services/fileService.ts
index 849133c8b51..83b6527fb8a 100644
--- a/src/services/fileService.ts
+++ b/src/services/fileService.ts
@@ -1,12 +1,12 @@
 import { getEndpoint } from 'utils/common/apiUtil';
 import localForage from 'utils/storage/localForage';
 
-import CryptoWorker from 'utils/crypto';
 import { getToken } from 'utils/common/key';
 import { DataStream, MetadataObject } from './uploadService';
 import { Collection } from './collectionService';
 import HTTPService from './HTTPService';
 import { logError } from 'utils/sentry';
+import { decryptFile, sortFiles } from 'utils/file';
 
 const ENDPOINT = getEndpoint();
 const DIFF_LIMIT: number = 1000;
@@ -77,26 +77,7 @@ export const syncFiles = async (collections: Collection[], setFiles: (files: Fil
             }
             files.push(file);
         }
-        // sort according to modification time first
-        files = files.sort((a, b) => {
-            if (!b.metadata?.modificationTime) {
-                return -1;
-            }
-            if (!a.metadata?.modificationTime) {
-                return 1;
-            } else {
-                return b.metadata.modificationTime - a.metadata.modificationTime;
-            }
-        });
-
-        // then sort according to creation time, maintaining ordering according to modification time for files with creation time
-        files = files.map((file, index) => ({ index, file })).sort((a, b) => {
-            let diff = b.file.metadata.creationTime - a.file.metadata.creationTime;
-            if (diff === 0) {
-                diff = a.index - b.index;
-            }
-            return diff;
-        }).map((file) => file.file);
+        files=sortFiles(files);
         await localForage.setItem('files', files);
         await localForage.setItem(
             `${collection.id}-time`,
@@ -125,7 +106,6 @@ export const getFiles = async (
     setFiles: (files: File[]) => void,
 ): Promise<File[]> => {
     try {
-        const worker = await new CryptoWorker();
         const decryptedFiles: File[] = [];
         let time = sinceTime ||
             (await localForage.getItem<number>(`${collection.id}-time`)) ||
@@ -152,12 +132,7 @@ export const getFiles = async (
                 ...(await Promise.all(
                     resp.data.diff.map(async (file: File) => {
                         if (!file.isDeleted) {
-                            file.key = await worker.decryptB64(
-                                file.encryptedKey,
-                                file.keyDecryptionNonce,
-                                collection.key,
-                            );
-                            file.metadata = await worker.decryptMetadata(file);
+                            file = await decryptFile(file, collection);
                         }
                         return file;
                     }) as Promise<File>[],
diff --git a/src/services/uploadService.ts b/src/services/uploadService.ts
index 9544a9e0a44..1dcb4943144 100644
--- a/src/services/uploadService.ts
+++ b/src/services/uploadService.ts
@@ -3,7 +3,7 @@ import HTTPService from './HTTPService';
 import EXIF from 'exif-js';
 import { File, fileAttribute } from './fileService';
 import { Collection } from './collectionService';
-import { FILE_TYPE } from 'pages/gallery';
+import { FILE_TYPE, SetFiles } from 'pages/gallery';
 import { checkConnectivity, retryPromise, sleep } from 'utils/common';
 import {
     handleError,
@@ -17,8 +17,12 @@ import { getToken } from 'utils/common/key';
 import {
     fileIsHEIC,
     convertHEIC2JPEG,
+    sortFilesIntoCollections,
+    sortFiles,
+    decryptFile,
 } from 'utils/file';
 import { logError } from 'utils/sentry';
+import localForage from 'utils/storage/localForage';
 const ENDPOINT = getEndpoint();
 
 const THUMBNAIL_HEIGHT = 720;
@@ -142,10 +146,13 @@ class UploadService {
     private progressBarProps;
     private failedFiles: FileWithCollection[];
     private existingFilesCollectionWise: Map<number, File[]>;
+    private existingFiles: File[];
+    private setFiles:SetFiles;
     public async uploadFiles(
         filesWithCollectionToUpload: FileWithCollection[],
-        existingFilesCollectionWise: Map<number, File[]>,
+        existingFiles: File[],
         progressBarProps,
+        setFiles:SetFiles,
     ) {
         try {
             checkConnectivity();
@@ -156,9 +163,10 @@ class UploadService {
             this.failedFiles = [];
             this.metadataMap = new Map<string, object>();
             this.progressBarProps = progressBarProps;
-            this.existingFilesCollectionWise = existingFilesCollectionWise;
+            this.existingFiles=existingFiles;
+            this.existingFilesCollectionWise = sortFilesIntoCollections(existingFiles);
             this.updateProgressBarUI();
-
+            this.setFiles=setFiles;
             const metadataFiles: globalThis.File[] = [];
             const actualFiles: FileWithCollection[] = [];
             filesWithCollectionToUpload.forEach((fileWithCollection) => {
@@ -255,19 +263,31 @@ class UploadService {
             } else {
                 let encryptedFile: EncryptedFile =
                     await this.encryptFile(worker, file, collection.key);
+
                 let backupedFile: BackupedFile = await this.uploadToBucket(
                     encryptedFile.file,
                 );
-                file = null;
+
                 let uploadFile: uploadFile = this.getUploadFile(
                     collection,
                     backupedFile,
                     encryptedFile.fileKey,
                 );
+
                 encryptedFile = null;
                 backupedFile = null;
-                await this.uploadFile(uploadFile);
+
+                const uploadedFile =await this.uploadFile(uploadFile);
+                const decryptedFile=await decryptFile(uploadedFile, collection);
+
+                this.existingFiles.push(decryptedFile);
+                this.existingFiles=sortFiles(this.existingFiles);
+                await localForage.setItem('files', this.existingFiles);
+                this.setFiles(this.existingFiles);
+
+                file = null;
                 uploadFile = null;
+
                 this.fileProgress.delete(rawFile.name);
                 this.filesCompleted++;
             }
@@ -288,8 +308,8 @@ class UploadService {
             );
         }
     }
-    async retryFailedFiles() {
-        await this.uploadFiles(this.failedFiles, this.existingFilesCollectionWise, this.progressBarProps);
+    async retryFailedFiles(localFiles:File[]) {
+        await this.uploadFiles(this.failedFiles, localFiles, this.progressBarProps, this.setFiles);
     }
 
     private updateProgressBarUI() {
@@ -544,7 +564,7 @@ class UploadService {
         return uploadFile;
     }
 
-    private async uploadFile(uploadFile: uploadFile) {
+    private async uploadFile(uploadFile: uploadFile):Promise<File> {
         try {
             const token = getToken();
             if (!token) {
diff --git a/src/utils/file/index.ts b/src/utils/file/index.ts
index 5beb6cf1d24..1fc7eadbf64 100644
--- a/src/utils/file/index.ts
+++ b/src/utils/file/index.ts
@@ -1,5 +1,7 @@
+import { Collection } from 'services/collectionService';
 import { File } from 'services/fileService';
 import { runningInBrowser } from 'utils/common';
+import CryptoWorker from 'utils/crypto';
 
 const TYPE_HEIC = 'heic';
 const UNSUPPORTED_FORMATS = ['flv', 'mkv', '3gp', 'avi', 'wmv'];
@@ -94,3 +96,38 @@ export function formatDateTime(date: number | Date) {
     });
     return `${dateTimeFormat.format(date)} ${timeFormat.format(date)}`;
 }
+
+export function sortFiles(files:File[]) {
+    // sort according to modification time first
+    files = files.sort((a, b) => {
+        if (!b.metadata?.modificationTime) {
+            return -1;
+        }
+        if (!a.metadata?.modificationTime) {
+            return 1;
+        } else {
+            return b.metadata.modificationTime - a.metadata.modificationTime;
+        }
+    });
+
+    // then sort according to creation time, maintaining ordering according to modification time for files with creation time
+    files = files.map((file, index) => ({ index, file })).sort((a, b) => {
+        let diff = b.file.metadata.creationTime - a.file.metadata.creationTime;
+        if (diff === 0) {
+            diff = a.index - b.index;
+        }
+        return diff;
+    }).map((file) => file.file);
+    return files;
+}
+
+export async function decryptFile(file:File, collection:Collection) {
+    const worker = await new CryptoWorker();
+    file.key = await worker.decryptB64(
+        file.encryptedKey,
+        file.keyDecryptionNonce,
+        collection.key,
+    );
+    file.metadata = await worker.decryptMetadata(file);
+    return file;
+}
