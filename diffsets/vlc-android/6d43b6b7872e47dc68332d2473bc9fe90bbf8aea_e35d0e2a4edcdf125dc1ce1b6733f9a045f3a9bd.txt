diff --git a/application/resources/assets/images/svg/ic_swipe_unlock.svg b/application/resources/assets/images/svg/ic_swipe_unlock.svg
new file mode 100644
index 0000000000..65902bf016
--- /dev/null
+++ b/application/resources/assets/images/svg/ic_swipe_unlock.svg
@@ -0,0 +1,16 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Generator: Adobe Illustrator 24.0.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
+<svg version="1.1"
+	 id="svg6" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg"
+	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32"
+	 style="enable-background:new 0 0 32 32;" xml:space="preserve">
+<style type="text/css">
+	.st0{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
+</style>
+<sodipodi:namedview  bordercolor="#666666" borderopacity="1" gridtolerance="10" guidetolerance="10" id="namedview8" inkscape:current-layer="svg6" inkscape:cx="0.15254237" inkscape:cy="12" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-height="1413" inkscape:window-maximized="1" inkscape:window-width="2560" inkscape:window-x="0" inkscape:window-y="27" inkscape:zoom="9.8333333" objecttolerance="10" pagecolor="#ffffff" showgrid="false">
+	</sodipodi:namedview>
+<path class="st0" d="M16,8.7c1.4,0,2.5,1.1,2.5,2.5v1.6h-5v-1.6C13.5,9.8,14.6,8.7,16,8.7z M16,16.8c0.9,0,1.6,0.7,1.6,1.6
+	S16.9,20,16,20c-0.9,0-1.6-0.7-1.6-1.6S15.1,16.8,16,16.8z M16,7.2c-2.2,0-4,1.8-4,4v1.6h-0.8c-0.9,0-1.6,0.7-1.6,1.6v8
+	c0,0.9,0.7,1.6,1.6,1.6h9.6c0.9,0,1.6-0.7,1.6-1.6v-8c0-0.9-0.7-1.6-1.6-1.6H20v-1.6C20,9,18.2,7.2,16,7.2z M16,0
+	c8.8,0,16,7.2,16,16s-7.2,16-16,16S0,24.8,0,16S7.2,0,16,0z"/>
+</svg>
diff --git a/application/resources/src/main/res/drawable/ic_swipe_unlock.xml b/application/resources/src/main/res/drawable/ic_swipe_unlock.xml
new file mode 100644
index 0000000000..0e5b7bbcfc
--- /dev/null
+++ b/application/resources/src/main/res/drawable/ic_swipe_unlock.xml
@@ -0,0 +1,10 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="32dp"
+        android:height="32dp"
+        android:viewportWidth="32"
+        android:viewportHeight="32">
+    <path
+            android:fillColor="#FFFFFF"
+            android:fillType="evenOdd"
+            android:pathData="M16,8.7c1.4,0 2.5,1.1 2.5,2.5v1.6h-5v-1.6C13.5,9.8 14.6,8.7 16,8.7zM16,16.8c0.9,0 1.6,0.7 1.6,1.6S16.9,20 16,20c-0.9,0 -1.6,-0.7 -1.6,-1.6S15.1,16.8 16,16.8zM16,7.2c-2.2,0 -4,1.8 -4,4v1.6h-0.8c-0.9,0 -1.6,0.7 -1.6,1.6v8c0,0.9 0.7,1.6 1.6,1.6h9.6c0.9,0 1.6,-0.7 1.6,-1.6v-8c0,-0.9 -0.7,-1.6 -1.6,-1.6H20v-1.6C20,9 18.2,7.2 16,7.2zM16,0c8.8,0 16,7.2 16,16s-7.2,16 -16,16S0,24.8 0,16S7.2,0 16,0z" />
+</vector>
diff --git a/application/resources/src/main/res/drawable/swipe_to_unlock_background.xml b/application/resources/src/main/res/drawable/swipe_to_unlock_background.xml
new file mode 100644
index 0000000000..8bd39d09bd
--- /dev/null
+++ b/application/resources/src/main/res/drawable/swipe_to_unlock_background.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ *************************************************************************
+  ~  swipe_to_unlock_brackground.xml
+  ~ **************************************************************************
+  ~ Copyright © 2020 VLC authors and VideoLAN
+  ~ Author: Nicolas POMEPUY
+  ~ This program is free software; you can redistribute it and/or modify
+  ~ it under the terms of the GNU General Public License as published by
+  ~ the Free Software Foundation; either version 2 of the License, or
+  ~ (at your option) any later version.
+  ~
+  ~ This program is distributed in the hope that it will be useful,
+  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
+  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  ~ GNU General Public License for more details.
+  ~
+  ~ You should have received a copy of the GNU General Public License
+  ~ along with this program; if not, write to the Free Software
+  ~ Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+  ~ ***************************************************************************
+  ~
+  ~
+  -->
+
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item>
+        <shape android:shape="rectangle">
+            <corners android:radius="60dp" />
+            <solid android:color="@color/playerbackground" />
+        </shape>
+    </item>
+
+</layer-list>
diff --git a/application/resources/src/main/res/values/attrs.xml b/application/resources/src/main/res/values/attrs.xml
index 5e234a57d3..4ff16c688f 100644
--- a/application/resources/src/main/res/values/attrs.xml
+++ b/application/resources/src/main/res/values/attrs.xml
@@ -99,6 +99,7 @@
     <attr name="ic_abrepeat_seta" format="reference" />
     <attr name="ic_abrepeat_setb" format="reference" />
     <attr name="ic_video_stats" format="reference" />
+    <attr name="ic_lock_player" format="reference" />
     <attr name="ic_crop_player" format="reference" />
     <attr name="ic_dial" format="reference" />
     <attr name="player_icon_color" format="reference" />
diff --git a/application/resources/src/main/res/values/colors.xml b/application/resources/src/main/res/values/colors.xml
index ba94a6bb55..d13b19d7c9 100644
--- a/application/resources/src/main/res/values/colors.xml
+++ b/application/resources/src/main/res/values/colors.xml
@@ -68,6 +68,7 @@
 
     <color name="black_transparent_80">#cc000000</color>
     <color name="white_transparent_10">#1affffff</color>
+    <color name="white_transparent_30">#4dffffff</color>
 
     <color name="white_selection_transparent">#44ffffff</color>
 
diff --git a/application/resources/src/main/res/values/strings.xml b/application/resources/src/main/res/values/strings.xml
index f2585f64e6..966d29c200 100644
--- a/application/resources/src/main/res/values/strings.xml
+++ b/application/resources/src/main/res/values/strings.xml
@@ -128,8 +128,6 @@
     <string name="firstsong">First song of the playlist</string>
     <string name="lastsong">Last song of the playlist</string>
 
-    <string name="locked">Locked</string>
-    <string name="unlocked">Unlocked</string>
     <string name="surface_best_fit">Best fit</string>
     <string name="surface_fit_screen">Fit screen</string>
     <string name="surface_fill">Fill</string>
@@ -736,4 +734,7 @@
     <string name="no_favorite">No favorite</string>
     <string name="empty_directory">Empty</string>
     <string name="no_track">No track</string>
+
+    <string name="swipe_unlock">Swipe to unlock</string>
+    <string name="swipe_unlock_no_touch">Long press to unlock</string>
 </resources>
diff --git a/application/television/src/main/res/layout/activity_media_list_tv_item.xml b/application/television/src/main/res/layout/activity_media_list_tv_item.xml
index 88b5a393a8..a12aef1947 100644
--- a/application/television/src/main/res/layout/activity_media_list_tv_item.xml
+++ b/application/television/src/main/res/layout/activity_media_list_tv_item.xml
@@ -73,7 +73,7 @@
             android:textColor="@color/white"
             android:textSize="16sp"
             app:layout_constraintBottom_toTopOf="@+id/textView16"
-            app:layout_constraintEnd_toStartOf="@+id/textView17"
+            app:layout_constraintEnd_toStartOf="@+id/swipe_text"
             app:layout_constraintHorizontal_bias="0.5"
             app:layout_constraintStart_toEndOf="@+id/item_play"
             app:layout_constraintTop_toTopOf="parent"
@@ -88,7 +88,7 @@
             android:layout_marginEnd="8dp"
             android:text="@{item.artist}"
             app:layout_constraintBottom_toBottomOf="parent"
-            app:layout_constraintEnd_toStartOf="@+id/textView17"
+            app:layout_constraintEnd_toStartOf="@+id/swipe_text"
             app:layout_constraintHorizontal_bias="0.5"
             app:layout_constraintStart_toEndOf="@+id/item_play"
             app:layout_constraintTop_toBottomOf="@+id/title"
diff --git a/application/vlc-android/res/layout/player_hud.xml b/application/vlc-android/res/layout/player_hud.xml
index 6d6d0031d8..f6583024ec 100644
--- a/application/vlc-android/res/layout/player_hud.xml
+++ b/application/vlc-android/res/layout/player_hud.xml
@@ -490,6 +490,16 @@
                     vlc:layout_constraintTop_toTopOf="@+id/player_overlay_play"
                     vlc:srcCompat="@drawable/ic_player_more" />
 
+            <org.videolan.vlc.gui.view.SwipeToUnlockView
+                    android:id="@+id/swipe_to_unlock"
+                    android:layout_width="wrap_content"
+                    android:layout_height="match_parent"
+                    android:visibility="gone"
+                    vlc:layout_constraintBottom_toBottomOf="parent"
+                    vlc:layout_constraintEnd_toEndOf="parent"
+                    vlc:layout_constraintStart_toStartOf="parent"
+                    vlc:layout_constraintTop_toBottomOf="@id/player_overlay_seekbar" />
+
         </androidx.constraintlayout.widget.ConstraintLayout>
     </androidx.constraintlayout.widget.ConstraintLayout>
 
diff --git a/application/vlc-android/res/layout/swipe_to_unlock.xml b/application/vlc-android/res/layout/swipe_to_unlock.xml
new file mode 100644
index 0000000000..30b0599530
--- /dev/null
+++ b/application/vlc-android/res/layout/swipe_to_unlock.xml
@@ -0,0 +1,65 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ *************************************************************************
+  ~  swipe_to_unlock.xml
+  ~ **************************************************************************
+  ~ Copyright © 2020 VLC authors and VideoLAN
+  ~ Author: Nicolas POMEPUY
+  ~ This program is free software; you can redistribute it and/or modify
+  ~ it under the terms of the GNU General Public License as published by
+  ~ the Free Software Foundation; either version 2 of the License, or
+  ~ (at your option) any later version.
+  ~
+  ~ This program is distributed in the hope that it will be useful,
+  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
+  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  ~ GNU General Public License for more details.
+  ~
+  ~ You should have received a copy of the GNU General Public License
+  ~ along with this program; if not, write to the Free Software
+  ~ Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+  ~ ***************************************************************************
+  ~
+  ~
+  -->
+
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:app="http://schemas.android.com/apk/res-auto"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:background="@drawable/swipe_to_unlock_background">
+
+    <TextView
+            android:id="@+id/swipe_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginStart="60dp"
+            android:layout_marginEnd="24dp"
+            android:text="@string/swipe_unlock"
+            android:textAllCaps="true"
+            android:textColor="@color/white"
+            app:layout_constraintBottom_toBottomOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+    <androidx.constraintlayout.widget.Guideline
+            android:id="@+id/swipe_guideline"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            app:layout_constraintGuide_begin="18dp" />
+
+    <ImageView
+            android:id="@+id/swipe_icon"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="4dp"
+            android:layout_marginBottom="4dp"
+            app:layout_constraintBottom_toBottomOf="parent"
+            app:layout_constraintEnd_toStartOf="@+id/swipe_guideline"
+            app:layout_constraintStart_toStartOf="@+id/swipe_guideline"
+            app:layout_constraintTop_toTopOf="parent"
+            app:srcCompat="@drawable/ic_swipe_unlock" />
+
+
+</androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
diff --git a/application/vlc-android/res/values/styles.xml b/application/vlc-android/res/values/styles.xml
index 7762229723..28c7b655e0 100644
--- a/application/vlc-android/res/values/styles.xml
+++ b/application/vlc-android/res/values/styles.xml
@@ -102,6 +102,7 @@
         <item name="ic_abrepeat">@drawable/ic_abrepeat</item>
         <item name="ic_abrepeat_reset">@drawable/ic_abrepeat_reset</item>
         <item name="ic_video_stats">@drawable/ic_video_stats</item>
+        <item name="ic_lock_player">@drawable/ic_lock_player</item>
         <item name="ic_dial">@drawable/ic_dial</item>
         <item name="progress_background">@color/grey400</item>
         <item name="ariane_text_color">@color/grey700</item>
@@ -227,6 +228,7 @@
         <item name="ic_abrepeat">@drawable/ic_abrepeat</item>
         <item name="ic_abrepeat_reset">@drawable/ic_abrepeat_reset</item>
         <item name="ic_video_stats">@drawable/ic_video_stats</item>
+        <item name="ic_lock_player">@drawable/ic_lock_player</item>
         <item name="ic_dial">@drawable/ic_dial_w</item>
         <item name="progress_indeterminate_tint">@color/orange500</item>
         <item name="progress_background">@color/grey700</item>
@@ -409,6 +411,7 @@
         <item name="ic_abrepeat">@drawable/ic_abrepeat</item>
         <item name="ic_abrepeat_reset">@drawable/ic_abrepeat_reset</item>
         <item name="ic_video_stats">@drawable/ic_video_stats</item>
+        <item name="ic_lock_player">@drawable/ic_lock_player</item>
         <item name="ic_dial">@drawable/ic_dial_w</item>
         <item name="ic_crop_player">@drawable/ic_crop_player</item>
         <item name="android:colorControlHighlight" tools:targetApi="lollipop">@color/orange500
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/helpers/PlayerOptionsDelegate.kt b/application/vlc-android/src/org/videolan/vlc/gui/helpers/PlayerOptionsDelegate.kt
index 158748659e..866650c792 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/helpers/PlayerOptionsDelegate.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/helpers/PlayerOptionsDelegate.kt
@@ -56,6 +56,7 @@ private const val ID_REPEAT = 10L
 private const val ID_SHUFFLE = 11L
 private const val ID_PASSTHROUGH = 12L
 private const val ID_ABREPEAT = 13L
+private const val ID_LOCK_PLAYER = 14L
 private const val ID_VIDEO_STATS = 15L
 
 @ObsoleteCoroutinesApi
@@ -94,6 +95,7 @@ class PlayerOptionsDelegate(val activity: AppCompatActivity, val service: Playba
     fun setup() {
         if (!this::recyclerview.isInitialized || PlayerController.playbackState == PlaybackStateCompat.STATE_STOPPED) return
         val options = mutableListOf<PlayerOption>()
+        if (video) options.add(PlayerOption(ID_LOCK_PLAYER, R.attr.ic_lock_player, res.getString(R.string.lock)))
         options.add(PlayerOption(ID_SLEEP, R.attr.ic_sleep_normal_style, res.getString(R.string.sleep_title)))
         if (service.isSeekable) {
             options.add(PlayerOption(ID_PLAYBACK_SPEED, R.attr.ic_speed_normal_style, res.getString(R.string.playback_speed)))
@@ -169,6 +171,10 @@ class PlayerOptionsDelegate(val activity: AppCompatActivity, val service: Playba
                 hide()
                 service.playlistManager.toggleABRepeat()
             }
+            ID_LOCK_PLAYER -> {
+                hide()
+                (activity as VideoPlayerActivity).toggleLock()
+            }
             ID_VIDEO_STATS -> {
                 hide()
                 service.playlistManager.toggleStats()
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/video/VideoPlayerActivity.kt b/application/vlc-android/src/org/videolan/vlc/gui/video/VideoPlayerActivity.kt
index d431c5396f..503008d99f 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/video/VideoPlayerActivity.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/video/VideoPlayerActivity.kt
@@ -70,6 +70,7 @@ import androidx.recyclerview.widget.LinearLayoutManager
 import androidx.recyclerview.widget.RecyclerView
 import androidx.vectordrawable.graphics.drawable.AnimatedVectorDrawableCompat
 import com.google.android.material.textfield.TextInputLayout
+import kotlinx.android.synthetic.main.player.*
 import kotlinx.android.synthetic.main.player_overlay_brightness.*
 import kotlinx.android.synthetic.main.player_overlay_volume.*
 import kotlinx.coroutines.*
@@ -554,10 +555,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             abRepeatAddMarker.setOnClickListener(this)
             hudBinding.orientationToggle.setOnClickListener(if (enabled) this else null)
             hudBinding.orientationToggle.setOnLongClickListener(if (enabled) this else null)
-        }
-        if (::hudRightBinding.isInitialized) {
-//            hudRightBinding.orientationToggle.setOnClickListener(if (enabled) this else null)
-//            hudRightBinding.orientationToggle.setOnLongClickListener(if (enabled) this else null)
+            hudBinding.swipeToUnlock.setOnStartTouchingListener { showOverlayTimeout(OVERLAY_INFINITE) }
+            hudBinding.swipeToUnlock.setOnStopTouchingListener { showOverlayTimeout(OVERLAY_TIMEOUT) }
+            hudBinding.swipeToUnlock.setOnUnlockListener { toggleLock() }
         }
         UiTools.setViewOnClickListener(rendererBtn, if (enabled) this else null)
     }
@@ -1044,6 +1044,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             KeyEvent.KEYCODE_DPAD_LEFT -> {
                 if (isNavMenu)
                     return navigateDvdMenu(keyCode)
+                else if (isLocked) {
+                    showOverlayTimeout(OVERLAY_TIMEOUT)
+                }
                 else if (!isShowing && !playlistContainer.isVisible()) {
                     if (event.isAltPressed && event.isCtrlPressed) {
                         touchDelegate.seekDelta(-300000)
@@ -1059,6 +1062,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             KeyEvent.KEYCODE_DPAD_RIGHT -> {
                 if (isNavMenu)
                     return navigateDvdMenu(keyCode)
+                else if (isLocked) {
+                    showOverlayTimeout(OVERLAY_TIMEOUT)
+                }
                 else if (!isShowing && !playlistContainer.isVisible()) {
                     if (event.isAltPressed && event.isCtrlPressed) {
                         touchDelegate.seekDelta(300000)
@@ -1074,6 +1080,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             KeyEvent.KEYCODE_DPAD_UP -> {
                 if (isNavMenu)
                     return navigateDvdMenu(keyCode)
+                else if (isLocked) {
+                    showOverlayTimeout(OVERLAY_TIMEOUT)
+                }
                 else if (event.isCtrlPressed) {
                     volumeUp()
                     return true
@@ -1088,6 +1097,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             KeyEvent.KEYCODE_DPAD_DOWN -> {
                 if (isNavMenu)
                     return navigateDvdMenu(keyCode)
+                else if (isLocked) {
+                    showOverlayTimeout(OVERLAY_TIMEOUT)
+                }
                 else if (event.isCtrlPressed) {
                     volumeDown()
                     return true
@@ -1099,6 +1111,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             KeyEvent.KEYCODE_DPAD_CENTER -> {
                 if (isNavMenu)
                     return navigateDvdMenu(keyCode)
+                else if (isLocked) {
+                    showOverlayTimeout(OVERLAY_TIMEOUT)
+                }
                 else if (!isShowing) {
                     doPlayPause()
                     return true
@@ -1252,13 +1267,13 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             else
                 getScreenOrientation(100)
         }
-        showInfo(R.string.locked, 1000)
         if (::hudBinding.isInitialized) {
             hudBinding.playerOverlayTime.isEnabled = false
             hudBinding.playerOverlaySeekbar.isEnabled = false
             hudBinding.playerOverlayLength.isEnabled = false
             hudBinding.playlistNext.isEnabled = false
             hudBinding.playlistPrevious.isEnabled = false
+            hudBinding.swipeToUnlock.setVisible()
         }
         hideOverlay(true)
         lockBackButton = true
@@ -1271,7 +1286,6 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
     private fun unlockScreen() {
         if (screenOrientation != 100)
             requestedOrientation = screenOrientationLock
-        showInfo(R.string.unlocked, 1000)
         if (::hudBinding.isInitialized) {
             hudBinding.playerOverlayTime.isEnabled = true
             hudBinding.playerOverlaySeekbar.isEnabled = service?.isSeekable != false
@@ -2173,6 +2187,9 @@ open class VideoPlayerActivity : AppCompatActivity(), PlaybackService.Callback,
             visibility = visibility or View.SYSTEM_UI_FLAG_VISIBLE or View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION
         }
 
+        player_ui_container.setPadding(0, 0, 0, 0)
+        player_ui_container.fitsSystemWindows = !isLocked
+
         if (AndroidDevices.hasNavBar)
             visibility = visibility or navbar
         window.decorView.systemUiVisibility = visibility
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/view/SwipeToUnlockView.kt b/application/vlc-android/src/org/videolan/vlc/gui/view/SwipeToUnlockView.kt
new file mode 100644
index 0000000000..670d326b70
--- /dev/null
+++ b/application/vlc-android/src/org/videolan/vlc/gui/view/SwipeToUnlockView.kt
@@ -0,0 +1,207 @@
+/*
+ * ************************************************************************
+ *  SwipeToUnlockView.kt
+ * *************************************************************************
+ * Copyright © 2019 VLC authors and VideoLAN
+ * Author: Nicolas POMEPUY
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ * **************************************************************************
+ *
+ *
+ */
+
+package org.videolan.vlc.gui.view
+
+import android.animation.ValueAnimator
+import android.content.Context
+import android.graphics.BlurMaskFilter
+import android.text.SpannableString
+import android.text.Spanned
+import android.text.style.MaskFilterSpan
+import android.util.AttributeSet
+import android.util.Log
+import android.view.KeyEvent
+import android.view.LayoutInflater
+import android.view.MotionEvent
+import android.view.View
+import android.view.animation.AccelerateInterpolator
+import android.widget.ImageView
+import android.widget.TextView
+import androidx.constraintlayout.widget.ConstraintLayout
+import androidx.constraintlayout.widget.Guideline
+import kotlinx.coroutines.ExperimentalCoroutinesApi
+import kotlinx.coroutines.ObsoleteCoroutinesApi
+import org.videolan.resources.AndroidDevices
+import org.videolan.tools.dp
+import org.videolan.tools.setGone
+import org.videolan.vlc.BuildConfig
+import org.videolan.vlc.R
+
+@ExperimentalCoroutinesApi
+@ObsoleteCoroutinesApi
+class SwipeToUnlockView : ConstraintLayout {
+
+    private lateinit var currentText: String
+    private var extremum: Int = 0
+    private lateinit var swipeIcon: ImageView
+    private lateinit var guideline: Guideline
+    private lateinit var swipeText: TextView
+
+    private var unlocking: Boolean = false
+    private lateinit var onStartTouching: () -> Unit
+    private lateinit var onStopTouching: () -> Unit
+    private lateinit var onUnlock: () -> Unit
+    private lateinit var keyAnimation: ValueAnimator
+
+    private val tvAcceptedKeys = arrayOf(KeyEvent.KEYCODE_DPAD_CENTER, KeyEvent.KEYCODE_DPAD_DOWN, KeyEvent.KEYCODE_DPAD_LEFT, KeyEvent.KEYCODE_DPAD_RIGHT, KeyEvent.KEYCODE_DPAD_UP, KeyEvent.KEYCODE_ENTER, KeyEvent.KEYCODE_NUMPAD_ENTER)
+
+    constructor(context: Context) : super(context)
+
+    constructor(context: Context, attrs: AttributeSet) : super(context, attrs) {
+        initialize()
+    }
+
+    constructor(context: Context, attrs: AttributeSet, defStyle: Int) : super(context, attrs, defStyle) {
+        initialize()
+    }
+
+    fun setOnStartTouchingListener(listener: () -> Unit) {
+        onStartTouching = listener
+    }
+
+    fun setOnStopTouchingListener(listener: () -> Unit) {
+        onStopTouching = listener
+    }
+
+    fun setOnUnlockListener(listener: () -> Unit) {
+        onUnlock = listener
+    }
+
+    override fun setVisibility(visibility: Int) {
+        if (visibility == View.VISIBLE) {
+            unlocking = false
+            if (extremum != 0) playStep(extremum)
+            requestFocus()
+        }
+        super.setVisibility(visibility)
+    }
+
+    override fun onTouchEvent(event: MotionEvent?): Boolean {
+        if (unlocking) return super.onTouchEvent(event)
+        event?.let { event ->
+            val currentX = event.x.toInt().coerceAtLeast(extremum).coerceAtMost(width - extremum)
+
+            when (event.action) {
+                MotionEvent.ACTION_DOWN -> {
+                    onStartTouching.invoke()
+                    return true
+                }
+                MotionEvent.ACTION_MOVE -> {
+
+                    if (currentX >= width - extremum) unlock()
+
+                    playStep(currentX)
+
+                    return true
+                }
+                MotionEvent.ACTION_UP -> {
+                    animateBack(currentX)
+                    onStopTouching.invoke()
+                    return true
+                }
+                else -> return true
+            }
+        }
+        return super.onTouchEvent(event)
+    }
+
+    private fun animateBack(currentX: Int) {
+        if (BuildConfig.DEBUG) Log.d(this::class.java.simpleName, "animateBack", RuntimeException("gime a stack"))
+        val animation = ValueAnimator.ofInt(currentX, extremum)
+        animation.duration = 250 // milliseconds
+
+        animation.addUpdateListener { animator -> playStep(animator.animatedValue as Int) }
+        animation.start()
+        swipeText.alpha = 1f
+    }
+
+    private fun playStep(currentX: Int) {
+        guideline.setGuidelineBegin(currentX)
+        val progress = (currentX.toFloat() - extremum) / (width - extremum)
+        swipeText.alpha = 1F - progress
+
+        val string = SpannableString(currentText)
+        if (progress > 0) {
+            val blurMask = BlurMaskFilter(progress * 10, BlurMaskFilter.Blur.NORMAL)
+            string.setSpan(MaskFilterSpan(blurMask), 0, string.length, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE)
+        }
+
+        swipeText.text = string
+    }
+
+    override fun onKeyDown(keyCode: Int, event: KeyEvent?): Boolean {
+        if (event?.keyCode in tvAcceptedKeys && !unlocking) {
+            onStartTouching.invoke()
+            if (!::keyAnimation.isInitialized || !keyAnimation.isRunning) {
+                keyAnimation = ValueAnimator.ofInt(extremum, width - extremum)
+                keyAnimation.interpolator = AccelerateInterpolator()
+                keyAnimation.duration = 2000
+                keyAnimation.addUpdateListener { animator ->
+                    run {
+                        playStep(animator.animatedValue as Int)
+                        if (animator.animatedValue == width - extremum) unlock()
+                    }
+                }
+                keyAnimation.start()
+            }
+            return true
+        }
+        return super.onKeyDown(keyCode, event)
+    }
+
+    override fun onKeyUp(keyCode: Int, event: KeyEvent?): Boolean {
+        if (event?.keyCode in tvAcceptedKeys) {
+            onStopTouching.invoke()
+
+            if (::keyAnimation.isInitialized && keyAnimation.isRunning) {
+                animateBack(keyAnimation.animatedValue as Int)
+                keyAnimation.removeAllUpdateListeners()
+                keyAnimation.cancel()
+            }
+            return true
+        }
+        return super.onKeyUp(keyCode, event)
+    }
+
+    private fun unlock() {
+        unlocking = true
+        onUnlock.invoke()
+        setGone()
+        guideline.setGuidelineBegin(extremum)
+    }
+
+    private fun initialize() {
+        LayoutInflater.from(context).inflate(R.layout.swipe_to_unlock, this, true)
+        guideline = findViewById(R.id.swipe_guideline)
+        swipeIcon = findViewById(R.id.swipe_icon)
+        swipeText = findViewById(R.id.swipe_text)
+
+        swipeIcon.addOnLayoutChangeListener { v, _, _, _, _, _, _, _, _ -> extremum = (v.width / 2) + 4.dp }
+        isFocusable = true
+
+        currentText = if (!AndroidDevices.isTv) context.getString(R.string.swipe_unlock) else context.getString(R.string.swipe_unlock_no_touch)
+        swipeText.text = currentText
+    }
+}
