diff --git a/vlc-android/AndroidManifest.xml b/vlc-android/AndroidManifest.xml
index eae1a33e08..cec48bcf79 100644
--- a/vlc-android/AndroidManifest.xml
+++ b/vlc-android/AndroidManifest.xml
@@ -10,7 +10,7 @@
 	        <activity 
 	        	android:label="@string/app_name"
 	        	android:icon="@drawable/icon" 
-	        	android:name="MediaLibraryActivity"
+	        	android:name=".MainActivity"
 	        	android:theme="@android:style/Theme.NoTitleBar"
 	        	android:configChanges="orientation">
 	        	<intent-filter>
@@ -34,9 +34,15 @@
 	        <activity 
 	        	android:name="PreferencesActivity" 
 	        	android:theme="@android:style/Theme.NoTitleBar"/>
+	        <activity 
+	        	android:name="VideoActivityGroup" 
+	        	android:theme="@android:style/Theme.NoTitleBar"/>
 	        <activity 
 	        	android:name="VideoListActivity" 
 	        	android:theme="@android:style/Theme.NoTitleBar"/>
+	        <activity 
+	        	android:name=".MediaInfoActivity" 
+	        	android:theme="@android:style/Theme.NoTitleBar"/>
 	        <activity 
 	        	android:name="VideoPlayerActivity" 
 	        	android:theme="@android:style/Theme.NoTitleBar.Fullscreen" 
diff --git a/vlc-android/res/layout/media_info.xml b/vlc-android/res/layout/media_info.xml
new file mode 100644
index 0000000000..792123bd5c
--- /dev/null
+++ b/vlc-android/res/layout/media_info.xml
@@ -0,0 +1,94 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView
+  	xmlns:android="http://schemas.android.com/apk/res/android"
+  	android:layout_width="fill_parent"
+  	android:layout_height="fill_parent"
+  	android:scrollbars="none">
+	<FrameLayout
+	  	android:orientation="vertical"
+	  	android:layout_width="match_parent"
+	  	android:layout_height="match_parent">
+	  	<LinearLayout
+	  		android:layout_width="match_parent"
+	  		android:layout_height="match_parent"
+	  		android:gravity="center_horizontal"
+	  		android:paddingTop="60dip">
+	  		<ProgressBar 
+	  			android:layout_width="wrap_content" 
+	  			android:layout_height="wrap_content" 
+	  			style="?android:attr/progressBarStyleLarge"/>
+	  	</LinearLayout>
+	
+	    <ImageView 
+	    	android:layout_width="match_parent" 
+	    	android:layout_height="210dip" 
+	    	android:id="@+id/image"
+	    	android:scaleType="centerCrop"
+	    	android:visibility="invisible"/>
+	    <LinearLayout
+	    	android:layout_width="match_parent" 
+	    	android:layout_height="match_parent" 
+	    	android:paddingTop="180dip">
+		    <LinearLayout
+		    	android:layout_width="match_parent" 
+		    	android:layout_height="match_parent" 
+		    	android:orientation="vertical"
+		    	android:background="#66000000">
+		        <TextView 
+		        	android:layout_width="wrap_content" 
+		        	android:layout_height="wrap_content" 
+		        	android:textAppearance="?android:attr/textAppearanceLarge" 
+		        	android:id="@+id/title"
+		        	android:singleLine="true"
+		        	android:layout_marginLeft="10dip"/>
+		        <TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="match_parent" 
+	        		android:gravity="right"
+	       			android:id="@+id/length" 
+	       			android:layout_marginRight="10dip"
+	       			android:textAppearance="?android:attr/textAppearanceMedium"/>
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	       			android:layout_marginTop="10dip"
+	       			android:layout_marginLeft="5dip"
+	       			android:textAppearance="?android:attr/textAppearanceMedium"
+	       			android:text="Stream 0"/>
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	        		android:layout_marginLeft="20dip"
+	       			android:textAppearance="?android:attr/textAppearanceSmall"
+	       			android:text="Type: Video\nCodec: MPEG-4 Video (XVID)\nResolution: 640x352\nFrame rate: 25"/>
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	       			android:layout_marginTop="10dip"
+	       			android:layout_marginLeft="5dip"
+	       			android:textAppearance="?android:attr/textAppearanceMedium"
+	       			android:text="Stream 1"/>
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	        		android:layout_marginLeft="20dip"
+	       			android:textAppearance="?android:attr/textAppearanceSmall"
+	       			android:text="Type: Audio\nCodec: MPEG Audio layer 1/2/3 (mpga)\nChannels: Stereo\nSample rate: 48000 Hz\nBitrate: 128 kb/s"/>
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	       			android:layout_marginTop="10dip"
+	       			android:layout_marginLeft="5dip"
+	       			android:textAppearance="?android:attr/textAppearanceMedium"
+	       			android:text="Stream 2"/>	
+	       		<TextView 
+		        	android:layout_height="wrap_content" 
+	        		android:layout_width="wrap_content" 
+	        		android:layout_marginLeft="20dip"
+	       			android:textAppearance="?android:attr/textAppearanceSmall"
+	       			android:text="Type: Subtitle\nCodec: Text subtitles with various tags (subt)"
+	       			android:layout_marginBottom="30dip"/>
+		    </LinearLayout>
+	    </LinearLayout>
+	</FrameLayout>
+</ScrollView>
diff --git a/vlc-android/src/org/videolan/vlc/android/AudioListActivity.java b/vlc-android/src/org/videolan/vlc/android/AudioListActivity.java
index efbf86822b..9619bbfd07 100644
--- a/vlc-android/src/org/videolan/vlc/android/AudioListActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/AudioListActivity.java
@@ -38,20 +38,15 @@ protected void onCreate(Bundle savedInstanceState) {
 
 	private void updateList() {
 		
-		MediaLibraryActivity mediaLibraryActivity = MediaLibraryActivity.getInstance();
-		List<MediaItem> itemList = mediaLibraryActivity.mItemList;
+		List<MediaItem> itemList = MediaLibrary.getInstance().getAudioItems();
+
+		for (MediaItem item : itemList) {
+			HashMap<String,String> listItem = new HashMap<String,String>();
+			listItem.put( "text1", item.getName());
+			listItem.put( "text2", item.getPath());
+			list.add( listItem );
+		}	
 
-		if (itemList.size() > 0) {
-			for (MediaItem item : itemList) {
-				if (item.getType() == MediaItem.TYPE_AUDIO) {
-					HashMap<String,String> listItem = new HashMap<String,String>();
-					listItem.put( "text1", item.getName() );
-					listItem.put( "text2", item.getPath() );
-					list.add( listItem );
-				}
-			}	
-		}
-		
 		mAudioAdapter.notifyDataSetChanged();
 
 	}
diff --git a/vlc-android/src/org/videolan/vlc/android/BrowserActivity.java b/vlc-android/src/org/videolan/vlc/android/BrowserActivity.java
index 8175c9d613..2af1cd9a73 100644
--- a/vlc-android/src/org/videolan/vlc/android/BrowserActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/BrowserActivity.java
@@ -87,7 +87,7 @@ public boolean onKeyDown(int keyCode, KeyEvent event) {
 	@Override
 	protected void onStop() {
 		// Update the MediaList
-		MediaLibraryActivity.getInstance().loadMediaItems();
+		MediaLibrary.getInstance().loadMediaItems();
 		super.onStop();
 	}
 
diff --git a/vlc-android/src/org/videolan/vlc/android/DatabaseManager.java b/vlc-android/src/org/videolan/vlc/android/DatabaseManager.java
index 4b8a09a37c..5aa0a318b4 100644
--- a/vlc-android/src/org/videolan/vlc/android/DatabaseManager.java
+++ b/vlc-android/src/org/videolan/vlc/android/DatabaseManager.java
@@ -64,7 +64,7 @@ private DatabaseManager(Context context) {
 	
 	public synchronized static DatabaseManager getInstance() {
         if (instance == null) {
-        	Context context = MediaLibraryActivity.getInstance();
+        	Context context = MainActivity.getInstance();
             instance = new DatabaseManager(context);
         }
         return instance;
diff --git a/vlc-android/src/org/videolan/vlc/android/MainActivity.java b/vlc-android/src/org/videolan/vlc/android/MainActivity.java
new file mode 100644
index 0000000000..37c1623739
--- /dev/null
+++ b/vlc-android/src/org/videolan/vlc/android/MainActivity.java
@@ -0,0 +1,166 @@
+package org.videolan.vlc.android;
+
+
+import android.app.TabActivity;
+import android.content.Intent;
+import android.os.Bundle;
+import android.os.Handler;
+import android.os.Message;
+import android.util.Log;
+import android.view.Menu;
+import android.view.MenuInflater;
+import android.view.MenuItem;
+import android.view.View;
+import android.widget.ProgressBar;
+import android.widget.TabHost;
+
+public class MainActivity extends TabActivity {
+	public final static String TAG = "VLC/MainActivity";
+
+	protected static final int HIDE_PROGRESSBAR = 0;
+	protected static final int SHOW_PROGRESSBAR = 1;
+	private static final int VIDEO_TAB = 0;
+	private static final int AUDIO_TAB = 1;
+	
+	private VideoListActivity mVideoListActivity;
+	
+	private static MainActivity mInstance;	
+	private ProgressBar mProgressBar;
+	private TabHost mTabHost;
+	private int mCurrentState = 0;
+	
+
+	@Override   
+	protected void onCreate(Bundle savedInstanceState) {	
+		setContentView(R.layout.media_library);	
+		super.onCreate(savedInstanceState); 
+
+		/* Initialize variables */
+		mInstance = this;	
+		mProgressBar = (ProgressBar)findViewById(R.id.ml_progress_bar);
+
+        /* Initialize the TabView */
+        mTabHost = getTabHost();
+        mTabHost.addTab(mTabHost.newTabSpec("VIDEO TAB").setIndicator("VIDEO TAB")
+        		.setContent(new Intent(this, VideoActivityGroup.class)));
+       
+        
+        mTabHost.addTab(mTabHost.newTabSpec("AUDIO TAB").setIndicator("AUDIO TAB")
+        		.setContent(new Intent(this, AudioListActivity.class)));
+        
+        // restore the last used tab
+        mTabHost.setCurrentTab(mCurrentState);
+        
+        /* Load media items from database and storage */
+        MediaLibrary.getInstance().loadMediaItems();
+	}
+
+	/** Create menu from XML 
+	 */
+	@Override
+	public boolean onCreateOptionsMenu(Menu menu) {
+		MenuInflater inflater = getMenuInflater();
+		inflater.inflate(R.menu.media_library, menu);
+		return super.onCreateOptionsMenu(menu);
+	}
+	
+
+	@Override
+	public boolean onSearchRequested() {
+		Intent intent = new Intent(this, SearchActivity.class);
+		startActivity(intent);
+		return false;
+	}
+	
+	@Override
+	public void onBackPressed() {
+		Log.e(TAG, TAG + " onBackPressed()");
+	}
+
+	/**
+	 * Handle onClick form menu buttons
+	 */
+	@Override
+	public boolean onOptionsItemSelected(MenuItem item) {
+		
+		// Intent to start new Activity
+		Intent intent;
+		
+		// Handle item selection
+		switch (item.getItemId()) {
+		// Sort by name
+		case R.id.ml_menu_sortby_name:
+			if (mCurrentState == VIDEO_TAB) {
+				mVideoListActivity.sortBy(
+						VideoListAdapter.SORT_BY_NAME);
+			} 
+			break;
+			// Sort by length
+		case R.id.ml_menu_sortby_length:
+			if (mCurrentState == VIDEO_TAB) {
+				mVideoListActivity.sortBy(
+						VideoListAdapter.SORT_BY_LENGTH);
+			} 
+			break;
+		// About
+		case R.id.ml_menu_about:
+			intent = new Intent(this, AboutActivity.class);
+			startActivity(intent);
+			break;
+		// Preferences
+		case R.id.ml_menu_preferences:
+			intent = new Intent(this, PreferencesActivity.class);
+			startActivity(intent);
+			break;
+		}
+		return super.onOptionsItemSelected(item);
+	}
+
+	/**
+	 * onClick event from xml
+	 * @param view
+	 */
+	public void changeTabClick(View view) {
+		
+		// TODO: change the icon
+		if (mCurrentState == VIDEO_TAB) {
+			mCurrentState = AUDIO_TAB;
+		} else {
+			mCurrentState = VIDEO_TAB;
+		}
+		
+		mTabHost.setCurrentTab(mCurrentState);
+	}
+	
+	
+	/**
+	 * onClick event from xml
+	 * @param view
+	 */
+	public void searchClick(View view) {
+		onSearchRequested();
+	}
+
+	/**
+	 * Get instance e.g. for Context or Handler
+	 * @return this ;)
+	 */
+	protected static MainActivity getInstance() {
+		return mInstance;	
+	}
+	
+	protected Handler mHandler = new Handler() {	
+		@Override
+		public void handleMessage(Message msg) {
+			switch (msg.what) {
+			case SHOW_PROGRESSBAR:
+				mProgressBar.setVisibility(View.VISIBLE);
+				break;
+			case HIDE_PROGRESSBAR:
+				mProgressBar.setVisibility(View.INVISIBLE);	
+				break;
+			}
+		};
+	};
+    
+}
diff --git a/vlc-android/src/org/videolan/vlc/android/MediaInfoActivity.java b/vlc-android/src/org/videolan/vlc/android/MediaInfoActivity.java
new file mode 100644
index 0000000000..857b21491a
--- /dev/null
+++ b/vlc-android/src/org/videolan/vlc/android/MediaInfoActivity.java
@@ -0,0 +1,115 @@
+package org.videolan.vlc.android;
+
+import java.nio.ByteBuffer;
+
+import android.app.Activity;
+import android.graphics.Bitmap;
+import android.graphics.Bitmap.Config;
+import android.os.Bundle;
+import android.os.Handler;
+import android.os.Message;
+import android.util.Log;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+public class MediaInfoActivity extends Activity {
+	public final static String TAG = "VLC/MediaInfoActivity";
+	private MediaItem mItem;
+	private Bitmap mImage;
+	private final static int NEW_IMAGE = 0;
+	
+	@Override
+	protected void onCreate(Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		setContentView(R.layout.media_info);
+		String path = getIntent().getExtras().getString("filePath");
+		if (path == null)
+			return;
+		mItem = MediaLibrary.getInstance().getMediaItem(path);
+				
+		// set title
+		TextView titleView = (TextView)findViewById(R.id.title);
+		titleView.setText(mItem.getName());
+		
+		// set length
+		TextView lengthView = (TextView)findViewById(R.id.length);
+		lengthView.setText(Util.millisToString(mItem.getLength()));
+		
+		new Thread(mLoadImage).start();
+		
+	}
+	
+	@Override
+	public void onBackPressed() {
+		Log.e(TAG, TAG + " onBackPressed()");
+	}
+	
+	Runnable mLoadImage = new Runnable() {	
+		@Override
+		public void run() {
+			LibVLC mLibVlc = null;
+			try {
+				mLibVlc = LibVLC.getInstance();
+			} catch (LibVlcException e) {
+				return;
+			}
+			
+            int width = getWindowManager().getDefaultDisplay().getHeight();
+            int height = width;
+            
+            // Get the thumbnail.
+            mImage = Bitmap.createBitmap(width, height, Config.ARGB_8888);
+
+            byte[] b = mLibVlc.getThumbnail(mItem.getPath(), width, height);
+
+            if (b == null) // We were not able to create a thumbnail for this item.
+            	return;
+
+            
+            mImage.copyPixelsFromBuffer(ByteBuffer.wrap(b));
+            int top = 0;
+            for (int i = 0; i < height; i++) {
+            	int pixel = mImage.getPixel(width/2, i);
+            	if (pixel == 0) {
+            		top = i;
+            	} else {
+            		break;
+            	}
+            }
+            
+            int left = 0;
+            for (int i = 0; i < width; i++) {
+            	int pixel = mImage.getPixel(i, height/2);
+            	if (pixel == 0) {
+            		left = i;
+            	} else {
+            		break;
+            	}
+            }
+            
+            // Cut off the transparency on the borders
+            mImage = Bitmap.createBitmap(mImage, top, left, 
+					(width - (2 * top)), (height - (2 * left)));
+            
+            mHandler.sendEmptyMessage(NEW_IMAGE);
+		}
+	};
+	
+	
+	
+	Handler mHandler = new Handler() {
+		
+		public void handleMessage(Message msg) {
+			switch (msg.what) {
+			case NEW_IMAGE:
+				ImageView imageView = 
+					(ImageView)MediaInfoActivity.this.findViewById(R.id.image);
+				imageView.setImageBitmap(mImage);
+				imageView.setVisibility(ImageView.VISIBLE);
+				break;
+			}
+		};
+		
+	};
+
+}
diff --git a/vlc-android/src/org/videolan/vlc/android/MediaLibrary.java b/vlc-android/src/org/videolan/vlc/android/MediaLibrary.java
new file mode 100644
index 0000000000..8d055af2bd
--- /dev/null
+++ b/vlc-android/src/org/videolan/vlc/android/MediaLibrary.java
@@ -0,0 +1,199 @@
+package org.videolan.vlc.android;
+
+import java.io.File;
+import java.io.FileFilter;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.List;
+import java.util.Stack;
+import java.util.concurrent.BrokenBarrierException;
+import java.util.concurrent.CyclicBarrier;
+
+import android.os.Handler;
+
+
+public class MediaLibrary {
+	public final static String TAG = "VLC/MediaLibrary";
+	
+	protected static final int MEDIA_ITEMS_UPDATED = 100;
+
+	private static MediaLibrary mInstance;
+	private DatabaseManager mDBManager;	
+	private ArrayList<MediaItem> mItemList;
+	private final CyclicBarrier mBarrier = new CyclicBarrier(2);
+	private ArrayList<Handler> mUpdateHandler;
+	
+	private MediaLibrary() {
+		mInstance = this;
+		mItemList = new ArrayList<MediaItem>();
+		mUpdateHandler = new ArrayList<Handler>();
+		mDBManager = DatabaseManager.getInstance();	
+	}
+	
+	public void loadMediaItems() {
+		new Thread(mGetMediaItems).start();
+	}
+	
+
+	public static MediaLibrary getInstance() {
+		if (mInstance == null)
+			mInstance = new MediaLibrary();
+		return mInstance;
+	}
+	
+	public void addUpdateHandler(Handler handler) {
+		mUpdateHandler.add(handler);
+	}
+
+	public ArrayList<MediaItem> getVideoItems() {
+		ArrayList<MediaItem> videoItems = new ArrayList<MediaItem>();
+		for (int i = 0; i < mItemList.size(); i++) {
+			MediaItem item = mItemList.get(i);
+			if (item.getType() == MediaItem.TYPE_VIDEO) {
+				videoItems.add(item);
+			}
+		}
+		return videoItems;
+	}
+	
+	public ArrayList<MediaItem> getAudioItems() {
+		ArrayList<MediaItem> videoItems = new ArrayList<MediaItem>();
+		for (int i = 0; i < mItemList.size(); i++) {
+			MediaItem item = mItemList.get(i);
+			if (item.getType() == MediaItem.TYPE_AUDIO) {
+				videoItems.add(item);
+			}
+		}
+		return videoItems;
+	}
+	
+	public ArrayList<MediaItem> getMediaItems() {
+		return mItemList;
+	}
+	
+	public MediaItem getMediaItem(String path) {
+		for (int i = 0; i < mItemList.size(); i++) {
+			MediaItem item = mItemList.get(i);
+			if (item.getPath().equals(path)) {
+				return item;
+			}
+		}
+		return null;
+	}
+	
+	
+	private final Runnable mGetMediaItems = new Runnable() {
+    	
+    	private Stack<File> directorys = new Stack<File>();
+    	private  MainActivity mMainActivity;
+    	private  Handler mHandler;
+    	
+
+		public void run() {
+			// Initialize variables
+			mMainActivity = MainActivity.getInstance();
+			mHandler = mMainActivity.mHandler;
+			
+			
+			// show progressbar in header
+			mHandler.sendEmptyMessage(MainActivity.SHOW_PROGRESSBAR);	
+			
+			// get directories from database
+			directorys.addAll(mDBManager.getMediaDirs());
+			
+			// get all paths of the existing media items
+			List<File> existingFiles = mDBManager.getMediaItemPaths();
+			
+			// list of all added files
+			List<File> addedFiles = new ArrayList<File>();
+			
+			// clear all old item
+			mItemList.clear();
+			
+	    	MediaItemFilter mediaFileFilter = new MediaItemFilter();
+	    	
+	    	
+	    	while (!directorys.isEmpty()) {
+	    		File dir = directorys.pop();
+	    		File[] f = null;
+	    		if ((f = dir.listFiles(mediaFileFilter)) != null) {		    	  	
+			    	for (int i = 0; i < f.length; i++) {
+			    		if (f[i].isFile()) {
+			    			if (existingFiles.contains(f[i])) {
+			    				
+			    				/** only add file if it is not already in the 
+			    				 * list. eg. if user select an subfolder as well
+			    				 */
+			    				if (!addedFiles.contains(f[i])) {
+				    				// get existing media item from database
+				    				mItemList.add(mDBManager.getMediaItem(
+				    						f[i].getPath()));	
+				    				addedFiles.add( f[i] );
+			    				}
+			    			} else {
+			    				// create new media item
+			    				mItemList.add( new MediaItem( f[i] ));
+			    			}
+			    		} else if (f[i].isDirectory()) {
+			    			directorys.push(f[i]);
+			    		}
+			    	}   
+		    	}
+	    	}
+	    	
+
+	    	
+	    	// update the video and audio activities
+	    	for (int i = 0; i < mUpdateHandler.size(); i++) {
+	    		Handler h = mUpdateHandler.get(i);
+	    		h.sendEmptyMessage(MEDIA_ITEMS_UPDATED);
+	    	}
+	    	
+	    	
+			try {
+				mBarrier.await();
+			} catch (InterruptedException e) {
+				e.printStackTrace();
+			} catch (BrokenBarrierException e) {
+				e.printStackTrace();
+			}
+	    	
+	    	// remove file from database 
+	    	for (int i = 0; i < existingFiles.size(); i++) {
+	    		if (!addedFiles.contains(existingFiles.get(i))) {
+		    		mDBManager.removeMediaItem(
+		    				existingFiles.get(i).getPath());
+	    		}
+	    	}
+	    	// hide progressbar in header
+	    	mHandler.sendEmptyMessage(MainActivity.HIDE_PROGRESSBAR);
+			
+		}
+    };
+
+	
+	/** 
+	 * Filters all irrelevant files 
+	 */
+    private class MediaItemFilter implements FileFilter {
+    	
+    	// FIXME: save extensions in external database
+    	private String[] extensions = MediaItem.EXTENTIONS; 
+		public boolean accept(File f) {
+			boolean accepted = false;
+			if (!f.isHidden()) {
+				if (f.isDirectory()) {
+					accepted = true;
+				} else {
+					String fileName = f.getName().toLowerCase();
+					int dotIndex = fileName.lastIndexOf(".");
+					if (dotIndex != -1) {
+						String fileExt = fileName.substring(dotIndex);
+						accepted = Arrays.asList(extensions).contains(fileExt);
+					}
+				}
+			}
+			return accepted;
+		}   	
+    }
+}
diff --git a/vlc-android/src/org/videolan/vlc/android/MediaLibraryActivity.java b/vlc-android/src/org/videolan/vlc/android/MediaLibraryActivity.java
deleted file mode 100644
index 593d981fe4..0000000000
--- a/vlc-android/src/org/videolan/vlc/android/MediaLibraryActivity.java
+++ /dev/null
@@ -1,287 +0,0 @@
-package org.videolan.vlc.android;
-
-
-import java.io.File;
-import java.io.FileFilter;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.List;
-import java.util.Stack;
-import java.util.concurrent.BrokenBarrierException;
-import java.util.concurrent.CyclicBarrier;
-
-import android.app.TabActivity;
-import android.content.Intent;
-import android.os.Bundle;
-import android.os.Handler;
-import android.os.Message;
-import android.view.Menu;
-import android.view.MenuInflater;
-import android.view.MenuItem;
-import android.view.View;
-import android.widget.ProgressBar;
-import android.widget.TabHost;
-
-public class MediaLibraryActivity extends TabActivity {
-	public final static String TAG = "VLC/MediaLibraryActivity";
-
-	protected static final int HIDE_PROGRESSBAR = 0;
-	protected static final int SHOW_PROGRESSBAR = 1;
-	private static final int VIDEO_TAB = 0;
-	private static final int AUDIO_TAB = 1;
-	
-	private VideoListActivity mVideoListActivity;
-
-	
-	private static MediaLibraryActivity mInstance;	
-	private DatabaseManager mDBManager;	
-	private final CyclicBarrier mBarrier = new CyclicBarrier(2);
-	protected ArrayList<MediaItem> mItemList = new ArrayList<MediaItem>();
-	private ProgressBar mProgressBar;
-	private TabHost mTabHost;
-	private int mCurrentState = 0;
-	
-
-	@Override   
-	protected void onCreate(Bundle savedInstanceState) {	
-		setContentView(R.layout.media_library);	
-		super.onCreate(savedInstanceState); 
-
-		/* Initialize variables */
-		mInstance = this;	
-		mDBManager = DatabaseManager.getInstance();
-		mProgressBar = (ProgressBar)findViewById(R.id.ml_progress_bar);
-
-        /* Initialize the TabView */
-        mTabHost = getTabHost();
-        mTabHost.addTab(mTabHost.newTabSpec("VIDEO TAB").setIndicator("VIDEO TAB")
-        		.setContent(new Intent(this, VideoListActivity.class)));
-        mVideoListActivity = VideoListActivity.getInstance();
-        
-        
-        mTabHost.addTab(mTabHost.newTabSpec("AUDIO TAB").setIndicator("AUDIO TAB")
-        		.setContent(new Intent(this, AudioListActivity.class)));
-        
-        // restore the last used tab
-        mTabHost.setCurrentTab(mCurrentState);
-        
-        /* Load media items from database and storage */
-		loadMediaItems();
-	}
-
-	/** Create menu from XML 
-	 */
-	@Override
-	public boolean onCreateOptionsMenu(Menu menu) {
-		MenuInflater inflater = getMenuInflater();
-		inflater.inflate(R.menu.media_library, menu);
-		return super.onCreateOptionsMenu(menu);
-	}
-	
-
-	@Override
-	public boolean onSearchRequested() {
-		Intent intent = new Intent(this, SearchActivity.class);
-		startActivity(intent);
-		return false;
-	}
-
-	/**
-	 * Handle onClick form menu buttons
-	 */
-	@Override
-	public boolean onOptionsItemSelected(MenuItem item) {
-		
-		// Intent to start new Activity
-		Intent intent;
-		
-		// Handle item selection
-		switch (item.getItemId()) {
-		// Sort by name
-		case R.id.ml_menu_sortby_name:
-			if (mCurrentState == VIDEO_TAB) {
-				mVideoListActivity.sortBy(
-						VideoListAdapter.SORT_BY_NAME);
-			} 
-			break;
-			// Sort by length
-		case R.id.ml_menu_sortby_length:
-			if (mCurrentState == VIDEO_TAB) {
-				mVideoListActivity.sortBy(
-						VideoListAdapter.SORT_BY_LENGTH);
-			} 
-			break;
-		// About
-		case R.id.ml_menu_about:
-			intent = new Intent(this, AboutActivity.class);
-			startActivity(intent);
-			break;
-		// Preferences
-		case R.id.ml_menu_preferences:
-			intent = new Intent(this, PreferencesActivity.class);
-			startActivity(intent);
-			break;
-		}
-		return super.onOptionsItemSelected(item);
-	}
-	
-	
-	/**
-	 * onClick event from xml
-	 * @param view
-	 */
-	public void changeTabClick(View view) {
-		
-		// TODO: change the icon
-		if (mCurrentState == VIDEO_TAB) {
-			mCurrentState = AUDIO_TAB;
-		} else {
-			mCurrentState = VIDEO_TAB;
-		}
-		
-		mTabHost.setCurrentTab(mCurrentState);
-	}
-	
-	
-	/**
-	 * onClick event from xml
-	 * @param view
-	 */
-	public void searchClick(View view) {
-		onSearchRequested();
-	}
-
-	/**
-	 * Get instance e.g. for Context or Handler
-	 * @return this ;)
-	 */
-	protected static MediaLibraryActivity getInstance() {
-		return mInstance;	
-	}
-	
-	
-	
-
-	protected Handler mHandler = new Handler() {	
-		@Override
-		public void handleMessage(Message msg) {
-			switch (msg.what) {
-			case SHOW_PROGRESSBAR:
-				mProgressBar.setVisibility(View.VISIBLE);
-				break;
-			case HIDE_PROGRESSBAR:
-				mProgressBar.setVisibility(View.INVISIBLE);	
-				break;
-			}
-		};
-	};
-
-	public void loadMediaItems() {
-		new Thread(mGetMediaItems).start();
-	}
-	
-	private final Runnable mGetMediaItems = new Runnable() {
-    	
-    	private Stack<File> directorys = new Stack<File>();
-
-		public void run() {
-			// show progressbar in header
-			mHandler.sendEmptyMessage(SHOW_PROGRESSBAR);	
-			
-			// get directories from database
-			directorys.addAll(mDBManager.getMediaDirs());
-			
-			// get all paths of the existing media items
-			List<File> existingFiles = mDBManager.getMediaItemPaths();
-			
-			// list of all added files
-			List<File> addedFiles = new ArrayList<File>();
-			
-			// clear all old item
-			mItemList.clear();
-			
-	    	MediaItemFilter mediaFileFilter = new MediaItemFilter();
-	    	
-	    	
-	    	while (!directorys.isEmpty()) {
-	    		File dir = directorys.pop();
-	    		File[] f = null;
-	    		if ((f = dir.listFiles(mediaFileFilter)) != null) {		    	  	
-			    	for (int i = 0; i < f.length; i++) {
-			    		if (f[i].isFile()) {
-			    			if (existingFiles.contains(f[i])) {
-			    				
-			    				/** only add file if it is not already in the 
-			    				 * list. eg. if user select an subfolder as well
-			    				 */
-			    				if (!addedFiles.contains(f[i])) {
-				    				// get existing media item from database
-				    				mItemList.add(mDBManager.getMediaItem(
-				    						f[i].getPath()));	
-				    				addedFiles.add( f[i] );
-			    				}
-			    			} else {
-			    				// create new media item
-			    				mItemList.add( new MediaItem( f[i] ));
-			    			}
-			    		} else if (f[i].isDirectory()) {
-			    			directorys.push(f[i]);
-			    		}
-			    	}   
-		    	}
-	    	}
-	    	
-	    	
-	    	// update the video and audio activities
-	    	mVideoListActivity.mHandler.sendEmptyMessage(
-	    			VideoListActivity.UPDATE_LIST);
-			try {
-				mBarrier.await();
-			} catch (InterruptedException e) {
-				e.printStackTrace();
-			} catch (BrokenBarrierException e) {
-				e.printStackTrace();
-			}
-	    	
-	    	// remove file from database 
-	    	for (int i = 0; i < existingFiles.size(); i++) {
-	    		if (!addedFiles.contains(existingFiles.get(i))) {
-		    		mDBManager.removeMediaItem(
-		    				existingFiles.get(i).getPath());
-	    		}
-	    	}
-	    	// hide progressbar in header
-	    	mHandler.sendEmptyMessage(HIDE_PROGRESSBAR);
-			
-		}
-    };
-	
-	
-	
-	/** 
-	 * Filters all irrelevant files 
-	 */
-    private class MediaItemFilter implements FileFilter {
-    	
-    	// FIXME: save extensions in external database
-    	private String[] extensions = MediaItem.EXTENTIONS; 
-		public boolean accept(File f) {
-			boolean accepted = false;
-			if (!f.isHidden()) {
-				if (f.isDirectory()) {
-					accepted = true;
-				} else {
-					String fileName = f.getName().toLowerCase();
-					int dotIndex = fileName.lastIndexOf(".");
-					if (dotIndex != -1) {
-						String fileExt = fileName.substring(dotIndex);
-						accepted = Arrays.asList(extensions).contains(fileExt);
-					}
-				}
-			}
-			return accepted;
-		}   	
-    }
-    
-    
-}
diff --git a/vlc-android/src/org/videolan/vlc/android/PreferencesActivity.java b/vlc-android/src/org/videolan/vlc/android/PreferencesActivity.java
index d07b101828..96113b2f23 100644
--- a/vlc-android/src/org/videolan/vlc/android/PreferencesActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/PreferencesActivity.java
@@ -25,7 +25,7 @@ protected void onCreate(Bundle savedInstanceState) {
 				new OnPreferenceClickListener() {
 			
 			public boolean onPreferenceClick(Preference preference) {
-				Intent intent = new Intent(MediaLibraryActivity.getInstance(), 
+				Intent intent = new Intent(MainActivity.getInstance(), 
 						BrowserActivity.class);
 				startActivity(intent);
 				return true;
diff --git a/vlc-android/src/org/videolan/vlc/android/SearchActivity.java b/vlc-android/src/org/videolan/vlc/android/SearchActivity.java
index 2426e3a4bb..c5262e62af 100644
--- a/vlc-android/src/org/videolan/vlc/android/SearchActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/SearchActivity.java
@@ -66,7 +66,7 @@ private void search(CharSequence key, int type) {
     	// set result adapter to the list 
 		mResultAdapter.clear();
 		String[] keys = key.toString().split("\\s+");
-		ArrayList<MediaItem> allItems = MediaLibraryActivity.getInstance().mItemList;
+		ArrayList<MediaItem> allItems = MediaLibrary.getInstance().getMediaItems();
 		int results = 0;
 		for (int i = 0; i < allItems.size(); i++) {
 			MediaItem item = allItems.get(i);
diff --git a/vlc-android/src/org/videolan/vlc/android/ThumbnailerManager.java b/vlc-android/src/org/videolan/vlc/android/ThumbnailerManager.java
index 4433aab1b9..291e5043dd 100644
--- a/vlc-android/src/org/videolan/vlc/android/ThumbnailerManager.java
+++ b/vlc-android/src/org/videolan/vlc/android/ThumbnailerManager.java
@@ -22,12 +22,12 @@ public class ThumbnailerManager extends Thread {
     private final Condition notEmpty = lock.newCondition();
     
     private LibVLC mLibVlc;  
-    private MediaLibraryActivity mMediaLibraryActivity;
+    private MainActivity mMediaLibraryActivity;
     private VideoListActivity mVideoListActivity;
 
     
     public ThumbnailerManager() {
-    	mMediaLibraryActivity = MediaLibraryActivity.getInstance();
+    	mMediaLibraryActivity = MainActivity.getInstance();
     	mVideoListActivity = VideoListActivity.getInstance();
     	try {
 			mLibVlc = LibVLC.getInstance();
@@ -73,7 +73,7 @@ public void run()
             {
                 try {
                 	mMediaLibraryActivity.mHandler.sendEmptyMessage(
-                			MediaLibraryActivity.HIDE_PROGRESSBAR);
+                			MainActivity.HIDE_PROGRESSBAR);
                 	Log.i(TAG, "hide ProgressBar!");
                     notEmpty.await();
                 } catch (InterruptedException e) {
@@ -87,7 +87,7 @@ public void run()
             
             MediaItem item = mItems.poll();
             mMediaLibraryActivity.mHandler.sendEmptyMessage(
-        			MediaLibraryActivity.SHOW_PROGRESSBAR);   
+        			MainActivity.SHOW_PROGRESSBAR);   
             
             Log.i(TAG, "show ProgressBar!");
             
diff --git a/vlc-android/src/org/videolan/vlc/android/Util.java b/vlc-android/src/org/videolan/vlc/android/Util.java
index ee885e9a7b..6147ca58f9 100644
--- a/vlc-android/src/org/videolan/vlc/android/Util.java
+++ b/vlc-android/src/org/videolan/vlc/android/Util.java
@@ -10,7 +10,7 @@ public class Util {
 
 	@Deprecated
     public static void toaster(String message, int duration) {
-        Toast.makeText(MediaLibraryActivity.getInstance(),
+        Toast.makeText(MainActivity.getInstance(),
                        message, duration)
              .show();
     }
@@ -22,7 +22,7 @@ public static void toaster(String message) {
 
     /** Print an on-screen message to alert the user */
     public static void toaster(int stringId, int duration) {
-        Toast.makeText(MediaLibraryActivity.getInstance(),
+        Toast.makeText(MainActivity.getInstance(),
                        stringId, duration)
              .show();
     }
diff --git a/vlc-android/src/org/videolan/vlc/android/VideoActivityGroup.java b/vlc-android/src/org/videolan/vlc/android/VideoActivityGroup.java
new file mode 100644
index 0000000000..5a0edef8ff
--- /dev/null
+++ b/vlc-android/src/org/videolan/vlc/android/VideoActivityGroup.java
@@ -0,0 +1,79 @@
+package org.videolan.vlc.android;
+
+import java.util.ArrayList;
+
+import android.app.Activity;
+import android.app.ActivityGroup;
+import android.app.LocalActivityManager;
+import android.content.Intent;
+import android.os.Bundle;
+import android.util.Log;
+import android.view.Window;
+
+public class VideoActivityGroup extends ActivityGroup {
+	public final static String TAG = "VLC/VideoActivityGroup";
+	
+	private static VideoActivityGroup mInstance;  
+	private ArrayList<String> mHistory;
+	
+	@Override
+	protected void onCreate(Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		this.mHistory = new ArrayList<String>();
+		mInstance = this;
+		
+		// Load VideoListActivity by default
+		Intent intent = new Intent(this, VideoListActivity.class);
+		startChildAcitvity("VideoListActivity", intent);
+	}
+	
+	
+	public void startChildAcitvity(String id, Intent intent) {
+		Window window = getLocalActivityManager().startActivity(
+				id, intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP));
+		if (window != null) {
+			mHistory.add(id);
+			setContentView(window.getDecorView());
+		}
+	}
+
+
+	public static VideoActivityGroup getInstance() {
+		return mInstance;
+	} 
+
+	@Override
+	public void finishFromChild(Activity child) {
+		LocalActivityManager manager = getLocalActivityManager();
+		int index = mHistory.size() - 1;
+
+		if (index > 0) {
+			manager.destroyActivity(mHistory.get(index), true);
+			mHistory.remove(index);
+			index--;
+			String id = mHistory.get(index);
+			Activity activity = manager.getActivity(id);
+			setContentView(activity.getWindow().getDecorView());
+		} else {
+			finish();
+		}
+
+
+	
+		
+	}
+	
+	@Override
+	public void onBackPressed() {
+		int index = mHistory.size()-1;
+		
+		if (index > 0) {
+			getCurrentActivity().finish();
+			return;
+		}
+		super.onBackPressed();
+	}
+
+	
+	
+}
diff --git a/vlc-android/src/org/videolan/vlc/android/VideoListActivity.java b/vlc-android/src/org/videolan/vlc/android/VideoListActivity.java
index af0d975abe..27cbd6989f 100644
--- a/vlc-android/src/org/videolan/vlc/android/VideoListActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/VideoListActivity.java
@@ -26,7 +26,8 @@ public class VideoListActivity extends ListActivity {
 	private static VideoListActivity mInstance;	
 	
 	protected static final int UPDATE_ITEM = 0;
-	protected static final int UPDATE_LIST = 1;
+	
+	private MediaLibrary mMediaLibrary;
 
 	
 	@Override
@@ -39,6 +40,8 @@ protected void onCreate(Bundle savedInstanceState) {
 		mNoFileLayout = (LinearLayout)findViewById(R.id.video_list_empty_nofile);
 		mLoadFileLayout = (LinearLayout)findViewById(R.id.video_list_empty_loadfile);
 		
+		mMediaLibrary = MediaLibrary.getInstance();
+		mMediaLibrary.addUpdateHandler(mHandler);
 		mThumbnailerManager = new ThumbnailerManager();
 		
 		setListAdapter(mVideoAdapter);
@@ -83,7 +86,7 @@ public void handleMessage(Message msg) {
 					e.printStackTrace();
 				}
 				break;
-			case UPDATE_LIST:
+			case MediaLibrary.MEDIA_ITEMS_UPDATED:
 				updateList();
 				break;
 			}
@@ -92,9 +95,9 @@ public void handleMessage(Message msg) {
 	
 	private void updateList() {
 		
-		MediaLibraryActivity mediaLibraryActivity = MediaLibraryActivity.getInstance();
+		MainActivity mainActivity = MainActivity.getInstance();
 		
-		List<MediaItem> itemList = mediaLibraryActivity.mItemList;
+		List<MediaItem> itemList = mMediaLibrary.getVideoItems();
 		
 		mVideoAdapter.clear();
 		
@@ -112,7 +115,7 @@ private void updateList() {
 			mNoFileLayout.setVisibility(View.VISIBLE);
 		}
 		
-		mediaLibraryActivity.mHandler.sendEmptyMessage(MediaLibraryActivity.HIDE_PROGRESSBAR);
+		mainActivity.mHandler.sendEmptyMessage(MainActivity.HIDE_PROGRESSBAR);
 
 	}
 	
diff --git a/vlc-android/src/org/videolan/vlc/android/VideoListAdapter.java b/vlc-android/src/org/videolan/vlc/android/VideoListAdapter.java
index 8147a5a5c5..b0d4e3398d 100644
--- a/vlc-android/src/org/videolan/vlc/android/VideoListAdapter.java
+++ b/vlc-android/src/org/videolan/vlc/android/VideoListAdapter.java
@@ -4,8 +4,10 @@
 import java.util.Comparator;
 
 import android.content.Context;
+import android.content.Intent;
 import android.graphics.Bitmap;
 import android.graphics.BitmapFactory;
+import android.util.Log;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -114,7 +116,7 @@ public View getView(int position, View convertView, ViewGroup parent) {
 		} else {
 			// set default thumbnail
 			thumbnail = BitmapFactory.decodeResource(
-					MediaLibraryActivity.getInstance().getResources(), 
+					MainActivity.getInstance().getResources(), 
 					R.drawable.thumbnail);
 			thumbnailView.setImageBitmap(thumbnail);
 		}
@@ -130,8 +132,10 @@ public View getView(int position, View convertView, ViewGroup parent) {
 		@Override
 		public void onClick(View v) {
 			MediaItem item = (MediaItem)v.getTag();
-			// TODO: show details
-			Util.toaster("show details for: " + item.getName());
+			Intent intent = new Intent(getContext(), MediaInfoActivity.class);
+			intent.putExtra("filePath", item.getPath());
+			VideoActivityGroup group = VideoActivityGroup.getInstance();
+			group.startChildAcitvity("MediaInfo", intent);
 		}
 	};
 	
diff --git a/vlc-android/src/org/videolan/vlc/android/VideoPlayerActivity.java b/vlc-android/src/org/videolan/vlc/android/VideoPlayerActivity.java
index 12de3b9c9c..3fa1d02cc1 100644
--- a/vlc-android/src/org/videolan/vlc/android/VideoPlayerActivity.java
+++ b/vlc-android/src/org/videolan/vlc/android/VideoPlayerActivity.java
@@ -77,7 +77,7 @@ public class VideoPlayerActivity extends Activity {
 	protected void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		setContentView(R.layout.player);
-		mContext = MediaLibraryActivity.getInstance();
+		mContext = MainActivity.getInstance();
 		
 		// stop screen from dimming
 		PowerManager pm = (PowerManager)getSystemService(Context.POWER_SERVICE);
