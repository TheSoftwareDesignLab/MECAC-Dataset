diff --git a/application/resources/src/main/java/org/videolan/resources/VLCInstance.kt b/application/resources/src/main/java/org/videolan/resources/VLCInstance.kt
index 4fc1e71f58..666c91b9bf 100644
--- a/application/resources/src/main/java/org/videolan/resources/VLCInstance.kt
+++ b/application/resources/src/main/java/org/videolan/resources/VLCInstance.kt
@@ -25,15 +25,17 @@ import android.app.Activity
 import android.content.Context
 import android.content.Intent
 import android.util.Log
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.withContext
 import org.videolan.libvlc.FactoryManager
 import org.videolan.libvlc.LibVLC
 import org.videolan.libvlc.interfaces.ILibVLC
 import org.videolan.libvlc.interfaces.ILibVLCFactory
 import org.videolan.libvlc.util.VLCUtil
+import org.videolan.medialibrary.interfaces.Medialibrary
 import org.videolan.resources.VLCInstance.init
 import org.videolan.resources.util.VLCCrashHandler
 import org.videolan.tools.SingletonHolder
-import org.videolan.medialibrary.interfaces.Medialibrary
 
 object VLCInstance : SingletonHolder<ILibVLC, Context>({ init(it.applicationContext) }) {
     const val TAG = "VLC/UiTools/VLCInstance"
@@ -58,7 +60,7 @@ object VLCInstance : SingletonHolder<ILibVLC, Context>({ init(it.applicationCont
     }
 
     @Throws(IllegalStateException::class)
-    fun restart() {
+    suspend fun restart() = withContext(Dispatchers.IO) {
         sLibVLC.release()
         sLibVLC = libVLCFactory.getFromOptions(AppContextProvider.appContext, VLCOptions.libOptions)
         instance = sLibVLC
diff --git a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesActivity.kt b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesActivity.kt
index 291c9a38ee..0caa563c07 100644
--- a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesActivity.kt
+++ b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesActivity.kt
@@ -61,11 +61,6 @@ class PreferencesActivity : BaseTvActivity() {
         }
     }
 
-    fun restartMediaPlayer() {
-        val le = PlaybackService.restartPlayer
-        if (le.hasObservers()) le.value = true
-    }
-
     fun setRestart() {
         setResult(RESULT_RESTART)
     }
diff --git a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAdvanced.kt b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAdvanced.kt
index 2699ebbe5c..c1c315d1f6 100644
--- a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAdvanced.kt
+++ b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAdvanced.kt
@@ -51,6 +51,7 @@ import org.videolan.vlc.gui.DebugLogActivity
 import org.videolan.vlc.gui.dialogs.ConfirmDeleteDialog
 import org.videolan.vlc.gui.dialogs.RenameDialog
 import org.videolan.vlc.gui.helpers.hf.StoragePermissionsDelegate.Companion.getWritePermission
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import org.videolan.vlc.util.FeatureFlag
 import org.videolan.vlc.util.FileUtils
 import org.videolan.vlc.util.deleteAllWatchNext
@@ -235,27 +236,29 @@ class PreferencesAdvanced : BasePreferenceFragment(), SharedPreferences.OnShared
                         activity?.let { Toast.makeText(it, R.string.network_caching_popup, Toast.LENGTH_SHORT).show() }
                     }
                 }
-                restartLibVLC()
+                launch { restartLibVLC() }
             }
             "custom_libvlc_options" -> {
-                try {
-                    VLCInstance.restart()
-                } catch (e: IllegalStateException){
-                    activity?.let { Toast.makeText(it, R.string.custom_libvlc_options_invalid, Toast.LENGTH_LONG).show() }
-                    sharedPreferences.putSingle("custom_libvlc_options", "")
-                } finally {
-                    (activity as? PreferencesActivity)?.restartMediaPlayer()
+                launch {
+                    try {
+                        VLCInstance.restart()
+                    } catch (e: IllegalStateException) {
+                        activity?.let { Toast.makeText(it, R.string.custom_libvlc_options_invalid, Toast.LENGTH_LONG).show() }
+                        sharedPreferences.putSingle("custom_libvlc_options", "")
+                    } finally {
+                        restartMediaPlayer()
+                    }
+                    restartLibVLC()
                 }
-                restartLibVLC()
             }
             "opengl", "deblocking", "enable_frame_skip", "enable_time_stretching_audio", "enable_verbose_mode", "prefer_smbv1" -> {
-                restartLibVLC()
+                launch { restartLibVLC() }
             }
         }
     }
 
-    private fun restartLibVLC() {
+    private suspend fun restartLibVLC() {
         VLCInstance.restart()
-        (activity as? PreferencesActivity)?.restartMediaPlayer()
+        restartMediaPlayer()
     }
 }
diff --git a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAudio.kt b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAudio.kt
index 608f5fcba3..2f71504ad2 100644
--- a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAudio.kt
+++ b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesAudio.kt
@@ -34,6 +34,9 @@ import androidx.preference.CheckBoxPreference
 import androidx.preference.EditTextPreference
 import androidx.preference.ListPreference
 import androidx.preference.Preference
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.MainScope
+import kotlinx.coroutines.launch
 import org.videolan.libvlc.util.AndroidUtil
 import org.videolan.libvlc.util.HWDecoderUtil
 import org.videolan.resources.VLCInstance
@@ -43,6 +46,7 @@ import org.videolan.tools.RESUME_PLAYBACK
 import org.videolan.tools.Settings
 import org.videolan.vlc.BuildConfig
 import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import org.videolan.vlc.util.LocaleUtil
 import java.text.DecimalFormat
 import java.text.DecimalFormatSymbols
@@ -52,7 +56,7 @@ private const val TAG = "VLC/PreferencesAudio"
 
 @Suppress("DEPRECATION")
 @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)
-class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener {
+class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener, CoroutineScope by MainScope() {
 
     private lateinit var preferredAudioTrack: ListPreference
 
@@ -122,14 +126,14 @@ class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPre
     override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences, key: String) {
         when (key) {
             "aout" -> {
-                restartLibVLC()
+                launch { restartLibVLC() }
                 val opensles = "1" == preferenceManager.sharedPreferences.getString("aout", "0")
                 if (opensles) findPreference<CheckBoxPreference>("audio_digital_output")?.isChecked = false
                 findPreference<Preference>("audio_digital_output")?.isVisible = !opensles
             }
             "audio_digital_output" -> updatePassThroughSummary()
             "audio_preferred_language" -> updatePreferredAudioTrack()
-            "audio-replay-gain-enable", "audio-replay-gain-mode", "audio-replay-gain-peak-protection" -> restartLibVLC()
+            "audio-replay-gain-enable", "audio-replay-gain-mode", "audio-replay-gain-peak-protection" -> launch { restartLibVLC() }
             "audio-replay-gain-default", "audio-replay-gain-preamp" -> {
                 val defValue = if (key == "audio-replay-gain-default") "-7.0" else "0.0"
                 val newValue = sharedPreferences.getString(key, defValue)
@@ -145,15 +149,15 @@ class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPre
                             putString(key, fmtValue)
                             findPreference<EditTextPreference>(key)?.let { it.text = fmtValue }
                         }
-                    } else restartLibVLC()
+                    } else launch { restartLibVLC() }
                 }
             }
         }
     }
 
-    private fun restartLibVLC() {
+    private suspend fun restartLibVLC() {
         VLCInstance.restart()
-        if (activity != null) (activity as PreferencesActivity).restartMediaPlayer()
+        restartMediaPlayer()
     }
 
     private fun prepareLocaleList() {
diff --git a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesSubtitles.kt b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesSubtitles.kt
index 00ad21540d..aa7a06e2ae 100644
--- a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesSubtitles.kt
+++ b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesSubtitles.kt
@@ -32,6 +32,9 @@ import android.util.Log
 import androidx.preference.ListPreference
 import androidx.preference.SeekBarPreference
 import com.jaredrummler.android.colorpicker.ColorPreferenceCompat
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.MainScope
+import kotlinx.coroutines.launch
 import org.videolan.resources.VLCInstance
 import org.videolan.television.ui.COLOR_PICKER_SELECTED_COLOR
 import org.videolan.television.ui.COLOR_PICKER_TITLE
@@ -40,13 +43,14 @@ import org.videolan.tools.LocaleUtils
 import org.videolan.tools.Settings
 import org.videolan.vlc.BuildConfig
 import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 
 private const val SUBTITLE_COLOR_RESULT = 1
 private const val SUBTITLE_BACKGROUND_COLOR_RESULT = 2
 private const val SUBTITLE_SHADOW_COLOR_RESULT = 3
 private const val SUBTITLE_OUTLINE_COLOR_RESULT = 4
 @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)
-class PreferencesSubtitles : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener {
+class PreferencesSubtitles : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener, CoroutineScope by MainScope() {
 
     private lateinit var settings: SharedPreferences
     private lateinit var preferredSubtitleTrack: ListPreference
@@ -157,9 +161,10 @@ class PreferencesSubtitles : BasePreferenceFragment(), SharedPreferences.OnShare
             "subtitles_background_color", "subtitles_background_color_opacity", "subtitles_background",
             "subtitles_outline", "subtitles_outline_size", "subtitles_outline_color", "subtitles_outline_color_opacity",
             "subtitles_shadow", "subtitles_shadow_color", "subtitles_shadow_color_opacity" -> {
-                VLCInstance.restart()
-                if (activity != null)
-                    (activity as PreferencesActivity).restartMediaPlayer()
+                launch {
+                    VLCInstance.restart()
+                    restartMediaPlayer()
+                }
                 managePreferenceVisibilities()
             }
             "subtitle_preferred_language" -> updatePreferredSubtitleTrack()
diff --git a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesVideo.kt b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesVideo.kt
index b8700d21a0..f3e1165207 100644
--- a/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesVideo.kt
+++ b/application/television/src/main/java/org/videolan/television/ui/preferences/PreferencesVideo.kt
@@ -27,15 +27,18 @@ import android.content.SharedPreferences
 import android.os.Build
 import android.os.Bundle
 import androidx.preference.Preference
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.MainScope
+import kotlinx.coroutines.launch
 import org.videolan.resources.VLCInstance
 import org.videolan.tools.LOCK_USE_SENSOR
 import org.videolan.tools.POPUP_FORCE_LEGACY
 import org.videolan.tools.SAVE_BRIGHTNESS
 import org.videolan.vlc.R
-import org.videolan.vlc.gui.preferences.PreferencesActivity
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 
 @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)
-class PreferencesVideo : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener {
+class PreferencesVideo : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener, CoroutineScope by MainScope() {
 
     override fun getXml() = R.xml.preferences_video
 
@@ -66,8 +69,10 @@ class PreferencesVideo : BasePreferenceFragment(), SharedPreferences.OnSharedPre
     override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences, key: String) {
         when (key) {
             "preferred_resolution" -> {
-                VLCInstance.restart()
-                (activity as? PreferencesActivity)?.restartMediaPlayer()
+                launch {
+                    VLCInstance.restart()
+                    restartMediaPlayer()
+                }
             }
         }
     }
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/helpers/PreferenceUtils.kt b/application/vlc-android/src/org/videolan/vlc/gui/helpers/PreferenceUtils.kt
new file mode 100644
index 0000000000..e783b98abd
--- /dev/null
+++ b/application/vlc-android/src/org/videolan/vlc/gui/helpers/PreferenceUtils.kt
@@ -0,0 +1,35 @@
+/*
+ * ************************************************************************
+ *  PreferenceUtils.kt
+ * *************************************************************************
+ * Copyright Â© 2022 VLC authors and VideoLAN
+ * Author: Nicolas POMEPUY
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ * **************************************************************************
+ *
+ *
+ */
+
+package org.videolan.vlc.gui.helpers
+
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.withContext
+import org.videolan.vlc.PlaybackService
+
+
+suspend fun restartMediaPlayer() = withContext(Dispatchers.Main) {
+    val le = PlaybackService.restartPlayer
+    if (le.hasObservers()) le.value = true
+}
\ No newline at end of file
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesActivity.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesActivity.kt
index 824fecc0b2..ec1c2cbe11 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesActivity.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesActivity.kt
@@ -101,11 +101,6 @@ class PreferencesActivity : BaseActivity() {
 
     }
 
-    fun restartMediaPlayer() {
-        val le = PlaybackService.restartPlayer
-        if (le.hasObservers()) le.value = true
-    }
-
     fun exitAndRescan() {
         setRestart()
         val intent = intent
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAdvanced.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAdvanced.kt
index bfc37bcfc6..cc31231315 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAdvanced.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAdvanced.kt
@@ -55,6 +55,7 @@ import org.videolan.vlc.gui.dialogs.RenameDialog
 import org.videolan.vlc.gui.helpers.MedialibraryUtils
 import org.videolan.vlc.gui.helpers.UiTools
 import org.videolan.vlc.gui.helpers.hf.StoragePermissionsDelegate.Companion.getWritePermission
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import org.videolan.vlc.util.FeatureFlag
 import org.videolan.vlc.util.FileUtils
 import org.videolan.vlc.util.share
@@ -240,32 +241,34 @@ class PreferencesAdvanced : BasePreferenceFragment(), SharedPreferences.OnShared
                         UiTools.snacker(requireActivity(), R.string.network_caching_popup)
                     }
                 }
-                restartLibVLC()
+                lifecycleScope.launch { restartLibVLC() }
             }
             // No break because need VLCInstance.restart();
             "custom_libvlc_options" -> {
-                try {
-                    VLCInstance.restart()
-                } catch (e: IllegalStateException){
-                    UiTools.snacker(requireActivity(), R.string.custom_libvlc_options_invalid)
-                    sharedPreferences.putSingle("custom_libvlc_options", "")
-                } finally {
-                    (activity as? PreferencesActivity)?.restartMediaPlayer()
+                lifecycleScope.launch {
+                    try {
+                        VLCInstance.restart()
+                    } catch (e: IllegalStateException) {
+                        UiTools.snacker(requireActivity(), R.string.custom_libvlc_options_invalid)
+                        sharedPreferences.putSingle("custom_libvlc_options", "")
+                    } finally {
+                        restartMediaPlayer()
+                    }
+                    restartLibVLC()
                 }
-                restartLibVLC()
             }
             "opengl", "deblocking", "enable_frame_skip", "enable_time_stretching_audio", "enable_verbose_mode" -> {
-                restartLibVLC()
+                lifecycleScope.launch { restartLibVLC() }
             }
             "prefer_smbv1" -> {
-                VLCInstance.restart()
+                lifecycleScope.launch { VLCInstance.restart() }
                 UiTools.restartDialog(requireActivity())
             }
         }
     }
 
-    private fun restartLibVLC() {
+    private suspend fun restartLibVLC() {
         VLCInstance.restart()
-        (activity as? PreferencesActivity)?.restartMediaPlayer()
+        restartMediaPlayer()
     }
 }
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAudio.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAudio.kt
index 61790a585a..368de965df 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAudio.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesAudio.kt
@@ -47,6 +47,7 @@ import org.videolan.vlc.gui.browser.EXTRA_MRL
 import org.videolan.vlc.gui.browser.FilePickerActivity
 import org.videolan.vlc.gui.browser.KEY_PICKER_TYPE
 import org.videolan.vlc.gui.helpers.UiTools
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import org.videolan.vlc.media.MediaUtils
 import org.videolan.vlc.providers.PickerType
 import org.videolan.vlc.util.LocaleUtil
@@ -135,8 +136,8 @@ class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPre
             if (data.hasExtra(EXTRA_MRL)) {
                 lifecycleScope.launch {
                     MediaUtils.useAsSoundFont(requireActivity(), Uri.parse(data.getStringExtra(EXTRA_MRL)))
+                    VLCInstance.restart()
                 }
-                VLCInstance.restart()
                 UiTools.restartDialog(requireActivity())
             }
         }
@@ -146,14 +147,14 @@ class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPre
         if (activity == null) return
         when (key) {
             "aout" -> {
-                restartLibVLC()
+                lifecycleScope.launch { restartLibVLC() }
                 val opensles = "1" == preferenceManager.sharedPreferences.getString("aout", "0")
                 if (opensles) findPreference<CheckBoxPreference>("audio_digital_output")?.isChecked = false
                 findPreference<Preference>("audio_digital_output")?.isVisible = !opensles
             }
             "audio_digital_output" -> updatePassThroughSummary()
             "audio_preferred_language" -> updatePreferredAudioTrack()
-            "audio-replay-gain-enable", "audio-replay-gain-mode", "audio-replay-gain-peak-protection" -> restartLibVLC()
+            "audio-replay-gain-enable", "audio-replay-gain-mode", "audio-replay-gain-peak-protection" -> lifecycleScope.launch { restartLibVLC() }
             "audio-replay-gain-default", "audio-replay-gain-preamp" -> {
                 val defValue = if (key == "audio-replay-gain-default") "-7.0" else "0.0"
                 val newValue = sharedPreferences.getString(key, defValue)
@@ -169,15 +170,15 @@ class PreferencesAudio : BasePreferenceFragment(), SharedPreferences.OnSharedPre
                             putString(key, fmtValue)
                             findPreference<EditTextPreference>(key)?.let { it.text = fmtValue }
                         }
-                    } else restartLibVLC()
+                    } else lifecycleScope.launch { restartLibVLC() }
                 }
             }
         }
     }
 
-    private fun restartLibVLC() {
+    private suspend fun restartLibVLC() {
         VLCInstance.restart()
-        (activity as? PreferencesActivity)?.restartMediaPlayer()
+        restartMediaPlayer()
     }
 
     private fun prepareLocaleList() {
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesCasting.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesCasting.kt
index 4b2abadb2a..89774d3b9d 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesCasting.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesCasting.kt
@@ -24,9 +24,12 @@ package org.videolan.vlc.gui.preferences
 
 import android.content.SharedPreferences
 import android.os.Bundle
+import androidx.lifecycle.lifecycleScope
 import androidx.preference.Preference
-import org.videolan.vlc.R
+import kotlinx.coroutines.launch
 import org.videolan.resources.VLCInstance
+import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 
 class PreferencesCasting : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener {
 
@@ -51,8 +54,10 @@ class PreferencesCasting : BasePreferenceFragment(), SharedPreferences.OnSharedP
     override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences?, key: String?) {
         when (key) {
             "casting_passthrough", "casting_quality" -> {
-                VLCInstance.restart()
-                (activity as? PreferencesActivity)?.restartMediaPlayer()
+                lifecycleScope.launch {
+                    VLCInstance.restart()
+                    restartMediaPlayer()
+                }
             }
         }
     }
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesSubtitles.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesSubtitles.kt
index 47450b2124..6ec0b8b433 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesSubtitles.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesSubtitles.kt
@@ -24,14 +24,17 @@ package org.videolan.vlc.gui.preferences
 
 import android.content.SharedPreferences
 import android.os.Bundle
+import androidx.lifecycle.lifecycleScope
 import androidx.preference.ListPreference
 import androidx.preference.SeekBarPreference
 import com.jaredrummler.android.colorpicker.ColorPreferenceCompat
+import kotlinx.coroutines.launch
 import org.videolan.resources.VLCInstance
 import org.videolan.tools.LocaleUtils
 import org.videolan.tools.Settings
 import org.videolan.vlc.BuildConfig
 import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 
 class PreferencesSubtitles : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener {
 
@@ -104,9 +107,10 @@ class PreferencesSubtitles : BasePreferenceFragment(), SharedPreferences.OnShare
             "subtitles_background_color", "subtitles_background_color_opacity", "subtitles_background",
             "subtitles_outline", "subtitles_outline_size", "subtitles_outline_color", "subtitles_outline_color_opacity",
             "subtitles_shadow", "subtitles_shadow_color", "subtitles_shadow_color_opacity" -> {
-                VLCInstance.restart()
-                if (activity != null)
-                    (activity as PreferencesActivity).restartMediaPlayer()
+                lifecycleScope.launch {
+                    VLCInstance.restart()
+                    restartMediaPlayer()
+                }
                 managePreferenceVisibilities()
             }
             "subtitle_preferred_language" -> updatePreferredSubtitleTrack()
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesVideo.kt b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesVideo.kt
index 4b12e7d94d..5f1a6eeecb 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesVideo.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/preferences/PreferencesVideo.kt
@@ -24,11 +24,14 @@ package org.videolan.vlc.gui.preferences
 
 import android.content.SharedPreferences
 import android.os.Bundle
+import androidx.lifecycle.lifecycleScope
 import androidx.preference.Preference
+import kotlinx.coroutines.launch
 import org.videolan.libvlc.util.AndroidUtil
 import org.videolan.resources.VLCInstance
 import org.videolan.tools.POPUP_FORCE_LEGACY
 import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import org.videolan.vlc.util.Permissions
 
 class PreferencesVideo : BasePreferenceFragment(), SharedPreferences.OnSharedPreferenceChangeListener  {
@@ -56,8 +59,10 @@ class PreferencesVideo : BasePreferenceFragment(), SharedPreferences.OnSharedPre
     override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences, key: String) {
         when (key) {
             "preferred_resolution" -> {
-                VLCInstance.restart()
-                (activity as? PreferencesActivity)?.restartMediaPlayer()
+                lifecycleScope.launch {
+                    VLCInstance.restart()
+                    restartMediaPlayer()
+                }
             }
             POPUP_FORCE_LEGACY -> {
                 if (sharedPreferences.getBoolean(key, false) && !Permissions.canDrawOverlays(requireActivity())) Permissions.checkDrawOverlaysPermission(requireActivity())
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/video/benchmark/BenchActivity.kt b/application/vlc-android/src/org/videolan/vlc/gui/video/benchmark/BenchActivity.kt
index eef21071a4..2a2537c08c 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/video/benchmark/BenchActivity.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/video/benchmark/BenchActivity.kt
@@ -33,6 +33,7 @@ import android.support.v4.media.session.PlaybackStateCompat
 import android.util.Log
 import android.view.View
 import androidx.core.content.edit
+import androidx.lifecycle.lifecycleScope
 import kotlinx.coroutines.Dispatchers
 import kotlinx.coroutines.launch
 import org.videolan.libvlc.MediaPlayer
@@ -41,6 +42,7 @@ import org.videolan.tools.AppScope
 import org.videolan.tools.Settings
 import org.videolan.vlc.PlaybackService
 import org.videolan.vlc.R
+import org.videolan.vlc.gui.helpers.restartMediaPlayer
 import java.io.*
 
 /**
@@ -138,8 +140,10 @@ class BenchActivity : ShallowVideoPlayer() {
                     putBoolean(PREFERENCE_PLAYBACK_HISTORY, false)
                 }
             }
-            VLCInstance.restart()
-            this.service?.restartMediaPlayer()
+            lifecycleScope.launch {
+                VLCInstance.restart()
+                restartMediaPlayer()
+            }
         }
     }
 
@@ -553,8 +557,8 @@ class BenchActivity : ShallowVideoPlayer() {
                     putString(PREFERENCE_OPENGL, oldOpenglValue)
                     putBoolean(PREFERENCE_PLAYBACK_HISTORY, oldHistoryBoolean)
                 }
+                VLCInstance.restart()
             }
-            VLCInstance.restart()
         }
         /* Case of error in VideoPlayerActivity, then finish is not overridden */
         if (hasVLCFailed) {
