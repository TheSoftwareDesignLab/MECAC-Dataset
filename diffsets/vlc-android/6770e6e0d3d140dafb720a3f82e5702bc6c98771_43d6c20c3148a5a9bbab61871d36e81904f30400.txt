diff --git a/application/resources/src/main/res/values/strings.xml b/application/resources/src/main/res/values/strings.xml
index 5e76d1f264..80d2277a1e 100644
--- a/application/resources/src/main/res/values/strings.xml
+++ b/application/resources/src/main/res/values/strings.xml
@@ -810,7 +810,8 @@
     <string name="light_theme">Light theme</string>
     <string name="add">Add</string>
     <string name="add_to_new_playlist">Add to new playlist</string>
-    <string name="add_to_new_or_selected_playlist">Add to new or selected playlist</string>
+    <string name="create_new_playlist">Create new playlist</string>
+    <string name="create">Create</string>
     <string name="resume_card_message">Resume playback of %1$s?</string>
     <string name="misc">Miscellaneous</string>
     <string name="popup_force_legacy_title">Use custom Picture-in-Picture popup</string>
@@ -1027,7 +1028,6 @@
     <string name="stop_unpaubale">This media cannot be paused. Stop it instead?</string>
     <string name="delete_forever">Delete forever</string>
     <string name="add_to_existing_playlist">Add to existing playlist</string>
-    <string name="select_existing_playlist">Select existing playlist</string>
     <string name="bookmarks_title">Bookmarks</string>
     <string name="no_bookmark">No bookmark set</string>
     <string name="bookmark_default_name">Bookmark at %s</string>
@@ -1072,11 +1072,11 @@
     <string name="banned">Banned folder (long tap to change)</string>
     <string name="banned_tv">Banned folder</string>
     <string name="banned_parent">Banned by parent folder</string>
-    <plurals name="duplication_two_options_secondary">
+    <plurals name="duplicate_two_options_secondary">
         <item quantity="one">This item is already in \"%s\" playlist.</item>
         <item quantity="other">These items are already in \"%s\" playlist.</item>
     </plurals>
-    <plurals name="duplication_three_options_secondary">
+    <plurals name="duplicate_three_options_secondary">
         <item quantity="one">1 of the selected items is already in \"%s\" playlist.</item>
         <item quantity="other">%d of the selected items are already in \"%s\" playlist.</item>
     </plurals>
diff --git a/application/vlc-android/res/layout/dialog_playlist.xml b/application/vlc-android/res/layout/dialog_playlist.xml
index c67291f36a..2645f1dfb9 100644
--- a/application/vlc-android/res/layout/dialog_playlist.xml
+++ b/application/vlc-android/res/layout/dialog_playlist.xml
@@ -16,16 +16,21 @@
                 type="Boolean" />
     </data>
 
-    <androidx.core.widget.NestedScrollView
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:orientation="vertical">
+
+        <androidx.core.widget.NestedScrollView
             android:layout_width="match_parent"
-            android:layout_height="match_parent">
+            android:layout_height="match_parent"
+            android:layout_weight="1">
 
-        <androidx.constraintlayout.widget.ConstraintLayout
+            <androidx.constraintlayout.widget.ConstraintLayout
                 android:layout_width="match_parent"
                 android:layout_height="match_parent">
 
-
-            <TextView
+                <TextView
                     android:id="@+id/textView9"
                     style="@style/Theme.VLC.BottomSheetTitle"
                     android:layout_width="0dp"
@@ -33,45 +38,46 @@
                     android:layout_marginStart="8dp"
                     android:layout_marginTop="8dp"
                     android:minHeight="0dp"
-                    android:text="@string/add_to_new_playlist"
+                    android:text="@string/create_new_playlist"
                     app:layout_constraintStart_toStartOf="parent"
                     app:layout_constraintTop_toTopOf="parent" />
 
-            <TextView
-                    android:id="@+id/medias2"
-                    android:layout_width="wrap_content"
-                    android:layout_height="wrap_content"
-                    android:layout_marginStart="8dp"
-                    android:fontFamily="sans-serif-light"
-                    android:text="@{filesText}"
-                    android:textSize="12sp"
-                    android:visibility="@{isLoading ? View.GONE : View.VISIBLE}"
-                    app:layout_constraintStart_toStartOf="parent"
-                    app:layout_constraintTop_toBottomOf="@+id/textView9"
-                    tools:text="65 medias" />
 
-            <com.google.android.material.textfield.TextInputLayout
+                <com.google.android.material.textfield.TextInputLayout
                     android:id="@+id/dialog_playlist_name"
+                    style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox.Dense"
                     android:layout_width="0dp"
                     android:layout_height="wrap_content"
                     android:layout_marginStart="8dp"
                     android:layout_marginTop="8dp"
                     android:layout_marginEnd="8dp"
-                    app:layout_constraintEnd_toStartOf="@+id/dialog_playlist_save"
-                        style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox.Dense"
+                    app:layout_constraintEnd_toStartOf="@+id/dialog_playlist_create"
                     app:layout_constraintStart_toStartOf="parent"
-                    app:layout_constraintTop_toBottomOf="@+id/medias2">
+                    app:layout_constraintTop_toBottomOf="@+id/textView9">
 
-                <com.google.android.material.textfield.TextInputEditText
+                    <com.google.android.material.textfield.TextInputEditText
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
                         android:layout_alignParentTop="true"
                         android:hint="@string/playlist_name_hint"
                         android:imeOptions="actionSend"
                         android:inputType="text" />
-            </com.google.android.material.textfield.TextInputLayout>
+                </com.google.android.material.textfield.TextInputLayout>
+
+                <Button
+                    android:id="@+id/dialog_playlist_create"
+                    style="@style/Widget.MaterialComponents.Button.TextButton.Dialog"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:layout_below="@+id/dialog_playlist_name"
+                    android:layout_alignParentEnd="true"
+                    android:layout_marginEnd="8dp"
+                    android:enabled="@{!isLoading}"
+                    android:text="@string/create"
+                    app:layout_constraintBaseline_toBaselineOf="@+id/dialog_playlist_name"
+                    app:layout_constraintEnd_toEndOf="parent" />
 
-            <TextView
+                <TextView
                     android:id="@+id/selected_playlist_count"
                     style="@style/Theme.VLC.BottomSheetTitle"
                     android:layout_width="0dp"
@@ -79,11 +85,11 @@
                     android:layout_marginStart="8dp"
                     android:layout_marginTop="24dp"
                     android:minHeight="0dp"
-                    android:text="@string/select_existing_playlist"
+                    android:text="@string/add_to_existing_playlist"
                     app:layout_constraintStart_toStartOf="parent"
                     app:layout_constraintTop_toBottomOf="@+id/dialog_playlist_name" />
 
-            <TextView
+                <TextView
                     android:id="@+id/medias"
                     android:layout_width="wrap_content"
                     android:layout_height="wrap_content"
@@ -96,7 +102,7 @@
                     app:layout_constraintTop_toBottomOf="@+id/selected_playlist_count"
                     tools:text="65 medias" />
 
-            <ProgressBar
+                <ProgressBar
                     android:id="@+id/progressBar2"
                     style="?android:attr/progressBarStyle"
                     android:layout_width="32dp"
@@ -107,7 +113,7 @@
                     app:layout_constraintStart_toEndOf="@+id/selected_playlist_count"
                     app:layout_constraintTop_toTopOf="@+id/selected_playlist_count" />
 
-            <androidx.appcompat.widget.SwitchCompat
+                <androidx.appcompat.widget.SwitchCompat
                     android:id="@+id/replaceSwitch"
                     android:layout_width="0dp"
                     android:layout_height="wrap_content"
@@ -118,42 +124,44 @@
                     app:layout_constraintStart_toStartOf="parent"
                     app:layout_constraintTop_toBottomOf="@+id/medias" />
 
-            <FrameLayout
+                <FrameLayout
                     android:id="@+id/dialog_list_container"
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
                     android:layout_marginTop="16dp"
-                    app:layout_constraintBottom_toBottomOf="parent"
+
                     app:layout_constraintEnd_toEndOf="parent"
                     app:layout_constraintStart_toStartOf="parent"
                     app:layout_constraintTop_toBottomOf="@+id/replaceSwitch">
 
-                <androidx.recyclerview.widget.RecyclerView
+                    <androidx.recyclerview.widget.RecyclerView
                         android:id="@android:id/list"
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content" />
 
-                <TextView
+                    <TextView
                         android:id="@android:id/empty"
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
                         android:gravity="center_horizontal"
                         android:text="@string/noplaylist" />
-            </FrameLayout>
+                </FrameLayout>
 
-            <Button
-                    android:id="@+id/dialog_playlist_save"
-                    style="@style/Widget.MaterialComponents.Button.TextButton.Dialog"
-                    android:layout_width="wrap_content"
-                    android:layout_height="wrap_content"
-                    android:layout_below="@+id/dialog_playlist_name"
-                    android:layout_alignParentEnd="true"
-                    android:layout_marginEnd="8dp"
-                    android:enabled="@{!isLoading}"
-                    android:text="@string/add"
-                    app:layout_constraintBaseline_toBaselineOf="@+id/dialog_playlist_name"
-                    app:layout_constraintEnd_toEndOf="parent" />
-        </androidx.constraintlayout.widget.ConstraintLayout>
 
-    </androidx.core.widget.NestedScrollView>
+            </androidx.constraintlayout.widget.ConstraintLayout>
+
+        </androidx.core.widget.NestedScrollView>
+
+        <Button
+            android:id="@+id/dialog_playlist_save"
+            style="@style/Widget.MaterialComponents.Button.TextButton.Dialog"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginEnd="8dp"
+            android:enabled="@{!isLoading}"
+            android:text="@string/add"
+            android:layout_gravity="center"
+            android:gravity="center" />
+
+    </LinearLayout>
 </layout>
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/dialogs/DuplicationWarningDialog.kt b/application/vlc-android/src/org/videolan/vlc/gui/dialogs/DuplicationWarningDialog.kt
index 1246d833a1..f1dd0d10f2 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/dialogs/DuplicationWarningDialog.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/dialogs/DuplicationWarningDialog.kt
@@ -25,21 +25,22 @@ class DuplicationWarningDialog : VLCBottomSheetDialogFragment(), View.OnClickLis
 
     private lateinit var binding: DialogDuplicationWarningBinding
 
-    private var duplicatesCount: Int = 0
-    private var highlightsCount: Int = 0
-    private var playlistTitle: String = ""
+    private var duplicationMessages: ArrayList<String> = arrayListOf()
+    private var finalMessage: SpannableString = SpannableString("")
+    private var playlistTitles: ArrayList<String> = arrayListOf()
+    private var shouldShowThreeOptions: Boolean = false
 
     override fun initialFocusedView(): View {
-        return if (shouldShowThreeOptions())
-                    binding.addNewButton
-                else
-                    binding.cancelButton
+        return if (shouldShowThreeOptions)
+            binding.addNewButton
+        else
+            binding.cancelButton
     }
 
     override fun onCreate(savedInstanceState: Bundle?) {
-        highlightsCount = arguments?.getInt(HIGHLIGHT_KEY)!!
-        duplicatesCount = arguments?.getInt(DUPLICATION_KEY)!!
-        playlistTitle = arguments?.getString(TITLE_KEY)!!
+        duplicationMessages = arguments?.getStringArrayList(DUPLICATION_MESSAGES_KEY)!!
+        shouldShowThreeOptions = arguments?.getBoolean(SHOW_OPTIONS_KEY)!!
+        playlistTitles = arguments?.getStringArrayList(TITLE_KEY)!!
         super.onCreate(savedInstanceState)
     }
 
@@ -50,26 +51,20 @@ class DuplicationWarningDialog : VLCBottomSheetDialogFragment(), View.OnClickLis
 
     override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
         super.onViewCreated(view, savedInstanceState)
-        if (shouldShowThreeOptions()) {
+        if (shouldShowThreeOptions) {
             binding.addAllButton.setOnClickListener(this)
             binding.addNewButton.setOnClickListener(this)
             binding.cancelButton.setOnClickListener(this)
-            val pluralSecondary = R.plurals.duplication_three_options_secondary
-            val secondaryMessage = if (duplicatesCount == 1)
-                resources.getQuantityString(pluralSecondary, duplicatesCount,playlistTitle)
-            else
-                resources.getQuantityString(pluralSecondary, duplicatesCount,duplicatesCount,playlistTitle)
-            setupSecondaryText(secondaryMessage)
         } else {
             binding.addNewButton.visibility = View.GONE
             binding.addAllButton.text = resources.getString(R.string.add_button)
             binding.addAllButton.setOnClickListener(this)
             binding.cancelButton.setOnClickListener(this)
-            val pluralSecondary = R.plurals.duplication_two_options_secondary
-            val secondaryMessage = resources.getQuantityString(pluralSecondary, duplicatesCount,playlistTitle)
-
-            setupSecondaryText(secondaryMessage)
         }
+        for (i in 0 until duplicationMessages.size) {
+            setupSecondaryText(duplicationMessages[i], playlistTitles[i])
+        }
+        binding.secondaryTextview.text = finalMessage
     }
 
     override fun onClick(view: View) {
@@ -92,17 +87,16 @@ class DuplicationWarningDialog : VLCBottomSheetDialogFragment(), View.OnClickLis
         dismiss()
     }
 
-    private fun setupSecondaryText(secondaryMessage: String) {
+    private fun setupSecondaryText(secondaryMessage: String, playlistTitle: String) {
         val searchTitle = "\"$playlistTitle\""
         val styledText = SpannableString.valueOf(secondaryMessage)
         val startIndex = styledText.indexOf(searchTitle)
         val endIndex = startIndex + searchTitle.length
         styledText.setSpan(StyleSpan(Typeface.BOLD), startIndex, endIndex, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE)
         styledText.setSpan(ForegroundColorSpan(MaterialColors.getColor(requireContext(), R.attr.font_default, Color.BLACK)), startIndex, endIndex, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE)
-        binding.secondaryTextview.text = styledText
-    }
 
-    private fun shouldShowThreeOptions() = duplicatesCount < highlightsCount
+        finalMessage = SpannableString.valueOf(finalMessage.toString() + styledText.toString()+"\n")
+    }
 
     companion object {
 
@@ -114,16 +108,16 @@ class DuplicationWarningDialog : VLCBottomSheetDialogFragment(), View.OnClickLis
         const val ADD_NEW = 1
         const val CANCEL = 2
 
-        private const val HIGHLIGHT_KEY = "highlighted_items_count"
-        private const val DUPLICATION_KEY = "duplicate_items_count"
         private const val TITLE_KEY = "playlist_title"
+        private const val DUPLICATION_MESSAGES_KEY = "duplication_messages"
+        private const val SHOW_OPTIONS_KEY = "show_three_options"
 
-        fun newInstance(highlightedItemsCount: Int, duplicateItemsCount: Int, playlistTitle: String) : DuplicationWarningDialog {
+        fun newInstance(shouldShowThreeOptions: Boolean, playlistTitle: ArrayList<String>, duplicationMessages: ArrayList<String>) : DuplicationWarningDialog {
             return DuplicationWarningDialog().apply {
                 val args = Bundle()
-                args.putInt(HIGHLIGHT_KEY, highlightedItemsCount)
-                args.putInt(DUPLICATION_KEY, duplicateItemsCount)
-                args.putString(TITLE_KEY, playlistTitle)
+                args.putStringArrayList(TITLE_KEY, playlistTitle)
+                args.putStringArrayList(DUPLICATION_MESSAGES_KEY, duplicationMessages)
+                args.putBoolean(SHOW_OPTIONS_KEY, shouldShowThreeOptions)
                 arguments = args
             }
         }
diff --git a/application/vlc-android/src/org/videolan/vlc/gui/dialogs/SavePlaylistDialog.kt b/application/vlc-android/src/org/videolan/vlc/gui/dialogs/SavePlaylistDialog.kt
index a216916845..6de80c6afb 100644
--- a/application/vlc-android/src/org/videolan/vlc/gui/dialogs/SavePlaylistDialog.kt
+++ b/application/vlc-android/src/org/videolan/vlc/gui/dialogs/SavePlaylistDialog.kt
@@ -59,6 +59,7 @@ import org.videolan.vlc.viewmodels.browser.TYPE_FILE
 import org.videolan.vlc.viewmodels.browser.getBrowserModel
 import java.util.*
 import java.util.concurrent.atomic.AtomicBoolean
+import kotlin.collections.ArrayList
 
 class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
         TextView.OnEditorActionListener, SimpleAdapter.ClickHandler {
@@ -66,7 +67,7 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
 
     override fun needToManageOrientation(): Boolean = false
 
-    var selectedPlaylist: Playlist? = null
+    var selectedPlaylist: ArrayList<Playlist>? = null
     var nonDuplicateTracks: Array<MediaWrapper>? = null
 
     private var isLoading: Boolean = false
@@ -132,8 +133,7 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
                 emptyArray()
             }
         }
-        selectedPlaylist = savedInstanceState?.parcelable(SELECTED_PLAYLIST)
-        nonDuplicateTracks = selectedPlaylist?.let { getNonDuplicateTracks(it.tracks, newTracks) }
+        selectedPlaylist = savedInstanceState?.getSerializable(SELECTED_PLAYLIST) as ArrayList<Playlist>?
     }
 
     override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
@@ -147,11 +147,12 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
         super.onViewCreated(view, savedInstanceState)
 
         binding.dialogPlaylistSave.setOnClickListener(this)
+        binding.dialogPlaylistCreate.setOnClickListener(this)
 
         binding.dialogPlaylistName.editText!!.setOnEditorActionListener(this)
         binding.dialogPlaylistName.editText!!.setOnKeyListener { _, keyCode, _ ->
             if (keyCode == KeyEvent.KEYCODE_ENTER) {
-                addToNewPlaylist()
+                addNewPlaylist()
                 true
             } else false
         }
@@ -165,15 +166,13 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
                 viewLifecycleOwner) { _: String, bundle: Bundle ->
             when (bundle.getInt(OPTION_KEY)) {
                 ADD_ALL -> {
-                    savePlaylist(selectedPlaylist!!, newTracks)
-                    processNextItem()
+                    processNextItem(newTracks)
                 }
                 ADD_NEW -> {
-                    savePlaylist(selectedPlaylist!!, nonDuplicateTracks!!)
-                    processNextItem()
+                    processNextItem(nonDuplicateTracks!!)
                 }
                 CANCEL, NO_OPTION -> {
-                    processNextItem()
+                    // do nothing
                 }
             }
         }
@@ -181,11 +180,20 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
         binding.replaceSwitch.setOnCheckedChangeListener { _, isChecked ->
             Settings.getInstance(requireActivity()).putSingle(PLAYLIST_REPLACE, isChecked)
         }
+        selectedPlaylist?.let {
+            it.forEachIndexed { index, playlist ->
+                adapter.multiSelectHelper.toggleSelection(index)
+            }
+            if (it.size > 0){
+                binding.selectedPlaylistCount.text = resources.getString(R.string.selection_count, it.size)
+            }
+        }
     }
 
     override fun onSaveInstanceState(outState: Bundle) {
         super.onSaveInstanceState(outState)
-        outState.putParcelable(SELECTED_PLAYLIST, selectedPlaylist)
+        selectedPlaylist = adapter.multiSelectHelper.getSelection() as ArrayList<Playlist>
+        outState.putSerializable(SELECTED_PLAYLIST, selectedPlaylist)
     }
 
     private fun updateEmptyView() {
@@ -193,31 +201,37 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
     }
 
     override fun onClick(v: View) {
-        addToNewPlaylist()
-        if(adapter.multiSelectHelper.getSelection().isNotEmpty()) {
-            val selectedItems = adapter.multiSelectHelper.getSelection()
-            playlistIterator = selectedItems.iterator()
-            processNextItem()
+        when (v.id) {
+            R.id.dialog_playlist_save -> {
+                if (adapter.multiSelectHelper.getSelection().isNotEmpty()) {
+                    val selectedItems = adapter.multiSelectHelper.getSelection()
+                    playlistIterator = selectedItems.iterator()
+                    saveToExistingPlaylists(selectedItems)
+                }
+            }
+
+            R.id.dialog_playlist_create -> addNewPlaylist()
         }
     }
 
-    private fun processNextItem() {
+    private fun processNextItem(tracks: Array<MediaWrapper>) {
         if (playlistIterator != null && playlistIterator!!.hasNext()) {
             val item = playlistIterator!!.next()
             currentItem = item
-            saveToExistingPlaylists(item)
+            savePlaylist(item as Playlist, tracks)
         } else {
             playlistIterator = null
             currentItem = null
             dismiss()
         }
     }
+
     override fun onEditorAction(v: TextView, actionId: Int, event: KeyEvent?): Boolean {
-        if (actionId == EditorInfo.IME_ACTION_SEND) addToNewPlaylist()
+        if (actionId == EditorInfo.IME_ACTION_SEND) addNewPlaylist()
         return false
     }
 
-    private fun addToNewPlaylist() {
+    private fun addNewPlaylist() {
         if (alreadyAdding.getAndSet(true)) return
         val name = binding.dialogPlaylistName.editText?.text?.toString()?.trim { it <= ' ' }
                 ?: return
@@ -227,8 +241,12 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
                 alreadyAdding.set(false)
                 return@launch
             }
-            savePlaylist(medialibrary.createPlaylist(name, Settings.includeMissing, false) ?: return@launch, newTracks)
-            if(adapter.multiSelectHelper.getSelection().isEmpty()) dismiss()
+            medialibrary.createPlaylist(name, Settings.includeMissing, false)
+            binding.dialogPlaylistName.editText?.text?.clear()
+            adapter.submitList(listOf<MediaLibraryItem>(*medialibrary.getPlaylists(Playlist.Type.All, false).apply { forEach { it.description = resources.getQuantityString(R.plurals.media_quantity, it.tracksCount, it.tracksCount) } }))
+            alreadyAdding.set(false)
+            binding.dialogPlaylistName.error = null
+
         }
     }
 
@@ -255,19 +273,46 @@ class SavePlaylistDialog : VLCBottomSheetDialogFragment(), View.OnClickListener,
                 val newPlaylist = medialibrary.createPlaylist(name, Settings.includeMissing, false)
                 newPlaylist.append(ids)
             } else playlist.append(ids)
+            withContext(coroutineContextProvider.Main) {
+                if (playlistIterator == null) dismiss()
+                else processNextItem(tracks)
+            }
         }
     }
 
-    private fun saveToExistingPlaylists(item: MediaLibraryItem){
-        selectedPlaylist = item as Playlist
-        nonDuplicateTracks = getNonDuplicateTracks(selectedPlaylist!!.tracks, newTracks)
-        val duplicateItemsCount = newTracks.size - nonDuplicateTracks!!.size
-        if (duplicateItemsCount == 0 || binding.replaceSwitch.isChecked) {
-            savePlaylist(selectedPlaylist!!, newTracks)
-            processNextItem()
+    private fun saveToExistingPlaylists(items: List<MediaLibraryItem>) {
+        val highlightedItemsCounts = newTracks.size
+        var shouldShowThreeOptions = false
+        val titles : ArrayList<String> = ArrayList()
+        val duplicationMessages = items.filter { playlist ->
+            nonDuplicateTracks = getNonDuplicateTracks(playlist.tracks, newTracks)
+            val duplicateItemsCount = newTracks.size - nonDuplicateTracks!!.size
+            duplicateItemsCount != 0
+        }.mapIndexed { index, playlist ->
+            nonDuplicateTracks = getNonDuplicateTracks(playlist.tracks, newTracks)
+            val duplicateItemsCount = newTracks.size - nonDuplicateTracks!!.size
+            val pluralSecondary: Int
+            val secondaryMessage: String
+            titles.add(playlist.title)
+            if(duplicateItemsCount < highlightedItemsCounts){
+                shouldShowThreeOptions = true
+                pluralSecondary = R.plurals.duplicate_three_options_secondary
+                secondaryMessage = if (duplicateItemsCount == 1)
+                    resources.getQuantityString(pluralSecondary, duplicateItemsCount,playlist.title)
+                else
+                    resources.getQuantityString(pluralSecondary, duplicateItemsCount, duplicateItemsCount, playlist.title)
+                secondaryMessage
+            }else{
+                pluralSecondary = R.plurals.duplicate_two_options_secondary
+                secondaryMessage = resources.getQuantityString(pluralSecondary, duplicateItemsCount, playlist.title)
+                secondaryMessage
+            }
+        }
+
+        if (duplicationMessages.isEmpty() || binding.replaceSwitch.isChecked) {
+            processNextItem(newTracks)
         } else {
-            val highlightedItemsCount = newTracks.size
-            val warningDialog = DuplicationWarningDialog.newInstance(highlightedItemsCount, duplicateItemsCount,selectedPlaylist!!.title)
+            val warningDialog = DuplicationWarningDialog.newInstance(shouldShowThreeOptions,titles, ArrayList(duplicationMessages))
             warningDialog.show(requireActivity().supportFragmentManager, "duplicationWarningDialog")
         }
     }
