diff --git a/twidere/build.gradle b/twidere/build.gradle
index 838eb79c7e..0a4a2e296b 100644
--- a/twidere/build.gradle
+++ b/twidere/build.gradle
@@ -19,7 +19,7 @@ android {
 
     defaultConfig {
         applicationId "org.mariotaku.twidere"
-        minSdkVersion 14
+        minSdkVersion 21
         targetSdkVersion 23
         versionCode 156
         versionName "3.0.6.5"
@@ -88,6 +88,7 @@ dependencies {
     compile 'com.android.support:preference-v7:23.2.1'
     compile 'com.android.support:preference-v14:23.2.1'
     compile('com.github.afollestad:app-theme-engine:1.0.1@aar') { transitive = true }
+    compile('com.github.afollestad.material-dialogs:commons:0.8.5.7@aar') { transitive = true }
     compile 'com.twitter:twitter-text:1.13.0'
     compile 'com.nostra13.universalimageloader:universal-image-loader:1.9.5'
     compile 'com.squareup:otto:1.3.8'
diff --git a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java b/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java
index ec8ae11c56..21b224f984 100644
--- a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java
+++ b/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java
@@ -80,7 +80,6 @@ public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
     @Override
     public void onViewCreated(View view, Bundle savedInstanceState) {
         super.onViewCreated(view, savedInstanceState);
-        onBaseViewCreated(view, savedInstanceState);
         requestFitSystemWindows();
     }
 
@@ -143,11 +142,6 @@ public void requestFitSystemWindows() {
         }
     }
 
-    @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-
-    }
-
     @Override
     public void executeAfterFragmentResumed(Action action) {
         mActionHelper.executeAfterFragmentResumed(action);
diff --git a/twidere/src/main/AndroidManifest.xml b/twidere/src/main/AndroidManifest.xml
index 44f970a21d..959dc8caf0 100644
--- a/twidere/src/main/AndroidManifest.xml
+++ b/twidere/src/main/AndroidManifest.xml
@@ -75,7 +75,7 @@
         android:icon="@mipmap/ic_launcher"
         android:label="@string/app_name"
         android:supportsRtl="true"
-        android:theme="@style/Theme.Compat.Base.NoActionBar"
+        android:theme="@style/Theme.Twidere.NoActionBar"
         tools:ignore="UnusedAttribute">
         <uses-library
             android:name="com.sec.android.app.multiwindow"
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
index 41b11f695c..4676f80891 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
@@ -29,13 +29,13 @@
 import android.support.v4.app.FragmentTransaction;
 import android.support.v4.app.NavUtils;
 import android.support.v7.app.ActionBar;
+import android.support.v7.app.AppCompatDelegate;
 import android.support.v7.widget.ActionBarContainer;
 import android.support.v7.widget.ActionMenuView;
 import android.support.v7.widget.Toolbar;
 import android.view.KeyEvent;
 import android.view.MenuItem;
 import android.view.View;
-import android.view.ViewGroup;
 
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.iface.IControlBarActivity;
@@ -82,7 +82,7 @@ public void onLayoutChange(View v, int left, int top, int right, int bottom, int
 
     @Override
     public Fragment getCurrentVisibleFragment() {
-        return getSupportFragmentManager().findFragmentById(R.id.content_fragment);
+        return getSupportFragmentManager().findFragmentById(android.R.id.content);
     }
 
     @Override
@@ -92,20 +92,6 @@ public boolean triggerRefresh(int position) {
 
     @Override
     public void onFitSystemWindows(Rect insets) {
-        final View actionBarContainer = findViewById(R.id.twidere_action_bar_container);
-        if (actionBarContainer != null) {
-            final ViewGroup.LayoutParams toolBarParams = actionBarContainer.getLayoutParams();
-            boolean changed = false;
-            if (toolBarParams instanceof ViewGroup.MarginLayoutParams) {
-                final int topMargin = ((ViewGroup.MarginLayoutParams) toolBarParams).topMargin;
-                changed = topMargin != insets.top;
-                ((ViewGroup.MarginLayoutParams) toolBarParams).topMargin = insets.top;
-            }
-            if (changed) {
-                actionBarContainer.setLayoutParams(toolBarParams);
-            }
-        }
-        insets.top += ThemeUtils.getActionBarHeight(this);
         super.onFitSystemWindows(insets);
         final Fragment fragment = getCurrentVisibleFragment();
         if (fragment instanceof IBaseFragment) {
@@ -179,13 +165,13 @@ private boolean isFragmentKeyboardShortcutHandled(final KeyboardShortcutsHandler
 
     @Override
     protected void onCreate(final Bundle savedInstanceState) {
+        supportRequestWindowFeature(AppCompatDelegate.FEATURE_SUPPORT_ACTION_BAR_OVERLAY);
         mMultiSelectHandler = new MultiSelectEventHandler(this);
         mMultiSelectHandler.dispatchOnCreate();
         final Intent intent = getIntent();
         final Uri data = intent.getData();
         final int linkId = matchLinkId(data);
         super.onCreate(savedInstanceState);
-
         ThemeUtils.setCompatContentViewOverlay(this, new EmptyDrawable());
         final ActionBar actionBar = getSupportActionBar();
         if (actionBar != null) {
@@ -226,11 +212,6 @@ public final void setSubtitle(CharSequence subtitle) {
         actionBar.setSubtitle(subtitle);
     }
 
-    @Override
-    public void onContentChanged() {
-        super.onContentChanged();
-    }
-
     protected boolean shouldSetActionItemColor() {
         return !(getCurrentVisibleFragment() instanceof UserFragment);
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
index f98c3dbf75..08fde661be 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
@@ -59,7 +59,6 @@
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
 import org.mariotaku.twidere.util.ThemeUtils;
-import org.mariotaku.twidere.util.TwidereActionModeForChildListener;
 import org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout;
 
 import java.util.ArrayList;
@@ -77,7 +76,6 @@ public class SettingsActivity extends BaseAppCompatActivity implements OnItemCli
     private EntriesAdapter mEntriesAdapter;
     private TintedStatusNativeActionModeAwareLayout mMainContent;
     private View mDetailFragmentContainer;
-    private TwidereActionModeForChildListener mTwidereActionModeForChildListener;
 
     public static void setShouldNotifyChange(Activity activity) {
         if (!(activity instanceof SettingsActivity)) return;
@@ -105,8 +103,6 @@ protected void onCreate(Bundle savedInstanceState) {
         mMainContent.setDrawColor(true);
         mMainContent.setColor(statusBarColor, alpha);
 
-        mTwidereActionModeForChildListener = new TwidereActionModeForChildListener(this, this, false);
-        mMainContent.setActionModeForChildListener(mTwidereActionModeForChildListener);
         mDetailFragmentContainer.setBackgroundColor((backgroundAlpha << 24 | 0xFFFFFF) & ThemeUtils.getThemeBackgroundColor(this));
 
         mSlidingPaneLayout.setShadowResourceLeft(R.drawable.sliding_pane_shadow_left);
@@ -226,9 +222,6 @@ private boolean shouldNotifyChange() {
 
     @Override
     public void onBackPressed() {
-        if (mTwidereActionModeForChildListener.finishExisting()) {
-            return;
-        }
         if (isTopSettings() && shouldNotifyChange()) {
             final RestartConfirmDialogFragment df = new RestartConfirmDialogFragment();
             df.show(getSupportFragmentManager(), "restart_confirm");
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
index 0e1660f131..9ef98a6235 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
@@ -42,7 +42,6 @@
 import android.support.v4.app.FragmentTransaction;
 import android.support.v4.view.ViewCompat;
 import android.support.v7.app.AlertDialog;
-import android.support.v7.widget.ActionMenuView;
 import android.support.v7.widget.Toolbar;
 import android.text.Editable;
 import android.text.InputType;
@@ -101,7 +100,6 @@
 import org.mariotaku.twidere.util.ParseUtils;
 import org.mariotaku.twidere.util.SharedPreferencesWrapper;
 import org.mariotaku.twidere.util.ThemeUtils;
-import org.mariotaku.twidere.util.TwidereActionModeForChildListener;
 import org.mariotaku.twidere.util.TwitterAPIFactory;
 import org.mariotaku.twidere.util.TwitterContentUtils;
 import org.mariotaku.twidere.util.UserAgentUtils;
@@ -109,7 +107,6 @@
 import org.mariotaku.twidere.util.support.ViewSupport;
 import org.mariotaku.twidere.util.support.view.ViewOutlineProviderCompat;
 import org.mariotaku.twidere.util.view.ConsumerKeySecretValidator;
-import org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout;
 import org.mariotaku.twidere.view.iface.TintedStatusLayout;
 
 import java.lang.ref.WeakReference;
@@ -281,15 +278,7 @@ public boolean onPrepareOptionsMenu(final Menu menu) {
             itemBrowser.setVisible(is_oauth);
             itemBrowser.setEnabled(is_oauth);
         }
-        final boolean result = super.onPrepareOptionsMenu(menu);
-        if (!shouldSetActionItemColor()) return result;
-        final Toolbar toolbar = peekActionBarToolbar();
-        if (toolbar != null) {
-            final int themeColor = getCurrentThemeColor();
-            final int itemColor = ThemeUtils.getContrastForegroundColor(this, themeColor);
-            ThemeUtils.wrapToolbarMenuIcon(ViewSupport.findViewByType(toolbar, ActionMenuView.class), itemColor, itemColor);
-        }
-        return result;
+        return true;
     }
 
     @Override
@@ -322,10 +311,6 @@ protected void onCreate(final Bundle savedInstanceState) {
         setContentView(R.layout.activity_sign_in);
         setSupportActionBar((Toolbar) findViewById(R.id.action_bar));
 
-        TwidereActionModeForChildListener actionModeForChildListener = new TwidereActionModeForChildListener(this, this, false);
-        final TintedStatusNativeActionModeAwareLayout layout = (TintedStatusNativeActionModeAwareLayout) findViewById(R.id.main_content);
-        layout.setActionModeForChildListener(actionModeForChildListener);
-
         ThemeUtils.setCompatContentViewOverlay(this, new EmptyDrawable());
         final View actionBarContainer = findViewById(R.id.twidere_action_bar_container);
         ViewCompat.setElevation(actionBarContainer, ThemeUtils.getSupportActionBarElevation(this));
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
index 7f2d1f914b..8b35e036cf 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
@@ -163,8 +163,8 @@ private void setListShown(boolean shown) {
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mListView = (DragSortListView) view.findViewById(android.R.id.list);
         mEmptyView = view.findViewById(android.R.id.empty);
         mEmptyIcon = (ImageView) view.findViewById(R.id.empty_icon);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
index d3cd604951..767c53b14b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
@@ -76,8 +76,8 @@ public void onClick(View v) {
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mStartDiagnosticsButton = (Button) view.findViewById(R.id.start_diagnostics);
         mLogTextView = (TextView) view.findViewById(R.id.log_text);
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedEditTextPreferenceDialogFragmentCompat.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedEditTextPreferenceDialogFragmentCompat.java
new file mode 100644
index 0000000000..7ce396fd80
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedEditTextPreferenceDialogFragmentCompat.java
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2015 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License
+ */
+package org.mariotaku.twidere.fragment;
+
+import android.os.Bundle;
+import android.support.v7.preference.EditTextPreference;
+import android.view.View;
+import android.widget.EditText;
+
+public class ThemedEditTextPreferenceDialogFragmentCompat extends ThemedPreferenceDialogFragmentCompat {
+
+    private EditText mEditText;
+
+    public static ThemedEditTextPreferenceDialogFragmentCompat newInstance(String key) {
+        final ThemedEditTextPreferenceDialogFragmentCompat fragment =
+                new ThemedEditTextPreferenceDialogFragmentCompat();
+        final Bundle args = new Bundle();
+        args.putString(ARG_KEY, key);
+        fragment.setArguments(args);
+        return fragment;
+    }
+
+    @Override
+    protected boolean needInputMethod() {
+        return true;
+    }
+
+    @Override
+    protected void onBindDialogView(View view) {
+        super.onBindDialogView(view);
+        mEditText = (EditText) view.findViewById(android.R.id.edit);
+        final EditTextPreference preference = (EditTextPreference) getPreference();
+        mEditText.setText(preference.getText());
+    }
+
+    @Override
+    public void onDialogClosed(boolean positiveResult) {
+        if (positiveResult) {
+            final String value = mEditText.getText().toString();
+            final EditTextPreference preference = (EditTextPreference) getPreference();
+            if (preference.callChangeListener(value)) {
+                preference.setText(value);
+            }
+        }
+
+    }
+}
\ No newline at end of file
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedListPreferenceDialogFragmentCompat.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedListPreferenceDialogFragmentCompat.java
new file mode 100644
index 0000000000..53c21dffa7
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedListPreferenceDialogFragmentCompat.java
@@ -0,0 +1,85 @@
+/*
+ * Copyright (C) 2015 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License
+ */
+package org.mariotaku.twidere.fragment;
+
+import android.content.DialogInterface;
+import android.os.Bundle;
+import android.support.v7.preference.ListPreference;
+
+import com.afollestad.materialdialogs.AlertDialogWrapper;
+
+import org.mariotaku.twidere.util.TwidereArrayUtils;
+
+public class ThemedListPreferenceDialogFragmentCompat extends ThemedPreferenceDialogFragmentCompat {
+    private int mClickedDialogEntryIndex;
+
+    public static ThemedListPreferenceDialogFragmentCompat newInstance(String key) {
+        final ThemedListPreferenceDialogFragmentCompat fragment =
+                new ThemedListPreferenceDialogFragmentCompat();
+        final Bundle b = new Bundle(1);
+        b.putString(ARG_KEY, key);
+        fragment.setArguments(b);
+        return fragment;
+    }
+
+    private ListPreference getListPreference() {
+        return (ListPreference) getPreference();
+    }
+
+    @Override
+    protected void onPrepareDialogBuilder(AlertDialogWrapper.Builder builder) {
+        super.onPrepareDialogBuilder(builder);
+        final ListPreference preference = getListPreference();
+        final String[] entries = TwidereArrayUtils.toStringArray(preference.getEntries());
+        if (entries == null || preference.getEntryValues() == null) {
+            throw new IllegalStateException(
+                    "ListPreference requires an entries array and an entryValues array.");
+        }
+        mClickedDialogEntryIndex = preference.findIndexOfValue(preference.getValue());
+        builder.setSingleChoiceItems(entries, mClickedDialogEntryIndex,
+                new DialogInterface.OnClickListener() {
+                    public void onClick(DialogInterface dialog, int which) {
+                        mClickedDialogEntryIndex = which;
+                        /*
+                         * Clicking on an item simulates the positive button
+                         * click, and dismisses the dialog.
+                         */
+                        ThemedListPreferenceDialogFragmentCompat.this.onClick(dialog,
+                                DialogInterface.BUTTON_POSITIVE);
+                        dialog.dismiss();
+                    }
+                });
+        /*
+         * The typical interaction for list-based dialogs is to have
+         * click-on-an-item dismiss the dialog instead of the user having to
+         * press 'Ok'.
+         */
+        //noinspection ConstantConditions
+        builder.setPositiveButton(null, null);
+    }
+
+    @Override
+    public void onDialogClosed(boolean positiveResult) {
+        final ListPreference preference = getListPreference();
+        if (positiveResult && mClickedDialogEntryIndex >= 0 &&
+                preference.getEntryValues() != null) {
+            String value = preference.getEntryValues()[mClickedDialogEntryIndex].toString();
+            if (preference.callChangeListener(value)) {
+                preference.setValue(value);
+            }
+        }
+    }
+}
\ No newline at end of file
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedPreferenceDialogFragmentCompat.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedPreferenceDialogFragmentCompat.java
new file mode 100644
index 0000000000..8c228eec27
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ThemedPreferenceDialogFragmentCompat.java
@@ -0,0 +1,67 @@
+package org.mariotaku.twidere.fragment;
+
+import android.app.Dialog;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+import android.support.v7.app.AlertDialog;
+import android.support.v7.preference.DialogPreference;
+import android.support.v7.preference.PreferenceDialogFragmentCompat;
+import android.view.View;
+import android.view.Window;
+
+import com.afollestad.materialdialogs.AlertDialogWrapper;
+
+/**
+ * Created by mariotaku on 16/3/15.
+ */
+public abstract class ThemedPreferenceDialogFragmentCompat extends PreferenceDialogFragmentCompat {
+
+    @Override
+    @NonNull
+    public Dialog onCreateDialog(Bundle savedInstanceState) {
+        final Context context = getContext();
+        final DialogPreference preference = getPreference();
+        onClick(null, DialogInterface.BUTTON_NEGATIVE);
+        final AlertDialogWrapper.Builder builder = new AlertDialogWrapper.Builder(context)
+                .setTitle(preference.getDialogTitle())
+                .setIcon(preference.getDialogIcon())
+                .setPositiveButton(preference.getPositiveButtonText(), this)
+                .setNegativeButton(preference.getNegativeButtonText(), this);
+        View contentView = onCreateDialogView(context);
+        if (contentView != null) {
+            onBindDialogView(contentView);
+            builder.setView(contentView);
+        } else {
+            builder.setMessage(preference.getDialogMessage());
+        }
+        onPrepareDialogBuilder(builder);
+        // Create the dialog
+        final Dialog dialog = builder.create();
+        if (needInputMethod()) {
+            supportRequestInputMethod(dialog);
+        }
+        return builder.create();
+    }
+
+    @Override
+    protected final void onPrepareDialogBuilder(AlertDialog.Builder builder) {
+
+    }
+
+    protected void onPrepareDialogBuilder(AlertDialogWrapper.Builder builder) {
+
+    }
+
+    private void supportRequestInputMethod(Dialog dialog) {
+        Window window = dialog.getWindow();
+        window.setSoftInputMode(5);
+    }
+
+    @Override
+    public final void onClick(DialogInterface dialog, int which) {
+        super.onClick(dialog, which);
+    }
+
+}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/iface/IBaseFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/iface/IBaseFragment.java
index c5602afa7b..54178b0157 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/iface/IBaseFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/iface/IBaseFragment.java
@@ -21,7 +21,6 @@
 
 import android.graphics.Rect;
 import android.os.Bundle;
-import android.view.View;
 
 import java.util.LinkedList;
 import java.util.Queue;
@@ -33,8 +32,6 @@ public interface IBaseFragment {
 
     void requestFitSystemWindows();
 
-    void onBaseViewCreated(View view, Bundle savedInstanceState);
-
     interface SystemWindowsInsetsCallback {
         boolean getSystemWindowsInsets(Rect insets);
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java
index 5f5a07f0e4..85419c04fa 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java
@@ -192,8 +192,8 @@ public void onStop() {
     }
 
     @Override
-    public void onBaseViewCreated(View view, @Nullable Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mProgressContainer = view.findViewById(R.id.progress_container);
         mSwipeRefreshLayout = (SwipeRefreshLayout) view.findViewById(R.id.swipe_layout);
         mListView = (ListView) view.findViewById(R.id.list_view);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java
index 2b0df9960a..230c7d82be 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java
@@ -272,8 +272,8 @@ public void onStop() {
     }
 
     @Override
-    public void onBaseViewCreated(View view, @Nullable Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mProgressContainer = view.findViewById(R.id.progress_container);
         mSwipeRefreshLayout = (SwipeRefreshLayout) view.findViewById(R.id.swipe_layout);
         mRecyclerView = (RecyclerView) view.findViewById(R.id.recycler_view);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java
index cadeaa17cc..477d75b26c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java
@@ -56,7 +56,6 @@
 import android.support.v7.widget.RecyclerView;
 import android.support.v7.widget.RecyclerView.Adapter;
 import android.support.v7.widget.RecyclerView.ViewHolder;
-import android.view.ContextThemeWrapper;
 import android.view.KeyEvent;
 import android.view.LayoutInflater;
 import android.view.Menu;
@@ -119,7 +118,6 @@ public class AccountsDashboardFragment extends BaseSupportFragment implements Lo
     private View mAccountProfileContainer;
     private View mNoAccountContainer;
 
-    private Context mThemedContext;
     private AccountToggleProvider mAccountActionProvider;
     private final SupportFragmentReloadCursorObserver mReloadContentObserver = new SupportFragmentReloadCursorObserver(
             this, 0, this) {
@@ -385,8 +383,8 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mNavigationView = (NavigationView) view.findViewById(R.id.navigation_view);
         mAccountSelectorView = mNavigationView.getHeaderView(0);
         mAccountsSelector = (RecyclerView) mAccountSelectorView.findViewById(R.id.other_accounts_list);
@@ -490,13 +488,6 @@ private void getLocationOnScreen(View view, RectF rectF) {
         rectF.set(location[0], location[1], location[0] + view.getWidth(), location[1] + view.getHeight());
     }
 
-    @Override
-    public Context getThemedContext() {
-        if (mThemedContext != null) return mThemedContext;
-        final Context context = getActivity();
-        return mThemedContext = new ContextThemeWrapper(context, R.style.Theme_Twidere_Drawer);
-    }
-
     private void onAccountSelected(AccountProfileImageViewHolder holder, final ParcelableAccount account) {
         if (mSwitchAccountAnimationPlaying) return;
         final ImageView snapshotView = mFloatingProfileImageSnapshotView;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java
index 88d670e6b2..f5a7d1bd25 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java
@@ -196,8 +196,8 @@ public void onAccountToggle(UserKey accountId, boolean state) {
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mListView = (DragSortListView) view.findViewById(android.R.id.list);
         mEmptyView = view.findViewById(android.R.id.empty);
         mEmptyIcon = (ImageView) view.findViewById(R.id.empty_icon);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java
index 84c6d376c9..e7c3998e66 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java
@@ -86,9 +86,8 @@ public BaseSupportFragment() {
     }
 
     @Override
-    public final void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
-        super.onViewCreated(view, savedInstanceState);
-        onBaseViewCreated(view, savedInstanceState);
+    public void onViewStateRestored(@Nullable Bundle savedInstanceState) {
+        super.onViewStateRestored(savedInstanceState);
         requestFitSystemWindows();
     }
 
@@ -151,11 +150,6 @@ public void requestFitSystemWindows() {
         }
     }
 
-    @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-
-    }
-
     @Override
     public void executeAfterFragmentResumed(Action action) {
         mActionHelper.executeAfterFragmentResumed(action);
@@ -173,10 +167,6 @@ public void onDestroy() {
         DebugModeUtils.watchReferenceLeak(this);
     }
 
-    public Context getThemedContext() {
-        return getActivity();
-    }
-
     protected void fitSystemWindows(Rect insets) {
         final View view = getView();
         if (view != null) {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java
index fe9fdd0b80..baff31f804 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java
@@ -21,11 +21,11 @@
 
 import android.app.Dialog;
 import android.content.DialogInterface;
-import android.content.res.Resources;
 import android.graphics.Color;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
 import android.support.v4.app.FragmentActivity;
+import android.support.v4.content.ContextCompat;
 import android.support.v7.app.AlertDialog;
 
 import org.mariotaku.twidere.R;
@@ -91,9 +91,8 @@ public void onShow(DialogInterface di) {
                 mController = new ColorPickerDialog.Controller(dialog.getContext(), dialog.getWindow().getDecorView());
 
                 final boolean showAlphaSlider = args.getBoolean(EXTRA_ALPHA_SLIDER, true);
-                final Resources res = getResources();
                 for (int presetColor : PRESET_COLORS) {
-                    mController.addColor(res.getColor(presetColor));
+                    mController.addColor(ContextCompat.getColor(getContext(), presetColor));
                 }
                 mController.setAlphaEnabled(showAlphaSlider);
                 mController.setInitialColor(color);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java
index 9e3a50db6d..0214334870 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java
@@ -246,8 +246,8 @@ public void onStop() {
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mListView = (ListView) view.findViewById(android.R.id.list);
         mEmptyView = view.findViewById(android.R.id.empty);
         mEmptyText = (TextView) view.findViewById(R.id.empty_text);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java
index 9423b6ccb0..1315ca416d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java
@@ -122,8 +122,8 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mViewPager = (ViewPager) view.findViewById(R.id.view_pager);
         mPagerIndicator = (TabPagerIndicator) view.findViewById(R.id.view_pager_tabs);
         mPagerOverlay = view.findViewById(R.id.pager_window_overlay);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java
index c919559588..a12abb4091 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java
@@ -112,8 +112,8 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe
     }
 
     @Override
-    public void onBaseViewCreated(final View view, final Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(final View view, final Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mViewPager = (ViewPager) view.findViewById(R.id.view_pager);
         mPagerIndicator = (TabPagerIndicator) view.findViewById(R.id.view_pager_tabs);
         mPagerOverlay = view.findViewById(R.id.pager_window_overlay);
@@ -149,23 +149,12 @@ public boolean triggerRefresh(final int position) {
 
     @Override
     protected void fitSystemWindows(Rect insets) {
-        final View view = getView();
-        if (view != null) {
-            final int top = Utils.getInsetsTopWithoutActionBarHeight(getActivity(), insets.top);
-            view.setPadding(insets.left, top, insets.right, insets.bottom);
-        }
+        super.fitSystemWindows(insets);
         updateTabOffset();
     }
 
     @Override
     public boolean getSystemWindowsInsets(Rect insets) {
-        if (mPagerIndicator == null) return false;
-        final FragmentActivity activity = getActivity();
-        if (activity instanceof LinkHandlerActivity) {
-            ((LinkHandlerActivity) activity).getSystemWindowsInsets(insets);
-            insets.top = mPagerIndicator.getHeight() + getControlBarHeight();
-            return true;
-        }
         return false;
     }
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java
index e54a65a847..578269d360 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java
@@ -418,8 +418,8 @@ public boolean onOptionsItemSelected(MenuItem item) {
     }
 
     @Override
-    public void onBaseViewCreated(final View view, final Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(final View view, final Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mUsersSearchProgress = view.findViewById(R.id.users_search_progress);
         mUsersSearchList = (ListView) view.findViewById(R.id.users_search_list);
         mUsersSearchEmpty = view.findViewById(R.id.users_search_empty);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java
index f9c0b625a1..6eed8d8a9d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java
@@ -245,8 +245,8 @@ public boolean onOptionsItemSelected(final MenuItem item) {
     }
 
     @Override
-    public void onBaseViewCreated(final View view, final Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(final View view, final Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mViewPager = (ViewPager) view.findViewById(R.id.view_pager);
         mPagerWindowOverlay = view.findViewById(R.id.pager_window_overlay);
         mPagerIndicator = (TabPagerIndicator) view.findViewById(R.id.view_pager_tabs);
@@ -257,7 +257,7 @@ protected void fitSystemWindows(Rect insets) {
         final View view = getView();
         if (view != null) {
             final int top = Utils.getInsetsTopWithoutActionBarHeight(getActivity(), insets.top);
-            view.setPadding(insets.left, top, insets.right, insets.bottom);
+//            view.setPadding(insets.left, top, insets.right, insets.bottom);
         }
         updateTabOffset();
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java
index 01d9393270..1ca5771b04 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java
@@ -393,8 +393,8 @@ public NdefMessage createNdefMessage(NfcEvent event) {
     }
 
     @Override
-    public void onBaseViewCreated(View view, @Nullable Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mStatusContent = view.findViewById(R.id.status_content);
         mRecyclerView = (RecyclerView) view.findViewById(R.id.recycler_view);
         mProgressContainer = view.findViewById(R.id.progress_container);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java
index f3a11f3918..dec94bc792 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java
@@ -58,7 +58,6 @@
 import android.support.v4.view.ViewPager.OnPageChangeListener;
 import android.support.v7.app.ActionBar;
 import android.support.v7.app.AppCompatActivity;
-import android.support.v7.widget.ActionBarContainer;
 import android.support.v7.widget.Toolbar;
 import android.text.TextUtils;
 import android.util.Log;
@@ -84,12 +83,12 @@
 import org.apache.commons.lang3.ObjectUtils;
 import org.mariotaku.sqliteqb.library.Expression;
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.iface.IThemedActivity;
 import org.mariotaku.twidere.activity.AccountSelectorActivity;
 import org.mariotaku.twidere.activity.ColorPickerDialogActivity;
 import org.mariotaku.twidere.activity.LinkHandlerActivity;
 import org.mariotaku.twidere.activity.ThemedAppCompatActivity;
 import org.mariotaku.twidere.activity.UserListSelectorActivity;
+import org.mariotaku.twidere.activity.iface.IThemedActivity;
 import org.mariotaku.twidere.adapter.SupportTabsAdapter;
 import org.mariotaku.twidere.api.twitter.Twitter;
 import org.mariotaku.twidere.api.twitter.TwitterException;
@@ -151,7 +150,6 @@
 import org.mariotaku.twidere.view.ProfileBannerImageView;
 import org.mariotaku.twidere.view.ShapedImageView;
 import org.mariotaku.twidere.view.TabPagerIndicator;
-import org.mariotaku.twidere.view.TintedStatusFrameLayout;
 import org.mariotaku.twidere.view.iface.IExtendedView.OnSizeChangedListener;
 
 import java.util.Calendar;
@@ -194,7 +192,6 @@ public class UserFragment extends BaseSupportFragment implements OnClickListener
     private View mProgressContainer, mHeaderErrorContainer;
     private View mCardContent;
     private View mProfileBannerSpace;
-    private TintedStatusFrameLayout mTintedStatusContent;
     private HeaderDrawerLayout mHeaderDrawerLayout;
     private ViewPager mViewPager;
     private TabPagerIndicator mPagerIndicator;
@@ -706,14 +703,6 @@ public void onActivityResult(final int requestCode, final int resultCode, final
 
     }
 
-    @Override
-    public void onAttach(Context context) {
-        super.onAttach(context);
-        if (context instanceof FragmentActivity) {
-            mTintedStatusContent = (TintedStatusFrameLayout) ((FragmentActivity) context).findViewById(R.id.main_content);
-        }
-    }
-
     @Override
     public View onCreateView(final LayoutInflater inflater, final ViewGroup container, final Bundle savedInstanceState) {
         return inflater.inflate(R.layout.fragment_user, container, false);
@@ -1135,8 +1124,8 @@ public boolean onOptionsItemSelected(final MenuItem item) {
     }
 
     @Override
-    public void onBaseViewCreated(final View view, final Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(final View view, final Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mHeaderDrawerLayout = (HeaderDrawerLayout) view.findViewById(R.id.user_profile_drawer);
         final View headerView = mHeaderDrawerLayout.getHeader();
         final View contentView = mHeaderDrawerLayout.getContent();
@@ -1439,9 +1428,6 @@ public boolean triggerRefresh() {
     }
 
     public void setListShown(boolean shown) {
-        final TintedStatusFrameLayout tintedStatus = mTintedStatusContent;
-        if (tintedStatus == null) return;
-//        tintedStatus.setDrawShadow(shown);
     }
 
     private void getFriendship() {
@@ -1478,10 +1464,6 @@ private void setUiColor(int color) {
         final IThemedActivity themed = (IThemedActivity) activity;
         final String backgroundOption = themed.getThemeBackgroundOption();
         final int actionBarColor = ThemeUtils.getActionBarColor(activity, color, backgroundOption);
-        if (mTintedStatusContent != null) {
-            final int alpha = ThemeUtils.isTransparentBackground(backgroundOption) ? themed.getCurrentThemeBackgroundAlpha() : 0xFF;
-            mTintedStatusContent.setColor(actionBarColor, ThemeUtils.getActionBarAlpha(alpha));
-        }
         if (mActionBarBackground != null) {
             mActionBarBackground.setColor(actionBarColor);
         }
@@ -1513,9 +1495,8 @@ private void setupBaseActionBar() {
         final FragmentActivity activity = getActivity();
         if (!(activity instanceof LinkHandlerActivity)) return;
         final LinkHandlerActivity linkHandler = (LinkHandlerActivity) activity;
-        final ActionBarContainer actionBarContainer = linkHandler.getActionBarContainer();
         final ActionBar actionBar = linkHandler.getSupportActionBar();
-        if (actionBarContainer == null || actionBar == null) return;
+        if (actionBar == null) return;
         final Drawable shadow = ResourcesCompat.getDrawable(activity.getResources(), R.drawable.shadow_user_banner_action_bar, null);
         mActionBarBackground = new ActionBarDrawable(shadow);
         if (!ThemeUtils.isWindowFloating(linkHandler)
@@ -1523,7 +1504,7 @@ private void setupBaseActionBar() {
 //            mActionBarBackground.setAlpha(ThemeUtils.getActionBarAlpha(linkHandler.getCurrentThemeBackgroundAlpha()));
             mProfileBannerView.setAlpha(linkHandler.getCurrentThemeBackgroundAlpha() / 255f);
         }
-        actionBarContainer.setPrimaryBackground(mActionBarBackground);
+        actionBar.setBackgroundDrawable(mActionBarBackground);
     }
 
     private void setupUserPages() {
@@ -1589,9 +1570,8 @@ private void updateScrollOffset(int offset) {
         profileBannerView.setTranslationY(offset / 2);
         profileBirthdayBannerView.setTranslationY(offset / 2);
 
-        if (mActionBarBackground != null && mTintedStatusContent != null) {
+        if (mActionBarBackground != null) {
             mActionBarBackground.setFactor(factor);
-            mTintedStatusContent.setFactor(factor);
 
             final float profileContentHeight = mProfileNameContainer.getHeight() + mProfileDetailsContainer.getHeight();
             final float tabOutlineAlphaFactor;
@@ -1732,9 +1712,12 @@ public int getIntrinsicHeight() {
 
         public void setFactor(float f) {
             mFactor = f;
-            mShadowDrawable.setAlpha(Math.round(mAlpha * TwidereMathUtils.clamp(1 - f, 0, 1)));
+            final int shadowAlpha = Math.round(mAlpha * TwidereMathUtils.clamp(1 - f, 0, 1));
+            mShadowDrawable.setAlpha(shadowAlpha);
             final boolean hasColor = mColor != 0;
-            mColorDrawable.setAlpha(hasColor ? Math.round(mAlpha * TwidereMathUtils.clamp(f, 0, 1)) : 0);
+            final int colorAlpha = hasColor ? Math.round(mAlpha * TwidereMathUtils.clamp(f, 0, 1)) : 0;
+            mColorDrawable.setAlpha(colorAlpha);
+            invalidateSelf();
         }
 
         public void setOutlineAlphaFactor(float f) {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java
index 6138b06f89..281839ba49 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java
@@ -391,8 +391,8 @@ public void onLoaderReset(final Loader<SingleResponse<ParcelableUserList>> loade
     }
 
     @Override
-    public void onBaseViewCreated(final View view, final Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(final View view, final Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mViewPager = (ViewPager) view.findViewById(R.id.view_pager);
         mPagerIndicator = (TabPagerIndicator) view.findViewById(R.id.view_pager_tabs);
         mPagerOverlay = view.findViewById(R.id.pager_window_overlay);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java
index 43654c6c81..230a500537 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java
@@ -271,8 +271,8 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mProgressContainer = view.findViewById(R.id.progress_container);
         mEditProfileContent = view.findViewById(R.id.edit_profile_content);
         mProfileBannerView = (ImageView) view.findViewById(R.id.profile_banner);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java
index 7c165a4b16..c1479cfcc9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java
@@ -98,8 +98,8 @@ public void onActivityCreated(@Nullable Bundle savedInstanceState) {
     }
 
     @Override
-    public void onBaseViewCreated(View view, Bundle savedInstanceState) {
-        super.onBaseViewCreated(view, savedInstanceState);
+    public void onViewCreated(View view, Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
         mPollContainer = (TableLayout) view.findViewById(R.id.poll_container);
         mPollSummary = (TextView) view.findViewById(R.id.poll_summary);
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ColorPickerPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ColorPickerPreference.java
index dc7d55211e..66abcdabf9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/ColorPickerPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ColorPickerPreference.java
@@ -27,7 +27,6 @@
 import android.os.Bundle;
 import android.support.annotation.NonNull;
 import android.support.v4.content.ContextCompat;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.DialogPreference;
 import android.support.v7.preference.PreferenceDialogFragmentCompat;
 import android.support.v7.preference.PreferenceFragmentCompat;
@@ -37,6 +36,9 @@
 import android.view.View;
 import android.widget.ImageView;
 
+import com.afollestad.materialdialogs.DialogAction;
+import com.afollestad.materialdialogs.MaterialDialog;
+
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
@@ -105,7 +107,7 @@ public boolean isAlphaSliderEnabled() {
     }
 
     public static final class ColorPickerPreferenceDialogFragment extends PreferenceDialogFragmentCompat
-            implements DialogInterface.OnShowListener {
+            implements DialogInterface.OnShowListener, MaterialDialog.SingleButtonCallback {
 
         private ColorPickerDialog.Controller mController;
 
@@ -123,13 +125,15 @@ public static ColorPickerPreferenceDialogFragment newInstance(String key) {
         public Dialog onCreateDialog(Bundle savedInstanceState) {
             final ColorPickerPreference preference = (ColorPickerPreference) getPreference();
             final Context context = getContext();
-            final AlertDialog.Builder builder = new AlertDialog.Builder(context);
-            builder.setTitle(preference.getDialogTitle());
-            builder.setView(R.layout.cp__dialog_color_picker);
-
-            builder.setPositiveButton(context.getString(android.R.string.ok), this);
-            builder.setNegativeButton(context.getString(android.R.string.cancel), this);
-            AlertDialog dialog = builder.create();
+            final MaterialDialog.Builder builder = new MaterialDialog.Builder(context);
+            builder.title(preference.getDialogTitle());
+            builder.customView(R.layout.cp__dialog_color_picker, false);
+
+            builder.positiveText(android.R.string.ok);
+            builder.negativeText(android.R.string.cancel);
+            builder.onPositive(this);
+            builder.onNegative(this);
+            Dialog dialog = builder.build();
             dialog.setOnShowListener(this);
             return dialog;
         }
@@ -148,7 +152,7 @@ public void onDialogClosed(boolean positive) {
         @Override
         public void onShow(DialogInterface dialog) {
             final ColorPickerPreference preference = (ColorPickerPreference) getPreference();
-            final AlertDialog alertDialog = (AlertDialog) dialog;
+            final Dialog alertDialog = (Dialog) dialog;
             final View windowView = alertDialog.getWindow().getDecorView();
             if (windowView == null) return;
             mController = new ColorPickerDialog.Controller(getContext(), windowView);
@@ -158,6 +162,21 @@ public void onShow(DialogInterface dialog) {
             }
             mController.setInitialColor(preference.getValue());
         }
+
+        @Override
+        public void onClick(@NonNull MaterialDialog materialDialog, @NonNull DialogAction dialogAction) {
+            switch (dialogAction) {
+                case POSITIVE:
+                    onClick(materialDialog, DialogInterface.BUTTON_POSITIVE);
+                    break;
+                case NEUTRAL:
+                    onClick(materialDialog, DialogInterface.BUTTON_NEUTRAL);
+                    break;
+                case NEGATIVE:
+                    onClick(materialDialog, DialogInterface.BUTTON_NEGATIVE);
+                    break;
+            }
+        }
     }
 
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ComponentPickerPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ComponentPickerPreference.java
index c3d6038cdf..46bbc6cb81 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/ComponentPickerPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ComponentPickerPreference.java
@@ -30,7 +30,7 @@
 
 import java.util.List;
 
-public abstract class ComponentPickerPreference extends ListPreference {
+public abstract class ComponentPickerPreference extends ThemedListPreference {
 
     protected final PackageManager packageManager;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/DefaultAPIPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/DefaultAPIPreference.java
index bde2100dba..0b4be3dbdc 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/DefaultAPIPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/DefaultAPIPreference.java
@@ -25,9 +25,7 @@
 import android.content.SharedPreferences;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.DialogPreference;
-import android.support.v7.preference.PreferenceDialogFragmentCompat;
 import android.support.v7.preference.PreferenceFragmentCompat;
 import android.text.TextUtils;
 import android.util.AttributeSet;
@@ -44,6 +42,7 @@
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.APIEditorActivity;
+import org.mariotaku.twidere.fragment.ThemedPreferenceDialogFragmentCompat;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
 import org.mariotaku.twidere.provider.TwidereDataStore.Accounts;
@@ -59,6 +58,7 @@ public DefaultAPIPreference(final Context context, final AttributeSet attrs) {
 
     public DefaultAPIPreference(final Context context, final AttributeSet attrs, final int defStyle) {
         super(context, attrs, defStyle);
+        setDialogLayoutResource(R.layout.layout_api_editor);
     }
 
     @Override
@@ -68,7 +68,7 @@ public void displayDialog(PreferenceFragmentCompat fragment) {
         df.show(fragment.getFragmentManager(), getKey());
     }
 
-    public static final class DefaultAPIPreferenceDialogFragment extends PreferenceDialogFragmentCompat {
+    public static final class DefaultAPIPreferenceDialogFragment extends ThemedPreferenceDialogFragmentCompat {
 
         public static DefaultAPIPreferenceDialogFragment newInstance(String key) {
             final DefaultAPIPreferenceDialogFragment df = new DefaultAPIPreferenceDialogFragment();
@@ -90,28 +90,22 @@ public static DefaultAPIPreferenceDialogFragment newInstance(String key) {
         @Override
         public Dialog onCreateDialog(final Bundle savedInstanceState) {
             final DialogPreference preference = getPreference();
-            AlertDialog.Builder builder = new AlertDialog.Builder(getContext());
-            builder.setView(R.layout.layout_api_editor);
-            builder.setTitle(preference.getDialogTitle());
-            builder.setPositiveButton(android.R.string.ok, this);
-            builder.setNegativeButton(android.R.string.cancel, this);
-
-            final AlertDialog dialog = builder.create();
+            final Dialog dialog = super.onCreateDialog(savedInstanceState);
             dialog.setOnShowListener(new DialogInterface.OnShowListener() {
                 @Override
                 public void onShow(DialogInterface dialog) {
-                    final AlertDialog alertDialog = (AlertDialog) dialog;
-                    mEditAPIUrlFormat = (EditText) alertDialog.findViewById(R.id.api_url_format);
-                    mEditAuthType = (RadioGroup) alertDialog.findViewById(R.id.auth_type);
-                    mButtonOAuth = (RadioButton) alertDialog.findViewById(R.id.oauth);
-                    mButtonxAuth = (RadioButton) alertDialog.findViewById(R.id.xauth);
-                    mButtonBasic = (RadioButton) alertDialog.findViewById(R.id.basic);
-                    mButtonTwipOMode = (RadioButton) alertDialog.findViewById(R.id.twip_o);
-                    mEditSameOAuthSigningUrl = (CheckBox) alertDialog.findViewById(R.id.same_oauth_signing_url);
-                    mEditNoVersionSuffix = (CheckBox) alertDialog.findViewById(R.id.no_version_suffix);
-                    mEditConsumerKey = (EditText) alertDialog.findViewById(R.id.consumer_key);
-                    mEditConsumerSecret = (EditText) alertDialog.findViewById(R.id.consumer_secret);
-                    mAPIFormatHelpButton = alertDialog.findViewById(R.id.api_url_format_help);
+                    final Dialog editDialog = (Dialog) dialog;
+                    mEditAPIUrlFormat = (EditText) editDialog.findViewById(R.id.api_url_format);
+                    mEditAuthType = (RadioGroup) editDialog.findViewById(R.id.auth_type);
+                    mButtonOAuth = (RadioButton) editDialog.findViewById(R.id.oauth);
+                    mButtonxAuth = (RadioButton) editDialog.findViewById(R.id.xauth);
+                    mButtonBasic = (RadioButton) editDialog.findViewById(R.id.basic);
+                    mButtonTwipOMode = (RadioButton) editDialog.findViewById(R.id.twip_o);
+                    mEditSameOAuthSigningUrl = (CheckBox) editDialog.findViewById(R.id.same_oauth_signing_url);
+                    mEditNoVersionSuffix = (CheckBox) editDialog.findViewById(R.id.no_version_suffix);
+                    mEditConsumerKey = (EditText) editDialog.findViewById(R.id.consumer_key);
+                    mEditConsumerSecret = (EditText) editDialog.findViewById(R.id.consumer_secret);
+                    mAPIFormatHelpButton = editDialog.findViewById(R.id.api_url_format_help);
 
                     mEditNoVersionSuffix.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                         @Override
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/LinkHighlightPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/LinkHighlightPreference.java
index 74160afd7b..19392f5b4e 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/LinkHighlightPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/LinkHighlightPreference.java
@@ -20,7 +20,6 @@
 package org.mariotaku.twidere.preference;
 
 import android.content.Context;
-import android.support.v7.preference.ListPreference;
 import android.support.v7.preference.PreferenceViewHolder;
 import android.text.SpannableString;
 import android.util.AttributeSet;
@@ -29,7 +28,7 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.text.TwidereHighLightStyle;
 
-public class LinkHighlightPreference extends ListPreference implements Constants {
+public class LinkHighlightPreference extends ThemedListPreference implements Constants {
 
     private static final int[] ENTRIES_RES = {R.string.none, R.string.highlight, R.string.underline,
             R.string.highlight_and_underline};
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/MultiSelectListPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/MultiSelectListPreference.java
index cd9674abdb..75563543b5 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/MultiSelectListPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/MultiSelectListPreference.java
@@ -27,12 +27,13 @@
 import android.content.SharedPreferences;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.DialogPreference;
 import android.support.v7.preference.PreferenceDialogFragmentCompat;
 import android.support.v7.preference.PreferenceFragmentCompat;
 import android.util.AttributeSet;
 
+import com.afollestad.materialdialogs.AlertDialogWrapper;
+
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
 
@@ -90,7 +91,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
                 throw new IllegalArgumentException();
             mValues = new boolean[length];
             mPreferences = preference.getDefaultSharedPreferences();
-            final AlertDialog.Builder builder = new AlertDialog.Builder(getContext());
+            final AlertDialogWrapper.Builder builder = new AlertDialogWrapper.Builder(getContext());
             for (int i = 0; i < length; i++) {
                 mValues[i] = mPreferences.getBoolean(mKeys[i], mDefaultValues[i]);
             }
@@ -101,26 +102,15 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
             return builder.create();
         }
 
-
-        @Override
-        public void onClick(final DialogInterface dialog, final int which) {
-            if (mPreferences == null) return;
-            switch (which) {
-                case DialogInterface.BUTTON_POSITIVE:
-                    final SharedPreferences.Editor editor = mPreferences.edit();
-                    final int length = mKeys.length;
-                    for (int i = 0; i < length; i++) {
-                        editor.putBoolean(mKeys[i], mValues[i]);
-                    }
-                    editor.apply();
-                    break;
-            }
-
-        }
-
         @Override
         public void onDialogClosed(boolean positive) {
-
+            if (mPreferences == null || !positive) return;
+            final SharedPreferences.Editor editor = mPreferences.edit();
+            final int length = mKeys.length;
+            for (int i = 0; i < length; i++) {
+                editor.putBoolean(mKeys[i], mValues[i]);
+            }
+            editor.apply();
         }
 
         @Override
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/RingtonePreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/RingtonePreference.java
index e89cf21e1b..1c70ecfb5b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/RingtonePreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/RingtonePreference.java
@@ -20,7 +20,6 @@
 import android.app.Dialog;
 import android.content.Context;
 import android.content.DialogInterface;
-import android.content.DialogInterface.OnClickListener;
 import android.content.res.TypedArray;
 import android.database.Cursor;
 import android.media.MediaPlayer;
@@ -33,11 +32,14 @@
 import android.support.v4.content.CursorLoader;
 import android.support.v4.content.Loader;
 import android.support.v4.widget.SimpleCursorAdapter;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.DialogPreference;
 import android.support.v7.preference.PreferenceDialogFragmentCompat;
 import android.support.v7.preference.PreferenceFragmentCompat;
 import android.util.AttributeSet;
+import android.view.View;
+
+import com.afollestad.materialdialogs.DialogAction;
+import com.afollestad.materialdialogs.MaterialDialog;
 
 import org.mariotaku.sqliteqb.library.Expression;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
@@ -112,14 +114,32 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
             a.recycle();
             mAdapter = new SimpleCursorAdapter(context, layout, null, new String[]{Audio.Media.TITLE}, new int[]{android.R.id.text1}, 0);
 
-            final AlertDialog.Builder builder = new AlertDialog.Builder(context);
-            builder.setTitle(getPreference().getDialogTitle());
-            builder.setPositiveButton(android.R.string.ok, this);
-            builder.setNegativeButton(android.R.string.cancel, this);
+            final MaterialDialog.Builder builder = new MaterialDialog.Builder(context);
+            builder.title(getPreference().getDialogTitle());
+            builder.positiveText(android.R.string.ok);
+            builder.negativeText(android.R.string.cancel);
+            builder.onPositive(new MaterialDialog.SingleButtonCallback() {
+                @Override
+                public void onClick(@NonNull MaterialDialog materialDialog, @NonNull DialogAction dialogAction) {
+                    RingtonePreferenceDialogFragment.this.onClick(materialDialog, DialogInterface.BUTTON_POSITIVE);
+                }
+            });
+            builder.onNegative(new MaterialDialog.SingleButtonCallback() {
+                @Override
+                public void onClick(@NonNull MaterialDialog materialDialog, @NonNull DialogAction dialogAction) {
+                    RingtonePreferenceDialogFragment.this.onClick(materialDialog, DialogInterface.BUTTON_NEGATIVE);
+                }
+            });
+            builder.cancelListener(new DialogInterface.OnCancelListener() {
+                @Override
+                public void onCancel(DialogInterface dialog) {
+                    RingtonePreferenceDialogFragment.this.onClick(dialog, DialogInterface.BUTTON_NEGATIVE);
+                }
+            });
             int checkedItem = -1;
-            builder.setSingleChoiceItems(mAdapter, checkedItem, new OnClickListener() {
+            builder.adapter(mAdapter, new MaterialDialog.ListCallback() {
                 @Override
-                public void onClick(DialogInterface dialog, int which) {
+                public void onSelection(MaterialDialog dialog, View view, int which, CharSequence text) {
                     if (mMediaPlayer != null) {
                         if (mMediaPlayer.isPlaying()) {
                             mMediaPlayer.stop();
@@ -143,7 +163,7 @@ public void onClick(DialogInterface dialog, int which) {
                 }
             });
             getLoaderManager().initLoader(0, null, this);
-            return builder.create();
+            return builder.build();
         }
 
         @Override
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/SeekBarDialogPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/SeekBarDialogPreference.java
index a79835fcfd..d7b069bc3a 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/SeekBarDialogPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/SeekBarDialogPreference.java
@@ -21,15 +21,21 @@
 
 import android.content.Context;
 import android.content.res.TypedArray;
+import android.os.Bundle;
 import android.os.Parcel;
 import android.os.Parcelable;
 import android.support.annotation.NonNull;
 import android.support.v7.preference.DialogPreference;
+import android.support.v7.preference.PreferenceFragmentCompat;
+import android.text.TextUtils;
 import android.util.AttributeSet;
+import android.view.View;
 import android.widget.SeekBar;
 import android.widget.TextView;
 
 import org.mariotaku.twidere.R;
+import org.mariotaku.twidere.fragment.ThemedPreferenceDialogFragmentCompat;
+import org.mariotaku.twidere.preference.iface.IDialogPreference;
 
 /**
  * A {@link DialogPreference} that provides a user with the means to select an
@@ -37,7 +43,7 @@
  *
  * @author lukehorvat
  */
-public class SeekBarDialogPreference extends DialogPreference {
+public class SeekBarDialogPreference extends DialogPreference implements IDialogPreference {
     private static final int DEFAULT_MIN_PROGRESS = 0;
     private static final int DEFAULT_MAX_PROGRESS = 100;
     private static final int DEFAULT_PROGRESS = 0;
@@ -49,8 +55,7 @@ public class SeekBarDialogPreference extends DialogPreference {
     private int mStep;
 
     private CharSequence mProgressTextSuffix;
-    private TextView mProgressText;
-    private SeekBar mSeekBar;
+
 
     public SeekBarDialogPreference(final Context context) {
         this(context, null);
@@ -129,54 +134,6 @@ public void setProgressTextSuffix(final CharSequence progressTextSuffix) {
         mProgressTextSuffix = progressTextSuffix;
     }
 
-//    @Override
-//    protected void onBindDialogView(@NonNull final View view) {
-//        super.onBindDialogView(view);
-//
-//        final CharSequence message = getDialogMessage();
-//        final TextView dialogMessageText = (TextView) view.findViewById(R.id.text_dialog_message);
-//        dialogMessageText.setText(message);
-//        dialogMessageText.setVisibility(TextUtils.isEmpty(message) ? View.GONE : View.VISIBLE);
-//
-//        mProgressText = (TextView) view.findViewById(R.id.text_progress);
-//
-//        mSeekBar = (SeekBar) view.findViewById(R.id.seek_bar);
-//        mSeekBar.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {
-//            @Override
-//            public void onProgressChanged(final SeekBar seekBar, final int progress, final boolean fromUser) {
-//                // update text that displays the current SeekBar progress value
-//                // note: this does not persist the progress value. that is only
-//                // ever done in setProgress()
-//                final String progressStr = String.valueOf(progress * mStep + mMinProgress);
-//                mProgressText.setText(mProgressTextSuffix == null ? progressStr : progressStr
-//                        .concat(mProgressTextSuffix.toString()));
-//            }
-//
-//            @Override
-//            public void onStartTrackingTouch(final SeekBar seekBar) {
-//            }
-//
-//            @Override
-//            public void onStopTrackingTouch(final SeekBar seekBar) {
-//            }
-//        });
-//        mSeekBar.setMax((int) Math.ceil((mMaxProgress - mMinProgress) / (double) mStep));
-//        mSeekBar.setProgress((int) Math.ceil((mProgress - mMinProgress) / (double) mStep));
-//    }
-
-//    @Override
-//    protected void onDialogClosed(final boolean positiveResult) {
-//        super.onDialogClosed(positiveResult);
-//
-//        // when the user selects "OK", persist the new value
-//        if (positiveResult) {
-//            final int realProgress = mSeekBar.getProgress() * mStep + mMinProgress;
-//            if (callChangeListener(realProgress)) {
-//                setProgress(realProgress);
-//            }
-//        }
-//    }
-
     @Override
     protected Object onGetDefaultValue(final TypedArray a, final int index) {
         return a.getInt(index, DEFAULT_PROGRESS);
@@ -226,6 +183,85 @@ protected void onSetInitialValue(final boolean restore, final Object defaultValu
         setProgress(restore ? getPersistedInt(DEFAULT_PROGRESS) : (Integer) defaultValue);
     }
 
+    @Override
+    public void displayDialog(PreferenceFragmentCompat fragment) {
+        SeekBarDialogPreferenceFragment df = SeekBarDialogPreferenceFragment.newInstance(getKey());
+        df.setTargetFragment(fragment, 0);
+        df.show(fragment.getFragmentManager(), getKey());
+    }
+
+    public static class SeekBarDialogPreferenceFragment extends ThemedPreferenceDialogFragmentCompat {
+
+        public static SeekBarDialogPreferenceFragment newInstance(String key) {
+            final SeekBarDialogPreferenceFragment fragment = new SeekBarDialogPreferenceFragment();
+            final Bundle args = new Bundle();
+            args.putString(ARG_KEY, key);
+            fragment.setArguments(args);
+            return fragment;
+        }
+
+        private TextView mProgressText;
+        private SeekBar mSeekBar;
+
+        @Override
+        protected void onBindDialogView(View view) {
+            super.onBindDialogView(view);
+            final SeekBarDialogPreference preference = (SeekBarDialogPreference) getPreference();
+            final CharSequence message = preference.getDialogMessage();
+            final TextView dialogMessageText = (TextView) view.findViewById(R.id.text_dialog_message);
+            dialogMessageText.setText(message);
+            dialogMessageText.setVisibility(TextUtils.isEmpty(message) ? View.GONE : View.VISIBLE);
+
+            mProgressText = (TextView) view.findViewById(R.id.text_progress);
+
+            mSeekBar = (SeekBar) view.findViewById(R.id.seek_bar);
+            mSeekBar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
+                @Override
+                public void onProgressChanged(final SeekBar seekBar, final int progress, final boolean fromUser) {
+                    // update text that displays the current SeekBar progress value
+                    // note: this does not persist the progress value. that is only
+                    // ever done in setProgress()
+                    final int step = preference.getStep();
+                    final int minProgress = preference.getMinProgress();
+                    final String progressStr = String.valueOf(progress * step + minProgress);
+                    final CharSequence progressTextSuffix = preference.getProgressTextSuffix();
+                    if (progressTextSuffix == null) {
+                        mProgressText.setText(progressStr);
+                    } else {
+                        mProgressText.setText(progressStr.concat(progressTextSuffix.toString()));
+                    }
+                }
+
+                @Override
+                public void onStartTrackingTouch(final SeekBar seekBar) {
+                }
+
+                @Override
+                public void onStopTrackingTouch(final SeekBar seekBar) {
+                }
+            });
+            final int maxProgress = preference.getMaxProgress();
+            final int minProgress = preference.getMinProgress();
+            final int step = preference.getStep();
+            final int progress = preference.getProgress();
+            mSeekBar.setMax((int) Math.ceil((maxProgress - minProgress) / (double) step));
+            mSeekBar.setProgress((int) Math.ceil((progress - minProgress) / (double) step));
+        }
+
+        @Override
+        public void onDialogClosed(boolean positive) {
+            if (positive) {
+                final SeekBarDialogPreference preference = (SeekBarDialogPreference) getPreference();
+                final int minProgress = preference.getMinProgress();
+                final int step = preference.getStep();
+                final int realProgress = mSeekBar.getProgress() * step + minProgress;
+                if (preference.callChangeListener(realProgress)) {
+                    preference.setProgress(realProgress);
+                }
+            }
+        }
+    }
+
     private static class SavedState extends BaseSavedState {
         int minProgress;
         int maxProgress;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeBackgroundPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeBackgroundPreference.java
index bc948d5e6a..dbfe036e0f 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeBackgroundPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeBackgroundPreference.java
@@ -8,7 +8,6 @@
 import android.content.res.Resources;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.DialogPreference;
 import android.support.v7.preference.PreferenceDialogFragmentCompat;
 import android.support.v7.preference.PreferenceFragmentCompat;
@@ -17,9 +16,13 @@
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
+import android.widget.AdapterView;
 import android.widget.ListView;
 import android.widget.SeekBar;
 
+import com.afollestad.materialdialogs.AlertDialogWrapper;
+import com.afollestad.materialdialogs.MaterialDialog;
+
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
@@ -147,7 +150,7 @@ private void updateAlphaVisibility() {
         @NonNull
         @Override
         public Dialog onCreateDialog(Bundle savedInstanceState) {
-            AlertDialog.Builder builder = new AlertDialog.Builder(getContext());
+            AlertDialogWrapper.Builder builder = new AlertDialogWrapper.Builder(getContext());
             final ThemeBackgroundPreference preference = (ThemeBackgroundPreference) getPreference();
             final SharedPreferences preferences = preference.getSharedPreferences();
             preference.setValue(preference.getPersistedString(null));
@@ -161,14 +164,15 @@ public void onClick(DialogInterface dialog, int which) {
             });
             builder.setPositiveButton(android.R.string.ok, this);
             builder.setNegativeButton(android.R.string.cancel, this);
-            final AlertDialog dialog = builder.create();
+            final Dialog dialog = builder.create();
             dialog.setOnShowListener(new DialogInterface.OnShowListener() {
                 @Override
                 public void onShow(DialogInterface dialog) {
-                    if (dialog instanceof AlertDialog && preferences != null) {
-                        AlertDialog alertDialog = (AlertDialog) dialog;
-                        final LayoutInflater inflater = alertDialog.getLayoutInflater();
-                        final ListView listView = alertDialog.getListView();
+                    if (preferences != null) {
+                        final MaterialDialog materialDialog = (MaterialDialog) dialog;
+                        final LayoutInflater inflater = materialDialog.getLayoutInflater();
+                        final ListView listView = materialDialog.getListView();
+                        assert listView != null;
                         final ViewGroup listViewParent = (ViewGroup) listView.getParent();
                         listViewParent.removeView(listView);
                         final View view = inflater.inflate(R.layout.dialog_theme_background_preference, listViewParent);
@@ -177,6 +181,14 @@ public void onShow(DialogInterface dialog) {
                         mAlphaSlider = (SeekBar) view.findViewById(R.id.alpha_slider);
                         mAlphaSlider.setMax(MAX_ALPHA - MIN_ALPHA);
                         mAlphaSlider.setProgress(preferences.getInt(KEY_THEME_BACKGROUND_ALPHA, DEFAULT_THEME_BACKGROUND_ALPHA) - MIN_ALPHA);
+                        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
+                            @Override
+                            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
+                                materialDialog.onItemClick(parent, view, position, id);
+                                preference.setSelectedOption(position);
+                                updateAlphaVisibility();
+                            }
+                        });
                         updateAlphaVisibility();
                     }
                 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeFontFamilyPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeFontFamilyPreference.java
index ba1bab4561..f623008146 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeFontFamilyPreference.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemeFontFamilyPreference.java
@@ -21,7 +21,6 @@
 
 import android.content.Context;
 import android.os.Build;
-import android.support.v7.preference.ListPreference;
 import android.text.SpannableString;
 import android.text.style.TypefaceSpan;
 import android.util.AttributeSet;
@@ -29,7 +28,7 @@
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 
-public class ThemeFontFamilyPreference extends ListPreference implements Constants {
+public class ThemeFontFamilyPreference extends ThemedListPreference implements Constants {
 
     private static final int[] ENTRIES_RES = {R.string.font_family_regular, R.string.font_family_condensed,
             R.string.font_family_light};
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedEditTextPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedEditTextPreference.java
new file mode 100644
index 0000000000..7cb9179b1b
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedEditTextPreference.java
@@ -0,0 +1,37 @@
+package org.mariotaku.twidere.preference;
+
+import android.content.Context;
+import android.support.v7.preference.EditTextPreference;
+import android.support.v7.preference.PreferenceFragmentCompat;
+import android.util.AttributeSet;
+
+import org.mariotaku.twidere.fragment.ThemedEditTextPreferenceDialogFragmentCompat;
+import org.mariotaku.twidere.preference.iface.IDialogPreference;
+
+/**
+ * Created by mariotaku on 16/3/15.
+ */
+public class ThemedEditTextPreference extends EditTextPreference implements IDialogPreference {
+    public ThemedEditTextPreference(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
+        super(context, attrs, defStyleAttr, defStyleRes);
+    }
+
+    public ThemedEditTextPreference(Context context, AttributeSet attrs, int defStyleAttr) {
+        super(context, attrs, defStyleAttr);
+    }
+
+    public ThemedEditTextPreference(Context context, AttributeSet attrs) {
+        super(context, attrs);
+    }
+
+    public ThemedEditTextPreference(Context context) {
+        super(context);
+    }
+
+    @Override
+    public void displayDialog(PreferenceFragmentCompat fragment) {
+        ThemedEditTextPreferenceDialogFragmentCompat df = ThemedEditTextPreferenceDialogFragmentCompat.newInstance(getKey());
+        df.setTargetFragment(fragment, 0);
+        df.show(fragment.getFragmentManager(), getKey());
+    }
+}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedListPreference.java b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedListPreference.java
new file mode 100644
index 0000000000..c221237b5f
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/preference/ThemedListPreference.java
@@ -0,0 +1,37 @@
+package org.mariotaku.twidere.preference;
+
+import android.content.Context;
+import android.support.v7.preference.ListPreference;
+import android.support.v7.preference.PreferenceFragmentCompat;
+import android.util.AttributeSet;
+
+import org.mariotaku.twidere.fragment.ThemedListPreferenceDialogFragmentCompat;
+import org.mariotaku.twidere.preference.iface.IDialogPreference;
+
+/**
+ * Created by mariotaku on 16/3/15.
+ */
+public class ThemedListPreference extends ListPreference implements IDialogPreference {
+    public ThemedListPreference(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
+        super(context, attrs, defStyleAttr, defStyleRes);
+    }
+
+    public ThemedListPreference(Context context, AttributeSet attrs, int defStyleAttr) {
+        super(context, attrs, defStyleAttr);
+    }
+
+    public ThemedListPreference(Context context, AttributeSet attrs) {
+        super(context, attrs);
+    }
+
+    public ThemedListPreference(Context context) {
+        super(context);
+    }
+
+    @Override
+    public void displayDialog(PreferenceFragmentCompat fragment) {
+        ThemedListPreferenceDialogFragmentCompat df = ThemedListPreferenceDialogFragmentCompat.newInstance(getKey());
+        df.setTargetFragment(fragment, 0);
+        df.show(fragment.getFragmentManager(), getKey());
+    }
+}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/TwidereActionModeForChildListener.java b/twidere/src/main/java/org/mariotaku/twidere/util/TwidereActionModeForChildListener.java
deleted file mode 100644
index 8015c230b1..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/util/TwidereActionModeForChildListener.java
+++ /dev/null
@@ -1,255 +0,0 @@
-/*
- * Twidere - Twitter client for Android
- *
- *  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
- *
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.util;
-
-import android.app.Activity;
-import android.content.Context;
-import android.graphics.Rect;
-import android.support.v4.view.ViewCompat;
-import android.support.v7.app.ActionBar;
-import android.support.v7.app.AppCompatCallback;
-import android.support.v7.app.AppCompatUtils;
-import android.support.v7.view.ActionMode;
-import android.support.v7.view.StandaloneActionMode;
-import android.support.v7.view.SupportActionModeWrapper;
-import android.support.v7.widget.ActionBarContextView;
-import android.support.v7.widget.Toolbar;
-import android.util.TypedValue;
-import android.view.Gravity;
-import android.view.Menu;
-import android.view.MenuItem;
-import android.view.View;
-import android.view.ViewGroup;
-import android.view.Window;
-import android.view.accessibility.AccessibilityEvent;
-import android.widget.PopupWindow;
-
-import org.mariotaku.twidere.activity.iface.IAppCompatActivity;
-import org.mariotaku.twidere.activity.iface.IThemedActivity;
-import org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout;
-
-/**
- * Created by mariotaku on 15/4/27.
- */
-public class TwidereActionModeForChildListener implements TintedStatusNativeActionModeAwareLayout.OnActionModeForChildListener {
-    private final Activity mActivity;
-    private final IThemedActivity mThemed;
-    private final AppCompatCallback mAppCompatCallback;
-    private final Window mWindow;
-
-    private ActionMode mActionMode;
-    public ActionBarContextView mActionModeView;
-    public PopupWindow mActionModePopup;
-    public Runnable mShowActionModePopup;
-
-    public TwidereActionModeForChildListener(IThemedActivity activity, AppCompatCallback callback, boolean usePopup) {
-        mActivity = (Activity) activity;
-        mThemed = activity;
-        mWindow = mActivity.getWindow();
-        mAppCompatCallback = callback;
-    }
-
-    @Override
-    public android.view.ActionMode startActionModeForChild(View originalView, android.view.ActionMode.Callback callback) {
-        // Try and start a support action mode, wrapping the callback
-        final ActionMode supportActionMode = startSupportActionMode(
-                new SupportActionModeWrapper.CallbackWrapper(mActivity, callback));
-        if (supportActionMode == null) {
-            return mActivity.startActionMode(callback);
-        }
-        return new SupportActionModeWrapper(mActivity, supportActionMode);
-    }
-
-    public ActionMode startSupportActionMode(ActionMode.Callback callback) {
-        if (callback == null) {
-            throw new IllegalArgumentException("ActionMode callback can not be null.");
-        }
-
-        if (mActionMode != null) {
-            mActionMode.finish();
-        }
-
-        final ActionMode.Callback wrappedCallback = new ActionModeCallbackWrapper(callback);
-
-        if (mActionMode == null) {
-            // If the action bar didn't provide an action mode, start the emulated window one
-            mActionMode = startSupportActionModeFromWindow(wrappedCallback);
-        }
-
-        return mActionMode;
-    }
-
-    ActionMode startSupportActionModeFromWindow(ActionMode.Callback callback) {
-        if (mActionMode != null) {
-            mActionMode.finish();
-        }
-
-        final ActionMode.Callback wrappedCallback = new ActionModeCallbackWrapper(callback);
-
-        if (mActionModeView == null) {
-            // Use the action bar theme.
-            final Context actionBarContext;
-            actionBarContext = ThemeUtils.getActionBarThemedContext(mActivity,
-                    mThemed.getCurrentThemeColor());
-
-            mActionModeView = new ActionBarContextView(actionBarContext);
-            mActionModePopup = new PopupWindow(actionBarContext, null,
-                    android.support.v7.appcompat.R.attr.actionModePopupWindowStyle);
-            mActionModePopup.setContentView(mActionModeView);
-
-            final TypedValue outValue = new TypedValue();
-            actionBarContext.getTheme().resolveAttribute(
-                    android.support.v7.appcompat.R.attr.actionBarSize, outValue, true);
-            final int height = TypedValue.complexToDimensionPixelSize(outValue.data,
-                    actionBarContext.getResources().getDisplayMetrics());
-            mActionModeView.setContentHeight(height);
-            ThemeUtils.setActionBarContextViewBackground(mActionModeView,
-                    mThemed.getCurrentThemeColor(),
-                    mThemed.getCurrentThemeBackgroundOption(), false);
-            mActionModePopup.setHeight(ViewGroup.LayoutParams.WRAP_CONTENT);
-            final Rect actionModeBounds = getActionModeBounds();
-            if (actionModeBounds != null) {
-                mActionModePopup.setWidth(actionModeBounds.width());
-            } else {
-                mActionModePopup.setWidth(ViewGroup.LayoutParams.MATCH_PARENT);
-            }
-            mShowActionModePopup = new Runnable() {
-                @Override
-                public void run() {
-                    if (actionModeBounds != null) {
-                        mActionModePopup.showAtLocation(mWindow.getDecorView(), Gravity.TOP | Gravity.LEFT,
-                                actionModeBounds.left, actionModeBounds.top);
-                    } else {
-                        mActionModePopup.showAtLocation(mWindow.getDecorView(), Gravity.TOP | Gravity.LEFT, 0, 0);
-                    }
-                }
-            };
-        }
-
-        if (mActionModeView != null) {
-            mActionModeView.killMode();
-            ActionMode mode = new StandaloneActionMode(mActionModeView.getContext(),
-                    mActionModeView, wrappedCallback, mActionModePopup == null);
-            if (callback.onCreateActionMode(mode, mode.getMenu())) {
-                mode.invalidate();
-                mActionModeView.initForMode(mode);
-                mActionModeView.setVisibility(View.VISIBLE);
-                mActionMode = mode;
-                if (mActionModePopup != null) {
-                    mWindow.getDecorView().post(mShowActionModePopup);
-                }
-                mActionModeView.sendAccessibilityEvent(
-                        AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED);
-
-                if (mActionModeView.getParent() != null) {
-                    ViewCompat.requestApplyInsets((View) mActionModeView.getParent());
-                }
-            } else {
-                mActionMode = null;
-            }
-
-        }
-        if (mActionMode != null && mAppCompatCallback != null) {
-            mAppCompatCallback.onSupportActionModeStarted(mActionMode);
-        }
-        return mActionMode;
-    }
-
-    private Rect getActionModeBounds() {
-        if (mActivity instanceof IAppCompatActivity) {
-            final Rect bounds = new Rect();
-            final int[] location = new int[2];
-            final ActionBar actionBar = ((IAppCompatActivity) mActivity).getSupportActionBar();
-            final Toolbar toolbar = AppCompatUtils.findToolbarForActionBar(actionBar);
-            if (toolbar != null) {
-                toolbar.getLocationInWindow(location);
-                bounds.left = location[0];
-                bounds.top = location[1];
-                bounds.right = bounds.left + toolbar.getWidth();
-                bounds.bottom = bounds.top + toolbar.getHeight();
-                return bounds;
-            }
-        }
-        return null;
-    }
-
-    public boolean finishExisting() {
-        if (mActionMode != null) {
-            mActionMode.finish();
-            return true;
-        }
-        return false;
-    }
-
-    public void setModeTranslationY(int translationY) {
-        if (mActionModeView != null) {
-            mActionModeView.setTranslationY(translationY);
-        }
-    }
-
-
-    /**
-     * Clears out internal reference when the action mode is destroyed.
-     */
-    class ActionModeCallbackWrapper implements ActionMode.Callback {
-        private ActionMode.Callback mWrapped;
-
-        public ActionModeCallbackWrapper(ActionMode.Callback wrapped) {
-            mWrapped = wrapped;
-        }
-
-        @Override
-        public boolean onCreateActionMode(ActionMode mode, Menu menu) {
-            return mWrapped.onCreateActionMode(mode, menu);
-        }
-
-        @Override
-        public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
-            return mWrapped.onPrepareActionMode(mode, menu);
-        }
-
-        @Override
-        public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
-            return mWrapped.onActionItemClicked(mode, item);
-        }
-
-        @Override
-        public void onDestroyActionMode(ActionMode mode) {
-            mWrapped.onDestroyActionMode(mode);
-            if (mActionModePopup != null) {
-                mWindow.getDecorView().removeCallbacks(mShowActionModePopup);
-                mActionModePopup.dismiss();
-            } else if (mActionModeView != null) {
-                mActionModeView.setVisibility(View.GONE);
-                if (mActionModeView.getParent() != null) {
-                    ViewCompat.requestApplyInsets((View) mActionModeView.getParent());
-                }
-            }
-            if (mActionModeView != null) {
-                mActionModeView.removeAllViews();
-            }
-            if (mAppCompatCallback != null) {
-                mAppCompatCallback.onSupportActionModeFinished(mActionMode);
-            }
-            mActionMode = null;
-        }
-    }
-
-}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/view/MainFrameLayout.java b/twidere/src/main/java/org/mariotaku/twidere/view/MainFrameLayout.java
deleted file mode 100644
index f0968384b5..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/view/MainFrameLayout.java
+++ /dev/null
@@ -1,33 +0,0 @@
-package org.mariotaku.twidere.view;
-
-import android.content.Context;
-import android.util.AttributeSet;
-
-/**
- * Created by mariotaku on 14/10/20.
- */
-public class MainFrameLayout extends TintedStatusFrameLayout {
-    public MainFrameLayout(Context context) {
-        super(context);
-    }
-
-    public MainFrameLayout(Context context, AttributeSet attrs) {
-        super(context, attrs);
-    }
-
-    public MainFrameLayout(Context context, AttributeSet attrs, int defStyleAttr) {
-        super(context, attrs, defStyleAttr);
-    }
-
-    @Override
-    public void setPadding(int left, int top, int right, int bottom) {
-        super.setPadding(left, top, right, bottom);
-    }
-
-    @Override
-    public void setStatusBarHeight(int height) {
-        setPadding(0, height, 0, 0);
-        super.setStatusBarHeight(height);
-    }
-
-}
diff --git a/twidere/src/main/res/layout/activity_content_fragment.xml b/twidere/src/main/res/layout/activity_content_fragment.xml
index eee80578b9..eb254a7678 100644
--- a/twidere/src/main/res/layout/activity_content_fragment.xml
+++ b/twidere/src/main/res/layout/activity_content_fragment.xml
@@ -17,10 +17,9 @@
   ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
   -->
 
-<org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout
+<org.mariotaku.twidere.view.ExtendedFrameLayout
     android:id="@+id/main_content"
     xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
     android:layout_height="match_parent">
 
@@ -29,26 +28,4 @@
         android:layout_width="match_parent"
         android:layout_height="match_parent"/>
 
-    <RelativeLayout
-        android:id="@+id/twidere_action_bar_with_overlay"
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:orientation="vertical">
-
-        <org.mariotaku.twidere.view.TwidereActionBarContainer
-            android:id="@+id/twidere_action_bar_container"
-            style="?attr/actionBarStyle"
-            android:layout_width="match_parent"
-            android:layout_height="?actionBarSize"
-            android:layout_alignParentTop="true"
-            android:touchscreenBlocksFocus="true"
-            tools:ignore="UnusedAttribute"/>
-
-        <View
-            android:id="@+id/window_overlay"
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:layout_below="@+id/twidere_action_bar_container"
-            android:background="?android:windowContentOverlay"/>
-    </RelativeLayout>
-</org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout>
+</org.mariotaku.twidere.view.ExtendedFrameLayout>
diff --git a/twidere/src/main/res/layout/activity_content_fragment_action_bar.xml b/twidere/src/main/res/layout/activity_content_fragment_action_bar.xml
new file mode 100644
index 0000000000..eee80578b9
--- /dev/null
+++ b/twidere/src/main/res/layout/activity_content_fragment_action_bar.xml
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ Twidere - Twitter client for Android
+  ~
+  ~  Copyright (C) 2012-2014 Mariotaku Lee <mariotaku.lee@gmail.com>
+  ~
+  ~  This program is free software: you can redistribute it and/or modify
+  ~  it under the terms of the GNU General Public License as published by
+  ~  the Free Software Foundation, either version 3 of the License, or
+  ~  (at your option) any later version.
+  ~
+  ~  This program is distributed in the hope that it will be useful,
+  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
+  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+  ~  GNU General Public License for more details.
+  ~
+  ~  You should have received a copy of the GNU General Public License
+  ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+  -->
+
+<org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout
+    android:id="@+id/main_content"
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <FrameLayout
+        android:id="@+id/content_fragment"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"/>
+
+    <RelativeLayout
+        android:id="@+id/twidere_action_bar_with_overlay"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical">
+
+        <org.mariotaku.twidere.view.TwidereActionBarContainer
+            android:id="@+id/twidere_action_bar_container"
+            style="?attr/actionBarStyle"
+            android:layout_width="match_parent"
+            android:layout_height="?actionBarSize"
+            android:layout_alignParentTop="true"
+            android:touchscreenBlocksFocus="true"
+            tools:ignore="UnusedAttribute"/>
+
+        <View
+            android:id="@+id/window_overlay"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_below="@+id/twidere_action_bar_container"
+            android:background="?android:windowContentOverlay"/>
+    </RelativeLayout>
+</org.mariotaku.twidere.view.TintedStatusNativeActionModeAwareLayout>
diff --git a/twidere/src/main/res/layout/activity_home_content.xml b/twidere/src/main/res/layout/activity_home_content.xml
index 84eda5555c..d33720e917 100644
--- a/twidere/src/main/res/layout/activity_home_content.xml
+++ b/twidere/src/main/res/layout/activity_home_content.xml
@@ -58,6 +58,7 @@
         android:layout_margin="@dimen/element_spacing_large"
         android:clickable="true"
         android:src="@drawable/ic_action_status_compose"
+        app:backgroundTint="?colorPrimary"
         app:elevation="6dp"
         app:pressedTranslationZ="12dp"/>
 
diff --git a/twidere/src/main/res/layout/fragment_content_recyclerview.xml b/twidere/src/main/res/layout/fragment_content_recyclerview.xml
index a6f5325736..1a98670f23 100644
--- a/twidere/src/main/res/layout/fragment_content_recyclerview.xml
+++ b/twidere/src/main/res/layout/fragment_content_recyclerview.xml
@@ -20,7 +20,8 @@
 <FrameLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
-    android:layout_height="match_parent">
+    android:layout_height="match_parent"
+    android:fitsSystemWindows="true">
 
     <include layout="@layout/layout_content_fragment_common"/>
 
diff --git a/twidere/src/main/res/layout/fragment_drafts.xml b/twidere/src/main/res/layout/fragment_drafts.xml
index 6fe36b9f97..54e1bd4449 100644
--- a/twidere/src/main/res/layout/fragment_drafts.xml
+++ b/twidere/src/main/res/layout/fragment_drafts.xml
@@ -21,7 +21,8 @@
     xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
-    android:layout_height="match_parent">
+    android:layout_height="match_parent"
+    android:fitsSystemWindows="true">
 
     <FrameLayout
         android:id="@+id/list_container"
diff --git a/twidere/src/main/res/layout/fragment_status.xml b/twidere/src/main/res/layout/fragment_status.xml
index fbc6196745..419bc9995c 100644
--- a/twidere/src/main/res/layout/fragment_status.xml
+++ b/twidere/src/main/res/layout/fragment_status.xml
@@ -22,10 +22,9 @@
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
-    android:descendantFocusability="beforeDescendants"
+    android:fitsSystemWindows="true"
     android:orientation="vertical">
 
-
     <RelativeLayout
         android:id="@+id/status_content"
         android:layout_width="match_parent"
@@ -47,7 +46,6 @@
             android:layout_height="wrap_content"
             android:visibility="gone"/>
 
-
     </RelativeLayout>
 
     <include layout="@layout/layout_content_fragment_common"/>
diff --git a/twidere/src/main/res/layout/fragment_user.xml b/twidere/src/main/res/layout/fragment_user.xml
index abe26c2c86..907cce8be7 100644
--- a/twidere/src/main/res/layout/fragment_user.xml
+++ b/twidere/src/main/res/layout/fragment_user.xml
@@ -17,10 +17,12 @@
   ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
   -->
 
-<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:layout_width="match_parent"
-    android:layout_height="match_parent">
+    android:layout_height="match_parent"
+    android:fitsSystemWindows="true">
 
     <org.mariotaku.twidere.view.ExtendedFrameLayout
         android:id="@+id/details_container"
@@ -37,7 +39,7 @@
                 android:id="@+id/profile_banner"
                 android:layout_width="match_parent"
                 android:layout_height="wrap_content"
-                android:scaleType="centerCrop" />
+                android:scaleType="centerCrop"/>
 
             <FrameLayout
                 android:id="@+id/profile_birthday_banner"
@@ -49,7 +51,7 @@
 
                 <org.mariotaku.twidere.view.BirthdayView
                     android:layout_width="match_parent"
-                    android:layout_height="match_parent" />
+                    android:layout_height="match_parent"/>
             </FrameLayout>
         </RelativeLayout>
 
@@ -58,7 +60,7 @@
             android:layout_width="match_parent"
             android:layout_height="match_parent"
             app:hdl_contentLayout="@layout/fragment_content_pages"
-            app:hdl_headerLayout="@layout/header_user" />
+            app:hdl_headerLayout="@layout/header_user"/>
     </org.mariotaku.twidere.view.ExtendedFrameLayout>
 
 </FrameLayout>
\ No newline at end of file
diff --git a/twidere/src/main/res/layout/layout_draggable_list_with_empty_view.xml b/twidere/src/main/res/layout/layout_draggable_list_with_empty_view.xml
index 6cb7e561d6..8ee537f276 100644
--- a/twidere/src/main/res/layout/layout_draggable_list_with_empty_view.xml
+++ b/twidere/src/main/res/layout/layout_draggable_list_with_empty_view.xml
@@ -22,7 +22,8 @@
     xmlns:app="http://schemas.android.com/apk/res-auto"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
-    android:layout_height="match_parent">
+    android:layout_height="match_parent"
+    android:fitsSystemWindows="true">
 
     <FrameLayout
         android:id="@+id/list_container"
diff --git a/twidere/src/main/res/menu/menu_account_dashboard.xml b/twidere/src/main/res/menu/menu_account_dashboard.xml
index ba63cd883a..90fd3c84df 100644
--- a/twidere/src/main/res/menu/menu_account_dashboard.xml
+++ b/twidere/src/main/res/menu/menu_account_dashboard.xml
@@ -22,7 +22,7 @@
         <item
             android:id="@id/lists"
             android:icon="@drawable/ic_action_list"
-            android:title="@string/likes"/>
+            android:title="@string/lists"/>
         <item
             android:id="@id/groups"
             android:icon="@drawable/ic_action_list"
diff --git a/twidere/src/main/res/values-notnight/themes.xml b/twidere/src/main/res/values-notnight/themes.xml
index 50db22ba81..96d0ef4fbb 100644
--- a/twidere/src/main/res/values-notnight/themes.xml
+++ b/twidere/src/main/res/values-notnight/themes.xml
@@ -1,10 +1,12 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
-    <style name="Theme.Twidere" parent="Theme.Compat.Base.Light">
+    <style name="Theme.Twidere" parent="Theme.AppCompat.Light">
 
         <!-- Widget styles -->
         <item name="android:listSeparatorTextViewStyle">@style/Widget.Light.TextView.ListSeparator
         </item>
+        <item name="actionModeBackground">?colorPrimary</item>
+        <item name="actionBarPopupTheme">@style/ThemeOverlay.AppCompat</item>
 
         <!-- Card UI styles -->
         <item name="cardActionButtonStyle">@style/Widget.Light.CardActionButton</item>
@@ -24,7 +26,7 @@
         <item name="preferenceTheme">@style/PreferenceThemeOverlay.v14.Material</item>
     </style>
 
-    <style name="Theme.Twidere.NoActionBar" parent="Theme.Compat.Base.Light.NoActionBar">
+    <style name="Theme.Twidere.NoActionBar" parent="Theme.AppCompat.Light.NoActionBar">
 
         <!-- Widget styles -->
         <item name="android:listSeparatorTextViewStyle">@style/Widget.Light.TextView.ListSeparator
@@ -49,7 +51,7 @@
     </style>
 
 
-    <style name="Theme.Twidere.DialogWhenLarge.NoActionBar" parent="Theme.Compat.Base.Light.DialogWhenLarge">
+    <style name="Theme.Twidere.DialogWhenLarge.NoActionBar" parent="Theme.AppCompat.Light.DialogWhenLarge">
 
         <item name="windowNoTitle">true</item>
         <item name="windowActionBar">false</item>
@@ -77,7 +79,7 @@
     </style>
 
 
-    <style name="Theme.Twidere.Dialog" parent="Theme.Compat.Base.Light.Dialog">
+    <style name="Theme.Twidere.Dialog" parent="Theme.AppCompat.Light.Dialog">
 
         <!-- Custom view styles -->
 
@@ -104,7 +106,7 @@
     </style>
 
 
-    <style name="Theme.Twidere.Compose" parent="Theme.Compat.Base.Light.Dialog">
+    <style name="Theme.Twidere.Compose" parent="Theme.AppCompat.Light.Dialog">
 
         <item name="windowActionBar">false</item>
         <item name="windowActionModeOverlay">false</item>
@@ -150,10 +152,6 @@
         <item name="android:windowActionModeOverlay">false</item>
     </style>
 
-    <style name="Theme.Twidere.Drawer" parent="Theme.Twidere.NoActionBar">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/bg_color_drawer_light</item>
-    </style>
 
     <style name="Theme.Twidere.NoDisplay" parent="Theme.Twidere.Dialog">
         <item name="android:windowBackground">@android:color/transparent</item>
diff --git a/twidere/src/main/res/values-v21/themes_base_appcompat.xml b/twidere/src/main/res/values-v21/themes_base_appcompat.xml
deleted file mode 100644
index 2a366a91bf..0000000000
--- a/twidere/src/main/res/values-v21/themes_base_appcompat.xml
+++ /dev/null
@@ -1,31 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?><!--
-  ~ Twidere - Twitter client for Android
-  ~
-  ~  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
-  ~
-  ~  This program is free software: you can redistribute it and/or modify
-  ~  it under the terms of the GNU General Public License as published by
-  ~  the Free Software Foundation, either version 3 of the License, or
-  ~  (at your option) any later version.
-  ~
-  ~  This program is distributed in the hope that it will be useful,
-  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
-  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-  ~  GNU General Public License for more details.
-  ~
-  ~  You should have received a copy of the GNU General Public License
-  ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-  -->
-
-<resources>
-
-    <style name="Theme.Compat.Base.Dialog" parent="Theme.AppCompat.Dialog">
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_light</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Light.Dialog" parent="Theme.AppCompat.Light.Dialog">
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_light</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_dark</item>
-    </style>
-</resources>
\ No newline at end of file
diff --git a/twidere/src/main/res/values/themes.xml b/twidere/src/main/res/values/themes.xml
index 7a89011fd1..fd7ead01f7 100644
--- a/twidere/src/main/res/values/themes.xml
+++ b/twidere/src/main/res/values/themes.xml
@@ -2,11 +2,13 @@
 <resources xmlns:android="http://schemas.android.com/apk/res/android">
 
 
-    <style name="Theme.Twidere" parent="Theme.Compat.Base">
+    <style name="Theme.Twidere" parent="Theme.AppCompat">
 
         <!-- Widget styles -->
         <item name="android:listSeparatorTextViewStyle">@style/Widget.Dark.TextView.ListSeparator
         </item>
+        <item name="actionModeStyle">@style/Widget.AppCompat.ActionBar</item>
+        <item name="actionModeBackground">?colorPrimary</item>
 
         <!-- Card UI styles -->
         <item name="cardActionButtonStyle">@style/Widget.CardActionButton</item>
@@ -26,7 +28,7 @@
         <item name="preferenceTheme">@style/PreferenceThemeOverlay.v14.Material</item>
     </style>
 
-    <style name="Theme.Twidere.NoActionBar" parent="Theme.Compat.Base.NoActionBar">
+    <style name="Theme.Twidere.NoActionBar" parent="Theme.AppCompat.NoActionBar">
 
         <!-- Window attributes -->
         <item name="android:windowBackground">@color/background_color_window_dark</item>
@@ -53,7 +55,7 @@
         <item name="preferenceTheme">@style/PreferenceThemeOverlay.v14.Material</item>
     </style>
 
-    <style name="Theme.Twidere.DialogWhenLarge.NoActionBar" parent="Theme.Compat.Base.DialogWhenLarge">
+    <style name="Theme.Twidere.DialogWhenLarge.NoActionBar" parent="Theme.AppCompat.DialogWhenLarge">
 
         <item name="windowNoTitle">true</item>
         <item name="windowActionBar">false</item>
@@ -80,7 +82,7 @@
 
     </style>
 
-    <style name="Theme.Twidere.Dialog" parent="Theme.Compat.Base.Dialog">
+    <style name="Theme.Twidere.Dialog" parent="Theme.AppCompat.Dialog">
 
         <!-- Custom view styles -->
 
@@ -106,7 +108,7 @@
 
     </style>
 
-    <style name="Theme.Twidere.Compose" parent="Theme.Compat.Base.Dialog">
+    <style name="Theme.Twidere.Compose" parent="Theme.AppCompat.Dialog">
 
         <item name="windowActionBar">false</item>
         <item name="windowActionModeOverlay">false</item>
@@ -157,16 +159,6 @@
 
     </style>
 
-    <style name="Theme.Twidere.Drawer" parent="Theme.Twidere.NoActionBar">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/bg_color_drawer_dark</item>
-        <item name="darkTheme">true</item>
-
-        <!-- ATE attributes -->
-        <item name="ateThemeKey">dark</item>
-
-    </style>
-
     <style name="Theme.Twidere.NoDisplay" parent="Theme.Twidere.Dialog">
         <item name="android:windowBackground">@android:color/transparent</item>
         <!--<item name="android:backgroundDimEnabled">false</item>-->
@@ -218,9 +210,10 @@
 
     </style>
 
-    <style name="Theme.Nyan" parent="Theme.Compat.Base.NoActionBar">
+    <style name="Theme.Nyan" parent="Theme.AppCompat.NoActionBar">
         <item name="android:windowBackground">@color/nyan_background</item>
         <item name="darkTheme">true</item>
+        <item name="colorPrimary">@color/nyan_background</item>
     </style>
 
 </resources>
\ No newline at end of file
diff --git a/twidere/src/main/res/values/themes_base_appcompat.xml b/twidere/src/main/res/values/themes_base_appcompat.xml
deleted file mode 100644
index 5f6ac7e73f..0000000000
--- a/twidere/src/main/res/values/themes_base_appcompat.xml
+++ /dev/null
@@ -1,82 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-  ~ Twidere - Twitter client for Android
-  ~
-  ~  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
-  ~
-  ~  This program is free software: you can redistribute it and/or modify
-  ~  it under the terms of the GNU General Public License as published by
-  ~  the Free Software Foundation, either version 3 of the License, or
-  ~  (at your option) any later version.
-  ~
-  ~  This program is distributed in the hope that it will be useful,
-  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
-  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-  ~  GNU General Public License for more details.
-  ~
-  ~  You should have received a copy of the GNU General Public License
-  ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-  -->
-
-<resources>
-
-    <style name="Theme.Compat.Base" parent="Theme.AppCompat">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/background_color_window_dark</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_light</item>
-    </style>
-
-    <style name="Theme.Compat.Base.NoActionBar" parent="Theme.AppCompat.NoActionBar">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/background_color_window_dark</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_light</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Dialog" parent="Theme.AppCompat.Dialog">
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_light</item>
-        <item name="android:actionBarSize">?actionBarSize</item>
-    </style>
-
-    <style name="Theme.Compat.Base.DialogWhenLarge" parent="Theme.AppCompat.DialogWhenLarge">
-        <!-- Window attributes -->
-        <item name="windowNormalBackground">@color/background_color_window_dark</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_light</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Light" parent="Theme.AppCompat.Light">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/background_color_window_light</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_light</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_dark</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Light.NoActionBar" parent="Theme.AppCompat.Light.NoActionBar">
-        <!-- Window attributes -->
-        <item name="android:windowBackground">@color/background_color_window_light</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_light</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_dark</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Light.Dialog" parent="Theme.AppCompat.Light.Dialog">
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_light</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_dark</item>
-        <item name="android:actionBarSize">?actionBarSize</item>
-    </style>
-
-    <style name="Theme.Compat.Base.Light.DialogWhenLarge" parent="Theme.AppCompat.Light.DialogWhenLarge">
-        <!-- Window attributes -->
-        <item name="windowNormalBackground">@color/background_color_window_light</item>
-
-        <item name="android:textColorTertiary">@color/tertiary_text_mtrl_light</item>
-        <item name="android:textColorTertiaryInverse">@color/tertiary_text_mtrl_dark</item>
-    </style>
-</resources>
\ No newline at end of file
diff --git a/twidere/src/main/res/xml/preferences_advanced_network.xml b/twidere/src/main/res/xml/preferences_advanced_network.xml
index f5c01ac4b3..be12950316 100644
--- a/twidere/src/main/res/xml/preferences_advanced_network.xml
+++ b/twidere/src/main/res/xml/preferences_advanced_network.xml
@@ -19,7 +19,7 @@
             android:summary="@string/tcp_dns_query_summary"
             android:title="@string/tcp_dns_query"/>
 
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="builtin_dns_resolver"
             android:dialogTitle="@string/dns_server"
             android:inputType="textVisiblePassword"
@@ -50,31 +50,31 @@
             android:summary="@string/proxy_summary"
             android:title="@string/proxy"/>
 
-        <ListPreference
+        <org.mariotaku.twidere.preference.ThemedListPreference
             android:defaultValue="http"
             android:dependency="enable_proxy"
             android:entries="@array/entries_proxy_type"
             android:entryValues="@array/values_proxy_type"
             android:key="proxy_type"
             android:title="@string/proxy_type"/>
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="enable_proxy"
             android:key="proxy_host"
             android:singleLine="true"
             android:title="@string/proxy_host"/>
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="enable_proxy"
             android:inputType="number"
             android:key="proxy_port"
             android:singleLine="true"
             android:title="@string/proxy_port"/>
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="enable_proxy"
             android:inputType="textEmailAddress"
             android:key="proxy_username"
             android:singleLine="true"
             android:title="@string/proxy_username"/>
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="enable_proxy"
             android:inputType="textPassword"
             android:key="proxy_password"
@@ -101,13 +101,13 @@
             android:key="thumbor_enabled"
             android:title="@string/thumbor_integration"/>
 
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="thumbor_enabled"
             android:inputType="textUri"
             android:key="thumbor_address"
             android:title="@string/server_address"/>
 
-        <EditTextPreference
+        <org.mariotaku.twidere.preference.ThemedEditTextPreference
             android:dependency="thumbor_enabled"
             android:inputType="textVisiblePassword"
             android:key="thumbor_security_key"
diff --git a/twidere/src/main/res/xml/preferences_cards.xml b/twidere/src/main/res/xml/preferences_cards.xml
index 6f29891234..9cc3b0d9f4 100644
--- a/twidere/src/main/res/xml/preferences_cards.xml
+++ b/twidere/src/main/res/xml/preferences_cards.xml
@@ -36,7 +36,7 @@
             android:value="true"/>
     </SwitchPreference>
 
-    <ListPreference
+    <org.mariotaku.twidere.preference.ThemedListPreference
         android:defaultValue="@string/default_profile_image_style"
         android:entries="@array/entries_profile_image_style"
         android:entryValues="@array/values_profile_image_style"
@@ -46,7 +46,7 @@
         <extra
             android:name="notify_change"
             android:value="true"/>
-    </ListPreference>
+    </org.mariotaku.twidere.preference.ThemedListPreference>
 
     <SwitchPreference
         android:defaultValue="false"
diff --git a/twidere/src/main/res/xml/preferences_compose.xml b/twidere/src/main/res/xml/preferences_compose.xml
index 1d38f21abf..e0867dab40 100644
--- a/twidere/src/main/res/xml/preferences_compose.xml
+++ b/twidere/src/main/res/xml/preferences_compose.xml
@@ -37,7 +37,7 @@
         android:summary="@string/compose_now_summary"
         android:title="@string/compose_now"/>
 
-    <ListPreference
+    <org.mariotaku.twidere.preference.ThemedListPreference
         android:defaultValue="compose"
         android:dependency="compose_now"
         android:entries="@array/entries_compose_now_action"
@@ -51,7 +51,7 @@
         android:summary="%s"
         android:title="@string/status_shortener"/>
 
-    <EditTextPreference
+    <org.mariotaku.twidere.preference.ThemedEditTextPreference
         android:defaultValue="RT @[NAME]: [TEXT]"
         android:dialogTitle="@string/quote_format"
         android:key="quote_format"
@@ -59,7 +59,7 @@
         android:summary="@string/quote_format_summary"
         android:title="@string/quote_format"/>
 
-    <EditTextPreference
+    <org.mariotaku.twidere.preference.ThemedEditTextPreference
         android:defaultValue="[TITLE] - [TEXT]"
         android:dialogTitle="@string/share_format"
         android:key="share_format"
diff --git a/twidere/src/main/res/xml/preferences_refresh.xml b/twidere/src/main/res/xml/preferences_refresh.xml
index ee0d84c00d..e882f4d8b5 100644
--- a/twidere/src/main/res/xml/preferences_refresh.xml
+++ b/twidere/src/main/res/xml/preferences_refresh.xml
@@ -13,7 +13,7 @@
     <PreferenceCategory
         android:key="cat_general"
         android:title="@string/general">
-        <ListPreference
+        <org.mariotaku.twidere.preference.ThemedListPreference
             android:defaultValue="15"
             android:entries="@array/entries_refresh_interval"
             android:entryValues="@array/values_refresh_interval"
diff --git a/twidere/src/main/res/xml/preferences_scrapyard.xml b/twidere/src/main/res/xml/preferences_scrapyard.xml
index fd292122cb..8b4a2b5bda 100644
--- a/twidere/src/main/res/xml/preferences_scrapyard.xml
+++ b/twidere/src/main/res/xml/preferences_scrapyard.xml
@@ -20,7 +20,7 @@
 
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
 
-    <ListPreference
+    <org.mariotaku.twidere.preference.ThemedListPreference
         android:defaultValue="crop"
         android:entries="@array/entries_media_preview_style"
         android:entryValues="@array/values_media_preview_style"
@@ -29,7 +29,7 @@
         <extra
             android:name="notify_change"
             android:value="true"/>
-    </ListPreference>
+    </org.mariotaku.twidere.preference.ThemedListPreference>
     <SwitchPreference
         android:defaultValue="false"
         android:key="show_absolute_time"
@@ -48,7 +48,7 @@
             android:value="true"/>
     </SwitchPreference>
 
-    <ListPreference
+    <org.mariotaku.twidere.preference.ThemedListPreference
         android:defaultValue="@string/default_tab_display_option"
         android:entries="@array/entries_tab_display_option"
         android:entryValues="@array/values_tab_display_option"
diff --git a/twidere/src/main/res/xml/preferences_theme.xml b/twidere/src/main/res/xml/preferences_theme.xml
index 12d498b357..0ad09ddc06 100644
--- a/twidere/src/main/res/xml/preferences_theme.xml
+++ b/twidere/src/main/res/xml/preferences_theme.xml
@@ -4,7 +4,7 @@
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:title="@string/theme">
 
-    <ListPreference
+    <org.mariotaku.twidere.preference.ThemedListPreference
         android:defaultValue="light"
         android:entries="@array/entries_theme"
         android:entryValues="@array/values_theme"
@@ -14,7 +14,7 @@
         <extra
             android:name="recreate_activity"
             android:value="true"/>
-    </ListPreference>
+    </org.mariotaku.twidere.preference.ThemedListPreference>
 
     <org.mariotaku.twidere.preference.ThemeBackgroundPreference
         android:defaultValue="default"
diff --git a/twidere/src/main/res/xml/preferences_thumbor.xml b/twidere/src/main/res/xml/preferences_thumbor.xml
index 39b6e0bc67..a809a2b4eb 100644
--- a/twidere/src/main/res/xml/preferences_thumbor.xml
+++ b/twidere/src/main/res/xml/preferences_thumbor.xml
@@ -22,11 +22,11 @@
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:title="@string/thumbor_integration">
 
-    <EditTextPreference
+    <org.mariotaku.twidere.preference.ThemedEditTextPreference
         android:inputType="textUri"
         android:key="thumbor_address"
         android:title="@string/server_address"/>
-    <EditTextPreference
+    <org.mariotaku.twidere.preference.ThemedEditTextPreference
         android:inputType="textVisiblePassword"
         android:key="thumbor_security_key"
         android:title="@string/security_key"/>
