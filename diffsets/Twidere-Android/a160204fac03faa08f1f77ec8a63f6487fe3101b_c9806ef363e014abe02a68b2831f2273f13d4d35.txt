diff --git a/twidere.component.common/src/main/java/org/mariotaku/twidere/model/ParcelableAccount.java b/twidere.component.common/src/main/java/org/mariotaku/twidere/model/ParcelableAccount.java
index c3b7c0875e..8aeef0ab60 100644
--- a/twidere.component.common/src/main/java/org/mariotaku/twidere/model/ParcelableAccount.java
+++ b/twidere.component.common/src/main/java/org/mariotaku/twidere/model/ParcelableAccount.java
@@ -148,6 +148,8 @@ public boolean equals(Object o) {
 
     @Override
     public int hashCode() {
+        // Dummy account
+        if (account_key == null) return 0;
         return account_key.hashCode();
     }
 
diff --git a/twidere/build.gradle b/twidere/build.gradle
index 5f7b2f0bcb..2ed68a48e6 100644
--- a/twidere/build.gradle
+++ b/twidere/build.gradle
@@ -80,10 +80,10 @@ dependencies {
     apt 'com.google.dagger:dagger-compiler:2.1'
     apt "com.github.mariotaku.ObjectCursor:processor:0.9.6"
 
-    compile('com.github.afollestad.app-theme-engine:library:1.0.2-SNAPSHOT@aar') {
+    compile('com.github.mariotaku:app-theme-engine:1efc6237e1@aar') {
         transitive = true
     }
-    compile('com.github.afollestad.material-dialogs:commons:0.8.5.8-SNAPSHOT@aar') {
+    compile('com.github.mariotaku.material-dialogs:commons:bf2f2c5c57@aar') {
         transitive = true
     }
     //    compile 'pl.droidsonroids.gif:android-gif-drawable:1.1.7'
@@ -136,7 +136,6 @@ dependencies {
     compile 'org.apache.commons:commons-lang3:3.4'
     compile 'commons-primitives:commons-primitives:1.0'
     compile 'com.bluelinelabs:logansquare:1.3.7'
-    compile 'com.makeramen:roundedimageview:2.1.1'
     compile 'com.soundcloud.android:android-crop:1.0.1@aar'
     compile 'com.hannesdorfmann.parcelableplease:annotation:1.0.2'
     compile 'com.github.mariotaku:PickNCrop:0.9.3'
diff --git a/twidere/proguard-rules.pro b/twidere/proguard-rules.pro
index 23dea42ce2..69eeeaa49f 100644
--- a/twidere/proguard-rules.pro
+++ b/twidere/proguard-rules.pro
@@ -23,6 +23,7 @@
 -dontwarn com.makeramen.roundedimageview.**
 
 -keepattributes *Annotation*
+-keepattributes EnclosingMethod
 
 # https://github.com/bluelinelabs/LoganSquare
 -keep class com.bluelinelabs.logansquare.** { *; }
diff --git a/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/OpenStreetMapViewerFragment.java b/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/OpenStreetMapViewerFragment.java
similarity index 99%
rename from twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/OpenStreetMapViewerFragment.java
rename to twidere/src/fdroid/java/org/mariotaku/twidere/fragment/OpenStreetMapViewerFragment.java
index a11a09d844..6b18a3a70b 100644
--- a/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/OpenStreetMapViewerFragment.java
+++ b/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/OpenStreetMapViewerFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.graphics.Point;
 import android.graphics.drawable.Drawable;
diff --git a/twidere/src/fdroid/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java b/twidere/src/fdroid/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
index 4d8726ac1e..af717b086e 100644
--- a/twidere/src/fdroid/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
+++ b/twidere/src/fdroid/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
@@ -22,7 +22,7 @@
 import android.content.Context;
 import android.support.v4.app.Fragment;
 
-import org.mariotaku.twidere.fragment.support.OpenStreetMapViewerFragment;
+import org.mariotaku.twidere.fragment.OpenStreetMapViewerFragment;
 
 /**
  * Created by mariotaku on 15/4/27.
diff --git a/twidere/src/google/AndroidManifest.xml b/twidere/src/google/AndroidManifest.xml
index b02056919e..6787aeef2d 100644
--- a/twidere/src/google/AndroidManifest.xml
+++ b/twidere/src/google/AndroidManifest.xml
@@ -1,6 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
-<manifest xmlns:android="http://schemas.android.com/apk/res/android"
-          xmlns:tools="http://schemas.android.com/tools">
+<manifest
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools">
 
     <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
 
diff --git a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java b/twidere/src/google/java/org/mariotaku/twidere/fragment/GoogleMapFragment.java
similarity index 99%
rename from twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java
rename to twidere/src/google/java/org/mariotaku/twidere/fragment/GoogleMapFragment.java
index 21b224f984..4792f201c9 100644
--- a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/GoogleMapFragment.java
+++ b/twidere/src/google/java/org/mariotaku/twidere/fragment/GoogleMapFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.graphics.Rect;
diff --git a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/WebMapFragment.java b/twidere/src/google/java/org/mariotaku/twidere/fragment/WebMapFragment.java
similarity index 98%
rename from twidere/src/google/java/org/mariotaku/twidere/fragment/support/WebMapFragment.java
rename to twidere/src/google/java/org/mariotaku/twidere/fragment/WebMapFragment.java
index 25b6256c4f..a37ae7281a 100644
--- a/twidere/src/google/java/org/mariotaku/twidere/fragment/support/WebMapFragment.java
+++ b/twidere/src/google/java/org/mariotaku/twidere/fragment/WebMapFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.content.Intent;
diff --git a/twidere/src/google/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java b/twidere/src/google/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
index f55fef9ee8..b4dda0a14b 100644
--- a/twidere/src/google/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
+++ b/twidere/src/google/java/org/mariotaku/twidere/util/MapFragmentFactoryImpl.java
@@ -25,8 +25,8 @@
 import com.google.android.gms.common.ConnectionResult;
 import com.google.android.gms.common.GoogleApiAvailability;
 
-import org.mariotaku.twidere.fragment.support.GoogleMapFragment;
-import org.mariotaku.twidere.fragment.support.WebMapFragment;
+import org.mariotaku.twidere.fragment.GoogleMapFragment;
+import org.mariotaku.twidere.fragment.WebMapFragment;
 
 /**
  * Created by mariotaku on 15/4/27.
diff --git a/twidere/src/main/AndroidManifest.xml b/twidere/src/main/AndroidManifest.xml
index 78095b5820..c921cd04fd 100644
--- a/twidere/src/main/AndroidManifest.xml
+++ b/twidere/src/main/AndroidManifest.xml
@@ -1,67 +1,67 @@
 <?xml version="1.0" encoding="utf-8"?>
-<manifest xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:tools="http://schemas.android.com/tools"
-    package="org.mariotaku.twidere"
-    android:installLocation="auto" >
+<manifest package="org.mariotaku.twidere"
+          xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:tools="http://schemas.android.com/tools"
+          android:installLocation="auto">
 
-    <uses-sdk />
+    <uses-sdk/>
 
     <uses-feature
         android:name="android.hardware.camera"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:name="android.hardware.location"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:name="android.hardware.location.gps"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:name="android.hardware.location.network"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:name="android.hardware.touchscreen"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:name="android.hardware.nfc"
-        android:required="false" />
+        android:required="false"/>
     <uses-feature
         android:glEsVersion="0x00020000"
-        android:required="true" />
-
-    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
-    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
-    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
-    <uses-permission android:name="android.permission.INTERNET" />
-    <uses-permission android:name="android.permission.VIBRATE" />
-    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
-    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
-    <uses-permission android:name="android.permission.NFC" />
-    <uses-permission android:name="org.mariotaku.twidere.permission.SHORTEN_STATUS" />
-    <uses-permission android:name="org.mariotaku.twidere.permission.UPLOAD_MEDIA" />
-    <uses-permission android:name="org.mariotaku.twidere.permission.SYNC_TIMELINE" />
+        android:required="true"/>
+
+    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
+    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
+    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
+    <uses-permission android:name="android.permission.INTERNET"/>
+    <uses-permission android:name="android.permission.VIBRATE"/>
+    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
+    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
+    <uses-permission android:name="android.permission.NFC"/>
+    <uses-permission android:name="org.mariotaku.twidere.permission.SHORTEN_STATUS"/>
+    <uses-permission android:name="org.mariotaku.twidere.permission.UPLOAD_MEDIA"/>
+    <uses-permission android:name="org.mariotaku.twidere.permission.SYNC_TIMELINE"/>
     <uses-permission
         android:name="android.permission.READ_PHONE_STATE"
-        tools:node="remove" />
+        tools:node="remove"/>
 
     <permission-group
         android:name="org.mariotaku.twidere.permission.PERMISSION_GROUP"
-        android:label="@string/app_name" />
+        android:label="@string/app_name"/>
 
     <permission
         android:name="org.mariotaku.twidere.permission.SHORTEN_STATUS"
         android:description="@string/permission_description_shorten_status"
         android:label="@string/permission_label_shorten_status"
-        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP" />
+        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP"/>
     <permission
         android:name="org.mariotaku.twidere.permission.UPLOAD_MEDIA"
         android:description="@string/permission_description_upload_media"
         android:label="@string/permission_label_upload_media"
-        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP" />
+        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP"/>
     <permission
         android:name="org.mariotaku.twidere.permission.SYNC_TIMELINE"
         android:description="@string/permission_description_sync_timeline"
         android:label="@string/permission_label_sync_timeline"
-        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP" />
+        android:permissionGroup="org.mariotaku.twidere.permission.PERMISSION_GROUP"/>
 
     <application
         android:name=".app.TwidereApplication"
@@ -74,35 +74,35 @@
         android:label="@string/app_name"
         android:supportsRtl="true"
         android:theme="@style/Theme.Twidere.NoActionBar"
-        tools:ignore="UnusedAttribute" >
+        tools:ignore="UnusedAttribute">
         <uses-library
             android:name="com.sec.android.app.multiwindow"
-            android:required="false" />
+            android:required="false"/>
 
         <meta-data
             android:name="io.fabric.ApiKey"
-            android:value="dc4ee756d3b705e00011782f1426fc8656ad3bd9" />
+            android:value="dc4ee756d3b705e00011782f1426fc8656ad3bd9"/>
         <meta-data
             android:name="com.google.android.backup.api_key"
-            android:value="AEdPqrEAAAAIKbKATV1AGbLB4kem3w8QaPVJSPVVumbMHxkfwA" />
+            android:value="AEdPqrEAAAAIKbKATV1AGbLB4kem3w8QaPVJSPVVumbMHxkfwA"/>
         <meta-data
             android:name="com.sec.android.support.multiwindow"
-            android:value="true" />
+            android:value="true"/>
         <meta-data
             android:name="com.sec.android.multiwindow.DEFAULT_SIZE_W"
-            android:value="480dp" />
+            android:value="480dp"/>
         <meta-data
             android:name="com.sec.android.multiwindow.DEFAULT_SIZE_H"
-            android:value="640dp" />
+            android:value="640dp"/>
         <meta-data
             android:name="com.sec.android.multiwindow.MINIMUM_SIZE_W"
-            android:value="240dp" />
+            android:value="240dp"/>
         <meta-data
             android:name="com.sec.android.multiwindow.MINIMUM_SIZE_H"
-            android:value="320dp" />
+            android:value="320dp"/>
         <meta-data
             android:name="override_tinted_status_bar_defaults"
-            android:value="true" />
+            android:value="true"/>
 
         <activity
             android:name=".activity.MainActivity"
@@ -110,13 +110,13 @@
             android:label="@string/app_name"
             android:launchMode="singleTop"
             android:theme="@style/Theme.Twidere.NoActionBar"
-            android:windowSoftInputMode="adjustNothing" >
+            android:windowSoftInputMode="adjustNothing">
             <intent-filter>
-                <action android:name="android.intent.action.MAIN" />
+                <action android:name="android.intent.action.MAIN"/>
 
-                <category android:name="android.intent.category.LAUNCHER" />
-                <category android:name="android.intent.category.MULTIWINDOW_LAUNCHER" />
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.LAUNCHER"/>
+                <category android:name="android.intent.category.MULTIWINDOW_LAUNCHER"/>
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
@@ -126,13 +126,13 @@
             android:label="@string/app_name"
             android:launchMode="singleTop"
             android:theme="@style/Theme.Twidere.NoActionBar"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="android.intent.action.MAIN" />
+                <action android:name="android.intent.action.MAIN"/>
 
-                <category android:name="android.intent.category.LAUNCHER" />
-                <category android:name="android.intent.category.MULTIWINDOW_LAUNCHER" />
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.LAUNCHER"/>
+                <category android:name="android.intent.category.MULTIWINDOW_LAUNCHER"/>
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
@@ -140,24 +140,24 @@
             android:label="@string/app_name"
             android:launchMode="singleTop"
             android:theme="@style/Theme.Twidere.NoActionBar"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.HOME" />
+                <action android:name="org.mariotaku.twidere.HOME"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
             <intent-filter>
-                <action android:name="android.intent.action.SEARCH" />
+                <action android:name="android.intent.action.SEARCH"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
 
             <meta-data
                 android:name="android.app.searchable"
-                android:resource="@xml/searchable" />
+                android:resource="@xml/searchable"/>
             <meta-data
                 android:name="android.app.default_searchable"
-                android:value=".activity.support.HomeActivity" />
+                android:value=".activity.support.HomeActivity"/>
         </activity>
         <activity
             android:name=".activity.ComposeActivity"
@@ -166,64 +166,64 @@
             android:launchMode="singleTop"
             android:parentActivityName=".activity.HomeActivity"
             android:theme="@style/Theme.Twidere.Compose"
-            android:windowSoftInputMode="adjustResize" >
-            <intent-filter android:label="@string/compose" >
-                <action android:name="android.intent.action.MAIN" />
-                <action android:name="org.mariotaku.twidere.COMPOSE" />
-                <action android:name="org.mariotaku.twidere.REPLY" />
-                <action android:name="org.mariotaku.twidere.QUOTE" />
-                <action android:name="org.mariotaku.twidere.EDIT_DRAFT" />
-                <action android:name="org.mariotaku.twidere.MENTION" />
-                <action android:name="org.mariotaku.twidere.REPLY_MULTIPLE" />
-
-                <category android:name="android.intent.category.DEFAULT" />
+            android:windowSoftInputMode="adjustResize">
+            <intent-filter android:label="@string/compose">
+                <action android:name="android.intent.action.MAIN"/>
+                <action android:name="org.mariotaku.twidere.COMPOSE"/>
+                <action android:name="org.mariotaku.twidere.REPLY"/>
+                <action android:name="org.mariotaku.twidere.QUOTE"/>
+                <action android:name="org.mariotaku.twidere.EDIT_DRAFT"/>
+                <action android:name="org.mariotaku.twidere.MENTION"/>
+                <action android:name="org.mariotaku.twidere.REPLY_MULTIPLE"/>
+
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
-            <intent-filter android:label="@string/app_name" >
-                <action android:name="android.intent.action.SEND" />
-                <action android:name="android.intent.action.SEND_MULTIPLE" />
+            <intent-filter android:label="@string/app_name">
+                <action android:name="android.intent.action.SEND"/>
+                <action android:name="android.intent.action.SEND_MULTIPLE"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
 
-                <data android:mimeType="image/*" />
-                <data android:mimeType="text/plain" />
+                <data android:mimeType="image/*"/>
+                <data android:mimeType="text/plain"/>
             </intent-filter>
 
             <meta-data
                 android:name="android.support.PARENT_ACTIVITY"
-                android:value=".activity.HomeActivity" />
+                android:value=".activity.HomeActivity"/>
         </activity>
         <activity
             android:name=".activity.QuickSearchBarActivity"
             android:label="@string/search"
             android:launchMode="singleTop"
             android:theme="@style/Theme.Twidere.QuickSearchBar"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.GLOBAL_SEARCH" />
+                <action android:name="org.mariotaku.twidere.GLOBAL_SEARCH"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.SignInActivity"
             android:label="@string/sign_in"
             android:theme="@style/Theme.Twidere"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.TWITTER_LOGIN" />
+                <action android:name="org.mariotaku.twidere.TWITTER_LOGIN"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.BrowserSignInActivity"
             android:label="@string/browser_sign_in"
             android:theme="@style/Theme.Twidere"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.TWITTER_BROWSER_LOGIN" />
+                <action android:name="org.mariotaku.twidere.TWITTER_BROWSER_LOGIN"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
@@ -231,53 +231,53 @@
             android:label="@string/settings"
             android:parentActivityName=".activity.HomeActivity"
             android:theme="@style/Theme.Twidere"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="android.intent.action.MANAGE_NETWORK_USAGE" />
-                <action android:name="org.mariotaku.twidere.SETTINGS" />
+                <action android:name="android.intent.action.MANAGE_NETWORK_USAGE"/>
+                <action android:name="org.mariotaku.twidere.SETTINGS"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
 
             <meta-data
                 android:name="android.support.PARENT_ACTIVITY"
-                android:value=".activity.HomeActivity" />
+                android:value=".activity.HomeActivity"/>
         </activity>
         <activity
             android:name=".activity.APIEditorActivity"
             android:label="@string/edit_api"
             android:theme="@style/Theme.Twidere.Dialog"
-            android:windowSoftInputMode="adjustResize" />
+            android:windowSoftInputMode="adjustResize"/>
         <activity
             android:name=".activity.AccountSelectorActivity"
             android:label="@string/select_account"
-            android:theme="@style/Theme.Twidere.Dialog" >
+            android:theme="@style/Theme.Twidere.Dialog">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.SELECT_ACCOUNT" />
+                <action android:name="org.mariotaku.twidere.SELECT_ACCOUNT"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.ColorPickerDialogActivity"
             android:label="@string/set_color"
-            android:theme="@style/Theme.Twidere.NoDisplay" />
+            android:theme="@style/Theme.Twidere.NoDisplay"/>
         <activity
             android:name=".activity.LinkHandlerActivity"
             android:parentActivityName=".activity.HomeActivity"
             android:theme="@style/Theme.Twidere"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <meta-data
                 android:name="android.support.PARENT_ACTIVITY"
-                android:value=".activity.HomeActivity" />
+                android:value=".activity.HomeActivity"/>
 
             <intent-filter>
-                <action android:name="android.intent.action.VIEW" />
+                <action android:name="android.intent.action.VIEW"/>
 
-                <category android:name="android.intent.category.BROWSABLE" />
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.BROWSABLE"/>
+                <category android:name="android.intent.category.DEFAULT"/>
 
-                <data android:scheme="twidere" />
+                <data android:scheme="twidere"/>
             </intent-filter>
         </activity>
         <activity
@@ -285,20 +285,20 @@
             android:configChanges="keyboardHidden|orientation|screenSize"
             android:label="@string/media"
             android:theme="@style/Theme.Twidere.Viewer"
-            android:windowSoftInputMode="adjustPan" >
+            android:windowSoftInputMode="adjustPan">
             <meta-data
                 android:name="android.support.PARENT_ACTIVITY"
-                android:value=".activity.HomeActivity" />
+                android:value=".activity.HomeActivity"/>
 
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.VIEW_MEDIA" />
+                <action android:name="org.mariotaku.twidere.VIEW_MEDIA"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
-                <category android:name="android.intent.category.BROWSABLE" />
+                <category android:name="android.intent.category.DEFAULT"/>
+                <category android:name="android.intent.category.BROWSABLE"/>
 
-                <data android:scheme="http" />
-                <data android:scheme="https" />
-                <data android:scheme="file" />
+                <data android:scheme="http"/>
+                <data android:scheme="https"/>
+                <data android:scheme="file"/>
             </intent-filter>
         </activity>
         <activity
@@ -306,25 +306,25 @@
             android:exported="false"
             android:label="@string/pick_file"
             android:theme="@style/Theme.Twidere.NoDisplay"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.PICK_FILE" />
-                <action android:name="org.mariotaku.twidere.PICK_DIRECTORY" />
+                <action android:name="org.mariotaku.twidere.PICK_FILE"/>
+                <action android:name="org.mariotaku.twidere.PICK_DIRECTORY"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.ThemedImagePickerActivity"
             android:exported="false"
             android:theme="@style/Theme.Twidere.NoDisplay"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="android.intent.action.MAIN" />
-                <action android:name="org.mariotaku.twidere.PICK_IMAGE" />
-                <action android:name="org.mariotaku.twidere.TAKE_PHOTO" />
+                <action android:name="android.intent.action.MAIN"/>
+                <action android:name="org.mariotaku.twidere.PICK_IMAGE"/>
+                <action android:name="org.mariotaku.twidere.TAKE_PHOTO"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
@@ -332,106 +332,106 @@
             android:exported="false"
             android:label="@string/add_tab"
             android:theme="@style/Theme.Twidere.Dialog"
-            android:windowSoftInputMode="adjustResize" >
+            android:windowSoftInputMode="adjustResize">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.ADD_TAB" />
-                <action android:name="org.mariotaku.twidere.EDIT_TAB" />
+                <action android:name="org.mariotaku.twidere.ADD_TAB"/>
+                <action android:name="org.mariotaku.twidere.EDIT_TAB"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.CreateComposeShortcutActivity"
             android:label="@string/compose"
-            android:theme="@style/Theme.Twidere.NoDisplay" >
+            android:theme="@style/Theme.Twidere.NoDisplay">
             <intent-filter>
-                <action android:name="android.intent.action.CREATE_SHORTCUT" />
+                <action android:name="android.intent.action.CREATE_SHORTCUT"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.CopyLinkActivity"
             android:label="@string/copy_link"
-            android:theme="@style/Theme.Twidere.NoDisplay" />
+            android:theme="@style/Theme.Twidere.NoDisplay"/>
         <activity
             android:name=".activity.RequestPermissionsActivity"
             android:label="@string/permissions_request"
-            android:theme="@style/Theme.Twidere.Dialog" >
+            android:theme="@style/Theme.Twidere.Dialog">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.REQUEST_PERMISSIONS" />
+                <action android:name="org.mariotaku.twidere.REQUEST_PERMISSIONS"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.UserListSelectorActivity"
             android:label="@string/select_user_list"
-            android:theme="@style/Theme.Twidere.Dialog" >
+            android:theme="@style/Theme.Twidere.Dialog">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.SELECT_USER" />
-                <action android:name="org.mariotaku.twidere.SELECT_USER_LIST" />
+                <action android:name="org.mariotaku.twidere.SELECT_USER"/>
+                <action android:name="org.mariotaku.twidere.SELECT_USER_LIST"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.SettingsWizardActivity"
             android:label="@string/settings_wizard"
-            android:theme="@style/Theme.Twidere.NoActionBar" />
+            android:theme="@style/Theme.Twidere.NoActionBar"/>
         <activity
             android:name=".activity.DataExportActivity"
             android:label="@string/export_settings"
-            android:theme="@style/Theme.Twidere.NoDisplay" />
+            android:theme="@style/Theme.Twidere.NoDisplay"/>
         <activity
             android:name=".activity.DataImportActivity"
             android:label="@string/import_settings"
-            android:theme="@style/Theme.Twidere.NoDisplay" />
+            android:theme="@style/Theme.Twidere.NoDisplay"/>
         <activity
             android:name=".activity.ActivityPickerActivity"
-            android:theme="@style/Theme.Twidere.Dialog" >
+            android:theme="@style/Theme.Twidere.Dialog">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.PICK_ACTIVITY" />
+                <action android:name="org.mariotaku.twidere.PICK_ACTIVITY"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
         </activity>
         <activity
             android:name=".activity.TwitterLinkHandlerActivity"
             android:excludeFromRecents="true"
             android:taskAffinity=":twidere_twitter_link_handler"
-            android:theme="@style/Theme.Twidere.NoDisplay" >
+            android:theme="@style/Theme.Twidere.NoDisplay">
             <intent-filter>
                 <data
                     android:host="twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="http" />
+                    android:scheme="http"/>
                 <data
                     android:host="twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="https" />
+                    android:scheme="https"/>
                 <data
                     android:host="www.twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="http" />
+                    android:scheme="http"/>
                 <data
                     android:host="www.twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="https" />
+                    android:scheme="https"/>
                 <data
                     android:host="mobile.twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="http" />
+                    android:scheme="http"/>
                 <data
                     android:host="mobile.twitter.com"
                     android:pathPrefix="/"
-                    android:scheme="https" />
+                    android:scheme="https"/>
 
-                <action android:name="android.intent.action.VIEW" />
-                <action android:name="android.nfc.action.NDEF_DISCOVERED" />
+                <action android:name="android.intent.action.VIEW"/>
+                <action android:name="android.nfc.action.NDEF_DISCOVERED"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
-                <category android:name="android.intent.category.BROWSABLE" />
+                <category android:name="android.intent.category.DEFAULT"/>
+                <category android:name="android.intent.category.BROWSABLE"/>
             </intent-filter>
         </activity>
         <activity
@@ -439,56 +439,50 @@
             android:enabled="false"
             android:excludeFromRecents="true"
             android:taskAffinity=":twidere_assist_launcher"
-            android:theme="@style/Theme.Twidere.NoDisplay" >
+            android:theme="@style/Theme.Twidere.NoDisplay">
             <intent-filter>
-                <action android:name="android.intent.action.ASSIST" />
+                <action android:name="android.intent.action.ASSIST"/>
 
-                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.DEFAULT"/>
             </intent-filter>
 
             <meta-data
                 android:name="com.android.systemui.action_assist_icon"
-                android:resource="@drawable/ic_assist_twidere" />
+                android:resource="@drawable/ic_assist_twidere"/>
         </activity>
         <activity
             android:name=".activity.KeyboardShortcutPreferenceCompatActivity"
-            android:theme="@style/Theme.Twidere.Dialog" />
+            android:theme="@style/Theme.Twidere.Dialog"/>
         <activity
-            android:name=".activity.TestActivity"
-            android:enabled="false"
-            android:label="Twidere test"
+            android:name=".activity.HiddenSettingsActivity"
+            android:label="@string/hidden_settings"
             android:launchMode="singleTop"
-            android:windowSoftInputMode="adjustResize" >
-            <intent-filter>
-                <action android:name="android.intent.action.MAIN" />
-
-                <category android:name="android.intent.category.LAUNCHER" />
-            </intent-filter>
-        </activity>
+            android:theme="@style/Theme.Twidere"
+            android:windowSoftInputMode="adjustResize"/>
         <activity
             android:name=".activity.NyanActivity"
             android:launchMode="singleTop"
             android:theme="@style/Theme.Nyan"
-            android:windowSoftInputMode="stateAlwaysHidden" />
+            android:windowSoftInputMode="stateAlwaysHidden"/>
         <activity
             android:name=".activity.UsageStatisticsActivity"
             android:label="@string/usage_statistics"
-            android:theme="@style/Theme.Twidere.NoDisplay" />
+            android:theme="@style/Theme.Twidere"/>
         <activity
             android:name=".activity.ImageCropperActivity"
             android:label="@string/crop_image"
             android:theme="@style/Theme.Twidere.NoActionBar"
-            android:windowSoftInputMode="adjustResize" />
+            android:windowSoftInputMode="adjustResize"/>
 
         <service
             android:name=".service.RefreshService"
-            android:label="@string/label_refresh_service" />
+            android:label="@string/label_refresh_service"/>
         <service
             android:name=".service.StreamingService"
-            android:label="@string/label_streaming_service" />
+            android:label="@string/label_streaming_service"/>
         <service
             android:name=".service.BackgroundOperationService"
-            android:label="@string/label_background_operation_service" />
+            android:label="@string/label_background_operation_service"/>
         <service
             android:name=".nyan.NyanWallpaperService"
             android:enabled="false"
@@ -496,14 +490,14 @@
             android:icon="@drawable/nyan_sakamoto_thumbnail"
             android:label="@string/nyan_sakamoto"
             android:permission="android.permission.BIND_WALLPAPER"
-            android:process=":wallpaper" >
-            <intent-filter android:priority="1" >
-                <action android:name="android.service.wallpaper.WallpaperService" />
+            android:process=":wallpaper">
+            <intent-filter android:priority="1">
+                <action android:name="android.service.wallpaper.WallpaperService"/>
             </intent-filter>
 
             <meta-data
                 android:name="android.service.wallpaper"
-                android:resource="@xml/nyan_wallpaper" />
+                android:resource="@xml/nyan_wallpaper"/>
         </service>
         <service
             android:name=".nyan.NyanDaydreamService"
@@ -512,12 +506,12 @@
             android:icon="@drawable/nyan_sakamoto_thumbnail"
             android:label="@string/nyan_sakamoto"
             android:process=":daydream"
-            tools:ignore="ExportedService" >
-            <intent-filter android:priority="1" >
-                <action android:name="android.service.dreams.DreamService" />
+            tools:ignore="ExportedService">
+            <intent-filter android:priority="1">
+                <action android:name="android.service.dreams.DreamService"/>
             </intent-filter>
         </service>
-        <service android:name="edu.tsinghua.hotmobi.UploadLogsService" />
+        <service android:name="edu.tsinghua.hotmobi.UploadLogsService"/>
 
         <provider
             android:name=".provider.TwidereDataProvider"
@@ -525,54 +519,54 @@
             android:exported="true"
             android:grantUriPermissions="true"
             android:label="@string/label_data_provider"
-            tools:ignore="ExportedContentProvider" />
+            tools:ignore="ExportedContentProvider"/>
         <provider
             android:name=".provider.RecentSearchProvider"
             android:authorities="org.mariotaku.twidere.provider.SearchRecentSuggestions"
-            tools:ignore="ExportedContentProvider" />
+            tools:ignore="ExportedContentProvider"/>
         <provider
             android:name="android.support.v4.content.FileProvider"
             android:authorities="twidere.file"
             android:exported="false"
-            android:grantUriPermissions="true" >
+            android:grantUriPermissions="true">
             <meta-data
                 android:name="android.support.FILE_PROVIDER_PATHS"
-                android:resource="@xml/file_paths" />
+                android:resource="@xml/file_paths"/>
         </provider>
         <provider
             android:name=".provider.CacheProvider"
             android:authorities="twidere.cache"
-            android:exported="false" />
+            android:exported="false"/>
 
-        <receiver android:name=".receiver.ConnectivityStateReceiver" >
+        <receiver android:name=".receiver.ConnectivityStateReceiver">
             <intent-filter>
-                <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
+                <action android:name="android.net.conn.CONNECTIVITY_CHANGE"/>
             </intent-filter>
         </receiver>
         <receiver
             android:name=".receiver.NotificationReceiver"
-            android:exported="false" >
+            android:exported="false">
             <intent-filter>
-                <action android:name="org.mariotaku.twidere.NOTIFICATION_DELETED" />
+                <action android:name="org.mariotaku.twidere.NOTIFICATION_DELETED"/>
             </intent-filter>
         </receiver>
         <receiver
             android:name=".receiver.SecretCodeBroadcastReceiver"
-            android:label="@string/twidere_test" >
+            android:label="@string/twidere_test">
             <intent-filter>
-                <action android:name="android.provider.Telephony.SECRET_CODE" />
+                <action android:name="android.provider.Telephony.SECRET_CODE"/>
 
                 <data
                     android:host="8943373"
-                    android:scheme="android_secret_code" />
+                    android:scheme="android_secret_code"/>
             </intent-filter>
         </receiver>
-        <receiver android:name=".receiver.PowerStateReceiver" >
+        <receiver android:name=".receiver.PowerStateReceiver">
             <intent-filter>
-                <action android:name="android.intent.action.BATTERY_LOW" />
-                <action android:name="android.intent.action.BATTERY_OKAY" />
-                <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
-                <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
+                <action android:name="android.intent.action.BATTERY_LOW"/>
+                <action android:name="android.intent.action.BATTERY_OKAY"/>
+                <action android:name="android.intent.action.ACTION_POWER_CONNECTED"/>
+                <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED"/>
             </intent-filter>
         </receiver>
     </application>
diff --git a/twidere/src/main/java/android/support/v7/widget/android/support/v7/view/menu/TwidereActionMenuItemView.java b/twidere/src/main/java/android/support/v7/widget/android/support/v7/view/menu/TwidereActionMenuItemView.java
index be7304ca58..9a0eac70e2 100644
--- a/twidere/src/main/java/android/support/v7/widget/android/support/v7/view/menu/TwidereActionMenuItemView.java
+++ b/twidere/src/main/java/android/support/v7/widget/android/support/v7/view/menu/TwidereActionMenuItemView.java
@@ -65,7 +65,11 @@ private void invalidateTintColor() {
     @Override
     public void setIcon(Drawable icon) {
         invalidateTintColor();
-        mIcon = TintHelper.createTintedDrawable(icon, mTintColor);
+        if (icon instanceof IgnoreTinting) {
+            mIcon = icon;
+        } else {
+            mIcon = TintHelper.createTintedDrawable(icon, mTintColor);
+        }
         super.setIcon(mIcon);
         invalidateActionView();
     }
@@ -104,4 +108,8 @@ public boolean setsStatusBarColor() {
     public boolean setsToolbarColor() {
         return false;
     }
+
+    public interface IgnoreTinting {
+
+    }
 }
\ No newline at end of file
diff --git a/twidere/src/main/java/edu/tsinghua/hotmobi/model/UserEvent.java b/twidere/src/main/java/edu/tsinghua/hotmobi/model/UserEvent.java
index 6844de0776..047d3f992f 100644
--- a/twidere/src/main/java/edu/tsinghua/hotmobi/model/UserEvent.java
+++ b/twidere/src/main/java/edu/tsinghua/hotmobi/model/UserEvent.java
@@ -11,7 +11,7 @@
 import com.hannesdorfmann.parcelableplease.annotation.ParcelablePlease;
 import com.hannesdorfmann.parcelableplease.annotation.ParcelableThisPlease;
 
-import org.mariotaku.twidere.fragment.support.UserFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
 import org.mariotaku.twidere.model.ParcelableUser;
 
 /**
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/APIEditorActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/APIEditorActivity.java
index 791adeedd7..2cc0dfeaa9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/APIEditorActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/APIEditorActivity.java
@@ -39,7 +39,7 @@
 import android.widget.Toast;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
 import org.mariotaku.twidere.model.CustomAPIConfig;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.provider.TwidereDataStore.Accounts;
@@ -49,7 +49,7 @@
 import static org.mariotaku.twidere.util.Utils.getNonEmptyString;
 import static org.mariotaku.twidere.util.Utils.trim;
 
-public class APIEditorActivity extends BaseSupportDialogActivity implements OnCheckedChangeListener,
+public class APIEditorActivity extends BaseActivity implements OnCheckedChangeListener,
         OnClickListener, CompoundButton.OnCheckedChangeListener {
 
     private EditText mEditAPIUrlFormat;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/AccountSelectorActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/AccountSelectorActivity.java
index d1bb9949f9..61f25bfb21 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/AccountSelectorActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/AccountSelectorActivity.java
@@ -42,8 +42,8 @@
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.provider.TwidereDataStore.Accounts;
 
-public class AccountSelectorActivity extends BaseSupportDialogActivity implements LoaderCallbacks<Cursor>,
-        OnClickListener, OnItemClickListener {
+public class AccountSelectorActivity extends BaseActivity implements
+        LoaderCallbacks<Cursor>, OnClickListener, OnItemClickListener {
 
     private final ContentObserver mContentObserver = new ContentObserver(null) {
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ActivityPickerActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ActivityPickerActivity.java
index 6ecafdda32..f16f4c4bd3 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ActivityPickerActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/ActivityPickerActivity.java
@@ -16,8 +16,8 @@
 
 import java.util.List;
 
-public class ActivityPickerActivity extends BaseSupportDialogActivity implements LoaderCallbacks<List<ResolveInfo>>,
-        OnItemClickListener {
+public class ActivityPickerActivity extends BaseActivity implements
+        LoaderCallbacks<List<ResolveInfo>>, OnItemClickListener {
 
     private ResolveInfoListAdapter mAdapter;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/BaseAppCompatActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/BaseActivity.java
similarity index 53%
rename from twidere/src/main/java/org/mariotaku/twidere/activity/BaseAppCompatActivity.java
rename to twidere/src/main/java/org/mariotaku/twidere/activity/BaseActivity.java
index 609901c4df..85cf0a28bd 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/BaseAppCompatActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/BaseActivity.java
@@ -20,39 +20,66 @@
 package org.mariotaku.twidere.activity;
 
 import android.annotation.SuppressLint;
+import android.content.Context;
+import android.content.res.Configuration;
+import android.content.res.Resources;
 import android.graphics.Rect;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.support.v7.app.AppCompatDelegate;
+import android.support.v7.preference.Preference;
+import android.support.v7.preference.PreferenceFragmentCompat;
+import android.support.v7.preference.PreferenceFragmentCompat.OnPreferenceDisplayDialogCallback;
+import android.support.v7.view.menu.ActionMenuItemView;
+import android.support.v7.widget.TwidereActionMenuView;
+import android.util.AttributeSet;
 import android.view.KeyEvent;
 import android.view.MotionEvent;
+import android.view.View;
+import android.view.Window;
 
+import com.afollestad.appthemeengine.ATEActivity;
 import com.squareup.otto.Bus;
 
+import org.mariotaku.twidere.BuildConfig;
 import org.mariotaku.twidere.Constants;
+import org.mariotaku.twidere.activity.iface.IAppCompatActivity;
 import org.mariotaku.twidere.activity.iface.IControlBarActivity;
 import org.mariotaku.twidere.activity.iface.IExtendedActivity;
+import org.mariotaku.twidere.activity.iface.IThemedActivity;
 import org.mariotaku.twidere.fragment.iface.IBaseFragment.SystemWindowsInsetsCallback;
+import org.mariotaku.twidere.preference.iface.IDialogPreference;
 import org.mariotaku.twidere.util.AsyncTwitterWrapper;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler.KeyboardShortcutCallback;
 import org.mariotaku.twidere.util.MediaLoaderWrapper;
 import org.mariotaku.twidere.util.NotificationManagerWrapper;
+import org.mariotaku.twidere.util.PermissionsManager;
 import org.mariotaku.twidere.util.ReadStateManager;
 import org.mariotaku.twidere.util.SharedPreferencesWrapper;
+import org.mariotaku.twidere.util.StrictModeUtils;
 import org.mariotaku.twidere.util.ThemeUtils;
 import org.mariotaku.twidere.util.UserColorNameManager;
 import org.mariotaku.twidere.util.dagger.GeneralComponentHelper;
 import org.mariotaku.twidere.view.iface.IExtendedView.OnFitSystemWindowsListener;
 
+import java.lang.reflect.Constructor;
+import java.lang.reflect.InvocationTargetException;
 import java.util.ArrayList;
 
 import javax.inject.Inject;
 
 @SuppressLint("Registered")
-public class BaseAppCompatActivity extends ThemedAppCompatActivity implements Constants,
-        OnFitSystemWindowsListener, SystemWindowsInsetsCallback, IControlBarActivity,
-        KeyboardShortcutCallback, IExtendedActivity {
-
+public class BaseActivity extends ATEActivity implements Constants, IExtendedActivity,
+        IThemedActivity, IAppCompatActivity, IControlBarActivity, OnFitSystemWindowsListener,
+        SystemWindowsInsetsCallback, KeyboardShortcutCallback, OnPreferenceDisplayDialogCallback {
+
+    private static final String[] sClassPrefixList = {
+            "android.widget.",
+            "android.view.",
+            "android.webkit."
+    };
     // Utility classes
     @Inject
     protected KeyboardShortcutsHandler mKeyboardShortcutsHandler;
@@ -70,6 +97,8 @@ public class BaseAppCompatActivity extends ThemedAppCompatActivity implements Co
     protected MediaLoaderWrapper mMediaLoader;
     @Inject
     protected UserColorNameManager mUserColorNameManager;
+    @Inject
+    protected PermissionsManager mPermissionsManager;
 
     private ActionHelper mActionHelper = new ActionHelper(this);
 
@@ -79,6 +108,10 @@ public class BaseAppCompatActivity extends ThemedAppCompatActivity implements Co
     // Data fields
     private Rect mSystemWindowsInsets;
     private int mKeyMetaState;
+    // Data fields
+    private int mCurrentThemeColor;
+    private int mCurrentThemeBackgroundAlpha;
+    private String mCurrentThemeBackgroundOption;
 
     @Override
     public boolean getSystemWindowsInsets(Rect insets) {
@@ -87,11 +120,6 @@ public boolean getSystemWindowsInsets(Rect insets) {
         return true;
     }
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getUserAccentColor(this);
-    }
-
     @Override
     public void onFitSystemWindows(Rect insets) {
         if (mSystemWindowsInsets == null)
@@ -147,6 +175,10 @@ public boolean handleKeyboardShortcutRepeat(@NonNull KeyboardShortcutsHandler ha
 
     @Override
     protected void onCreate(final Bundle savedInstanceState) {
+        if (BuildConfig.DEBUG) {
+            StrictModeUtils.detectAllVmPolicy();
+            StrictModeUtils.detectAllThreadPolicy();
+        }
         super.onCreate(savedInstanceState);
         GeneralComponentHelper.build(this).inject(this);
     }
@@ -215,4 +247,128 @@ public void executeAfterFragmentResumed(Action action) {
         mActionHelper.executeAfterFragmentResumed(action);
     }
 
+    @Override
+    public int getCurrentThemeBackgroundAlpha() {
+        return mCurrentThemeBackgroundAlpha;
+    }
+
+    @Override
+    public String getCurrentThemeBackgroundOption() {
+        return mCurrentThemeBackgroundOption;
+    }
+
+    @Override
+    public int getCurrentThemeColor() {
+        return mCurrentThemeColor;
+    }
+
+    @Override
+    public int getThemeBackgroundAlpha() {
+        return ThemeUtils.getUserThemeBackgroundAlpha(this);
+    }
+
+    @Override
+    public String getThemeBackgroundOption() {
+        return ThemeUtils.getThemeBackgroundOption(this);
+    }
+
+    @Nullable
+    @Override
+    public String getATEKey() {
+        return ThemeUtils.getATEKey(this);
+    }
+
+    @Override
+    protected void onApplyThemeResource(@NonNull Resources.Theme theme, int resId, boolean first) {
+        mCurrentThemeBackgroundAlpha = getThemeBackgroundAlpha();
+        mCurrentThemeBackgroundOption = getThemeBackgroundOption();
+        super.onApplyThemeResource(theme, resId, first);
+        final Window window = getWindow();
+        if (shouldApplyWindowBackground()) {
+            ThemeUtils.applyWindowBackground(this, window, mCurrentThemeBackgroundOption,
+                    mCurrentThemeBackgroundAlpha);
+        }
+    }
+
+    @Override
+    public void onConfigurationChanged(Configuration newConfig) {
+        ThemeUtils.fixNightMode(getResources(), newConfig);
+        super.onConfigurationChanged(newConfig);
+    }
+
+    protected boolean shouldApplyWindowBackground() {
+        return true;
+    }
+
+    @Override
+    public View onCreateView(View parent, String name, Context context, AttributeSet attrs) {
+        // Fix for https://github.com/afollestad/app-theme-engine/issues/109
+        if (context != this) {
+            final AppCompatDelegate delegate = getDelegate();
+            View view = delegate.createView(parent, name, context, attrs);
+            if (view == null) {
+                view = newInstance(name, context, attrs);
+            }
+            if (view == null) {
+                view = newInstance(name, context, attrs);
+            }
+            if (view != null) {
+                return view;
+            }
+        }
+        if (parent instanceof TwidereActionMenuView) {
+            final Class<?> cls = findClass(name);
+            if (cls != null && ActionMenuItemView.class.isAssignableFrom(cls)) {
+                return ((TwidereActionMenuView) parent).createActionMenuView(context, attrs);
+            }
+        }
+        return super.onCreateView(parent, name, context, attrs);
+    }
+
+    private Class<?> findClass(String name) {
+        Class<?> cls = null;
+        try {
+            cls = Class.forName(name);
+        } catch (ClassNotFoundException e) {
+            // Ignore
+        }
+        if (cls != null) return cls;
+        for (String prefix : sClassPrefixList) {
+            try {
+                cls = Class.forName(prefix + name);
+            } catch (ClassNotFoundException e) {
+                // Ignore
+            }
+            if (cls != null) return cls;
+        }
+        return null;
+    }
+
+    private View newInstance(String name, Context context, AttributeSet attrs) {
+        try {
+            final Class<?> cls = findClass(name);
+            if (cls == null) throw new ClassNotFoundException(name);
+            final Constructor<?> constructor = cls.getConstructor(Context.class, AttributeSet.class);
+            return (View) constructor.newInstance(context, attrs);
+        } catch (InstantiationException e) {
+            return null;
+        } catch (IllegalAccessException e) {
+            return null;
+        } catch (InvocationTargetException e) {
+            return null;
+        } catch (NoSuchMethodException e) {
+            return null;
+        } catch (ClassNotFoundException e) {
+            return null;
+        }
+    }
+
+    @Override
+    public boolean onPreferenceDisplayDialog(PreferenceFragmentCompat fragment, Preference preference) {
+        if (preference instanceof IDialogPreference) {
+            ((IDialogPreference) preference).displayDialog(fragment);
+            return true;
+        }
+        return false;
+    }
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/BaseSupportDialogActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/BaseSupportDialogActivity.java
deleted file mode 100644
index 7045124154..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/BaseSupportDialogActivity.java
+++ /dev/null
@@ -1,160 +0,0 @@
-/*
- * 				Twidere - Twitter client for Android
- * 
- *  Copyright (C) 2012-2014 Mariotaku Lee <mariotaku.lee@gmail.com>
- * 
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- * 
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- * 
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.activity;
-
-import android.annotation.SuppressLint;
-import android.content.res.Configuration;
-import android.os.Bundle;
-import android.support.annotation.LayoutRes;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.v7.app.AppCompatCallback;
-import android.support.v7.app.AppCompatDelegate;
-import android.support.v7.view.ActionMode;
-import android.view.MenuInflater;
-import android.view.View;
-import android.view.ViewGroup;
-
-import org.mariotaku.twidere.Constants;
-import org.mariotaku.twidere.activity.ThemedFragmentActivity;
-import org.mariotaku.twidere.util.ThemeUtils;
-
-@SuppressLint("Registered")
-public class BaseSupportDialogActivity extends ThemedFragmentActivity implements Constants,
-        AppCompatCallback {
-
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getThemeColor(this);
-    }
-
-    private AppCompatDelegate mDelegate;
-
-    /**
-     * Notifies the Activity that a support action mode has been started.
-     * Activity subclasses overriding this method should call the superclass implementation.
-     *
-     * @param mode The new action mode.
-     */
-    @Override
-    public void onSupportActionModeStarted(ActionMode mode) {
-    }
-
-    /**
-     * Notifies the activity that a support action mode has finished.
-     * Activity subclasses overriding this method should call the superclass implementation.
-     *
-     * @param mode The action mode that just finished.
-     */
-    @Override
-    public void onSupportActionModeFinished(ActionMode mode) {
-    }
-
-    @Nullable
-    @Override
-    public ActionMode onWindowStartingSupportActionMode(ActionMode.Callback callback) {
-        return null;
-    }
-
-    public boolean supportRequestWindowFeature(int featureId) {
-        return getDelegate().requestWindowFeature(featureId);
-    }
-
-    @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        getDelegate().installViewFactory();
-        getDelegate().onCreate(savedInstanceState);
-        super.onCreate(savedInstanceState);
-    }
-
-    @Override
-    protected void onStop() {
-        super.onStop();
-        getDelegate().onStop();
-    }
-
-    @Override
-    protected void onDestroy() {
-        super.onDestroy();
-        getDelegate().onDestroy();
-    }
-
-    @Override
-    protected void onPostCreate(Bundle savedInstanceState) {
-        super.onPostCreate(savedInstanceState);
-        getDelegate().onPostCreate(savedInstanceState);
-    }
-
-    @Override
-    protected void onPostResume() {
-        super.onPostResume();
-        getDelegate().onPostResume();
-    }
-
-    @Override
-    public void onConfigurationChanged(Configuration newConfig) {
-        super.onConfigurationChanged(newConfig);
-        getDelegate().onConfigurationChanged(newConfig);
-    }
-
-    @Override
-    public void setContentView(@LayoutRes int layoutResID) {
-        getDelegate().setContentView(layoutResID);
-    }
-
-    @Override
-    public void setContentView(View view) {
-        getDelegate().setContentView(view);
-    }
-
-    @Override
-    public void setContentView(View view, ViewGroup.LayoutParams params) {
-        getDelegate().setContentView(view, params);
-    }
-
-    @Override
-    public void addContentView(View view, ViewGroup.LayoutParams params) {
-        getDelegate().addContentView(view, params);
-    }
-
-    @Override
-    public void invalidateOptionsMenu() {
-        getDelegate().invalidateOptionsMenu();
-    }
-
-    @NonNull
-    @Override
-    public MenuInflater getMenuInflater() {
-        return getDelegate().getMenuInflater();
-    }
-
-    @Override
-    protected void onTitleChanged(CharSequence title, int color) {
-        super.onTitleChanged(title, color);
-        getDelegate().setTitle(title);
-    }
-
-    public AppCompatDelegate getDelegate() {
-        if (mDelegate == null) {
-            mDelegate = AppCompatDelegate.create(this, this);
-        }
-        return mDelegate;
-    }
-}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/BrowserSignInActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/BrowserSignInActivity.java
index 71d4a96e5c..8445897290 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/BrowserSignInActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/BrowserSignInActivity.java
@@ -54,7 +54,7 @@
 import static android.text.TextUtils.isEmpty;
 
 @SuppressLint("SetJavaScriptEnabled")
-public class BrowserSignInActivity extends BaseAppCompatActivity {
+public class BrowserSignInActivity extends BaseActivity {
 
     private static final String INJECT_CONTENT = "javascript:window.injector.processHTML('<head>'+document.getElementsByTagName('html')[0].innerHTML+'</head>');";
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ColorPickerDialogActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ColorPickerDialogActivity.java
index cbfd5a1c33..a6684bf90c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ColorPickerDialogActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/ColorPickerDialogActivity.java
@@ -23,11 +23,10 @@
 import android.graphics.Color;
 import android.os.Bundle;
 
-import org.mariotaku.twidere.activity.BaseSupportDialogActivity;
-import org.mariotaku.twidere.fragment.support.ColorPickerDialogFragment;
-import org.mariotaku.twidere.fragment.support.ColorPickerDialogFragment.Callback;
+import org.mariotaku.twidere.fragment.ColorPickerDialogFragment;
+import org.mariotaku.twidere.fragment.ColorPickerDialogFragment.Callback;
 
-public class ColorPickerDialogActivity extends BaseSupportDialogActivity implements Callback {
+public class ColorPickerDialogActivity extends BaseActivity implements Callback {
 
     public static final int RESULT_CLEARED = -2;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ComposeActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ComposeActivity.java
index f7e9a2e64d..577a789c84 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ComposeActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/ComposeActivity.java
@@ -106,8 +106,8 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.adapter.ArrayRecyclerAdapter;
 import org.mariotaku.twidere.adapter.BaseRecyclerViewAdapter;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.model.ConsumerKeyType;
 import org.mariotaku.twidere.model.Draft;
 import org.mariotaku.twidere.model.DraftValuesCreator;
@@ -171,7 +171,7 @@
 
 import javax.inject.Inject;
 
-public class ComposeActivity extends BaseAppCompatActivity implements OnMenuItemClickListener,
+public class ComposeActivity extends BaseActivity implements OnMenuItemClickListener,
         OnClickListener, OnLongClickListener, Callback, ATEToolbarCustomizer {
 
     // Constants
@@ -230,11 +230,6 @@ public class ComposeActivity extends BaseAppCompatActivity implements OnMenuItem
     private LocationListener mLocationListener;
     private boolean mNameFirst;
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getUserAccentColor(this);
-    }
-
     @Override
     public void onActivityResult(final int requestCode, final int resultCode, final Intent intent) {
         switch (requestCode) {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/CustomTabEditorActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/CustomTabEditorActivity.java
index aae163ef32..7983f8cc62 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/CustomTabEditorActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/CustomTabEditorActivity.java
@@ -49,7 +49,7 @@
 import org.mariotaku.twidere.adapter.AccountsSpinnerAdapter;
 import org.mariotaku.twidere.adapter.ArrayAdapter;
 import org.mariotaku.twidere.annotation.CustomTabType;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
 import org.mariotaku.twidere.model.CustomTabConfiguration;
 import org.mariotaku.twidere.model.CustomTabConfiguration.ExtraConfiguration;
 import org.mariotaku.twidere.model.ParcelableAccount;
@@ -79,7 +79,7 @@
 import static org.mariotaku.twidere.util.CustomTabUtils.getTabConfiguration;
 import static org.mariotaku.twidere.util.CustomTabUtils.getTabTypeName;
 
-public class CustomTabEditorActivity extends BaseSupportDialogActivity implements OnClickListener {
+public class CustomTabEditorActivity extends BaseActivity implements OnClickListener {
 
     private SharedPreferences mPreferences;
 
@@ -238,7 +238,7 @@ public void setExtraFieldView(final View view, final Object value) {
             text1.setText(mUserColorNameManager.getUserNickname(user.key, user.name, false));
             text2.setText(String.format("@%s", user.screen_name));
             if (displayProfileImage) {
-                mImageLoader.displayProfileImage(icon, user);
+                mMediaLoader.displayProfileImage(icon, user);
             }
         } else if (value instanceof ParcelableUserList) {
             final ParcelableUserList userList = (ParcelableUserList) value;
@@ -246,7 +246,7 @@ public void setExtraFieldView(final View view, final Object value) {
             text1.setText(userList.name);
             text2.setText(getString(R.string.created_by, createdBy));
             if (displayProfileImage) {
-                mImageLoader.displayProfileImage(icon, userList.user_profile_image_url);
+                mMediaLoader.displayProfileImage(icon, userList.user_profile_image_url);
             }
         } else if (value instanceof CharSequence) {
             text2.setVisibility(View.GONE);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/DataExportActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/DataExportActivity.java
index 810657b409..f7cd9ba328 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/DataExportActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/DataExportActivity.java
@@ -8,8 +8,8 @@
 import android.util.Log;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.fragment.support.DataExportImportTypeSelectorDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.DataExportImportTypeSelectorDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.util.DataImportExportUtils;
 import org.mariotaku.twidere.util.ThemeUtils;
 
@@ -19,16 +19,12 @@
 import java.util.Date;
 import java.util.Locale;
 
-public class DataExportActivity extends ThemedFragmentActivity implements DataExportImportTypeSelectorDialogFragment.Callback {
+public class DataExportActivity extends BaseActivity implements
+        DataExportImportTypeSelectorDialogFragment.Callback {
 
     private ExportSettingsTask mTask;
     private Runnable mResumeFragmentsRunnable;
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getThemeColor(this);
-    }
-
     @Override
     public void onCancelled(DialogFragment df) {
         if (!isFinishing()) {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/DataImportActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/DataImportActivity.java
index ac718340cd..cccda71ddc 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/DataImportActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/DataImportActivity.java
@@ -9,25 +9,21 @@
 import android.util.Log;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.fragment.support.DataExportImportTypeSelectorDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.DataExportImportTypeSelectorDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.util.DataImportExportUtils;
 import org.mariotaku.twidere.util.ThemeUtils;
 
 import java.io.File;
 import java.io.IOException;
 
-public class DataImportActivity extends ThemedFragmentActivity implements DataExportImportTypeSelectorDialogFragment.Callback {
+public class DataImportActivity extends BaseActivity implements
+        DataExportImportTypeSelectorDialogFragment.Callback {
 
     private ImportSettingsTask mImportSettingsTask;
     private OpenImportTypeTask mOpenImportTypeTask;
     private Runnable mResumeFragmentsRunnable;
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getThemeColor(this);
-    }
-
     @Override
     public void onCancelled(final DialogFragment df) {
         if (!isFinishing()) {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/FileSelectorActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/FileSelectorActivity.java
index 792560347b..2acecd2699 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/FileSelectorActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/FileSelectorActivity.java
@@ -31,15 +31,15 @@
 import android.widget.Toast;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.BaseSupportDialogActivity;
-import org.mariotaku.twidere.fragment.support.FileSelectorDialogFragment;
+import org.mariotaku.twidere.fragment.FileSelectorDialogFragment;
 import org.mariotaku.twidere.util.PermissionUtils;
 
 import java.io.File;
 
 import static android.os.Environment.getExternalStorageDirectory;
 
-public class FileSelectorActivity extends BaseSupportDialogActivity implements FileSelectorDialogFragment.Callback {
+public class FileSelectorActivity extends BaseActivity implements
+        FileSelectorDialogFragment.Callback {
 
 
     private Runnable mResumeFragmentsRunnable;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/TestActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/HiddenSettingsActivity.java
similarity index 60%
rename from twidere/src/main/java/org/mariotaku/twidere/activity/TestActivity.java
rename to twidere/src/main/java/org/mariotaku/twidere/activity/HiddenSettingsActivity.java
index ed4c0ed0dc..6eebca8ac9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/TestActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/HiddenSettingsActivity.java
@@ -19,18 +19,27 @@
 
 package org.mariotaku.twidere.activity;
 
-import android.app.Activity;
 import android.os.Bundle;
+import android.support.v4.app.Fragment;
+import android.support.v4.app.FragmentManager;
+import android.support.v4.app.FragmentTransaction;
 
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
+import org.mariotaku.twidere.fragment.SettingsDetailsFragment;
 
-public class TestActivity extends Activity implements Constants {
+public class HiddenSettingsActivity extends BaseActivity implements Constants {
 
     @Override
     protected void onCreate(final Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setContentView(R.layout.activity_test);
+        final Bundle fragmentArgs = new Bundle();
+        fragmentArgs.putInt(EXTRA_RESID, R.xml.preferences_hidden);
+        final FragmentManager fm = getSupportFragmentManager();
+        final FragmentTransaction ft = fm.beginTransaction();
+        ft.replace(android.R.id.content, Fragment.instantiate(this,
+                SettingsDetailsFragment.class.getName(), fragmentArgs));
+        ft.commit();
     }
 
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/HomeActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/HomeActivity.java
index 09bb334694..e9cd391267 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/HomeActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/HomeActivity.java
@@ -43,6 +43,7 @@
 import android.support.v4.widget.DrawerLayout;
 import android.support.v4.widget.DrawerLayoutAccessor;
 import android.support.v7.app.ActionBar;
+import android.support.v7.app.AppCompatDelegate;
 import android.support.v7.widget.Toolbar;
 import android.util.SparseIntArray;
 import android.view.Gravity;
@@ -61,12 +62,12 @@
 import org.mariotaku.twidere.adapter.SupportTabsAdapter;
 import org.mariotaku.twidere.annotation.CustomTabType;
 import org.mariotaku.twidere.annotation.ReadPositionTag;
+import org.mariotaku.twidere.fragment.AccountsDashboardFragment;
 import org.mariotaku.twidere.fragment.CustomTabsFragment;
+import org.mariotaku.twidere.fragment.DirectMessagesFragment;
+import org.mariotaku.twidere.fragment.TrendsSuggestionsFragment;
 import org.mariotaku.twidere.fragment.iface.RefreshScrollTopInterface;
 import org.mariotaku.twidere.fragment.iface.SupportFragmentCallback;
-import org.mariotaku.twidere.fragment.support.AccountsDashboardFragment;
-import org.mariotaku.twidere.fragment.support.DirectMessagesFragment;
-import org.mariotaku.twidere.fragment.support.TrendsSuggestionsFragment;
 import org.mariotaku.twidere.graphic.EmptyDrawable;
 import org.mariotaku.twidere.model.ParcelableAccount;
 import org.mariotaku.twidere.model.SupportTabSpec;
@@ -97,7 +98,7 @@
 import java.util.Collections;
 import java.util.List;
 
-public class HomeActivity extends BaseAppCompatActivity implements OnClickListener, OnPageChangeListener,
+public class HomeActivity extends BaseActivity implements OnClickListener, OnPageChangeListener,
         SupportFragmentCallback, OnLongClickListener, DrawerLayout.DrawerListener {
     private final Handler mHandler = new Handler();
 
@@ -330,6 +331,7 @@ protected void onCreate(final Bundle savedInstanceState) {
             finish();
             return;
         }
+        supportRequestWindowFeature(AppCompatDelegate.FEATURE_ACTION_MODE_OVERLAY);
         setContentView(R.layout.activity_home);
 
         setSupportActionBar(mActionBar);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ImageCropperActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ImageCropperActivity.java
index 66d9a3a0fc..42c8245c7c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ImageCropperActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/ImageCropperActivity.java
@@ -54,11 +54,6 @@ public void onCreate(final Bundle savedInstanceState) {
 
     }
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getUserAccentColor(this);
-    }
-
     @Override
     public void setContentView(final int layoutResID) {
         super.setContentView(R.layout.activity_image_cropper);
@@ -90,14 +85,8 @@ public String getThemeBackgroundOption() {
         return ThemeUtils.getThemeBackgroundOption(this);
     }
 
-    @Override
-    public String getThemeFontFamily() {
-        return ThemeUtils.getThemeFontFamily(this);
-    }
-
     @Override
     protected void onApplyThemeResource(@NonNull Resources.Theme theme, int resId, boolean first) {
-        mCurrentThemeColor = getThemeColor();
         mCurrentThemeBackgroundAlpha = getThemeBackgroundAlpha();
         mCurrentThemeBackgroundOption = getThemeBackgroundOption();
         super.onApplyThemeResource(theme, resId, first);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/KeyboardShortcutPreferenceCompatActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/KeyboardShortcutPreferenceCompatActivity.java
index d484e383d0..24d33d57ea 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/KeyboardShortcutPreferenceCompatActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/KeyboardShortcutPreferenceCompatActivity.java
@@ -32,12 +32,11 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler.KeyboardShortcutSpec;
-import org.mariotaku.twidere.util.ThemeUtils;
 
 /**
  * Created by mariotaku on 15/4/20.
  */
-public class KeyboardShortcutPreferenceCompatActivity extends BaseSupportDialogActivity implements
+public class KeyboardShortcutPreferenceCompatActivity extends BaseActivity implements
         Constants, OnClickListener {
 
     public static final String EXTRA_CONTEXT_TAG = "context_tag";
@@ -54,11 +53,6 @@ public String getThemeBackgroundOption() {
         return VALUE_THEME_BACKGROUND_DEFAULT;
     }
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getThemeColor(this);
-    }
-
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
index aa72c62e11..5f03728cc2 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/LinkHandlerActivity.java
@@ -52,7 +52,7 @@
 import static org.mariotaku.twidere.util.Utils.createFragmentForIntent;
 import static org.mariotaku.twidere.util.Utils.matchLinkId;
 
-public class LinkHandlerActivity extends BaseAppCompatActivity implements SystemWindowsInsetsCallback,
+public class LinkHandlerActivity extends BaseActivity implements SystemWindowsInsetsCallback,
         IControlBarActivity, SupportFragmentCallback {
 
     private final View.OnLayoutChangeListener mLayoutChangeListener = new View.OnLayoutChangeListener() {
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/MediaViewerActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/MediaViewerActivity.java
index 33394a6c6e..1fd5434756 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/MediaViewerActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/MediaViewerActivity.java
@@ -80,7 +80,7 @@
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.iface.IExtendedActivity;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.model.ParcelableMedia;
 import org.mariotaku.twidere.model.ParcelableStatus;
 import org.mariotaku.twidere.model.UserKey;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/QuickSearchBarActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/QuickSearchBarActivity.java
index 1ff11ebcb8..7a2c0dd56f 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/QuickSearchBarActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/QuickSearchBarActivity.java
@@ -55,7 +55,7 @@
 
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.adapter.AccountsSpinnerAdapter;
-import org.mariotaku.twidere.fragment.support.UserFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
 import org.mariotaku.twidere.model.ParcelableAccount;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.model.UserKey;
@@ -69,7 +69,6 @@
 import org.mariotaku.twidere.util.MediaLoaderWrapper;
 import org.mariotaku.twidere.util.ParseUtils;
 import org.mariotaku.twidere.util.SwipeDismissListViewTouchListener;
-import org.mariotaku.twidere.util.ThemeUtils;
 import org.mariotaku.twidere.util.UserColorNameManager;
 import org.mariotaku.twidere.util.content.ContentResolverUtils;
 import org.mariotaku.twidere.view.ExtendedRelativeLayout;
@@ -82,7 +81,7 @@
 /**
  * Created by mariotaku on 15/1/6.
  */
-public class QuickSearchBarActivity extends ThemedFragmentActivity implements OnClickListener,
+public class QuickSearchBarActivity extends BaseActivity implements OnClickListener,
         LoaderCallbacks<Cursor>, OnItemSelectedListener, OnItemClickListener,
         OnFitSystemWindowsListener, SwipeDismissListViewTouchListener.DismissCallbacks {
 
@@ -116,11 +115,6 @@ public void onDismiss(ListView listView, int[] reverseSortedPositions) {
         getSupportLoaderManager().restartLoader(0, null, this);
     }
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getUserAccentColor(this);
-    }
-
     @Override
     public void onClick(View v) {
         switch (v.getId()) {
@@ -335,7 +329,7 @@ public static class SuggestionsAdapter extends CursorAdapter implements OnClickL
         static final int VIEW_TYPE_USER_SCREEN_NAME = 3;
 
         private final LayoutInflater mInflater;
-        private final MediaLoaderWrapper mImageLoader;
+        private final MediaLoaderWrapper mMediaLoader;
         private final UserColorNameManager mUserColorNameManager;
         private final QuickSearchBarActivity mActivity;
         private final SortableIntList mRemovedPositions;
@@ -347,7 +341,7 @@ public static class SuggestionsAdapter extends CursorAdapter implements OnClickL
             super(activity, null, 0);
             mRemovedPositions = new SortableIntList();
             mActivity = activity;
-            mImageLoader = activity.mImageLoader;
+            mMediaLoader = activity.mMediaLoader;
             mUserColorNameManager = activity.mUserColorNameManager;
             mInflater = LayoutInflater.from(activity);
         }
@@ -408,7 +402,7 @@ public void bindView(View view, Context context, Cursor cursor) {
                     holder.text2.setVisibility(View.VISIBLE);
                     holder.text2.setText(String.format("@%s", cursor.getString(mIndices.summary)));
                     holder.icon.clearColorFilter();
-                    mImageLoader.displayProfileImage(holder.icon, cursor.getString(mIndices.icon));
+                    mMediaLoader.displayProfileImage(holder.icon, cursor.getString(mIndices.icon));
                     break;
                 }
                 case VIEW_TYPE_USER_SCREEN_NAME: {
@@ -416,7 +410,7 @@ public void bindView(View view, Context context, Cursor cursor) {
                     holder.text1.setText(String.format("@%s", cursor.getString(mIndices.title)));
                     holder.text2.setVisibility(View.GONE);
                     holder.icon.setColorFilter(holder.text1.getCurrentTextColor(), Mode.SRC_ATOP);
-                    mImageLoader.cancelDisplayTask(holder.icon);
+                    mMediaLoader.cancelDisplayTask(holder.icon);
                     holder.icon.setImageResource(R.drawable.ic_action_user);
                     break;
                 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/RequestPermissionsActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/RequestPermissionsActivity.java
index fe646a81c9..4d66103544 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/RequestPermissionsActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/RequestPermissionsActivity.java
@@ -36,13 +36,12 @@
 import android.widget.TextView;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.BaseSupportDialogActivity;
 import org.mariotaku.twidere.util.HtmlEscapeHelper;
 import org.mariotaku.twidere.util.PermissionsManager;
 
 import static android.text.TextUtils.isEmpty;
 
-public class RequestPermissionsActivity extends BaseSupportDialogActivity implements OnClickListener {
+public class RequestPermissionsActivity extends BaseActivity implements OnClickListener {
 
     private ImageView mIconView;
     private TextView mNameView, mDescriptionView, mMessageView;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
index 8e373a0557..b9f4c241f7 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsActivity.java
@@ -36,7 +36,6 @@
 import android.support.v7.app.AlertDialog;
 import android.support.v7.preference.Preference;
 import android.support.v7.preference.PreferenceFragmentCompat;
-import android.support.v7.preference.PreferenceFragmentCompat.OnPreferenceDisplayDialogCallback;
 import android.support.v7.preference.PreferenceFragmentCompat.OnPreferenceStartFragmentCallback;
 import android.view.KeyEvent;
 import android.view.LayoutInflater;
@@ -51,11 +50,11 @@
 import android.widget.TextView;
 
 import org.mariotaku.twidere.R;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
 import org.mariotaku.twidere.fragment.CustomTabsFragment;
 import org.mariotaku.twidere.fragment.ExtensionsListFragment;
 import org.mariotaku.twidere.fragment.SettingsDetailsFragment;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportBrowserFragment;
+import org.mariotaku.twidere.fragment.SupportBrowserFragment;
 import org.mariotaku.twidere.preference.iface.IDialogPreference;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
 import org.mariotaku.twidere.util.ThemeUtils;
@@ -63,8 +62,8 @@
 import java.util.ArrayList;
 import java.util.List;
 
-public class SettingsActivity extends BaseAppCompatActivity implements OnItemClickListener,
-        OnPreferenceStartFragmentCallback, OnPreferenceDisplayDialogCallback {
+public class SettingsActivity extends BaseActivity implements OnItemClickListener,
+        OnPreferenceStartFragmentCallback {
 
     private static final int RESULT_SETTINGS_CHANGED = 10;
 
@@ -261,15 +260,6 @@ protected void openDetails(int position) {
         mSlidingPaneLayout.closePane();
     }
 
-    @Override
-    public boolean onPreferenceDisplayDialog(PreferenceFragmentCompat fragment, Preference preference) {
-        if (preference instanceof IDialogPreference) {
-            ((IDialogPreference) preference).displayDialog(fragment);
-            return true;
-        }
-        return false;
-    }
-
     static class EntriesAdapter extends BaseAdapter {
 
         static final int VIEW_TYPE_PREFERENCE_ENTRY = 0;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsWizardActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsWizardActivity.java
index 8c48876156..7f117533e1 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsWizardActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/SettingsWizardActivity.java
@@ -49,12 +49,12 @@
 import org.mariotaku.twidere.adapter.SupportTabsAdapter;
 import org.mariotaku.twidere.annotation.CustomTabType;
 import org.mariotaku.twidere.fragment.BasePreferenceFragment;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
-import org.mariotaku.twidere.fragment.support.BaseSupportFragment;
-import org.mariotaku.twidere.fragment.support.DirectMessagesFragment;
-import org.mariotaku.twidere.fragment.support.HomeTimelineFragment;
-import org.mariotaku.twidere.fragment.support.InteractionsTimelineFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportFragment;
+import org.mariotaku.twidere.fragment.DirectMessagesFragment;
+import org.mariotaku.twidere.fragment.HomeTimelineFragment;
+import org.mariotaku.twidere.fragment.InteractionsTimelineFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.model.CustomTabConfiguration;
 import org.mariotaku.twidere.model.SupportTabSpec;
 import org.mariotaku.twidere.preference.WizardPageHeaderPreference;
@@ -74,7 +74,7 @@
 import java.util.Collections;
 import java.util.List;
 
-public class SettingsWizardActivity extends BaseAppCompatActivity implements Constants {
+public class SettingsWizardActivity extends BaseActivity implements Constants {
 
     public static final String WIZARD_PREFERENCE_KEY_NEXT_PAGE = "next_page";
     public static final String WIZARD_PREFERENCE_KEY_USE_DEFAULTS = "use_defaults";
@@ -163,11 +163,6 @@ public String getThemeBackgroundOption() {
         return ThemeUtils.getThemeBackgroundOption(this);
     }
 
-    @Override
-    public int getThemeColor() {
-        return ThemeUtils.getUserAccentColor(this);
-    }
-
     @Override
     protected void onCreate(final Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
index 245535e702..67a3486eb9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/SignInActivity.java
@@ -75,9 +75,8 @@
 import org.mariotaku.twidere.api.twitter.auth.OAuthToken;
 import org.mariotaku.twidere.api.twitter.model.Paging;
 import org.mariotaku.twidere.api.twitter.model.User;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
-import org.mariotaku.twidere.graphic.EmptyDrawable;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.model.ParcelableAccount;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.model.ParcelableUser;
@@ -101,8 +100,6 @@
 import org.mariotaku.twidere.util.TwitterContentUtils;
 import org.mariotaku.twidere.util.UserAgentUtils;
 import org.mariotaku.twidere.util.Utils;
-import org.mariotaku.twidere.util.support.ViewSupport;
-import org.mariotaku.twidere.util.support.view.ViewOutlineProviderCompat;
 import org.mariotaku.twidere.util.view.ConsumerKeySecretValidator;
 
 import java.lang.ref.WeakReference;
@@ -114,7 +111,7 @@
 import static org.mariotaku.twidere.util.Utils.showErrorMessage;
 import static org.mariotaku.twidere.util.Utils.trim;
 
-public class SignInActivity extends BaseAppCompatActivity implements OnClickListener, TextWatcher {
+public class SignInActivity extends BaseActivity implements OnClickListener, TextWatcher {
 
     public static final String FRAGMENT_TAG_SIGN_IN_PROGRESS = "sign_in_progress";
     private static final String TWITTER_SIGNUP_URL = "https://twitter.com/signup";
@@ -163,7 +160,7 @@ public void onActivityResult(final int requestCode, final int resultCode, final
                 break;
             }
             case REQUEST_BROWSER_SIGN_IN: {
-                if (resultCode == BaseAppCompatActivity.RESULT_OK && data != null) {
+                if (resultCode == BaseActivity.RESULT_OK && data != null) {
                     doBrowserLogin(data);
                 }
                 break;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedAppCompatActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedAppCompatActivity.java
deleted file mode 100644
index aa30f12c0a..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedAppCompatActivity.java
+++ /dev/null
@@ -1,195 +0,0 @@
-/*
- * 				Twidere - Twitter client for Android
- * 
- *  Copyright (C) 2012-2014 Mariotaku Lee <mariotaku.lee@gmail.com>
- * 
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- * 
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- * 
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.activity;
-
-import android.content.Context;
-import android.content.res.Configuration;
-import android.content.res.Resources;
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.v7.app.AppCompatDelegate;
-import android.support.v7.view.menu.ActionMenuItemView;
-import android.support.v7.widget.TwidereActionMenuView;
-import android.util.AttributeSet;
-import android.view.View;
-import android.view.Window;
-
-import com.afollestad.appthemeengine.ATEActivity;
-
-import org.mariotaku.twidere.BuildConfig;
-import org.mariotaku.twidere.Constants;
-import org.mariotaku.twidere.activity.iface.IAppCompatActivity;
-import org.mariotaku.twidere.activity.iface.IThemedActivity;
-import org.mariotaku.twidere.util.StrictModeUtils;
-import org.mariotaku.twidere.util.ThemeUtils;
-
-import java.lang.reflect.Constructor;
-import java.lang.reflect.InvocationTargetException;
-
-public abstract class ThemedAppCompatActivity extends ATEActivity implements Constants,
-        IThemedActivity, IAppCompatActivity {
-
-    // Data fields
-    private int mCurrentThemeColor;
-    private int mCurrentThemeBackgroundAlpha;
-    private String mCurrentThemeBackgroundOption;
-
-    @Override
-    public int getCurrentThemeBackgroundAlpha() {
-        return mCurrentThemeBackgroundAlpha;
-    }
-
-    @Override
-    public String getCurrentThemeBackgroundOption() {
-        return mCurrentThemeBackgroundOption;
-    }
-
-    @Override
-    public int getCurrentThemeColor() {
-        return mCurrentThemeColor;
-    }
-
-    @Override
-    public int getThemeBackgroundAlpha() {
-        return ThemeUtils.getUserThemeBackgroundAlpha(this);
-    }
-
-    @Override
-    public String getThemeBackgroundOption() {
-        return ThemeUtils.getThemeBackgroundOption(this);
-    }
-
-    @Override
-    public String getThemeFontFamily() {
-        return ThemeUtils.getThemeFontFamily(this);
-    }
-
-    @Override
-    protected void onCreate(final Bundle savedInstanceState) {
-        if (BuildConfig.DEBUG) {
-            StrictModeUtils.detectAllVmPolicy();
-            StrictModeUtils.detectAllThreadPolicy();
-        }
-        super.onCreate(savedInstanceState);
-    }
-
-
-    @Nullable
-    @Override
-    public String getATEKey() {
-        return ThemeUtils.getATEKey(this);
-    }
-
-    @Override
-    protected void onApplyThemeResource(@NonNull Resources.Theme theme, int resId, boolean first) {
-        mCurrentThemeColor = getThemeColor();
-        mCurrentThemeBackgroundAlpha = getThemeBackgroundAlpha();
-        mCurrentThemeBackgroundOption = getThemeBackgroundOption();
-        super.onApplyThemeResource(theme, resId, first);
-        final Window window = getWindow();
-        if (shouldApplyWindowBackground()) {
-            ThemeUtils.applyWindowBackground(this, window, mCurrentThemeBackgroundOption,
-                    mCurrentThemeBackgroundAlpha);
-        }
-    }
-
-
-    @Override
-    public void onConfigurationChanged(Configuration newConfig) {
-        ThemeUtils.fixNightMode(getResources(), newConfig);
-        super.onConfigurationChanged(newConfig);
-    }
-
-    protected boolean shouldApplyWindowBackground() {
-        return true;
-    }
-
-
-    private static final String[] sClassPrefixList = {
-            "android.widget.",
-            "android.view.",
-            "android.webkit."
-    };
-
-    @Override
-    public View onCreateView(View parent, String name, Context context, AttributeSet attrs) {
-        // Fix for https://github.com/afollestad/app-theme-engine/issues/109
-        if (context != this) {
-            final AppCompatDelegate delegate = getDelegate();
-            View view = delegate.createView(parent, name, context, attrs);
-            if (view == null) {
-                view = newInstance(name, context, attrs);
-            }
-            if (view == null) {
-                view = newInstance(name, context, attrs);
-            }
-            if (view != null) {
-                return view;
-            }
-        }
-        if (parent instanceof TwidereActionMenuView) {
-            final Class<?> cls = findClass(name);
-            if (cls != null && ActionMenuItemView.class.isAssignableFrom(cls)) {
-                return ((TwidereActionMenuView) parent).createActionMenuView(context, attrs);
-            }
-        }
-        return super.onCreateView(parent, name, context, attrs);
-    }
-
-    private Class<?> findClass(String name) {
-        Class<?> cls = null;
-        try {
-            cls = Class.forName(name);
-        } catch (ClassNotFoundException e) {
-            // Ignore
-        }
-        if (cls != null) return cls;
-        for (String prefix : sClassPrefixList) {
-            try {
-                cls = Class.forName(prefix + name);
-            } catch (ClassNotFoundException e) {
-                // Ignore
-            }
-            if (cls != null) return cls;
-        }
-        return null;
-    }
-
-    private View newInstance(String name, Context context, AttributeSet attrs) {
-        try {
-            final Class<?> cls = findClass(name);
-            if (cls == null) throw new ClassNotFoundException(name);
-            final Constructor<?> constructor = cls.getConstructor(Context.class, AttributeSet.class);
-            return (View) constructor.newInstance(context, attrs);
-        } catch (InstantiationException e) {
-            return null;
-        } catch (IllegalAccessException e) {
-            return null;
-        } catch (InvocationTargetException e) {
-            return null;
-        } catch (NoSuchMethodException e) {
-            return null;
-        } catch (ClassNotFoundException e) {
-            return null;
-        }
-    }
-
-}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedFragmentActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedFragmentActivity.java
deleted file mode 100644
index a1f5691dde..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/ThemedFragmentActivity.java
+++ /dev/null
@@ -1,183 +0,0 @@
-/*
- * Twidere - Twitter client for Android
- *
- *  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
- *
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.activity;
-
-import android.content.res.Configuration;
-import android.content.res.Resources;
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.v4.app.FragmentActivity;
-import android.view.KeyEvent;
-
-import com.squareup.otto.Bus;
-
-import org.mariotaku.twidere.BuildConfig;
-import org.mariotaku.twidere.Constants;
-import org.mariotaku.twidere.activity.iface.IThemedActivity;
-import org.mariotaku.twidere.util.ActivityTracker;
-import org.mariotaku.twidere.util.AsyncTwitterWrapper;
-import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
-import org.mariotaku.twidere.util.KeyboardShortcutsHandler.KeyboardShortcutCallback;
-import org.mariotaku.twidere.util.MediaLoaderWrapper;
-import org.mariotaku.twidere.util.PermissionsManager;
-import org.mariotaku.twidere.util.SharedPreferencesWrapper;
-import org.mariotaku.twidere.util.StrictModeUtils;
-import org.mariotaku.twidere.util.ThemeUtils;
-import org.mariotaku.twidere.util.UserColorNameManager;
-import org.mariotaku.twidere.util.Utils;
-import org.mariotaku.twidere.util.dagger.GeneralComponentHelper;
-import org.mariotaku.twidere.view.ShapedImageView.ShapeStyle;
-
-import javax.inject.Inject;
-
-public abstract class ThemedFragmentActivity extends FragmentActivity implements Constants,
-        IThemedActivity, KeyboardShortcutCallback {
-
-    // Utility classes
-    @Inject
-    protected KeyboardShortcutsHandler mKeyboardShortcutsHandler;
-    @Inject
-    protected AsyncTwitterWrapper mTwitterWrapper;
-    @Inject
-    protected ActivityTracker mActivityTracker;
-    @Inject
-    protected MediaLoaderWrapper mImageLoader;
-    @Inject
-    protected UserColorNameManager mUserColorNameManager;
-    @Inject
-    protected SharedPreferencesWrapper mPreferences;
-    @Inject
-    protected Bus mBus;
-    @Inject
-    protected PermissionsManager mPermissionsManager;
-
-    //Data fields
-    private int mCurrentThemeColor;
-    private int mCurrentThemeBackgroundAlpha;
-    @ShapeStyle
-    private int mProfileImageStyle;
-    private String mCurrentThemeBackgroundOption;
-    private String mCurrentThemeFontFamily;
-    private int mMetaState;
-
-    @Override
-    public int getCurrentThemeBackgroundAlpha() {
-        return mCurrentThemeBackgroundAlpha;
-    }
-
-    @Override
-    public String getCurrentThemeBackgroundOption() {
-        return mCurrentThemeBackgroundOption;
-    }
-
-    @Override
-    public int getCurrentThemeColor() {
-        return mCurrentThemeColor;
-    }
-
-    @Override
-    public int getThemeBackgroundAlpha() {
-        return ThemeUtils.getUserThemeBackgroundAlpha(this);
-    }
-
-    @Override
-    public String getThemeBackgroundOption() {
-        return ThemeUtils.getThemeBackgroundOption(this);
-    }
-
-    @Override
-    public String getThemeFontFamily() {
-        return ThemeUtils.getThemeFontFamily(this);
-    }
-
-    @Override
-    protected void onCreate(final Bundle savedInstanceState) {
-        if (BuildConfig.DEBUG) {
-            StrictModeUtils.detectAllVmPolicy();
-            StrictModeUtils.detectAllThreadPolicy();
-        }
-        super.onCreate(savedInstanceState);
-        GeneralComponentHelper.build(this).inject(this);
-    }
-
-    @Override
-    public void setTheme(int resId) {
-        super.setTheme(resId);
-        if (shouldApplyWindowBackground()) {
-            ThemeUtils.applyWindowBackground(this, getWindow(),
-                    mCurrentThemeBackgroundOption, mCurrentThemeBackgroundAlpha);
-        }
-    }
-
-    @Override
-    protected void onApplyThemeResource(@NonNull Resources.Theme theme, int resId, boolean first) {
-        mCurrentThemeColor = getThemeColor();
-        mCurrentThemeFontFamily = getThemeFontFamily();
-        mCurrentThemeBackgroundAlpha = getThemeBackgroundAlpha();
-        mCurrentThemeBackgroundOption = getThemeBackgroundOption();
-        mProfileImageStyle = Utils.getProfileImageStyle(this);
-        super.onApplyThemeResource(theme, resId, first);
-    }
-
-    @Override
-    public boolean handleKeyboardShortcutSingle(@NonNull KeyboardShortcutsHandler handler, int keyCode, @NonNull KeyEvent event, int metaState) {
-        return false;
-    }
-
-    @Override
-    public boolean handleKeyboardShortcutRepeat(@NonNull KeyboardShortcutsHandler handler, int keyCode, int repeatCount, @NonNull KeyEvent event, int metaState) {
-        return false;
-    }
-
-    @Override
-    public boolean isKeyboardShortcutHandled(@NonNull KeyboardShortcutsHandler handler, int keyCode, @NonNull KeyEvent event, int metaState) {
-        return false;
-    }
-
-    @Override
-    public boolean onKeyUp(int keyCode, @NonNull KeyEvent event) {
-        if (KeyEvent.isModifierKey(keyCode)) {
-            mMetaState &= ~KeyboardShortcutsHandler.getMetaStateForKeyCode(keyCode);
-        }
-        handleKeyboardShortcutSingle(mKeyboardShortcutsHandler, keyCode, event, mMetaState);
-        return isKeyboardShortcutHandled(mKeyboardShortcutsHandler, keyCode, event, mMetaState) || super.onKeyUp(keyCode, event);
-    }
-
-    @Override
-    public boolean onKeyDown(int keyCode, KeyEvent event) {
-        if (KeyEvent.isModifierKey(keyCode)) {
-            mMetaState |= KeyboardShortcutsHandler.getMetaStateForKeyCode(keyCode);
-        }
-        if (handleKeyboardShortcutRepeat(mKeyboardShortcutsHandler, keyCode, event.getRepeatCount(), event, mMetaState))
-            return true;
-        return isKeyboardShortcutHandled(mKeyboardShortcutsHandler, keyCode, event, mMetaState) || super.onKeyDown(keyCode, event);
-    }
-
-    @Override
-    public void onConfigurationChanged(Configuration newConfig) {
-        ThemeUtils.fixNightMode(getResources(), newConfig);
-        super.onConfigurationChanged(newConfig);
-    }
-
-    protected boolean shouldApplyWindowBackground() {
-        return true;
-    }
-
-}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/UsageStatisticsActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/UsageStatisticsActivity.java
index d1ea8e0b66..d38705dbf4 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/UsageStatisticsActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/UsageStatisticsActivity.java
@@ -19,51 +19,38 @@
 
 package org.mariotaku.twidere.activity;
 
-import android.app.Activity;
-import android.content.Intent;
 import android.content.SharedPreferences;
 import android.os.Bundle;
-import android.preference.PreferenceActivity;
+import android.support.v4.app.Fragment;
+import android.support.v4.app.FragmentManager;
+import android.support.v4.app.FragmentTransaction;
 
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.fragment.SettingsDetailsFragment;
-import org.mariotaku.twidere.util.SharedPreferencesWrapper;
-import org.mariotaku.twidere.util.dagger.DependencyHolder;
 
-public class UsageStatisticsActivity extends Activity implements Constants {
-
-    private static final int REQUEST_USAGE_STATISTICS = 201;
+public class UsageStatisticsActivity extends BaseActivity implements Constants {
 
     @Override
-    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
-        switch (requestCode) {
-            case REQUEST_USAGE_STATISTICS: {
-                DependencyHolder holder = DependencyHolder.get(this);
-                final SharedPreferencesWrapper prefs = holder.getPreferences();
-                if (!prefs.contains(KEY_USAGE_STATISTICS)) {
-                    final SharedPreferences.Editor editor = prefs.edit();
-                    editor.putBoolean(KEY_USAGE_STATISTICS, prefs.getBoolean(KEY_USAGE_STATISTICS));
-                    editor.apply();
-                }
-                finish();
-                return;
-            }
+    protected void onDestroy() {
+        if (!mPreferences.contains(KEY_USAGE_STATISTICS)) {
+            final SharedPreferences.Editor editor = mPreferences.edit();
+            editor.putBoolean(KEY_USAGE_STATISTICS, mPreferences.getBoolean(KEY_USAGE_STATISTICS));
+            editor.apply();
         }
-        super.onActivityResult(requestCode, resultCode, data);
+        super.onDestroy();
     }
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        setVisible(true);
         final Bundle fragmentArgs = new Bundle();
         fragmentArgs.putInt(EXTRA_RESID, R.xml.preferences_usage_statistics);
-        final Intent intent = new Intent(this, SettingsActivity.class);
-        intent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT, SettingsDetailsFragment.class.getName());
-        intent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT_ARGUMENTS, fragmentArgs);
-        intent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT_TITLE, R.string.usage_statistics);
-        startActivityForResult(intent, REQUEST_USAGE_STATISTICS);
+        final FragmentManager fm = getSupportFragmentManager();
+        final FragmentTransaction ft = fm.beginTransaction();
+        ft.replace(android.R.id.content, Fragment.instantiate(this,
+                SettingsDetailsFragment.class.getName(), fragmentArgs));
+        ft.commit();
     }
 
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/UserListSelectorActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/UserListSelectorActivity.java
index 10cfdd807e..9fefee942c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/UserListSelectorActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/UserListSelectorActivity.java
@@ -46,8 +46,8 @@
 import org.mariotaku.twidere.api.twitter.model.ResponseList;
 import org.mariotaku.twidere.api.twitter.model.User;
 import org.mariotaku.twidere.api.twitter.model.UserList;
-import org.mariotaku.twidere.fragment.support.CreateUserListDialogFragment;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.CreateUserListDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 import org.mariotaku.twidere.model.ParcelableUser;
 import org.mariotaku.twidere.model.ParcelableUserList;
 import org.mariotaku.twidere.model.SingleResponse;
@@ -65,7 +65,8 @@
 import static android.text.TextUtils.isEmpty;
 import static org.mariotaku.twidere.util.DataStoreUtils.getAccountScreenName;
 
-public class UserListSelectorActivity extends BaseSupportDialogActivity implements OnClickListener, OnItemClickListener {
+public class UserListSelectorActivity extends BaseActivity implements OnClickListener,
+        OnItemClickListener {
 
     private AutoCompleteTextView mEditScreenName;
     private ListView mUserListsListView, mUsersListView;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/activity/iface/IThemedActivity.java b/twidere/src/main/java/org/mariotaku/twidere/activity/iface/IThemedActivity.java
index 4a60efaf71..7dd05f00a5 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/activity/iface/IThemedActivity.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/activity/iface/IThemedActivity.java
@@ -31,8 +31,4 @@ public interface IThemedActivity {
 
     String getThemeBackgroundOption();
 
-    int getThemeColor();
-
-    String getThemeFontFamily();
-
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/adapter/AccountsSpinnerAdapter.java b/twidere/src/main/java/org/mariotaku/twidere/adapter/AccountsSpinnerAdapter.java
index bf3c496337..43ace6d4f6 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/adapter/AccountsSpinnerAdapter.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/adapter/AccountsSpinnerAdapter.java
@@ -27,7 +27,7 @@
 import android.widget.TextView;
 
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.fragment.support.MessagesConversationFragment;
+import org.mariotaku.twidere.fragment.MessagesConversationFragment;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.model.UserKey;
 import org.mariotaku.twidere.util.MediaLoaderWrapper;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/adapter/ComposeAutoCompleteAdapter.java b/twidere/src/main/java/org/mariotaku/twidere/adapter/ComposeAutoCompleteAdapter.java
index ed2c08acb6..01614a46ed 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/adapter/ComposeAutoCompleteAdapter.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/adapter/ComposeAutoCompleteAdapter.java
@@ -27,6 +27,7 @@
 import android.text.TextUtils;
 import android.view.View;
 import android.widget.FilterQueryProvider;
+import android.widget.ImageView;
 import android.widget.TextView;
 
 import org.apache.commons.lang3.StringUtils;
@@ -71,7 +72,7 @@ public ComposeAutoCompleteAdapter(final Context context) {
     public void bindView(final View view, final Context context, final Cursor cursor) {
         final TextView text1 = (TextView) view.findViewById(android.R.id.text1);
         final TextView text2 = (TextView) view.findViewById(android.R.id.text2);
-        final ProfileImageView icon = (ProfileImageView) view.findViewById(android.R.id.icon);
+        final ImageView icon = (ImageView) view.findViewById(android.R.id.icon);
 
         // Clear images in order to prevent images in recycled view shown.
         icon.setImageDrawable(null);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/adapter/ParcelableActivitiesAdapter.java b/twidere/src/main/java/org/mariotaku/twidere/adapter/ParcelableActivitiesAdapter.java
index 4b2e8860c0..88a0a3bd86 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/adapter/ParcelableActivitiesAdapter.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/adapter/ParcelableActivitiesAdapter.java
@@ -36,8 +36,8 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.adapter.iface.IActivitiesAdapter;
 import org.mariotaku.twidere.api.twitter.model.Activity;
-import org.mariotaku.twidere.fragment.support.CursorActivitiesFragment;
-import org.mariotaku.twidere.fragment.support.UserFragment;
+import org.mariotaku.twidere.fragment.CursorActivitiesFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
 import org.mariotaku.twidere.model.ParcelableActivity;
 import org.mariotaku.twidere.model.ParcelableActivityCursorIndices;
 import org.mariotaku.twidere.model.ParcelableMedia;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/adapter/UserAutoCompleteAdapter.java b/twidere/src/main/java/org/mariotaku/twidere/adapter/UserAutoCompleteAdapter.java
index 2c54a5ad49..f15dd60a92 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/adapter/UserAutoCompleteAdapter.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/adapter/UserAutoCompleteAdapter.java
@@ -26,6 +26,7 @@
 import android.text.TextUtils;
 import android.view.View;
 import android.widget.FilterQueryProvider;
+import android.widget.ImageView;
 import android.widget.TextView;
 
 import org.mariotaku.sqliteqb.library.Columns;
@@ -73,7 +74,7 @@ public UserAutoCompleteAdapter(final Context context) {
     public void bindView(final View view, final Context context, final Cursor cursor) {
         final TextView text1 = (TextView) view.findViewById(android.R.id.text1);
         final TextView text2 = (TextView) view.findViewById(android.R.id.text2);
-        final ProfileImageView icon = (ProfileImageView) view.findViewById(android.R.id.icon);
+        final ImageView icon = (ImageView) view.findViewById(android.R.id.icon);
 
         // Clear images in order to prevent images in recycled view shown.
         icon.setImageDrawable(null);
diff --git a/twidere/src/main/java/org/mariotaku/twidere/app/TwidereApplication.java b/twidere/src/main/java/org/mariotaku/twidere/app/TwidereApplication.java
index e96514d3a9..5a1529141c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/app/TwidereApplication.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/app/TwidereApplication.java
@@ -53,6 +53,7 @@
 import org.mariotaku.twidere.activity.MainActivity;
 import org.mariotaku.twidere.activity.MainHondaJOJOActivity;
 import org.mariotaku.twidere.service.RefreshService;
+import org.mariotaku.twidere.util.theme.ProfileImageViewViewProcessor;
 import org.mariotaku.twidere.util.BugReporter;
 import org.mariotaku.twidere.util.DebugModeUtils;
 import org.mariotaku.twidere.util.ExternalThemeManager;
@@ -68,11 +69,13 @@
 import org.mariotaku.twidere.util.theme.ActionBarContextViewViewProcessor;
 import org.mariotaku.twidere.util.theme.ExtendedSwipeRefreshLayoutViewProcessor;
 import org.mariotaku.twidere.util.theme.FloatingActionButtonViewProcessor;
+import org.mariotaku.twidere.util.theme.OptimalLinkColorTagProcessor;
 import org.mariotaku.twidere.util.theme.ProgressWheelViewProcessor;
 import org.mariotaku.twidere.util.theme.TabPagerIndicatorViewProcessor;
 import org.mariotaku.twidere.util.theme.TimelineContentTextViewViewProcessor;
-import org.mariotaku.twidere.view.TabPagerIndicator;
 import org.mariotaku.twidere.view.ExtendedSwipeRefreshLayout;
+import org.mariotaku.twidere.view.ProfileImageView;
+import org.mariotaku.twidere.view.TabPagerIndicator;
 import org.mariotaku.twidere.view.TimelineContentTextView;
 
 public class TwidereApplication extends Application implements Constants,
@@ -89,6 +92,7 @@ public class TwidereApplication extends Application implements Constants,
     private SQLiteDatabase mDatabase;
 
     private ApplicationModule mApplicationModule;
+    private ProfileImageViewViewProcessor mProfileImageViewViewProcessor;
 
     @NonNull
     public static TwidereApplication getInstance(@NonNull final Context context) {
@@ -137,6 +141,9 @@ public void onCreate() {
         ATE.registerViewProcessor(ExtendedSwipeRefreshLayout.class, new ExtendedSwipeRefreshLayoutViewProcessor());
         ATE.registerViewProcessor(TimelineContentTextView.class, new TimelineContentTextViewViewProcessor());
         ATE.registerViewProcessor(ProgressWheel.class, new ProgressWheelViewProcessor());
+        mProfileImageViewViewProcessor = new ProfileImageViewViewProcessor();
+        ATE.registerViewProcessor(ProfileImageView.class, mProfileImageViewViewProcessor);
+        ATE.registerTagProcessor("optimal_link_color", new OptimalLinkColorTagProcessor());
         final SharedPreferences preferences = getSharedPreferences();
         if (!ATE.config(this, null).isConfigured()) {
             final int themeColor = preferences.getInt(KEY_THEME_COLOR, ContextCompat.getColor(this,
@@ -297,6 +304,11 @@ public void onSharedPreferenceChanged(final SharedPreferences preferences, final
                 Config.markChanged(this, VALUE_THEME_NAME_LIGHT, VALUE_THEME_NAME_DARK);
                 break;
             }
+            case KEY_PROFILE_IMAGE_STYLE: {
+                Config.markChanged(this, VALUE_THEME_NAME_LIGHT, VALUE_THEME_NAME_DARK);
+                mProfileImageViewViewProcessor.setStyle(Utils.getProfileImageStyle(preferences.getString(key, null)));
+                break;
+            }
             case KEY_THEME_COLOR: {
                 final int themeColor = preferences.getInt(key, ContextCompat.getColor(this,
                         R.color.branding_color));
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsActivitiesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsActivitiesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsActivitiesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsActivitiesFragment.java
index f1c6dc9858..6732d552b2 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsActivitiesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsActivitiesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.content.Intent;
@@ -45,7 +45,7 @@
 import org.mariotaku.twidere.adapter.decorator.DividerItemDecoration;
 import org.mariotaku.twidere.adapter.iface.ILoadMoreSupportAdapter.IndicatorPosition;
 import org.mariotaku.twidere.annotation.ReadPositionTag;
-import org.mariotaku.twidere.fragment.support.AbsStatusesFragment.DefaultOnLikedListener;
+import org.mariotaku.twidere.fragment.AbsStatusesFragment.DefaultOnLikedListener;
 import org.mariotaku.twidere.loader.iface.IExtendedLoader;
 import org.mariotaku.twidere.model.BaseRefreshTaskParam;
 import org.mariotaku.twidere.model.ParcelableActivity;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListRecyclerViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListRecyclerViewFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListRecyclerViewFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListRecyclerViewFragment.java
index 8d3c78845b..260a37e74b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListRecyclerViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListRecyclerViewFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.support.annotation.NonNull;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListViewFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListViewFragment.java
index 85419c04fa..25b9e2e54d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentListViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentListViewFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.graphics.Rect;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentRecyclerViewFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentRecyclerViewFragment.java
index a4c4b8ea2b..a0aacaaf5c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsContentRecyclerViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsContentRecyclerViewFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.graphics.Rect;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsStatusesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsStatusesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsStatusesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsStatusesFragment.java
index d8493df6a4..51721a2209 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsStatusesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsStatusesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.content.Intent;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsToolbarTabPagesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsToolbarTabPagesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsToolbarTabPagesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AbsToolbarTabPagesFragment.java
index c4f154906e..2bff200bf9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AbsToolbarTabPagesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AbsToolbarTabPagesFragment.java
@@ -1,4 +1,4 @@
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.content.Intent;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsDashboardFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsDashboardFragment.java
index cd9f92a77c..1fb87da59b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsDashboardFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsDashboardFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.animation.Animator;
 import android.animation.Animator.AnimatorListener;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsManagerFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsManagerFragment.java
index f5a7d1bd25..1bcd27b212 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AccountsManagerFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AccountsManagerFragment.java
@@ -1,4 +1,4 @@
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.app.AlertDialog;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AddStatusFilterDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/AddStatusFilterDialogFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/AddStatusFilterDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/AddStatusFilterDialogFragment.java
index 24c3914065..b210df116b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/AddStatusFilterDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/AddStatusFilterDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.ContentResolver;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseFiltersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseFiltersFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseFiltersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/BaseFiltersFragment.java
index 322036923d..3822a8bfab 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseFiltersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseFiltersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.ContentResolver;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportDialogFragment.java
index b9d18f4253..abfa2cf185 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.content.BroadcastReceiver;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportFragment.java
index e7c3998e66..1773be2887 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.content.BroadcastReceiver;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportWebViewFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportWebViewFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportWebViewFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportWebViewFragment.java
index 82879404f7..0db4a20b36 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/BaseSupportWebViewFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/BaseSupportWebViewFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.annotation.SuppressLint;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ColorPickerDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ColorPickerDialogFragment.java
index baff31f804..7ee5a0a1b7 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ColorPickerDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ColorPickerDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.DialogInterface;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserBlockDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserBlockDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserBlockDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserBlockDialogFragment.java
index c7f04dc2ee..c4a24fcb86 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserBlockDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserBlockDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserListDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserListDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserListDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserListDialogFragment.java
index ec65454d05..3df58b3bce 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserListDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserListDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.DialogInterface;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserMuteDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserMuteDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserMuteDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserMuteDialogFragment.java
index 910ef8eff4..d724bc5d30 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CreateUserMuteDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CreateUserMuteDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorActivitiesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorActivitiesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorActivitiesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CursorActivitiesFragment.java
index 8f3bebbe6c..1f08de0071 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorActivitiesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorActivitiesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.ContentResolver;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorStatusesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorStatusesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorStatusesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CursorStatusesFragment.java
index d860cb24a5..8037ba82ed 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorStatusesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorStatusesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.ContentResolver;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorSupportUsersListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorSupportUsersListFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorSupportUsersListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/CursorSupportUsersListFragment.java
index d0d5281ae9..74ad0735ec 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/CursorSupportUsersListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CursorSupportUsersListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
index 8b35e036cf..d5a86c5645 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/CustomTabsFragment.java
@@ -61,7 +61,6 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.SettingsActivity;
 import org.mariotaku.twidere.activity.CustomTabEditorActivity;
-import org.mariotaku.twidere.fragment.support.BaseSupportFragment;
 import org.mariotaku.twidere.model.CustomTabConfiguration;
 import org.mariotaku.twidere.model.CustomTabConfiguration.CustomTabConfigurationComparator;
 import org.mariotaku.twidere.model.UserKey;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DataExportImportTypeSelectorDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DataExportImportTypeSelectorDialogFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DataExportImportTypeSelectorDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DataExportImportTypeSelectorDialogFragment.java
index e8d2bf63f7..1d328ac23b 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DataExportImportTypeSelectorDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DataExportImportTypeSelectorDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DeleteUserListMembersDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DeleteUserListMembersDialogFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DeleteUserListMembersDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DeleteUserListMembersDialogFragment.java
index a057006e54..fbc4520164 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DeleteUserListMembersDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DeleteUserListMembersDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyFriendshipDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyFriendshipDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyFriendshipDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyFriendshipDialogFragment.java
index 9014ec9c78..5728d1eea8 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyFriendshipDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyFriendshipDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroySavedSearchDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroySavedSearchDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroySavedSearchDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DestroySavedSearchDialogFragment.java
index 125036097c..44eceab850 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroySavedSearchDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroySavedSearchDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyStatusDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyStatusDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyStatusDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyStatusDialogFragment.java
index 3915d3a3e2..af35b37b07 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyStatusDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyStatusDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListDialogFragment.java
index 21cffdf6e2..edc0770ee8 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListSubscriptionDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListSubscriptionDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListSubscriptionDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListSubscriptionDialogFragment.java
index 46919464d7..0098cacb58 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DestroyUserListSubscriptionDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DestroyUserListSubscriptionDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DirectMessagesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DirectMessagesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DirectMessagesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DirectMessagesFragment.java
index ef4ded8302..e85fe9cf76 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DirectMessagesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DirectMessagesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.ContentResolver;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/DraftsFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/DraftsFragment.java
index 0214334870..669cc650a0 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/DraftsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/DraftsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.AlertDialog;
 import android.app.Dialog;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FileSelectorDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/FileSelectorDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/FileSelectorDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/FileSelectorDialogFragment.java
index a744d4ec70..6cd933ce4e 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FileSelectorDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/FileSelectorDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.AlertDialog;
 import android.app.Dialog;
@@ -207,7 +207,7 @@ private static class FilesAdapter extends ArrayAdapter<File> {
         public FilesAdapter(final Context context) {
             super(context, android.R.layout.simple_list_item_1);
             mResources = context.getResources();
-            mActionIconColor = ThemeUtils.isDarkTheme(context) ? 0xffffffff : 0xc0333333;
+            mActionIconColor = !ThemeUtils.isLightTheme(context) ? 0xffffffff : 0xc0333333;
             mPadding = (int) (4 * mResources.getDisplayMetrics().density);
         }
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/FiltersFragment.java
similarity index 79%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/FiltersFragment.java
index 7dfaac8a51..c444fef1c2 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/FiltersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/FiltersFragment.java
@@ -17,16 +17,16 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.os.Bundle;
 
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.adapter.SupportTabsAdapter;
-import org.mariotaku.twidere.fragment.support.BaseFiltersFragment.FilteredKeywordsFragment;
-import org.mariotaku.twidere.fragment.support.BaseFiltersFragment.FilteredLinksFragment;
-import org.mariotaku.twidere.fragment.support.BaseFiltersFragment.FilteredSourcesFragment;
-import org.mariotaku.twidere.fragment.support.BaseFiltersFragment.FilteredUsersFragment;
+import org.mariotaku.twidere.fragment.BaseFiltersFragment.FilteredKeywordsFragment;
+import org.mariotaku.twidere.fragment.BaseFiltersFragment.FilteredLinksFragment;
+import org.mariotaku.twidere.fragment.BaseFiltersFragment.FilteredSourcesFragment;
+import org.mariotaku.twidere.fragment.BaseFiltersFragment.FilteredUsersFragment;
 
 public class FiltersFragment extends AbsToolbarTabPagesFragment {
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/HomeTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/HomeTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/HomeTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/HomeTimelineFragment.java
index 75fbfe6550..aa3f6beb75 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/HomeTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/HomeTimelineFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.net.Uri;
 import android.support.annotation.NonNull;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/HostMappingsListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/HostMappingsListFragment.java
index 99b841c65f..65f3c42cf9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/HostMappingsListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/HostMappingsListFragment.java
@@ -51,7 +51,6 @@
 import org.apache.commons.lang3.StringUtils;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.adapter.ArrayAdapter;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
 import org.mariotaku.twidere.util.ParseUtils;
 import org.mariotaku.twidere.util.SharedPreferencesWrapper;
 import org.mariotaku.twidere.util.ThemeUtils;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/IncomingFriendshipsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/IncomingFriendshipsFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/IncomingFriendshipsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/IncomingFriendshipsFragment.java
index 4a37c3b779..4de5445f5d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/IncomingFriendshipsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/IncomingFriendshipsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/InteractionsTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/InteractionsTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/InteractionsTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/InteractionsTimelineFragment.java
index d478b2e028..d25b6a5334 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/InteractionsTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/InteractionsTimelineFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.net.Uri;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/InvalidTabFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/InvalidTabFragment.java
similarity index 89%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/InvalidTabFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/InvalidTabFragment.java
index 840370874b..6eb33b1762 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/InvalidTabFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/InvalidTabFragment.java
@@ -1,4 +1,4 @@
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.os.Bundle;
 import android.view.LayoutInflater;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/KeyboardShortcutsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/KeyboardShortcutsFragment.java
index e9044b8ef0..f9ec30ae65 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/KeyboardShortcutsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/KeyboardShortcutsFragment.java
@@ -23,7 +23,6 @@
 import android.content.Context;
 import android.content.DialogInterface;
 import android.content.DialogInterface.OnClickListener;
-import android.content.DialogInterface.OnKeyListener;
 import android.content.Intent;
 import android.content.SharedPreferences;
 import android.content.SharedPreferences.OnSharedPreferenceChangeListener;
@@ -32,21 +31,14 @@
 import android.support.annotation.Nullable;
 import android.support.v4.app.DialogFragment;
 import android.support.v7.app.AlertDialog;
-import android.support.v7.preference.DialogPreference;
 import android.support.v7.preference.Preference;
-import android.text.TextUtils;
-import android.util.Log;
-import android.view.KeyEvent;
 import android.view.Menu;
 import android.view.MenuInflater;
 import android.view.MenuItem;
-import android.view.View;
-import android.widget.TextView;
 
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.KeyboardShortcutPreferenceCompatActivity;
 import org.mariotaku.twidere.constant.KeyboardShortcutConstants;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler;
 import org.mariotaku.twidere.util.KeyboardShortcutsHandler.KeyboardShortcutSpec;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ListsFragment.java
similarity index 96%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ListsFragment.java
index d7b8fa56a2..3f97e2309c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ListsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ListsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.os.Bundle;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/MessagesConversationFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/MessagesConversationFragment.java
index 428107f81b..6a68749463 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MessagesConversationFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/MessagesConversationFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.app.AlertDialog;
@@ -75,7 +75,7 @@
 import org.mariotaku.sqliteqb.library.OrderBy;
 import org.mariotaku.sqliteqb.library.RawItemArray;
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.BaseAppCompatActivity;
+import org.mariotaku.twidere.activity.BaseActivity;
 import org.mariotaku.twidere.activity.ThemedImagePickerActivity;
 import org.mariotaku.twidere.adapter.AccountsSpinnerAdapter;
 import org.mariotaku.twidere.adapter.MessageConversationAdapter;
@@ -226,7 +226,7 @@ public View onCreateView(final LayoutInflater inflater, final ViewGroup containe
     public void onActivityCreated(final Bundle savedInstanceState) {
         super.onActivityCreated(savedInstanceState);
 
-        final BaseAppCompatActivity activity = (BaseAppCompatActivity) getActivity();
+        final BaseActivity activity = (BaseActivity) getActivity();
         mMessageDrafts = activity.getSharedPreferences(MESSAGE_DRAFTS_PREFERENCES_NAME, Context.MODE_PRIVATE);
 
         final View view = getView();
@@ -663,15 +663,15 @@ private void setupEditQuery() {
             @Override
             public boolean shouldCallListener() {
                 final FragmentActivity activity = getActivity();
-                if (!(activity instanceof BaseAppCompatActivity)) return false;
-                return ((BaseAppCompatActivity) activity).getKeyMetaState() == 0;
+                if (!(activity instanceof BaseActivity)) return false;
+                return ((BaseActivity) activity).getKeyMetaState() == 0;
             }
 
             @Override
             public boolean onHitEnter() {
                 final FragmentActivity activity = getActivity();
-                if (!(activity instanceof BaseAppCompatActivity)) return false;
-                if (((BaseAppCompatActivity) activity).getKeyMetaState() != 0) return false;
+                if (!(activity instanceof BaseActivity)) return false;
+                if (((BaseActivity) activity).getKeyMetaState() != 0) return false;
                 final ParcelableCredentials account = (ParcelableCredentials) mAccountSpinner.getSelectedItem();
                 if (account == null) return false;
                 mEditText.setAccountKey(account.account_key);
@@ -766,7 +766,7 @@ private void showMenu(final View view, final ParcelableDirectMessage dm) {
     }
 
     private void updateActionBar() {
-        final BaseAppCompatActivity activity = (BaseAppCompatActivity) getActivity();
+        final BaseActivity activity = (BaseActivity) getActivity();
         final ActionBar actionBar = activity.getSupportActionBar();
         if (actionBar == null) return;
         actionBar.setDisplayOptions(mRecipient != null ? ActionBar.DISPLAY_SHOW_TITLE : ActionBar.DISPLAY_SHOW_CUSTOM,
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MutesUsersListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/MutesUsersListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/MutesUsersListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/MutesUsersListFragment.java
index 8846e3efb8..60299bc97f 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/MutesUsersListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/MutesUsersListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
index 767c53b14b..811736db10 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/NetworkDiagnosticsFragment.java
@@ -33,7 +33,6 @@
 import org.mariotaku.twidere.api.twitter.Twitter;
 import org.mariotaku.twidere.api.twitter.TwitterException;
 import org.mariotaku.twidere.api.twitter.model.Paging;
-import org.mariotaku.twidere.fragment.support.BaseSupportFragment;
 import org.mariotaku.twidere.model.ParcelableCredentials;
 import org.mariotaku.twidere.model.UserKey;
 import org.mariotaku.twidere.model.util.ParcelableCredentialsUtils;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableGroupsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableGroupsFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableGroupsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableGroupsFragment.java
index e0fe4001da..5493e6f3c5 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableGroupsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableGroupsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableStatusesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableStatusesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableStatusesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableStatusesFragment.java
index dd1783f9db..a8db0e5011 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableStatusesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableStatusesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUserListsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUserListsFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUserListsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUserListsFragment.java
index 272195f260..7176bbbe14 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUserListsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUserListsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUsersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUsersFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUsersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUsersFragment.java
index b451fd8cdf..678535a992 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ParcelableUsersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ParcelableUsersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.content.Intent;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/PhishingLinkWarningDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/PhishingLinkWarningDialogFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/PhishingLinkWarningDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/PhishingLinkWarningDialogFragment.java
index 2fa8062a6a..9508b54d61 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/PhishingLinkWarningDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/PhishingLinkWarningDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.DialogInterface;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/PublicTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/PublicTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/PublicTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/PublicTimelineFragment.java
index b3a24599f1..f5313c6cad 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/PublicTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/PublicTimelineFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ReportSpamDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ReportSpamDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ReportSpamDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ReportSpamDialogFragment.java
index 2e1c60ec97..f24cc3a9a1 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ReportSpamDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ReportSpamDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetQuoteDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetQuoteDialogFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetQuoteDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetQuoteDialogFragment.java
index 44c8806e85..21cc622108 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetQuoteDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetQuoteDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.annotation.SuppressLint;
 import android.app.Dialog;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetsOfMeFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetsOfMeFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetsOfMeFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetsOfMeFragment.java
index 151dc700ad..ff3fc619b7 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/RetweetsOfMeFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/RetweetsOfMeFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SavedSearchesListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SavedSearchesListFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SavedSearchesListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SavedSearchesListFragment.java
index 890b581a7a..48e34cd243 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SavedSearchesListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SavedSearchesListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ScheduledStatusesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/ScheduledStatusesFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/ScheduledStatusesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/ScheduledStatusesFragment.java
index 733d1f1018..5710d1db70 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ScheduledStatusesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/ScheduledStatusesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SearchFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SearchFragment.java
index e839a45800..bb2a93f501 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SearchFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.ContentResolver;
 import android.content.ContentValues;
@@ -26,12 +26,9 @@
 import android.provider.SearchRecentSuggestions;
 import android.support.v4.view.ViewPager.OnPageChangeListener;
 import android.text.TextUtils;
-import android.view.LayoutInflater;
 import android.view.Menu;
 import android.view.MenuInflater;
 import android.view.MenuItem;
-import android.view.View;
-import android.view.ViewGroup;
 
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.ComposeActivity;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchUsersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SearchUsersFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchUsersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SearchUsersFragment.java
index 593f95b0e0..7a29530643 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SearchUsersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SearchUsersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SensitiveContentWarningDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SensitiveContentWarningDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SensitiveContentWarningDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SensitiveContentWarningDialogFragment.java
index c4f55ec78d..11776622b3 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SensitiveContentWarningDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SensitiveContentWarningDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SetUserNicknameDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SetUserNicknameDialogFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SetUserNicknameDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SetUserNicknameDialogFragment.java
index 8e3bee84ad..9bfe4eed1a 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SetUserNicknameDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SetUserNicknameDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFavoritersListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFavoritersListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFavoritersListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFavoritersListFragment.java
index d76cf08992..787f9f9747 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFavoritersListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFavoritersListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFragment.java
index 7c065750e7..a31d37e502 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.app.AlertDialog;
@@ -101,7 +101,7 @@
 import org.mariotaku.twidere.api.twitter.model.TranslationResult;
 import org.mariotaku.twidere.api.twitter.model.User;
 import org.mariotaku.twidere.constant.IntentConstants;
-import org.mariotaku.twidere.fragment.support.AbsStatusesFragment.DefaultOnLikedListener;
+import org.mariotaku.twidere.fragment.AbsStatusesFragment.DefaultOnLikedListener;
 import org.mariotaku.twidere.loader.ConversationLoader;
 import org.mariotaku.twidere.loader.ParcelableStatusLoader;
 import org.mariotaku.twidere.menu.support.FavoriteItemProvider;
@@ -985,7 +985,8 @@ public void displayStatus(@Nullable final ParcelableCredentials account,
             final Context context = adapter.getContext();
             final MediaLoaderWrapper loader = adapter.getMediaLoader();
             final UserColorNameManager manager = adapter.getUserColorNameManager();
-            AsyncTwitterWrapper twitter = adapter.getTwitterWrapper();
+            final BidiFormatter formatter = adapter.getBidiFormatter();
+            final AsyncTwitterWrapper twitter = adapter.getTwitterWrapper();
             final boolean nameFirst = adapter.isNameFirst();
 
             linkClickHandler.setStatus(status);
@@ -1014,6 +1015,7 @@ public void displayStatus(@Nullable final ParcelableCredentials account,
 
                 quotedNameView.setName(manager.getUserNickname(status.quoted_user_id, status.quoted_user_name, false));
                 quotedNameView.setScreenName(String.format("@%s", status.quoted_user_screen_name));
+                quotedNameView.updateText(formatter);
 
                 final CharSequence quotedText = HtmlSpanBuilder.fromHtml(status.quoted_text_html,
                         status.text_unescaped);
@@ -1039,7 +1041,6 @@ public void displayStatus(@Nullable final ParcelableCredentials account,
                 timestamp = status.timestamp;
             }
 
-            final BidiFormatter formatter = adapter.getBidiFormatter();
 
             nameView.setName(manager.getUserNickname(status.user_key, status.user_name, false));
             nameView.setScreenName(String.format("@%s", status.user_screen_name));
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusRetweetersListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusRetweetersListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusRetweetersListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StatusRetweetersListFragment.java
index 0c1bf4559e..258c6ce0aa 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusRetweetersListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusRetweetersListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesListFragment.java
index 1427415636..2f00993a06 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesSearchFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesSearchFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesSearchFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesSearchFragment.java
index cc84195b6a..844b1b8cea 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/StatusesSearchFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StatusesSearchFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.graphics.Rect;
diff --git a/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/StubFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/StubFragment.java
similarity index 97%
rename from twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/StubFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/StubFragment.java
index 4c9a5836a7..a97ab423e5 100644
--- a/twidere/src/fdroid/java/org/mariotaku/twidere/fragment/support/StubFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/StubFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.os.Bundle;
 import android.support.annotation.Nullable;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportBrowserFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportBrowserFragment.java
similarity index 96%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportBrowserFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SupportBrowserFragment.java
index 3bf101567f..3992cb4048 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportBrowserFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportBrowserFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.os.Bundle;
 import android.webkit.WebView;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportMessageDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportMessageDialogFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportMessageDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SupportMessageDialogFragment.java
index 6a234aa9d5..8cba72d7e1 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportMessageDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportMessageDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.AlertDialog;
 import android.app.Dialog;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportProgressDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportProgressDialogFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportProgressDialogFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/SupportProgressDialogFragment.java
index 20646b1984..84d2d0623d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/SupportProgressDialogFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/SupportProgressDialogFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Dialog;
 import android.app.ProgressDialog;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/TrendsSuggestionsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/TrendsSuggestionsFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/TrendsSuggestionsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/TrendsSuggestionsFragment.java
index ebd54c6a42..ec82d58da3 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/TrendsSuggestionsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/TrendsSuggestionsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.database.Cursor;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserBlocksListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserBlocksListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserBlocksListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserBlocksListFragment.java
index acec463bbf..50176dc0a8 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserBlocksListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserBlocksListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFavoritesFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFavoritesFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFavoritesFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserFavoritesFragment.java
index d5e3e92fb0..3495d918f9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFavoritesFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFavoritesFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFollowersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFollowersFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFollowersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserFollowersFragment.java
index 56f425ab3a..667bb7de48 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFollowersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFollowersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserFragment.java
index b26a135480..898cff982a 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.animation.ArgbEvaluator;
 import android.annotation.TargetApi;
@@ -89,9 +89,9 @@
 import org.mariotaku.sqliteqb.library.Expression;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.AccountSelectorActivity;
+import org.mariotaku.twidere.activity.BaseActivity;
 import org.mariotaku.twidere.activity.ColorPickerDialogActivity;
 import org.mariotaku.twidere.activity.LinkHandlerActivity;
-import org.mariotaku.twidere.activity.ThemedAppCompatActivity;
 import org.mariotaku.twidere.activity.UserListSelectorActivity;
 import org.mariotaku.twidere.activity.iface.IThemedActivity;
 import org.mariotaku.twidere.adapter.SupportTabsAdapter;
@@ -1508,7 +1508,7 @@ private void setUiColor(int color) {
         if (mActionBarBackground == null) {
             setupBaseActionBar();
         }
-        final ThemedAppCompatActivity activity = (ThemedAppCompatActivity) getActivity();
+        final BaseActivity activity = (BaseActivity) getActivity();
         if (Config.coloredActionBar(activity, activity.getATEKey())) {
             mPrimaryColor = color;
             mPrimaryColorDark = ATEUtil.darkenColor(color);
@@ -1620,7 +1620,7 @@ private void updateScrollOffset(int offset) {
         profileBannerView.setTranslationY(offset / 2);
         profileBirthdayBannerView.setTranslationY(offset / 2);
 
-        final ThemedAppCompatActivity activity = (ThemedAppCompatActivity) getActivity();
+        final BaseActivity activity = (BaseActivity) getActivity();
 
 
         final int statusBarColor = (int) sArgbEvaluator.evaluate(factor, ATEUtil.darkenColor(0xA0000000),
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFriendsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFriendsFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFriendsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserFriendsFragment.java
index fb49594fe4..1865bda230 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserFriendsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserFriendsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserGroupsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserGroupsFragment.java
similarity index 94%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserGroupsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserGroupsFragment.java
index 2107d0d029..3444c5c17f 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserGroupsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserGroupsFragment.java
@@ -1,4 +1,4 @@
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListFragment.java
index 1a52061c2c..96368d5ea9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.app.Activity;
 import android.app.Dialog;
@@ -420,7 +420,6 @@ private void setupUserPages() {
         mPagerAdapter.addTab(UserListSubscribersFragment.class, tabArgs, getString(R.string.subscribers), null, 2, null);
 
         final FragmentActivity activity = getActivity();
-        ThemeUtils.initPagerIndicatorAsActionBarTab(activity, mPagerIndicator, mPagerOverlay);
         ThemeUtils.setCompatToolbarOverlay(activity, new EmptyDrawable());
         ThemeUtils.setWindowOverlayViewOverlay(activity, new EmptyDrawable());
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembersFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembersFragment.java
index fbda54a2d7..163eacdd23 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.BroadcastReceiver;
 import android.content.Context;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembershipsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembershipsFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembershipsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembershipsFragment.java
index 6b31ae5a56..c6e6bbc3eb 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListMembershipsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListMembershipsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListSubscribersFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListSubscribersFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListSubscribersFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListSubscribersFragment.java
index ddd87730a6..1d558df586 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListSubscribersFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListSubscribersFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListTimelineFragment.java
index eafb7f3b70..911526feac 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListTimelineFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListsFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserListsFragment.java
index c3c5ff26f9..13932251b4 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserListsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserListsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMediaTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserMediaTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMediaTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserMediaTimelineFragment.java
index 2a225bf17e..07ee4420ac 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMediaTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserMediaTimelineFragment.java
@@ -1,4 +1,4 @@
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
@@ -17,6 +17,7 @@
 import org.mariotaku.twidere.adapter.StaggeredGridParcelableStatusesAdapter;
 import org.mariotaku.twidere.adapter.iface.ILoadMoreSupportAdapter.IndicatorPosition;
 import org.mariotaku.twidere.adapter.iface.IStatusesAdapter;
+import org.mariotaku.twidere.fragment.AbsContentRecyclerViewFragment;
 import org.mariotaku.twidere.loader.MediaTimelineLoader;
 import org.mariotaku.twidere.loader.iface.IExtendedLoader;
 import org.mariotaku.twidere.model.ParcelableMedia;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMentionsFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserMentionsFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMentionsFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserMentionsFragment.java
index 2805240677..aa56d054a3 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserMentionsFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserMentionsFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserProfileEditorFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserProfileEditorFragment.java
index 230a500537..743196f70d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserProfileEditorFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserProfileEditorFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.content.Intent;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserTimelineFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserTimelineFragment.java
similarity index 98%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserTimelineFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UserTimelineFragment.java
index c3f82e205d..87dc1c2be1 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UserTimelineFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UserTimelineFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UsersListFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/UsersListFragment.java
similarity index 97%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/UsersListFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/UsersListFragment.java
index 6658eff88c..6fd5cabd86 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/UsersListFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/UsersListFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support;
+package org.mariotaku.twidere.fragment;
 
 import android.content.Context;
 import android.os.Bundle;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardBrowserFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardBrowserFragment.java
similarity index 93%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardBrowserFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardBrowserFragment.java
index 87d52066f7..eb12e9b2a0 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardBrowserFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardBrowserFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support.card;
+package org.mariotaku.twidere.fragment.card;
 
 import android.os.Bundle;
 import android.support.annotation.NonNull;
@@ -25,7 +25,7 @@
 import android.webkit.WebSettings;
 import android.webkit.WebView;
 
-import org.mariotaku.twidere.fragment.support.SupportBrowserFragment;
+import org.mariotaku.twidere.fragment.SupportBrowserFragment;
 
 /**
  * Created by mariotaku on 15/1/6.
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardPollFragment.java
similarity index 99%
rename from twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java
rename to twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardPollFragment.java
index c1479cfcc9..812d1439b4 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/card/CardPollFragment.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/fragment/card/CardPollFragment.java
@@ -17,7 +17,7 @@
  *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  */
 
-package org.mariotaku.twidere.fragment.support.card;
+package org.mariotaku.twidere.fragment.card;
 
 import android.content.Context;
 import android.graphics.Canvas;
@@ -50,7 +50,7 @@
 import org.mariotaku.twidere.api.twitter.TwitterException;
 import org.mariotaku.twidere.api.twitter.model.CardDataMap;
 import org.mariotaku.twidere.api.twitter.model.CardEntity;
-import org.mariotaku.twidere.fragment.support.BaseSupportFragment;
+import org.mariotaku.twidere.fragment.BaseSupportFragment;
 import org.mariotaku.twidere.model.ParcelableCardEntity;
 import org.mariotaku.twidere.model.ParcelableStatus;
 import org.mariotaku.twidere.model.UserKey;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ViewStatusDialogFragment.java b/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ViewStatusDialogFragment.java
deleted file mode 100644
index 053e027910..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/fragment/support/ViewStatusDialogFragment.java
+++ /dev/null
@@ -1,86 +0,0 @@
-/*
- * Twidere - Twitter client for Android
- *
- *  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
- *
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.fragment.support;
-
-import android.os.Bundle;
-import android.support.annotation.Nullable;
-import android.support.v4.app.FragmentActivity;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
-
-import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.adapter.DummyStatusHolderAdapter;
-import org.mariotaku.twidere.model.ParcelableStatus;
-import org.mariotaku.twidere.view.holder.StatusViewHolder;
-import org.mariotaku.twidere.view.holder.iface.IStatusViewHolder;
-
-/**
- * Created by mariotaku on 15/3/17.
- */
-public class ViewStatusDialogFragment extends BaseSupportDialogFragment {
-
-    private DummyStatusHolderAdapter mAdapter;
-    private IStatusViewHolder mHolder;
-    private View mStatusContainer;
-
-    public ViewStatusDialogFragment() {
-        setStyle(STYLE_NO_TITLE, 0);
-    }
-
-    @Override
-    public View onCreateView(final LayoutInflater inflater, final ViewGroup parent, final Bundle savedInstanceState) {
-        if (getShowsDialog()) {
-            return inflater.inflate(R.layout.dialog_scrollable_status, parent, false);
-        }
-        return inflater.inflate(R.layout.fragment_scrollable_status, parent, false);
-    }
-
-    @Override
-    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
-        super.onViewCreated(view, savedInstanceState);
-        mStatusContainer = view.findViewById(R.id.status_container);
-    }
-
-    @Override
-    public void onActivityCreated(final Bundle savedInstanceState) {
-        super.onActivityCreated(savedInstanceState);
-        final Bundle args = getArguments();
-        if (args == null || args.getParcelable(EXTRA_STATUS) == null) {
-            dismiss();
-            return;
-        }
-        final View view = getView();
-        assert view != null;
-        final FragmentActivity activity = getActivity();
-        mAdapter = new DummyStatusHolderAdapter(activity);
-        mHolder = new StatusViewHolder(mAdapter, getView());
-        final ParcelableStatus status = args.getParcelable(EXTRA_STATUS);
-        assert status != null;
-        if (args.containsKey(EXTRA_SHOW_MEDIA_PREVIEW)) {
-            mAdapter.setMediaPreviewEnabled(args.getBoolean(EXTRA_SHOW_MEDIA_PREVIEW));
-        }
-        mHolder.displayStatus(status, false, true);
-        mStatusContainer.findViewById(R.id.item_menu).setVisibility(View.GONE);
-        mStatusContainer.findViewById(R.id.action_buttons).setVisibility(View.GONE);
-    }
-
-
-}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/graphic/ActionIconDrawable.java b/twidere/src/main/java/org/mariotaku/twidere/graphic/ActionIconDrawable.java
index 3583a55fc1..955ad4e886 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/graphic/ActionIconDrawable.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/graphic/ActionIconDrawable.java
@@ -22,6 +22,7 @@
 import android.graphics.PorterDuff.Mode;
 import android.graphics.drawable.Drawable;
 import android.support.v7.graphics.drawable.DrawableWrapper;
+import android.support.v7.widget.android.support.v7.view.menu.TwidereActionMenuItemView;
 import android.view.MenuItem;
 
 import org.mariotaku.twidere.util.menu.TwidereMenuInfo;
@@ -29,7 +30,7 @@
 /**
  * Created by mariotaku on 15/1/16.
  */
-public class ActionIconDrawable extends DrawableWrapper {
+public class ActionIconDrawable extends DrawableWrapper implements TwidereActionMenuItemView.IgnoreTinting {
 
     private int mDefaultColor;
     private int mHighlightColor;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/graphic/like/LikeAnimationDrawable.java b/twidere/src/main/java/org/mariotaku/twidere/graphic/like/LikeAnimationDrawable.java
index 129a9cbd6d..698903b5b1 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/graphic/like/LikeAnimationDrawable.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/graphic/like/LikeAnimationDrawable.java
@@ -14,6 +14,7 @@
 import android.support.annotation.ColorInt;
 import android.support.annotation.IntDef;
 import android.support.annotation.NonNull;
+import android.support.v7.widget.android.support.v7.view.menu.TwidereActionMenuItemView;
 import android.util.Property;
 import android.view.animation.AccelerateInterpolator;
 import android.view.animation.DecelerateInterpolator;
@@ -32,7 +33,8 @@
 /**
  * Created by mariotaku on 15/11/4.
  */
-public class LikeAnimationDrawable extends Drawable implements Animatable, Drawable.Callback, DoNotWrapDrawable {
+public class LikeAnimationDrawable extends Drawable implements Animatable, Drawable.Callback,
+        DoNotWrapDrawable, TwidereActionMenuItemView.IgnoreTinting {
 
     @NonNull
     private LikeAnimationState mState;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/receiver/SecretCodeBroadcastReceiver.java b/twidere/src/main/java/org/mariotaku/twidere/receiver/SecretCodeBroadcastReceiver.java
index 3445807a90..01cda89b32 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/receiver/SecretCodeBroadcastReceiver.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/receiver/SecretCodeBroadcastReceiver.java
@@ -22,27 +22,15 @@
 import android.content.BroadcastReceiver;
 import android.content.Context;
 import android.content.Intent;
-import android.os.Bundle;
-import android.preference.PreferenceActivity;
 
-import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.SettingsActivity;
+import org.mariotaku.twidere.activity.HiddenSettingsActivity;
 import org.mariotaku.twidere.constant.IntentConstants;
-import org.mariotaku.twidere.fragment.SettingsDetailsFragment;
 
 public class SecretCodeBroadcastReceiver extends BroadcastReceiver implements IntentConstants {
 
     @Override
     public void onReceive(final Context context, final Intent intent) {
-        final Intent testIntent = new Intent(context, SettingsActivity.class);
-        final String cls = SettingsDetailsFragment.class.getName();
-        final Bundle args = new Bundle();
-        args.putInt(EXTRA_RESID, R.xml.preferences_hidden);
-        args.putString(EXTRA_SETTINGS_INTENT_ACTION, INTENT_ACTION_HIDDEN_SETTINGS_ENTRY);
-        testIntent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT, cls);
-        testIntent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT_ARGUMENTS, args);
-        testIntent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT_TITLE, R.string.hidden_settings);
-        testIntent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT_SHORT_TITLE, R.string.hidden_settings);
+        final Intent testIntent = new Intent(context, HiddenSettingsActivity.class);
         testIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
         context.startActivity(testIntent);
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/task/ProgressSaveFileTask.java b/twidere/src/main/java/org/mariotaku/twidere/task/ProgressSaveFileTask.java
index a6cca30b3d..b81ddf88b9 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/task/ProgressSaveFileTask.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/task/ProgressSaveFileTask.java
@@ -26,7 +26,7 @@
 import android.support.v4.app.FragmentManager;
 
 import org.mariotaku.twidere.activity.iface.IExtendedActivity;
-import org.mariotaku.twidere.fragment.support.SupportProgressDialogFragment;
+import org.mariotaku.twidere.fragment.SupportProgressDialogFragment;
 
 import java.io.File;
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/AsyncTwitterWrapper.java b/twidere/src/main/java/org/mariotaku/twidere/util/AsyncTwitterWrapper.java
index c516f5ac5c..7a8d02feff 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/AsyncTwitterWrapper.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/AsyncTwitterWrapper.java
@@ -30,7 +30,6 @@
 import android.support.annotation.Nullable;
 import android.support.v4.util.SimpleArrayMap;
 import android.util.Log;
-import android.util.Pair;
 
 import com.squareup.otto.Bus;
 
@@ -108,7 +107,6 @@
 import org.mariotaku.twidere.task.ReportSpamAndBlockTask;
 import org.mariotaku.twidere.task.twitter.GetActivitiesTask;
 import org.mariotaku.twidere.task.util.TaskStarter;
-import org.mariotaku.twidere.util.collection.CompactHashSet;
 
 import java.io.FileNotFoundException;
 import java.util.ArrayList;
@@ -128,10 +126,10 @@ public class AsyncTwitterWrapper extends TwitterWrapper {
     private final SharedPreferencesWrapper mPreferences;
     private final Bus mBus;
 
-    private Set<Pair<UserKey, String>> mCreatingFavoriteIds = new CompactHashSet<>();
-    private Set<Pair<UserKey, String>> mDestroyingFavoriteIds = new CompactHashSet<>();
-    private Set<Pair<UserKey, String>> mCreatingRetweetIds = new CompactHashSet<>();
-    private Set<Pair<UserKey, String>> mDestroyingStatusIds = new CompactHashSet<>();
+    private IntList mCreatingFavoriteIds = new ArrayIntList();
+    private IntList mDestroyingFavoriteIds = new ArrayIntList();
+    private IntList mCreatingRetweetIds = new ArrayIntList();
+    private IntList mDestroyingStatusIds = new ArrayIntList();
     private IntList mUpdatingRelationshipIds = new ArrayIntList();
 
     private final LongList mSendingDraftIds = new ArrayLongList();
@@ -333,20 +331,24 @@ public long[] getSendingDraftIds() {
         return mSendingDraftIds.toArray();
     }
 
-    public boolean isCreatingFavorite(final UserKey accountId, final String statusId) {
-        return mCreatingFavoriteIds.contains(Pair.create(accountId, statusId));
+    public boolean isCreatingFavorite(@Nullable final UserKey accountId, @Nullable final String statusId) {
+        return mCreatingFavoriteIds.contains(calculateHashCode(accountId, statusId));
     }
 
-    public boolean isCreatingRetweet(final UserKey accountKey, final String statusId) {
-        return mCreatingRetweetIds.contains(Pair.create(accountKey, statusId));
+    public boolean isCreatingRetweet(@Nullable final UserKey accountKey, @Nullable final String statusId) {
+        return mCreatingRetweetIds.contains(calculateHashCode(accountKey, statusId));
     }
 
-    public boolean isDestroyingFavorite(final UserKey accountKey, final String statusId) {
-        return mDestroyingFavoriteIds.contains(Pair.create(accountKey, statusId));
+    public boolean isDestroyingFavorite(@Nullable final UserKey accountKey, @Nullable final String statusId) {
+        return mDestroyingFavoriteIds.contains(calculateHashCode(accountKey, statusId));
     }
 
-    public boolean isDestroyingStatus(final UserKey accountId, final String statusId) {
-        return mDestroyingStatusIds.contains(Pair.create(accountId, statusId));
+    public boolean isDestroyingStatus(@Nullable final UserKey accountId, @Nullable final String statusId) {
+        return mDestroyingStatusIds.contains(calculateHashCode(accountId, statusId));
+    }
+
+    static int calculateHashCode(@Nullable final UserKey accountId, @Nullable final String statusId) {
+        return (accountId == null ? 0 : accountId.hashCode()) ^ (statusId == null ? 0 : statusId.hashCode());
     }
 
     public boolean isHomeTimelineRefreshing() {
@@ -749,13 +751,16 @@ protected SingleResponse<ParcelableStatus> doInBackground(final Object... params
         @Override
         protected void onPreExecute() {
             super.onPreExecute();
-            mCreatingFavoriteIds.add(Pair.create(mAccountKey, mStatusId));
+            final int hashCode = calculateHashCode(mAccountKey, mStatusId);
+            if (!mCreatingFavoriteIds.contains(hashCode)) {
+                mCreatingFavoriteIds.add(hashCode);
+            }
             bus.post(new StatusListChangedEvent());
         }
 
         @Override
         protected void onPostExecute(final SingleResponse<ParcelableStatus> result) {
-            mCreatingFavoriteIds.remove(Pair.create(mAccountKey, mStatusId));
+            mCreatingFavoriteIds.removeElement(calculateHashCode(mAccountKey, mStatusId));
             final FavoriteTaskEvent taskEvent = new FavoriteTaskEvent(FavoriteTaskEvent.Action.CREATE,
                     mAccountKey, mStatusId);
             taskEvent.setFinished(true);
@@ -1202,13 +1207,16 @@ protected SingleResponse<ParcelableStatus> doInBackground(final Object... params
         @Override
         protected void onPreExecute() {
             super.onPreExecute();
-            mDestroyingFavoriteIds.add(Pair.create(mAccountKey, mStatusId));
+            final int hashCode = calculateHashCode(mAccountKey, mStatusId);
+            if (!mDestroyingFavoriteIds.contains(hashCode)) {
+                mDestroyingFavoriteIds.add(hashCode);
+            }
             bus.post(new StatusListChangedEvent());
         }
 
         @Override
         protected void onPostExecute(final SingleResponse<ParcelableStatus> result) {
-            mDestroyingFavoriteIds.remove(Pair.create(mAccountKey, mStatusId));
+            mDestroyingFavoriteIds.removeElement(calculateHashCode(mAccountKey, mStatusId));
             final FavoriteTaskEvent taskEvent = new FavoriteTaskEvent(FavoriteTaskEvent.Action.DESTROY,
                     mAccountKey, mStatusId);
             taskEvent.setFinished(true);
@@ -1309,13 +1317,16 @@ protected SingleResponse<ParcelableStatus> doInBackground(final Object... params
         @Override
         protected void onPreExecute() {
             super.onPreExecute();
-            mDestroyingStatusIds.add(Pair.create(mAccountKey, mStatusId));
+            final int hashCode = calculateHashCode(mAccountKey, mStatusId);
+            if (!mDestroyingStatusIds.contains(hashCode)) {
+                mDestroyingStatusIds.add(hashCode);
+            }
             bus.post(new StatusListChangedEvent());
         }
 
         @Override
         protected void onPostExecute(final SingleResponse<ParcelableStatus> result) {
-            mDestroyingStatusIds.remove(Pair.create(mAccountKey, mStatusId));
+            mDestroyingStatusIds.removeElement(calculateHashCode(mAccountKey, mStatusId));
             if (result.hasData()) {
                 final ParcelableStatus status = result.getData();
                 if (status.retweet_id != null) {
@@ -1533,13 +1544,16 @@ protected SingleResponse<ParcelableStatus> doInBackground(final Object... params
         @Override
         protected void onPreExecute() {
             super.onPreExecute();
-            mCreatingRetweetIds.add(Pair.create(mAccountKey, mStatusId));
+            final int hashCode = calculateHashCode(mAccountKey, mStatusId);
+            if (!mCreatingRetweetIds.contains(hashCode)) {
+                mCreatingRetweetIds.add(hashCode);
+            }
             bus.post(new StatusListChangedEvent());
         }
 
         @Override
         protected void onPostExecute(final SingleResponse<ParcelableStatus> result) {
-            mCreatingRetweetIds.remove(Pair.create(mAccountKey, mStatusId));
+            mCreatingRetweetIds.removeElement(calculateHashCode(mAccountKey, mStatusId));
             if (result.hasData()) {
                 final ParcelableStatus status = result.getData();
                 // BEGIN HotMobi
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/CustomTabUtils.java b/twidere/src/main/java/org/mariotaku/twidere/util/CustomTabUtils.java
index 51477e485c..cc3480a01d 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/CustomTabUtils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/CustomTabUtils.java
@@ -39,16 +39,16 @@
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.annotation.CustomTabType;
 import org.mariotaku.twidere.annotation.ReadPositionTag;
-import org.mariotaku.twidere.fragment.support.DirectMessagesFragment;
-import org.mariotaku.twidere.fragment.support.HomeTimelineFragment;
-import org.mariotaku.twidere.fragment.support.InteractionsTimelineFragment;
-import org.mariotaku.twidere.fragment.support.InvalidTabFragment;
-import org.mariotaku.twidere.fragment.support.RetweetsOfMeFragment;
-import org.mariotaku.twidere.fragment.support.StatusesSearchFragment;
-import org.mariotaku.twidere.fragment.support.TrendsSuggestionsFragment;
-import org.mariotaku.twidere.fragment.support.UserFavoritesFragment;
-import org.mariotaku.twidere.fragment.support.UserListTimelineFragment;
-import org.mariotaku.twidere.fragment.support.UserTimelineFragment;
+import org.mariotaku.twidere.fragment.DirectMessagesFragment;
+import org.mariotaku.twidere.fragment.HomeTimelineFragment;
+import org.mariotaku.twidere.fragment.InteractionsTimelineFragment;
+import org.mariotaku.twidere.fragment.InvalidTabFragment;
+import org.mariotaku.twidere.fragment.RetweetsOfMeFragment;
+import org.mariotaku.twidere.fragment.StatusesSearchFragment;
+import org.mariotaku.twidere.fragment.TrendsSuggestionsFragment;
+import org.mariotaku.twidere.fragment.UserFavoritesFragment;
+import org.mariotaku.twidere.fragment.UserListTimelineFragment;
+import org.mariotaku.twidere.fragment.UserTimelineFragment;
 import org.mariotaku.twidere.model.CustomTabConfiguration;
 import org.mariotaku.twidere.model.CustomTabConfiguration.ExtraConfiguration;
 import org.mariotaku.twidere.model.SupportTabSpec;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/DirectMessageOnLinkClickHandler.java b/twidere/src/main/java/org/mariotaku/twidere/util/DirectMessageOnLinkClickHandler.java
index a89302ed12..867dc78d48 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/DirectMessageOnLinkClickHandler.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/DirectMessageOnLinkClickHandler.java
@@ -27,7 +27,7 @@
 import android.support.v4.app.FragmentActivity;
 import android.support.v4.app.FragmentManager;
 
-import org.mariotaku.twidere.fragment.support.PhishingLinkWarningDialogFragment;
+import org.mariotaku.twidere.fragment.PhishingLinkWarningDialogFragment;
 
 public class DirectMessageOnLinkClickHandler extends OnLinkClickHandler {
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/IntentUtils.java b/twidere/src/main/java/org/mariotaku/twidere/util/IntentUtils.java
index 10cea42f2c..57c7bb82fd 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/IntentUtils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/IntentUtils.java
@@ -22,8 +22,8 @@
 import org.mariotaku.twidere.TwidereConstants;
 import org.mariotaku.twidere.activity.MediaViewerActivity;
 import org.mariotaku.twidere.constant.SharedPreferenceConstants;
-import org.mariotaku.twidere.fragment.support.SensitiveContentWarningDialogFragment;
-import org.mariotaku.twidere.fragment.support.UserFragment;
+import org.mariotaku.twidere.fragment.SensitiveContentWarningDialogFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
 import org.mariotaku.twidere.model.ParcelableDirectMessage;
 import org.mariotaku.twidere.model.ParcelableMedia;
 import org.mariotaku.twidere.model.ParcelableStatus;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/MenuUtils.java b/twidere/src/main/java/org/mariotaku/twidere/util/MenuUtils.java
index 0981097114..eac1fa04f4 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/MenuUtils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/MenuUtils.java
@@ -49,10 +49,10 @@
 import org.mariotaku.twidere.activity.ColorPickerDialogActivity;
 import org.mariotaku.twidere.constant.IntentConstants;
 import org.mariotaku.twidere.constant.SharedPreferenceConstants;
-import org.mariotaku.twidere.fragment.support.AbsStatusesFragment;
-import org.mariotaku.twidere.fragment.support.AddStatusFilterDialogFragment;
-import org.mariotaku.twidere.fragment.support.DestroyStatusDialogFragment;
-import org.mariotaku.twidere.fragment.support.SetUserNicknameDialogFragment;
+import org.mariotaku.twidere.fragment.AbsStatusesFragment;
+import org.mariotaku.twidere.fragment.AddStatusFilterDialogFragment;
+import org.mariotaku.twidere.fragment.DestroyStatusDialogFragment;
+import org.mariotaku.twidere.fragment.SetUserNicknameDialogFragment;
 import org.mariotaku.twidere.graphic.ActionIconDrawable;
 import org.mariotaku.twidere.graphic.PaddingDrawable;
 import org.mariotaku.twidere.menu.SupportStatusShareProvider;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/MultiSelectEventHandler.java b/twidere/src/main/java/org/mariotaku/twidere/util/MultiSelectEventHandler.java
index f38137d9fb..0c2a449a69 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/MultiSelectEventHandler.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/MultiSelectEventHandler.java
@@ -33,7 +33,7 @@
 
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
-import org.mariotaku.twidere.activity.BaseAppCompatActivity;
+import org.mariotaku.twidere.activity.BaseActivity;
 import org.mariotaku.twidere.menu.AccountActionProvider;
 import org.mariotaku.twidere.model.ParcelableAccount;
 import org.mariotaku.twidere.model.ParcelableStatus;
@@ -64,13 +64,13 @@ public class MultiSelectEventHandler implements Constants, ActionMode.Callback,
 
     private ActionMode mActionMode;
 
-    private final BaseAppCompatActivity mActivity;
+    private final BaseActivity mActivity;
 
     private AccountActionProvider mAccountActionProvider;
 
     public static final int MENU_GROUP = 201;
 
-    public MultiSelectEventHandler(final BaseAppCompatActivity activity) {
+    public MultiSelectEventHandler(final BaseActivity activity) {
         GeneralComponentHelper.build(activity).inject(this);
         mActivity = activity;
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/OnLinkClickHandler.java b/twidere/src/main/java/org/mariotaku/twidere/util/OnLinkClickHandler.java
index e52e9f42be..a70c331e1a 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/OnLinkClickHandler.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/OnLinkClickHandler.java
@@ -28,7 +28,7 @@
 
 import org.apache.commons.lang3.StringUtils;
 import org.mariotaku.twidere.Constants;
-import org.mariotaku.twidere.fragment.support.UserFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
 import org.mariotaku.twidere.model.ParcelableMedia;
 import org.mariotaku.twidere.model.UserKey;
 import org.mariotaku.twidere.model.util.ParcelableMediaUtils;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/ThemeUtils.java b/twidere/src/main/java/org/mariotaku/twidere/util/ThemeUtils.java
index 4ba7d6e8cc..da1af9945f 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/ThemeUtils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/ThemeUtils.java
@@ -31,11 +31,10 @@
 import android.graphics.drawable.ColorDrawable;
 import android.graphics.drawable.Drawable;
 import android.os.Build;
+import android.support.annotation.ColorInt;
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
-import android.support.v4.app.FragmentActivity;
 import android.support.v4.content.ContextCompat;
-import android.support.v4.view.ViewCompat;
 import android.support.v7.app.AppCompatDelegate;
 import android.support.v7.view.menu.ActionMenuItemView;
 import android.support.v7.widget.ActionBarOverlayLayout;
@@ -61,13 +60,11 @@
 import org.mariotaku.twidere.Constants;
 import org.mariotaku.twidere.R;
 import org.mariotaku.twidere.activity.iface.IThemedActivity;
-import org.mariotaku.twidere.graphic.ActionBarColorDrawable;
 import org.mariotaku.twidere.graphic.ActionIconDrawable;
 import org.mariotaku.twidere.graphic.iface.DoNotWrapDrawable;
 import org.mariotaku.twidere.preference.ThemeBackgroundPreference;
 import org.mariotaku.twidere.util.menu.TwidereMenuInfo;
 import org.mariotaku.twidere.util.support.ViewSupport;
-import org.mariotaku.twidere.view.TabPagerIndicator;
 
 import java.lang.reflect.Field;
 
@@ -87,8 +84,9 @@ private ThemeUtils() {
     }
 
 
-    public static void applyColorFilterToMenuIcon(final Menu menu, final int color, final int popupColor,
-                                                  final int highlightColor, final Mode mode,
+    public static void applyColorFilterToMenuIcon(final Menu menu, @ColorInt final int color,
+                                                  @ColorInt final int popupColor,
+                                                  @ColorInt final int highlightColor, final Mode mode,
                                                   final int... excludedGroups) {
         for (int i = 0, j = menu.size(); i < j; i++) {
             final MenuItem item = menu.getItem(i);
@@ -119,7 +117,7 @@ public static void applyWindowBackground(@NonNull Context context, @NonNull Wind
             window.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WALLPAPER);
             window.setBackgroundDrawable(getWindowBackgroundFromThemeApplyAlpha(context, alpha));
         } else if (VALUE_THEME_BACKGROUND_SOLID.equals(option)) {
-            window.setBackgroundDrawable(new ColorDrawable(isDarkTheme(context) ? Color.BLACK : Color.WHITE));
+            window.setBackgroundDrawable(new ColorDrawable(!isLightTheme(context) ? Color.BLACK : Color.WHITE));
         } else {
             window.setBackgroundDrawable(getWindowBackgroundFromTheme(context));
         }
@@ -130,34 +128,13 @@ public static void applyWindowBackground(Context context, View window, String op
         if (VALUE_THEME_BACKGROUND_TRANSPARENT.equals(option)) {
             ViewSupport.setBackground(window, getWindowBackgroundFromThemeApplyAlpha(context, alpha));
         } else if (VALUE_THEME_BACKGROUND_SOLID.equals(option)) {
-            ViewSupport.setBackground(window, new ColorDrawable(isDarkTheme(context) ? Color.BLACK : Color.WHITE));
+            ViewSupport.setBackground(window, new ColorDrawable(!isLightTheme(context) ? Color.BLACK : Color.WHITE));
         } else {
             ViewSupport.setBackground(window, getWindowBackgroundFromTheme(context));
         }
     }
 
 
-    @NonNull
-    public static Drawable getActionBarBackground(final Context context, final int accentColor,
-                                                  final String backgroundOption, final boolean outlineEnabled) {
-        final int actionBarColor;
-        if (!isDarkTheme(context)) {
-            actionBarColor = accentColor;
-        } else if (isSolidBackground(backgroundOption)) {
-            actionBarColor = Color.BLACK;
-        } else {
-            actionBarColor = context.getResources().getColor(R.color.background_color_action_bar_dark);
-        }
-        return ActionBarColorDrawable.create(actionBarColor, outlineEnabled);
-    }
-
-    @NonNull
-    public static Drawable getActionBarStackedBackground(final Context context,
-                                                         final int accentColor, String backgroundOption,
-                                                         boolean outlineEnabled) {
-        return getActionBarBackground(context, accentColor, backgroundOption, outlineEnabled);
-    }
-
     public static int getCardBackgroundColor(final Context context, String backgroundOption, int themeAlpha) {
         final TypedArray a = context.obtainStyledAttributes(new int[]{R.attr.cardItemBackgroundColor});
         final int color = a.getColor(0, Color.TRANSPARENT);
@@ -194,7 +171,7 @@ public static Drawable getCompatToolbarOverlay(Activity activity) {
     public static int getContrastForegroundColor(Context context, int color) {
         final int[] colors = new int[2];
         getDarkLightForegroundColors(context, colors);
-        if (isDarkTheme(context) || TwidereColorUtils.getYIQLuminance(color) <= ACCENT_COLOR_THRESHOLD) {
+        if (!isLightTheme(context) || TwidereColorUtils.getYIQLuminance(color) <= ACCENT_COLOR_THRESHOLD) {
             //return light text color
             return colors[1];
         }
@@ -285,25 +262,15 @@ public static int getTextColorPrimary(final Context context) {
     }
 
 
-    public static void getTextColorPrimaryAndInverse(final Context context, int[] colors) {
-        final TypedArray a = context.obtainStyledAttributes(ATTRS_TEXT_COLOR_PRIMARY_AND_INVERSE);
-        try {
-            colors[0] = a.getColor(0, Color.TRANSPARENT);
-            colors[1] = a.getColor(1, Color.TRANSPARENT);
-        } finally {
-            a.recycle();
-        }
-    }
-
     public static void getDarkLightForegroundColors(final Context context, int[] colors) {
         final TypedArray a = context.obtainStyledAttributes(ATTRS_COLOR_FOREGROUND_AND_INVERSE);
         try {
-            if (isDarkTheme(context)) {
-                colors[0] = a.getColor(1, Color.WHITE);
-                colors[1] = a.getColor(0, Color.BLACK);
-            } else {
+            if (isLightTheme(context)) {
                 colors[0] = a.getColor(0, Color.WHITE);
                 colors[1] = a.getColor(1, Color.BLACK);
+            } else {
+                colors[0] = a.getColor(1, Color.WHITE);
+                colors[1] = a.getColor(0, Color.BLACK);
             }
         } finally {
             a.recycle();
@@ -407,7 +374,7 @@ public static int getOptimalAccentColor(final Context context, boolean isActionB
 
     public static int getOptimalAccentColor(final Context context, final int accentColor, boolean isActionBarContext) {
         final int backgroundColorApprox;
-        final boolean isDarkTheme = isDarkTheme(context);
+        final boolean isDarkTheme = !isLightTheme(context);
         if (!isActionBarContext) {
             backgroundColorApprox = isDarkTheme ? Color.BLACK : Color.WHITE;
         } else if (isDarkTheme) {
@@ -484,52 +451,8 @@ public static Drawable getNormalWindowContentOverlay(final Context context) {
         return getWindowContentOverlay(context);
     }
 
-    public static void initPagerIndicatorAsActionBarTab(FragmentActivity activity, TabPagerIndicator indicator, @Nullable View pagerOverlay) {
-        final float supportActionBarElevation = getSupportActionBarElevation(activity);
-        ViewCompat.setElevation(indicator, supportActionBarElevation);
-        if (!(activity instanceof IThemedActivity)) return;
-        final int themeColor = ((IThemedActivity) activity).getCurrentThemeColor();
-        final String backgroundOption = ((IThemedActivity) activity).getCurrentThemeBackgroundOption();
-        final int colorDark, colorLight;
-        final int[] textColors = new int[2];
-        getTextColorPrimaryAndInverse(activity, textColors);
-        if (isDarkTheme(activity)) {
-            colorDark = textColors[1];
-            colorLight = textColors[0];
-        } else {
-            colorDark = textColors[0];
-            colorLight = textColors[1];
-        }
-        final int contrastColor = TwidereColorUtils.getContrastYIQ(themeColor, ACCENT_COLOR_THRESHOLD,
-                colorDark, colorLight);
-        ViewSupport.setBackground(indicator, getActionBarStackedBackground(activity, themeColor, backgroundOption, true));
-        if (isDarkTheme(activity)) {
-            final int foregroundColor = getThemeForegroundColor(activity);
-            indicator.setIconColor(foregroundColor);
-            indicator.setLabelColor(foregroundColor);
-            indicator.setStripColor(themeColor);
-        } else {
-            indicator.setIconColor(contrastColor);
-            indicator.setLabelColor(contrastColor);
-            indicator.setStripColor(contrastColor);
-        }
-        indicator.updateAppearance();
-        if (pagerOverlay != null) {
-            ViewSupport.setBackground(pagerOverlay, getNormalWindowContentOverlay(activity));
-        }
-    }
-
-    public static boolean isColoredActionBar(Context context) {
-        final TypedArray a = context.obtainStyledAttributes(new int[]{R.attr.coloredActionBar});
-        try {
-            return a.getBoolean(0, false);
-        } finally {
-            a.recycle();
-        }
-    }
-
-    public static boolean isDarkTheme(final Context context) {
-        final TypedArray a = context.obtainStyledAttributes(new int[]{R.attr.darkTheme});
+    public static boolean isLightTheme(final Context context) {
+        final TypedArray a = context.obtainStyledAttributes(new int[]{R.attr.isLightTheme});
         try {
             return a.getBoolean(0, false);
         } finally {
@@ -630,7 +553,7 @@ public static void setupDrawerBackground(Context context, View view) {
         final int alpha = ((IThemedActivity) context).getCurrentThemeBackgroundAlpha();
         final Drawable d;
         if (isSolidBackground(backgroundOption)) {
-            d = new ColorDrawable(isDarkTheme(context) ? Color.BLACK : Color.WHITE);
+            d = new ColorDrawable(!isLightTheme(context) ? Color.BLACK : Color.WHITE);
         } else {
             d = getWindowBackgroundFromTheme(context);
         }
@@ -775,7 +698,7 @@ public static Context getActionBarThemedContext(Context base) {
 
     public static Context getActionBarThemedContext(Context base, int accentColor) {
         final int actionBarThemeId;
-        if (isDarkTheme(base) || TwidereColorUtils.getYIQLuminance(accentColor) <= ACCENT_COLOR_THRESHOLD) {
+        if (!isLightTheme(base) || TwidereColorUtils.getYIQLuminance(accentColor) <= ACCENT_COLOR_THRESHOLD) {
             actionBarThemeId = R.style.Theme_Twidere;
         } else {
             actionBarThemeId = R.style.Theme_Twidere;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardFragmentFactory.java b/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardFragmentFactory.java
index 331bb88934..2184bee302 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardFragmentFactory.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardFragmentFactory.java
@@ -23,8 +23,8 @@
 import android.support.annotation.Nullable;
 import android.support.v4.app.Fragment;
 
-import org.mariotaku.twidere.fragment.support.card.CardBrowserFragment;
-import org.mariotaku.twidere.fragment.support.card.CardPollFragment;
+import org.mariotaku.twidere.fragment.card.CardBrowserFragment;
+import org.mariotaku.twidere.fragment.card.CardPollFragment;
 import org.mariotaku.twidere.model.ParcelableCardEntity;
 import org.mariotaku.twidere.model.ParcelableStatus;
 import org.mariotaku.twidere.model.util.ParcelableCardEntityUtils;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardUtils.java b/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardUtils.java
index fb3f3e003b..3dc076d75c 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardUtils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/TwitterCardUtils.java
@@ -25,7 +25,7 @@
 import android.text.TextUtils;
 
 import org.apache.commons.lang3.ArrayUtils;
-import org.mariotaku.twidere.fragment.support.card.CardPollFragment;
+import org.mariotaku.twidere.fragment.card.CardPollFragment;
 import org.mariotaku.twidere.model.ParcelableCardEntity;
 import org.mariotaku.twidere.model.ParcelableMedia;
 import org.mariotaku.twidere.model.ParcelableStatus;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/Utils.java b/twidere/src/main/java/org/mariotaku/twidere/util/Utils.java
index d9b9d19c03..ec14218d10 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/Utils.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/Utils.java
@@ -127,39 +127,39 @@
 import org.mariotaku.twidere.api.twitter.model.Relationship;
 import org.mariotaku.twidere.api.twitter.model.Status;
 import org.mariotaku.twidere.fragment.iface.IBaseFragment.SystemWindowsInsetsCallback;
-import org.mariotaku.twidere.fragment.support.AccountsManagerFragment;
-import org.mariotaku.twidere.fragment.support.DirectMessagesFragment;
-import org.mariotaku.twidere.fragment.support.DraftsFragment;
-import org.mariotaku.twidere.fragment.support.FiltersFragment;
-import org.mariotaku.twidere.fragment.support.IncomingFriendshipsFragment;
-import org.mariotaku.twidere.fragment.support.InteractionsTimelineFragment;
-import org.mariotaku.twidere.fragment.support.ListsFragment;
-import org.mariotaku.twidere.fragment.support.MessagesConversationFragment;
-import org.mariotaku.twidere.fragment.support.MutesUsersListFragment;
-import org.mariotaku.twidere.fragment.support.PublicTimelineFragment;
-import org.mariotaku.twidere.fragment.support.SavedSearchesListFragment;
-import org.mariotaku.twidere.fragment.support.ScheduledStatusesFragment;
-import org.mariotaku.twidere.fragment.support.SearchFragment;
-import org.mariotaku.twidere.fragment.support.StatusFavoritersListFragment;
-import org.mariotaku.twidere.fragment.support.StatusFragment;
-import org.mariotaku.twidere.fragment.support.StatusRetweetersListFragment;
-import org.mariotaku.twidere.fragment.support.StatusesListFragment;
-import org.mariotaku.twidere.fragment.support.UserBlocksListFragment;
-import org.mariotaku.twidere.fragment.support.UserFavoritesFragment;
-import org.mariotaku.twidere.fragment.support.UserFollowersFragment;
-import org.mariotaku.twidere.fragment.support.UserFragment;
-import org.mariotaku.twidere.fragment.support.UserFriendsFragment;
-import org.mariotaku.twidere.fragment.support.UserGroupsFragment;
-import org.mariotaku.twidere.fragment.support.UserListFragment;
-import org.mariotaku.twidere.fragment.support.UserListMembersFragment;
-import org.mariotaku.twidere.fragment.support.UserListMembershipsFragment;
-import org.mariotaku.twidere.fragment.support.UserListSubscribersFragment;
-import org.mariotaku.twidere.fragment.support.UserListTimelineFragment;
-import org.mariotaku.twidere.fragment.support.UserMediaTimelineFragment;
-import org.mariotaku.twidere.fragment.support.UserMentionsFragment;
-import org.mariotaku.twidere.fragment.support.UserProfileEditorFragment;
-import org.mariotaku.twidere.fragment.support.UserTimelineFragment;
-import org.mariotaku.twidere.fragment.support.UsersListFragment;
+import org.mariotaku.twidere.fragment.AccountsManagerFragment;
+import org.mariotaku.twidere.fragment.DirectMessagesFragment;
+import org.mariotaku.twidere.fragment.DraftsFragment;
+import org.mariotaku.twidere.fragment.FiltersFragment;
+import org.mariotaku.twidere.fragment.IncomingFriendshipsFragment;
+import org.mariotaku.twidere.fragment.InteractionsTimelineFragment;
+import org.mariotaku.twidere.fragment.ListsFragment;
+import org.mariotaku.twidere.fragment.MessagesConversationFragment;
+import org.mariotaku.twidere.fragment.MutesUsersListFragment;
+import org.mariotaku.twidere.fragment.PublicTimelineFragment;
+import org.mariotaku.twidere.fragment.SavedSearchesListFragment;
+import org.mariotaku.twidere.fragment.ScheduledStatusesFragment;
+import org.mariotaku.twidere.fragment.SearchFragment;
+import org.mariotaku.twidere.fragment.StatusFavoritersListFragment;
+import org.mariotaku.twidere.fragment.StatusFragment;
+import org.mariotaku.twidere.fragment.StatusRetweetersListFragment;
+import org.mariotaku.twidere.fragment.StatusesListFragment;
+import org.mariotaku.twidere.fragment.UserBlocksListFragment;
+import org.mariotaku.twidere.fragment.UserFavoritesFragment;
+import org.mariotaku.twidere.fragment.UserFollowersFragment;
+import org.mariotaku.twidere.fragment.UserFragment;
+import org.mariotaku.twidere.fragment.UserFriendsFragment;
+import org.mariotaku.twidere.fragment.UserGroupsFragment;
+import org.mariotaku.twidere.fragment.UserListFragment;
+import org.mariotaku.twidere.fragment.UserListMembersFragment;
+import org.mariotaku.twidere.fragment.UserListMembershipsFragment;
+import org.mariotaku.twidere.fragment.UserListSubscribersFragment;
+import org.mariotaku.twidere.fragment.UserListTimelineFragment;
+import org.mariotaku.twidere.fragment.UserMediaTimelineFragment;
+import org.mariotaku.twidere.fragment.UserMentionsFragment;
+import org.mariotaku.twidere.fragment.UserProfileEditorFragment;
+import org.mariotaku.twidere.fragment.UserTimelineFragment;
+import org.mariotaku.twidere.fragment.UsersListFragment;
 import org.mariotaku.twidere.graphic.PaddingDrawable;
 import org.mariotaku.twidere.model.AccountPreferences;
 import org.mariotaku.twidere.model.ParcelableAccount;
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/dagger/GeneralComponent.java b/twidere/src/main/java/org/mariotaku/twidere/util/dagger/GeneralComponent.java
index 6859694966..4635220e3e 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/dagger/GeneralComponent.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/dagger/GeneralComponent.java
@@ -21,9 +21,8 @@
 
 import android.support.v7.widget.RecyclerView;
 
-import org.mariotaku.twidere.activity.BaseAppCompatActivity;
+import org.mariotaku.twidere.activity.BaseActivity;
 import org.mariotaku.twidere.activity.ComposeActivity;
-import org.mariotaku.twidere.activity.ThemedFragmentActivity;
 import org.mariotaku.twidere.activity.MediaViewerActivity;
 import org.mariotaku.twidere.adapter.AccountsAdapter;
 import org.mariotaku.twidere.adapter.AccountsSpinnerAdapter;
@@ -35,11 +34,10 @@
 import org.mariotaku.twidere.adapter.UserAutoCompleteAdapter;
 import org.mariotaku.twidere.fragment.BaseListFragment;
 import org.mariotaku.twidere.fragment.BasePreferenceFragment;
-import org.mariotaku.twidere.fragment.support.AccountsDashboardFragment;
-import org.mariotaku.twidere.fragment.support.BaseFiltersFragment;
-import org.mariotaku.twidere.fragment.support.BaseSupportDialogFragment;
-import org.mariotaku.twidere.fragment.support.BaseSupportFragment;
-import org.mariotaku.twidere.fragment.support.MessagesConversationFragment;
+import org.mariotaku.twidere.fragment.BaseFiltersFragment;
+import org.mariotaku.twidere.fragment.BaseSupportDialogFragment;
+import org.mariotaku.twidere.fragment.BaseSupportFragment;
+import org.mariotaku.twidere.fragment.MessagesConversationFragment;
 import org.mariotaku.twidere.loader.TwitterAPIStatusesLoader;
 import org.mariotaku.twidere.preference.AccountsListPreference;
 import org.mariotaku.twidere.preference.KeyboardShortcutPreference;
@@ -77,15 +75,13 @@ public interface GeneralComponent {
 
     void inject(RefreshService object);
 
-    void inject(ThemedFragmentActivity object);
-
     void inject(ComposeActivity object);
 
     void inject(TwidereDataProvider object);
 
     void inject(BaseListFragment object);
 
-    void inject(BaseAppCompatActivity object);
+    void inject(BaseActivity object);
 
     void inject(BackgroundOperationService object);
 
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/menu/TwidereMenuInfo.java b/twidere/src/main/java/org/mariotaku/twidere/util/menu/TwidereMenuInfo.java
index 8d3177875d..e9f2af68e8 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/menu/TwidereMenuInfo.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/menu/TwidereMenuInfo.java
@@ -1,11 +1,13 @@
 package org.mariotaku.twidere.util.menu;
 
+import android.support.annotation.ColorInt;
 import android.view.ContextMenu.ContextMenuInfo;
 
 /**
  * Created by mariotaku on 14/10/27.
  */
 public class TwidereMenuInfo implements ContextMenuInfo {
+    @ColorInt
     private final int highlightColor;
     private final boolean isHighlight;
 
@@ -14,11 +16,12 @@ public TwidereMenuInfo(boolean isHighlight) {
         this(isHighlight, 0);
     }
 
-    public TwidereMenuInfo(boolean isHighlight, int highlightColor) {
+    public TwidereMenuInfo(boolean isHighlight, @ColorInt int highlightColor) {
         this.isHighlight = isHighlight;
         this.highlightColor = highlightColor;
     }
 
+    @ColorInt
     public int getHighlightColor(int def) {
         return highlightColor != 0 ? highlightColor : def;
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/theme/OptimalLinkColorTagProcessor.java b/twidere/src/main/java/org/mariotaku/twidere/util/theme/OptimalLinkColorTagProcessor.java
new file mode 100644
index 0000000000..a57cd9eac6
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/theme/OptimalLinkColorTagProcessor.java
@@ -0,0 +1,29 @@
+package org.mariotaku.twidere.util.theme;
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.view.View;
+import android.widget.TextView;
+
+import com.afollestad.appthemeengine.Config;
+import com.afollestad.appthemeengine.tagprocessors.TagProcessor;
+
+import org.mariotaku.twidere.util.ThemeUtils;
+
+/**
+ * Created by mariotaku on 16/3/18.
+ */
+public class OptimalLinkColorTagProcessor extends TagProcessor {
+    @Override
+    public boolean isTypeSupported(@NonNull View view) {
+        return view instanceof TextView;
+    }
+
+    @Override
+    public void process(@NonNull Context context, @Nullable String key, @NonNull View view, @NonNull String suffix) {
+        TextView tv = (TextView) view;
+        final int accentColor = Config.accentColor(context, key);
+        tv.setLinkTextColor(ThemeUtils.getOptimalAccentColor(accentColor, tv.getCurrentTextColor()));
+    }
+}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/theme/ProfileImageViewViewProcessor.java b/twidere/src/main/java/org/mariotaku/twidere/util/theme/ProfileImageViewViewProcessor.java
new file mode 100644
index 0000000000..df5d51f566
--- /dev/null
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/theme/ProfileImageViewViewProcessor.java
@@ -0,0 +1,28 @@
+package org.mariotaku.twidere.util.theme;
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+import com.afollestad.appthemeengine.viewprocessors.ViewProcessor;
+
+import org.mariotaku.twidere.view.ProfileImageView;
+import org.mariotaku.twidere.view.ShapedImageView;
+
+/**
+ * Created by mariotaku on 16/3/18.
+ */
+public class ProfileImageViewViewProcessor implements ViewProcessor<ProfileImageView, Object> {
+    @ShapedImageView.ShapeStyle
+    private int mStyle = ShapedImageView.SHAPE_CIRCLE;
+
+    @Override
+    public void process(@NonNull Context context, @Nullable String key, @Nullable ProfileImageView target, @Nullable Object extra) {
+        if (target == null) return;
+        target.setStyle(mStyle);
+    }
+
+    public void setStyle(@ShapedImageView.ShapeStyle int style) {
+        mStyle = style;
+    }
+}
diff --git a/twidere/src/main/java/org/mariotaku/twidere/util/theme/TimelineContentTextViewViewProcessor.java b/twidere/src/main/java/org/mariotaku/twidere/util/theme/TimelineContentTextViewViewProcessor.java
index f9f1fd6ea8..a9cc812c74 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/util/theme/TimelineContentTextViewViewProcessor.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/util/theme/TimelineContentTextViewViewProcessor.java
@@ -5,6 +5,7 @@
 import android.support.annotation.Nullable;
 
 import com.afollestad.appthemeengine.Config;
+import com.afollestad.appthemeengine.viewprocessors.DefaultProcessor;
 import com.afollestad.appthemeengine.viewprocessors.ViewProcessor;
 
 import org.mariotaku.twidere.util.ThemeUtils;
@@ -13,10 +14,13 @@
 /**
  * Created by mariotaku on 16/3/18.
  */
-public class TimelineContentTextViewViewProcessor implements ViewProcessor<TimelineContentTextView, Object> {
+public class TimelineContentTextViewViewProcessor implements ViewProcessor<TimelineContentTextView, Void> {
+    final DefaultProcessor defaultProcessor = new DefaultProcessor();
+
     @Override
-    public void process(@NonNull Context context, @Nullable String key, @Nullable TimelineContentTextView target, @Nullable Object extra) {
+    public void process(@NonNull Context context, @Nullable String key, @Nullable TimelineContentTextView target, @Nullable Void extra) {
         if (target == null) return;
+        defaultProcessor.process(context, key, target, extra);
         final int accentColor = Config.accentColor(context, key);
         target.setLinkTextColor(ThemeUtils.getOptimalAccentColor(accentColor, target.getCurrentTextColor()));
     }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/view/HeaderDrawerLayout.java b/twidere/src/main/java/org/mariotaku/twidere/view/HeaderDrawerLayout.java
index 48043ae7ed..067baf6fa8 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/view/HeaderDrawerLayout.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/view/HeaderDrawerLayout.java
@@ -116,18 +116,21 @@ protected void onLayout(boolean changed, int l, int t, int r, int b) {
         for (int i = 0, j = getChildCount(); i < j; i++) {
             final View child = getChildAt(i);
             final int left = getPaddingLeft(), right = left + child.getMeasuredWidth();
-            final int top;
+            final int top, bottom;
             if (i == 0) {
                 if (shouldLayoutHeaderBottomCallback() && child.getHeight() != 0) {
-                    final int heightDelta = child.getMeasuredHeight() - child.getHeight();
-                    top = mHeaderOffset + getPaddingTop() - heightDelta;
+                    // How far did we moved?
+                    int delta = mHeaderOffset + getPaddingTop() - child.getTop();
+                    bottom = child.getBottom() + delta;
+                    top = bottom - child.getHeight();
                 } else {
                     top = mHeaderOffset + getPaddingTop();
+                    bottom = top + child.getMeasuredHeight();
                 }
             } else {
                 top = getChildAt(i - 1).getBottom();
+                bottom = top + child.getMeasuredHeight();
             }
-            final int bottom = top + child.getMeasuredHeight();
             child.layout(left, top, right, bottom);
             notifyOffsetChanged();
         }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/view/ProfileImageView.java b/twidere/src/main/java/org/mariotaku/twidere/view/ProfileImageView.java
index c55306f7fa..ced0820707 100644
--- a/twidere/src/main/java/org/mariotaku/twidere/view/ProfileImageView.java
+++ b/twidere/src/main/java/org/mariotaku/twidere/view/ProfileImageView.java
@@ -21,14 +21,11 @@
 
 import android.content.Context;
 import android.util.AttributeSet;
-import android.view.ViewGroup;
-
-import com.makeramen.roundedimageview.RoundedImageView;
 
 /**
  * Created by mariotaku on 15/6/6.
  */
-public class ProfileImageView extends RoundedImageView {
+public class ProfileImageView extends ShapedImageView {
     public ProfileImageView(final Context context) {
         super(context);
     }
@@ -40,26 +37,4 @@ public ProfileImageView(final Context context, final AttributeSet attrs) {
     public ProfileImageView(final Context context, final AttributeSet attrs, final int defStyle) {
         super(context, attrs, defStyle);
     }
-
-    @Override
-    protected void onMeasure(final int widthMeasureSpec, final int heightMeasureSpec) {
-        final int width = MeasureSpec.getSize(widthMeasureSpec), height = MeasureSpec.getSize(heightMeasureSpec);
-        final ViewGroup.LayoutParams lp = getLayoutParams();
-        if (lp.height == ViewGroup.LayoutParams.MATCH_PARENT && lp.width == ViewGroup.LayoutParams.WRAP_CONTENT) {
-            super.onMeasure(heightMeasureSpec, heightMeasureSpec);
-            setMeasuredDimension(height, height);
-        } else if (lp.width == ViewGroup.LayoutParams.MATCH_PARENT && lp.height == ViewGroup.LayoutParams.WRAP_CONTENT) {
-            super.onMeasure(widthMeasureSpec, widthMeasureSpec);
-            setMeasuredDimension(width, width);
-        } else {
-            if (width > height) {
-                super.onMeasure(heightMeasureSpec, heightMeasureSpec);
-                setMeasuredDimension(height, height);
-            } else {
-                super.onMeasure(widthMeasureSpec, widthMeasureSpec);
-                setMeasuredDimension(width, width);
-            }
-        }
-    }
-
 }
diff --git a/twidere/src/main/java/org/mariotaku/twidere/view/SquareShapedImageView.java b/twidere/src/main/java/org/mariotaku/twidere/view/SquareShapedImageView.java
deleted file mode 100644
index c6d964a2db..0000000000
--- a/twidere/src/main/java/org/mariotaku/twidere/view/SquareShapedImageView.java
+++ /dev/null
@@ -1,61 +0,0 @@
-/*
- * Twidere - Twitter client for Android
- *
- *  Copyright (C) 2012-2015 Mariotaku Lee <mariotaku.lee@gmail.com>
- *
- *  This program is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 3 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
- */
-
-package org.mariotaku.twidere.view;
-
-import android.content.Context;
-import android.util.AttributeSet;
-import android.view.ViewGroup;
-
-public class SquareShapedImageView extends ShapedImageView {
-
-    public SquareShapedImageView(final Context context) {
-        this(context, null);
-    }
-
-    public SquareShapedImageView(final Context context, final AttributeSet attrs) {
-        this(context, attrs, 0);
-    }
-
-    public SquareShapedImageView(final Context context, final AttributeSet attrs, final int defStyle) {
-        super(context, attrs, defStyle);
-    }
-
-    @Override
-    protected void onMeasure(final int widthMeasureSpec, final int heightMeasureSpec) {
-        final int width = MeasureSpec.getSize(widthMeasureSpec), height = MeasureSpec.getSize(heightMeasureSpec);
-        final ViewGroup.LayoutParams lp = getLayoutParams();
-        if (lp.height == ViewGroup.LayoutParams.MATCH_PARENT && lp.width == ViewGroup.LayoutParams.WRAP_CONTENT) {
-            super.onMeasure(makeSpec(heightMeasureSpec, MeasureSpec.EXACTLY), makeSpec(heightMeasureSpec, MeasureSpec.EXACTLY));
-        } else if (lp.width == ViewGroup.LayoutParams.MATCH_PARENT && lp.height == ViewGroup.LayoutParams.WRAP_CONTENT) {
-            super.onMeasure(makeSpec(widthMeasureSpec, MeasureSpec.EXACTLY), makeSpec(widthMeasureSpec, MeasureSpec.EXACTLY));
-        } else {
-            if (width > height) {
-                super.onMeasure(makeSpec(heightMeasureSpec, MeasureSpec.EXACTLY), makeSpec(heightMeasureSpec, MeasureSpec.EXACTLY));
-            } else {
-                super.onMeasure(makeSpec(widthMeasureSpec, MeasureSpec.EXACTLY), makeSpec(widthMeasureSpec, MeasureSpec.EXACTLY));
-            }
-        }
-    }
-
-    private static int makeSpec(int spec, int mode) {
-        return MeasureSpec.makeMeasureSpec(MeasureSpec.getSize(spec), mode);
-    }
-
-}
diff --git a/twidere/src/main/res/layout/activity_custom_tab_editor.xml b/twidere/src/main/res/layout/activity_custom_tab_editor.xml
index d029407851..8fc1ae6989 100644
--- a/twidere/src/main/res/layout/activity_custom_tab_editor.xml
+++ b/twidere/src/main/res/layout/activity_custom_tab_editor.xml
@@ -79,6 +79,7 @@
                         style="?android:listSeparatorTextViewStyle"
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
+                        android:tag="text_color|accent_color"
                         android:text="@string/account"/>
 
                     <Spinner
@@ -100,6 +101,7 @@
                         style="?android:listSeparatorTextViewStyle"
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
+                        android:tag="text_color|accent_color"
                         android:text="@string/user"/>
 
                     <FrameLayout
@@ -126,6 +128,7 @@
                         style="?android:listSeparatorTextViewStyle"
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
+                        android:tag="text_color|accent_color"
                         android:text="@string/extra_configurations"/>
 
                     <LinearLayout
diff --git a/twidere/src/main/res/layout/activity_home.xml b/twidere/src/main/res/layout/activity_home.xml
index 33e70d4c9c..8e4ecd3d5f 100644
--- a/twidere/src/main/res/layout/activity_home.xml
+++ b/twidere/src/main/res/layout/activity_home.xml
@@ -32,7 +32,7 @@
 
     <fragment
         android:id="@+id/left_drawer"
-        class="org.mariotaku.twidere.fragment.support.AccountsDashboardFragment"
+        class="org.mariotaku.twidere.fragment.AccountsDashboardFragment"
         android:layout_width="@dimen/drawer_width_home"
         android:layout_height="match_parent"
         android:layout_gravity="start"
diff --git a/twidere/src/main/res/layout/adapter_item_media_status.xml b/twidere/src/main/res/layout/adapter_item_media_status.xml
index 1d46fbe710..e7204c4de8 100644
--- a/twidere/src/main/res/layout/adapter_item_media_status.xml
+++ b/twidere/src/main/res/layout/adapter_item_media_status.xml
@@ -63,7 +63,7 @@
             android:layout_height="wrap_content"
             android:padding="@dimen/element_spacing_small">
 
-            <org.mariotaku.twidere.view.SquareShapedImageView
+            <org.mariotaku.twidere.view.ShapedImageView
                 android:id="@+id/media_profile_image"
                 style="?profileImageStyle"
                 android:layout_width="@dimen/element_size_small"
diff --git a/twidere/src/main/res/layout/drawer_home_accounts.xml b/twidere/src/main/res/layout/drawer_home_accounts.xml
index 1ba7098a3c..0f9b807b40 100644
--- a/twidere/src/main/res/layout/drawer_home_accounts.xml
+++ b/twidere/src/main/res/layout/drawer_home_accounts.xml
@@ -28,7 +28,7 @@
 
     <fragment
         android:id="@+id/left_drawer"
-        class="org.mariotaku.twidere.fragment.support.AccountsDashboardFragment"
+        class="org.mariotaku.twidere.fragment.AccountsDashboardFragment"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
         tools:layout="@layout/fragment_accounts_dashboard"/>
diff --git a/twidere/src/main/res/layout/fragment_accounts_dashboard.xml b/twidere/src/main/res/layout/fragment_accounts_dashboard.xml
index a37bbc1728..7a6e9120ca 100644
--- a/twidere/src/main/res/layout/fragment_accounts_dashboard.xml
+++ b/twidere/src/main/res/layout/fragment_accounts_dashboard.xml
@@ -27,4 +27,4 @@
     android:focusable="true"
     app:headerLayout="@layout/header_drawer_account_selector"
     app:menu="@menu/menu_account_dashboard"
-    tools:context=".fragment.support.AccountsDashboardFragment"/>
+    tools:context=".fragment.AccountsDashboardFragment"/>
diff --git a/twidere/src/main/res/layout/fragment_wizard_page_finished.xml b/twidere/src/main/res/layout/fragment_wizard_page_finished.xml
index 688bc16c05..bd0e8ea485 100644
--- a/twidere/src/main/res/layout/fragment_wizard_page_finished.xml
+++ b/twidere/src/main/res/layout/fragment_wizard_page_finished.xml
@@ -72,6 +72,7 @@
                 android:layout_gravity="center"
                 android:fontFamily="sans-serif-condensed"
                 android:singleLine="true"
+                android:tag="text_color|accent_color"
                 android:text="@android:string/ok"
                 android:textAppearance="?android:attr/textAppearanceLarge"
                 android:textSize="@dimen/text_size_wizard_nav_item"
diff --git a/twidere/src/main/res/layout/header_drawer_account_selector.xml b/twidere/src/main/res/layout/header_drawer_account_selector.xml
index 4da6aa8604..22065114ad 100644
--- a/twidere/src/main/res/layout/header_drawer_account_selector.xml
+++ b/twidere/src/main/res/layout/header_drawer_account_selector.xml
@@ -131,7 +131,8 @@
                         android:id="@+id/account_dashboard_menu"
                         android:layout_width="match_parent"
                         android:layout_height="match_parent"
-                        android:focusable="true"/>
+                        android:focusable="true"
+                        android:tag="ate_ignore"/>
                 </FrameLayout>
 
             </LinearLayout>
diff --git a/twidere/src/main/res/layout/header_wizard_page.xml b/twidere/src/main/res/layout/header_wizard_page.xml
index 253620bb09..786641b1a4 100644
--- a/twidere/src/main/res/layout/header_wizard_page.xml
+++ b/twidere/src/main/res/layout/header_wizard_page.xml
@@ -32,6 +32,7 @@
         android:layout_height="wrap_content"
         android:padding="@dimen/element_spacing_normal"
         android:singleLine="true"
+        android:tag="text_color|accent_color"
         android:textAppearance="?android:attr/textAppearanceLarge"
         android:textSize="@dimen/text_size_wizard_title"/>
 
diff --git a/twidere/src/main/res/layout/list_item_preference_header_category.xml b/twidere/src/main/res/layout/list_item_preference_header_category.xml
index bf934106b1..6dc441ecfb 100644
--- a/twidere/src/main/res/layout/list_item_preference_header_category.xml
+++ b/twidere/src/main/res/layout/list_item_preference_header_category.xml
@@ -27,4 +27,5 @@
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
     android:singleLine="true"
+    android:tag="text_color|accent_color"
     android:textColor="?colorAccent"/>
diff --git a/twidere/src/main/res/layout/list_item_suggestion_user.xml b/twidere/src/main/res/layout/list_item_suggestion_user.xml
index 5356fc3ba2..ad6ae637d6 100644
--- a/twidere/src/main/res/layout/list_item_suggestion_user.xml
+++ b/twidere/src/main/res/layout/list_item_suggestion_user.xml
@@ -17,22 +17,23 @@
   ~  along with this program.  If not, see <http://www.gnu.org/licenses/>.
   -->
 
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
-    android:layout_height="@dimen/element_size_normal"
+    android:layout_height="wrap_content"
     android:gravity="center_vertical"
     android:minHeight="?android:listPreferredItemHeightSmall"
     android:orientation="horizontal"
     android:padding="@dimen/element_spacing_small">
 
-    <org.mariotaku.twidere.view.SquareShapedImageView
+    <org.mariotaku.twidere.view.ShapedImageView
         android:id="@android:id/icon"
         style="?profileImageStyle"
-        android:layout_width="wrap_content"
-        android:layout_height="match_parent"
+        android:layout_width="@dimen/element_size_normal"
+        android:layout_height="@dimen/element_size_normal"
         android:contentDescription="@string/icon"
-        android:scaleType="centerCrop" />
+        android:scaleType="centerCrop"/>
 
     <LinearLayout
         android:layout_width="match_parent"
@@ -40,9 +41,9 @@
         android:gravity="center_vertical"
         android:orientation="horizontal"
         android:paddingEnd="0dp"
+        android:paddingLeft="@dimen/element_spacing_small"
         android:paddingRight="0dp"
-        android:paddingStart="@dimen/element_spacing_small"
-        android:paddingLeft="@dimen/element_spacing_small">
+        android:paddingStart="@dimen/element_spacing_small">
 
         <TextView
             android:id="@android:id/text1"
@@ -50,7 +51,7 @@
             android:layout_height="wrap_content"
             android:singleLine="true"
             android:textAppearance="?android:attr/textAppearanceMedium"
-            tools:text="Mariotaku" />
+            tools:text="Mariotaku"/>
 
         <TextView
             android:id="@android:id/text2"
@@ -60,7 +61,7 @@
             android:layout_marginStart="@dimen/element_spacing_small"
             android:singleLine="true"
             android:textAppearance="?android:attr/textAppearanceSmall"
-            tools:text="\@mariotaku" />
+            tools:text="\@mariotaku"/>
     </LinearLayout>
 
 </LinearLayout>
\ No newline at end of file
diff --git a/twidere/src/main/res/layout/settings_layout_wizard_page_nav.xml b/twidere/src/main/res/layout/settings_layout_wizard_page_nav.xml
index 70bbeea624..b4ec6575b7 100644
--- a/twidere/src/main/res/layout/settings_layout_wizard_page_nav.xml
+++ b/twidere/src/main/res/layout/settings_layout_wizard_page_nav.xml
@@ -31,6 +31,7 @@
         android:layout_gravity="end"
         android:fontFamily="sans-serif-condensed"
         android:singleLine="true"
+        android:tag="text_color|accent_color"
         android:textAppearance="?android:attr/textAppearanceLarge"
         android:textSize="@dimen/text_size_wizard_nav_item"
         android:textStyle="bold"
diff --git a/twidere/src/main/res/values-notnight/themes.xml b/twidere/src/main/res/values-notnight/themes.xml
index 00282f9aef..a1bf1b0d83 100644
--- a/twidere/src/main/res/values-notnight/themes.xml
+++ b/twidere/src/main/res/values-notnight/themes.xml
@@ -17,7 +17,6 @@
         <item name="menuIconColor">@color/action_icon_dark</item>
         <item name="messageBubbleColor">@color/message_bubble_color_light</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_light</item>
-        <item name="coloredActionBar">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">light</item>
@@ -46,7 +45,6 @@
         <item name="menuIconColor">@color/action_icon_dark</item>
         <item name="messageBubbleColor">@color/message_bubble_color_light</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_light</item>
-        <item name="coloredActionBar">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">light</item>
@@ -73,7 +71,6 @@
         <item name="menuIconColor">@color/action_icon_dark</item>
         <item name="messageBubbleColor">@color/message_bubble_color_light</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_light</item>
-        <item name="coloredActionBar">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">light</item>
@@ -100,12 +97,17 @@
     </style>
 
     <style name="Theme.Twidere.QuickSearchBar" parent="Theme.Twidere.Dialog">
+
+        <item name="windowNoTitle">true</item>
+        <item name="windowActionModeOverlay">false</item>
+
         <item name="android:windowBackground">@android:color/transparent</item>
         <item name="android:windowNoTitle">true</item>
         <item name="android:windowMinWidthMajor">@android:dimen/dialog_min_width_major</item>
         <item name="android:windowMinWidthMinor">100%</item>
         <item name="android:windowActionBarOverlay">false</item>
         <item name="android:windowActionModeOverlay">false</item>
+
     </style>
 
 
diff --git a/twidere/src/main/res/values/attrs.xml b/twidere/src/main/res/values/attrs.xml
index 935944d30f..babb11a01e 100644
--- a/twidere/src/main/res/values/attrs.xml
+++ b/twidere/src/main/res/values/attrs.xml
@@ -12,10 +12,7 @@
         <attr name="cardItemBackgroundColor" format="color"/>
         <attr name="quoteIndicatorBackgroundColor" format="color"/>
         <attr name="linePageIndicatorStyle" format="reference"/>
-        <attr name="progressWheelStyle" format="reference"/>
-        <attr name="darkTheme" format="boolean"/>
         <attr name="ateThemeKey" format="string"/>
-        <attr name="coloredActionBar" format="boolean"/>
         <attr name="windowNormalBackground" format="reference"/>
     </declare-styleable>
     <declare-styleable name="ColorLabelView">
diff --git a/twidere/src/main/res/values/styles.xml b/twidere/src/main/res/values/styles.xml
index 9f1e59cbca..6f30e6e054 100644
--- a/twidere/src/main/res/values/styles.xml
+++ b/twidere/src/main/res/values/styles.xml
@@ -33,8 +33,6 @@
         <item name="sivCornerRadiusRatio">10%p</item>
         <item name="sivBackgroundColor">?android:colorBackground</item>
         <item name="sivShape">circle</item>
-        <item name="riv_oval">true</item>
-        <item name="riv_corner_radius">2dp</item>
     </style>
 
     <style name="Widget.Light.ProfileImage" parent="Widget.Base">
@@ -44,8 +42,6 @@
         <item name="sivCornerRadiusRatio">10%p</item>
         <item name="sivBackgroundColor">?android:colorBackground</item>
         <item name="sivShape">circle</item>
-        <item name="riv_oval">true</item>
-        <item name="riv_corner_radius">2dp</item>
     </style>
 
     <style name="Widget.ProfileImage.Large">
@@ -57,7 +53,6 @@
         <item name="sivBorderWidth">2dp</item>
         <item name="sivBackgroundColor">?android:colorBackground</item>
         <item name="sivShape">circle</item>
-        <item name="riv_corner_radius">4dp</item>
     </style>
 
     <style name="Widget.Light.ProfileImage.Large">
@@ -69,7 +64,6 @@
         <item name="sivBorderWidth">2dp</item>
         <item name="sivBackgroundColor">?android:colorBackground</item>
         <item name="sivShape">circle</item>
-        <item name="riv_corner_radius">4dp</item>
     </style>
 
     <style name="Widget.ProfileType" parent="Widget.Base">
diff --git a/twidere/src/main/res/values/themes.xml b/twidere/src/main/res/values/themes.xml
index e14d909082..bae51bd083 100644
--- a/twidere/src/main/res/values/themes.xml
+++ b/twidere/src/main/res/values/themes.xml
@@ -18,7 +18,6 @@
         <item name="menuIconColor">@color/action_icon_light</item>
         <item name="messageBubbleColor">@color/message_bubble_color_dark</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_dark</item>
-        <item name="darkTheme">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
@@ -54,7 +53,6 @@
         <item name="menuIconColor">@color/action_icon_light</item>
         <item name="messageBubbleColor">@color/message_bubble_color_dark</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_dark</item>
-        <item name="darkTheme">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
@@ -80,7 +78,6 @@
         <item name="menuIconColor">@color/action_icon_light</item>
         <item name="messageBubbleColor">@color/message_bubble_color_dark</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_dark</item>
-        <item name="darkTheme">true</item>
 
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
@@ -113,8 +110,6 @@
         <item name="android:windowActionBarOverlay">false</item>
         <item name="android:windowActionModeOverlay">false</item>
 
-        <item name="darkTheme">true</item>
-
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
 
@@ -131,8 +126,6 @@
         <item name="android:windowNoTitle">true</item>
         <item name="android:windowTitleStyle">@style/Widget.TextView.WindowTitle.NoDisplay</item>
 
-        <item name="darkTheme">true</item>
-
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
 
@@ -164,8 +157,6 @@
         <item name="messageBubbleColor">@color/message_bubble_color_dark</item>
         <item name="quoteIndicatorBackgroundColor">@color/quote_indicator_background_dark</item>
 
-        <item name="darkTheme">true</item>
-
         <!-- ATE attributes -->
         <item name="ateThemeKey">dark</item>
 
@@ -175,7 +166,6 @@
 
     <style name="Theme.Nyan" parent="Theme.AppCompat.NoActionBar">
         <item name="android:windowBackground">@color/nyan_background</item>
-        <item name="darkTheme">true</item>
         <item name="colorPrimary">@color/nyan_background</item>
     </style>
 
