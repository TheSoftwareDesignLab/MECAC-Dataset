diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java
index 256d1e685044..b8708201495f 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java
@@ -94,10 +94,8 @@
 import com.ichi2.anki.dialogs.DeckPickerBackupNoSpaceLeftDialog;
 import com.ichi2.anki.dialogs.DeckPickerConfirmDeleteDeckDialog;
 import com.ichi2.anki.dialogs.DeckPickerContextMenu;
-import com.ichi2.anki.dialogs.ExportCompleteDialog;
 import com.ichi2.anki.dialogs.DeckPickerNoSpaceLeftDialog;
 import com.ichi2.anki.dialogs.DialogHandler;
-import com.ichi2.anki.dialogs.ExportDialog;
 import com.ichi2.anki.dialogs.ImportDialog;
 import com.ichi2.anki.dialogs.MediaCheckDialog;
 import com.ichi2.anki.dialogs.SyncErrorDialog;
@@ -156,9 +154,8 @@
 
 public class DeckPicker extends NavigationDrawerActivity implements
         StudyOptionsListener, SyncErrorDialog.SyncErrorDialogListener, ImportDialog.ImportDialogListener,
-        MediaCheckDialog.MediaCheckDialogListener, ExportDialog.ExportDialogListener,
-        ActivityCompat.OnRequestPermissionsResultCallback, CustomStudyDialog.CustomStudyListener,
-        ExportCompleteDialog.ExportCompleteDialogListener {
+        MediaCheckDialog.MediaCheckDialogListener, ActivityCompat.OnRequestPermissionsResultCallback,
+        CustomStudyDialog.CustomStudyListener{
 
 
     /**
@@ -793,7 +790,7 @@ public boolean onOptionsItemSelected(MenuItem item) {
         } else if (itemId == R.id.action_export) {
             Timber.i("DeckPicker:: Export collection button pressed");
             String msg = getResources().getString(R.string.confirm_apkg_export);
-            showDialogFragment(ExportDialog.newInstance(msg));
+            mExportingDelegate.showExportDialog(msg);
             return true;
         }
         return super.onOptionsItemSelected(item);
@@ -1992,24 +1989,6 @@ public void importReplace(String importPath) {
     }
 
 
-    @Override
-    public void exportApkg(String filename, Long did, boolean includeSched, boolean includeMedia) {
-        mExportingDelegate.exportApkg(filename,did,includeSched,includeMedia);
-    }
-
-
-    @Override
-    public void emailFile(String path) {
-        mExportingDelegate.emailFile(path);
-    }
-
-
-    @Override
-    public void saveExportFile(String path) {
-        mExportingDelegate.saveExportFile(path);
-    }
-
-
     /**
      * Load a new studyOptionsFragment. If withDeckOptions is true, the deck options activity will
      * be loaded on top of it. Use this flag when creating a new filtered deck to allow the user to
@@ -2391,7 +2370,7 @@ public void showContextMenuExportDialog() {
     }
     public void exportDeck(long did) {
         String msg = getResources().getString(R.string.confirm_apkg_export_deck, getCol().getDecks().get(did).getString("name"));
-        showDialogFragment(ExportDialog.newInstance(msg, did));
+        mExportingDelegate.showExportDialog(msg, did);
     }
 
     public void createIcon(Context context) {
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportCompleteDialog.java b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportCompleteDialog.java
index 3e2bc4b87805..b88b6aa5e96a 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportCompleteDialog.java
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportCompleteDialog.java
@@ -36,13 +36,21 @@ public interface ExportCompleteDialogListener {
         void saveExportFile(String exportPath);
     }
 
+    @NonNull
+    private final ExportCompleteDialogListener mListener;
+
+    public ExportCompleteDialog(@NonNull ExportCompleteDialogListener listener) {
+        mListener = listener;
+    }
 
-    public static ExportCompleteDialog newInstance(String exportPath) {
-        ExportCompleteDialog f = new ExportCompleteDialog();
-        Bundle args = new Bundle();
+    public ExportCompleteDialog withArguments(String exportPath) {
+        Bundle args = this.getArguments();
+        if (args == null) {
+            args = new Bundle();
+        }
         args.putString("exportPath", exportPath);
-        f.setArguments(args);
-        return f;
+        this.setArguments(args);
+        return this;
     }
 
 
@@ -50,23 +58,23 @@ public static ExportCompleteDialog newInstance(String exportPath) {
     @Override
     public MaterialDialog onCreateDialog(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        final String exportPath = getArguments().getString("exportPath");
-        MaterialDialog.Builder dialogBuilder = new MaterialDialog.Builder(getActivity())
+        final String exportPath = requireArguments().getString("exportPath");
+        MaterialDialog.Builder dialogBuilder = new MaterialDialog.Builder(requireActivity())
                 .title(getNotificationTitle())
                 .content(getNotificationMessage())
                 .iconAttr(R.attr.dialogSendIcon)
                 .positiveText(R.string.export_send_button)
                 .negativeText(R.string.export_save_button)
                 .onPositive((dialog, which) -> {
-                    ((ExportCompleteDialogListener) getActivity()).dismissAllDialogFragments();
-                    ((ExportCompleteDialogListener) getActivity()).emailFile(exportPath);
+                    mListener.dismissAllDialogFragments();
+                    mListener.emailFile(exportPath);
                 })
                 .onNegative((dialog, which) -> {
-                    ((ExportCompleteDialogListener) getActivity()).dismissAllDialogFragments();
-                    ((ExportCompleteDialogListener) getActivity()).saveExportFile(exportPath);
+                    mListener.dismissAllDialogFragments();
+                    mListener.saveExportFile(exportPath);
                 })
                 .neutralText(R.string.dialog_cancel)
-                .onNeutral((dialog, which) -> ((ExportCompleteDialogListener) getActivity()).dismissAllDialogFragments());
+                .onNeutral((dialog, which) -> mListener.dismissAllDialogFragments());
         return dialogBuilder.show();
     }
     
@@ -76,7 +84,7 @@ public String getNotificationTitle() {
 
 
     public String getNotificationMessage() {
-        File exportPath = new File(getArguments().getString("exportPath"));
+        File exportPath = new File(requireArguments().getString("exportPath"));
         return res().getString(R.string.export_successful, exportPath.getName());
     }
 }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportDialog.java b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportDialog.java
index 397083f4bc10..025fb414dea8 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportDialog.java
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportDialog.java
@@ -18,14 +18,15 @@
 
 import android.content.res.Resources;
 import android.os.Bundle;
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
 
 import com.afollestad.materialdialogs.MaterialDialog;
 import com.ichi2.anki.R;
 import com.ichi2.anki.analytics.AnalyticsDialogFragment;
 import com.ichi2.utils.BundleUtils;
 
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
 public class ExportDialog extends AnalyticsDialogFragment {
 
     public interface ExportDialogListener {
@@ -34,6 +35,14 @@ public interface ExportDialogListener {
         void dismissAllDialogFragments();
     }
 
+    @NonNull
+    private final ExportDialogListener mListener;
+
+
+    public ExportDialog(@NonNull ExportDialogListener listener) {
+        mListener = listener;
+    }
+
     private final static int INCLUDE_SCHED = 0;
     private final static int INCLUDE_MEDIA = 1;
     private boolean mIncludeSched = false;
@@ -47,15 +56,17 @@ public interface ExportDialogListener {
      *            if did is null then the whole collection of decks will be exported
      * @param dialogMessage A string which can be used to show a custom message or specify import path
      */
-    public static ExportDialog newInstance(@NonNull String dialogMessage, @Nullable Long did) {
-        ExportDialog f = new ExportDialog();
-        Bundle args = new Bundle();
+    public ExportDialog withArguments(@NonNull String dialogMessage, @Nullable Long did) {
+        Bundle args = this.getArguments();
+        if (args == null) {
+            args = new Bundle();
+        }
         if (did != null) {
             args.putLong("did", did);
         }
         args.putString("dialogMessage", dialogMessage);
-        f.setArguments(args);
-        return f;
+        this.setArguments(args);
+        return this;
     }
 
     /**
@@ -63,8 +74,8 @@ public static ExportDialog newInstance(@NonNull String dialogMessage, @Nullable
      *
      * @param dialogMessage A string which can be used to show a custom message or specify import path
      */
-    public static ExportDialog newInstance(@NonNull String dialogMessage) {
-        return newInstance(dialogMessage, null);
+    public ExportDialog withArguments(@NonNull String dialogMessage) {
+        return withArguments(dialogMessage, null);
     }
 
 
@@ -85,7 +96,7 @@ public MaterialDialog onCreateDialog(Bundle savedInstanceState) {
         final String[] items = { res.getString(R.string.export_include_schedule),
                 res.getString(R.string.export_include_media) };
 
-        MaterialDialog.Builder builder = new MaterialDialog.Builder(getActivity())
+        MaterialDialog.Builder builder = new MaterialDialog.Builder(requireActivity())
                 .title(R.string.export)
                 .content(getArguments().getString("dialogMessage"))
                 .positiveText(android.R.string.ok)
@@ -110,7 +121,7 @@ public MaterialDialog onCreateDialog(Bundle savedInstanceState) {
                             return true;
                         })
                 .onPositive((dialog, which) -> {
-                    ((ExportDialogListener) getActivity()).exportApkg(null, did, mIncludeSched, mIncludeMedia);
+                    mListener.exportApkg(null, did, mIncludeSched, mIncludeMedia);
                     dismissAllDialogFragments();
                 })
                 .onNegative((dialog, which) -> dismissAllDialogFragments());
@@ -119,7 +130,7 @@ public MaterialDialog onCreateDialog(Bundle savedInstanceState) {
 
 
     public void dismissAllDialogFragments() {
-        ((ExportDialogListener) getActivity()).dismissAllDialogFragments();
+        mListener.dismissAllDialogFragments();
     }
 
 }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.java b/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.java
index 66a543057ed9..55066ecb9048 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.java
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.java
@@ -18,7 +18,9 @@
 
 import android.content.Intent;
 import android.net.Uri;
+import android.os.Bundle;
 import android.os.ParcelFileDescriptor;
+import android.os.PersistableBundle;
 import android.util.Pair;
 
 import com.afollestad.materialdialogs.MaterialDialog;
@@ -28,6 +30,7 @@
 import com.ichi2.anki.UIUtils;
 import com.ichi2.anki.dialogs.ExportCompleteDialog;
 import com.ichi2.anki.dialogs.ExportCompleteDialog.ExportCompleteDialogListener;
+import com.ichi2.anki.dialogs.ExportDialog.ExportDialogListener;
 import com.ichi2.async.CollectionTask;
 import com.ichi2.async.TaskListenerWithContext;
 import com.ichi2.async.TaskManager;
@@ -44,23 +47,28 @@
 import androidx.annotation.NonNull;
 import androidx.core.app.ShareCompat;
 import androidx.core.content.FileProvider;
+import androidx.fragment.app.FragmentFactory;
+import androidx.fragment.app.FragmentManager;
 import timber.log.Timber;
 
 /**
  * A delegate class used in any {@link AnkiActivity} where the exporting feature is required.
- * <p>
- * The calling activity must implement {@link ExportCompleteDialogListener} and can then forward any call the the exporting delegate
  */
-public class ActivityExportingDelegate <A extends AnkiActivity & ExportCompleteDialogListener> {
+public class ActivityExportingDelegate <A extends AnkiActivity> implements ExportDialogListener, ExportCompleteDialogListener {
+
 
     private final A mActivity;
     private final Supplier<Collection> mCollectionSupplier;
     private final int mPickExportFileCallbackCode;
+    private final ExportDialogsFactory mDialogsFactory;
 
     private String mExportFileName;
 
 
     /**
+     * Must be constructed before calling {@link AnkiActivity#onCreate(Bundle, PersistableBundle)}, this is to fragment
+     * factory {@link #mDialogsFactory} is set correctly.
+     *
      * @param activity the calling activity (must implement {@link ExportCompleteDialogListener})
      * @param collectionSupplier a predicate that supplies a collection instance
      * @param mPickExportFileCallbackCode the code that will be used on onActivityResult
@@ -69,9 +77,22 @@ public ActivityExportingDelegate(A activity, Supplier<Collection> collectionSupp
         mActivity = activity;
         this.mCollectionSupplier = collectionSupplier;
         this.mPickExportFileCallbackCode = mPickExportFileCallbackCode;
+        final FragmentManager fragmentManager = activity.getSupportFragmentManager();
+        mDialogsFactory = new ExportDialogsFactory(this, this).attachToActivity(activity);
+        fragmentManager.setFragmentFactory(mDialogsFactory);
     }
 
 
+    public void showExportDialog(String msg) {
+        mActivity.showDialogFragment(mDialogsFactory.newExportDialog().withArguments(msg));
+    }
+
+
+    public void showExportDialog(String msg, long did) {
+        mActivity.showDialogFragment(mDialogsFactory.newExportDialog().withArguments(msg, did));
+    }
+
+    @Override
     public void exportApkg(String filename, Long did, boolean includeSched, boolean includeMedia) {
         File exportDir = new File(mActivity.getExternalCacheDir(), "export");
         exportDir.mkdirs();
@@ -92,11 +113,18 @@ public void exportApkg(String filename, Long did, boolean includeSched, boolean
             String newFileName = colPath.getName().replace(".anki2", timeStampSuffix + ".colpkg");
             exportPath = new File(exportDir, newFileName);
         }
-        final ExportListener exportListener = new ExportListener<>(mActivity);
+        final ExportListener exportListener = new ExportListener<>(mActivity, mDialogsFactory);
         TaskManager.launchCollectionTask(new CollectionTask.ExportApkg(exportPath.getPath(), did, includeSched, includeMedia), exportListener);
     }
 
 
+    @Override
+    public void dismissAllDialogFragments() {
+        mActivity.dismissAllDialogFragments();
+    }
+
+
+    @Override
     public void emailFile(String path) {
         // Make sure the file actually exists
         File attachment = new File(path);
@@ -130,6 +158,7 @@ public void emailFile(String path) {
     }
 
 
+    @Override
     public void saveExportFile(String path) {
         // Make sure the file actually exists
         File attachment = new File(path);
@@ -184,12 +213,15 @@ public boolean exportToProvider(Intent intent, boolean deleteAfterExport) {
     }
 
 
-    private static class ExportListener<A extends AnkiActivity & ExportCompleteDialogListener>  extends TaskListenerWithContext<A, Void, Pair<Boolean, String>> {
+    private static class ExportListener<A extends AnkiActivity>  extends TaskListenerWithContext<A, Void, Pair<Boolean, String>> {
+        private final ExportDialogsFactory mDialogsFactory;
+
         private MaterialDialog mProgressDialog;
 
 
-        public ExportListener(A activity) {
+        public ExportListener(A activity, ExportDialogsFactory dialogsFactory) {
             super(activity);
+            this.mDialogsFactory = dialogsFactory;
         }
 
 
@@ -215,7 +247,8 @@ public void actualOnPostExecute(@NonNull A activity, Pair<Boolean, String> resul
                 Timber.i("Export successful");
                 String exportPath = result.second;
                 if (exportPath != null) {
-                    activity.showAsyncDialogFragment(ExportCompleteDialog.newInstance(exportPath));
+                    final ExportCompleteDialog dialog = mDialogsFactory.newExportCompleteDialog().withArguments(exportPath);
+                    activity.showAsyncDialogFragment(dialog);
                 } else {
                     UIUtils.showThemedToast(activity, activity.getResources().getString(R.string.export_unsuccessful), true);
                 }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/export/ExportDialogsFactory.java b/AnkiDroid/src/main/java/com/ichi2/anki/export/ExportDialogsFactory.java
new file mode 100644
index 000000000000..5fb7635da877
--- /dev/null
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/export/ExportDialogsFactory.java
@@ -0,0 +1,69 @@
+/*
+ Copyright (c) 2021 Tarek Mohamed Abdalla <tarekkma@gmail.com>
+
+ This program is free software; you can redistribute it and/or modify it under
+ the terms of the GNU General Public License as published by the Free Software
+ Foundation; either version 3 of the License, or (at your option) any later
+ version.
+
+ This program is distributed in the hope that it will be useful, but WITHOUT ANY
+ WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+ PARTICULAR PURPOSE. See the GNU General Public License for more details.
+
+ You should have received a copy of the GNU General Public License along with
+ this program.  If not, see <http://www.gnu.org/licenses/>.
+ */
+package com.ichi2.anki.export;
+
+import com.ichi2.anki.dialogs.ExportCompleteDialog;
+import com.ichi2.anki.dialogs.ExportDialog;
+import com.ichi2.utils.ExtendedFragmentFactory;
+
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentFactory;
+
+class ExportDialogsFactory extends ExtendedFragmentFactory {
+
+    @NonNull
+    private final ExportCompleteDialog.ExportCompleteDialogListener mExportCompleteDialogListener;
+    @NonNull
+    private final ExportDialog.ExportDialogListener mExportDialogListener;
+
+
+    public ExportDialogsFactory(
+            @NonNull ExportCompleteDialog.ExportCompleteDialogListener exportCompleteDialogListener,
+            @NonNull ExportDialog.ExportDialogListener exportDialogListener
+    ) {
+        this.mExportCompleteDialogListener = exportCompleteDialogListener;
+        this.mExportDialogListener = exportDialogListener;
+    }
+
+
+    @NonNull
+    @Override
+    public Fragment instantiate(@NonNull ClassLoader classLoader, @NonNull String className) {
+        Class<? extends Fragment> cls = loadFragmentClass(classLoader, className);
+
+        if (cls == ExportDialog.class) {
+            return newExportDialog();
+        }
+
+        if (cls == ExportCompleteDialog.class) {
+            return newExportCompleteDialog();
+        }
+
+        return super.instantiate(classLoader, className);
+    }
+
+    @NonNull
+    public ExportDialog newExportDialog() {
+        return new ExportDialog(mExportDialogListener);
+    }
+
+    @NonNull
+    public ExportCompleteDialog newExportCompleteDialog() {
+        return new ExportCompleteDialog(mExportCompleteDialogListener);
+    }
+}
