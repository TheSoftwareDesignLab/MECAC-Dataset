diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.kt b/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.kt
index 486ba0ad34c7..0b8f0185cd8a 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/CardBrowser.kt
@@ -100,6 +100,7 @@ import com.ichi2.widget.WidgetStatus.updateInBackground
 import kotlinx.coroutines.Job
 import kotlinx.coroutines.flow.Flow
 import kotlinx.coroutines.launch
+import kotlinx.coroutines.runBlocking
 import net.ankiweb.rsdroid.RustCleanup
 import timber.log.Timber
 import java.util.*
@@ -407,22 +408,22 @@ open class CardBrowser :
         viewModel.flowOfIsTruncated.launchCollectionInLifecycleScope { cardsAdapter.notifyDataSetChanged() }
 
         viewModel.flowOfCardsOrNotes
-            .launchCollectionInLifecycleScope { runOnUiThread { searchCards() } }
+            .launchCollectionInLifecycleScope { searchCards() }
 
         viewModel.flowOfSearchQueryExpanded
             .launchCollectionInLifecycleScope { searchQueryExpanded ->
                 Timber.d("query expansion changed: %b", searchQueryExpanded)
                 if (searchQueryExpanded) {
-                    runOnUiThread { searchItem?.expandActionView() }
+                    searchItem?.expandActionView()
                 } else {
-                    runOnUiThread { searchItem?.collapseActionView() }
+                    searchItem?.collapseActionView()
                     // invalidate options menu so that disappeared icons would appear again
                     invalidateOptionsMenu()
                 }
             }
 
         viewModel.flowOfSelectedRows
-            .launchCollectionInLifecycleScope { runOnUiThread { onSelectionChanged() } }
+            .launchCollectionInLifecycleScope { onSelectionChanged() }
 
         viewModel.flowOfColumnIndex1
             .launchCollectionInLifecycleScope { index -> cardsAdapter.updateMapping { it[0] = COLUMN1_KEYS[index] } }
@@ -442,9 +443,7 @@ open class CardBrowser :
             }
 
         viewModel.flowOfCanSearch
-            .launchCollectionInLifecycleScope { canSave ->
-                runOnUiThread { saveSearchItem?.isVisible = canSave }
-            }
+            .launchCollectionInLifecycleScope { canSave -> saveSearchItem?.isVisible = canSave }
 
         viewModel.flowOfIsInMultiSelectMode
             .launchCollectionInLifecycleScope { inMultiSelect ->
@@ -2211,7 +2210,16 @@ open class CardBrowser :
 
     private fun <T> Flow<T>.launchCollectionInLifecycleScope(block: suspend (T) -> Unit) {
         lifecycleScope.launch {
-            this@launchCollectionInLifecycleScope.collect { block(it) }
+            this@launchCollectionInLifecycleScope.collect {
+                if (isRobolectric) {
+                    // hack: lifecycleScope/runOnUiThread do not handle our
+                    // test dispatcher overriding both IO and Main
+                    // in tests, waitForAsyncTasksToComplete may be required.
+                    HandlerUtils.postOnNewHandler { runBlocking { block(it) } }
+                } else {
+                    block(it)
+                }
+            }
         }
     }
 }
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/CardBrowserTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/CardBrowserTest.kt
index d651fdbbe5a9..276a489a3d02 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/CardBrowserTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/CardBrowserTest.kt
@@ -434,6 +434,7 @@ class CardBrowserTest : RobolectricTest() {
 
         val b = browserWithNoNewCards
         b.viewModel.setFlagFilter(Flag.RED)
+        waitForAsyncTasksToComplete()
 
         assertThat("Flagged cards should be returned", b.viewModel.rowCount, equalTo(2))
     }
@@ -718,6 +719,7 @@ class CardBrowserTest : RobolectricTest() {
 
         val cardBrowser = browserWithNoNewCards
         cardBrowser.searchCards("Hello")
+        waitForAsyncTasksToComplete()
         assertThat(
             "Card browser should have Test Deck as the selected deck",
             cardBrowser.selectedDeckNameForUi,
@@ -726,6 +728,7 @@ class CardBrowserTest : RobolectricTest() {
         assertThat("Result should be empty", cardBrowser.viewModel.rowCount, equalTo(0))
 
         cardBrowser.searchAllDecks()
+        waitForAsyncTasksToComplete()
         assertThat("Result should contain one card", cardBrowser.viewModel.rowCount, equalTo(1))
     }
 
@@ -736,10 +739,11 @@ class CardBrowserTest : RobolectricTest() {
         addNoteUsingBasicAndReversedModel("Hello", "Anki")
 
         browserWithNoNewCards.apply {
-            searchAllDecks()
+            searchAllDecks().join()
             with(viewModel) {
                 assertThat("Result should contain 4 cards", rowCount, equalTo(4))
-                setCardsOrNotes(NOTES)
+                setCardsOrNotes(NOTES).join()
+                waitForAsyncTasksToComplete()
                 assertThat("Result should contain 2 cards (one per note)", rowCount, equalTo(2))
             }
         }
