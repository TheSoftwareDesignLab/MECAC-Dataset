diff --git a/AnkiDroid/src/main/java/com/ichi2/libanki/TagManager.kt b/AnkiDroid/src/main/java/com/ichi2/libanki/TagManager.kt
index 4c44989d66d0..6965001ed6c7 100644
--- a/AnkiDroid/src/main/java/com/ichi2/libanki/TagManager.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/libanki/TagManager.kt
@@ -18,7 +18,6 @@ package com.ichi2.libanki
 
 import com.ichi2.libanki.backend.model.TagUsnTuple
 import net.ankiweb.rsdroid.RustCleanup
-import java.util.*
 
 /**
  * Manages the tag cache and tags for notes.
@@ -32,7 +31,9 @@ abstract class TagManager {
      * Registry save/load
      * ***********************************************************
      */
+    @RustCleanup("Tags.java only")
     abstract fun load(json: String)
+    @RustCleanup("Tags.java only")
     abstract fun flush()
 
     /*
@@ -58,6 +59,7 @@ abstract class TagManager {
     abstract fun registerNotes(nids: kotlin.collections.Collection<Long>? = null)
 
     abstract fun allItems(): Iterable<TagUsnTuple>
+    @RustCleanup("Tags.java only")
     abstract fun save()
     /**
      * byDeck returns the tags of the cards in the deck
@@ -65,7 +67,7 @@ abstract class TagManager {
      * @param children whether to include the deck's children
      * @return a list of the tags
      */
-    abstract fun byDeck(did: Long, children: Boolean): ArrayList<String>
+    abstract fun byDeck(did: Long, children: Boolean = false): List<String>
 
     /*
     * Bulk addition/removal from notes
@@ -110,7 +112,8 @@ abstract class TagManager {
      */
 
     /** Strip duplicates, adjust case to match existing tags, and sort. */
-    abstract fun canonify(tagList: List<String>): TreeSet<String>
+    @RustCleanup("List, not Collection")
+    abstract fun canonify(tagList: List<String>): java.util.AbstractSet<String>
     /** @return True if TAG is in TAGS. Ignore case. */
     abstract fun inList(tag: String, tags: Iterable<String>): Boolean
 
@@ -119,6 +122,7 @@ abstract class TagManager {
      * ***********************************************************
      */
 
+    @RustCleanup("Tags.java only")
     abstract fun beforeUpload()
 
     /*
diff --git a/AnkiDroid/src/main/java/com/ichi2/libanki/TagsV16.kt b/AnkiDroid/src/main/java/com/ichi2/libanki/TagsV16.kt
index 4196a85f3d71..1a461a2edee7 100644
--- a/AnkiDroid/src/main/java/com/ichi2/libanki/TagsV16.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/libanki/TagsV16.kt
@@ -30,7 +30,6 @@ import com.ichi2.libanki.backend.model.TagUsnTuple
 import com.ichi2.libanki.utils.join
 import com.ichi2.libanki.utils.list
 import com.ichi2.libanki.utils.set
-import java.util.*
 import java.util.regex.Pattern
 
 /**
@@ -39,32 +38,32 @@ import java.util.regex.Pattern
  * tracked, so unused tags can only be removed from the list with a DB check.
  * This module manages the tag cache and tags for notes.
  */
-class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
+class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) : TagManager() {
 
     /** all tags */
-    fun all(): List<String> = mBackend.all_tags().map { it.tag }
+    override fun all(): List<String> = mBackend.all_tags().map { it.tag }
 
     /** List of (tag, usn) */
-    fun allItems(): List<TagUsnTuple> = mBackend.all_tags()
+    override fun allItems(): List<TagUsnTuple> = mBackend.all_tags()
 
     /*
     # Registering and fetching tags
     #############################################################
     */
 
-    fun register(
-        tags: kotlin.collections.Collection<String>,
-        usn: Optional<Int> = Optional.empty(),
-        clear: Boolean = false
+    override fun register(
+        tags: Iterable<String>,
+        usn: Int?,
+        clear: Boolean
     ) {
 
         val preserve_usn: Boolean
         val usn_: Int
-        if (!usn.isPresent) {
+        if (usn == null) {
             preserve_usn = false
             usn_ = 0
         } else {
-            usn_ = usn.get()
+            usn_ = usn
             preserve_usn = true
         }
 
@@ -74,13 +73,13 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
     }
 
     /** Add any missing tags from notes to the tags list. */
-    fun registerNotes(nids: Optional<List<Long>> = Optional.empty()) {
+    override fun registerNotes(nids: kotlin.collections.Collection<Long>?) {
 
         // when called without an argument, the old list is cleared first.
         val clear: Boolean
         val lim: String
-        if (nids.isPresent) {
-            lim = " where id in " + ids2str(nids.get())
+        if (nids != null) {
+            lim = " where id in " + ids2str(nids)
             clear = false
         } else {
             lim = ""
@@ -96,7 +95,7 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
         )
     }
 
-    fun byDeck(did: Long, children: Boolean = false): List<String> {
+    override fun byDeck(did: Long, children: Boolean): List<String> {
         val basequery = "select n.tags from cards c, notes n WHERE c.nid = n.id"
         val query: String
         val res: List<String>
@@ -143,8 +142,7 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
     // legacy routines
 
     /**  Add tags in bulk. TAGS is space-separated. */
-    fun bulkAdd(ids: List<Long>, tags: String, add: Boolean = true) {
-
+    override fun bulkAdd(ids: List<Long>, tags: String, add: Boolean) {
         if (add) {
             bulk_add(ids, tags)
         } else {
@@ -152,17 +150,13 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
         }
     }
 
-    fun bulkRem(ids: List<Long>, tags: String) {
-        bulkAdd(ids, tags, false)
-    }
-
     /*
     # String-based utilities
     ##########################################################################
      */
 
     /** Parse a string and return a list of tags. */
-    fun split(tags: String): MutableList<String> {
+    override fun split(tags: String): MutableList<String> {
         return tags.replace('\u3000', ' ')
             .split("\\s".toRegex())
             .filter { it.isNotEmpty() }
@@ -170,7 +164,7 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
     }
 
     /** Join tags into a single string, with leading and trailing spaces. */
-    fun join(tags: List<String>): String {
+    override fun join(tags: kotlin.collections.Collection<String>): String {
         if (tags.isEmpty()) {
             return ""
         }
@@ -190,7 +184,7 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
     }
 
     /** Delete tags if they exist. */
-    fun remFromStr(deltags: String, tags: String): String {
+    override fun remFromStr(deltags: String, tags: String): String {
         fun wildcard(search: String, str: String): Boolean {
             // TODO: needs testing
             val escaped = Pattern.quote(search).replace("\\*", ".*")
@@ -221,12 +215,41 @@ class TagsV16(val mCol: Collection, private val mBackend: TagsBackend) {
      */
 
     // this is now a no-op - the tags are canonified when the note is saved
-    fun canonify(tagList: List<String>): List<String> {
-        return tagList
+    override fun canonify(tagList: List<String>): java.util.AbstractSet<String> {
+        // libAnki difference: tagList was returned directly
+        return HashSet(tagList)
     }
 
     /** True if TAG is in TAGS. Ignore case.*/
-    fun inList(tag: String, tags: List<String>): Boolean {
+    override fun inList(tag: String, tags: Iterable<String>): Boolean {
         return tags.map { it.lowercase() }.contains(tag.lowercase())
     }
+
+    /*
+     * Not in libAnki
+     */
+
+    override fun add(tag: String, usn: Int?) {
+        register(listOf(tag), usn)
+    }
+
+    /*
+     * Interface compatibility - to be removed
+     */
+
+    override fun load(json: String) {
+        // intentionally left blank
+    }
+
+    override fun flush() {
+        // intentionally left blank
+    }
+
+    override fun save() {
+        // intentionally left blank//
+    }
+
+    override fun beforeUpload() {
+        // intentionally left blank//
+    }
 }
diff --git a/AnkiDroid/src/main/java/com/ichi2/libanki/utils/PythonExtensions.kt b/AnkiDroid/src/main/java/com/ichi2/libanki/utils/PythonExtensions.kt
index 81ebe7cedd70..288b51228f1b 100644
--- a/AnkiDroid/src/main/java/com/ichi2/libanki/utils/PythonExtensions.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/libanki/utils/PythonExtensions.kt
@@ -65,7 +65,7 @@ fun <T> list(values: Collection<T>): List<T> = ArrayList(values)
 
 fun <T> set(values: List<T>): HashSet<T> = HashSet(values)
 
-fun String.join(values: Collection<String>): String {
+fun String.join(values: Iterable<String>): String {
     return TextUtils.join(this, values)
 }
 
