diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AnkiActivity.kt b/AnkiDroid/src/main/java/com/ichi2/anki/AnkiActivity.kt
index d49498bfee91..bb7afaff31f9 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/AnkiActivity.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AnkiActivity.kt
@@ -85,6 +85,9 @@ open class AnkiActivity : AppCompatActivity, SimpleMessageDialogListener, Collec
         // The hardware buttons should control the music volume
         volumeControlStream = AudioManager.STREAM_MUSIC
         // Set the theme
+        Themes.systemIsInNightMode =
+            resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK == Configuration.UI_MODE_NIGHT_YES
+        Themes.updateCurrentTheme()
         Themes.setTheme(this)
         Themes.disableXiaomiForceDarkMode(this)
         mPreviousTheme = Themes.currentTheme
@@ -282,7 +285,10 @@ open class AnkiActivity : AppCompatActivity, SimpleMessageDialogListener, Collec
         animation: Direction?
     ) {
         try {
-            launcher.launch(intent, ActivityTransitionAnimation.getAnimationOptions(this, animation))
+            launcher.launch(
+                intent,
+                ActivityTransitionAnimation.getAnimationOptions(this, animation)
+            )
         } catch (e: ActivityNotFoundException) {
             Timber.w(e)
             this.showSnackbar(R.string.activity_start_failed)
@@ -515,9 +521,14 @@ open class AnkiActivity : AppCompatActivity, SimpleMessageDialogListener, Collec
      * @param message
      * @param reload flag which forces app to be restarted when true
      */
-
-    open fun showSimpleMessageDialog(message: String?, title: String = "", reload: Boolean = false) {
-        val newFragment: AsyncDialogFragment = SimpleMessageDialog.newInstance(title, message, reload)
+    @KotlinCleanup("make message non-null")
+    open fun showSimpleMessageDialog(
+        message: String?,
+        title: String = "",
+        reload: Boolean = false
+    ) {
+        val newFragment: AsyncDialogFragment =
+            SimpleMessageDialog.newInstance(title, message, reload)
         showAsyncDialogFragment(newFragment)
     }
 
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/AnkiActivityTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/AnkiActivityTest.kt
index 76aa293e4036..3a06bc59bd4a 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/AnkiActivityTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/AnkiActivityTest.kt
@@ -38,6 +38,7 @@ class AnkiActivityTest : RobolectricTest() {
 
         val newConfig = Configuration(activity.resources.configuration)
         newConfig.uiMode = 33
+        activity.resources.configuration.uiMode = 33
         activity.onConfigurationChanged(newConfig)
 
         assertThat(Themes.currentTheme, equalTo(Theme.BLACK))
