diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.kt b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.kt
index e0f73041cf42..6e2092df9b43 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.kt
@@ -71,7 +71,6 @@ import androidx.core.view.MenuItemCompat
 import androidx.core.view.OnReceiveContentListener
 import androidx.core.view.isVisible
 import androidx.draganddrop.DropHelper
-import androidx.fragment.app.FragmentActivity
 import androidx.fragment.app.commit
 import androidx.lifecycle.flowWithLifecycle
 import androidx.lifecycle.lifecycleScope
@@ -1812,10 +1811,6 @@ open class DeckPicker :
         }
     }
 
-    override fun dismissAllDialogFragments() {
-        (this as FragmentActivity).dismissAllDialogFragments()
-    }
-
     override fun deleteUnused(unused: List<String>) {
         launchCatchingTask {
             // Number of deleted files
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DatabaseErrorDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DatabaseErrorDialog.kt
index 045cd87d16da..0b443469e2cf 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DatabaseErrorDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DatabaseErrorDialog.kt
@@ -126,7 +126,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                     }
                     negativeButton(R.string.answering_error_report) {
                         (activity as DeckPicker).sendErrorReport()
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     neutralButton(R.string.close) {
                         closeCollectionAndFinish()
@@ -200,7 +200,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                     setIcon(R.drawable.ic_warning)
                     positiveButton(R.string.dialog_positive_repair) {
                         (activity as DeckPicker).repairCollection()
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     negativeButton(R.string.dialog_cancel)
                 }
@@ -236,7 +236,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                                     ?.restoreFromBackup(
                                         backups[index].path
                                     )
-                                dismissAllDialogFragments()
+                                activity?.dismissAllDialogFragments()
                             } else {
                                 // otherwise show an error dialog
                                 AlertDialog.Builder(requireActivity()).show {
@@ -250,7 +250,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                 alertDialog.setOnKeyListener { _: DialogInterface?, keyCode: Int, _: KeyEvent? ->
                     if (keyCode == KeyEvent.KEYCODE_BACK) {
                         Timber.i("DIALOG_RESTORE_BACKUP caught hardware back button")
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                         return@setOnKeyListener true
                     }
                     false
@@ -285,7 +285,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                     message(text = message)
                     positiveButton(R.string.dialog_ok) {
                         (activity as DeckPicker).integrityCheck()
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     negativeButton(R.string.dialog_cancel)
                 }
@@ -309,7 +309,7 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
                     message(text = message)
                     positiveButton(R.string.dialog_positive_overwrite) {
                         (activity as DeckPicker).sync(ConflictResolution.FULL_DOWNLOAD)
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     negativeButton(R.string.dialog_cancel)
                 }
@@ -554,10 +554,6 @@ class DatabaseErrorDialog : AsyncDialogFragment() {
 
     private fun requireDialogType() = BundleCompat.getParcelable(requireArguments(), "dialog", DatabaseErrorDialogType::class.java)!!
 
-    fun dismissAllDialogFragments() {
-        (activity as AnkiActivity).dismissAllDialogFragments()
-    }
-
     @Parcelize
     enum class DatabaseErrorDialogType : Parcelable {
         DIALOG_LOAD_FAILED,
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerAnalyticsOptInDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerAnalyticsOptInDialog.kt
index d9a7c8272d95..664657fa67ad 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerAnalyticsOptInDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerAnalyticsOptInDialog.kt
@@ -18,10 +18,10 @@ package com.ichi2.anki.dialogs
 
 import android.os.Bundle
 import androidx.appcompat.app.AlertDialog
-import com.ichi2.anki.DeckPicker
 import com.ichi2.anki.R
 import com.ichi2.anki.analytics.AnalyticsDialogFragment
 import com.ichi2.anki.analytics.UsageAnalytics
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 import com.ichi2.utils.cancelable
 import com.ichi2.utils.checkBoxPrompt
 import com.ichi2.utils.create
@@ -39,10 +39,10 @@ class DeckPickerAnalyticsOptInDialog : AnalyticsDialogFragment() {
             checkBoxPrompt(R.string.analytics_title, isCheckedDefault = true) {}
             positiveButton(R.string.dialog_continue) {
                 UsageAnalytics.isEnabled = (it as AlertDialog).getCheckBoxPrompt().isChecked
-                (activity as DeckPicker).dismissAllDialogFragments()
+                activity?.dismissAllDialogFragments()
             }
             cancelable(true)
-            setOnCancelListener { (activity as DeckPicker).dismissAllDialogFragments() }
+            setOnCancelListener { activity?.dismissAllDialogFragments() }
         }
     }
 
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerConfirmDeleteDeckDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerConfirmDeleteDeckDialog.kt
index 609bf184bbe3..cee8d7af3617 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerConfirmDeleteDeckDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/DeckPickerConfirmDeleteDeckDialog.kt
@@ -23,6 +23,7 @@ import androidx.core.text.HtmlCompat
 import com.ichi2.anki.DeckPicker
 import com.ichi2.anki.R
 import com.ichi2.anki.analytics.AnalyticsDialogFragment
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 import com.ichi2.libanki.DeckId
 import com.ichi2.utils.BundleUtils.requireLong
 
@@ -55,10 +56,10 @@ class DeckPickerConfirmDeleteDeckDialog : AnalyticsDialogFragment() {
             .setIcon(R.drawable.ic_warning)
             .setPositiveButton(R.string.dialog_positive_delete) { _, _ ->
                 (activity as DeckPicker).deleteDeck(deckId)
-                (activity as DeckPicker).dismissAllDialogFragments()
+                activity?.dismissAllDialogFragments()
             }
             .setNegativeButton(R.string.dialog_cancel) { _, _ ->
-                (activity as DeckPicker).dismissAllDialogFragments()
+                activity?.dismissAllDialogFragments()
             }
             .create()
     }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportReadyDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportReadyDialog.kt
index 46735bb2bce7..a4cd1cf9410c 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportReadyDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ExportReadyDialog.kt
@@ -31,7 +31,6 @@ import com.ichi2.utils.positiveButton
 
 class ExportReadyDialog(private val listener: ExportReadyDialogListener) : AsyncDialogFragment() {
     interface ExportReadyDialogListener {
-        fun dismissAllDialogFragments()
         fun shareFile(path: String) // path of the file to be shared
         fun saveExportFile(exportPath: String)
     }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ImportDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ImportDialog.kt
index a1326eb3efa2..8359008f63c0 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ImportDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/ImportDialog.kt
@@ -21,6 +21,7 @@ import androidx.annotation.CheckResult
 import androidx.annotation.VisibleForTesting
 import androidx.appcompat.app.AlertDialog
 import com.ichi2.anki.R
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 import com.ichi2.utils.negativeButton
 import com.ichi2.utils.positiveButton
 import timber.log.Timber
@@ -30,7 +31,6 @@ class ImportDialog : AsyncDialogFragment() {
     interface ImportDialogListener {
         fun importAdd(importPath: String)
         fun importReplace(importPath: String)
-        fun dismissAllDialogFragments()
     }
 
     override fun onCreateDialog(savedInstanceState: Bundle?): AlertDialog {
@@ -47,7 +47,7 @@ class ImportDialog : AsyncDialogFragment() {
                     .setMessage(res().getString(R.string.import_dialog_message_add, displayFileName))
                     .positiveButton(R.string.import_message_add) {
                         (activity as ImportDialogListener).importAdd(packagePath)
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .negativeButton(R.string.dialog_cancel)
                     .create()
@@ -57,7 +57,7 @@ class ImportDialog : AsyncDialogFragment() {
                     .setMessage(res().getString(R.string.import_message_replace_confirm, displayFileName))
                     .positiveButton(R.string.dialog_positive_replace) {
                         (activity as ImportDialogListener).importReplace(packagePath)
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .negativeButton(R.string.dialog_cancel)
                     .create()
@@ -87,10 +87,6 @@ class ImportDialog : AsyncDialogFragment() {
             return res().getString(R.string.import_title)
         }
 
-    fun dismissAllDialogFragments() {
-        (activity as ImportDialogListener).dismissAllDialogFragments()
-    }
-
     companion object {
         const val DIALOG_IMPORT_ADD_CONFIRM = 2
         const val DIALOG_IMPORT_REPLACE_CONFIRM = 3
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/MediaCheckDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/MediaCheckDialog.kt
index d2f53ea7bcc4..75b1f075a05e 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/MediaCheckDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/MediaCheckDialog.kt
@@ -17,6 +17,7 @@ import com.ichi2.anki.AnkiActivity
 import com.ichi2.anki.DeckPicker
 import com.ichi2.anki.R
 import com.ichi2.anki.showError
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 import com.ichi2.libanki.MediaCheckResult
 
 class MediaCheckDialog : AsyncDialogFragment() {
@@ -25,7 +26,6 @@ class MediaCheckDialog : AsyncDialogFragment() {
         fun showMediaCheckDialog(dialogType: Int, checkList: MediaCheckResult)
         fun mediaCheck()
         fun deleteUnused(unused: List<String>)
-        fun dismissAllDialogFragments()
     }
 
     override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
@@ -37,10 +37,10 @@ class MediaCheckDialog : AsyncDialogFragment() {
                 dialog.setMessage(notificationMessage)
                     .setPositiveButton(R.string.dialog_ok) { _, _ ->
                         (activity as MediaCheckDialogListener?)?.mediaCheck()
-                        (activity as MediaCheckDialogListener?)?.dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ ->
-                        (activity as MediaCheckDialogListener?)?.dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .create()
             }
@@ -88,15 +88,15 @@ class MediaCheckDialog : AsyncDialogFragment() {
                     fileListTextView.setTextIsSelectable(true)
                     dialog.setPositiveButton(R.string.check_media_delete_unused) { _, _ ->
                         (activity as MediaCheckDialogListener?)?.deleteUnused(unused)
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                         .setNegativeButton(R.string.dialog_cancel) { _, _ ->
-                            (activity as MediaCheckDialogListener?)?.dismissAllDialogFragments()
+                            activity?.dismissAllDialogFragments()
                         }
                 } else {
                     fileListTextView.visibility = View.GONE
                     dialog.setNegativeButton(R.string.dialog_ok) { _, _ ->
-                        (activity as MediaCheckDialogListener).dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                 }
                 dialog.setView(dialogBody)
@@ -107,10 +107,6 @@ class MediaCheckDialog : AsyncDialogFragment() {
         }
     }
 
-    fun dismissAllDialogFragments() {
-        (activity as MediaCheckDialogListener).dismissAllDialogFragments()
-    }
-
     override val notificationMessage: String
         get() {
             return when (requireArguments().getInt("dialogType")) {
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/SyncErrorDialog.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/SyncErrorDialog.kt
index 2934ac322d58..769970226362 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/SyncErrorDialog.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/SyncErrorDialog.kt
@@ -30,6 +30,7 @@ import com.ichi2.anki.DeckPicker
 import com.ichi2.anki.R
 import com.ichi2.anki.joinSyncMessages
 import com.ichi2.anki.showError
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 
 class SyncErrorDialog : AsyncDialogFragment() {
     interface SyncErrorDialogListener {
@@ -38,7 +39,6 @@ class SyncErrorDialog : AsyncDialogFragment() {
         fun loginToSyncServer()
         fun sync(conflict: ConflictResolution? = null)
         fun mediaCheck()
-        fun dismissAllDialogFragments()
         fun integrityCheck()
     }
 
@@ -62,10 +62,10 @@ class SyncErrorDialog : AsyncDialogFragment() {
                 dialog.setIcon(R.drawable.ic_sync_problem)
                     .setPositiveButton(R.string.retry) { _, _ ->
                         (activity as SyncErrorDialogListener).sync()
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ ->
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .create()
             }
@@ -81,7 +81,7 @@ class SyncErrorDialog : AsyncDialogFragment() {
                             ?.showSyncErrorDialog(DIALOG_SYNC_CONFLICT_CONFIRM_KEEP_REMOTE)
                     }
                     .setNeutralButton(R.string.dialog_cancel) { _, _ ->
-                        dismissAllDialogFragments()
+                        activity?.dismissAllDialogFragments()
                     }
                     .create()
             }
@@ -89,9 +89,8 @@ class SyncErrorDialog : AsyncDialogFragment() {
                 // Confirmation before pushing local collection to server after sync conflict
                 dialog.setIcon(R.drawable.ic_sync_problem)
                     .setPositiveButton(R.string.dialog_positive_replace) { _, _ ->
-                        val activity = activity as SyncErrorDialogListener?
-                        activity!!.sync(ConflictResolution.FULL_UPLOAD)
-                        dismissAllDialogFragments()
+                        (activity as SyncErrorDialogListener).sync(ConflictResolution.FULL_UPLOAD)
+                        activity?.dismissAllDialogFragments()
                     }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -100,9 +99,8 @@ class SyncErrorDialog : AsyncDialogFragment() {
                 // Confirmation before overwriting local collection with server collection after sync conflict
                 dialog.setIcon(R.drawable.ic_sync_problem)
                     .setPositiveButton(R.string.dialog_positive_replace) { _, _ ->
-                        val activity = activity as SyncErrorDialogListener?
-                        activity!!.sync(ConflictResolution.FULL_DOWNLOAD)
-                        dismissAllDialogFragments()
+                        (activity as SyncErrorDialogListener).sync(ConflictResolution.FULL_DOWNLOAD)
+                        activity?.dismissAllDialogFragments()
                     }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -124,7 +122,7 @@ class SyncErrorDialog : AsyncDialogFragment() {
                 // Confirmation before pushing local collection to server after sanity check error
                 dialog.setPositiveButton(R.string.dialog_positive_replace) { _, _ ->
                     (activity as SyncErrorDialogListener).sync(ConflictResolution.FULL_UPLOAD)
-                    dismissAllDialogFragments()
+                    activity?.dismissAllDialogFragments()
                 }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -133,7 +131,7 @@ class SyncErrorDialog : AsyncDialogFragment() {
                 // Confirmation before overwriting local collection with server collection after sanity check error
                 dialog.setPositiveButton(R.string.dialog_positive_replace) { _, _ ->
                     (activity as SyncErrorDialogListener).sync(ConflictResolution.FULL_DOWNLOAD)
-                    dismissAllDialogFragments()
+                    activity?.dismissAllDialogFragments()
                 }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -141,7 +139,7 @@ class SyncErrorDialog : AsyncDialogFragment() {
             DIALOG_MEDIA_SYNC_ERROR -> {
                 dialog.setPositiveButton(R.string.check_media) { _, _ ->
                     (activity as SyncErrorDialogListener).mediaCheck()
-                    dismissAllDialogFragments()
+                    activity?.dismissAllDialogFragments()
                 }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -157,7 +155,7 @@ class SyncErrorDialog : AsyncDialogFragment() {
             DIALOG_SYNC_BASIC_CHECK_ERROR -> {
                 dialog.setPositiveButton(R.string.check_db) { _, _ ->
                     (activity as SyncErrorDialogListener).integrityCheck()
-                    dismissAllDialogFragments()
+                    activity?.dismissAllDialogFragments()
                 }
                     .setNegativeButton(R.string.dialog_cancel) { _, _ -> }
                     .create()
@@ -225,10 +223,6 @@ class SyncErrorDialog : AsyncDialogFragment() {
             return SyncErrorDialogMessageHandler(dialogType, dialogMessage)
         }
 
-    fun dismissAllDialogFragments() {
-        (activity as SyncErrorDialogListener).dismissAllDialogFragments()
-    }
-
     companion object {
         const val DIALOG_USER_NOT_LOGGED_IN_SYNC = 0
         const val DIALOG_CONNECTION_ERROR = 1
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.kt b/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.kt
index ef5647b473dd..6d5805baea63 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/export/ActivityExportingDelegate.kt
@@ -62,7 +62,7 @@ class ActivityExportingDelegate(private val activity: AnkiActivity, private val
     private val saveFileLauncher: ActivityResultLauncher<Intent>
     private lateinit var fileExportPath: String
 
-    override fun dismissAllDialogFragments() {
+    fun dismissAllDialogFragments() {
         activity.dismissAllDialogFragments()
     }
 
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/DeckPickerTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/DeckPickerTest.kt
index 40d59a10e600..56d6d9105f2c 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/DeckPickerTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/DeckPickerTest.kt
@@ -19,6 +19,7 @@ import com.ichi2.anki.dialogs.DeckPickerContextMenu.DeckPickerContextMenuOption
 import com.ichi2.anki.dialogs.utils.title
 import com.ichi2.anki.exception.UnknownDatabaseVersionException
 import com.ichi2.anki.preferences.sharedPrefs
+import com.ichi2.anki.utils.ext.dismissAllDialogFragments
 import com.ichi2.annotations.NeedsTest
 import com.ichi2.libanki.DeckId
 import com.ichi2.libanki.Storage
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/dialogs/AsyncDialogFragmentsTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/dialogs/AsyncDialogFragmentsTest.kt
index 4a205714fb27..2eb2d73af888 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/dialogs/AsyncDialogFragmentsTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/dialogs/AsyncDialogFragmentsTest.kt
@@ -70,8 +70,6 @@ class AsyncDialogFragmentsTest {
 
     private fun emptyExportListener(): ExportReadyDialog.ExportReadyDialogListener {
         return object : ExportReadyDialog.ExportReadyDialogListener {
-            override fun dismissAllDialogFragments() { }
-
             override fun shareFile(path: String) { }
 
             override fun saveExportFile(exportPath: String) { }
