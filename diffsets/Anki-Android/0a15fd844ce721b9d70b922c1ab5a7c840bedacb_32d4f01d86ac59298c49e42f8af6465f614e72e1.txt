diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.kt b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.kt
index f5293eabd5a8..dcd8c847147a 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.kt
@@ -1638,7 +1638,6 @@ abstract class AbstractFlashcardViewer :
         return if (isControlBlocked() && which !== ViewerCommand.EXIT) {
             false
         } else when (which) {
-            ViewerCommand.NOTHING -> true
             ViewerCommand.SHOW_ANSWER -> {
                 if (sDisplayAnswer) {
                     return false
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/Preferences.kt b/AnkiDroid/src/main/java/com/ichi2/anki/Preferences.kt
index 8dafebe818b6..b2da39eeb7b8 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/Preferences.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/Preferences.kt
@@ -418,6 +418,14 @@ class Preferences : AnkiActivity() {
                 getString(R.string.notification_minimum_cards_due_blink),
             )
 
+            // Controls preferences summary
+            findPreference<Preference>(getString(R.string.pref_controls_screen_key))!!
+                .summary = buildCategorySummary(
+                getString(R.string.pref_cat_gestures),
+                getString(R.string.keyboard),
+                getString(R.string.bluetooth)
+            )
+
             if (isRestrictedLearningDevice) {
                 findPreference<Preference>("pref_screen_advanced")!!.isVisible = false
             }
@@ -643,9 +651,6 @@ class Preferences : AnkiActivity() {
                     }
                     CardBrowserContextMenu.CARD_BROWSER_CONTEXT_MENU_PREF_KEY -> CardBrowserContextMenu.ensureConsistentStateWithSharedPreferences(preferencesActivity)
                     AnkiCardContextMenu.ANKI_CARD_CONTEXT_MENU_PREF_KEY -> AnkiCardContextMenu.ensureConsistentStateWithSharedPreferences(preferencesActivity)
-                    "gestureCornerTouch" -> {
-                        GesturesSettingsFragment.updateGestureCornerTouch(preferencesActivity, screen)
-                    }
                 }
                 // Update the summary text to reflect new value
                 preferencesActivity.updateSummary(pref)
@@ -994,40 +999,6 @@ class Preferences : AnkiActivity() {
         }
     }
 
-    class GesturesSettingsFragment : SpecificSettingsFragment() {
-        override val preferenceResource: Int
-            get() = R.xml.preferences_gestures
-        override val analyticsScreenNameConstant: String
-            get() = "prefs.gestures"
-
-        override fun initSubscreen() {
-            addPreferencesFromResource(R.xml.preferences_gestures)
-            val screen = preferenceScreen
-            updateGestureCornerTouch(screen)
-        }
-
-        private fun updateGestureCornerTouch(screen: PreferenceScreen) {
-            updateGestureCornerTouch(requireContext(), screen)
-        }
-
-        companion object {
-            fun updateGestureCornerTouch(context: Context?, screen: PreferenceScreen) {
-                val gestureCornerTouch = AnkiDroidApp.getSharedPrefs(context).getBoolean("gestureCornerTouch", false)
-                if (gestureCornerTouch) {
-                    requirePreference<Preference>(screen, "gestureTapTop").setTitle(R.string.gestures_corner_tap_top_center)
-                    requirePreference<Preference>(screen, "gestureTapLeft").setTitle(R.string.gestures_corner_tap_middle_left)
-                    requirePreference<Preference>(screen, "gestureTapRight").setTitle(R.string.gestures_corner_tap_middle_right)
-                    requirePreference<Preference>(screen, "gestureTapBottom").setTitle(R.string.gestures_corner_tap_bottom_center)
-                } else {
-                    requirePreference<Preference>(screen, "gestureTapTop").setTitle(R.string.gestures_tap_top)
-                    requirePreference<Preference>(screen, "gestureTapLeft").setTitle(R.string.gestures_tap_left)
-                    requirePreference<Preference>(screen, "gestureTapRight").setTitle(R.string.gestures_tap_right)
-                    requirePreference<Preference>(screen, "gestureTapBottom").setTitle(R.string.gestures_tap_bottom)
-                }
-            }
-        }
-    }
-
     class AdvancedSettingsFragment : SpecificSettingsFragment() {
         override val preferenceResource: Int
             get() = R.xml.preferences_advanced
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/Gesture.kt b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/Gesture.kt
index 1a8fc13e63ae..d351f9fab646 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/Gesture.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/Gesture.kt
@@ -35,35 +35,24 @@ fun interface GestureListener {
     fun onGesture(gesture: Gesture)
 }
 
-// TODO: Code and preference defaults are inconsistent: #8066
 enum class Gesture(
     @get:JvmName("getResourceId") val resourceId: Int,
-    private val preferenceKey: String,
-    private val preferenceDefault: ViewerCommand
 ) {
-    SWIPE_UP(R.string.gestures_swipe_up, "gestureSwipeUp", ViewerCommand.EDIT),
-    SWIPE_DOWN(R.string.gestures_swipe_down, "gestureSwipeDown", ViewerCommand.NOTHING),
-    SWIPE_LEFT(R.string.gestures_swipe_left, "gestureSwipeLeft", ViewerCommand.UNDO),
-    SWIPE_RIGHT(R.string.gestures_swipe_right, "gestureSwipeRight", ViewerCommand.EXIT),
-    LONG_TAP(R.string.gestures_long_tap, "gestureLongclick", ViewerCommand.NOTHING),
-    DOUBLE_TAP(R.string.gestures_double_tap, "gestureDoubleTap", ViewerCommand.FLIP_OR_ANSWER_BETTER_THAN_RECOMMENDED),
-    TAP_TOP_LEFT(R.string.gestures_corner_tap_top_left, "gestureTapTopLeft", ViewerCommand.NOTHING),
-    TAP_TOP(R.string.gestures_tap_top, "gestureTapTop", ViewerCommand.BURY_CARD),
-    TAP_TOP_RIGHT(R.string.gestures_corner_tap_top_right, "gestureTapTopRight", ViewerCommand.NOTHING),
-    TAP_LEFT(R.string.gestures_tap_left, "gestureTapLeft", ViewerCommand.FLIP_OR_ANSWER_EASE2),
-    TAP_CENTER(R.string.gestures_corner_tap_middle_center, "gestureTapCenter", ViewerCommand.NOTHING),
-    TAP_RIGHT(R.string.gestures_tap_right, "gestureTapRight", ViewerCommand.FLIP_OR_ANSWER_RECOMMENDED),
-    TAP_BOTTOM_LEFT(R.string.gestures_corner_tap_bottom_left, "gestureTapBottomLeft", ViewerCommand.NOTHING),
-    TAP_BOTTOM(R.string.gestures_tap_bottom, "gestureTapBottom", ViewerCommand.FLIP_OR_ANSWER_EASE1),
-    TAP_BOTTOM_RIGHT(R.string.gestures_corner_tap_bottom_right, "gestureTapBottomRight", ViewerCommand.NOTHING);
-
-    fun fromPreference(prefs: SharedPreferences): ViewerCommand {
-        val value = prefs.getString(preferenceKey, null) ?: return preferenceDefault
-
-        val valueAsInt = Integer.parseInt(value)
-
-        return ViewerCommand.fromInt(valueAsInt) ?: preferenceDefault
-    }
+    SWIPE_UP(R.string.gestures_swipe_up),
+    SWIPE_DOWN(R.string.gestures_swipe_down),
+    SWIPE_LEFT(R.string.gestures_swipe_left),
+    SWIPE_RIGHT(R.string.gestures_swipe_right),
+    LONG_TAP(R.string.gestures_long_tap),
+    DOUBLE_TAP(R.string.gestures_double_tap),
+    TAP_TOP_LEFT(R.string.gestures_corner_tap_top_left),
+    TAP_TOP(R.string.gestures_tap_top),
+    TAP_TOP_RIGHT(R.string.gestures_corner_tap_top_right),
+    TAP_LEFT(R.string.gestures_tap_left),
+    TAP_CENTER(R.string.gestures_corner_tap_middle_center),
+    TAP_RIGHT(R.string.gestures_tap_right),
+    TAP_BOTTOM_LEFT(R.string.gestures_corner_tap_bottom_left),
+    TAP_BOTTOM(R.string.gestures_tap_bottom),
+    TAP_BOTTOM_RIGHT(R.string.gestures_corner_tap_bottom_right);
 
     fun toDisplayString(context: Context): String =
         getDisplayPrefix() + ' ' + context.getString(resourceId)
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/GestureProcessor.kt b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/GestureProcessor.kt
index c01a9cc19d6d..66e556b6d5da 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/GestureProcessor.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/GestureProcessor.kt
@@ -16,8 +16,8 @@
 package com.ichi2.anki.cardviewer
 
 import android.content.SharedPreferences
-import com.ichi2.anki.cardviewer.ViewerCommand.NOTHING
 import com.ichi2.anki.reviewer.GestureMapper
+import com.ichi2.anki.reviewer.MappableBinding
 
 class GestureProcessor(private val processor: ViewerCommand.CommandProcessor?) {
     companion object {
@@ -50,24 +50,33 @@ class GestureProcessor(private val processor: ViewerCommand.CommandProcessor?) {
 
     fun init(preferences: SharedPreferences) {
         isEnabled = preferences.getBoolean(PREF_KEY, false)
-        gestureDoubleTap = Gesture.DOUBLE_TAP.fromPreference(preferences)
-        gestureLongclick = Gesture.LONG_TAP.fromPreference(preferences)
-        gestureSwipeUp = Gesture.SWIPE_UP.fromPreference(preferences)
-        gestureSwipeDown = Gesture.SWIPE_DOWN.fromPreference(preferences)
-        gestureSwipeLeft = Gesture.SWIPE_LEFT.fromPreference(preferences)
-        gestureSwipeRight = Gesture.SWIPE_RIGHT.fromPreference(preferences)
+
+        val associatedCommands = HashMap<Gesture, ViewerCommand>()
+        for (command in ViewerCommand.values()) {
+            for (mappableBinding in MappableBinding.fromPreference(preferences, command)) {
+                if (mappableBinding.binding.isGesture)
+                    associatedCommands[mappableBinding.binding.gesture!!] = command
+            }
+        }
+        gestureDoubleTap = associatedCommands[Gesture.DOUBLE_TAP]
+        gestureLongclick = associatedCommands[Gesture.LONG_TAP]
+        gestureSwipeUp = associatedCommands[Gesture.SWIPE_UP]
+        gestureSwipeDown = associatedCommands[Gesture.SWIPE_DOWN]
+        gestureSwipeLeft = associatedCommands[Gesture.SWIPE_LEFT]
+        gestureSwipeRight = associatedCommands[Gesture.SWIPE_RIGHT]
         gestureMapper.init(preferences)
-        gestureTapLeft = Gesture.TAP_LEFT.fromPreference(preferences)
-        gestureTapRight = Gesture.TAP_RIGHT.fromPreference(preferences)
-        gestureTapTop = Gesture.TAP_TOP.fromPreference(preferences)
-        gestureTapBottom = Gesture.TAP_BOTTOM.fromPreference(preferences)
+        gestureTapLeft = associatedCommands[Gesture.TAP_LEFT]
+        gestureTapRight = associatedCommands[Gesture.TAP_RIGHT]
+        gestureTapTop = associatedCommands[Gesture.TAP_TOP]
+        gestureTapBottom = associatedCommands[Gesture.TAP_BOTTOM]
+
         val useCornerTouch = preferences.getBoolean("gestureCornerTouch", false)
         if (useCornerTouch) {
-            gestureTapTopLeft = Gesture.TAP_TOP_LEFT.fromPreference(preferences)
-            gestureTapTopRight = Gesture.TAP_TOP_RIGHT.fromPreference(preferences)
-            gestureTapCenter = Gesture.TAP_CENTER.fromPreference(preferences)
-            gestureTapBottomLeft = Gesture.TAP_BOTTOM_LEFT.fromPreference(preferences)
-            gestureTapBottomRight = Gesture.TAP_BOTTOM_RIGHT.fromPreference(preferences)
+            gestureTapTopLeft = associatedCommands[Gesture.TAP_TOP_LEFT]
+            gestureTapTopRight = associatedCommands[Gesture.TAP_TOP_RIGHT]
+            gestureTapCenter = associatedCommands[Gesture.TAP_CENTER]
+            gestureTapBottomLeft = associatedCommands[Gesture.TAP_BOTTOM_LEFT]
+            gestureTapBottomRight = associatedCommands[Gesture.TAP_BOTTOM_RIGHT]
         }
     }
 
@@ -115,7 +124,7 @@ class GestureProcessor(private val processor: ViewerCommand.CommandProcessor?) {
             Gesture.TAP_BOTTOM_RIGHT -> gestureTapBottomRight
             Gesture.DOUBLE_TAP -> gestureDoubleTap
             Gesture.LONG_TAP -> gestureLongclick
-            else -> NOTHING
+            else -> null
         }
     }
 
@@ -129,7 +138,7 @@ class GestureProcessor(private val processor: ViewerCommand.CommandProcessor?) {
             return false
         }
         for (gesture in gestures) {
-            if (mapGestureToCommand(gesture) != NOTHING) {
+            if (mapGestureToCommand(gesture) != null) {
                 return true
             }
         }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/ViewerCommand.kt b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/ViewerCommand.kt
index f232682b7ea4..2469f882219f 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/ViewerCommand.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/cardviewer/ViewerCommand.kt
@@ -17,6 +17,7 @@ package com.ichi2.anki.cardviewer
 
 import android.content.SharedPreferences
 import android.view.KeyEvent
+import androidx.core.content.edit
 import com.ichi2.anki.R
 import com.ichi2.anki.reviewer.Binding.Companion.keyCode
 import com.ichi2.anki.reviewer.Binding.Companion.unicode
@@ -32,60 +33,51 @@ import java.util.function.BiFunction
 import java.util.stream.Collectors
 
 /** Abstraction: Discuss moving many of these to 'Reviewer'  */
-enum class ViewerCommand(val resourceId: Int, private val preferenceValue: Int) {
-    NOTHING(R.string.nothing, 0),
-    SHOW_ANSWER(R.string.show_answer, 1),
-    FLIP_OR_ANSWER_EASE1(R.string.gesture_answer_1, 2),
-    FLIP_OR_ANSWER_EASE2(R.string.gesture_answer_2, 3),
-    FLIP_OR_ANSWER_EASE3(R.string.gesture_answer_3, 4),
-    FLIP_OR_ANSWER_EASE4(R.string.gesture_answer_4, 5),
-    FLIP_OR_ANSWER_RECOMMENDED(R.string.gesture_answer_green, 6),
-    FLIP_OR_ANSWER_BETTER_THAN_RECOMMENDED(R.string.gesture_answer_better_recommended, 7),
-    UNDO(R.string.undo, 8),
-    EDIT(R.string.cardeditor_title_edit_card, 9),
-    MARK(R.string.menu_mark_note, 10),
-    BURY_CARD(R.string.menu_bury, 12),
-    SUSPEND_CARD(R.string.menu_suspend_card, 13),
-    DELETE(R.string.menu_delete_note, 14), // 15 is unused.
-    PLAY_MEDIA(R.string.gesture_play, 16),
-    EXIT(R.string.gesture_abort_learning, 17),
-    BURY_NOTE(R.string.menu_bury_note, 18),
-    SUSPEND_NOTE(R.string.menu_suspend_note, 19),
-    TOGGLE_FLAG_RED(R.string.gesture_flag_red, 20),
-    TOGGLE_FLAG_ORANGE(R.string.gesture_flag_orange, 21),
-    TOGGLE_FLAG_GREEN(R.string.gesture_flag_green, 22),
-    TOGGLE_FLAG_BLUE(R.string.gesture_flag_blue, 23),
-    TOGGLE_FLAG_PINK(R.string.gesture_flag_pink, 38),
-    TOGGLE_FLAG_TURQUOISE(R.string.gesture_flag_turquoise, 39),
-    TOGGLE_FLAG_PURPLE(R.string.gesture_flag_purple, 40),
-    UNSET_FLAG(R.string.gesture_flag_remove, 24),
-    PAGE_UP(R.string.gesture_page_up, 30),
-    PAGE_DOWN(R.string.gesture_page_down, 31),
-    TAG(R.string.add_tag, 32),
-    CARD_INFO(R.string.card_info_title, 33),
-    ABORT_AND_SYNC(R.string.gesture_abort_sync, 34),
-    RECORD_VOICE(R.string.record_voice, 35),
-    REPLAY_VOICE(R.string.replay_voice, 36),
-    TOGGLE_WHITEBOARD(R.string.gesture_toggle_whiteboard, 37),
-    SHOW_HINT(R.string.gesture_show_hint, 41),
-    SHOW_ALL_HINTS(R.string.gesture_show_all_hints, 42),
-    ADD_NOTE(R.string.menu_add_note, 43);
+enum class ViewerCommand(val resourceId: Int) {
+    SHOW_ANSWER(R.string.show_answer),
+    FLIP_OR_ANSWER_EASE1(R.string.gesture_answer_1),
+    FLIP_OR_ANSWER_EASE2(R.string.gesture_answer_2),
+    FLIP_OR_ANSWER_EASE3(R.string.gesture_answer_3),
+    FLIP_OR_ANSWER_EASE4(R.string.gesture_answer_4),
+    FLIP_OR_ANSWER_RECOMMENDED(R.string.gesture_answer_green),
+    FLIP_OR_ANSWER_BETTER_THAN_RECOMMENDED(R.string.gesture_answer_better_recommended),
+    UNDO(R.string.undo),
+    EDIT(R.string.cardeditor_title_edit_card),
+    MARK(R.string.menu_mark_note),
+    BURY_CARD(R.string.menu_bury),
+    SUSPEND_CARD(R.string.menu_suspend_card),
+    DELETE(R.string.menu_delete_note),
+    PLAY_MEDIA(R.string.gesture_play),
+    EXIT(R.string.gesture_abort_learning),
+    BURY_NOTE(R.string.menu_bury_note),
+    SUSPEND_NOTE(R.string.menu_suspend_note),
+    TOGGLE_FLAG_RED(R.string.gesture_flag_red),
+    TOGGLE_FLAG_ORANGE(R.string.gesture_flag_orange),
+    TOGGLE_FLAG_GREEN(R.string.gesture_flag_green),
+    TOGGLE_FLAG_BLUE(R.string.gesture_flag_blue),
+    TOGGLE_FLAG_PINK(R.string.gesture_flag_pink),
+    TOGGLE_FLAG_TURQUOISE(R.string.gesture_flag_turquoise),
+    TOGGLE_FLAG_PURPLE(R.string.gesture_flag_purple),
+    UNSET_FLAG(R.string.gesture_flag_remove),
+    PAGE_UP(R.string.gesture_page_up),
+    PAGE_DOWN(R.string.gesture_page_down),
+    TAG(R.string.add_tag),
+    CARD_INFO(R.string.card_info_title),
+    ABORT_AND_SYNC(R.string.gesture_abort_sync),
+    RECORD_VOICE(R.string.record_voice),
+    REPLAY_VOICE(R.string.replay_voice),
+    TOGGLE_WHITEBOARD(R.string.gesture_toggle_whiteboard),
+    SHOW_HINT(R.string.gesture_show_hint),
+    SHOW_ALL_HINTS(R.string.gesture_show_all_hints),
+    ADD_NOTE(R.string.menu_add_note);
 
     companion object {
-        fun fromInt(valueAsInt: Int): ViewerCommand? =
-            // PERF: this is slow, but won't be used for long
-            values().firstOrNull { it.preferenceValue == valueAsInt }
-
         val allDefaultBindings: List<MappableBinding>
             get() = Arrays.stream(values())
                 .flatMap { x: ViewerCommand -> x.defaultValue.stream() }
                 .collect(Collectors.toList())
     }
 
-    fun toPreferenceString(): String {
-        return preferenceValue.toString()
-    }
-
     val preferenceKey: String
         get() = "binding_$name"
 
@@ -112,15 +104,20 @@ enum class ViewerCommand(val resourceId: Int, private val preferenceValue: Int)
     }
 
     private fun addBindingInternal(preferences: SharedPreferences, binding: MappableBinding, performAdd: BiFunction<MutableList<MappableBinding>, MappableBinding, Boolean>) {
-        if (this == NOTHING) {
-            return
-        }
         val bindings: MutableList<MappableBinding> = fromPreference(preferences, this)
         performAdd.apply(bindings, binding)
         val newValue: String = bindings.toPreferenceString()
         preferences.edit().putString(preferenceKey, newValue).apply()
     }
 
+    fun removeBinding(prefs: SharedPreferences, binding: MappableBinding) {
+        val bindings: MutableList<MappableBinding> = MappableBinding.fromPreferenceString(preferenceKey)
+        bindings.remove(binding)
+        prefs.edit {
+            putString(preferenceKey, bindings.toPreferenceString())
+        }
+    }
+
     // If we use the serialised format, then this adds additional coupling to the properties.
     val defaultValue: List<MappableBinding>
         get() = // If we use the serialised format, then this adds additional coupling to the properties.
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/GestureSelectionDialogBuilder.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/GestureSelectionDialogBuilder.kt
index f9bf56101e37..0e1a3ae911d5 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/GestureSelectionDialogBuilder.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/GestureSelectionDialogBuilder.kt
@@ -23,7 +23,7 @@ import com.ichi2.ui.GesturePicker
 
 /** Helper functions for a Dialog which wraps a [com.ichi2.ui.GesturePicker]  */
 class GestureSelectionDialogBuilder(context: Context) : MaterialDialog.Builder(context) {
-    private val mGesturePicker: GesturePicker = GesturePicker(context)
+    val mGesturePicker: GesturePicker = GesturePicker(context)
 
     /** Supplies a callback which is called each time the user gesture selection changes
      *
@@ -33,15 +33,6 @@ class GestureSelectionDialogBuilder(context: Context) : MaterialDialog.Builder(c
         return this
     }
 
-    /** Supplies a callback which is called when the user presses "OK" with a valid gesture */
-    fun onGestureSubmitted(listener: GestureListener): GestureSelectionDialogBuilder {
-        onPositive { _, _ ->
-            val gesture = mGesturePicker.getGesture() ?: return@onPositive
-            listener.onGesture(gesture)
-        }
-        return this
-    }
-
     init {
         positiveText(R.string.dialog_ok)
         title(R.string.binding_add_gesture)
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/KeySelectionDialogBuilder.kt b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/KeySelectionDialogBuilder.kt
index 37418e3f84c1..48a25a9b01cf 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/KeySelectionDialogBuilder.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/dialogs/KeySelectionDialogBuilder.kt
@@ -26,7 +26,7 @@ import com.ichi2.ui.KeyPicker
 typealias KeyCode = Int
 
 class KeySelectionDialogBuilder(context: Context) : MaterialDialog.Builder(context) {
-    private val mKeyPicker: KeyPicker = KeyPicker.inflate(context)
+    val mKeyPicker: KeyPicker = KeyPicker.inflate(context)
 
     /** Supplies a callback which is called each time the user presses a key
      *
@@ -36,15 +36,6 @@ class KeySelectionDialogBuilder(context: Context) : MaterialDialog.Builder(conte
         return this
     }
 
-    /** Supplies a callback to be called when the user presses "OK" with a valid binding */
-    fun onBindingSubmitted(listener: (Binding) -> Unit): KeySelectionDialogBuilder {
-        onPositive { _, _ ->
-            val binding = mKeyPicker.getBinding() ?: return@onPositive
-            listener(binding)
-        }
-        return this
-    }
-
     fun disallowModifierKeys(): KeySelectionDialogBuilder {
         mKeyPicker.setKeycodeValidation(disallowModifierKeyCodes())
         return this
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/Binding.kt b/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/Binding.kt
index 1638cad6565b..35fcb2f4a6e3 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/Binding.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/Binding.kt
@@ -17,7 +17,6 @@ package com.ichi2.anki.reviewer
 
 import android.content.Context
 import android.os.Build
-import android.text.TextUtils
 import android.util.Pair
 import android.view.KeyEvent
 import androidx.annotation.VisibleForTesting
@@ -28,6 +27,7 @@ import timber.log.Timber
 import java.util.*
 
 class Binding private constructor(val modifierKeys: ModifierKeys?, val keycode: Int?, val unicodeCharacter: Char?, val gesture: Gesture?) {
+    constructor(gesture: Gesture?) : this(null, null, null, gesture)
 
     private fun getKeyCodePrefix(): String {
         // KEY_PREFIX is not usable before API 23
@@ -253,7 +253,7 @@ class Binding private constructor(val modifierKeys: ModifierKeys?, val keycode:
         fun unknown(): Binding = Binding(ModifierKeys.none(), null, null, null)
 
         fun fromString(from: String): Binding {
-            if (TextUtils.isEmpty(from)) return unknown()
+            if (from.isEmpty()) return unknown()
             try {
                 return when (from[0]) {
                     GESTURE_PREFIX -> {
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/MappableBinding.kt b/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/MappableBinding.kt
index 58dd1b08a483..d7502f32199f 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/MappableBinding.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/reviewer/MappableBinding.kt
@@ -20,6 +20,7 @@ import android.content.Context
 import android.content.SharedPreferences
 import androidx.annotation.CheckResult
 import com.ichi2.anki.R
+import com.ichi2.anki.cardviewer.Gesture
 import com.ichi2.anki.cardviewer.ViewerCommand
 import timber.log.Timber
 import java.util.*
@@ -155,7 +156,10 @@ class MappableBinding(val binding: Binding, private val screen: Screen) {
         const val PREF_SEPARATOR = '|'
 
         @CheckResult
-        fun fromGesture(b: Binding): MappableBinding = MappableBinding(b, Screen.Reviewer(CardSide.BOTH))
+        fun fromGesture(gesture: Gesture): MappableBinding = MappableBinding(Binding(gesture), Screen.Reviewer(CardSide.BOTH))
+
+        @CheckResult
+        fun fromGestureBinding(b: Binding): MappableBinding = MappableBinding(b, Screen.Reviewer(CardSide.BOTH))
 
         @CheckResult
         fun List<MappableBinding>.toPreferenceString(): String = this.mapNotNull { it.toPreferenceString() }
diff --git a/AnkiDroid/src/main/java/com/ichi2/anki/servicelayer/PreferenceUpgradeService.kt b/AnkiDroid/src/main/java/com/ichi2/anki/servicelayer/PreferenceUpgradeService.kt
index b56a976f6cb0..a6881cb2bb8f 100644
--- a/AnkiDroid/src/main/java/com/ichi2/anki/servicelayer/PreferenceUpgradeService.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/anki/servicelayer/PreferenceUpgradeService.kt
@@ -21,8 +21,10 @@ import android.view.KeyEvent
 import androidx.annotation.VisibleForTesting
 import androidx.core.content.edit
 import com.ichi2.anki.AnkiDroidApp
+import com.ichi2.anki.cardviewer.Gesture
 import com.ichi2.anki.cardviewer.ViewerCommand
 import com.ichi2.anki.noteeditor.CustomToolbarButton
+import com.ichi2.anki.reviewer.Binding
 import com.ichi2.anki.reviewer.Binding.Companion.keyCode
 import com.ichi2.anki.reviewer.CardSide
 import com.ichi2.anki.reviewer.FullScreenMode
@@ -74,13 +76,14 @@ object PreferenceUpgradeService {
         companion object {
             /** A version code where the value doesn't matter as we're not using the result */
             private const val IGNORED_LEGACY_VERSION_CODE = 0L
+            const val upgradeVersionPrefKey = "preferenceUpgradeVersion"
 
             /** Returns all instances of preference upgrade classes */
             internal fun getAllInstances(legacyPreviousVersionCode: LegacyVersionIdentifier) = sequence<PreferenceUpgrade> {
                 yield(LegacyPreferenceUpgrade(legacyPreviousVersionCode))
-                yield(UpgradeVolumeButtonsToBindings())
                 yield(RemoveLegacyMediaSyncUrl())
                 yield(UpdateNoteEditorToolbarPrefs())
+                yield(UpgradeGesturesToControls())
             }
 
             /** Returns a list of preference upgrade classes which have not been applied */
@@ -99,11 +102,11 @@ object PreferenceUpgradeService {
             }
 
             internal fun getPreferenceVersion(preferences: SharedPreferences) =
-                preferences.getInt("preferenceUpgradeVersion", 0)
+                preferences.getInt(upgradeVersionPrefKey, 0)
 
             internal fun setPreferenceVersion(preferences: SharedPreferences, versionIdentifier: VersionIdentifier) {
                 Timber.i("upgrading preference version to '$versionIdentifier'")
-                preferences.edit { putInt("preferenceUpgradeVersion", versionIdentifier) }
+                preferences.edit { putInt(upgradeVersionPrefKey, versionIdentifier) }
             }
 
             /** Returns the collection of all preference version numbers */
@@ -167,52 +170,6 @@ object PreferenceUpgradeService {
             }
         }
 
-        @VisibleForTesting
-        internal class UpgradeVolumeButtonsToBindings : PreferenceUpgrade(2) {
-            override fun upgrade(preferences: SharedPreferences) {
-                upgradeVolumeGestureToKeyBind(preferences, "gestureVolumeUp", KeyEvent.KEYCODE_VOLUME_UP)
-                upgradeVolumeGestureToKeyBind(preferences, "gestureVolumeDown", KeyEvent.KEYCODE_VOLUME_DOWN)
-            }
-
-            @VisibleForTesting
-            internal fun upgradeVolumeGestureToKeyBind(preferences: SharedPreferences, oldGesturePreferenceKey: String, volumeKeyCode: Int) {
-                Timber.d("Replacing gesture '%s' with binding", oldGesturePreferenceKey)
-
-                // This exists as a user may have mapped "volume down" to "UNDO".
-                // Undo already exists as a key binding, and we don't want to trash this during an upgrade
-                if (!preferences.contains(oldGesturePreferenceKey)) {
-                    Timber.v("No preference to upgrade")
-                    return
-                }
-
-                try {
-                    replaceGestureWithBinding(preferences, oldGesturePreferenceKey, volumeKeyCode)
-                } finally {
-                    Timber.v("removing pref key: '%s'", oldGesturePreferenceKey)
-                    // remove the old key
-                    preferences.edit { remove(oldGesturePreferenceKey) }
-                }
-            }
-
-            private fun replaceGestureWithBinding(preferences: SharedPreferences, oldGesturePreferenceKey: String, volumeKeyCode: Int) {
-                // the preference should be set, but if it's null, then we have nothing to do
-                val gesture = preferences.getString(oldGesturePreferenceKey, "0") ?: return
-                // If the preference doesn't map (for example: it was removed), then nothing to do
-                val asInt = gesture.toIntOrNull() ?: return
-                val command = ViewerCommand.fromInt(asInt) ?: return
-
-                if (command == ViewerCommand.NOTHING) {
-                    return
-                }
-
-                Timber.i("Moving preference from '%s' to '%s'", oldGesturePreferenceKey, command.preferenceKey)
-
-                // add to the binding_COMMANDNAME preference
-                val binding = MappableBinding(keyCode(volumeKeyCode), MappableBinding.Screen.Reviewer(CardSide.BOTH))
-                command.addBindingAtEnd(preferences, binding)
-            }
-        }
-
         fun performUpgrade(preferences: SharedPreferences) {
             Timber.i("Running preference upgrade: ${this.javaClass.simpleName}")
             upgrade(preferences)
@@ -279,5 +236,108 @@ object PreferenceUpgradeService {
                 return buttons
             }
         }
+
+        internal class UpgradeGesturesToControls : PreferenceUpgrade(5) {
+            val oldCommandValues = mapOf(
+                Pair(1, ViewerCommand.SHOW_ANSWER),
+                Pair(2, ViewerCommand.FLIP_OR_ANSWER_EASE1),
+                Pair(3, ViewerCommand.FLIP_OR_ANSWER_EASE2),
+                Pair(4, ViewerCommand.FLIP_OR_ANSWER_EASE3),
+                Pair(5, ViewerCommand.FLIP_OR_ANSWER_EASE4),
+                Pair(6, ViewerCommand.FLIP_OR_ANSWER_RECOMMENDED),
+                Pair(7, ViewerCommand.FLIP_OR_ANSWER_BETTER_THAN_RECOMMENDED),
+                Pair(8, ViewerCommand.UNDO),
+                Pair(9, ViewerCommand.EDIT),
+                Pair(10, ViewerCommand.MARK),
+                Pair(12, ViewerCommand.BURY_CARD),
+                Pair(13, ViewerCommand.SUSPEND_CARD),
+                Pair(14, ViewerCommand.DELETE),
+                Pair(16, ViewerCommand.PLAY_MEDIA),
+                Pair(17, ViewerCommand.EXIT),
+                Pair(18, ViewerCommand.BURY_NOTE),
+                Pair(19, ViewerCommand.SUSPEND_NOTE),
+                Pair(20, ViewerCommand.TOGGLE_FLAG_RED),
+                Pair(21, ViewerCommand.TOGGLE_FLAG_ORANGE),
+                Pair(22, ViewerCommand.TOGGLE_FLAG_GREEN),
+                Pair(23, ViewerCommand.TOGGLE_FLAG_BLUE),
+                Pair(38, ViewerCommand.TOGGLE_FLAG_PINK),
+                Pair(39, ViewerCommand.TOGGLE_FLAG_TURQUOISE),
+                Pair(40, ViewerCommand.TOGGLE_FLAG_PURPLE),
+                Pair(24, ViewerCommand.UNSET_FLAG),
+                Pair(30, ViewerCommand.PAGE_UP),
+                Pair(31, ViewerCommand.PAGE_DOWN),
+                Pair(32, ViewerCommand.TAG),
+                Pair(33, ViewerCommand.CARD_INFO),
+                Pair(34, ViewerCommand.ABORT_AND_SYNC),
+                Pair(35, ViewerCommand.RECORD_VOICE),
+                Pair(36, ViewerCommand.REPLAY_VOICE),
+                Pair(37, ViewerCommand.TOGGLE_WHITEBOARD),
+                Pair(41, ViewerCommand.SHOW_HINT),
+                Pair(42, ViewerCommand.SHOW_ALL_HINTS),
+                Pair(43, ViewerCommand.ADD_NOTE),
+            )
+
+            override fun upgrade(preferences: SharedPreferences) {
+                upgradeGestureToBinding(preferences, "gestureSwipeUp", Gesture.SWIPE_UP)
+                upgradeGestureToBinding(preferences, "gestureSwipeDown", Gesture.SWIPE_DOWN)
+                upgradeGestureToBinding(preferences, "gestureSwipeLeft", Gesture.SWIPE_LEFT)
+                upgradeGestureToBinding(preferences, "gestureSwipeRight", Gesture.SWIPE_RIGHT)
+                upgradeGestureToBinding(preferences, "gestureLongclick", Gesture.LONG_TAP)
+                upgradeGestureToBinding(preferences, "gestureDoubleTap", Gesture.DOUBLE_TAP)
+                upgradeGestureToBinding(preferences, "gestureTapTopLeft", Gesture.TAP_TOP_LEFT)
+                upgradeGestureToBinding(preferences, "gestureTapTop", Gesture.TAP_TOP)
+                upgradeGestureToBinding(preferences, "gestureTapTopRight", Gesture.TAP_TOP_RIGHT)
+                upgradeGestureToBinding(preferences, "gestureTapLeft", Gesture.TAP_LEFT)
+                upgradeGestureToBinding(preferences, "gestureTapCenter", Gesture.TAP_CENTER)
+                upgradeGestureToBinding(preferences, "gestureTapRight", Gesture.TAP_RIGHT)
+                upgradeGestureToBinding(preferences, "gestureTapBottomLeft", Gesture.TAP_BOTTOM_LEFT)
+                upgradeGestureToBinding(preferences, "gestureTapBottom", Gesture.TAP_BOTTOM)
+                upgradeGestureToBinding(preferences, "gestureTapBottomRight", Gesture.TAP_BOTTOM_RIGHT)
+                upgradeVolumeGestureToBinding(preferences, "gestureVolumeUp", KeyEvent.KEYCODE_VOLUME_UP)
+                upgradeVolumeGestureToBinding(preferences, "gestureVolumeDown", KeyEvent.KEYCODE_VOLUME_DOWN)
+            }
+
+            private fun upgradeVolumeGestureToBinding(preferences: SharedPreferences, oldGesturePreferenceKey: String, volumeKeyCode: Int) {
+                upgradeBinding(preferences, oldGesturePreferenceKey, keyCode(volumeKeyCode))
+            }
+
+            private fun upgradeGestureToBinding(preferences: SharedPreferences, oldGesturePreferenceKey: String, gesture: Gesture) {
+                upgradeBinding(preferences, oldGesturePreferenceKey, Binding.gesture(gesture))
+            }
+
+            @VisibleForTesting
+            internal fun upgradeBinding(preferences: SharedPreferences, oldGesturePreferenceKey: String, binding: Binding) {
+                Timber.d("Replacing gesture '%s' with binding", oldGesturePreferenceKey)
+
+                // This exists as a user may have mapped "volume down" to "UNDO".
+                // Undo already exists as a key binding, and we don't want to trash this during an upgrade
+                if (!preferences.contains(oldGesturePreferenceKey)) {
+                    Timber.v("No preference to upgrade")
+                    return
+                }
+
+                try {
+                    replaceBinding(preferences, oldGesturePreferenceKey, binding)
+                } finally {
+                    Timber.v("removing pref key: '%s'", oldGesturePreferenceKey)
+                    // remove the old key
+                    preferences.edit { remove(oldGesturePreferenceKey) }
+                }
+            }
+
+            private fun replaceBinding(preferences: SharedPreferences, oldGesturePreferenceKey: String, binding: Binding) {
+                // the preference should be set, but if it's null, then we have nothing to do
+                val pref = preferences.getString(oldGesturePreferenceKey, "0") ?: return
+                // If the preference doesn't map (for example: it was removed), then nothing to do
+                val asInt = pref.toIntOrNull() ?: return
+                val command = oldCommandValues[asInt] ?: return
+
+                Timber.i("Moving preference from '%s' to '%s'", oldGesturePreferenceKey, command.preferenceKey)
+
+                // add to the binding_COMMANDNAME preference
+                val mappableBinding = MappableBinding(binding, MappableBinding.Screen.Reviewer(CardSide.BOTH))
+                command.addBindingAtEnd(preferences, mappableBinding)
+            }
+        }
     }
 }
diff --git a/AnkiDroid/src/main/java/com/ichi2/preferences/ControlPreference.kt b/AnkiDroid/src/main/java/com/ichi2/preferences/ControlPreference.kt
index b4c906107429..6235b30793ea 100644
--- a/AnkiDroid/src/main/java/com/ichi2/preferences/ControlPreference.kt
+++ b/AnkiDroid/src/main/java/com/ichi2/preferences/ControlPreference.kt
@@ -25,15 +25,19 @@ import android.view.KeyEvent.KEYCODE_VOLUME_UP
 import androidx.preference.ListPreference
 import androidx.preference.ListPreferenceDialogFragmentCompat
 import androidx.preference.PreferenceCategory
+import com.afollestad.materialdialogs.MaterialDialog
 import com.ichi2.anki.AnkiDroidApp
 import com.ichi2.anki.R
 import com.ichi2.anki.UIUtils
+import com.ichi2.anki.cardviewer.GestureProcessor
 import com.ichi2.anki.cardviewer.ViewerCommand
 import com.ichi2.anki.dialogs.CardSideSelectionDialog
+import com.ichi2.anki.dialogs.GestureSelectionDialogBuilder
 import com.ichi2.anki.dialogs.KeySelectionDialogBuilder
 import com.ichi2.anki.reviewer.Binding
 import com.ichi2.anki.reviewer.CardSide
 import com.ichi2.anki.reviewer.MappableBinding
+import com.ichi2.anki.reviewer.MappableBinding.Companion.fromGesture
 import com.ichi2.anki.reviewer.MappableBinding.Companion.toPreferenceString
 import timber.log.Timber
 import java.util.*
@@ -61,6 +65,11 @@ class ControlPreference : ListPreference {
         // negative indices are "add"
         entryTitles.add(context.getString(R.string.binding_add_key))
         entryIndices.add(ADD_KEY_INDEX)
+        // Put "Add gesture" option if gestures are enabled
+        if (AnkiDroidApp.getSharedPrefs(context).getBoolean(GestureProcessor.PREF_KEY, false)) {
+            entryTitles.add(context.getString(R.string.binding_add_gesture))
+            entryIndices.add(ADD_GESTURE_INDEX)
+        }
         // 0 and above are "delete" actions for already mapped preferences
         for ((i, binding) in MappableBinding.fromPreferenceString(value).withIndex()) {
             entryTitles.add(context.getString(R.string.binding_remove_binding, binding.toDisplayString(context)))
@@ -102,15 +111,43 @@ class ControlPreference : ListPreference {
     /** Called when an element is selected in the ListView */
     override fun callChangeListener(newValue: Any?): Boolean {
         when (val index: Int = (newValue as String).toInt()) {
+            ADD_GESTURE_INDEX -> {
+                GestureSelectionDialogBuilder(context).apply {
+                    onGestureChanged { gesture ->
+                        showToastIfBindingIsUsed(fromGesture(gesture))
+                    }
+                    onPositive { dialog, _ ->
+                        val gesture = mGesturePicker.getGesture() ?: return@onPositive
+                        val mappableBinding = fromGesture(gesture)
+                        if (bindingIsUsedOnAnotherCommand(mappableBinding)) {
+                            showDialogToReplaceBinding(mappableBinding, context.getString(R.string.binding_replace_gesture), dialog)
+                        } else {
+                            addBinding(mappableBinding)
+                            dialog.dismiss()
+                        }
+                    }
+                    autoDismiss(false)
+                }.show()
+            }
             ADD_KEY_INDEX -> {
-                KeySelectionDialogBuilder(context)
-                    .onBindingChanged { binding -> checkExistingBinding(MappableBinding(binding, MappableBinding.Screen.Reviewer(CardSide.BOTH))) }
-                    // select a side, then add
-                    .onBindingSubmitted { binding ->
-                        CardSideSelectionDialog.displayInstance(context) { side -> addBinding(MappableBinding(binding, MappableBinding.Screen.Reviewer(side))) }
+                KeySelectionDialogBuilder(context).apply {
+                    onBindingChanged { binding -> showToastIfBindingIsUsed(MappableBinding(binding, MappableBinding.Screen.Reviewer(CardSide.BOTH))) }
+                    onPositive { dialog, _ ->
+                        val binding = mKeyPicker.getBinding() ?: return@onPositive
+                        // Use CardSide.BOTH as placeholder just to check if binding exists
+                        CardSideSelectionDialog.displayInstance(context) { side ->
+                            val mappableBinding = MappableBinding(binding, MappableBinding.Screen.Reviewer(side))
+                            if (bindingIsUsedOnAnotherCommand(mappableBinding)) {
+                                showDialogToReplaceBinding(mappableBinding, context.getString(R.string.binding_replace_key), dialog)
+                            } else {
+                                addBinding(mappableBinding)
+                                dialog.dismiss()
+                            }
+                        }
                     }
-                    .disallowModifierKeys()
-                    .show()
+                    autoDismiss(false)
+                    disallowModifierKeys()
+                }.show()
             }
             else -> {
                 val bindings: MutableList<MappableBinding> = MappableBinding.fromPreferenceString(value)
@@ -129,25 +166,28 @@ class ControlPreference : ListPreference {
         return keycode == KEYCODE_VOLUME_DOWN || keycode == KEYCODE_VOLUME_UP
     }
 
+    /**
+     * Return if another command uses
+     */
+    private fun bindingIsUsedOnAnotherCommand(binding: MappableBinding): Boolean {
+        return getCommandWithBindingExceptThis(binding) != null
+    }
+
     /** Displays a warning to the user if the provided binding couldn't be used */
-    private fun checkExistingBinding(binding: MappableBinding) {
-        val existingCommands = getExistingCommands(binding).toList()
-        if (existingCommands.isEmpty()) return // no conflicts
-        val commandNames = existingCommands.map { context.getString(it.resourceId) }
-        val text = context.getString(R.string.bindings_already_bound, TextUtils.join(", ", commandNames))
+    private fun showToastIfBindingIsUsed(binding: MappableBinding) {
+        val bindingCommand = getCommandWithBindingExceptThis(binding)
+            ?: return
+
+        val commandName = context.getString(bindingCommand.resourceId)
+        val text = context.getString(R.string.bindings_already_bound, commandName)
         UIUtils.showThemedToast(context, text, true)
     }
 
-    /** return all commands where the binding is already mapped excluding the current command */
-    fun getExistingCommands(binding: MappableBinding): List<ViewerCommand> {
-        // get a list of all bindings - tuple: (Command, List<MappableBinding>)
+    /** @return command where the binding is mapped excluding the current command */
+    private fun getCommandWithBindingExceptThis(binding: MappableBinding): ViewerCommand? {
         return MappableBinding.allMappings(AnkiDroidApp.getSharedPrefs(context))
-            // filter to the commands which have a binding matching this one
-            .filter { x -> x.second.any { cmdBinding -> cmdBinding == binding } }
-            // return the associated commands
-            .map { x -> x.first }
-            // except for the command that this preference refers to
-            .filter { x -> x.preferenceKey != key }
+            // filter to the commands which have a binding matching this one except this
+            .firstOrNull { x -> x.second.any { cmdBinding -> cmdBinding == binding } && x.first.preferenceKey != key }?.first
     }
 
     private fun addBinding(binding: MappableBinding) {
@@ -158,15 +198,50 @@ class ControlPreference : ListPreference {
         value = bindings.toPreferenceString()
     }
 
+    /**
+     * Remove binding from all control preferences
+     * in the parent PreferenceGroup of this [ControlPreference]
+     */
+    private fun clearBinding(binding: MappableBinding) {
+        val preferenceGroup = parent
+            ?: return
+
+        for (command in ViewerCommand.values()) {
+            val commandPreference = preferenceGroup.findPreference<ControlPreference>(command.preferenceKey)!!
+            val bindings = MappableBinding.fromPreferenceString(commandPreference.value)
+            if (binding in bindings) {
+                bindings.remove(binding)
+                commandPreference.value = bindings.toPreferenceString()
+            }
+        }
+    }
+
+    private fun showDialogToReplaceBinding(binding: MappableBinding, title: String, parentDialog: MaterialDialog) {
+        val commandName = context.getString(getCommandWithBindingExceptThis(binding)!!.resourceId)
+
+        MaterialDialog.Builder(context)
+            .title(title)
+            .content(context.getString(R.string.bindings_already_bound, commandName))
+            .onPositive { _, _ ->
+                clearBinding(binding)
+                addBinding(binding)
+                parentDialog.dismiss()
+            }
+            .positiveText(context.getString(R.string.dialog_positive_replace))
+            .negativeText(R.string.dialog_cancel)
+            .build()
+            .show()
+    }
+
     companion object {
-        private const val ADD_KEY_INDEX = -1
+        private const val ADD_KEY_INDEX = -2
+        private const val ADD_GESTURE_INDEX = -1
 
         /** Attaches all possible [ControlPreference] elements to a given [PreferenceCategory] */
         @JvmStatic
         fun setup(cat: PreferenceCategory) {
             val commands = Arrays.stream(ViewerCommand.values()).collect(Collectors.toList())
             val context = cat.context
-            commands.remove(ViewerCommand.NOTHING)
             for (c in commands) {
                 val p = ControlPreference(context)
                 p.setTitle(c.resourceId)
diff --git a/AnkiDroid/src/main/res/values/10-preferences.xml b/AnkiDroid/src/main/res/values/10-preferences.xml
index bf3313e5f168..a62db59f3eed 100644
--- a/AnkiDroid/src/main/res/values/10-preferences.xml
+++ b/AnkiDroid/src/main/res/values/10-preferences.xml
@@ -35,10 +35,7 @@
     <string name="pref_cat_themes" maxLength="41">Themes</string>
     <string name="pref_cat_fonts" maxLength="41">Fonts</string>
     <string name="pref_cat_gestures" maxLength="41">Gestures</string>
-    <string name="pref_cat_gestures_summ">Use taps and swipes instead of buttons</string>
-    <string name="pref_cat_actions" maxLength="41">Actions</string>
     <string name="pref_cat_controls" maxLength="41">Controls</string>
-    <string name="pref_cat_controls_summ">Configure keyboards and other devices</string>
     <string name="pref_cat_advanced" maxLength="41">Advanced</string>
     <string name="pref_cat_advanced_summ">Optimization and experimental features</string>
     <string name="pref_cat_performance" maxLength="41">Performance</string>
@@ -90,13 +87,9 @@
     <string name="gestures_tap_right" maxLength="41">Touch right</string>
     <string name="gestures_tap_bottom" maxLength="41">Touch bottom</string>
     <string name="gestures_corner_tap_top_left" maxLength="41">Touch top left</string>
-    <string name="gestures_corner_tap_top_center">Touch top center</string>
     <string name="gestures_corner_tap_top_right" maxLength="41">Touch top right</string>
-    <string name="gestures_corner_tap_middle_left">Touch middle left</string>
     <string name="gestures_corner_tap_middle_center" maxLength="41">Touch middle center</string>
-    <string name="gestures_corner_tap_middle_right">Touch middle right</string>
     <string name="gestures_corner_tap_bottom_left" maxLength="41">Touch bottom left</string>
-    <string name="gestures_corner_tap_bottom_center">Touch bottom center</string>
     <string name="gestures_corner_tap_bottom_right" maxLength="41">Touch bottom right</string>
     <string name="more_scrolling_buttons" maxLength="41">eReader</string>
     <string name="more_scrolling_buttons_summ">Also use kanji/katakana, emoji/kao-moji buttons for scrolling</string>
@@ -220,6 +213,8 @@
     <string name="custom_sync_server_media_url_title" maxLength="41">Media sync url</string>
     <string name="custom_sync_server_media_url_invalid">Media sync url invalid</string>
     <!-- Key Bindings -->
+    <string name="keyboard">Keyboard</string>
+    <string name="bluetooth">Bluetooth</string>
     <string name="controls_main_category" maxLength="41">Command mapping</string>
 
 
@@ -313,7 +308,9 @@
     <!-- Open Changelog-->
     <string name="open_changelog">Open Changelog</string>
     <string name="binding_add_gesture">Add gesture</string>
+    <string name="binding_replace_gesture">Replace gesture</string>
     <string name="binding_add_key">Add key</string>
+    <string name="binding_replace_key">Replace key</string>
     <string name="key_picker_default_press_key">Press a key</string>
 
     <!-- Select card side -->
@@ -331,5 +328,5 @@ this formatter is used if the bind only applies to both the question and the ans
     <!-- Binding Preference -->
     <string name="binding_remove_binding" comment="The parameter is the name of the key/gesture.
     Keys cannot be translated yet.">Remove ‘%s’</string>
-    <string name="bindings_already_bound">Already bound to %s</string>
+    <string name="bindings_already_bound">Already bound to ‘%s’</string>
 </resources>
diff --git a/AnkiDroid/src/main/res/values/11-arrays.xml b/AnkiDroid/src/main/res/values/11-arrays.xml
index dc68e5049b22..5967a12557b4 100644
--- a/AnkiDroid/src/main/res/values/11-arrays.xml
+++ b/AnkiDroid/src/main/res/values/11-arrays.xml
@@ -77,14 +77,12 @@
     <string name="html_size_code_xx_large">xx-large</string>
 
     <!-- gestures_labels -->
-    <string name="gesture_no_action">No action</string>
     <string name="gesture_answer_1">Answer button 1</string>
     <string name="gesture_answer_2">Answer button 2</string>
     <string name="gesture_answer_3">Answer button 3</string>
     <string name="gesture_answer_4">Answer button 4</string>
     <string name="gesture_answer_green">Answer recommended (green)</string>
     <string name="gesture_answer_better_recommended">Answer better than recommended</string>
-    <string name="gesture_tag_note">Tag note</string>
     <string name="gesture_play">Play media</string>
     <string name="gesture_abort_learning">Abort learning</string>
     <string name="gesture_flag_red">Toggle Red Flag</string>
diff --git a/AnkiDroid/src/main/res/values/constants.xml b/AnkiDroid/src/main/res/values/constants.xml
index 30e8fcc2090d..888db6d9d1d0 100644
--- a/AnkiDroid/src/main/res/values/constants.xml
+++ b/AnkiDroid/src/main/res/values/constants.xml
@@ -62,86 +62,6 @@
         <item>200</item>
         <item>500</item>
     </string-array>
-    <string-array name="gestures_labels">
-        <item>@string/gesture_no_action</item>
-        <item>@string/show_answer</item>
-        <item>@string/gesture_answer_1</item>
-        <item>@string/gesture_answer_2</item>
-        <item>@string/gesture_answer_3</item>
-        <item>@string/gesture_answer_4</item>
-        <item>@string/gesture_answer_green</item>
-        <item>@string/gesture_answer_better_recommended</item>
-        <item>@string/undo</item>
-        <item>@string/cardeditor_title_edit_card</item>
-        <item>@string/card_info_title</item>
-        <item>@string/gesture_tag_note</item>
-        <item>@string/menu_mark_note</item>
-        <item>@string/menu_bury_card</item>
-        <item>@string/menu_suspend_card</item>
-        <item>@string/menu_delete_note</item>
-        <item>@string/gesture_play</item>
-        <item>@string/gesture_abort_learning</item>
-        <item>@string/menu_bury_note</item>
-        <item>@string/menu_suspend_note</item>
-        <item>@string/gesture_flag_red</item>
-        <item>@string/gesture_flag_orange</item>
-        <item>@string/gesture_flag_green</item>
-        <item>@string/gesture_flag_blue</item>
-        <item>@string/gesture_flag_pink</item>
-        <item>@string/gesture_flag_turquoise</item>
-        <item>@string/gesture_flag_purple</item>
-        <item>@string/gesture_flag_remove</item>
-        <item>@string/gesture_page_up</item>
-        <item>@string/gesture_page_down</item>
-        <item>@string/gesture_abort_sync</item>
-        <item>@string/record_voice</item>
-        <item>@string/replay_voice</item>
-        <item>@string/gesture_toggle_whiteboard</item>
-        <item>@string/gesture_show_hint</item>
-        <item>@string/gesture_show_all_hints</item>
-        <item>@string/menu_add_note</item>
-    </string-array>
-    <string-array name="gestures_values">
-        <item>0</item>
-        <item>1</item>
-        <item>2</item>
-        <item>3</item>
-        <item>4</item>
-        <item>5</item>
-        <item>6</item>
-        <item>7</item>
-        <item>8</item>
-        <item>9</item>
-        <item>33</item> <!-- Card Info -->
-        <item>32</item> <!-- Tag Note -->
-        <item>10</item>
-        <!--11 was deleted: Lookup Dictionary-->
-        <item>12</item>
-        <item>13</item>
-        <item>14</item>
-        <!--15 reserved for clear whiteboard action-->
-        <item>16</item>
-        <item>17</item>
-        <item>18</item>
-        <item>19</item>
-        <item>20</item> <!-- Red Flag -->
-        <item>21</item> <!-- Orange Flag -->
-        <item>22</item> <!-- Green Flag -->
-        <item>23</item> <!-- Blue Flag -->
-        <item>38</item> <!-- Pink Flag -->
-        <item>39</item> <!-- Turquoise Flag -->
-        <item>40</item> <!-- Purple Flag -->
-        <item>24</item> <!-- Unset Flag -->
-        <item>30</item> <!-- Page Up -->
-        <item>31</item> <!-- Page Down -->
-        <item>34</item> <!-- Abort Learning and Sync -->
-        <item>35</item> <!-- Record voice -->
-        <item>36</item> <!-- Replay voice -->
-        <item>37</item> <!-- Toggle whiteboard -->
-        <item>41</item> <!-- Show hint -->
-        <item>42</item> <!-- Show all hints -->
-        <item>43</item> <!-- Add note -->
-    </string-array>
     <string-array name="custom_button_values">
         <item>2</item>
         <item>1</item>
diff --git a/AnkiDroid/src/main/res/values/preferences.xml b/AnkiDroid/src/main/res/values/preferences.xml
index de793aa1b989..79494ec6d339 100644
--- a/AnkiDroid/src/main/res/values/preferences.xml
+++ b/AnkiDroid/src/main/res/values/preferences.xml
@@ -28,6 +28,7 @@
     <string name="night_theme_key">nightTheme</string>
     <string name="gestures_preference">gestures</string>
     <string name="gestures_corner_touch_preference">gestureCornerTouch</string>
+    <string name="pref_controls_screen_key">controlsScreen</string>
     <!-- Sync preferences -->
     <string name="pref_sync_screen_key">syncScreen</string>
     <string name="sync_account_key">syncAccount</string>
diff --git a/AnkiDroid/src/main/res/xml/preference_headers.xml b/AnkiDroid/src/main/res/xml/preference_headers.xml
index 3e7fd365ebf3..555a05d8aed8 100644
--- a/AnkiDroid/src/main/res/xml/preference_headers.xml
+++ b/AnkiDroid/src/main/res/xml/preference_headers.xml
@@ -58,17 +58,10 @@
         android:icon="@drawable/ic_color_lens_white_24dp">
     </Preference>
 
-    <!-- Navigation Preferences -->
-    <Preference
-        android:fragment="com.ichi2.anki.Preferences$GesturesSettingsFragment"
-        android:summary="@string/pref_cat_gestures_summ"
-        android:title="@string/pref_cat_gestures">
-    </Preference>
-
     <!-- Keybinding preferences -->
     <Preference
         android:fragment="com.ichi2.anki.Preferences$ControlsSettingsFragment"
-        android:summary="@string/pref_cat_controls_summ"
+        android:key="@string/pref_controls_screen_key"
         android:title="@string/pref_cat_controls"
         android:icon="@drawable/ic_touch">
     </Preference>
diff --git a/AnkiDroid/src/main/res/xml/preferences_controls.xml b/AnkiDroid/src/main/res/xml/preferences_controls.xml
index 199dad69f39a..aef0fa1dd072 100644
--- a/AnkiDroid/src/main/res/xml/preferences_controls.xml
+++ b/AnkiDroid/src/main/res/xml/preferences_controls.xml
@@ -17,9 +17,40 @@
 
 <!-- Key com.ichi2.ui.BindingPreferences -->
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://arbitrary.app.namespace/com.ichi2.anki"
     android:title="@string/pref_cat_controls"
-    android:summary="@string/pref_cat_controls_summ">
+    android:key="@string/pref_controls_screen_key">
 
+    <SwitchPreference
+        android:defaultValue="false"
+        android:disableDependentsState="false"
+        android:key="@string/gestures_preference"
+        android:summary="@string/gestures_summ"
+        android:title="@string/gestures" />
+    <SwitchPreference
+        android:defaultValue="false"
+        android:dependency="@string/gestures_preference"
+        android:key="@string/gestures_corner_touch_preference"
+        android:summary="@string/gestures_corner_touch_summary"
+        android:title="@string/gestures_corner_touch" />
+    <SwitchPreference
+        android:defaultValue="false"
+        android:dependency="@string/gestures_preference"
+        android:disableDependentsState="false"
+        android:key="gestureFullScreenNavigationDrawer"
+        android:summary="@string/gestures_fullscreen_nav_drawer_summary"
+        android:title="@string/gestures_full_screen_nav_drawer" />
+    <com.ichi2.preferences.SeekBarPreferenceCompat
+        android:defaultValue="100"
+        android:dependency="@string/gestures_preference"
+        android:dialogMessage="@string/preference_summary_literal"
+        android:key="swipeSensitivity"
+        android:max="180"
+        android:summary="@string/preference_summary_literal"
+        android:text=""
+        android:title="@string/swipe_sensitivity"
+        app:interval="1"
+        app:min="20" />
     <!-- This category is expanded in BindingPreference.setup -->
     <PreferenceCategory android:title="@string/controls_main_category" android:key="key_map_category" />
 </PreferenceScreen>
\ No newline at end of file
diff --git a/AnkiDroid/src/main/res/xml/preferences_gestures.xml b/AnkiDroid/src/main/res/xml/preferences_gestures.xml
deleted file mode 100644
index cceb1ad8ab5c..000000000000
--- a/AnkiDroid/src/main/res/xml/preferences_gestures.xml
+++ /dev/null
@@ -1,159 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-~ Copyright (c) 2009 Nicolas Raoul <nicolas.raoul@gmail.com>
-~ Copyright (c) 2009 Edu Zamora <edu.zasu@gmail.com>
-~ Copyright (c) 2009 Jordi Chacon <jordi.chacon@gmail.com>
-~ Copyright (c) 2011 Norbert Nagold <norbert.nagold@gmail.com>
-~ Copyright (c) 2012 Kostas Spyropoulos <inigo.aldana@gmail.com>
-~ Copyright (c) 2014 Timothy Rae <perceptualchaos2@gmail.com>
-~
-~ This program is free software; you can redistribute it and/or modify it under
-~ the terms of the GNU General Public License as published by the Free Software
-~ Foundation; either version 3 of the License, or (at your option) any later
-~ version.
-~
-~ This program is distributed in the hope that it will be useful, but WITHOUT ANY
-~ WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
-~ PARTICULAR PURPOSE. See the GNU General Public License for more details.
-~
-~ You should have received a copy of the GNU General Public License along with
-~ this program.  If not, see <http://www.gnu.org/licenses/>.
--->
-
-<!-- Navigation Preferences -->
-<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://arbitrary.app.namespace/com.ichi2.anki"
-    android:title="@string/pref_cat_gestures"
-    android:summary="@string/pref_cat_gestures_summ" >
-    <SwitchPreference
-        android:defaultValue="false"
-        android:disableDependentsState="false"
-        android:key="@string/gestures_preference"
-        android:summary="@string/gestures_summ"
-        android:title="@string/gestures" />
-    <SwitchPreference
-        android:defaultValue="false"
-        android:dependency="@string/gestures_preference"
-        android:disableDependentsState="false"
-        android:key="@string/gestures_corner_touch_preference"
-        android:summary="@string/gestures_corner_touch_summary"
-        android:title="@string/gestures_corner_touch" />
-    <SwitchPreference
-        android:defaultValue="false"
-        android:dependency="@string/gestures_preference"
-        android:disableDependentsState="false"
-        android:key="gestureFullScreenNavigationDrawer"
-        android:summary="@string/gestures_fullscreen_nav_drawer_summary"
-        android:title="@string/gestures_full_screen_nav_drawer" />
-    <com.ichi2.preferences.SeekBarPreferenceCompat
-        android:defaultValue="100"
-        android:dependency="@string/gestures_preference"
-        android:dialogMessage="@string/preference_summary_literal"
-        android:key="swipeSensitivity"
-        android:max="180"
-        android:summary="@string/preference_summary_literal"
-        android:text=""
-        android:title="@string/swipe_sensitivity"
-        app:interval="1"
-        app:min="20" />
-    <PreferenceCategory android:title="@string/pref_cat_actions" >
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureSwipeUp"
-            android:title="@string/gestures_swipe_up" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureSwipeDown"
-            android:title="@string/gestures_swipe_down" />
-        <ListPreference
-            android:defaultValue="6"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureSwipeLeft"
-            android:title="@string/gestures_swipe_left" />
-        <ListPreference
-            android:defaultValue="2"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureSwipeRight"
-            android:title="@string/gestures_swipe_right" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureDoubleTap"
-            android:title="@string/gestures_double_tap" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_corner_touch_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapTopLeft"
-            android:title="@string/gestures_corner_tap_top_left" />
-        <ListPreference
-            android:defaultValue="1"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapTop"
-            android:title="@string/gestures_tap_top" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_corner_touch_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapTopRight"
-            android:title="@string/gestures_corner_tap_top_right" />
-        <ListPreference
-            android:defaultValue="1"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapLeft"
-            android:title="@string/gestures_tap_left" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_corner_touch_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapCenter"
-            android:title="@string/gestures_corner_tap_middle_center" />
-        <ListPreference
-            android:defaultValue="1"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapRight"
-            android:title="@string/gestures_tap_right" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_corner_touch_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapBottomLeft"
-            android:title="@string/gestures_corner_tap_bottom_left" />
-        <ListPreference
-            android:defaultValue="1"
-            android:dependency="@string/gestures_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapBottom"
-            android:title="@string/gestures_tap_bottom" />
-        <ListPreference
-            android:defaultValue="0"
-            android:dependency="@string/gestures_corner_touch_preference"
-            android:entries="@array/gestures_labels"
-            android:entryValues="@array/gestures_values"
-            android:key="gestureTapBottomRight"
-            android:title="@string/gestures_corner_tap_bottom_right" />
-    </PreferenceCategory>
-</PreferenceScreen>
\ No newline at end of file
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/ReviewerNoParamTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/ReviewerNoParamTest.kt
index 3e1686ecd59d..a86767361959 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/ReviewerNoParamTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/ReviewerNoParamTest.kt
@@ -22,7 +22,6 @@ import androidx.core.content.edit
 import androidx.test.ext.junit.runners.AndroidJUnit4
 import com.ichi2.anki.cardviewer.Gesture
 import com.ichi2.anki.cardviewer.Gesture.SWIPE_DOWN
-import com.ichi2.anki.cardviewer.Gesture.SWIPE_LEFT
 import com.ichi2.anki.cardviewer.Gesture.SWIPE_RIGHT
 import com.ichi2.anki.cardviewer.Gesture.SWIPE_UP
 import com.ichi2.anki.cardviewer.GestureProcessor
@@ -30,8 +29,8 @@ import com.ichi2.anki.cardviewer.ViewerCommand
 import com.ichi2.anki.model.WhiteboardPenColor
 import com.ichi2.anki.reviewer.FullScreenMode
 import com.ichi2.anki.reviewer.FullScreenMode.Companion.setPreference
+import com.ichi2.anki.reviewer.MappableBinding
 import com.ichi2.libanki.Consts
-import net.ankiweb.rsdroid.database.NotImplementedException
 import org.hamcrest.MatcherAssert.assertThat
 import org.hamcrest.Matchers.*
 import org.junit.Before
@@ -163,6 +162,7 @@ class ReviewerNoParamTest : RobolectricTest() {
     @RunInBackground
     fun defaultDrawerConflictIsTrueIfGesturesEnabled() {
         enableGestureSetting()
+        enableGesture(SWIPE_RIGHT)
         val reviewer = startReviewerFullScreen()
 
         assertThat(reviewer.hasDrawerSwipeConflicts(), equalTo(true))
@@ -272,30 +272,20 @@ class ReviewerNoParamTest : RobolectricTest() {
     }
 
     private fun disableGestures(vararg gestures: Gesture) {
-        AnkiDroidApp.getSharedPrefs(targetContext).edit {
-            for (g in gestures) {
-                val k = getKey(g)
-                putString(k, ViewerCommand.NOTHING.toPreferenceString())
+        val prefs = AnkiDroidApp.getSharedPrefs(targetContext)
+        for (command in ViewerCommand.values()) {
+            for (mappableBinding in MappableBinding.fromPreference(prefs, command)) {
+                if (mappableBinding.binding.gesture in gestures) {
+                    command.removeBinding(prefs, mappableBinding)
+                }
             }
         }
     }
 
     /** Enables a gesture (without changing the overall setting of whether gestures are allowed)  */
     private fun enableGesture(gesture: Gesture) {
-        AnkiDroidApp.getSharedPrefs(targetContext).edit {
-            val k = getKey(gesture)
-            putString(k, ViewerCommand.FLIP_OR_ANSWER_EASE1.toPreferenceString())
-        }
-    }
-
-    private fun getKey(gesture: Gesture): String {
-        return when (gesture) {
-            SWIPE_UP -> "gestureSwipeUp"
-            SWIPE_DOWN -> "gestureSwipeDown"
-            SWIPE_LEFT -> "gestureSwipeLeft"
-            SWIPE_RIGHT -> "gestureSwipeRight"
-            else -> throw NotImplementedException(gesture.toString())
-        }
+        val prefs = AnkiDroidApp.getSharedPrefs(targetContext)
+        ViewerCommand.FLIP_OR_ANSWER_EASE1.addBinding(prefs, MappableBinding.fromGesture(gesture))
     }
 
     private fun startReviewerFullScreen(): ReviewerExt {
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/GestureProcessorTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/GestureProcessorTest.kt
index a07159422818..f6ccbf392377 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/GestureProcessorTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/GestureProcessorTest.kt
@@ -17,6 +17,8 @@ package com.ichi2.anki.cardviewer
 
 import android.content.SharedPreferences
 import android.view.ViewConfiguration
+import com.ichi2.anki.reviewer.MappableBinding
+import com.ichi2.anki.reviewer.MappableBinding.Companion.toPreferenceString
 import io.mockk.every
 import io.mockk.mockk
 import io.mockk.mockkStatic
@@ -44,8 +46,7 @@ class GestureProcessorTest : ViewerCommand.CommandProcessor {
     @Test
     fun integrationTest() {
         val prefs = mockk<SharedPreferences>(relaxed = true)
-        every { prefs.getString(any(), any()) } returns "0"
-        every { prefs.getString("gestureTapCenter", any()) } returns "1"
+        every { prefs.getString(ViewerCommand.SHOW_ANSWER.preferenceKey, null) } returns listOf(MappableBinding.fromGesture(Gesture.TAP_CENTER)).toPreferenceString()
         every { prefs.getBoolean("gestureCornerTouch", any()) } returns true
         mSut.init(prefs)
         mSut.onTap(100, 100, 50f, 50f)
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/ViewerCommandTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/ViewerCommandTest.kt
index 57fd2bb9f1de..65315bf681d7 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/ViewerCommandTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/cardviewer/ViewerCommandTest.kt
@@ -31,7 +31,7 @@ class ViewerCommandTest {
         // Adds are acceptable
         // Deletes are acceptable if the binding should no longer exist
         assertEquals(
-            "binding_NOTHING, binding_SHOW_ANSWER, binding_FLIP_OR_ANSWER_EASE1, " +
+            "binding_SHOW_ANSWER, binding_FLIP_OR_ANSWER_EASE1, " +
                 "binding_FLIP_OR_ANSWER_EASE2, binding_FLIP_OR_ANSWER_EASE3, binding_FLIP_OR_ANSWER_EASE4, " +
                 "binding_FLIP_OR_ANSWER_RECOMMENDED, binding_FLIP_OR_ANSWER_BETTER_THAN_RECOMMENDED, " +
                 "binding_UNDO, binding_EDIT, binding_MARK, binding_BURY_CARD, " +
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeVolumeButtonsToBindingsTest.kt b/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTest.kt
similarity index 74%
rename from AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeVolumeButtonsToBindingsTest.kt
rename to AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTest.kt
index 135c7aa7af67..18f9a9d5f476 100644
--- a/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeVolumeButtonsToBindingsTest.kt
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTest.kt
@@ -23,7 +23,8 @@ import com.ichi2.anki.reviewer.Binding.Companion.keyCode
 import com.ichi2.anki.reviewer.CardSide
 import com.ichi2.anki.reviewer.MappableBinding
 import com.ichi2.anki.reviewer.MappableBinding.Screen.Reviewer
-import com.ichi2.anki.servicelayer.PreferenceUpgradeService.PreferenceUpgrade.UpgradeVolumeButtonsToBindings
+import com.ichi2.anki.servicelayer.PreferenceUpgradeService.PreferenceUpgrade.Companion.upgradeVersionPrefKey
+import com.ichi2.anki.servicelayer.PreferenceUpgradeService.PreferenceUpgrade.UpgradeGesturesToControls
 import org.hamcrest.CoreMatchers.equalTo
 import org.hamcrest.CoreMatchers.not
 import org.hamcrest.MatcherAssert.assertThat
@@ -37,56 +38,24 @@ import org.robolectric.ParameterizedRobolectricTestRunner
 import timber.log.Timber
 
 @RunWith(ParameterizedRobolectricTestRunner::class)
-class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : RobolectricTest() {
+class UpgradeGesturesToControlsTest(private val testData: TestData) : RobolectricTest() {
     private val changedKeys = HashSet<String>()
 
     private lateinit var prefs: SharedPreferences
-    private lateinit var instance: UpgradeVolumeButtonsToBindings
+    private lateinit var instance: UpgradeGesturesToControls
 
     @Before
     fun setup() {
-        super.setUp()
         prefs = super.getPreferences()
-        instance = UpgradeVolumeButtonsToBindings()
+        instance = UpgradeGesturesToControls()
         prefs.registerOnSharedPreferenceChangeListener { _, key -> run { Timber.i("added key $key"); changedKeys.add(key) } }
     }
 
-    @Test
-    fun test_preferences_not_opened_happy_path() {
-        // if the user has not opened the gestures, then nothing should be mapped
-        assertThat(prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(false))
-        assertThat(prefs.contains(PREF_KEY_VOLUME_UP), equalTo(false))
-
-        upgradeAllGestures()
-
-        // ensure that no settings were added to the preferences
-        assertThat(changedKeys, Matchers.contains("preferenceUpgradeVersion"))
-    }
-
-    @Test
-    fun test_preferences_opened_happy_path() {
-        // the default is that the user has not mapped the gesture, but has opened the screen
-        // so they are set to NOTHING
-        prefs.edit { putString(PREF_KEY_VOLUME_UP, ViewerCommand.NOTHING.toPreferenceString()) }
-        prefs.edit { putString(PREF_KEY_VOLUME_DOWN, ViewerCommand.NOTHING.toPreferenceString()) }
-
-        assertThat(prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(true))
-        assertThat(prefs.contains(PREF_KEY_VOLUME_UP), equalTo(true))
-
-        upgradeAllGestures()
-
-        // ensure that no settings were added to the preferences
-        assertThat(changedKeys, Matchers.contains("preferenceUpgradeVersion", PREF_KEY_VOLUME_DOWN, PREF_KEY_VOLUME_UP))
-
-        assertThat("Volume gestures are removed", prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(false))
-        assertThat("Volume gestures are removed", prefs.contains(PREF_KEY_VOLUME_UP), equalTo(false))
-    }
-
     @Test
     fun gesture_set_no_conflicts() {
         // assume that we have a preference set, and that it has no defaults
         val command = ViewerCommand.SHOW_ANSWER
-        prefs.edit { putString(testData.affectedPreferenceKey, command.toPreferenceString()) }
+        prefs.edit { putString(testData.affectedPreferenceKey, oldCommandPreferenceStrings[command]) }
 
         assertThat(prefs.contains(testData.affectedPreferenceKey), equalTo(true))
         assertThat(prefs.contains(testData.unaffectedPreferenceKey), equalTo(false))
@@ -94,7 +63,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
 
         upgradeAllGestures()
 
-        assertThat(changedKeys, Matchers.containsInAnyOrder("preferenceUpgradeVersion", testData.affectedPreferenceKey, command.preferenceKey))
+        assertThat(changedKeys, Matchers.containsInAnyOrder(upgradeVersionPrefKey, testData.affectedPreferenceKey, command.preferenceKey))
 
         assertThat("legacy preference removed", prefs.contains(testData.affectedPreferenceKey), equalTo(false))
         assertThat("new preference added", prefs.contains(command.preferenceKey), equalTo(true))
@@ -113,7 +82,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
         // if the gesture was mapped to a command which already had bindings,
         // check it is added to the list at the end
         val command = ViewerCommand.EDIT
-        prefs.edit { putString(testData.affectedPreferenceKey, command.toPreferenceString()) }
+        prefs.edit { putString(testData.affectedPreferenceKey, oldCommandPreferenceStrings[command]) }
 
         assertThat(prefs.contains(testData.affectedPreferenceKey), equalTo(true))
         assertThat(prefs.contains(testData.unaffectedPreferenceKey), equalTo(false))
@@ -123,7 +92,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
 
         upgradeAllGestures()
 
-        assertThat(changedKeys, Matchers.containsInAnyOrder("preferenceUpgradeVersion", testData.affectedPreferenceKey, command.preferenceKey))
+        assertThat(changedKeys, Matchers.containsInAnyOrder(upgradeVersionPrefKey, testData.affectedPreferenceKey, command.preferenceKey))
 
         assertThat("legacy preference removed", prefs.contains(testData.affectedPreferenceKey), equalTo(false))
         assertThat("new preference exists", prefs.contains(command.preferenceKey), equalTo(true))
@@ -150,7 +119,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
         val command = ViewerCommand.EDIT
         command.addBinding(prefs, testData.binding)
 
-        prefs.edit { putString(testData.affectedPreferenceKey, command.toPreferenceString()) }
+        prefs.edit { putString(testData.affectedPreferenceKey, oldCommandPreferenceStrings[command]) }
 
         assertThat(prefs.contains(testData.affectedPreferenceKey), equalTo(true))
         assertThat(prefs.contains(testData.unaffectedPreferenceKey), equalTo(false))
@@ -161,7 +130,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
 
         upgradeAllGestures()
 
-        assertThat("Binding gestures should not be changed", changedKeys, Matchers.contains("preferenceUpgradeVersion", testData.affectedPreferenceKey))
+        assertThat("Binding gestures should not be changed", changedKeys, Matchers.contains(upgradeVersionPrefKey, testData.affectedPreferenceKey))
 
         assertThat("legacy preference removed", prefs.contains(testData.affectedPreferenceKey), equalTo(false))
         assertThat("new preference still exists", prefs.contains(command.preferenceKey), equalTo(true))
@@ -173,7 +142,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
 
         upgradeAllGestures()
 
-        assertThat("Binding gestures should not be changed", changedKeys, Matchers.contains("preferenceUpgradeVersion", testData.affectedPreferenceKey))
+        assertThat("Binding gestures should not be changed", changedKeys, Matchers.contains(upgradeVersionPrefKey, testData.affectedPreferenceKey))
 
         assertThat("legacy preference removed", prefs.contains(testData.affectedPreferenceKey), equalTo(false))
     }
@@ -185,7 +154,7 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
 
         upgradeAllGestures()
 
-        assertThat("Binding gestures should not be changed", changedKeys, Matchers.containsInAnyOrder("preferenceUpgradeVersion", testData.affectedPreferenceKey))
+        assertThat("Binding gestures should not be changed", changedKeys, Matchers.containsInAnyOrder(upgradeVersionPrefKey, testData.affectedPreferenceKey))
 
         assertThat("legacy preference removed", prefs.contains(testData.affectedPreferenceKey), equalTo(false))
     }
@@ -198,8 +167,10 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
     companion object {
         private const val KEYCODE_VOLUME_UP = 24
         private const val KEYCODE_VOLUME_DOWN = 25
-        const val PREF_KEY_VOLUME_UP = "gestureVolumeUp"
-        const val PREF_KEY_VOLUME_DOWN = "gestureVolumeDown"
+        private const val PREF_KEY_VOLUME_UP = "gestureVolumeUp"
+        private const val PREF_KEY_VOLUME_DOWN = "gestureVolumeDown"
+
+        val oldCommandPreferenceStrings: HashMap<ViewerCommand, String> = hashMapOf(*UpgradeGesturesToControls().oldCommandValues.map { Pair(it.value, it.key.toString()) }.toTypedArray())
 
         private val volume_up_binding = MappableBinding(keyCode(KEYCODE_VOLUME_UP), Reviewer(CardSide.BOTH))
         private val volume_down_binding = MappableBinding(keyCode(KEYCODE_VOLUME_DOWN), Reviewer(CardSide.BOTH))
@@ -213,7 +184,6 @@ class UpgradeVolumeButtonsToBindingsTest(private val testData: TestData) : Robol
                 arrayOf(TestData(PREF_KEY_VOLUME_DOWN, KEYCODE_VOLUME_DOWN, PREF_KEY_VOLUME_UP, volume_down_binding)),
             ).toList()
         }
-
         data class TestData(val affectedPreferenceKey: String, val keyCode: Int, val unaffectedPreferenceKey: String, val binding: MappableBinding)
     }
 }
diff --git a/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTestNoParam.kt b/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTestNoParam.kt
new file mode 100644
index 000000000000..65d5170e3796
--- /dev/null
+++ b/AnkiDroid/src/test/java/com/ichi2/anki/servicemodel/UpgradeGesturesToControlsTestNoParam.kt
@@ -0,0 +1,86 @@
+/*
+ *  Copyright (c) 2022 Brayan Oliveira <brayandso.dev@gmail.com>
+ *
+ *  This program is free software; you can redistribute it and/or modify it under
+ *  the terms of the GNU General Public License as published by the Free Software
+ *  Foundation; either version 3 of the License, or (at your option) any later
+ *  version.
+ *
+ *  This program is distributed in the hope that it will be useful, but WITHOUT ANY
+ *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+ *  PARTICULAR PURPOSE. See the GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License along with
+ *  this program.  If not, see <http://www.gnu.org/licenses/>.
+ */
+package com.ichi2.anki.servicemodel
+
+import android.content.SharedPreferences
+import androidx.core.content.edit
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.ichi2.anki.RobolectricTest
+import com.ichi2.anki.servicelayer.PreferenceUpgradeService.PreferenceUpgrade.Companion.upgradeVersionPrefKey
+import com.ichi2.anki.servicelayer.PreferenceUpgradeService.PreferenceUpgrade.UpgradeGesturesToControls
+import org.hamcrest.CoreMatchers.equalTo
+import org.hamcrest.MatcherAssert.assertThat
+import org.hamcrest.Matchers
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import timber.log.Timber
+
+@RunWith(AndroidJUnit4::class)
+class UpgradeGesturesToControlsTestNoParam : RobolectricTest() {
+    private val changedKeys = HashSet<String>()
+
+    private lateinit var prefs: SharedPreferences
+    private lateinit var instance: UpgradeGesturesToControls
+
+    @Before
+    fun setup() {
+        prefs = super.getPreferences()
+        instance = UpgradeGesturesToControls()
+        prefs.registerOnSharedPreferenceChangeListener { _, key -> run { Timber.i("added key $key"); changedKeys.add(key) } }
+    }
+
+    @Test
+    fun test_preferences_not_opened_happy_path() {
+        // if the user has not opened the gestures, then nothing should be mapped
+        assertThat(prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(false))
+        assertThat(prefs.contains(PREF_KEY_VOLUME_UP), equalTo(false))
+
+        upgradeAllGestures()
+
+        // ensure that no settings were added to the preferences
+        assertThat(changedKeys, Matchers.contains(upgradeVersionPrefKey))
+    }
+
+    @Test
+    fun test_preferences_opened_happy_path() {
+        // the default is that the user has not mapped the gesture, but has opened the screen
+        // so they are set to NOTHING which had "0" as value
+        prefs.edit { putString(PREF_KEY_VOLUME_UP, "0") }
+        prefs.edit { putString(PREF_KEY_VOLUME_DOWN, "0") }
+
+        assertThat(prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(true))
+        assertThat(prefs.contains(PREF_KEY_VOLUME_UP), equalTo(true))
+
+        upgradeAllGestures()
+
+        // ensure that no settings were added to the preferences
+        assertThat(changedKeys, Matchers.contains(upgradeVersionPrefKey, PREF_KEY_VOLUME_DOWN, PREF_KEY_VOLUME_UP))
+
+        assertThat("Volume gestures are removed", prefs.contains(PREF_KEY_VOLUME_DOWN), equalTo(false))
+        assertThat("Volume gestures are removed", prefs.contains(PREF_KEY_VOLUME_UP), equalTo(false))
+    }
+
+    private fun upgradeAllGestures() {
+        changedKeys.clear()
+        instance.performUpgrade(prefs)
+    }
+
+    companion object {
+        const val PREF_KEY_VOLUME_UP = "gestureVolumeUp"
+        const val PREF_KEY_VOLUME_DOWN = "gestureVolumeDown"
+    }
+}
