diff --git a/extensions/build.gradle b/extensions/build.gradle
index 18145606a..d3bf1c68a 100644
--- a/extensions/build.gradle
+++ b/extensions/build.gradle
@@ -23,6 +23,10 @@ dependencies {
     api libs.core
     api libs.lifecycle.runtime
     api libs.activity
+    implementation platform(libs.compose.bom)
+    implementation libs.compose.material3
+    implementation libs.compose.ui.tooling.preview
+    debugImplementation libs.compose.ui.tooling.runtime
 }
 
 android {
diff --git a/extensions/src/main/java/com/google/android/apps/muzei/util/PaddingValuesExt.kt b/extensions/src/main/java/com/google/android/apps/muzei/util/PaddingValuesExt.kt
new file mode 100644
index 000000000..83e87a9c4
--- /dev/null
+++ b/extensions/src/main/java/com/google/android/apps/muzei/util/PaddingValuesExt.kt
@@ -0,0 +1,53 @@
+/*
+ * Copyright 2025 Google Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.apps.muzei.util
+
+import androidx.compose.foundation.layout.PaddingValues
+import androidx.compose.ui.unit.Dp
+import androidx.compose.ui.unit.LayoutDirection
+
+private class CombinedPaddingValues(
+    val first: PaddingValues,
+    val second: PaddingValues,
+    val combination: (first: Dp, second: Dp) -> Dp
+) : PaddingValues {
+    override fun calculateBottomPadding(): Dp =
+        combination(first.calculateBottomPadding(), second.calculateBottomPadding())
+
+    override fun calculateLeftPadding(layoutDirection: LayoutDirection): Dp =
+        combination(
+            first.calculateLeftPadding(layoutDirection),
+            second.calculateLeftPadding(layoutDirection)
+        )
+
+    override fun calculateRightPadding(layoutDirection: LayoutDirection): Dp =
+        combination(
+            first.calculateRightPadding(layoutDirection),
+            second.calculateRightPadding(layoutDirection)
+        )
+
+    override fun calculateTopPadding(): Dp =
+        combination(first.calculateTopPadding(), second.calculateTopPadding())
+}
+
+operator fun PaddingValues.plus(other: PaddingValues): PaddingValues {
+    return CombinedPaddingValues(this, other) { first, second -> first + second }
+}
+
+operator fun PaddingValues.minus(other: PaddingValues): PaddingValues {
+    return CombinedPaddingValues(this, other) { first, second -> first - second }
+}
\ No newline at end of file
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index dc0664018..9d68b3520 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -109,6 +109,7 @@ multidex = { group = "androidx.multidex", name = "multidex", version.ref = "mult
 navigation-fragment = { group = "androidx.navigation", name = "navigation-fragment-compose", version.ref = "navigation" }
 navigation-safeargs = { group = "androidx.navigation", name = "navigation-safe-args-gradle-plugin", version.ref = "navigation" }
 navigation-ui = { group = "androidx.navigation", name = "navigation-ui-ktx", version.ref = "navigation" }
+paging-compose = { group = "androidx.paging", name = "paging-compose", version.ref = "paging" }
 paging-runtime = { group = "androidx.paging", name = "paging-runtime", version.ref = "paging" }
 preference = { group = "androidx.preference", name = "preference-ktx", version.ref = "preference" }
 room-ktx = { group = "androidx.room", name = "room-ktx", version.ref = "room" }
diff --git a/source-gallery/build.gradle b/source-gallery/build.gradle
index f036c9fc1..c9139937f 100644
--- a/source-gallery/build.gradle
+++ b/source-gallery/build.gradle
@@ -44,6 +44,7 @@ dependencies {
     implementation libs.exifInterface
     implementation libs.lifecycle.common
     implementation libs.lifecycle.livedata
+    implementation libs.paging.compose
     implementation libs.room.ktx
     implementation libs.room.paging
     implementation libs.workManager
diff --git a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoGrid.kt b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoGrid.kt
new file mode 100644
index 000000000..fc1f171e7
--- /dev/null
+++ b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoGrid.kt
@@ -0,0 +1,208 @@
+/*
+ * Copyright 2025 Google Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.apps.muzei.gallery
+
+import android.net.Uri
+import androidx.compose.foundation.gestures.detectTapGestures
+import androidx.compose.foundation.layout.PaddingValues
+import androidx.compose.foundation.lazy.grid.GridCells
+import androidx.compose.foundation.lazy.grid.LazyVerticalGrid
+import androidx.compose.material3.ExperimentalMaterial3Api
+import androidx.compose.runtime.Composable
+import androidx.compose.runtime.CompositionLocalProvider
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.mutableStateOf
+import androidx.compose.runtime.remember
+import androidx.compose.runtime.setValue
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.geometry.Offset
+import androidx.compose.ui.graphics.Color
+import androidx.compose.ui.graphics.toArgb
+import androidx.compose.ui.input.pointer.pointerInput
+import androidx.compose.ui.tooling.preview.Preview
+import androidx.compose.ui.unit.dp
+import androidx.core.net.toUri
+import androidx.paging.compose.LazyPagingItems
+import androidx.paging.compose.itemKey
+import coil3.ColorImage
+import coil3.annotation.ExperimentalCoilApi
+import coil3.compose.AsyncImagePreviewHandler
+import coil3.compose.LocalAsyncImagePreviewHandler
+import com.google.android.apps.muzei.gallery.theme.GalleryTheme
+
+data class TouchInfo(
+    val photo: ChosenPhoto,
+    val offset: Offset,
+)
+
+@Composable
+fun GalleryChosenPhotoGrid(
+    photos: List<ChosenPhoto>,
+    modifier: Modifier = Modifier,
+    contentPadding: PaddingValues = PaddingValues(0.dp),
+    checkedItemIds: Set<Long> = emptySet(),
+    onCheckedToggled: (ChosenPhoto) -> Unit = {},
+    imageProvider: (chosenPhoto: ChosenPhoto, maxImages: Int) -> List<Uri>,
+) {
+    GalleryChosenPhotoGrid(
+        photos.size,
+        keyProvider = { index -> photos[index].uri },
+        photoProvider = { index -> photos[index] },
+        modifier,
+        contentPadding,
+        checkedItemIds,
+        onCheckedToggled,
+        imageProvider
+    )
+}
+
+@Composable
+fun GalleryChosenPhotoGrid(
+    photos: LazyPagingItems<ChosenPhoto>,
+    modifier: Modifier = Modifier,
+    contentPadding: PaddingValues = PaddingValues(0.dp),
+    checkedItemIds: Set<Long> = emptySet(),
+    onCheckedToggled: (ChosenPhoto) -> Unit = {},
+    imageProvider: (chosenPhoto: ChosenPhoto, maxImages: Int) -> List<Uri>,
+) {
+    val keyProvider = photos.itemKey { it.uri }
+    GalleryChosenPhotoGrid(
+        photos.itemCount,
+        // Workaround for https://issuetracker.google.com/issues/372311615
+        keyProvider = { index -> if (index < photos.itemSnapshotList.size) keyProvider(index) else -1 },
+        photoProvider = { index -> photos[index]!! },
+        modifier,
+        contentPadding,
+        checkedItemIds,
+        onCheckedToggled,
+        imageProvider
+    )
+}
+
+@Composable
+fun GalleryChosenPhotoGrid(
+    photoCount: Int,
+    keyProvider: (Int) -> Any,
+    photoProvider: (Int) -> ChosenPhoto,
+    modifier: Modifier = Modifier,
+    contentPadding: PaddingValues = PaddingValues(0.dp),
+    checkedItemIds: Set<Long> = emptySet(),
+    onCheckedToggled: (ChosenPhoto) -> Unit = {},
+    imageProvider: (ChosenPhoto, Int) -> List<Uri>,
+) {
+    var lastTouchInfo by remember { mutableStateOf<TouchInfo?>(null) }
+    LazyVerticalGrid(
+        columns = GridCells.Adaptive(150.dp),
+        modifier = modifier,
+        contentPadding = contentPadding,
+    ) {
+        items(
+            photoCount,
+            key = keyProvider
+        ) { index ->
+            val photo = photoProvider(index)
+            val isChecked = photo.id in checkedItemIds
+            GalleryChosenPhotoItem(
+                chosenPhoto = photo,
+                modifier = Modifier
+                    .animateItem()
+                    .pointerInput(Unit) {
+                        detectTapGestures(
+                            onPress = { offset ->
+                                lastTouchInfo = TouchInfo(photo, offset)
+                            },
+                            onTap = {
+                                onCheckedToggled(photo)
+                            }
+                        )
+                    },
+                checked = isChecked,
+                touchLocation = if (lastTouchInfo?.photo == photo) lastTouchInfo?.offset else null,
+                imageProvider = imageProvider
+            )
+        }
+    }
+}
+
+@OptIn(ExperimentalMaterial3Api::class, ExperimentalCoilApi::class)
+@Preview
+@Composable
+fun GalleryChosenPhotoGridPreview() {
+    val colors = buildList {
+        addAll(listOf(Color.Cyan, Color.DarkGray, Color.Magenta, Color.LightGray))
+        repeat(10) {
+            addAll(listOf(Color.Red, Color.Green, Color.Blue, Color.Yellow))
+        }
+    }
+    val previewHandler = AsyncImagePreviewHandler { request ->
+        ColorImage(colors[request.data.toString().toInt().mod(colors.size)].toArgb())
+    }
+    CompositionLocalProvider(LocalAsyncImagePreviewHandler provides previewHandler) {
+        GalleryTheme(
+            dynamicColor = false,
+        ) {
+            GalleryChosenPhotoGrid(
+                photos = colors.drop(4).mapIndexed { index, color ->
+                    ChosenPhoto(
+                        uri = (index + 4).toString().toUri(),
+                        isTreeUri = (index + 1) % 5 == 0
+                    )
+                },
+                imageProvider = { _, _ -> listOf("0".toUri(), "1".toUri(), "2".toUri()) },
+            )
+        }
+    }
+}
+
+@OptIn(ExperimentalMaterial3Api::class, ExperimentalCoilApi::class)
+@Preview
+@Composable
+fun GalleryChosenPhotoGridCheckedPreview() {
+    val colors = buildList {
+        addAll(listOf(Color.Cyan, Color.DarkGray, Color.Magenta, Color.LightGray))
+        repeat(10) {
+            addAll(listOf(Color.Red, Color.Green, Color.Blue, Color.Yellow))
+        }
+    }
+    val previewHandler = AsyncImagePreviewHandler { request ->
+        ColorImage(colors[request.data.toString().toInt().mod(colors.size)].toArgb())
+    }
+    CompositionLocalProvider(LocalAsyncImagePreviewHandler provides previewHandler) {
+        GalleryTheme(
+            dynamicColor = false,
+        ) {
+            GalleryChosenPhotoGrid(
+                photos = colors.drop(4).mapIndexed { index, color ->
+                    ChosenPhoto(
+                        uri = (index + 4).toString().toUri(),
+                        isTreeUri = (index + 1) % 5 == 0
+                    ).apply {
+                        id = index.toLong()
+                    }
+                },
+                checkedItemIds = buildSet {
+                    colors.forEachIndexed { index, _ ->
+                        if (index == 0 || (index + 1) % 7 == 0) {
+                            add(index.toLong())
+                        }
+                    }
+                },
+                imageProvider = { _, _ -> listOf("0".toUri(), "1".toUri(), "2".toUri()) },
+            )
+        }
+    }
+}
\ No newline at end of file
diff --git a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoItem.kt b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoItem.kt
index 353228ca4..a284d9742 100644
--- a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoItem.kt
+++ b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GalleryChosenPhotoItem.kt
@@ -66,12 +66,13 @@ import kotlin.math.max
 @Composable
 fun GalleryChosenPhotoItem(
     chosenPhoto: ChosenPhoto,
+    modifier: Modifier = Modifier,
     checked: Boolean = false,
     touchLocation: Offset? = null,
     imageProvider: (chosenPhoto: ChosenPhoto, maxImages: Int) -> List<Uri>,
 ) {
     Box(
-        modifier = Modifier.aspectRatio(1f)
+        modifier = modifier.aspectRatio(1f)
     ) {
         val images = if (chosenPhoto.isTreeUri) {
             imageProvider(chosenPhoto, 4)
diff --git a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
index 45c4b12e1..ac087245d 100644
--- a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
+++ b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
@@ -31,11 +31,8 @@ import android.util.Log
 import android.view.Menu
 import android.view.MenuInflater
 import android.view.MenuItem
-import android.view.MotionEvent
 import android.view.View
 import android.view.ViewAnimationUtils
-import android.view.ViewGroup
-import android.view.ViewTreeObserver
 import android.widget.Toast
 import androidx.activity.OnBackPressedCallback
 import androidx.activity.result.contract.ActivityResultContract
@@ -43,20 +40,26 @@ import androidx.activity.result.contract.ActivityResultContracts
 import androidx.activity.result.launch
 import androidx.activity.viewModels
 import androidx.appcompat.app.AppCompatActivity
-import androidx.compose.ui.geometry.Offset
-import androidx.compose.ui.platform.ComposeView
+import androidx.compose.foundation.layout.PaddingValues
+import androidx.compose.foundation.layout.WindowInsets
+import androidx.compose.foundation.layout.WindowInsetsSides
+import androidx.compose.foundation.layout.asPaddingValues
+import androidx.compose.foundation.layout.only
+import androidx.compose.foundation.layout.padding
+import androidx.compose.foundation.layout.safeDrawing
+import androidx.compose.runtime.LaunchedEffect
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.mutableStateOf
+import androidx.compose.runtime.remember
+import androidx.compose.runtime.setValue
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.res.dimensionResource
+import androidx.compose.ui.unit.dp
 import androidx.core.content.edit
-import androidx.core.graphics.Insets
 import androidx.core.view.MenuProvider
-import androidx.core.view.ViewCompat
-import androidx.core.view.WindowInsetsCompat
 import androidx.core.view.isVisible
 import androidx.lifecycle.lifecycleScope
-import androidx.paging.PagingDataAdapter
-import androidx.recyclerview.widget.DefaultItemAnimator
-import androidx.recyclerview.widget.DiffUtil
-import androidx.recyclerview.widget.GridLayoutManager
-import androidx.recyclerview.widget.RecyclerView
+import androidx.paging.compose.collectAsLazyPagingItems
 import com.google.android.apps.muzei.gallery.databinding.GalleryActivityBinding
 import com.google.android.apps.muzei.gallery.theme.GalleryTheme
 import com.google.android.apps.muzei.util.MultiSelectionController
@@ -64,6 +67,7 @@ import com.google.android.apps.muzei.util.addMenuProvider
 import com.google.android.apps.muzei.util.collectIn
 import com.google.android.apps.muzei.util.getString
 import com.google.android.apps.muzei.util.getStringOrNull
+import com.google.android.apps.muzei.util.plus
 import com.google.android.apps.muzei.util.toast
 import com.google.android.material.snackbar.Snackbar
 import kotlinx.coroutines.Dispatchers
@@ -118,18 +122,6 @@ class GallerySettingsActivity : AppCompatActivity(),
         private const val TAG = "GallerySettingsActivity"
         private const val SHARED_PREF_NAME = "GallerySettingsActivity"
         private const val SHOW_INTERNAL_STORAGE_MESSAGE = "show_internal_storage_message"
-
-        internal val CHOSEN_PHOTO_DIFF_CALLBACK: DiffUtil.ItemCallback<ChosenPhoto> = object : DiffUtil.ItemCallback<ChosenPhoto>() {
-            override fun areItemsTheSame(oldItem: ChosenPhoto, newItem: ChosenPhoto): Boolean {
-                return oldItem.uri == newItem.uri
-            }
-
-            override fun areContentsTheSame(oldItem: ChosenPhoto, newItem: ChosenPhoto): Boolean {
-                // If the items are the same (same image URI), then they are equivalent and
-                // no change animation is needed
-                return true
-            }
-        }
     }
 
     private val viewModel: GallerySettingsViewModel by viewModels()
@@ -164,8 +156,6 @@ class GallerySettingsActivity : AppCompatActivity(),
 
     private lateinit var binding: GalleryActivityBinding
 
-    private var itemSize = 10
-
     private val multiSelectionController = MultiSelectionController(this)
 
     private val addToolbarOnBackPressedCallback = object : OnBackPressedCallback(false) {
@@ -174,13 +164,7 @@ class GallerySettingsActivity : AppCompatActivity(),
         }
     }
 
-    private var updatePosition = -1
-
-    private var lastTouchPosition: Int = 0
-    private var lastTouchX: Int = 0
-    private var lastTouchY: Int = 0
-
-    private val chosenPhotosAdapter = GalleryAdapter()
+    private var chosenPhotosCount = 0
 
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
@@ -191,62 +175,40 @@ class GallerySettingsActivity : AppCompatActivity(),
 
         setupMultiSelect()
 
-        val gridLayoutManager = GridLayoutManager(this, 1)
-        binding.photoGrid.apply {
-            layoutManager = gridLayoutManager
-            itemAnimator = DefaultItemAnimator().apply {
-                supportsChangeAnimations = false
-            }
-        }
-
-        val vto = binding.photoGrid.viewTreeObserver
-        vto.addOnGlobalLayoutListener(object : ViewTreeObserver.OnGlobalLayoutListener {
-            override fun onGlobalLayout() {
-                val width = (binding.photoGrid.width
-                        - binding.photoGrid.paddingStart - binding.photoGrid.paddingEnd)
-                if (width <= 0) {
-                    return
-                }
-
-                // Compute number of columns
-                val maxItemWidth = resources.getDimensionPixelSize(
-                        R.dimen.gallery_chosen_photo_grid_max_item_size)
-                var numColumns = 1
-                while (true) {
-                    if (width / numColumns > maxItemWidth) {
-                        ++numColumns
-                    } else {
-                        break
+        binding.photoGrid.setContent {
+            GalleryTheme(
+                dynamicColor = false
+            ) {
+                val photos = viewModel.chosenPhotos.collectAsLazyPagingItems()
+                val selectedItems = multiSelectionController.selection
+                var firstIdle by remember { mutableStateOf(true) }
+                LaunchedEffect(photos.loadState.isIdle) {
+                    if (photos.loadState.isIdle) {
+                        if (firstIdle) {
+                            tryUpdateSelection(false)
+                            firstIdle = false
+                        }
+                        chosenPhotosCount = photos.itemCount
+                        onDataSetChanged()
                     }
                 }
-
-                val spacing = resources.getDimensionPixelSize(
-                        R.dimen.gallery_chosen_photo_grid_spacing)
-                itemSize = (width - spacing * (numColumns - 1)) / numColumns
-
-                // Complete setup
-                gridLayoutManager.spanCount = numColumns
-                binding.photoGrid.adapter = chosenPhotosAdapter
-
-                binding.photoGrid.viewTreeObserver.removeOnGlobalLayoutListener(this)
-                tryUpdateSelection(false)
+                GalleryChosenPhotoGrid(
+                    photos = photos,
+                    modifier = Modifier.padding(bottom = 90.dp),
+                    contentPadding = WindowInsets.safeDrawing
+                        .only(WindowInsetsSides.Horizontal + WindowInsetsSides.Bottom)
+                        .asPaddingValues() + PaddingValues(bottom = 90.dp),
+                    checkedItemIds = selectedItems,
+                    onCheckedToggled = { chosenPhoto ->
+                        multiSelectionController.toggle(chosenPhoto.id, true)
+                    },
+                ) { chosenPhoto, maxImages ->
+                    if (chosenPhoto.isTreeUri)
+                        getImagesFromTreeUri(chosenPhoto.uri, maxImages)
+                    else
+                        listOf(chosenPhoto.contentUri)
+                }
             }
-        })
-
-        ViewCompat.setOnApplyWindowInsetsListener(binding.photoGrid) { v, insets ->
-            val gridSpacing = resources
-                    .getDimensionPixelSize(R.dimen.gallery_chosen_photo_grid_spacing)
-            @Suppress("DEPRECATION")
-            ViewCompat.onApplyWindowInsets(v, WindowInsetsCompat.Builder(insets)
-                    .setSystemWindowInsets(Insets.of(
-                            insets.systemWindowInsetLeft + gridSpacing,
-                            gridSpacing,
-                            insets.systemWindowInsetRight + gridSpacing,
-                            insets.systemWindowInsetBottom +
-                                    insets.systemWindowInsetTop + gridSpacing +
-                                    resources.getDimensionPixelSize(R.dimen.gallery_fab_space)))
-                    .build())
-            insets
         }
 
         binding.reselectSelectedPhotos.setOnClickListener {
@@ -287,12 +249,6 @@ class GallerySettingsActivity : AppCompatActivity(),
                 hideAddToolbar(true)
             }
         }
-        viewModel.chosenPhotos.collectIn(this) {
-            chosenPhotosAdapter.submitData(it)
-        }
-        chosenPhotosAdapter.onPagesUpdatedFlow.collectIn(this) {
-            onDataSetChanged()
-        }
         addMenuProvider(this)
         viewModel.getContentActivityInfoList.map {
             it.size
@@ -463,15 +419,7 @@ class GallerySettingsActivity : AppCompatActivity(),
         hideAnimator.start()
     }
 
-    @SuppressLint("NotifyDataSetChanged")
     private fun tryUpdateSelection(allowAnimate: Boolean) {
-        if (updatePosition >= 0) {
-            chosenPhotosAdapter.notifyItemChanged(updatePosition)
-            updatePosition = -1
-        } else {
-            chosenPhotosAdapter.notifyDataSetChanged()
-        }
-
         val selectedCount = multiSelectionController.selectedCount
         val toolbarVisible = selectedCount > 0
 
@@ -555,7 +503,7 @@ class GallerySettingsActivity : AppCompatActivity(),
     }
 
     private fun onDataSetChanged() {
-        if (chosenPhotosAdapter.itemCount != 0) {
+        if (chosenPhotosCount != 0) {
             binding.empty.visibility = View.GONE
             // We have at least one image, so consider the Gallery source properly setup
             setResult(RESULT_OK)
@@ -593,61 +541,6 @@ class GallerySettingsActivity : AppCompatActivity(),
         }
     }
 
-    internal class PhotoViewHolder(
-            val composeView: ComposeView
-    ) : RecyclerView.ViewHolder(composeView)
-
-    private inner class GalleryAdapter : PagingDataAdapter<ChosenPhoto, PhotoViewHolder>(CHOSEN_PHOTO_DIFF_CALLBACK) {
-
-        @SuppressLint("ClickableViewAccessibility")
-        override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): PhotoViewHolder {
-            val composeView = ComposeView(parent.context)
-            val vh = PhotoViewHolder(composeView)
-
-            composeView.setOnTouchListener { _, motionEvent ->
-                if (motionEvent.actionMasked != MotionEvent.ACTION_CANCEL) {
-                    lastTouchPosition = vh.bindingAdapterPosition
-                    lastTouchX = motionEvent.x.toInt()
-                    lastTouchY = motionEvent.y.toInt()
-                }
-                false
-            }
-            composeView.setOnClickListener {
-                updatePosition = vh.bindingAdapterPosition
-                if (updatePosition != RecyclerView.NO_POSITION) {
-                    val chosenPhoto = getItem(updatePosition)
-                    multiSelectionController.toggle(chosenPhoto?.id ?: -1, true)
-                }
-            }
-
-            return vh
-        }
-
-        override fun onBindViewHolder(vh: PhotoViewHolder, position: Int) {
-            vh.composeView.setContent {
-                val chosenPhoto = getItem(position) ?: return@setContent
-                GalleryTheme(
-                    dynamicColor = false
-                ) {
-                    GalleryChosenPhotoItem(
-                        chosenPhoto,
-                        checked = multiSelectionController.isSelected(chosenPhoto.id),
-                        touchLocation = if (lastTouchPosition == vh.bindingAdapterPosition) {
-                            Offset(lastTouchX.toFloat(), lastTouchY.toFloat())
-                        } else {
-                            null
-                        }
-                    ) { chosenPhoto, maxImages ->
-                        if (chosenPhoto.isTreeUri)
-                            getImagesFromTreeUri(chosenPhoto.uri, maxImages)
-                        else
-                            listOf(chosenPhoto.contentUri)
-                    }
-                }
-            }
-        }
-    }
-
     private fun getImagesFromTreeUri(treeUri: Uri, maxImages: Int): List<Uri> {
         val images = ArrayList<Uri>()
         val directories = LinkedList<String>()
diff --git a/source-gallery/src/main/java/com/google/android/apps/muzei/util/MultiSelectionController.kt b/source-gallery/src/main/java/com/google/android/apps/muzei/util/MultiSelectionController.kt
index 75d3f05e6..22524ef57 100644
--- a/source-gallery/src/main/java/com/google/android/apps/muzei/util/MultiSelectionController.kt
+++ b/source-gallery/src/main/java/com/google/android/apps/muzei/util/MultiSelectionController.kt
@@ -17,12 +17,12 @@
 package com.google.android.apps.muzei.util
 
 import androidx.activity.OnBackPressedCallback
+import androidx.compose.runtime.snapshots.SnapshotStateSet
 import androidx.core.os.bundleOf
 import androidx.lifecycle.DefaultLifecycleObserver
 import androidx.lifecycle.LifecycleOwner
 import androidx.savedstate.SavedStateRegistry
 import androidx.savedstate.SavedStateRegistryOwner
-import java.util.HashSet
 
 /**
  * Utilities for storing multiple selection information in collection views.
@@ -38,7 +38,7 @@ class MultiSelectionController(
     private val lifecycle = savedStateRegistryOwner.lifecycle
     private val savedStateRegistry = savedStateRegistryOwner.savedStateRegistry
 
-    val selection = HashSet<Long>()
+    val selection = SnapshotStateSet<Long>()
     var callbacks: Callbacks? = null
 
     val selectedCount: Int
@@ -87,10 +87,6 @@ class MultiSelectionController(
         callbacks?.onSelectionChanged(false, fromUser)
     }
 
-    fun isSelected(item: Long): Boolean {
-        return selection.contains(item)
-    }
-
     fun interface Callbacks {
         fun onSelectionChanged(restored: Boolean, fromUser: Boolean)
     }
diff --git a/source-gallery/src/main/res/layout/gallery_activity.xml b/source-gallery/src/main/res/layout/gallery_activity.xml
index b5aab71ff..30b65eba2 100644
--- a/source-gallery/src/main/res/layout/gallery_activity.xml
+++ b/source-gallery/src/main/res/layout/gallery_activity.xml
@@ -22,19 +22,11 @@
     android:fitsSystemWindows="true"
     app:statusBarBackground="?android:colorBackground">
 
-    <androidx.recyclerview.widget.RecyclerView
+    <androidx.compose.ui.platform.ComposeView
         android:id="@+id/photo_grid"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
-        android:gravity="center"
-        android:stretchMode="columnWidth"
-        android:scrollbarStyle="outsideOverlay"
-        android:scrollbars="vertical"
-        android:clipToPadding="false"
         android:fitsSystemWindows="true"
-        android:drawSelectorOnTop="true"
-        android:horizontalSpacing="@dimen/gallery_chosen_photo_grid_spacing"
-        android:verticalSpacing="@dimen/gallery_chosen_photo_grid_spacing"
         app:layout_behavior="@string/appbar_scrolling_view_behavior"/>
 
     <com.google.android.material.appbar.AppBarLayout
diff --git a/source-gallery/src/main/res/values-sw600dp/dimens.xml b/source-gallery/src/main/res/values-sw600dp/dimens.xml
deleted file mode 100644
index de5640ccb..000000000
--- a/source-gallery/src/main/res/values-sw600dp/dimens.xml
+++ /dev/null
@@ -1,20 +0,0 @@
-<!--
-  Copyright 2014 Google Inc.
-
-  Licensed under the Apache License, Version 2.0 (the "License");
-  you may not use this file except in compliance with the License.
-  You may obtain a copy of the License at
-
-      http://www.apache.org/licenses/LICENSE-2.0
-
-  Unless required by applicable law or agreed to in writing, software
-  distributed under the License is distributed on an "AS IS" BASIS,
-  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  See the License for the specific language governing permissions and
-  limitations under the License.
-  -->
-
-<resources>
-    <dimen name="gallery_chosen_photo_grid_max_item_size">300dp</dimen>
-    <dimen name="gallery_chosen_photo_grid_spacing">2dp</dimen>
-</resources>
diff --git a/source-gallery/src/main/res/values/dimens.xml b/source-gallery/src/main/res/values/dimens.xml
index 5d6d1550f..aafbf24bc 100644
--- a/source-gallery/src/main/res/values/dimens.xml
+++ b/source-gallery/src/main/res/values/dimens.xml
@@ -15,9 +15,6 @@
   -->
 
 <resources>
-    <dimen name="gallery_chosen_photo_grid_max_item_size">200dp</dimen>
-    <dimen name="gallery_chosen_photo_grid_spacing">2dp</dimen>
-    <dimen name="gallery_fab_space">96dp</dimen>
     <dimen name="gallery_fab_margin">16dp</dimen>
     <dimen name="gallery_fab_toolbar_height">56dp</dimen>
     <dimen name="gallery_header_elevation">4dp</dimen>
