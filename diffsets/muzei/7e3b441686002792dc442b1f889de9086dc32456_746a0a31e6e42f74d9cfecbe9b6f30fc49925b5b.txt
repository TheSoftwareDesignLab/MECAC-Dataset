diff --git a/build.gradle b/build.gradle
index 223588be2..b2888b512 100644
--- a/build.gradle
+++ b/build.gradle
@@ -19,12 +19,12 @@ buildscript {
         compileSdkVersion = 29
         targetSdkVersion = 29
 
-        appCompatVersion = '1.1.0'
+        appCompatVersion = '1.2.0-alpha02'
         archCoreVersion = '2.1.0'
         browserVersion = '1.2.0'
         coilVersion = '0.9.1'
         constraintLayoutVersion = '2.0.0-beta4'
-        coreVersion = '1.2.0-rc01'
+        coreVersion = '1.3.0-alpha01'
         coroutinesVersion = '1.3.3'
         dokkaVersion = '0.10.0'
         drawerLayoutVersion = '1.1.0-alpha03'
@@ -32,13 +32,13 @@ buildscript {
         firebaseAnalyticsVersion = '17.2.1'
         firebaseCrashlyticsVersion = '17.0.0-beta01'
         firebasePerfVersion = '19.0.5'
-        fragmentVersion = '1.2.0-rc05'
+        fragmentVersion = '1.2.0'
         kotlinVersion = '1.3.61'
-        lifecycleVersion = '2.2.0-rc03'
+        lifecycleVersion = '2.2.0'
         localeVersion = '1.0.4'
         materialVersion = '1.1.0-rc02'
         multidexVersion = '2.0.1'
-        navigationVersion = '2.2.0-rc04'
+        navigationVersion = '2.2.0'
         okhttpVersion = '3.12.6'
         pagingVersion = '2.1.1'
         playServicesWearableVersion = '17.0.0'
@@ -50,7 +50,7 @@ buildscript {
         swipeRefreshLayoutVersion = '1.1.0-alpha03'
         wearableVersion = '2.5.0'
         wearVersion = '1.0.0'
-        workManagerVersion = '2.3.0-rc01'
+        workManagerVersion = '2.3.0'
     }
 
     repositories {
diff --git a/main/src/main/java/com/google/android/apps/muzei/MainFragment.kt b/main/src/main/java/com/google/android/apps/muzei/MainFragment.kt
index a26337806..571df389b 100644
--- a/main/src/main/java/com/google/android/apps/muzei/MainFragment.kt
+++ b/main/src/main/java/com/google/android/apps/muzei/MainFragment.kt
@@ -21,7 +21,9 @@ import android.os.Build
 import android.os.Bundle
 import android.view.View
 import androidx.core.content.ContextCompat
+import androidx.core.graphics.Insets
 import androidx.core.view.ViewCompat
+import androidx.core.view.WindowInsetsCompat
 import androidx.fragment.app.Fragment
 import androidx.navigation.fragment.NavHostFragment
 import androidx.navigation.ui.setupWithNavController
@@ -110,16 +112,18 @@ class MainFragment : Fragment(R.layout.main_fragment), ChooseProviderFragment.Ca
         ViewCompat.setOnApplyWindowInsetsListener(view) { _, insets ->
             // Ensure the container gets the appropriate insets
             ViewCompat.dispatchApplyWindowInsets(container,
-                    insets.replaceSystemWindowInsets(insets.systemWindowInsetLeft,
+                    WindowInsetsCompat.Builder(insets).setSystemWindowInsets(Insets.of(
+                            insets.systemWindowInsetLeft,
                             insets.systemWindowInsetTop,
                             insets.systemWindowInsetRight,
-                            0))
+                            0)).build())
             ViewCompat.dispatchApplyWindowInsets(bottomNavigationView,
-                    insets.replaceSystemWindowInsets(insets.systemWindowInsetLeft,
+                    WindowInsetsCompat.Builder(insets).setSystemWindowInsets(Insets.of(
+                            insets.systemWindowInsetLeft,
                             0,
                             insets.systemWindowInsetRight,
-                            insets.systemWindowInsetBottom))
-            insets.consumeSystemWindowInsets().consumeDisplayCutout()
+                            insets.systemWindowInsetBottom)).build())
+            insets.consumeSystemWindowInsets()?.consumeDisplayCutout()
         }
 
         // Listen for visibility changes to know when to hide our views
diff --git a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
index 2a196e753..c85069fe4 100644
--- a/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
+++ b/source-gallery/src/main/java/com/google/android/apps/muzei/gallery/GallerySettingsActivity.kt
@@ -54,7 +54,9 @@ import androidx.appcompat.widget.Toolbar
 import androidx.core.app.ActivityCompat
 import androidx.core.content.ContextCompat
 import androidx.core.content.edit
+import androidx.core.graphics.Insets
 import androidx.core.view.ViewCompat
+import androidx.core.view.WindowInsetsCompat
 import androidx.lifecycle.LiveData
 import androidx.lifecycle.Observer
 import androidx.lifecycle.lifecycleScope
@@ -195,12 +197,15 @@ class GallerySettingsActivity : AppCompatActivity(), Observer<PagedList<ChosenPh
         ViewCompat.setOnApplyWindowInsetsListener(photoGridView) { v, insets ->
             val gridSpacing = resources
                     .getDimensionPixelSize(R.dimen.gallery_chosen_photo_grid_spacing)
-            ViewCompat.onApplyWindowInsets(v, insets.replaceSystemWindowInsets(
-                    insets.systemWindowInsetLeft + gridSpacing,
-                    gridSpacing,
-                    insets.systemWindowInsetRight + gridSpacing,
-                    insets.systemWindowInsetBottom + insets.systemWindowInsetTop + gridSpacing +
-                            resources.getDimensionPixelSize(R.dimen.gallery_fab_space)))
+            ViewCompat.onApplyWindowInsets(v, WindowInsetsCompat.Builder(insets)
+                    .setSystemWindowInsets(Insets.of(
+                            insets.systemWindowInsetLeft + gridSpacing,
+                            gridSpacing,
+                            insets.systemWindowInsetRight + gridSpacing,
+                            insets.systemWindowInsetBottom +
+                                    insets.systemWindowInsetTop + gridSpacing +
+                                    resources.getDimensionPixelSize(R.dimen.gallery_fab_space)))
+                    .build())
             insets
         }
 
