diff --git a/app/build.gradle b/app/build.gradle
index 47431b2678..700654752d 100644
--- a/app/build.gradle
+++ b/app/build.gradle
@@ -160,9 +160,7 @@ dependencies {
     implementation('org.scala-saddle:google-rfc-2445:20110304') {
         transitive = false
     }
-    implementation('com.wdullaer:materialdatetimepicker:3.6.1') {
-        exclude group: 'com.android.support', module: 'support-v4'
-    }
+    implementation('com.wdullaer:materialdatetimepicker:4.0.1')
     implementation "me.leolin:ShortcutBadger:1.1.22@aar"
     implementation 'com.google.apis:google-api-services-tasks:v1-rev52-1.23.0'
     implementation 'com.google.api-client:google-api-client-android:1.23.0'
diff --git a/app/src/main/java/org/tasks/activities/DateAndTimePickerActivity.java b/app/src/main/java/org/tasks/activities/DateAndTimePickerActivity.java
index f0f5335a37..baa2935719 100644
--- a/app/src/main/java/org/tasks/activities/DateAndTimePickerActivity.java
+++ b/app/src/main/java/org/tasks/activities/DateAndTimePickerActivity.java
@@ -47,12 +47,13 @@ protected void onCreate(Bundle savedInstanceState) {
       }
     }
 
-    FragmentManager fragmentManager = getFragmentManager();
     if (preferences.getBoolean(R.string.p_use_native_datetime_pickers, false)) {
+      FragmentManager fragmentManager = getFragmentManager();
       if (fragmentManager.findFragmentByTag(FRAG_TAG_DATE_PICKER) == null) {
         newNativeDatePickerDialog(initial).show(fragmentManager, FRAG_TAG_DATE_PICKER);
       }
     } else {
+      androidx.fragment.app.FragmentManager fragmentManager = getSupportFragmentManager();
       MyDatePickerDialog datePickerDialog =
           (MyDatePickerDialog) fragmentManager.findFragmentByTag(FRAG_TAG_DATE_PICKER);
       if (datePickerDialog == null) {
diff --git a/app/src/main/java/org/tasks/activities/DatePickerActivity.java b/app/src/main/java/org/tasks/activities/DatePickerActivity.java
index 11984ad8ff..141528ddf6 100644
--- a/app/src/main/java/org/tasks/activities/DatePickerActivity.java
+++ b/app/src/main/java/org/tasks/activities/DatePickerActivity.java
@@ -3,14 +3,14 @@
 import static org.tasks.dialogs.NativeDatePickerDialog.newNativeDatePickerDialog;
 import static org.tasks.time.DateTimeUtils.currentTimeMillis;
 
-import android.app.FragmentManager;
 import android.content.Intent;
 import android.os.Bundle;
+import androidx.fragment.app.FragmentManager;
 import com.wdullaer.materialdatetimepicker.date.DatePickerDialog;
 import javax.inject.Inject;
 import org.tasks.R;
 import org.tasks.dialogs.MyDatePickerDialog;
-import org.tasks.dialogs.NativeDatePickerDialog;
+import org.tasks.dialogs.NativeDatePickerDialog.NativeDatePickerDialogCallback;
 import org.tasks.injection.ActivityComponent;
 import org.tasks.injection.InjectingAppCompatActivity;
 import org.tasks.preferences.Preferences;
@@ -19,8 +19,7 @@
 import org.tasks.time.DateTime;
 
 public class DatePickerActivity extends InjectingAppCompatActivity
-    implements DatePickerDialog.OnDateSetListener,
-        NativeDatePickerDialog.NativeDatePickerDialogCallback {
+    implements DatePickerDialog.OnDateSetListener, NativeDatePickerDialogCallback {
 
   public static final String EXTRA_TIMESTAMP = "extra_timestamp";
   private static final String FRAG_TAG_DATE_PICKER = "frag_tag_date_picker";
@@ -31,17 +30,16 @@ public class DatePickerActivity extends InjectingAppCompatActivity
   @Override
   protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
-
     long timestamp = getIntent().getLongExtra(EXTRA_TIMESTAMP, currentTimeMillis());
     DateTime initial = (timestamp > 0 ? new DateTime(timestamp) : new DateTime()).startOfDay();
 
-    FragmentManager fragmentManager = getFragmentManager();
-
     if (preferences.getBoolean(R.string.p_use_native_datetime_pickers, false)) {
+      android.app.FragmentManager fragmentManager = getFragmentManager();
       if (fragmentManager.findFragmentByTag(FRAG_TAG_DATE_PICKER) == null) {
         newNativeDatePickerDialog(initial).show(fragmentManager, FRAG_TAG_DATE_PICKER);
       }
     } else {
+      FragmentManager fragmentManager = getSupportFragmentManager();
       MyDatePickerDialog dialog =
           (MyDatePickerDialog) fragmentManager.findFragmentByTag(FRAG_TAG_DATE_PICKER);
       if (dialog == null) {
diff --git a/app/src/main/java/org/tasks/activities/TimePickerActivity.java b/app/src/main/java/org/tasks/activities/TimePickerActivity.java
index 72e1069d0b..07e74296e6 100644
--- a/app/src/main/java/org/tasks/activities/TimePickerActivity.java
+++ b/app/src/main/java/org/tasks/activities/TimePickerActivity.java
@@ -37,12 +37,13 @@ protected void onCreate(Bundle savedInstanceState) {
 
     initial = new DateTime(getIntent().getLongExtra(EXTRA_TIMESTAMP, currentTimeMillis()));
 
-    FragmentManager fragmentManager = getFragmentManager();
     if (preferences.getBoolean(R.string.p_use_native_datetime_pickers, false)) {
+      FragmentManager fragmentManager = getFragmentManager();
       if (fragmentManager.findFragmentByTag(FRAG_TAG_TIME_PICKER) == null) {
         newNativeTimePickerDialog(initial).show(fragmentManager, FRAG_TAG_TIME_PICKER);
       }
     } else {
+      androidx.fragment.app.FragmentManager fragmentManager = getSupportFragmentManager();
       MyTimePickerDialog dialog =
           (MyTimePickerDialog) fragmentManager.findFragmentByTag(FRAG_TAG_TIME_PICKER);
       if (dialog == null) {
diff --git a/app/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java b/app/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
index a6300c79d3..5b907724a8 100644
--- a/app/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
+++ b/app/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
@@ -6,6 +6,7 @@
 import android.app.Activity;
 import android.app.DatePickerDialog;
 import android.app.Dialog;
+import android.content.Context;
 import android.content.DialogInterface;
 import android.os.Bundle;
 import android.widget.DatePicker;
@@ -47,9 +48,11 @@ public void onCreate(Bundle savedInstanceState) {
   @Override
   public Dialog onCreateDialog(Bundle savedInstanceState) {
     Bundle args = getArguments();
+    Context context = getActivity();
+    theme.applyToContext(context);
     DatePickerDialog datePickerDialog =
         new DatePickerDialog(
-            theme.wrap(getActivity()),
+            context,
             this,
             args.getInt(EXTRA_YEAR),
             args.getInt(EXTRA_MONTH),
diff --git a/app/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java b/app/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
index e8db2d077d..ed0c635042 100644
--- a/app/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
+++ b/app/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
@@ -40,8 +40,9 @@ public void onCreate(Bundle savedInstanceState) {
 
   @Override
   public Dialog onCreateDialog(Bundle savedInstanceState) {
-    Context context = theme.wrap(getActivity());
     Bundle args = getArguments();
+    Context context = getActivity();
+    theme.applyToContext(context);
     TimePickerDialog timePickerDialog =
         new TimePickerDialog(
             context,
diff --git a/app/src/main/res/values-night/styles.xml b/app/src/main/res/values-night/styles.xml
index 623544c7c5..4721abd9b7 100644
--- a/app/src/main/res/values-night/styles.xml
+++ b/app/src/main/res/values-night/styles.xml
@@ -5,5 +5,5 @@
 
   <style name="DayNightAlert" parent="Theme.MaterialComponents.Dialog.Alert"/>
 
-  <style name="popup_overlay" parent="ThemeOverlay.AppCompat"/>
+  <style name="popup_overlay" parent="ThemeOverlay.MaterialComponents"/>
 </resources>
\ No newline at end of file
diff --git a/app/src/main/res/values/styles.xml b/app/src/main/res/values/styles.xml
index 77fffde653..33a5f4d337 100644
--- a/app/src/main/res/values/styles.xml
+++ b/app/src/main/res/values/styles.xml
@@ -9,7 +9,8 @@
     <item name="android:paddingRight">0dp</item>
   </style>
 
-  <style name="TranslucentDialog" parent="Theme.MaterialComponents.Light.Dialog">
+  <style name="TranslucentDialog" parent="DayNightDialog">
+    <item name="viewInflaterClass">androidx.appcompat.app.AppCompatViewInflater</item>
     <item name="android:windowNoTitle">true</item>
     <item name="android:windowBackground">@android:color/transparent</item>
     <item name="android:colorBackgroundCacheHint">@null</item>
