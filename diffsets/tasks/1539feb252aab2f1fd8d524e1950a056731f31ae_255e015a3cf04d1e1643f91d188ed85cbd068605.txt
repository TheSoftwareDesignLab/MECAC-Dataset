diff --git a/src/main/java/com/todoroo/astrid/backup/TasksXmlImporter.java b/src/main/java/com/todoroo/astrid/backup/TasksXmlImporter.java
index ce70d72c11..cd65014bfb 100644
--- a/src/main/java/com/todoroo/astrid/backup/TasksXmlImporter.java
+++ b/src/main/java/com/todoroo/astrid/backup/TasksXmlImporter.java
@@ -168,7 +168,7 @@ private void showSummary() {
                         r.getQuantityString(R.plurals.Ntasks, importCount, importCount),
                         r.getQuantityString(R.plurals.Ntasks, skipCount, skipCount),
                         r.getQuantityString(R.plurals.Ntasks, errorCount, errorCount)))
-                .setPositiveButton(context.getString(android.R.string.ok), new DialogInterface.OnClickListener() {
+                .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                     @Override
                     public void onClick(DialogInterface dialog, int id) {
                         dialog.dismiss();
diff --git a/src/main/java/com/todoroo/astrid/core/CustomFilterAdapter.java b/src/main/java/com/todoroo/astrid/core/CustomFilterAdapter.java
index b0eea1a790..78b04d028e 100644
--- a/src/main/java/com/todoroo/astrid/core/CustomFilterAdapter.java
+++ b/src/main/java/com/todoroo/astrid/core/CustomFilterAdapter.java
@@ -7,7 +7,6 @@
 
 import android.content.DialogInterface;
 import android.content.DialogInterface.OnClickListener;
-import android.support.v7.app.AlertDialog;
 import android.view.ContextMenu;
 import android.view.LayoutInflater;
 import android.view.MenuItem;
@@ -24,6 +23,7 @@
 import com.todoroo.astrid.core.CustomFilterActivity.CriterionInstance;
 
 import org.tasks.R;
+import org.tasks.dialogs.AlertDialogBuilder;
 import org.tasks.dialogs.DialogBuilder;
 
 import java.util.List;
@@ -104,7 +104,7 @@ public void onCreateContextMenu(ContextMenu menu, View v) {
      * Show options menu for the given criterioninstance
      */
     public void showOptionsFor(final CriterionInstance item, final Runnable onComplete) {
-        AlertDialog.Builder dialog = dialogBuilder.newDialog()
+        AlertDialogBuilder dialog = dialogBuilder.newDialog()
                 .setTitle(item.criterion.name);
 
         if(item.criterion instanceof MultipleSelectCriterion) {
diff --git a/src/main/java/com/todoroo/astrid/repeats/RepeatControlSet.java b/src/main/java/com/todoroo/astrid/repeats/RepeatControlSet.java
index 5f267e0933..3b4440f8e4 100644
--- a/src/main/java/com/todoroo/astrid/repeats/RepeatControlSet.java
+++ b/src/main/java/com/todoroo/astrid/repeats/RepeatControlSet.java
@@ -310,13 +310,13 @@ void clearRepeat(View view) {
     @OnClick(R.id.display_row_edit)
     void openPopup(View view) {
         if (dialog == null) {
-            buildDialog();
+            dialog = buildDialog();
         }
         dialog.show();
     }
 
-    protected Dialog buildDialog() {
-        AlertDialog.Builder builder = dialogBuilder.newDialog()
+    private AlertDialog buildDialog() {
+        return dialogBuilder.newDialog()
                 .setView(dialogView)
                 .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                     @Override
@@ -333,9 +333,8 @@ public void onClick(DialogInterface dialog, int which) {
                     public void onCancel(DialogInterface dialog) {
                         refreshDisplayView();
                     }
-                });
-        dialog = builder.show();
-        return dialog;
+                })
+                .create();
     }
 
     @Override
@@ -442,14 +441,15 @@ protected void repeatValueClick() {
         }
 
         ContextThemeWrapper wrapper = new ContextThemeWrapper(getActivity(), themeManager.getDialogThemeResId());
-        themeManager.applyThemeToContext(wrapper);
-        new NumberPickerDialog(wrapper, new OnNumberPickedListener() {
+        NumberPickerDialog dialog = new NumberPickerDialog(wrapper, new OnNumberPickedListener() {
             @Override
             public void onNumberPicked(int number) {
                 setRepeatValue(number);
             }
         }, getResources().getString(R.string.repeat_interval_prompt),
-        dialogValue, 1, 1, 365).show();
+                dialogValue, 1, 1, 365);
+        themeManager.applyThemeToContext(dialog.getContext());
+        dialog.show();
     }
 
     private void repeatUntilClick() {
diff --git a/src/main/java/com/todoroo/astrid/tags/TagsControlSet.java b/src/main/java/com/todoroo/astrid/tags/TagsControlSet.java
index a347623c4e..7206846ba0 100644
--- a/src/main/java/com/todoroo/astrid/tags/TagsControlSet.java
+++ b/src/main/java/com/todoroo/astrid/tags/TagsControlSet.java
@@ -42,6 +42,7 @@
 import com.todoroo.astrid.utility.Flags;
 
 import org.tasks.R;
+import org.tasks.dialogs.AlertDialogBuilder;
 import org.tasks.dialogs.DialogBuilder;
 import org.tasks.injection.FragmentComponent;
 import org.tasks.ui.TaskEditControlFragment;
@@ -162,13 +163,13 @@ public void apply(Task task) {
     @OnClick(R.id.display_row_edit)
     void openPopup(View view) {
         if (dialog == null) {
-            buildDialog();
+            dialog = buildDialog();
         }
         dialog.show();
     }
 
-    protected Dialog buildDialog() {
-        android.support.v7.app.AlertDialog.Builder builder = dialogBuilder.newDialog()
+    private AlertDialog buildDialog() {
+        return dialogBuilder.newDialog()
                 .setView(dialogView)
                 .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                     @Override
@@ -182,9 +183,8 @@ public void onClick(DialogInterface dialog, int which) {
                     public void onCancel(DialogInterface dialog) {
                         refreshDisplayView();
                     }
-                });
-        dialog = builder.show();
-        return dialog;
+                })
+                .create();
     }
 
     private void setTagSelected(String tag) {
diff --git a/src/main/java/com/todoroo/astrid/timers/TimerControlSet.java b/src/main/java/com/todoroo/astrid/timers/TimerControlSet.java
index 21129f5b14..5646926808 100644
--- a/src/main/java/com/todoroo/astrid/timers/TimerControlSet.java
+++ b/src/main/java/com/todoroo/astrid/timers/TimerControlSet.java
@@ -28,6 +28,7 @@
 import com.todoroo.astrid.ui.TimeDurationControlSet;
 
 import org.tasks.R;
+import org.tasks.dialogs.AlertDialogBuilder;
 import org.tasks.dialogs.DialogBuilder;
 import org.tasks.injection.ForActivity;
 import org.tasks.injection.FragmentComponent;
@@ -118,13 +119,13 @@ public void onSaveInstanceState(Bundle outState) {
     @OnClick(R.id.display_row_edit)
     void openPopup(View view) {
         if (dialog == null) {
-            buildDialog();
+            dialog = buildDialog();
         }
         dialog.show();
     }
 
-    protected Dialog buildDialog() {
-        AlertDialog.Builder builder = dialogBuilder.newDialog()
+    private AlertDialog buildDialog() {
+        return dialogBuilder.newDialog()
                 .setView(dialogView)
                 .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                     @Override
@@ -137,9 +138,8 @@ public void onClick(DialogInterface dialog, int which) {
                     public void onCancel(DialogInterface dialog) {
                         refreshDisplayView();
                     }
-                });
-        dialog = builder.show();
-        return dialog;
+                })
+                .create();
     }
 
     @OnClick(R.id.timer_container)
diff --git a/src/main/java/com/todoroo/astrid/ui/TimeDurationControlSet.java b/src/main/java/com/todoroo/astrid/ui/TimeDurationControlSet.java
index effc28a626..543f670939 100644
--- a/src/main/java/com/todoroo/astrid/ui/TimeDurationControlSet.java
+++ b/src/main/java/com/todoroo/astrid/ui/TimeDurationControlSet.java
@@ -70,7 +70,6 @@ public void onNumbersPicked(int[] values) {
     public void onClick(View v) {
         if(dialog == null) {
             ContextThemeWrapper contextThemeWrapper = new ContextThemeWrapper(context, themeManager.getDialogThemeResId());
-            themeManager.applyThemeToContext(contextThemeWrapper);
             dialog = new NNumberPickerDialog(contextThemeWrapper, this,
                     context.getResources().getString(R.string.DLG_hour_minutes),
                     new int[] {0, 0}, new int[] {1, 5}, new int[] {0, 0},
@@ -105,6 +104,7 @@ public int onChanged(int newVal) {
             dialog.setInitialValues(initialValues);
         }
 
+        themeManager.applyThemeToContext(dialog.getContext());
         dialog.show();
     }
 
diff --git a/src/main/java/org/tasks/activities/CalendarSelectionDialog.java b/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
index 13520702c7..01b5c07325 100644
--- a/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
+++ b/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
@@ -4,13 +4,13 @@
 import android.content.DialogInterface;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
-import android.support.v7.app.AlertDialog;
 
 import com.google.common.base.Function;
 
 import org.tasks.R;
 import org.tasks.calendars.AndroidCalendar;
 import org.tasks.calendars.CalendarProvider;
+import org.tasks.dialogs.AlertDialogBuilder;
 import org.tasks.dialogs.DialogBuilder;
 import org.tasks.injection.DialogFragmentComponent;
 import org.tasks.injection.InjectingDialogFragment;
@@ -53,7 +53,7 @@ public String apply(AndroidCalendar androidCalendar) {
             }
         });
 
-        AlertDialog.Builder builder = dialogBuilder.newDialog()
+        AlertDialogBuilder builder = dialogBuilder.newDialog()
                 .setItems(calendarNames.toArray(new String[calendarNames.size()]), new DialogInterface.OnClickListener() {
                     @Override
                     public void onClick(DialogInterface dialog, int which) {
diff --git a/src/main/java/org/tasks/dialogs/AlertDialogBuilder.java b/src/main/java/org/tasks/dialogs/AlertDialogBuilder.java
new file mode 100644
index 0000000000..818aac5a1b
--- /dev/null
+++ b/src/main/java/org/tasks/dialogs/AlertDialogBuilder.java
@@ -0,0 +1,118 @@
+package org.tasks.dialogs;
+
+import android.content.Context;
+import android.content.DialogInterface;
+import android.support.v7.app.AlertDialog;
+import android.support.v7.view.ContextThemeWrapper;
+import android.view.View;
+import android.widget.ListAdapter;
+
+import org.tasks.preferences.ThemeManager;
+
+public class AlertDialogBuilder {
+
+    private final AlertDialog.Builder builder;
+    private final Context context;
+    private final ThemeManager themeManager;
+
+    public AlertDialogBuilder(Context context, ThemeManager themeManager) {
+        this.context = context;
+        this.themeManager = themeManager;
+        ContextThemeWrapper wrapper = new ContextThemeWrapper(context, themeManager.getDialogThemeResId());
+        themeManager.applyThemeToContext(wrapper);
+        builder = new AlertDialog.Builder(wrapper);
+    }
+
+    public AlertDialogBuilder setMessage(int message, Object... formatArgs) {
+        return setMessage(context.getString(message, formatArgs));
+    }
+
+    public AlertDialogBuilder setMessage(String message) {
+        builder.setMessage(message);
+        return this;
+    }
+
+    public AlertDialogBuilder setPositiveButton(int ok, DialogInterface.OnClickListener onClickListener) {
+        builder.setPositiveButton(ok, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setNegativeButton(int cancel, DialogInterface.OnClickListener onClickListener) {
+        builder.setNegativeButton(cancel, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setTitle(int title) {
+        builder.setTitle(title);
+        return this;
+    }
+
+    public AlertDialogBuilder setItems(String[] strings, DialogInterface.OnClickListener onClickListener) {
+        builder.setItems(strings, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setView(View dialogView) {
+        builder.setView(dialogView);
+        return this;
+    }
+
+    public AlertDialogBuilder setOnCancelListener(DialogInterface.OnCancelListener onCancelListener) {
+        builder.setOnCancelListener(onCancelListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setAdapter(ListAdapter adapter, DialogInterface.OnClickListener listener) {
+        builder.setAdapter(adapter, listener);
+        return this;
+    }
+
+    public AlertDialogBuilder setSingleChoiceItems(String[] strings, int selectedIndex, DialogInterface.OnClickListener onClickListener) {
+        builder.setSingleChoiceItems(strings, selectedIndex, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setSingleChoiceItems(ListAdapter adapter, int selectedIndex, DialogInterface.OnClickListener onClickListener) {
+        builder.setSingleChoiceItems(adapter, selectedIndex, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setNeutralButton(int reverse, DialogInterface.OnClickListener onClickListener) {
+        builder.setNeutralButton(reverse, onClickListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setTitle(String title) {
+        builder.setTitle(title);
+        return this;
+    }
+
+    public AlertDialogBuilder setOnDismissListener(DialogInterface.OnDismissListener onDismissListener) {
+        builder.setOnDismissListener(onDismissListener);
+        return this;
+    }
+
+    public AlertDialogBuilder setCancelable(boolean b) {
+        builder.setCancelable(b);
+        return this;
+    }
+
+    public AlertDialog create() {
+        AlertDialog dialog = builder.create();
+        themeManager.applyThemeToContext(dialog.getContext());
+        return dialog;
+    }
+
+    public AlertDialog showThemedListView() {
+        AlertDialog dialog = create();
+        themeManager.applyThemeToContext(dialog.getListView().getContext());
+        dialog.show();
+        return dialog;
+    }
+
+    public AlertDialog show() {
+        AlertDialog dialog = create();
+        dialog.show();
+        return dialog;
+    }
+}
diff --git a/src/main/java/org/tasks/dialogs/DialogBuilder.java b/src/main/java/org/tasks/dialogs/DialogBuilder.java
index 41acc8a051..69cecd9101 100644
--- a/src/main/java/org/tasks/dialogs/DialogBuilder.java
+++ b/src/main/java/org/tasks/dialogs/DialogBuilder.java
@@ -4,10 +4,8 @@
 import android.app.ProgressDialog;
 import android.content.res.Resources;
 import android.graphics.drawable.ColorDrawable;
-import android.support.v7.app.AlertDialog;
 import android.support.v7.view.ContextThemeWrapper;
 
-import com.todoroo.andlib.data.Callback;
 import com.todoroo.andlib.utility.AndroidUtilities;
 
 import org.tasks.preferences.ThemeManager;
@@ -24,16 +22,18 @@ public DialogBuilder(Activity activity, ThemeManager themeManager) {
         this.themeManager = themeManager;
     }
 
-    public AlertDialog.Builder newDialog() {
-        return new AlertDialog.Builder(buildDialogWrapper());
+    public AlertDialogBuilder newDialog() {
+        return new AlertDialogBuilder(activity, themeManager);
     }
 
-    public AlertDialog.Builder newMessageDialog(int message, Object... formatArgs) {
-        return newDialog().setMessage(activity.getString(message, formatArgs));
+    @Deprecated
+    public AlertDialogBuilder newMessageDialog(int message, Object... formatArgs) {
+        return newDialog().setMessage(message, formatArgs);
     }
 
     public ProgressDialog newProgressDialog() {
-        ProgressDialog progressDialog = new ProgressDialog(buildDialogWrapper());
+        ProgressDialog progressDialog = new ProgressDialog(activity, themeManager.getDialogThemeResId());
+        themeManager.applyThemeToContext(progressDialog.getContext());
         if (AndroidUtilities.preLollipop()) {
             progressDialog.getWindow().setBackgroundDrawable(new ColorDrawable(android.R.color.transparent));
         }
diff --git a/src/main/java/org/tasks/dialogs/SortDialog.java b/src/main/java/org/tasks/dialogs/SortDialog.java
index f9b911730f..1daa8e779a 100644
--- a/src/main/java/org/tasks/dialogs/SortDialog.java
+++ b/src/main/java/org/tasks/dialogs/SortDialog.java
@@ -99,7 +99,7 @@ public void onClick(DialogInterface dialog, int which) {
                     }
                 })
                 .setNegativeButton(android.R.string.cancel, null)
-                .show();
+                .showThemedListView();
 
         enableReverse();
 
diff --git a/src/main/res/values/theme_base_dark.xml b/src/main/res/values/theme_base_dark.xml
index 386152078a..b655e5520f 100644
--- a/src/main/res/values/theme_base_dark.xml
+++ b/src/main/res/values/theme_base_dark.xml
@@ -3,31 +3,24 @@
 
     <style name="DarkBase" parent="Theme.AppCompat.NoActionBar">
         <item name="popup_theme">@style/ThemeOverlay.AppCompat</item>
-        <item name="windowActionModeOverlay">true</item>
-
         <item name="android:windowBackground">@color/md_dark_background</item>
-
+        <item name="asEditTextBackground">@null</item>
+        <item name="windowActionModeOverlay">true</item>
         <item name="drawer_background">@color/drawer_background_dark</item>
         <item name="drawer_background_selected">@color/drawer_background_selected_dark</item>
+        <item name="asDueDateCompletedColor">#ff777777</item>
         <item name="asSeparator">@android:color/transparent</item>
-        <item name="android:actionModeBackground">?attr/colorPrimary</item>
-
+        <item name="separatorHeight">1px</item>
         <item name="asContentBackground">@color/md_dark_background</item>
-
         <item name="asTextColor">@android:color/white</item>
         <item name="asTextColorHint">@android:color/darker_gray</item>
-        <item name="task_edit_divider">@color/task_edit_divider</item>
-        <item name="asDueDateColor">#c3c3c3</item>
-
-        <item name="asEditTextBackground">@null</item>
-
-        <item name="asDueDateCompletedColor">#ff777777</item>
-        <item name="separatorHeight">1px</item>
-
         <item name="asDetailsColor">#6666aa</item>
+        <item name="asDueDateColor">#c3c3c3</item>
         <item name="asListDividerColor">#dddddd</item>
         <item name="asThemeTextColor">@color/dark_blue_theme_color</item>
+        <item name="task_edit_divider">@color/task_edit_divider</item>
         <item name="android:spinnerItemStyle">@style/SpinnerNoPadding</item>
+        <item name="android:actionModeBackground">?attr/colorPrimary</item>
         <item name="alertDialogTheme">@style/DialogBaseDark</item>
     </style>
 
diff --git a/src/main/res/values/theme_base_light.xml b/src/main/res/values/theme_base_light.xml
index e7dc5e087e..65ede00a2a 100644
--- a/src/main/res/values/theme_base_light.xml
+++ b/src/main/res/values/theme_base_light.xml
@@ -27,7 +27,7 @@
     <style name="LightOverride" parent="LightBase">
     </style>
 
-    <style name="LightDialogBase" parent="Theme.AppCompat.Light.Dialog">
+    <style name="LightDialogBase" parent="@style/Theme.AppCompat.Light.Dialog">
         <item name="android:windowMinWidthMinor">@android:dimen/dialog_min_width_minor</item>
         <item name="android:windowMinWidthMajor">@android:dimen/dialog_min_width_major</item>
         <item name="asThemeTextColor">@color/dark_blue_theme_color</item>
