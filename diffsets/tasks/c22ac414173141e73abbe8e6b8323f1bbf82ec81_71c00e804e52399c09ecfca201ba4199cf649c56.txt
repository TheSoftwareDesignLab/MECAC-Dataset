diff --git a/src/main/java/org/tasks/activities/CalendarSelectionActivity.java b/src/main/java/org/tasks/activities/CalendarSelectionActivity.java
index 7b01fbd8fe..2a38ab3ef6 100644
--- a/src/main/java/org/tasks/activities/CalendarSelectionActivity.java
+++ b/src/main/java/org/tasks/activities/CalendarSelectionActivity.java
@@ -8,6 +8,8 @@
 import org.tasks.injection.ActivityComponent;
 import org.tasks.injection.InjectingAppCompatActivity;
 
+import static org.tasks.activities.CalendarSelectionDialog.newCalendarSelectionDialog;
+
 public class CalendarSelectionActivity extends InjectingAppCompatActivity implements CalendarSelectionDialog.CalendarSelectionHandler {
 
     private static final String FRAG_TAG_CALENDAR_PREFERENCE_SELECTION = "frag_tag_calendar_preference_selection";
@@ -22,10 +24,7 @@ protected void onCreate(Bundle savedInstanceState) {
         FragmentManager fragmentManager = getSupportFragmentManager();
         CalendarSelectionDialog fragmentByTag = (CalendarSelectionDialog) fragmentManager.findFragmentByTag(FRAG_TAG_CALENDAR_PREFERENCE_SELECTION);
         if (fragmentByTag == null) {
-            fragmentByTag = new CalendarSelectionDialog();
-            if (getIntent().getBooleanExtra(EXTRA_SHOW_NONE, false)) {
-                fragmentByTag.enableNone();
-            }
+            fragmentByTag = newCalendarSelectionDialog(getIntent().getBooleanExtra(EXTRA_SHOW_NONE, false));
             fragmentByTag.show(fragmentManager, FRAG_TAG_CALENDAR_PREFERENCE_SELECTION);
         }
         fragmentByTag.setCalendarSelectionHandler(this);
diff --git a/src/main/java/org/tasks/activities/CalendarSelectionDialog.java b/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
index d702ce6fa9..6839e4c6b1 100644
--- a/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
+++ b/src/main/java/org/tasks/activities/CalendarSelectionDialog.java
@@ -21,6 +21,7 @@
 import org.tasks.preferences.FragmentPermissionRequestor;
 import org.tasks.preferences.PermissionChecker;
 import org.tasks.preferences.PermissionRequestor;
+import org.tasks.themes.Theme;
 
 import java.util.ArrayList;
 import java.util.List;
@@ -32,17 +33,26 @@
 
 public class CalendarSelectionDialog extends InjectingDialogFragment {
 
+    public static CalendarSelectionDialog newCalendarSelectionDialog(boolean enableNone) {
+        CalendarSelectionDialog dialog = new CalendarSelectionDialog();
+        dialog.enableNone = enableNone;
+        return dialog;
+    }
+
     public interface CalendarSelectionHandler {
         void selectedCalendar(AndroidCalendar calendar);
 
         void cancel();
     }
 
+    private static final String EXTRA_NONE_ENABLED = "extra_none_enabled";
+
     @Inject DialogBuilder dialogBuilder;
     @Inject CalendarProvider calendarProvider;
     @Inject @ForActivity Context context;
     @Inject FragmentPermissionRequestor fragmentPermissionRequestor;
     @Inject PermissionChecker permissionChecker;
+    @Inject Theme theme;
     private CalendarSelectionHandler handler;
     private boolean enableNone;
     private ArrayAdapter<String> adapter;
@@ -54,9 +64,12 @@ public interface CalendarSelectionHandler {
     public Dialog onCreateDialog(Bundle savedInstanceState) {
         if (savedInstanceState == null) {
             fragmentPermissionRequestor.requestCalendarPermissions();
+        } else {
+            enableNone = savedInstanceState.getBoolean(EXTRA_NONE_ENABLED);
         }
 
-        adapter = new ArrayAdapter<>(context, R.layout.simple_list_item_single_choice_themed, calendarNames);
+        theme.applyToContext(getActivity());
+        adapter = new ArrayAdapter<>(getActivity(), R.layout.simple_list_item_single_choice_themed, calendarNames);
 
         AlertDialogBuilder builder = dialogBuilder.newDialog()
                 .setAdapter(adapter, new DialogInterface.OnClickListener() {
@@ -98,7 +111,7 @@ public String apply(AndroidCalendar androidCalendar) {
                 }
             }));
             if (calendarNames.isEmpty()) {
-                Toast.makeText(context, R.string.no_calendars_found, Toast.LENGTH_LONG).show();
+                Toast.makeText(getActivity(), R.string.no_calendars_found, Toast.LENGTH_LONG).show();
                 handler.cancel();
             } else {
                 adapter.notifyDataSetChanged();
@@ -106,6 +119,13 @@ public String apply(AndroidCalendar androidCalendar) {
         }
     }
 
+    @Override
+    public void onSaveInstanceState(Bundle outState) {
+        super.onSaveInstanceState(outState);
+
+        outState.putBoolean(EXTRA_NONE_ENABLED, enableNone);
+    }
+
     @Override
     public void onCancel(DialogInterface dialog) {
         super.onCancel(dialog);
@@ -129,10 +149,6 @@ protected void inject(DialogFragmentComponent component) {
         component.inject(this);
     }
 
-    public void enableNone() {
-        enableNone = true;
-    }
-
     public void setCalendarSelectionHandler(CalendarSelectionHandler handler) {
         this.handler = handler;
     }
diff --git a/src/main/java/org/tasks/dialogs/ColorPickerDialog.java b/src/main/java/org/tasks/dialogs/ColorPickerDialog.java
index a48cca9a73..752a468a6c 100644
--- a/src/main/java/org/tasks/dialogs/ColorPickerDialog.java
+++ b/src/main/java/org/tasks/dialogs/ColorPickerDialog.java
@@ -73,7 +73,7 @@ public View getView(int position, View convertView, ViewGroup parent) {
                 TextView textView = (TextView) (convertView == null
                         ? inflater.inflate(R.layout.color_selection_row, parent, false)
                         : convertView);
-                Drawable original = context.getResources().getDrawable(preferences.hasPurchase(R.string.p_purchased_themes) || position < 2
+                Drawable original = context.getResources().getDrawable(preferences.hasPurchase(R.string.p_purchased_themes) || position < getNumFree()
                         ? R.drawable.ic_lens_black_24dp
                         : R.drawable.ic_vpn_key_black_24dp);
                 Drawable wrapped = DrawableCompat.wrap(original.mutate());
diff --git a/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java b/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
index bccdca4b5b..d1d3b97540 100644
--- a/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
+++ b/src/main/java/org/tasks/dialogs/NativeDatePickerDialog.java
@@ -39,7 +39,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
         if (initial != null) {
             datePickerDialog.updateDate(initial.getYear(), initial.getMonthOfYear() - 1, initial.getDayOfMonth());
         }
-        datePickerDialog.setTitle(null);
+        datePickerDialog.setTitle("");
         return datePickerDialog;
     }
 
diff --git a/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java b/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
index a99a5af1e0..d0eec47644 100644
--- a/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
+++ b/src/main/java/org/tasks/dialogs/NativeTimePickerDialog.java
@@ -49,7 +49,7 @@ public void onClick(DialogInterface dialogInterface, int i) {
         if (initial != null) {
             timePickerDialog.updateTime(initial.getHourOfDay(), initial.getMinuteOfHour());
         }
-        timePickerDialog.setTitle(null);
+        timePickerDialog.setTitle("");
         return timePickerDialog;
     }
 
diff --git a/src/main/java/org/tasks/files/FileExplore.java b/src/main/java/org/tasks/files/FileExplore.java
index 41e4dc0905..1898595f1c 100644
--- a/src/main/java/org/tasks/files/FileExplore.java
+++ b/src/main/java/org/tasks/files/FileExplore.java
@@ -37,12 +37,14 @@ public class FileExplore extends InjectingAppCompatActivity {
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
 
-        Intent intent = getIntent();
-        directoryMode = intent.getBooleanExtra(EXTRA_DIRECTORY_MODE, false);
-        startPath = intent.getStringExtra(EXTRA_START_PATH);
+        if (savedInstanceState == null) {
+            Intent intent = getIntent();
+            directoryMode = intent.getBooleanExtra(EXTRA_DIRECTORY_MODE, false);
+            startPath = intent.getStringExtra(EXTRA_START_PATH);
 
-        if (permissionRequestor.requestFileWritePermission()) {
-            launchPicker();
+            if (permissionRequestor.requestFileWritePermission()) {
+                launchPicker();
+            }
         }
     }
 
@@ -76,10 +78,12 @@ private void launchPicker() {
     @Override
     public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {
         if (requestCode == PermissionRequestor.REQUEST_FILE_WRITE) {
-            if (grantResults[0] == PackageManager.PERMISSION_GRANTED) {
-                launchPicker();
-            } else {
-                finish();
+            if (grantResults.length > 0) {
+                if (grantResults[0] == PackageManager.PERMISSION_GRANTED) {
+                    launchPicker();
+                } else {
+                    finish();
+                }
             }
         } else {
             super.onRequestPermissionsResult(requestCode, permissions, grantResults);
diff --git a/src/main/java/org/tasks/injection/InjectingAppCompatActivity.java b/src/main/java/org/tasks/injection/InjectingAppCompatActivity.java
index edbd967495..c5d3a4bbae 100644
--- a/src/main/java/org/tasks/injection/InjectingAppCompatActivity.java
+++ b/src/main/java/org/tasks/injection/InjectingAppCompatActivity.java
@@ -21,7 +21,7 @@ public InjectingAppCompatActivity() {
     protected void onCreate(Bundle savedInstanceState) {
         activityComponent = ((InjectingApplication) getApplication()).getComponent().plus(new ActivityModule(this));
         inject(activityComponent);
-        setTitle(null);
+        setTitle("");
         super.onCreate(savedInstanceState);
     }
 
diff --git a/src/main/res/layout/simple_list_item_single_choice_themed.xml b/src/main/res/layout/simple_list_item_single_choice_themed.xml
index bfd4024039..e18519a5c7 100644
--- a/src/main/res/layout/simple_list_item_single_choice_themed.xml
+++ b/src/main/res/layout/simple_list_item_single_choice_themed.xml
@@ -16,7 +16,7 @@
 <CheckedTextView xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@android:id/text1"
     android:layout_width="match_parent"
-    android:layout_height="?android:attr/listPreferredItemHeight"
+    android:layout_height="?android:attr/listPreferredItemHeightSmall"
     android:gravity="center_vertical"
     android:paddingEnd="@dimen/keyline_first"
     android:paddingLeft="@dimen/keyline_first"
diff --git a/src/main/res/values/theme.xml b/src/main/res/values/theme.xml
index 4c2a2f4b6c..2fd7a01faf 100644
--- a/src/main/res/values/theme.xml
+++ b/src/main/res/values/theme.xml
@@ -26,7 +26,6 @@
     <style name="TasksDialogAlert" parent="@style/Theme.AppCompat.DayNight.Dialog.Alert">
         <item name="android:windowBackground">@color/background_color_dialog</item>
         <item name="colorAccent">?attr/colorAccentDialog</item>
-        <item name="colorAccentDialog">@color/blue_grey_400</item>
         <item name="asTextColor">@color/text_primary</item>
         <item name="icon_tint">@color/icon_tint</item>
     </style>
@@ -34,7 +33,6 @@
     <style name="TasksDialog" parent="@style/Theme.AppCompat.DayNight.Dialog">
         <item name="android:windowBackground">@color/background_color_dialog</item>
         <item name="colorAccent">?attr/colorAccentDialog</item>
-        <item name="colorAccentDialog">@color/blue_grey_400</item>
         <item name="asTextColor">@color/text_primary</item>
         <item name="icon_tint">@color/icon_tint</item>
     </style>
