diff --git a/focus-android/app/build.gradle b/focus-android/app/build.gradle
index dabb22322146..233a69e5adec 100644
--- a/focus-android/app/build.gradle
+++ b/focus-android/app/build.gradle
@@ -184,6 +184,8 @@ dependencies {
     compileOnly 'net.jcip:jcip-annotations:1.0'
     compileOnly "com.github.spotbugs:spotbugs-annotations:$spotbugs_version"
 
+    implementation "org.mozilla.components:session:$mozilla_components_version"
+    implementation "org.mozilla.components:engine:$mozilla_components_version"
     implementation "org.mozilla.components:telemetry:$mozilla_components_version"
     implementation "org.mozilla.components:ktx:$mozilla_components_version"
     implementation "org.mozilla.components:utils:$mozilla_components_version"
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java
index dcd8419cebea..ffe419e0ddea 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java
@@ -14,15 +14,16 @@
 import android.support.test.uiautomator.By;
 import android.support.test.uiautomator.Until;
 
+import mozilla.components.browser.session.SessionManager;
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.mozilla.focus.R;
+import org.mozilla.focus.ext.ContextKt;
 import org.mozilla.focus.helpers.SessionLoadedIdlingResource;
 import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.session.SessionManager;
 import org.mozilla.focus.utils.AppConstants;
 import org.mozilla.focus.web.IWebView;
 
@@ -43,7 +44,6 @@
 import static org.hamcrest.Matchers.equalTo;
 import static org.hamcrest.Matchers.is;
 import static org.hamcrest.Matchers.not;
-import static org.junit.Assert.assertFalse;
 import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
 import static org.mozilla.focus.helpers.EspressoHelper.navigateToMockWebServer;
 import static org.mozilla.focus.helpers.EspressoHelper.onFloatingEraseButton;
@@ -172,7 +172,10 @@ public void testVisitingMultipleSites() {
 
             // Now on main view
             assertTrue(TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime));
-            assertFalse(SessionManager.getInstance().hasSession());
+
+            final SessionManager sessionManager = ContextKt.getComponents(
+                    InstrumentationRegistry.getTargetContext().getApplicationContext()).getSessionManager();
+            assertTrue(sessionManager.getSessions().isEmpty());
         }
     }
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.java
index f6cd561b62a4..cc3b6ea3005b 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.java
@@ -10,10 +10,11 @@
 import android.support.test.InstrumentationRegistry;
 import android.support.test.rule.ActivityTestRule;
 
+import mozilla.components.browser.session.SessionManager;
 import org.mozilla.focus.activity.MainActivity;
-import org.mozilla.focus.session.SessionManager;
 
 import mozilla.components.support.utils.ThreadUtils;
+import org.mozilla.focus.ext.ContextKt;
 
 import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
 
@@ -47,10 +48,13 @@ protected void afterActivityFinished() {
 
         getActivity().finishAndRemoveTask();
 
+        final SessionManager sessionManager = ContextKt.getComponents(
+                InstrumentationRegistry.getTargetContext().getApplicationContext()).getSessionManager();
+
         ThreadUtils.INSTANCE.postToMainThread(new Runnable() {
             @Override
             public void run() {
-                SessionManager.getInstance().removeAllSessions();
+                sessionManager.removeAll();
             }
         });
     }
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.java
deleted file mode 100644
index c7380dcaf360..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.java
+++ /dev/null
@@ -1,49 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.helpers;
-
-import android.support.test.espresso.IdlingResource;
-
-import org.mozilla.focus.session.SessionManager;
-
-/**
- * An IdlingResource implementation that waits until the current session is not loading anymore.
- * Only after loading has completed further actions will be performed.
- */
-public class SessionLoadedIdlingResource implements IdlingResource {
-    private ResourceCallback resourceCallback;
-
-    @Override
-    public String getName() {
-        return SessionLoadedIdlingResource.class.getSimpleName();
-    }
-
-    @Override
-    public boolean isIdleNow() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        if (!sessionManager.hasSession()) {
-            invokeCallback();
-            return true;
-        }
-
-        if (sessionManager.getCurrentSession().getLoading().getValue()) {
-            return false;
-        } else {
-            invokeCallback();
-            return true;
-        }
-    }
-
-    private void invokeCallback() {
-        if (resourceCallback != null) {
-            resourceCallback.onTransitionToIdle();
-        }
-    }
-
-    @Override
-    public void registerIdleTransitionCallback(ResourceCallback callback) {
-        this.resourceCallback = callback;
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.kt
new file mode 100644
index 000000000000..3f4d732330f4
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/SessionLoadedIdlingResource.kt
@@ -0,0 +1,45 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.helpers
+
+import android.support.test.InstrumentationRegistry
+import android.support.test.espresso.IdlingResource
+import org.mozilla.focus.FocusApplication
+
+/**
+ * An IdlingResource implementation that waits until the current session is not loading anymore.
+ * Only after loading has completed further actions will be performed.
+ */
+class SessionLoadedIdlingResource : IdlingResource {
+    private var resourceCallback: IdlingResource.ResourceCallback? = null
+
+    override fun getName(): String {
+        return SessionLoadedIdlingResource::class.java.simpleName
+    }
+
+    override fun isIdleNow(): Boolean {
+        val context = InstrumentationRegistry.getInstrumentation().targetContext.applicationContext as FocusApplication
+        val sessionManager = context.components.sessionManager
+
+        val session = sessionManager.selectedSession
+
+        return if (session?.loading == true) {
+            false
+        } else {
+            invokeCallback()
+            true
+        }
+    }
+
+    private fun invokeCallback() {
+        if (resourceCallback != null) {
+            resourceCallback!!.onTransitionToIdle()
+        }
+    }
+
+    override fun registerIdleTransitionCallback(callback: IdlingResource.ResourceCallback) {
+        this.resourceCallback = callback
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/Components.kt b/focus-android/app/src/main/java/org/mozilla/focus/Components.kt
index 6cee3a733935..cedc329a0a5a 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/Components.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/Components.kt
@@ -4,9 +4,18 @@
 
 package org.mozilla.focus
 
+import android.content.Context
+import android.util.AttributeSet
 import mozilla.components.browser.search.SearchEngineManager
 import mozilla.components.browser.search.provider.AssetsSearchEngineProvider
 import mozilla.components.browser.search.provider.localization.LocaleSearchLocalizationProvider
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+import mozilla.components.concept.engine.DefaultSettings
+import mozilla.components.concept.engine.Engine
+import mozilla.components.concept.engine.EngineSession
+import mozilla.components.concept.engine.EngineView
+import mozilla.components.concept.engine.Settings
 import org.mozilla.focus.search.BingSearchEngineFilter
 import org.mozilla.focus.search.CustomSearchEngineProvider
 import org.mozilla.focus.search.HiddenSearchEngineFilter
@@ -14,7 +23,13 @@ import org.mozilla.focus.search.HiddenSearchEngineFilter
 /**
  * Helper object for lazily initializing components.
  */
-object Components {
+class Components {
+    val sessionManager by lazy {
+        SessionManager(DummyEngine()).apply {
+            register(SessionSetupObserver())
+        }
+    }
+
     val searchEngineManager by lazy {
         val assetsProvider = AssetsSearchEngineProvider(
                 LocaleSearchLocalizationProvider(),
@@ -26,3 +41,36 @@ object Components {
         SearchEngineManager(listOf(assetsProvider, customProvider))
     }
 }
+
+/**
+ * We are not using an "Engine" implementation yet. Therefore we create this dummy that we pass to
+ * the <code>SessionManager</code> for now.
+ */
+private class DummyEngine : Engine {
+    override val settings: Settings = DefaultSettings()
+
+    override fun createSession(private: Boolean): EngineSession {
+        throw NotImplementedError()
+    }
+
+    override fun createView(context: Context, attrs: AttributeSet?): EngineView {
+        throw NotImplementedError()
+    }
+
+    override fun name(): String {
+        throw NotImplementedError()
+    }
+}
+
+/**
+ * This is a workaround for setting up the Session object. Once we use browser-engine we can just setup the Engine to
+ * use specific default settings. For now we need to manually update every created Session model to reflect what Focus
+ * expects as default.
+ */
+class SessionSetupObserver : SessionManager.Observer {
+    override fun onSessionAdded(session: Session) {
+        // Tracking protection is enabled by default for every tab. Instead of setting up the engine we modify Session
+        // here and IWebView will get its default behavior from Session.
+        session.trackerBlockingEnabled = true
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.kt b/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.kt
index 97c1cf03a570..d2a92561e8f6 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.kt
@@ -17,7 +17,6 @@ import mozilla.components.service.fretboard.source.kinto.KintoExperimentSource
 import mozilla.components.service.fretboard.storage.flatfile.FlatFileExperimentStorage
 import org.mozilla.focus.locale.LocaleAwareApplication
 import org.mozilla.focus.session.NotificationSessionObserver
-import org.mozilla.focus.session.SessionManager
 import org.mozilla.focus.session.VisibilityLifeCycleCallback
 import org.mozilla.focus.telemetry.SentryWrapper
 import org.mozilla.focus.telemetry.TelemetrySessionObserver
@@ -45,6 +44,8 @@ class FocusApplication : LocaleAwareApplication() {
         private const val FRETBOARD_BLOCKING_NETWORK_READ_TIMEOUT = 10000
     }
 
+    val components: Components by lazy { Components() }
+
     var visibilityLifeCycleCallback: VisibilityLifeCycleCallback? = null
         private set
 
@@ -61,7 +62,7 @@ class FocusApplication : LocaleAwareApplication() {
 
             enableStrictMode()
 
-            Components.searchEngineManager.apply {
+            components.searchEngineManager.apply {
                 launch(IO) {
                     load(this@FocusApplication)
                 }
@@ -75,20 +76,14 @@ class FocusApplication : LocaleAwareApplication() {
             visibilityLifeCycleCallback = VisibilityLifeCycleCallback(this@FocusApplication)
             registerActivityLifecycleCallbacks(visibilityLifeCycleCallback)
 
-            setupSessions()
+            components.sessionManager.apply {
+                register(NotificationSessionObserver(this@FocusApplication))
+                register(TelemetrySessionObserver())
+                register(CleanupSessionObserver(this@FocusApplication))
+            }
         }
     }
 
-    private fun setupSessions() {
-        val sessions = SessionManager.getInstance().sessions
-        sessions.observeForever(NotificationSessionObserver(this@FocusApplication))
-        sessions.observeForever(TelemetrySessionObserver())
-        sessions.observeForever(CleanupSessionObserver(this@FocusApplication))
-
-        val customTabSessions = SessionManager.getInstance().customTabSessions
-        customTabSessions.observeForever(TelemetrySessionObserver())
-    }
-
     private suspend fun loadExperiments() {
         val experimentsFile = File(filesDir, EXPERIMENTS_JSON_FILENAME)
         val experimentSource = KintoExperimentSource(
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/CustomTabActivity.kt b/focus-android/app/src/main/java/org/mozilla/focus/activity/CustomTabActivity.kt
index a0915e019c6a..f36e8e13968d 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/activity/CustomTabActivity.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/CustomTabActivity.kt
@@ -5,45 +5,43 @@
 package org.mozilla.focus.activity
 
 import android.os.Bundle
+import mozilla.components.browser.session.Session
 import mozilla.components.support.utils.SafeIntent
-import org.mozilla.focus.customtabs.CustomTabConfig
-import org.mozilla.focus.session.Session
-import org.mozilla.focus.session.SessionManager
+import org.mozilla.focus.ext.components
 
 /**
  * The main entry point for "custom tabs" opened by third-party apps.
  */
 class CustomTabActivity : MainActivity() {
     private lateinit var customTabId: String
+
     private val customTabSession: Session by lazy {
-        SessionManager.getInstance().getCustomTabSessionByCustomTabIdOrThrow(customTabId)
+        components.sessionManager.findSessionById(customTabId)
+            ?: throw IllegalAccessError("No session wiht id $customTabId")
     }
 
-    override val isCustomTabMode: Boolean
-        get() = true
+    override val currentSessionForActivity: Session by lazy { customTabSession }
 
-    override fun onCreate(savedInstanceState: Bundle?) {
-        super.onCreate(savedInstanceState)
+    override val isCustomTabMode: Boolean = true
 
+    override fun onCreate(savedInstanceState: Bundle?) {
         val intent = SafeIntent(intent)
-        customTabId = intent.getStringExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID)
-                ?: throw IllegalAccessError("No custom tab id in intent")
+        customTabId = intent.getStringExtra(CUSTOM_TAB_ID)
+            ?: throw IllegalAccessError("No custom tab id in intent")
+
+        super.onCreate(savedInstanceState)
     }
 
     override fun onPause() {
         super.onPause()
 
-        if (isFinishing) {
-            // Remove custom tab session
-
-            val sessionManager: SessionManager = SessionManager.getInstance()
-
-            sessionManager
-                    .getCustomTabSessionByCustomTabId(customTabId)
-                    ?.let { sessionManager.removeCustomTabSession(it.uuid) }
+        if (isFinishing && customTabSession.isCustomTabSession()) {
+            // This may not be a custom tab session anymore ("open in firefox focus"). So only remove it if this
+            // activity is finishing and this is still a custom tab session.
+            components.sessionManager.remove(customTabSession)
         }
     }
-
-    override val currentSessionForActivity
-        get() = customTabSession
+    companion object {
+        const val CUSTOM_TAB_ID = "custom_tab_id"
+    }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.kt b/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.kt
index bcfc581dd931..a6a7b4f36e20 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.kt
@@ -1,20 +1,19 @@
 /* This Source Code Form is subject to the terms of the Mozilla Public
  * License, v. 2.0. If a copy of the MPL was not distributed with this
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
 package org.mozilla.focus.activity
 
 import android.app.Activity
 import android.os.Bundle
+import org.mozilla.focus.ext.components
 
-import org.mozilla.focus.session.SessionManager
 import org.mozilla.focus.telemetry.TelemetryWrapper
 
 class EraseShortcutActivity : Activity() {
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
 
-        SessionManager.getInstance().removeAllSessions()
+        components.sessionManager.removeSessions()
 
         TelemetryWrapper.eraseShortcutEvent()
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/IntentReceiverActivity.kt b/focus-android/app/src/main/java/org/mozilla/focus/activity/IntentReceiverActivity.kt
index 3ae930fab351..46a5acb812a2 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/activity/IntentReceiverActivity.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/IntentReceiverActivity.kt
@@ -7,21 +7,26 @@ package org.mozilla.focus.activity
 import android.app.Activity
 import android.content.Intent
 import android.os.Bundle
+import mozilla.components.browser.session.Session
 import mozilla.components.support.utils.SafeIntent
-import org.mozilla.focus.customtabs.CustomTabConfig
-import java.util.UUID
+import org.mozilla.focus.ext.components
+import org.mozilla.focus.session.IntentProcessor
 
 /**
  * This activity receives VIEW intents and either forwards them to MainActivity or CustomTabActivity.
  */
 class IntentReceiverActivity : Activity() {
+    private val intentProcessor by lazy { IntentProcessor(components.sessionManager) }
+
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
 
         val intent = SafeIntent(intent)
 
-        if (CustomTabConfig.isCustomTabIntent(intent)) {
-            dispatchCustomTabsIntent()
+        val session = intentProcessor.handleIntent(this, intent, savedInstanceState)
+
+        if (session?.isCustomTabSession() == true) {
+            dispatchCustomTabsIntent(session)
         } else {
             dispatchNormalIntent()
         }
@@ -29,14 +34,14 @@ class IntentReceiverActivity : Activity() {
         finish()
     }
 
-    private fun dispatchCustomTabsIntent() {
+    private fun dispatchCustomTabsIntent(session: Session) {
         val intent = Intent(intent)
 
         intent.setClassName(applicationContext, CustomTabActivity::class.java.name)
 
         // We are adding a generated custom tab ID to the intent here. CustomTabActivity will
         // use this ID to later decide what session to display once it is created.
-        intent.putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, UUID.randomUUID().toString())
+        intent.putExtra(CustomTabActivity.CUSTOM_TAB_ID, session.id)
 
         startActivity(intent)
     }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.kt b/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.kt
index 44b55a8a288e..9481742c51c5 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.kt
@@ -14,16 +14,17 @@ import android.preference.PreferenceManager
 import android.util.AttributeSet
 import android.view.View
 import android.view.WindowManager
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
 import mozilla.components.support.utils.SafeIntent
 import org.mozilla.focus.R
-import org.mozilla.focus.architecture.NonNullObserver
 import org.mozilla.focus.biometrics.Biometrics
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.fragment.BrowserFragment
 import org.mozilla.focus.fragment.FirstrunFragment
 import org.mozilla.focus.fragment.UrlInputFragment
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity
-import org.mozilla.focus.session.Session
-import org.mozilla.focus.session.SessionManager
+import org.mozilla.focus.session.IntentProcessor
 import org.mozilla.focus.session.ui.SessionsSheetFragment
 import org.mozilla.focus.settings.ExperimentsSettingsFragment
 import org.mozilla.focus.telemetry.SentryWrapper
@@ -39,13 +40,13 @@ import org.mozilla.focus.web.WebViewProvider
 
 @Suppress("TooManyFunctions")
 open class MainActivity : LocaleAwareAppCompatActivity() {
-    private val sessionManager: SessionManager = SessionManager.getInstance()
-
     protected open val isCustomTabMode: Boolean
         get() = false
 
     protected open val currentSessionForActivity: Session
-        get() = sessionManager.currentSession
+        get() = components.sessionManager.selectedSessionOrThrow
+
+    private val intentProcessor by lazy { IntentProcessor(components.sessionManager) }
 
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
@@ -70,8 +71,6 @@ open class MainActivity : LocaleAwareAppCompatActivity() {
             TelemetryWrapper.openFromIconEvent()
         }
 
-        sessionManager.handleIntent(this, intent, savedInstanceState)
-
         registerSessionObserver()
 
         WebViewProvider.preload(this)
@@ -98,45 +97,37 @@ open class MainActivity : LocaleAwareAppCompatActivity() {
     }
 
     private fun registerSessionObserver() {
-        (if (isCustomTabMode)
-            sessionManager.customTabSessions
-        else
-            sessionManager.sessions).observe(this, createSessionObserver())
-    }
+        components.sessionManager.register(object : SessionManager.Observer {
+            override fun onSessionSelected(session: Session) {
+                showBrowserScreenForCurrentSession()
+            }
 
-    private fun createSessionObserver() = object : NonNullObserver<List<Session>>() {
-        private var wasSessionsEmpty = false
-
-        public override fun onValueChanged(t: List<Session>) {
-            // If needed show the first run tour on top of the browser or url input fragment.
-            val showFirstrun = Settings.getInstance(this@MainActivity).shouldShowFirstrun()
-
-            if (t.isEmpty()) {
-                if (!isCustomTabMode) {
-                    // There's no active session. Show the URL input screen so that the user can
-                    // start a new session.
-                    if (showFirstrun) {
-                        showFirstrun()
-                    } else {
-                        showUrlInputScreen()
-                    }
-                }
+            override fun onAllSessionsRemoved() {
+                showUrlInputScreen()
 
-                wasSessionsEmpty = true
-            } else {
-                // This happens when we move from 0 to 1 sessions: either on startup or after an erase.
-                if (wasSessionsEmpty) {
-                    WebViewProvider.performNewBrowserSessionCleanup()
-                    wasSessionsEmpty = false
-                }
+                WebViewProvider.performNewBrowserSessionCleanup()
+            }
 
-                if (showFirstrun) {
-                    showFirstrun(currentSessionForActivity)
-                } else {
-                    // We have at least one session. Show a fragment for the current session.
-                    showBrowserScreenForCurrentSession()
+            override fun onSessionRemoved(session: Session) {
+                if (!isCustomTabMode && components.sessionManager.sessions.isEmpty()) {
+                    showUrlInputScreen()
+
+                    WebViewProvider.performNewBrowserSessionCleanup()
                 }
             }
+        })
+
+        if (!isCustomTabMode && components.sessionManager.sessions.isEmpty()) {
+            showUrlInputScreen()
+
+            WebViewProvider.performNewBrowserSessionCleanup()
+        } else {
+            showBrowserScreenForCurrentSession()
+        }
+
+        // If needed show the first run tour on top of the browser or url input fragment.
+        if (Settings.getInstance(this@MainActivity).shouldShowFirstrun() && !isCustomTabMode) {
+            showFirstrun()
         }
     }
 
@@ -191,7 +182,7 @@ open class MainActivity : LocaleAwareAppCompatActivity() {
             return
         }
 
-        sessionManager.handleNewIntent(this, intent)
+        intentProcessor.handleNewIntent(this, intent)
 
         val action = intent.action
 
@@ -212,7 +203,7 @@ open class MainActivity : LocaleAwareAppCompatActivity() {
         val fromShortcut = intent.getBooleanExtra(EXTRA_SHORTCUT, false)
         val fromNotification = intent.getBooleanExtra(EXTRA_NOTIFICATION, false)
 
-        SessionManager.getInstance().removeAllSessions()
+        components.sessionManager.removeSessions()
 
         if (fromShortcut) {
             TelemetryWrapper.eraseShortcutEvent()
@@ -277,7 +268,7 @@ open class MainActivity : LocaleAwareAppCompatActivity() {
         fragmentManager
                 .beginTransaction()
                 .replace(R.id.container, BrowserFragment.createForSession(currentSession), BrowserFragment.FRAGMENT_TAG)
-                .commit()
+            .commitAllowingStateLoss()
     }
 
     override fun onCreateView(name: String, context: Context, attrs: AttributeSet): View? {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.kt b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.kt
deleted file mode 100644
index 4cab999c19c3..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.kt
+++ /dev/null
@@ -1,42 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.architecture
-
-import android.arch.lifecycle.LiveData
-
-/**
- * A LiveData implementation with an initial value and that does not allow null values.
- */
-open class NonNullLiveData<T>(initialValue: T) : LiveData<T>() {
-    init {
-        value = initialValue
-    }
-
-    /**
-     * Returns the current (non-null) value. Note that calling this method on a background thread
-     * does not guarantee that the latest value set will be received.
-     */
-    override fun getValue(): T = super.getValue() ?: throw IllegalStateException("Value is null")
-
-    /**
-     * Posts a task to a main thread to set the given (non null) value.
-     */
-    override fun postValue(value: T?) {
-        if (value == null) {
-            throw IllegalArgumentException("Value cannot be null")
-        }
-        super.postValue(value)
-    }
-
-    /**
-     * Sets the (non-null) value. If there are active observers, the value will be dispatched to them.
-     */
-    override fun setValue(value: T?) {
-        if (value == null) {
-            throw IllegalArgumentException("Value cannot be null")
-        }
-        super.setValue(value)
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.kt b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.kt
deleted file mode 100644
index 0d6bccdde6b2..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.kt
+++ /dev/null
@@ -1,26 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.architecture
-
-import android.support.annotation.NonNull
-
-class NonNullMutableLiveData<T>(initialValue: T) : NonNullLiveData<T>(initialValue) {
-    /**
-     * Posts a task to a main thread to set the given (non-null) value.
-     */
-    public override fun postValue(value: T?) {
-        super.postValue(value)
-    }
-
-    /**
-     * Sets the (non-null) value. If there are active observers, the value will be dispatched to them.
-     */
-    public override fun setValue(value: T?) {
-        super.setValue(value)
-    }
-
-    @NonNull
-    override fun getValue(): T = super.getValue()
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.kt b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.kt
deleted file mode 100644
index 4900c2b640c2..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.kt
+++ /dev/null
@@ -1,17 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.architecture
-
-import android.arch.lifecycle.Observer
-
-abstract class NonNullObserver<T> : Observer<T> {
-    protected abstract fun onValueChanged(t: T)
-
-    override fun onChanged(value: T?) {
-        value?.let {
-            onValueChanged(it)
-        }
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java b/focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java
deleted file mode 100644
index d094021f1de6..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java
+++ /dev/null
@@ -1,308 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.customtabs;
-
-import android.app.PendingIntent;
-import android.content.Context;
-import android.graphics.Bitmap;
-import android.os.Bundle;
-import android.os.Parcelable;
-import android.support.annotation.ColorInt;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.customtabs.CustomTabsIntent;
-import android.util.Log;
-
-import org.mozilla.focus.R;
-
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.LinkedList;
-import java.util.List;
-
-import mozilla.components.support.utils.SafeBundle;
-import mozilla.components.support.utils.SafeIntent;
-
-public class CustomTabConfig {
-    private static final String LOGTAG = "CustomTabConfig";
-
-    /**
-     * This Intent extra is used internally to reference a specific custom tab.
-     */
-    public static final String EXTRA_CUSTOM_TAB_ID = "org.mozilla.focus.custom-tab-id";
-
-    public static final class ActionButtonConfig {
-        public final @NonNull String description;
-        public final @NonNull Bitmap icon;
-        public final @NonNull PendingIntent pendingIntent;
-
-        public ActionButtonConfig(final @NonNull String description,
-                                  final @NonNull Bitmap icon,
-                                  final @NonNull PendingIntent pendingIntent) {
-            this.description = description;
-            this.icon = icon;
-            this.pendingIntent = pendingIntent;
-        }
-    }
-
-    public static final class CustomTabMenuItem {
-        public final String name;
-        public final PendingIntent pendingIntent;
-
-        public CustomTabMenuItem(final @NonNull String name, final @NonNull PendingIntent pendingIntent) {
-            this.name = name;
-            this.pendingIntent = pendingIntent;
-        }
-    }
-
-    public final @NonNull String id;
-    public final @Nullable @ColorInt Integer toolbarColor;
-    public final @Nullable Bitmap closeButtonIcon;
-    public final boolean disableUrlbarHiding;
-
-    public final @Nullable ActionButtonConfig actionButtonConfig;
-    public final boolean showShareMenuItem;
-    public final @NonNull List<CustomTabMenuItem> menuItems;
-
-    private final @NonNull List<String> unsupportedFeatureList;
-
-    /* package-private */ CustomTabConfig(
-            final @NonNull String id,
-            final @Nullable @ColorInt Integer toolbarColor,
-            final @Nullable Bitmap closeButtonIcon,
-            final boolean disableUrlbarHiding,
-            final @Nullable ActionButtonConfig actionButtonConfig,
-            final boolean showShareMenuItem,
-            final @NonNull List<CustomTabMenuItem> menuItems,
-            final @NonNull List<String> unsupportedFeatureList) {
-        this.id = id;
-        this.toolbarColor = toolbarColor;
-        this.closeButtonIcon = closeButtonIcon;
-        this.disableUrlbarHiding = disableUrlbarHiding;
-        this.actionButtonConfig = actionButtonConfig;
-        this.showShareMenuItem = showShareMenuItem;
-        this.menuItems = menuItems;
-        this.unsupportedFeatureList = unsupportedFeatureList;
-    }
-
-    public static boolean isCustomTabIntent(final @NonNull SafeIntent intent) {
-        return intent.hasExtra(CustomTabsIntent.EXTRA_SESSION);
-    }
-
-    /* package-private */ static @Nullable Bitmap getCloseButtonIcon(final @NonNull Context context, final @NonNull SafeIntent intent) {
-        if (!intent.hasExtra(CustomTabsIntent.EXTRA_CLOSE_BUTTON_ICON)) {
-            return null;
-        }
-
-        final Parcelable closeButtonParcelable = intent.getParcelableExtra(CustomTabsIntent.EXTRA_CLOSE_BUTTON_ICON);
-        if (!(closeButtonParcelable instanceof Bitmap)) {
-            return null;
-        }
-
-        final Bitmap candidateIcon = (Bitmap) closeButtonParcelable;
-        final int maxSize = context.getResources().getDimensionPixelSize(R.dimen.customtabs_toolbar_icon_size);
-
-        if (candidateIcon.getWidth() <= maxSize &&
-                candidateIcon.getHeight() <= maxSize) {
-            return candidateIcon;
-        } else {
-            candidateIcon.recycle();
-            return null;
-        }
-    }
-
-    /* package-private */ static @Nullable ActionButtonConfig getActionButtonConfig(final @NonNull Context context, final @NonNull SafeIntent intent) {
-        if (!intent.hasExtra(CustomTabsIntent.EXTRA_ACTION_BUTTON_BUNDLE)) {
-            return null;
-        }
-
-        final SafeBundle actionButtonBundle = intent.getBundleExtra(CustomTabsIntent.EXTRA_ACTION_BUTTON_BUNDLE);
-
-        final String description = actionButtonBundle.getString(CustomTabsIntent.KEY_DESCRIPTION);
-        if (description == null) {
-            Log.w(LOGTAG, "Ignoring EXTRA_ACTION_BUTTON_BUNDLE due to missing description");
-            return null;
-        }
-
-        final Parcelable pendingIntentParcelable = actionButtonBundle.getParcelable(CustomTabsIntent.KEY_PENDING_INTENT);
-        final PendingIntent pendingIntent;
-        // See below: this might not be a PendingIntent, we need to verify ourselves
-        if (pendingIntentParcelable instanceof  PendingIntent) {
-            pendingIntent = (PendingIntent) pendingIntentParcelable;
-        } else {
-            Log.w(LOGTAG, "Ignoring EXTRA_ACTION_BUTTON_BUNDLE due to missing pendingIntent");
-            return null;
-        }
-
-        // Process the icon last: if we don't use the icon we need to recycle it, but if we've gotten
-        // to this stage we know that we have a valid description and pendingIntent, so returning
-        // an ActionButtonConfig is definitely possible (unless there's no icon, in which case there's nothing to do):
-        final Parcelable iconParcelable = actionButtonBundle.getParcelable(CustomTabsIntent.KEY_ICON);
-        final Bitmap icon;
-        // Java Generics mean that this parcelable might not be a bitmap, so we need to check and
-        // safely cast ourselves:
-        if (iconParcelable instanceof Bitmap) {
-            icon = (Bitmap) iconParcelable;
-        } else {
-            Log.w(LOGTAG, "Ignoring EXTRA_ACTION_BUTTON_BUNDLE due to missing icon");
-            return null;
-        }
-
-        return new ActionButtonConfig(description, icon, pendingIntent);
-    }
-
-    public static CustomTabConfig parseCustomTabIntent(final @NonNull Context context, final @NonNull SafeIntent intent) {
-        if (!intent.hasExtra(EXTRA_CUSTOM_TAB_ID)) {
-            throw new IllegalArgumentException("This custom tab intent  has no ID assigned");
-        }
-
-        final String id = intent.getStringExtra(EXTRA_CUSTOM_TAB_ID);
-
-        @ColorInt Integer toolbarColor = null;
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_TOOLBAR_COLOR)) {
-            toolbarColor = intent.getIntExtra(CustomTabsIntent.EXTRA_TOOLBAR_COLOR, -1);
-        }
-
-        final Bitmap closeButtonIcon = getCloseButtonIcon(context, intent);
-
-        // Custom tabs in Chrome defaults to hiding the URL bar. CustomTabsIntent.Builder only offers
-        // enableUrlBarHiding() which sets this value to true, which would suggest that the default
-        // is to have this disabled - but that's not what chrome does, I'm currently waiting
-        // for feedback on this bug: https://bugs.chromium.org/p/chromium/issues/detail?id=718654
-        boolean disableUrlbarHiding = !intent.getBooleanExtra(CustomTabsIntent.EXTRA_ENABLE_URLBAR_HIDING, true);
-
-        final ActionButtonConfig actionButtonConfig = getActionButtonConfig(context, intent);
-
-        // Share is part of the default menu, so it's simplest just to toggle it off as necessary instead
-        // of creating a fake menu item here, hence we keep this as  aboolean for now:
-        final boolean showShareMenuItem = intent.getBooleanExtra(CustomTabsIntent.EXTRA_DEFAULT_SHARE_MENU_ITEM,
-                // Unlike Chrome we will show the share menu by default. Note that currently the
-                // Custom Tabs support library has no option to explicitly hide this menu item. So
-                // setting the default to 'true' will show this menu item for all custom tabs.
-                true);
-
-        final List<CustomTabMenuItem> menuItems = new LinkedList<>();
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_MENU_ITEMS)) {
-            // This ArrayList should contain Bundles, however java generics don't actually let
-            // us check that that's the case (the only guarantee we get is that it's an ArrayList):
-            // You can see some gory details of similar issues at:
-            // https://bugzilla.mozilla.org/show_bug.cgi?id=1280382#c17
-            final ArrayList<?> menuItemBundles = intent.getParcelableArrayListExtra(CustomTabsIntent.EXTRA_MENU_ITEMS);
-
-            for (final Object bundleObject : menuItemBundles) {
-                if (!(bundleObject instanceof Bundle)) {
-                    // As noted above, this might not be a bundle:
-                    continue;
-                }
-
-                final SafeBundle bundle = new SafeBundle((Bundle) bundleObject);
-
-                final String name = bundle.getString(CustomTabsIntent.KEY_MENU_ITEM_TITLE);
-
-                final Parcelable parcelableIntent = bundle.getParcelable(CustomTabsIntent.KEY_PENDING_INTENT);
-                if (!(parcelableIntent instanceof PendingIntent)) {
-                    // And again: java generics don't guarantee anything, so we need to check for
-                    // PendingIntents ourselves
-                    continue;
-                }
-
-                final PendingIntent pendingIntent = (PendingIntent) parcelableIntent;
-
-                menuItems.add(new CustomTabMenuItem(name, pendingIntent));
-            }
-        }
-
-        // Store a list of unsupported features: we'll need these for telemetry. Eventually we'll want
-        // to actually parse these items, and use them in frontend code.
-        final List<String> unsupportedFeatureList = new LinkedList<>();
-
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_TINT_ACTION_BUTTON)) {
-            unsupportedFeatureList.add("hasActionButtonTint");
-        }
-
-        // The docs mention that EXTRA_TOOLBAR_ITEMS can be on the top or bottom toolbars. In practice
-        // (in Chrome) they are inserted into the bottom toolbar:
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_REMOTEVIEWS) ||
-                intent.hasExtra(CustomTabsIntent.EXTRA_TOOLBAR_ITEMS)) {
-            unsupportedFeatureList.add("hasBottomToolbar");
-        }
-
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_SECONDARY_TOOLBAR_COLOR)) {
-            // Disabled to not send more than 10 telemetry extras (See #629): hasBottomToolbar will
-            // be enough to determine whether this is a feature we should support.
-
-            // unsupportedFeatureList.add("hasBottomToolbarColor");
-        }
-
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_EXIT_ANIMATION_BUNDLE)) {
-            unsupportedFeatureList.add("hasExitAnimation");
-        }
-
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_ENABLE_INSTANT_APPS)) {
-            // Disabled to not send more than 10 telemetry extras (See #629): Instant apps are not
-            // something we are interested in here.
-
-            // unsupportedFeatureList.add("enablesInstantApps");
-        }
-
-        if (intent.hasExtra(CustomTabsIntent.EXTRA_TITLE_VISIBILITY_STATE)) {
-            final int titleVisibility = intent.getIntExtra(CustomTabsIntent.EXTRA_TITLE_VISIBILITY_STATE, 0);
-            switch (titleVisibility) {
-                case CustomTabsIntent.SHOW_PAGE_TITLE:
-                    unsupportedFeatureList.add("hasPageTitle");
-                    break;
-                case CustomTabsIntent.NO_TITLE:
-                    break;
-                default:
-                    Log.w(LOGTAG, "Custom tab intent specified unknown EXTRA_TITLE_VISIBILITY_STATE");
-                    break;
-            }
-        }
-
-        return new CustomTabConfig(
-                id,
-                toolbarColor,
-                closeButtonIcon,
-                disableUrlbarHiding,
-                actionButtonConfig,
-                showShareMenuItem,
-                menuItems,
-                unsupportedFeatureList);
-    }
-
-    /**
-     * Get a list of options enabled in the custom tabs intent, e.g. [hasToolbarColor, hasCloseButton].
-     */
-    public List<String> getOptionsList() {
-        // A list of custom-tab features that are used, stored for telemetry purposed
-        final List<String> featureList = new LinkedList<>(unsupportedFeatureList);
-
-        if (toolbarColor != null) {
-            featureList.add("hasToolbarColor");
-        }
-
-        if (closeButtonIcon != null) {
-            featureList.add("hasCloseButton");
-        }
-
-        if (!disableUrlbarHiding) {
-            featureList.add("disablesUrlbarHiding");
-        }
-
-        if (actionButtonConfig != null) {
-            featureList.add("hasActionButton");
-        }
-
-        if (showShareMenuItem) {
-            featureList.add("hasShareItem");
-        }
-
-        if (menuItems.size() > 0) {
-            featureList.add("hasCustomizedMenu");
-        }
-
-        return Collections.unmodifiableList(featureList);
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/ext/Context.kt b/focus-android/app/src/main/java/org/mozilla/focus/ext/Context.kt
new file mode 100644
index 000000000000..7c8b1d26032a
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/ext/Context.kt
@@ -0,0 +1,21 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.ext
+
+import android.content.Context
+import org.mozilla.focus.Components
+import org.mozilla.focus.FocusApplication
+
+/**
+ * Get the FocusApplication object from a context.
+ */
+val Context.application: FocusApplication
+    get() = applicationContext as FocusApplication
+
+/**
+ * Get the components of this application.
+ */
+val Context.components: Components
+    get() = application.components
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/ext/Fragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/ext/Fragment.kt
new file mode 100644
index 000000000000..f5b33ce28110
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/ext/Fragment.kt
@@ -0,0 +1,22 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.ext
+
+import android.support.v4.app.Fragment
+import org.mozilla.focus.Components
+
+/**
+ * Get the components of this application or null if this Fragment is not attached to a Context.
+ */
+val Fragment.components: Components?
+    get() = context?.components
+
+/**
+ * Get the components of this application.
+ *
+ * This method will throw an exception if this Fragment is not attached to a Context.
+ */
+val Fragment.requireComponents: Components
+    get() = requireContext().components
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/ext/Session.kt b/focus-android/app/src/main/java/org/mozilla/focus/ext/Session.kt
new file mode 100644
index 000000000000..c754220c7df5
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/ext/Session.kt
@@ -0,0 +1,52 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.ext
+
+import android.os.Bundle
+import mozilla.components.browser.session.Session
+import java.util.WeakHashMap
+
+// Extension methods on the Session class. This is used for additional session data that is not part
+// of the upstream browser-session component yet.
+
+val Session.isSearch
+    get() = searchTerms.isNotEmpty()
+
+private val extensions = WeakHashMap<Session, SessionExtension>()
+
+private fun getOrPutExtension(session: Session): SessionExtension {
+    extensions[session]?.let { return it }
+
+    return SessionExtension().also {
+        extensions[session] = it
+    }
+}
+
+private class SessionExtension {
+    var savedWebViewState: Bundle? = null
+    var shouldRequestDesktopSite: Boolean = false
+}
+
+/**
+ * Saving the state attached ot a session.
+ *
+ * Temporary solution until we can use the browser-engine component.
+ *
+ * Component upstream issue:
+ * https://github.com/mozilla-mobile/android-components/issues/408
+ */
+var Session.savedWebViewState: Bundle?
+    get() = getOrPutExtension(this).savedWebViewState
+    set(value) { getOrPutExtension(this).savedWebViewState = value }
+
+/**
+ * Whether to use desktop mode for this session.
+ *
+ * Component upstream issue:
+ * https://github.com/mozilla-mobile/android-components/issues/701
+ */
+var Session.shouldRequestDesktopSite: Boolean
+    get() = getOrPutExtension(this).shouldRequestDesktopSite
+    set(value) { getOrPutExtension(this).shouldRequestDesktopSite = value }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
index f77d698ec957..a8e2da459081 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
@@ -50,6 +50,8 @@ import android.widget.ImageView
 import android.widget.TextView
 import android.widget.Toast
 import kotlinx.android.synthetic.main.browser_display_toolbar.*
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
 import mozilla.components.support.utils.ColorUtils
 import mozilla.components.support.utils.DownloadUtils
 import mozilla.components.support.utils.DrawableUtils
@@ -57,11 +59,12 @@ import org.mozilla.focus.R
 import org.mozilla.focus.activity.InstallFirefoxActivity
 import org.mozilla.focus.activity.MainActivity
 import org.mozilla.focus.animation.TransitionDrawableGroup
-import org.mozilla.focus.architecture.NonNullObserver
 import org.mozilla.focus.biometrics.BiometricAuthenticationDialogFragment
 import org.mozilla.focus.biometrics.BiometricAuthenticationHandler
 import org.mozilla.focus.biometrics.Biometrics
 import org.mozilla.focus.broadcastreceiver.DownloadBroadcastReceiver
+import org.mozilla.focus.ext.requireComponents
+import org.mozilla.focus.ext.shouldRequestDesktopSite
 import org.mozilla.focus.findinpage.FindInPageCoordinator
 import org.mozilla.focus.gecko.NestedGeckoView
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity
@@ -70,11 +73,7 @@ import org.mozilla.focus.menu.context.WebContextMenu
 import org.mozilla.focus.observer.LoadTimeObserver
 import org.mozilla.focus.open.OpenWithFragment
 import org.mozilla.focus.popup.PopupUtils
-import org.mozilla.focus.session.NullSession
-import org.mozilla.focus.session.Session
 import org.mozilla.focus.session.SessionCallbackProxy
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
 import org.mozilla.focus.session.ui.SessionsSheetFragment
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.AppConstants
@@ -145,7 +144,6 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
     private var downloadBroadcastReceiver: DownloadBroadcastReceiver? = null
 
-    private val sessionManager: SessionManager = SessionManager.getInstance()
     private val findInPageCoordinator = FindInPageCoordinator()
 
     private var biometricController: BiometricAuthenticationHandler? = null
@@ -157,10 +155,11 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
     val url: String
         get() = urlView!!.text.toString()
 
-    override var session: Session? = null
+    override lateinit var session: Session
+        private set
 
     override val initialUrl: String?
-        get() = session!!.url.value
+        get() = session.url
 
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
@@ -174,20 +173,17 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
         val sessionUUID = arguments!!.getString(ARGUMENT_SESSION_UUID) ?: throw IllegalAccessError("No session exists")
 
-        session = if (sessionManager.hasSessionWithUUID(sessionUUID))
-            sessionManager.getSessionByUUID(sessionUUID)
-        else
-            NullSession()
-
-        session!!.blockedTrackers.observe(this, Observer { blockedTrackers ->
-            if (menuWeakReference == null) {
-                return@Observer
-            }
+        session = requireComponents.sessionManager.findSessionById(sessionUUID) ?: Session("about:blank")
 
-            val menu = menuWeakReference!!.get()
+        session.register(object : Session.Observer {
+            override fun onTrackerBlocked(session: Session, blocked: String, all: List<String>) {
+                menuWeakReference?.let {
+                    val menu = it.get()
 
-            menu?.updateTrackers(blockedTrackers!!)
-        })
+                    menu?.updateTrackers(all.size)
+                }
+            }
+        }, owner = this)
 
         findInPageCoordinator.matches.observe(
             this,
@@ -252,7 +248,14 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
             TelemetryWrapper.swipeReloadEvent()
         }
 
-        session!!.url.observe(this, Observer { url -> urlView!!.text = UrlUtils.stripUserInfo(url) })
+        // We need to set the initial value here and then update the view from the observer. That's needlessly verbose.
+        // We want to change that in Android Components: https://github.com/mozilla-mobile/android-components/issues/665
+        urlView!!.text = UrlUtils.stripUserInfo(session.url)
+        session.register(object : Session.Observer {
+            override fun onUrlChanged(session: Session, url: String) {
+                urlView?.text = UrlUtils.stripUserInfo(url)
+            }
+        }, owner = this)
 
         findInPageView = view.findViewById(R.id.find_in_page)
 
@@ -290,18 +293,17 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         closeFindInPage = view.findViewById(R.id.close_find_in_page)
         closeFindInPage!!.setOnClickListener(this)
 
-        setBlockingEnabled(session!!.isBlockingEnabled)
-        setShouldRequestDesktop(session!!.shouldRequestDesktopSite())
+        setBlockingEnabled(session.trackerBlockingEnabled)
+        setShouldRequestDesktop(session.shouldRequestDesktopSite)
 
-        LoadTimeObserver.addObservers(session!!, this)
+        LoadTimeObserver.addObservers(session, this)
 
-        session!!.loading.observe(this, object : NonNullObserver<Boolean>() {
-            public override fun onValueChanged(t: Boolean) {
-                val loading = t
+        session.register(object : Session.Observer {
+            override fun onLoadingStateChanged(session: Session, loading: Boolean) {
                 if (loading) {
                     backgroundTransitionGroup!!.resetTransition()
 
-                    progressView!!.progress = BrowserFragment.INITIAL_PROGRESS
+                    progressView!!.progress = INITIAL_PROGRESS
                     progressView!!.visibility = View.VISIBLE
                 } else {
                     if (progressView!!.visibility == View.VISIBLE) {
@@ -313,7 +315,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
                     swipeRefresh!!.isRefreshing = false
                 }
 
-                updateBlockingBadging(loading || session!!.isBlockingEnabled)
+                updateBlockingBadging(loading || session.trackerBlockingEnabled)
 
                 updateToolbarButtonStates(loading)
 
@@ -322,7 +324,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
                 hideFindInPage()
             }
-        })
+        }, owner = this)
 
         refreshButton = view.findViewById(R.id.refresh)
         refreshButton?.let { it.setOnClickListener(this) }
@@ -342,31 +344,40 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         blockView = view.findViewById<View>(R.id.block) as FrameLayout
 
         securityView = view.findViewById(R.id.security_info)
-        session!!.secure.observe(this, Observer { secure ->
-            if (!session!!.loading.value) {
-                if (secure!!) {
-                    securityView!!.setImageResource(R.drawable.ic_lock)
-                } else {
-                    if (URLUtil.isHttpUrl(url)) {
-                        // HTTP site
-                        securityView!!.setImageResource(R.drawable.ic_internet)
+
+        securityView!!.setImageResource(R.drawable.ic_internet)
+        session.register(object : Session.Observer {
+            override fun onSecurityChanged(session: Session, securityInfo: Session.SecurityInfo) {
+                if (!session.loading) {
+                    if (securityInfo.secure) {
+                        securityView!!.setImageResource(R.drawable.ic_lock)
                     } else {
-                        // Certificate is bad
-                        securityView!!.setImageResource(R.drawable.ic_warning)
+                        if (URLUtil.isHttpUrl(url)) {
+                            // HTTP site
+                            securityView!!.setImageResource(R.drawable.ic_internet)
+                        } else {
+                            // Certificate is bad
+                            securityView!!.setImageResource(R.drawable.ic_warning)
+                        }
                     }
+                } else {
+                    securityView!!.setImageResource(R.drawable.ic_internet)
                 }
-            } else {
-                securityView!!.setImageResource(R.drawable.ic_internet)
             }
-        })
+        }, owner = this)
+
         securityView!!.setOnClickListener(this)
 
-        session!!.progress.observe(this, Observer { progress -> progressView!!.progress = progress!! })
+        session.register(object : Session.Observer {
+            override fun onProgress(session: Session, progress: Int) {
+                progressView?.progress = progress
+            }
+        })
 
         menuView = view.findViewById<View>(R.id.menuView) as ImageButton
         menuView!!.setOnClickListener(this)
 
-        if (session!!.isCustomTab) {
+        if (session.isCustomTabSession()) {
             initialiseCustomTabUi(view)
         } else {
             initialiseNormalBrowserUi(view)
@@ -389,17 +400,27 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         val tabsButton = view.findViewById<FloatingSessionsButton>(R.id.tabs)
         tabsButton.setOnClickListener(this)
 
-        sessionManager.sessions.observe(this, object : NonNullObserver<List<Session>>() {
-            override fun onValueChanged(t: List<Session>) {
-                val sessions = t
-                tabsButton.updateSessionsCount(sessions.size)
-                eraseButton.updateSessionsCount(sessions.size)
+        val sessionManager = requireComponents.sessionManager
+        sessionManager.register(object : SessionManager.Observer {
+            override fun onSessionAdded(session: Session) {
+                tabsButton.updateSessionsCount(sessionManager.sessions.size)
+                eraseButton.updateSessionsCount(sessionManager.sessions.size)
+            }
+
+            override fun onSessionRemoved(session: Session) {
+                tabsButton.updateSessionsCount(sessionManager.sessions.size)
+                eraseButton.updateSessionsCount(sessionManager.sessions.size)
+            }
+
+            override fun onAllSessionsRemoved() {
+                tabsButton.updateSessionsCount(sessionManager.sessions.size)
+                eraseButton.updateSessionsCount(sessionManager.sessions.size)
             }
         })
     }
 
     private fun initialiseCustomTabUi(view: View) {
-        val customTabConfig = session!!.customTabConfig
+        val customTabConfig = session.customTabConfig!!
 
         // Unfortunately there's no simpler way to have the FAB only in normal-browser mode.
         // - ViewStub: requires splitting attributes for the FAB between the ViewStub, and actual FAB layout file.
@@ -417,9 +438,9 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         val textColor: Int
 
         if (customTabConfig.toolbarColor != null) {
-            urlBar!!.setBackgroundColor(customTabConfig.toolbarColor)
+            urlBar!!.setBackgroundColor(customTabConfig.toolbarColor!!)
 
-            textColor = ColorUtils.getReadableTextColor(customTabConfig.toolbarColor)
+            textColor = ColorUtils.getReadableTextColor(customTabConfig.toolbarColor!!)
             urlView!!.setTextColor(textColor)
         } else {
             textColor = Color.WHITE
@@ -448,10 +469,10 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
             val actionButton = view.findViewById<View>(R.id.customtab_actionbutton) as ImageButton
             actionButton.visibility = View.VISIBLE
 
-            actionButton.setImageBitmap(customTabConfig.actionButtonConfig.icon)
-            actionButton.contentDescription = customTabConfig.actionButtonConfig.description
+            actionButton.setImageBitmap(customTabConfig.actionButtonConfig!!.icon)
+            actionButton.contentDescription = customTabConfig.actionButtonConfig!!.description
 
-            val pendingIntent = customTabConfig.actionButtonConfig.pendingIntent
+            val pendingIntent = customTabConfig.actionButtonConfig!!.pendingIntent
 
             actionButton.setOnClickListener {
                 try {
@@ -725,8 +746,8 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         val addToHomescreenDialogFragment = AddToHomescreenDialogFragment.newInstance(
             url,
             title,
-            session!!.isBlockingEnabled,
-            session!!.shouldRequestDesktopSite()
+            session.trackerBlockingEnabled,
+            session.shouldRequestDesktopSite
         )
         addToHomescreenDialogFragment.setTargetFragment(
             this@BrowserFragment,
@@ -877,7 +898,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
             // Go back in web history
             goBack()
         } else {
-            if (session!!.source == Source.VIEW || session!!.source == Source.CUSTOM_TAB) {
+            if (session.source == Session.Source.ACTION_VIEW || session.source == Session.Source.CUSTOM_TAB) {
                 TelemetryWrapper.eraseBackToAppEvent()
 
                 // This session has been started from a VIEW intent. Go back to the previous app
@@ -886,12 +907,11 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
                 // If there are no other sessions then we remove the whole task because otherwise
                 // the old session might still be partially visible in the app switcher.
-                if (!SessionManager.getInstance().hasSession()) {
+                if (requireComponents.sessionManager.sessions.isEmpty()) {
                     requireActivity().finishAndRemoveTask()
                 } else {
                     requireActivity().finish()
                 }
-
                 // We can't show a snackbar outside of the app. So let's show a toast instead.
                 Toast.makeText(context, R.string.feedback_erase_custom_tab, Toast.LENGTH_SHORT).show()
             } else {
@@ -923,10 +943,10 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
         webView?.cleanup()
 
-        if (session!!.isCustomTab) {
-            SessionManager.getInstance().removeCustomTabSession(session!!.uuid)
+        if (session.isCustomTabSession()) {
+            requireComponents.sessionManager.remove(session)
         } else {
-            SessionManager.getInstance().removeCurrentSession()
+            requireComponents.sessionManager.remove()
         }
     }
 
@@ -956,15 +976,15 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
     override fun onClick(view: View) {
         when (view.id) {
             R.id.menuView -> {
-                val menu = BrowserMenu(activity, this, session!!.customTabConfig)
+                val menu = BrowserMenu(activity, this, session.customTabConfig)
                 menu.show(menuView)
 
                 menuWeakReference = WeakReference(menu)
             }
 
-            R.id.display_url -> if (SessionManager.getInstance().hasSessionWithUUID(session!!.uuid)) {
+            R.id.display_url -> if (requireComponents.sessionManager.findSessionById(session.id) != null) {
                 val urlFragment = UrlInputFragment
-                    .createWithSession(session!!, urlView!!)
+                    .createWithSession(session, urlView!!)
 
                 requireActivity().supportFragmentManager
                     .beginTransaction()
@@ -1008,10 +1028,12 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
             }
 
             R.id.open_in_firefox_focus -> {
-                sessionManager.moveCustomTabToRegularSessions(session)
+                session.customTabConfig = null
+
+                requireComponents.sessionManager.select(session)
 
                 val webView = getWebView()
-                webView?.saveWebViewState(session!!)
+                webView?.saveWebViewState(session)
 
                 val intent = Intent(context, MainActivity::class.java)
                 intent.action = Intent.ACTION_MAIN
@@ -1075,12 +1097,17 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
                 TelemetryWrapper.closeCustomTabEvent()
             }
 
-            R.id.help -> SessionManager.getInstance().createSession(Source.MENU, SupportUtils.HELP_URL)
+            R.id.help -> {
+                val session = Session(SupportUtils.HELP_URL, source = Session.Source.MENU)
+                requireComponents.sessionManager.add(session, selected = true)
+            }
 
-            R.id.help_trackers -> SessionManager.getInstance().createSession(
-                Source.MENU,
-                SupportUtils.getSumoURLForTopic(requireContext(), SupportUtils.SumoTopic.TRACKERS)
-            )
+            R.id.help_trackers -> {
+                val url = SupportUtils.getSumoURLForTopic(context!!, SupportUtils.SumoTopic.TRACKERS)
+                val session = Session(url, source = Session.Source.MENU)
+
+                requireComponents.sessionManager.add(session, selected = true)
+            }
 
             R.id.add_to_homescreen -> {
                 val webView = getWebView() ?: return
@@ -1093,11 +1120,10 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
             R.id.security_info -> showSecurityPopUp()
 
             R.id.report_site_issue -> {
-                SessionManager.getInstance()
-                    .createSession(
-                        Source.MENU,
-                        String.format(SupportUtils.REPORT_SITE_ISSUE_URL, url)
-                    )
+                val reportUrl = String.format(SupportUtils.REPORT_SITE_ISSUE_URL, url)
+                val session = Session(reportUrl, source = Session.Source.MENU)
+                requireComponents.sessionManager.add(session, selected = true)
+
                 TelemetryWrapper.reportSiteIssueEvent()
             }
 
@@ -1177,7 +1203,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
                 R.drawable.animated_background_disabled
         )
 
-        backgroundTransitionGroup = if (!session!!.isCustomTab) {
+        backgroundTransitionGroup = if (!session.isCustomTabSession()) {
             // Only update the toolbar background if this is not a custom tab. Custom tabs set their
             // own color and we do not want to override this here.
             urlBar!!.setBackgroundResource(if (enabled)
@@ -1210,10 +1236,10 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
 
     private fun showSecurityPopUp() {
         // Don't show Security Popup if the page is loading
-        if (session!!.loading.value!!) {
+        if (session.loading) {
             return
         }
-        val securityPopup = PopupUtils.createSecurityPopup(requireContext(), session!!)
+        val securityPopup = PopupUtils.createSecurityPopup(requireContext(), session)
         if (securityPopup != null) {
             securityPopup.setOnDismissListener { popupTint!!.visibility = View.GONE }
             securityPopup.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))
@@ -1237,7 +1263,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         if (view.id == R.id.display_url) {
             val context = activity ?: return false
 
-            if (session!!.isCustomTab) {
+            if (session.isCustomTabSession()) {
                 val clipBoard = context.getSystemService(Context.CLIPBOARD_SERVICE) as ClipboardManager
                 val uri = Uri.parse(url)
                 clipBoard.primaryClip = ClipData.newRawUri("Uri", uri)
@@ -1338,7 +1364,7 @@ class BrowserFragment : WebFragment(), LifecycleObserver, View.OnClickListener,
         @JvmStatic
         fun createForSession(session: Session): BrowserFragment {
             val arguments = Bundle()
-            arguments.putString(ARGUMENT_SESSION_UUID, session.uuid)
+            arguments.putString(ARGUMENT_SESSION_UUID, session.id)
 
             val fragment = BrowserFragment()
             fragment.arguments = arguments
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java
deleted file mode 100644
index 3a04e1a4587d..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java
+++ /dev/null
@@ -1,183 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-package org.mozilla.focus.fragment;
-
-import android.content.Context;
-import android.graphics.drawable.TransitionDrawable;
-import android.os.Bundle;
-import android.preference.PreferenceManager;
-import android.support.annotation.Nullable;
-import android.support.design.widget.TabLayout;
-import android.support.v4.app.Fragment;
-import android.support.v4.app.FragmentManager;
-import android.support.v4.view.ViewPager;
-import android.transition.Transition;
-import android.transition.TransitionInflater;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
-
-import org.mozilla.focus.R;
-import org.mozilla.focus.firstrun.FirstrunPagerAdapter;
-import org.mozilla.focus.session.NullSession;
-import org.mozilla.focus.session.Session;
-import org.mozilla.focus.session.SessionManager;
-import org.mozilla.focus.telemetry.TelemetryWrapper;
-import org.mozilla.focus.utils.StatusBarUtils;
-
-public class FirstrunFragment extends Fragment implements View.OnClickListener {
-    public static final String FRAGMENT_TAG = "firstrun";
-
-    public static final String FIRSTRUN_PREF = "firstrun_shown";
-
-    private static final String ARGUMENT_SESSION_UUID = "sessionUUID";
-
-    public static FirstrunFragment create(@Nullable Session currentSession) {
-        String uuid = currentSession != null ? currentSession.getUUID() : null;
-
-        Bundle arguments = new Bundle();
-        arguments.putString(ARGUMENT_SESSION_UUID, uuid);
-
-        FirstrunFragment fragment = new FirstrunFragment();
-        fragment.setArguments(arguments);
-
-        return fragment;
-    }
-
-    private ViewPager viewPager;
-
-    private View background;
-
-    @Override
-    public void onAttach(Context context) {
-        super.onAttach(context);
-
-        final Transition transition = TransitionInflater.from(context).
-                inflateTransition(R.transition.firstrun_exit);
-
-        setExitTransition(transition);
-
-        // We will send a telemetry event whenever a new firstrun page is shown. However this page
-        // listener won't fire for the initial page we are showing. So we are going to firing here.
-        TelemetryWrapper.showFirstRunPageEvent(0);
-    }
-
-    @Override
-    public View onCreateView(LayoutInflater inflater, ViewGroup container, @Nullable Bundle savedInstanceState) {
-        final View view = inflater.inflate(R.layout.fragment_firstrun, container, false);
-
-        view.findViewById(R.id.skip).setOnClickListener(this);
-
-        background = view.findViewById(R.id.background);
-
-        final FirstrunPagerAdapter adapter = new FirstrunPagerAdapter(container.getContext(), this);
-
-        viewPager = view.findViewById(R.id.pager);
-        viewPager.setContentDescription(adapter.getPageAccessibilityDescription(0));
-        viewPager.setFocusable(true);
-
-        viewPager.setPageTransformer(true, new ViewPager.PageTransformer() {
-            @Override
-            public void transformPage(View page, float position) {
-                page.setAlpha(1 - (0.5f * Math.abs(position)));
-            }
-        });
-
-        viewPager.setClipToPadding(false);
-        viewPager.setAdapter(adapter);
-        viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
-            @Override
-            public void onPageSelected(int position) {
-                TelemetryWrapper.showFirstRunPageEvent(position);
-
-                final TransitionDrawable drawable = (TransitionDrawable) background.getBackground();
-
-                if (position == adapter.getCount() - 1) {
-                    drawable.startTransition(200);
-                } else {
-                    drawable.resetTransition();
-                }
-
-                viewPager.setContentDescription(adapter.getPageAccessibilityDescription(position));
-            }
-
-            @Override
-            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {}
-
-            @Override
-            public void onPageScrollStateChanged(int state) {}
-        });
-
-        final TabLayout tabLayout = view.findViewById(R.id.tabs);
-        tabLayout.setupWithViewPager(viewPager, true);
-
-        return view;
-    }
-
-    @Override
-    public void onClick(View view) {
-        switch (view.getId()) {
-            case R.id.next:
-                viewPager.setCurrentItem(viewPager.getCurrentItem() + 1);
-                break;
-
-            case R.id.skip:
-                finishFirstrun();
-                TelemetryWrapper.skipFirstRunEvent();
-                break;
-
-            case R.id.finish:
-                finishFirstrun();
-                TelemetryWrapper.finishFirstRunEvent();
-                break;
-
-            default:
-                throw new IllegalArgumentException("Unknown view");
-        }
-    }
-
-    private void finishFirstrun() {
-        final FragmentManager fragmentManager = getActivity().getSupportFragmentManager();
-
-        PreferenceManager.getDefaultSharedPreferences(getContext())
-                .edit()
-                .putBoolean(FIRSTRUN_PREF, true)
-                .apply();
-
-        @Nullable String sessionUUID = getArguments().getString(ARGUMENT_SESSION_UUID);
-        SessionManager sessionManager = SessionManager.getInstance();
-
-        Fragment fragment;
-        if (sessionUUID == null) {
-            fragment = UrlInputFragment.createWithoutSession();
-        } else {
-            Session session;
-
-            if (sessionManager.hasSessionWithUUID(sessionUUID)) {
-                session = sessionManager.getSessionByUUID(sessionUUID);
-            } else {
-                session = new NullSession();
-            }
-
-            fragment =  BrowserFragment.createForSession(session);
-        }
-
-        fragmentManager
-                .beginTransaction()
-                .replace(R.id.container, fragment, UrlInputFragment.FRAGMENT_TAG)
-                .commit();
-    }
-
-    @Override
-    public void onResume() {
-        super.onResume();
-        StatusBarUtils.getStatusBarHeight(background, new StatusBarUtils.StatusBarHeightListener() {
-            @Override
-            public void onStatusBarHeightFetched(int statusBarHeight) {
-                background.setPadding(0, statusBarHeight, 0, 0);
-            }
-        });
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.kt
new file mode 100644
index 000000000000..69d8d65bb1b6
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.kt
@@ -0,0 +1,161 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.fragment
+
+import android.content.Context
+import android.graphics.drawable.TransitionDrawable
+import android.os.Bundle
+import android.preference.PreferenceManager
+import android.support.design.widget.TabLayout
+import android.support.v4.app.Fragment
+import android.support.v4.view.ViewPager
+import android.transition.TransitionInflater
+import android.view.LayoutInflater
+import android.view.View
+import android.view.ViewGroup
+import mozilla.components.browser.session.Session
+import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
+import org.mozilla.focus.firstrun.FirstrunPagerAdapter
+import org.mozilla.focus.telemetry.TelemetryWrapper
+import org.mozilla.focus.utils.StatusBarUtils
+
+class FirstrunFragment : Fragment(), View.OnClickListener {
+
+    private var viewPager: ViewPager? = null
+
+    private var background: View? = null
+
+    override fun onAttach(context: Context?) {
+        super.onAttach(context)
+
+        val transition = TransitionInflater.from(context).inflateTransition(R.transition.firstrun_exit)
+
+        exitTransition = transition
+
+        // We will send a telemetry event whenever a new firstrun page is shown. However this page
+        // listener won't fire for the initial page we are showing. So we are going to firing here.
+        TelemetryWrapper.showFirstRunPageEvent(0)
+    }
+
+    @Suppress("MagicNumber")
+    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
+        val view = inflater.inflate(R.layout.fragment_firstrun, container, false)
+
+        view.findViewById<View>(R.id.skip).setOnClickListener(this)
+
+        background = view.findViewById(R.id.background)
+
+        val adapter = FirstrunPagerAdapter(container!!.context, this)
+
+        viewPager = view.findViewById(R.id.pager)
+        viewPager!!.contentDescription = adapter.getPageAccessibilityDescription(0)
+        viewPager!!.isFocusable = true
+
+        viewPager!!.setPageTransformer(true) { page, position -> page.alpha = 1 - 0.5f * Math.abs(position) }
+
+        viewPager!!.clipToPadding = false
+        viewPager!!.adapter = adapter
+        viewPager!!.addOnPageChangeListener(object : ViewPager.OnPageChangeListener {
+            override fun onPageSelected(position: Int) {
+                TelemetryWrapper.showFirstRunPageEvent(position)
+
+                val drawable = background!!.background as TransitionDrawable
+
+                if (position == adapter.count - 1) {
+                    drawable.startTransition(200)
+                } else {
+                    drawable.resetTransition()
+                }
+
+                viewPager!!.contentDescription = adapter.getPageAccessibilityDescription(position)
+            }
+
+            override fun onPageScrolled(position: Int, positionOffset: Float, positionOffsetPixels: Int) {}
+
+            override fun onPageScrollStateChanged(state: Int) {}
+        })
+
+        val tabLayout = view.findViewById<TabLayout>(R.id.tabs)
+        tabLayout.setupWithViewPager(viewPager, true)
+
+        return view
+    }
+
+    override fun onClick(view: View) {
+        when (view.id) {
+            R.id.next -> viewPager!!.currentItem = viewPager!!.currentItem + 1
+
+            R.id.skip -> {
+                finishFirstrun()
+                TelemetryWrapper.skipFirstRunEvent()
+            }
+
+            R.id.finish -> {
+                finishFirstrun()
+                TelemetryWrapper.finishFirstRunEvent()
+            }
+
+            else -> throw IllegalArgumentException("Unknown view")
+        }
+    }
+
+    private fun finishFirstrun() {
+        val fragmentManager = activity!!.supportFragmentManager
+
+        PreferenceManager.getDefaultSharedPreferences(requireContext())
+            .edit()
+            .putBoolean(FIRSTRUN_PREF, true)
+            .apply()
+
+        val sessionUUID = arguments!!.getString(ARGUMENT_SESSION_UUID)
+        val sessionManager = requireContext().components.sessionManager
+
+        val fragment: Fragment
+        if (sessionUUID == null) {
+            fragment = UrlInputFragment.createWithoutSession()
+        } else {
+            val session = sessionManager.findSessionById(sessionUUID)
+
+            fragment = BrowserFragment.createForSession(session!!)
+        }
+
+        fragmentManager
+            .beginTransaction()
+            .replace(R.id.container, fragment, UrlInputFragment.FRAGMENT_TAG)
+            .commit()
+    }
+
+    override fun onResume() {
+        super.onResume()
+        StatusBarUtils.getStatusBarHeight(background) { statusBarHeight ->
+            background!!.setPadding(
+                0,
+                statusBarHeight,
+                0,
+                0
+            )
+        }
+    }
+
+    companion object {
+        const val FRAGMENT_TAG = "firstrun"
+        const val FIRSTRUN_PREF = "firstrun_shown"
+
+        private const val ARGUMENT_SESSION_UUID = "sessionUUID"
+
+        fun create(currentSession: Session?): FirstrunFragment {
+            val uuid = currentSession?.id
+
+            val arguments = Bundle()
+            arguments.putString(ARGUMENT_SESSION_UUID, uuid)
+
+            val fragment = FirstrunFragment()
+            fragment.arguments = arguments
+
+            return fragment
+        }
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.kt
index 94146afaf718..470d8cbf68a7 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.kt
@@ -8,9 +8,9 @@ import android.view.LayoutInflater
 import android.view.View
 import android.view.ViewGroup
 import android.widget.ProgressBar
+import mozilla.components.browser.session.Session
 
 import org.mozilla.focus.R
-import org.mozilla.focus.session.Session
 import org.mozilla.focus.web.Download
 import org.mozilla.focus.web.IWebView
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.kt
index 0812ce912727..06231589170f 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.kt
@@ -15,7 +15,6 @@ import android.os.Bundle
 import android.preference.PreferenceManager
 import android.text.InputType
 import android.text.SpannableString
-import android.text.TextUtils
 import android.text.method.LinkMovementMethod
 import android.text.style.ClickableSpan
 import android.text.style.ForegroundColorSpan
@@ -31,20 +30,20 @@ import kotlinx.android.synthetic.main.fragment_urlinput.view.*
 import kotlinx.coroutines.experimental.launch
 import mozilla.components.browser.domains.CustomDomains
 import mozilla.components.browser.domains.DomainAutoCompleteProvider
+import mozilla.components.browser.session.Session
 import mozilla.components.support.utils.ThreadUtils
 import mozilla.components.ui.autocomplete.InlineAutocompleteEditText
 import mozilla.components.ui.autocomplete.InlineAutocompleteEditText.AutocompleteResult
 import org.mozilla.focus.R
 import org.mozilla.focus.R.string.pref_key_homescreen_tips
 import org.mozilla.focus.R.string.teaser
+import org.mozilla.focus.ext.isSearch
+import org.mozilla.focus.ext.requireComponents
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity
 import org.mozilla.focus.locale.LocaleAwareFragment
 import org.mozilla.focus.menu.home.HomeMenu
 import org.mozilla.focus.searchsuggestions.SearchSuggestionsViewModel
 import org.mozilla.focus.searchsuggestions.ui.SearchSuggestionsFragment
-import org.mozilla.focus.session.Session
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.tips.Tip
 import org.mozilla.focus.tips.TipManager
@@ -106,7 +105,7 @@ class UrlInputFragment :
         fun createWithSession(session: Session, urlView: View): UrlInputFragment {
             val arguments = Bundle()
 
-            arguments.putString(ARGUMENT_SESSION_UUID, session.uuid)
+            arguments.putString(ARGUMENT_SESSION_UUID, session.id)
             arguments.putString(ARGUMENT_ANIMATION, ANIMATION_BROWSER_SCREEN)
 
             val screenLocation = IntArray(2)
@@ -160,9 +159,8 @@ class UrlInputFragment :
             .registerOnSharedPreferenceChangeListener(this)
 
         // Get session from session manager if there's a session UUID in the fragment's arguments
-        arguments?.getString(ARGUMENT_SESSION_UUID)?.let {
-            session = if (SessionManager.getInstance().hasSessionWithUUID(it)) SessionManager
-                .getInstance().getSessionByUUID(it) else null
+        arguments?.getString(ARGUMENT_SESSION_UUID)?.let { id ->
+            session = requireComponents.sessionManager.findSessionById(id)
         }
     }
 
@@ -320,8 +318,9 @@ class UrlInputFragment :
                     Features.SEARCH_TERMS_OR_URL
                 )
                     it.searchTerms else
-                    it.url.value
+                    it.url
             )
+
             clearView?.visibility = View.VISIBLE
             searchViewContainer?.visibility = View.GONE
             addToAutoComplete?.visibility = View.VISIBLE
@@ -421,14 +420,17 @@ class UrlInputFragment :
 
                 WhatsNew.userViewedWhatsNew(it)
 
-                SessionManager.getInstance().createSession(Source.MENU,
-                    SupportUtils.getSumoURLForTopic(it, SupportUtils.SumoTopic.WHATS_NEW))
+                val url = SupportUtils.getSumoURLForTopic(it, SupportUtils.SumoTopic.WHATS_NEW)
+                val session = Session(url, source = Session.Source.MENU)
+
+                requireComponents.sessionManager.add(session, selected = true)
             }
 
             R.id.settings -> (activity as LocaleAwareAppCompatActivity).openPreferences()
 
             R.id.help -> {
-                SessionManager.getInstance().createSession(Source.MENU, SupportUtils.HELP_URL)
+                val session = Session(SupportUtils.HELP_URL, source = Session.Source.MENU)
+                requireComponents.sessionManager.add(session, selected = true)
             }
 
             else -> throw IllegalStateException("Unhandled view in onClick()")
@@ -728,7 +730,9 @@ class UrlInputFragment :
     }
 
     private fun openUrl(url: String, searchTerms: String?) {
-        session?.searchTerms = searchTerms
+        if (!searchTerms.isNullOrEmpty()) {
+            session?.searchTerms = searchTerms!!
+        }
 
         val fragmentManager = requireActivity().supportFragmentManager
 
@@ -748,12 +752,12 @@ class UrlInputFragment :
                 .remove(this)
                 .commit()
         } else {
-            if (!TextUtils.isEmpty(searchTerms)) {
-                SessionManager.getInstance()
-                    .createSearchSession(Source.USER_ENTERED, url, searchTerms)
-            } else {
-                SessionManager.getInstance().createSession(Source.USER_ENTERED, url)
+            val session = Session(url, source = Session.Source.USER_ENTERED)
+            if (!searchTerms.isNullOrEmpty()) {
+                session.searchTerms = searchTerms!!
             }
+
+            requireComponents.sessionManager.add(session, selected = true)
         }
     }
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.kt
index 2cadbda38b1e..3265f192dcc9 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.kt
@@ -11,11 +11,13 @@ import android.view.LayoutInflater
 import android.view.View
 import android.view.ViewGroup
 import android.webkit.WebView
+import mozilla.components.browser.session.Session
 
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.savedWebViewState
+import org.mozilla.focus.ext.shouldRequestDesktopSite
 import org.mozilla.focus.locale.LocaleAwareFragment
 import org.mozilla.focus.locale.LocaleManager
-import org.mozilla.focus.session.Session
 import org.mozilla.focus.utils.AppConstants
 import org.mozilla.focus.web.IWebView
 
@@ -58,11 +60,9 @@ abstract class WebFragment : LocaleAwareFragment() {
         isWebViewAvailable = true
         webViewInstance!!.setCallback(createCallback())
 
-        val session = session
-
-        if (session != null) {
-            webViewInstance!!.setBlockingEnabled(session.isBlockingEnabled)
-            webViewInstance!!.setRequestDesktop(session.shouldRequestDesktopSite())
+        session?.let {
+            webViewInstance!!.setBlockingEnabled(it.trackerBlockingEnabled)
+            webViewInstance!!.setRequestDesktop(it.shouldRequestDesktopSite)
         }
 
         if (!AppConstants.isGeckoBuild) {
@@ -135,7 +135,7 @@ abstract class WebFragment : LocaleAwareFragment() {
 
     private fun restoreStateOrLoadUrl() {
         val session = session
-        if (session == null || !session.hasWebViewState()) {
+        if (session == null || session.savedWebViewState == null) {
             val url = initialUrl
             if (!TextUtils.isEmpty(url)) {
                 webViewInstance!!.loadUrl(url)
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BlockingItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BlockingItemViewHolder.java
index 138cfa8e9885..3091b6aa85ae 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BlockingItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BlockingItemViewHolder.java
@@ -28,7 +28,7 @@
         this.fragment = fragment;
 
         final Switch switchView = itemView.findViewById(R.id.blocking_switch);
-        switchView.setChecked(fragment.getSession().isBlockingEnabled());
+        switchView.setChecked(fragment.getSession().getTrackerBlockingEnabled());
         switchView.setOnCheckedChangeListener(this);
 
         final View helpView = itemView.findViewById(R.id.help_trackers);
@@ -43,11 +43,11 @@ public void onClick(View view) {
 
         trackerCounter = itemView.findViewById(R.id.trackers_count);
 
-        updateTrackers(fragment.getSession().getBlockedTrackers().getValue());
+        updateTrackers(fragment.getSession().getTrackersBlocked().size());
     }
 
     /* package */ void updateTrackers(int trackers) {
-        if (fragment.getSession().isBlockingEnabled()) {
+        if (fragment.getSession().getTrackerBlockingEnabled()) {
             updateTrackingCount(trackerCounter, trackers);
         } else {
             disableTrackingCount(trackerCounter);
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenu.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenu.java
index ddf81b51e371..a0cf6d20a260 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenu.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenu.java
@@ -18,8 +18,8 @@
 import android.widget.PopupWindow;
 import android.widget.TextView;
 
+import mozilla.components.browser.session.tab.CustomTabConfig;
 import org.mozilla.focus.R;
-import org.mozilla.focus.customtabs.CustomTabConfig;
 import org.mozilla.focus.fragment.BrowserFragment;
 import org.mozilla.focus.utils.ViewUtils;
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenuAdapter.kt b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenuAdapter.kt
index 8ca5e11aa17d..3a9c45aacc03 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenuAdapter.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/BrowserMenuAdapter.kt
@@ -10,9 +10,9 @@ import android.content.Context
 import android.support.v7.widget.RecyclerView
 import android.view.LayoutInflater
 import android.view.ViewGroup
+import mozilla.components.browser.session.tab.CustomTabConfig
 
 import org.mozilla.focus.R
-import org.mozilla.focus.customtabs.CustomTabConfig
 import org.mozilla.focus.fragment.BrowserFragment
 import org.mozilla.focus.utils.AppConstants
 import org.mozilla.focus.utils.Browsers
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/MenuItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/MenuItemViewHolder.java
index c98d6c2d7590..b6fec6c71b10 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/MenuItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/MenuItemViewHolder.java
@@ -38,7 +38,7 @@
             }
         }
 
-        final boolean isLoading = browserFragment.getSession().getLoading().getValue();
+        final boolean isLoading = browserFragment.getSession().getLoading();
 
         if ((menuItem.getId() == R.id.add_to_homescreen || menuItem.getId() == R.id.find_in_page) && isLoading) {
             menuItemView.setTextColor(browserFragment.getResources().getColor(R.color.colorTextInactive));
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/NavigationItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/NavigationItemViewHolder.java
index 0eb5a18c023c..b20ab0c0736e 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/NavigationItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/NavigationItemViewHolder.java
@@ -25,7 +25,7 @@ public NavigationItemViewHolder(View itemView, BrowserFragment fragment) {
         stopButton = itemView.findViewById(R.id.stop);
         stopButton.setOnClickListener(this);
 
-        updateLoading(fragment.getSession().getLoading().getValue());
+        updateLoading(fragment.getSession().getLoading());
 
         final View forwardView = itemView.findViewById(R.id.forward);
         if (!fragment.canGoForward()) {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/RequestDesktopCheckItemViewHolder.kt b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/RequestDesktopCheckItemViewHolder.kt
index 9b3b715df083..f6e7547e08f4 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/RequestDesktopCheckItemViewHolder.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/browser/RequestDesktopCheckItemViewHolder.kt
@@ -14,6 +14,7 @@ import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.UrlUtils
 
 import mozilla.components.support.utils.ThreadUtils
+import org.mozilla.focus.ext.shouldRequestDesktopSite
 
 internal class RequestDesktopCheckItemViewHolder/* package */(
     itemView: View,
@@ -22,7 +23,7 @@ internal class RequestDesktopCheckItemViewHolder/* package */(
     private val checkbox: CheckBox = itemView.findViewById(R.id.check_menu_item_checkbox)
 
     init {
-        checkbox.isChecked = fragment.session!!.shouldRequestDesktopSite()
+        checkbox.isChecked = fragment.session.shouldRequestDesktopSite
         checkbox.setOnCheckedChangeListener(this)
     }
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/context/WebContextMenu.kt b/focus-android/app/src/main/java/org/mozilla/focus/menu/context/WebContextMenu.kt
index d8a048cf15c4..f637f2a01862 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/context/WebContextMenu.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/context/WebContextMenu.kt
@@ -25,10 +25,10 @@ import android.text.Html
 import android.view.LayoutInflater
 import android.view.View
 import android.widget.TextView
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R
 import org.mozilla.focus.open.OpenWithFragment
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.telemetry.TelemetryWrapper.BrowserContextMenuValue
 import org.mozilla.focus.utils.Browsers
@@ -170,19 +170,20 @@ object WebContextMenu {
                     true
                 }
                 R.id.menu_new_tab -> {
-                    SessionManager.getInstance()
-                            .createNewTabSession(Source.MENU, hitTarget.linkURL, context).also { session ->
-                                if (!Settings.getInstance(context).shouldOpenNewTabs()) {
-                                    // Show Snackbar to allow users to switch to tab they just opened
-                                    val snackbar = ViewUtils.getBrandedSnackbar(
-                                            (context as Activity).findViewById(android.R.id.content),
-                                            R.string.new_tab_opened_snackbar)
-                                    snackbar.setAction(R.string.open_new_tab_snackbar) {
-                                        SessionManager.getInstance().selectSession(session)
-                                    }
-                                    snackbar.show()
-                                }
-                            }
+                    val session = Session(hitTarget.linkURL, source = Session.Source.MENU)
+                    context.components.sessionManager.add(session, selected = false)
+
+                    if (!Settings.getInstance(context).shouldOpenNewTabs()) {
+                        // Show Snackbar to allow users to switch to tab they just opened
+                        val snackbar = ViewUtils.getBrandedSnackbar(
+                                (context as Activity).findViewById(android.R.id.content),
+                                R.string.new_tab_opened_snackbar)
+                        snackbar.setAction(R.string.open_new_tab_snackbar) {
+                            context.components.sessionManager.select(session)
+                        }
+                        snackbar.show()
+                    }
+
                     TelemetryWrapper.openLinkInNewTabEvent()
                     PreferenceManager.getDefaultSharedPreferences(context).edit()
                             .putBoolean(
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/observer/LoadTimeObserver.kt b/focus-android/app/src/main/java/org/mozilla/focus/observer/LoadTimeObserver.kt
index 9f661fb2fe05..286d2669f130 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/observer/LoadTimeObserver.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/observer/LoadTimeObserver.kt
@@ -1,10 +1,13 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
 package org.mozilla.focus.observer
 
 import android.os.SystemClock
 import android.support.v4.app.Fragment
 import android.util.Log
-import org.mozilla.focus.architecture.NonNullObserver
-import org.mozilla.focus.session.Session
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.UrlUtils
 
@@ -18,19 +21,28 @@ object LoadTimeObserver {
         var startLoadTime: Long = 0
         var urlLoading: String? = null
 
-        session.loading.observe(fragment, object : NonNullObserver<Boolean>() {
-            public override fun onValueChanged(t: Boolean) {
-                if (t) {
-                    if ((urlLoading != null && urlLoading != session.url.value) || urlLoading == null) {
-                        urlLoading = session.url.value
+        session.register(object : Session.Observer {
+            override fun onUrlChanged(session: Session, url: String) {
+                if ((urlLoading != null && urlLoading != url) || urlLoading == null) {
+                    startLoadTime = SystemClock.elapsedRealtime()
+                    Log.i(LOG_TAG, "zerdatime $startLoadTime - url changed to $url, new page load start")
+                    urlLoading = url
+                }
+            }
+
+            override fun onLoadingStateChanged(session: Session, loading: Boolean) {
+                if (loading) {
+                    if ((urlLoading != null && urlLoading != session.url) || urlLoading == null) {
+                        urlLoading = session.url
                         startLoadTime = SystemClock.elapsedRealtime()
                         Log.i(LOG_TAG, "zerdatime $startLoadTime - page load start")
                     }
                 } else {
                     // Progress of 99 means the page completed loading and wasn't interrupted.
                     if (urlLoading != null &&
-                            session.url.value == urlLoading &&
-                            session.progress.value == MAX_PROGRESS) {
+                        session.url == urlLoading &&
+                        session.progress == MAX_PROGRESS) {
+                        Log.i(LOG_TAG, "Loaded page at $session.url.value")
                         val endTime = SystemClock.elapsedRealtime()
                         Log.i(LOG_TAG, "zerdatime $endTime - page load stop")
                         val elapsedLoad = endTime - startLoadTime
@@ -38,20 +50,11 @@ object LoadTimeObserver {
                         // Even internal pages take longer than 40 ms to load, let's not send any loads faster than this
                         if (elapsedLoad > MIN_LOAD_TIME && !UrlUtils.isLocalizedContent(urlLoading)) {
                             Log.i(LOG_TAG, "Sent load to histogram")
-                            TelemetryWrapper.addLoadToHistogram(session.url.value, elapsedLoad)
+                            TelemetryWrapper.addLoadToHistogram(session.url, elapsedLoad)
                         }
                     }
                 }
             }
-        })
-        session.url.observe(fragment, object : NonNullObserver<String>() {
-            public override fun onValueChanged(t: String) {
-                if ((urlLoading != null && urlLoading != t) || urlLoading == null) {
-                    startLoadTime = SystemClock.elapsedRealtime()
-                    Log.i(LOG_TAG, "zerdatime $startLoadTime - url changed to $t, new page load start")
-                    urlLoading = t
-                }
-            }
-        })
+        }, owner = fragment)
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt b/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt
index 13200d65cea3..e96e1a941269 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt
@@ -16,53 +16,50 @@ import android.webkit.URLUtil
 import android.widget.ImageView
 import android.widget.PopupWindow
 import android.widget.TextView
+import mozilla.components.browser.session.Session
 import mozilla.components.support.ktx.android.graphics.drawable.toBitmap
 import mozilla.components.support.utils.DrawableUtils
 import org.mozilla.focus.R
-import org.mozilla.focus.session.Session
 import java.net.MalformedURLException
 import java.net.URL
 
 object PopupUtils {
 
     fun createSecurityPopup(context: Context, session: Session): PopupWindow? {
-        if (session.secure.value != null) {
-            val isSecure = session.secure.value
-            val url = session.url.value
-            val res = context.resources
-
-            val inflater = LayoutInflater.from(context)
-            val popUpView = inflater.inflate(R.layout.security_popup, null)
-            val origin = session.securityOrigin.value
-            val verifierInfo = session.securityVerifier.value
-            val hostInfo = popUpView.findViewById<TextView>(R.id.site_identity_title)
-            val securityInfoIcon = popUpView.findViewById<ImageView>(R.id.site_identity_icon)
-            val verifier = popUpView.findViewById<TextView>(R.id.verifier)
-
-            setOrigin(hostInfo, origin, url)
-
-            val identityState = popUpView.findViewById<TextView>(R.id.site_identity_state)
-            identityState.setText(
-                if (isSecure)
-                    R.string.security_popup_secure_connection
-                else
-                    R.string.security_popup_insecure_connection)
-
-            if (isSecure) {
-                setSecurityInfoSecure(context, identityState, verifierInfo, verifier,
-                    securityInfoIcon)
-            } else {
-                verifier.visibility = View.GONE
-                setSecurityInfoInsecure(context, identityState, url, securityInfoIcon)
-            }
+        val isSecure = session.securityInfo.secure
+        val url = session.url
+        val res = context.resources
+
+        val inflater = LayoutInflater.from(context)
+        val popUpView = inflater.inflate(R.layout.security_popup, null)
+        val origin = session.securityInfo.host
+        val verifierInfo = session.securityInfo.issuer
+        val hostInfo = popUpView.findViewById<TextView>(R.id.site_identity_title)
+        val securityInfoIcon = popUpView.findViewById<ImageView>(R.id.site_identity_icon)
+        val verifier = popUpView.findViewById<TextView>(R.id.verifier)
+
+        setOrigin(hostInfo, origin, url)
+
+        val identityState = popUpView.findViewById<TextView>(R.id.site_identity_state)
+        identityState.setText(
+            if (isSecure)
+                R.string.security_popup_secure_connection
+            else
+                R.string.security_popup_insecure_connection)
+
+        if (isSecure) {
+            setSecurityInfoSecure(context, identityState, verifierInfo, verifier,
+                securityInfoIcon)
+        } else {
+            verifier.visibility = View.GONE
+            setSecurityInfoInsecure(context, identityState, url, securityInfoIcon)
+        }
 
-            identityState.compoundDrawablePadding = res.getDimension(
-                R.dimen.doorhanger_drawable_padding).toInt()
+        identityState.compoundDrawablePadding = res.getDimension(
+            R.dimen.doorhanger_drawable_padding).toInt()
 
-            return PopupWindow(popUpView, res.getDimension(R.dimen.doorhanger_width).toInt(),
-                ViewGroup.LayoutParams.WRAP_CONTENT, true)
-        }
-        return null
+        return PopupWindow(popUpView, res.getDimension(R.dimen.doorhanger_width).toInt(),
+            ViewGroup.LayoutParams.WRAP_CONTENT, true)
     }
 
     private fun setOrigin(hostInfo: TextView, origin: String?, url: String) {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/search/CustomSearchEngineStore.kt b/focus-android/app/src/main/java/org/mozilla/focus/search/CustomSearchEngineStore.kt
index 47a102ec1470..d0bb041204ca 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/search/CustomSearchEngineStore.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/search/CustomSearchEngineStore.kt
@@ -8,7 +8,7 @@ import android.content.Context
 import android.util.Log
 import mozilla.components.browser.search.SearchEngine
 import mozilla.components.browser.search.SearchEngineParser
-import org.mozilla.focus.Components
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.shortcut.IconGenerator
 import org.xmlpull.v1.XmlPullParserException
 import java.io.IOException
@@ -18,7 +18,7 @@ object CustomSearchEngineStore {
         val sharedPreferences = context.getSharedPreferences(PREF_FILE_SEARCH_ENGINES,
                 Context.MODE_PRIVATE)
 
-        val defaultEngines = Components.searchEngineManager.getSearchEngines(context)
+        val defaultEngines = context.components.searchEngineManager.getSearchEngines(context)
 
         return !sharedPreferences.contains(engineName) && !defaultEngines.any { it.name == engineName }
     }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEngineListPreference.kt b/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEngineListPreference.kt
index 74eaabf874a1..e8257cd359cd 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEngineListPreference.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEngineListPreference.kt
@@ -18,8 +18,8 @@ import android.widget.RadioGroup
 import kotlinx.coroutines.experimental.android.UI
 import kotlinx.coroutines.experimental.launch
 import mozilla.components.browser.search.SearchEngine
-import org.mozilla.focus.Components
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.utils.Settings
 
 abstract class SearchEngineListPreference : Preference {
@@ -41,7 +41,7 @@ abstract class SearchEngineListPreference : Preference {
         searchEngineGroup = holder!!.itemView.findViewById(R.id.search_engine_group)
         val context = searchEngineGroup!!.context
 
-        searchEngines = Components.searchEngineManager.getSearchEngines(context)
+        searchEngines = context.components.searchEngineManager.getSearchEngines(context)
             .sortedBy { it.name }
 
         refreshSearchEngineViews(context)
@@ -51,7 +51,7 @@ abstract class SearchEngineListPreference : Preference {
 
     fun refetchSearchEngines() {
         launch (UI) {
-            searchEngines = Components.searchEngineManager
+            searchEngines = context.components.searchEngineManager
                     .load(this@SearchEngineListPreference.context)
                     .await()
                     .sortedBy { it.name }
@@ -67,7 +67,7 @@ abstract class SearchEngineListPreference : Preference {
             return
         }
 
-        val defaultSearchEngine = Components.searchEngineManager.getDefaultSearchEngine(
+        val defaultSearchEngine = context.components.searchEngineManager.getDefaultSearchEngine(
                 context,
                 Settings.getInstance(context).defaultSearchEngineName
         ).identifier
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEnginePreference.kt b/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEnginePreference.kt
index 30c60a4cc5b6..1746f59ac1c1 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEnginePreference.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/search/SearchEnginePreference.kt
@@ -9,8 +9,8 @@ import android.content.Context
 import android.content.SharedPreferences
 import android.support.v7.preference.Preference
 import android.util.AttributeSet
-import org.mozilla.focus.Components
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.utils.Settings
 
 /**
@@ -45,7 +45,7 @@ class SearchEnginePreference : Preference, SharedPreferences.OnSharedPreferenceC
     }
 
     private val defaultSearchEngineName: String
-        get() = Components.searchEngineManager.getDefaultSearchEngine(
+        get() = context.components.searchEngineManager.getDefaultSearchEngine(
                 getContext(),
                 Settings.getInstance(context).defaultSearchEngineName).name
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/SearchSuggestionsPreferences.kt b/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/SearchSuggestionsPreferences.kt
index a36ad55e2552..3a3dcf2ec102 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/SearchSuggestionsPreferences.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/SearchSuggestionsPreferences.kt
@@ -8,7 +8,7 @@ import android.content.Context
 import android.preference.PreferenceManager
 import org.mozilla.focus.R
 import mozilla.components.browser.search.SearchEngine
-import org.mozilla.focus.Components
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.Settings
 
@@ -21,7 +21,7 @@ class SearchSuggestionsPreferences(private val context: Context) {
     fun userHasDismissedNoSuggestionsMessage(): Boolean = settings.userHasDismissedNoSuggestionsMessage()
 
     fun getSearchEngine(): SearchEngine {
-        return Components.searchEngineManager.getDefaultSearchEngine(
+        return context.components.searchEngineManager.getDefaultSearchEngine(
                 context, settings.defaultSearchEngineName)
     }
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/ui/SearchSuggestionsFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/ui/SearchSuggestionsFragment.kt
index 639ce832d5c0..8e52bb900c70 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/ui/SearchSuggestionsFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/searchsuggestions/ui/SearchSuggestionsFragment.kt
@@ -28,11 +28,11 @@ import kotlinx.android.synthetic.main.fragment_search_suggestions.*
 import kotlinx.coroutines.experimental.CommonPool
 import kotlinx.coroutines.experimental.android.UI
 import kotlinx.coroutines.experimental.launch
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.searchsuggestions.SearchSuggestionsViewModel
 import org.mozilla.focus.searchsuggestions.State
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
 import org.mozilla.focus.utils.SupportUtils
 import org.mozilla.focus.utils.UrlUtils
 
@@ -136,8 +136,10 @@ class SearchSuggestionsFragment : Fragment() {
 
         val learnMoreSpan = object : ClickableSpan() {
             override fun onClick(textView: View) {
-                val url = SupportUtils.getSumoURLForTopic(context!!, SupportUtils.SumoTopic.SEARCH_SUGGESTIONS)
-                SessionManager.getInstance().createSession(Source.MENU, url)
+                val context = textView.context
+                val url = SupportUtils.getSumoURLForTopic(context, SupportUtils.SumoTopic.SEARCH_SUGGESTIONS)
+                val session = Session(url, source = Session.Source.MENU)
+                context.components.sessionManager.add(session, selected = true)
             }
 
             override fun updateDrawState(ds: TextPaint?) {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/IntentProcessor.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/IntentProcessor.kt
new file mode 100644
index 000000000000..38eabbea5697
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/IntentProcessor.kt
@@ -0,0 +1,153 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session
+
+import android.content.Context
+import android.content.Intent
+import android.os.Bundle
+import android.text.TextUtils
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+import mozilla.components.browser.session.tab.CustomTabConfig
+import mozilla.components.support.utils.SafeIntent
+import mozilla.components.support.utils.WebURLFinder
+import org.mozilla.focus.ext.shouldRequestDesktopSite
+import org.mozilla.focus.shortcut.HomeScreen
+import org.mozilla.focus.utils.UrlUtils
+
+/**
+ * Implementation moved from Focus SessionManager. To be replaced with SessionIntentProcessor from feature-session
+ * component soon.
+ */
+class IntentProcessor(
+    private val sessionManager: SessionManager
+) {
+    /**
+     * Handle this incoming intent (via onCreate()) and create a new session if required.
+     */
+    fun handleIntent(context: Context, intent: SafeIntent, savedInstanceState: Bundle?): Session? {
+        if ((intent.flags and Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) != 0) {
+            // This Intent was launched from history (recent apps). Android will redeliver the
+            // original Intent (which might be a VIEW intent). However if there's no active browsing
+            // session then we do not want to re-process the Intent and potentially re-open a website
+            // from a session that the user already "erased".
+            return null
+        }
+
+        if (savedInstanceState != null) {
+            // We are restoring a previous session - No need to handle this Intent.
+            return null
+        }
+
+        return createSessionFromIntent(context, intent)
+    }
+
+    /**
+     * Handle this incoming intent (via onNewIntent()) and create a new session if required.
+     */
+    fun handleNewIntent(context: Context, intent: SafeIntent) {
+        createSessionFromIntent(context, intent)
+    }
+
+    @Suppress("ComplexMethod", "ReturnCount")
+    private fun createSessionFromIntent(context: Context, intent: SafeIntent): Session? {
+        val action = intent.action
+
+        when (action) {
+            Intent.ACTION_VIEW -> {
+                val dataString = intent.dataString
+                if (TextUtils.isEmpty(dataString)) {
+                    // If there's no URL in the Intent then we can't create a session.
+                    return null
+                }
+
+                return if (intent.hasExtra(HomeScreen.ADD_TO_HOMESCREEN_TAG)) {
+                    val blockingEnabled = intent.getBooleanExtra(HomeScreen.BLOCKING_ENABLED, true)
+                    val requestDesktop = intent.getBooleanExtra(HomeScreen.REQUEST_DESKTOP, false)
+
+                    createSession(
+                        Session.Source.HOME_SCREEN,
+                        intent,
+                        intent.dataString ?: "",
+                        blockingEnabled,
+                        requestDesktop)
+                } else {
+                    createSession(Session.Source.ACTION_VIEW, intent, intent.dataString ?: "")
+                }
+            }
+
+            Intent.ACTION_SEND -> {
+                val dataString = intent.getStringExtra(Intent.EXTRA_TEXT)
+                if (TextUtils.isEmpty(dataString)) {
+                    return null
+                }
+
+                return if (!UrlUtils.isUrl(dataString)) {
+                    val bestURL = WebURLFinder(dataString).bestWebURL()
+                    if (!TextUtils.isEmpty(bestURL)) {
+                        createSession(Session.Source.ACTION_SEND, bestURL ?: "")
+                    } else {
+                        createSearchSession(
+                            Session.Source.ACTION_SEND,
+                            UrlUtils.createSearchUrl(context, dataString),
+                            dataString ?: "")
+                    }
+                } else {
+                    createSession(Session.Source.ACTION_SEND, dataString ?: "")
+                }
+            }
+
+            else -> return null
+        }
+    }
+
+    private fun createSession(source: Session.Source, url: String): Session {
+        return Session(url, source = source).apply {
+            sessionManager.add(this, selected = true)
+        }
+    }
+
+    private fun createSearchSession(source: Session.Source, url: String, searchTerms: String): Session {
+        return Session(url, source = source).apply {
+            this.searchTerms = searchTerms
+            sessionManager.add(this, selected = true)
+        }
+    }
+
+    private fun createSession(source: Session.Source, intent: SafeIntent, url: String): Session {
+        return if (CustomTabConfig.isCustomTabIntent(intent)) {
+            Session(url, source = Session.Source.CUSTOM_TAB).apply {
+                customTabConfig = CustomTabConfig.createFromIntent(intent)
+                sessionManager.add(this, selected = true)
+            }
+        } else {
+            Session(url, source = source).apply {
+                sessionManager.add(this, selected = true)
+            }
+        }
+    }
+
+    private fun createSession(
+        source: Session.Source,
+        intent: SafeIntent,
+        url: String,
+        blockingEnabled: Boolean,
+        requestDesktop: Boolean
+    ): Session {
+        val session = if (CustomTabConfig.isCustomTabIntent(intent)) {
+            Session(url, source = Session.Source.CUSTOM_TAB).apply {
+                customTabConfig = CustomTabConfig.createFromIntent(intent)
+            }
+        } else {
+            Session(url, source = source)
+        }
+        session.trackerBlockingEnabled = blockingEnabled
+        session.shouldRequestDesktopSite = requestDesktop
+
+        sessionManager.add(session, selected = true)
+
+        return session
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.kt
index a05a4c07207f..362832475af3 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.kt
@@ -5,15 +5,25 @@
 package org.mozilla.focus.session
 
 import android.content.Context
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+import org.mozilla.focus.ext.components
 
-import org.mozilla.focus.architecture.NonNullObserver
+class NotificationSessionObserver(
+    private val context: Context
+) : SessionManager.Observer {
 
-class NotificationSessionObserver(private val context: Context) : NonNullObserver<List<Session>>() {
-    override fun onValueChanged(t: List<Session>) {
-        if (t.isEmpty()) {
+    override fun onSessionRemoved(session: Session) {
+        if (context.components.sessionManager.sessions.isEmpty()) {
             SessionNotificationService.stop(context)
-        } else {
-            SessionNotificationService.start(context)
         }
     }
+
+    override fun onAllSessionsRemoved() {
+        SessionNotificationService.stop(context)
+    }
+
+    override fun onSessionAdded(session: Session) {
+        SessionNotificationService.start(context)
+    }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java b/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java
deleted file mode 100644
index 2921250b4aab..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java
+++ /dev/null
@@ -1,16 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import org.mozilla.focus.browser.LocalizedContent;
-
-/**
- * An "empty" session object that can be used instead of <code>null</code>.
- */
-public class NullSession extends Session {
-    public NullSession() {
-        super(Source.NONE, LocalizedContent.URL_ABOUT);
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java b/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java
deleted file mode 100644
index 8c2c474a3f48..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java
+++ /dev/null
@@ -1,219 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.arch.lifecycle.LiveData;
-import android.arch.lifecycle.MutableLiveData;
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.text.TextUtils;
-
-import org.mozilla.focus.architecture.NonNullLiveData;
-import org.mozilla.focus.architecture.NonNullMutableLiveData;
-import org.mozilla.focus.customtabs.CustomTabConfig;
-
-import java.util.UUID;
-
-/**
- * Keeping track of state / data of a single browsing session (tab).
- */
-public class Session {
-    private Source source;
-    private final String uuid;
-    private final NonNullMutableLiveData<String> url;
-    private final MutableLiveData<String> pageTitle;
-    private final NonNullMutableLiveData<Integer> progress;
-    private final NonNullMutableLiveData<Boolean> secure;
-    private final MutableLiveData<String> securityVerifier;
-    private final MutableLiveData<String> securityOrigin;
-    private final NonNullMutableLiveData<Boolean> loading;
-    private final NonNullMutableLiveData<Integer> trackersBlocked;
-    private CustomTabConfig customTabConfig;
-    private Bundle webviewState;
-    private String searchTerms;
-    private String searchUrl;
-    private boolean isRecorded;
-    private boolean isBlockingEnabled;
-    private boolean requestDesktopSite;
-
-    /* package */ Session(Source source, String url) {
-        this.uuid = UUID.randomUUID().toString();
-        this.source = source;
-
-        this.url = new NonNullMutableLiveData<>(url);
-        this.pageTitle = new MutableLiveData<>();
-        this.progress = new NonNullMutableLiveData<>(0);
-        this.secure = new NonNullMutableLiveData<>(false);
-        this.loading = new NonNullMutableLiveData<>(false);
-        this.trackersBlocked = new NonNullMutableLiveData<>(0);
-
-        this.securityOrigin = new MutableLiveData<>();
-        this.securityVerifier = new MutableLiveData<>();
-
-        this.isBlockingEnabled = true;
-        this.isRecorded = false;
-    }
-
-    /* package */ Session(String url, @NonNull CustomTabConfig customTabConfig) {
-        this(Source.CUSTOM_TAB, url);
-
-        this.customTabConfig = customTabConfig;
-    }
-
-    /* package */ void clearSource() {
-        source = Source.NONE;
-    }
-
-    public Source getSource() {
-        return source;
-    }
-
-    public String getUUID() {
-        return uuid;
-    }
-
-    /* package */ void setUrl(String url) {
-        this.url.setValue(url);
-    }
-
-    public NonNullLiveData<String> getUrl() {
-        return url;
-    }
-
-    public LiveData<String> getPageTitle() {
-        return pageTitle;
-    }
-
-    public void setPageTitle(String pageTitle) {
-        this.pageTitle.setValue(pageTitle);
-    }
-
-    /* package */ void setProgress(int progress) {
-        this.progress.setValue(progress);
-    }
-
-    public NonNullLiveData<Integer> getProgress() {
-        return progress;
-    }
-
-    /* package */ void setSecure(boolean secure) {
-        this.secure.setValue(secure);
-    }
-
-    public NonNullLiveData<Boolean> getSecure() {
-        return secure;
-    }
-
-    /* package */ void setSecurityVerifier(String verifier) {
-        this.securityVerifier.setValue(verifier);
-    }
-
-    /* package */ void setSecurityOrigin(String origin) {
-        this.securityOrigin.setValue(origin);
-    }
-
-    public LiveData<String> getSecurityVerifier() {
-        return securityVerifier;
-    }
-
-    public LiveData<String> getSecurityOrigin() {
-        return securityOrigin;
-    }
-
-    /* package */ void setLoading(boolean loading) {
-        this.loading.setValue(loading);
-    }
-
-    public NonNullLiveData<Boolean> getLoading() {
-        return loading;
-    }
-
-    /* package */ void setTrackersBlocked(int trackersBlocked) {
-        this.trackersBlocked.postValue(trackersBlocked);
-    }
-
-    /* package */ void clearSearchTerms() {
-        searchTerms = null;
-    }
-
-    public NonNullLiveData<Integer> getBlockedTrackers() {
-        return trackersBlocked;
-    }
-
-    public void saveWebViewState(Bundle bundle) {
-        this.webviewState = bundle;
-    }
-
-    public Bundle getWebViewState() {
-        return webviewState;
-    }
-
-    public boolean hasWebViewState() {
-        return webviewState != null;
-    }
-
-    public boolean isCustomTab() {
-        return customTabConfig != null;
-    }
-
-    public CustomTabConfig getCustomTabConfig() {
-        return customTabConfig;
-    }
-
-    public boolean isRecorded() {
-        return isRecorded;
-    }
-
-    public void markAsRecorded() {
-        isRecorded = true;
-    }
-
-    public boolean isSearch() {
-        return !TextUtils.isEmpty(searchTerms);
-    }
-
-    public void setSearchTerms(String searchTerms) {
-        this.searchTerms = searchTerms;
-    }
-
-    public String getSearchTerms() {
-        return searchTerms;
-    }
-
-    public String getSearchUrl() {
-        return searchUrl;
-    }
-
-    public void setSearchUrl(String searchUrl) {
-        this.searchUrl = searchUrl;
-    }
-
-    public boolean isSameAs(@NonNull Session session) {
-        return uuid.equals(session.getUUID());
-    }
-
-    public boolean isBlockingEnabled() {
-        return isBlockingEnabled;
-    }
-
-    public void setBlockingEnabled(boolean blockingEnabled) {
-        this.isBlockingEnabled = blockingEnabled;
-    }
-
-    public boolean shouldRequestDesktopSite() {
-        return requestDesktopSite;
-    }
-
-    public void setRequestDesktopSite(boolean requestDesktopSite) {
-        this.requestDesktopSite = requestDesktopSite;
-    }
-
-    /**
-     * Remove the custom tab configuration. This will transform this session into a regular session.
-     */
-    /* package */ void stripCustomTabConfiguration() {
-        customTabConfig = null;
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java
deleted file mode 100644
index 5b54249a603c..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java
+++ /dev/null
@@ -1,132 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.view.View;
-
-import org.mozilla.focus.web.Download;
-import org.mozilla.focus.web.IWebView;
-
-public class SessionCallbackProxy implements IWebView.Callback {
-    /* package */ static final int MINIMUM_PROGRESS = 5;
-
-    private final Session session;
-    private final IWebView.Callback delegate;
-
-    public SessionCallbackProxy(Session session, IWebView.Callback delegate) {
-        this.session = session;
-        this.delegate = delegate;
-    }
-
-    @Override
-    public void onPageStarted(String url) {
-        session.setLoading(true);
-        session.setSecure(false);
-
-        // We are always setting the progress to 5% when a new page starts loading. Otherwise it might
-        // look like the browser is doing nothing (on a slow network) until we receive a progress
-        // from the WebView.
-        session.setProgress(MINIMUM_PROGRESS);
-
-        session.setUrl(url);
-    }
-
-    @Override
-    public void onPageFinished(boolean isSecure) {
-        session.setLoading(false);
-        session.setSecure(isSecure);
-    }
-
-    @Override
-    public void onSecurityChanged(boolean isSecure, String host, String organization) {
-        session.setSecure(isSecure);
-        session.setSecurityOrigin(host);
-        session.setSecurityVerifier(organization);
-    }
-
-    @Override
-    public void onProgress(int progress) {
-        // We do not want the progress to go backwards - so we always set it to at least the minimum.
-        progress = Math.max(MINIMUM_PROGRESS, progress);
-
-        // We do not want to show to show a progress that 100% because this will make the progress
-        // bar disappear.
-        progress = Math.min(99, progress);
-
-        session.setProgress(progress);
-    }
-
-    @Override
-    public void onURLChanged(String url) {
-        session.setUrl(url);
-    }
-
-    @Override
-    public void onTitleChanged(String title) {
-        session.setPageTitle(title);
-    }
-
-    @Override
-    public void onRequest(boolean isTriggeredByUserGesture) {
-        if (isTriggeredByUserGesture && session.isSearch()) {
-            // The user actively navigated away (no redirect) from the search page. Clear the
-            // search terms.
-            session.clearSearchTerms();
-        }
-    }
-
-    @Override
-    public void countBlockedTracker() {
-        //noinspection ConstantConditions - The value is never null
-        session.setTrackersBlocked(session.getBlockedTrackers().getValue() + 1);
-    }
-
-    @Override
-    public void resetBlockedTrackers() {
-        session.setTrackersBlocked(0);
-    }
-
-    @Override
-    public void onBlockingStateChanged(boolean isBlockingEnabled) {
-        session.setBlockingEnabled(isBlockingEnabled);
-    }
-
-    @Override
-    public void onHttpAuthRequest(@NonNull IWebView.HttpAuthCallback callback, String host, String realm) {
-        delegate.onHttpAuthRequest(callback, host, realm);
-    }
-
-    @Override
-    public void onRequestDesktopStateChanged(boolean shouldRequestDesktop) {
-        session.setRequestDesktopSite(shouldRequestDesktop);
-    }
-
-    @Override
-    public void onDownloadStart(Download download) {
-        // TODO: Replace with session property
-        delegate.onDownloadStart(download);
-    }
-
-    @Override
-    public void onLongPress(IWebView.HitTarget hitTarget) {
-        // TODO: Replace with session property
-        delegate.onLongPress(hitTarget);
-    }
-
-    @Override
-    public void onEnterFullScreen(@NonNull IWebView.FullscreenCallback callback, @Nullable View view) {
-        // TODO: Replace with session property
-        delegate.onEnterFullScreen(callback, view);
-    }
-
-    @Override
-    public void onExitFullScreen() {
-        // TODO: Replace with session property
-        delegate.onExitFullScreen();
-    }
-
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.kt
new file mode 100644
index 000000000000..e20e7b3ce2bd
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.kt
@@ -0,0 +1,118 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session
+
+import android.view.View
+
+import org.mozilla.focus.web.Download
+import org.mozilla.focus.web.IWebView
+
+import mozilla.components.browser.session.Session
+import org.mozilla.focus.ext.isSearch
+import org.mozilla.focus.ext.shouldRequestDesktopSite
+
+@Suppress("TooManyFunctions")
+class SessionCallbackProxy(private val session: Session, private val delegate: IWebView.Callback) : IWebView.Callback {
+
+    override fun onPageStarted(url: String) {
+        session.loading = true
+        session.securityInfo = Session.SecurityInfo(false)
+
+        // We are always setting the progress to 5% when a new page starts loading. Otherwise it might
+        // look like the browser is doing nothing (on a slow network) until we receive a progress
+        // from the WebView.
+        session.progress = MINIMUM_PROGRESS
+
+        session.url = url
+    }
+
+    override fun onPageFinished(isSecure: Boolean) {
+        session.loading = false
+        session.securityInfo = Session.SecurityInfo(isSecure)
+    }
+
+    override fun onSecurityChanged(isSecure: Boolean, host: String?, organization: String?) {
+        if (isSecure) {
+            session.securityInfo = Session.SecurityInfo(isSecure, host ?: "", organization ?: "")
+        } else {
+            session.securityInfo = Session.SecurityInfo(false)
+        }
+    }
+
+    override fun onProgress(progress: Int) {
+        var actualProgress = progress
+        // We do not want the progress to go backwards - so we always set it to at least the minimum.
+        actualProgress = Math.max(MINIMUM_PROGRESS, actualProgress)
+
+        // We do not want to show to show a progress that 100% because this will make the progress
+        // bar disappear.
+        actualProgress = Math.min(MAXIMUM_PROGRESS, actualProgress)
+
+        session.progress = actualProgress
+    }
+
+    override fun onURLChanged(url: String) {
+        session.url = url
+    }
+
+    override fun onTitleChanged(title: String) {
+        session.title = title
+    }
+
+    override fun onRequest(isTriggeredByUserGesture: Boolean) {
+        if (isTriggeredByUserGesture && session.isSearch) {
+            // The user actively navigated away (no redirect) from the search page. Clear the
+            // search terms.
+            session.searchTerms = ""
+        }
+    }
+
+    override fun countBlockedTracker() {
+        // The browser-engine component will fill "trackersBlocked" with blocked URLs. Until we use
+        // this component we just add a random string because we only display the count currently.
+        session.trackersBlocked = session.trackersBlocked + listOf("-")
+    }
+
+    override fun resetBlockedTrackers() {
+        session.trackersBlocked = emptyList()
+    }
+
+    override fun onBlockingStateChanged(isBlockingEnabled: Boolean) {
+        session.trackerBlockingEnabled = isBlockingEnabled
+    }
+
+    override fun onHttpAuthRequest(callback: IWebView.HttpAuthCallback, host: String, realm: String) {
+        delegate.onHttpAuthRequest(callback, host, realm)
+    }
+
+    override fun onRequestDesktopStateChanged(shouldRequestDesktop: Boolean) {
+        session.shouldRequestDesktopSite = shouldRequestDesktop
+    }
+
+    override fun onDownloadStart(download: Download) {
+        // To be replaced with session property
+        delegate.onDownloadStart(download)
+    }
+
+    override fun onLongPress(hitTarget: IWebView.HitTarget) {
+        // To be replaced with session property
+        delegate.onLongPress(hitTarget)
+    }
+
+    override fun onEnterFullScreen(callback: IWebView.FullscreenCallback, view: View?) {
+        // To be replaced with session property
+        delegate.onEnterFullScreen(callback, view)
+    }
+
+    override fun onExitFullScreen() {
+        // To be replaced with session property
+        delegate.onExitFullScreen()
+    }
+
+    companion object {
+        internal const val MINIMUM_PROGRESS = 5
+        internal const val MAXIMUM_PROGRESS = 99
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java
deleted file mode 100644
index dea58f4c8ba2..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java
+++ /dev/null
@@ -1,398 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.content.Context;
-import android.content.Intent;
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.annotation.VisibleForTesting;
-import android.text.TextUtils;
-
-import org.mozilla.focus.architecture.NonNullLiveData;
-import org.mozilla.focus.architecture.NonNullMutableLiveData;
-import org.mozilla.focus.customtabs.CustomTabConfig;
-import org.mozilla.focus.shortcut.HomeScreen;
-import org.mozilla.focus.utils.AppConstants;
-import org.mozilla.focus.utils.Settings;
-import org.mozilla.focus.utils.UrlUtils;
-import org.mozilla.focus.web.GeckoWebViewProvider;
-import org.mozilla.geckoview.GeckoSession;
-
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.List;
-
-import mozilla.components.support.utils.SafeIntent;
-import mozilla.components.support.utils.WebURLFinder;
-
-
-/**
- * Sessions are managed by this global SessionManager instance.
- */
-public class SessionManager {
-    private static final SessionManager INSTANCE = new SessionManager();
-
-    private final NonNullMutableLiveData<List<Session>> sessions;
-    private String currentSessionUUID;
-    private final NonNullMutableLiveData<List<Session>> customTabSessions;
-
-    public static SessionManager getInstance() {
-        return INSTANCE;
-    }
-
-    private SessionManager() {
-        this.sessions = new NonNullMutableLiveData<>(
-                Collections.unmodifiableList(Collections.<Session>emptyList()));
-        this.customTabSessions = new NonNullMutableLiveData<>(
-                Collections.unmodifiableList(Collections.<Session>emptyList()));
-    }
-
-    /**
-     * Handle this incoming intent (via onCreate()) and create a new session if required.
-     */
-    public void handleIntent(final Context context, final SafeIntent intent, final Bundle savedInstanceState) {
-        if ((intent.getFlags() & Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) != 0) {
-            // This Intent was launched from history (recent apps). Android will redeliver the
-            // original Intent (which might be a VIEW intent). However if there's no active browsing
-            // session then we do not want to re-process the Intent and potentially re-open a website
-            // from a session that the user already "erased".
-            return;
-        }
-
-        if (savedInstanceState != null) {
-            // We are restoring a previous session - No need to handle this Intent.
-            return;
-        }
-
-        createSessionFromIntent(context, intent);
-    }
-
-    /**
-     * Handle this incoming intent (via onNewIntent()) and create a new session if required.
-     */
-    public void handleNewIntent(final Context context, final SafeIntent intent) {
-        createSessionFromIntent(context, intent);
-    }
-
-    private void createSessionFromIntent(Context context, SafeIntent intent) {
-        final String action = intent.getAction();
-
-        if (Intent.ACTION_VIEW.equals(action)) {
-            final String dataString = intent.getDataString();
-            if (TextUtils.isEmpty(dataString)) {
-                return; // If there's no URL in the Intent then we can't create a session.
-            }
-
-            if (intent.hasExtra(HomeScreen.ADD_TO_HOMESCREEN_TAG)) {
-                final boolean blockingEnabled = intent.getBooleanExtra(HomeScreen.BLOCKING_ENABLED, true);
-                final boolean requestDesktop = intent.getBooleanExtra(HomeScreen.REQUEST_DESKTOP, false);
-                createSession(context, Source.HOME_SCREEN, intent, intent.getDataString(), blockingEnabled, requestDesktop);
-            } else {
-                createSession(context, Source.VIEW, intent, intent.getDataString());
-            }
-        } else if (Intent.ACTION_SEND.equals(action)) {
-            final String dataString = intent.getStringExtra(Intent.EXTRA_TEXT);
-            if (TextUtils.isEmpty(dataString)) {
-                return;
-            }
-
-            final boolean isURL = UrlUtils.isUrl(dataString);
-
-            if (!isURL) {
-                final String bestURL = new WebURLFinder(dataString).bestWebURL();
-                if (!TextUtils.isEmpty(bestURL)) {
-                    createSession(Source.SHARE, bestURL);
-                } else {
-                    createSearchSession(Source.SHARE, UrlUtils.createSearchUrl(context, dataString), dataString);
-                }
-            } else {
-                createSession(Source.SHARE, dataString);
-            }
-        }
-    }
-
-    /**
-     * Is there at least one regular browsing session?
-     */
-    public boolean hasSession() {
-        return !sessions.getValue().isEmpty();
-    }
-
-    /**
-     * Get the current session. This method will throw an exception if there's no active session.
-     */
-    public Session getCurrentSession() {
-        if (currentSessionUUID == null) {
-            throw new IllegalAccessError("There's no active session");
-        }
-
-        return getSessionByUUID(currentSessionUUID);
-    }
-
-    @Nullable
-    public Session getCustomTabSessionByCustomTabId(String customTabId) {
-        final List<Session> sessions = customTabSessions.getValue();
-
-        for (Session session : sessions) {
-            if (session.getCustomTabConfig().id.equals(customTabId)) {
-                return session;
-            }
-        }
-
-        return null;
-    }
-
-    @NonNull
-    public Session getCustomTabSessionByCustomTabIdOrThrow(String customTabId) {
-        final Session session = getCustomTabSessionByCustomTabId(customTabId);
-
-        if (session == null) {
-            throw new IllegalAccessError("There's no active custom tab session with id " + customTabId);
-        }
-
-        return session;
-    }
-
-    /**
-     * This method will turn a custom tab session into a regular session that will show up in the
-     * browser.
-     */
-    public void moveCustomTabToRegularSessions(Session session) {
-        // First we remove the custom tab configuration. This data is not needed anymore and its
-        // existence is an indicator that this is a custom tab and should be displayed as such.
-        session.stripCustomTabConfiguration();
-
-        // We remove the source from the session because from now on we do not treat it as
-        // Source.CUSTOM_TAB anymore.
-        session.clearSource();
-
-        // Remove session from custom tabs list, add it to the list of regular sessions and select
-        // it (-> foreground tab).
-        removeCustomTabSession(session.getUUID());
-        addSession(session);
-    }
-
-    public boolean isCurrentSession(@NonNull Session session) {
-        return session.getUUID().equals(currentSessionUUID);
-    }
-
-    public boolean hasSessionWithUUID(@NonNull String uuid) {
-        for (Session session : sessions.getValue()) {
-            if (uuid.equals(session.getUUID())) {
-                return true;
-            }
-        }
-
-        for (Session session : customTabSessions.getValue()) {
-            if (uuid.equals(session.getUUID())) {
-                return true;
-            }
-        }
-
-        return false;
-    }
-
-    public Session getSessionByUUID(@NonNull String uuid) {
-        for (Session session : sessions.getValue()) {
-            if (uuid.equals(session.getUUID())) {
-                return session;
-            }
-        }
-
-        for (Session session : customTabSessions.getValue()) {
-            if (uuid.equals(session.getUUID())) {
-                return session;
-            }
-        }
-
-        throw new IllegalAccessError("There's no active session with UUID " + uuid);
-    }
-
-    public int getNumberOfSessions() {
-        return sessions.getValue().size();
-    }
-
-    public int getPositionOfCurrentSession() {
-        if (currentSessionUUID == null) {
-            return -1;
-        }
-
-        for (int i = 0; i < this.sessions.getValue().size(); i++) {
-            final Session session = this.sessions.getValue().get(i);
-
-            if (session.getUUID().equals(currentSessionUUID)) {
-                return i;
-            }
-        }
-
-        return -1;
-    }
-
-    public NonNullLiveData<List<Session>> getSessions() {
-        return sessions;
-    }
-
-    public NonNullLiveData<List<Session>> getCustomTabSessions() {
-        return customTabSessions;
-    }
-
-    public Session createNewTabSession(@NonNull Source source, @NonNull String url, Context context) {
-        final Session session = new Session(source, url);
-        addNewTabSession(session, context);
-        return session;
-    }
-
-    public void createSession(@NonNull Source source, @NonNull String url) {
-        final Session session = new Session(source, url);
-        addSession(session);
-    }
-
-    public void createSearchSession(@NonNull Source source, @NonNull String url, String searchTerms) {
-        final Session session = new Session(source, url);
-        session.setSearchTerms(searchTerms);
-        addSession(session);
-    }
-
-    private void createSession(Context context, Source source, SafeIntent intent, String url) {
-        final Session session = CustomTabConfig.isCustomTabIntent(intent)
-                ? new Session(url, CustomTabConfig.parseCustomTabIntent(context, intent))
-                : new Session(source, url);
-        addSession(session);
-    }
-
-    private void createSession(Context context, Source source, SafeIntent intent, String url, boolean blockingEnabled, boolean requestDesktop) {
-        final Session session = CustomTabConfig.isCustomTabIntent(intent)
-                ? new Session(url, CustomTabConfig.parseCustomTabIntent(context, intent))
-                : new Session(source, url);
-        session.setBlockingEnabled(blockingEnabled);
-        session.setRequestDesktopSite(requestDesktop);
-        addSession(session);
-    }
-
-    private void addSession(Session session) {
-        if (session.isCustomTab()) {
-            final List<Session> sessions = new ArrayList<>(this.customTabSessions.getValue());
-            sessions.add(session);
-
-            customTabSessions.setValue(sessions);
-        } else {
-            currentSessionUUID = session.getUUID();
-
-            final List<Session> sessions = new ArrayList<>(this.sessions.getValue());
-            sessions.add(session);
-
-            this.sessions.setValue(Collections.unmodifiableList(sessions));
-        }
-    }
-
-    private void addNewTabSession(final Session session, Context context) {
-        if (currentSessionUUID == null || Settings.getInstance(context).shouldOpenNewTabs()) {
-            currentSessionUUID = session.getUUID();
-        }
-
-        final List<Session> sessions = new ArrayList<>(this.sessions.getValue());
-        sessions.add(session);
-        this.sessions.setValue(Collections.unmodifiableList(sessions));
-    }
-
-    public void selectSession(Session session) {
-        if (session.getUUID().equals(currentSessionUUID)) {
-            // This is already the selected session.
-            return;
-        }
-
-        currentSessionUUID = session.getUUID();
-
-        this.sessions.setValue(this.sessions.getValue());
-    }
-
-    /**
-     * Remove all sessions.
-     */
-    public void removeAllSessions() {
-        closeGeckoSessions(this.sessions.getValue());
-        currentSessionUUID = null;
-
-        sessions.setValue(Collections.unmodifiableList(Collections.<Session>emptyList()));
-    }
-
-    @VisibleForTesting void removeAllCustomTabSessions() {
-        closeGeckoSessions(this.customTabSessions.getValue());
-        customTabSessions.setValue(Collections.unmodifiableList(Collections.<Session>emptyList()));
-    }
-
-    /**
-     * Remove the current (selected) session.
-     */
-    public void removeCurrentSession() {
-        removeRegularSession(currentSessionUUID);
-    }
-
-    public void removeRegularSession(String uuid) {
-        final List<Session> sessions = new ArrayList<>();
-
-        int removedFromPosition = -1;
-
-        for (int i = 0; i < this.sessions.getValue().size(); i++) {
-            final Session currentSession = this.sessions.getValue().get(i);
-
-            if (currentSession.getUUID().equals(uuid)) {
-                removedFromPosition = i;
-                closeGeckoSessions(new ArrayList<>(Collections.singletonList(currentSession)));
-                continue;
-            }
-
-            sessions.add(currentSession);
-        }
-
-        if (removedFromPosition == -1) {
-            return;
-        }
-
-        if (sessions.isEmpty()) {
-            currentSessionUUID = null;
-        } else {
-            final Session currentSession = sessions.get(
-                    Math.min(removedFromPosition, sessions.size() - 1));
-            currentSessionUUID = currentSession.getUUID();
-        }
-
-        this.sessions.setValue(sessions);
-    }
-
-    public void removeCustomTabSession(String uuid) {
-        final List<Session> sessions = new ArrayList<>();
-
-        for (int i = 0; i < this.customTabSessions.getValue().size(); i++) {
-            final Session currentSession = this.customTabSessions.getValue().get(i);
-
-            if (currentSession.getUUID().equals(uuid)) {
-                closeGeckoSessions(new ArrayList<>(Collections.singletonList(currentSession)));
-                continue;
-            }
-
-            sessions.add(currentSession);
-        }
-
-        this.customTabSessions.setValue(sessions);
-    }
-
-    private void closeGeckoSessions(List<Session> sessions) {
-        if (AppConstants.INSTANCE.isGeckoBuild()) {
-            for (int i = 0; i < sessions.size(); i++) {
-                final Session session = sessions.get(i);
-                if (session != null && session.hasWebViewState()) {
-                    final Bundle webViewState = session.getWebViewState();
-                    final GeckoSession geckoSession = webViewState.getParcelable(GeckoWebViewProvider.GECKO_SESSION);
-                    if (geckoSession != null && geckoSession.isOpen()) {
-                        geckoSession.close();
-                    }
-                }
-            }
-        }
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.kt
index 2015bc224213..4026e558ec08 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.kt
@@ -18,6 +18,7 @@ import android.support.v4.content.ContextCompat
 
 import org.mozilla.focus.R
 import org.mozilla.focus.activity.MainActivity
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.telemetry.TelemetryWrapper
 
 /**
@@ -36,7 +37,7 @@ class SessionNotificationService : Service() {
             ACTION_ERASE -> {
                 TelemetryWrapper.eraseNotificationEvent()
 
-                SessionManager.getInstance().removeAllSessions()
+                components.sessionManager.removeSessions()
 
                 VisibilityLifeCycleCallback.finishAndRemoveTaskIfInBackground(this)
             }
@@ -50,7 +51,7 @@ class SessionNotificationService : Service() {
     override fun onTaskRemoved(rootIntent: Intent) {
         TelemetryWrapper.eraseTaskRemoved()
 
-        SessionManager.getInstance().removeAllSessions()
+        components.sessionManager.removeSessions()
 
         stopForeground(true)
         stopSelf()
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java b/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java
deleted file mode 100644
index 80c726f0e2de..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java
+++ /dev/null
@@ -1,51 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-/**
- * The source of a sessio: How was this session created? E.g. did we receive an Intent or did the
- * user start this session?
- */
-public enum Source {
-    /**
-     * Intent.ACTION_VIEW
-     */
-    VIEW,
-
-    /**
-     * Intent.ACTION_SEND
-     */
-    SHARE,
-
-    /**
-     * Via text selection action ("Search privately")
-     */
-    TEXT_SELECTION,
-
-    /**
-     * Via a home screen shortcut.
-     */
-    HOME_SCREEN,
-
-    /**
-     * The user entered a URL (or search ter,s)
-     */
-    USER_ENTERED,
-
-    /**
-     * Custom tab from a third-party application.
-     */
-    CUSTOM_TAB,
-
-    /**
-     * Open as a new tab from the (context( menu.
-     */
-    MENU,
-
-    /**
-     * Only used internally if we need to temporarily create a session object with no specific source.
-     */
-    NONE
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/EraseViewHolder.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/EraseViewHolder.kt
index 8b8d76d6ce3f..074e98213da9 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/EraseViewHolder.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/EraseViewHolder.kt
@@ -11,14 +11,15 @@ import android.support.v7.widget.RecyclerView
 import android.view.View
 import android.widget.TextView
 import org.mozilla.focus.R
-import org.mozilla.focus.session.SessionManager
+import org.mozilla.focus.ext.requireComponents
 import org.mozilla.focus.telemetry.TelemetryWrapper
 
-class EraseViewHolder(private val fragment: SessionsSheetFragment, itemView: View) : RecyclerView.ViewHolder(itemView),
-    View.OnClickListener {
+class EraseViewHolder(
+    private val fragment: SessionsSheetFragment,
+    itemView: View
+) : RecyclerView.ViewHolder(itemView), View.OnClickListener {
 
     init {
-
         val textView = itemView as TextView
         val leftDrawable = AppCompatResources.getDrawable(itemView.getContext(), R.drawable.ic_delete)
         textView.setCompoundDrawablesWithIntrinsicBounds(leftDrawable, null, null, null)
@@ -30,7 +31,7 @@ class EraseViewHolder(private val fragment: SessionsSheetFragment, itemView: Vie
 
         fragment.animateAndDismiss().addListener(object : AnimatorListenerAdapter() {
             override fun onAnimationEnd(animation: Animator) {
-                SessionManager.getInstance().removeAllSessions()
+                fragment.requireComponents.sessionManager.removeSessions()
             }
         })
     }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionViewHolder.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionViewHolder.kt
index 717838348504..e252a977fac6 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionViewHolder.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionViewHolder.kt
@@ -7,14 +7,13 @@ package org.mozilla.focus.session.ui
 import android.animation.Animator
 import android.animation.AnimatorListenerAdapter
 import android.support.v7.widget.RecyclerView
-import android.text.TextUtils
 import android.view.View
 import android.widget.TextView
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R
-import org.mozilla.focus.session.Session
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.ext.beautifyUrl
+import org.mozilla.focus.ext.requireComponents
+import org.mozilla.focus.telemetry.TelemetryWrapper
 import java.lang.ref.WeakReference
 
 class SessionViewHolder internal constructor(
@@ -38,7 +37,7 @@ class SessionViewHolder internal constructor(
 
         updateTitle(session)
 
-        val isCurrentSession = SessionManager.getInstance().isCurrentSession(session)
+        val isCurrentSession = fragment.requireComponents.sessionManager.selectedSession == session
 
         updateTextBackgroundColor(isCurrentSession)
     }
@@ -54,8 +53,8 @@ class SessionViewHolder internal constructor(
 
     private fun updateTitle(session: Session) {
         textView.text =
-                if (TextUtils.isEmpty(session.pageTitle.value)) session.url.value.beautifyUrl()
-                else session.pageTitle.value
+            if (session.title.isEmpty()) session.url.beautifyUrl()
+            else session.title
     }
 
     override fun onClick(view: View) {
@@ -66,7 +65,7 @@ class SessionViewHolder internal constructor(
     private fun selectSession(session: Session) {
         fragment.animateAndDismiss().addListener(object : AnimatorListenerAdapter() {
             override fun onAnimationEnd(animation: Animator) {
-                SessionManager.getInstance().selectSession(session)
+                fragment.requireComponents.sessionManager.select(session)
 
                 TelemetryWrapper.switchTabInTabsTrayEvent()
             }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsAdapter.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsAdapter.kt
index 47bcafe03aae..31b42608d00f 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsAdapter.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsAdapter.kt
@@ -4,21 +4,20 @@
 
 package org.mozilla.focus.session.ui
 
-import android.arch.lifecycle.Observer
 import android.support.v7.widget.RecyclerView
 import android.view.LayoutInflater
 import android.view.ViewGroup
 import android.widget.TextView
-
-import org.mozilla.focus.session.Session
-
-import java.util.ArrayList
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+import org.mozilla.focus.ext.requireComponents
 
 /**
  * Adapter implementation to show a list of active browsing sessions and an "erase" button at the end.
  */
-class SessionsAdapter/* package */ internal constructor(private val fragment: SessionsSheetFragment) :
-    RecyclerView.Adapter<RecyclerView.ViewHolder>(), Observer<List<Session>> {
+class SessionsAdapter internal constructor(
+    private val fragment: SessionsSheetFragment
+) : RecyclerView.Adapter<RecyclerView.ViewHolder>(), SessionManager.Observer {
     private var sessions: List<Session>? = null
 
     init {
@@ -65,8 +64,24 @@ class SessionsAdapter/* package */ internal constructor(private val fragment: Se
         return sessions!!.size + 1
     }
 
-    override fun onChanged(sessions: List<Session>?) {
-        this.sessions = ArrayList(sessions!!)
+    override fun onSessionAdded(session: Session) {
+        onUpdate(fragment.requireComponents.sessionManager.sessions)
+    }
+
+    override fun onSessionRemoved(session: Session) {
+        onUpdate(fragment.requireComponents.sessionManager.sessions)
+    }
+
+    override fun onSessionSelected(session: Session) {
+        onUpdate(fragment.requireComponents.sessionManager.sessions)
+    }
+
+    override fun onAllSessionsRemoved() {
+        onUpdate(fragment.requireComponents.sessionManager.sessions)
+    }
+
+    private fun onUpdate(sessions: List<Session>) {
+        this.sessions = sessions
         notifyDataSetChanged()
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsSheetFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsSheetFragment.kt
index c21381d8c5e5..18a2649d1192 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsSheetFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/ui/SessionsSheetFragment.kt
@@ -17,8 +17,8 @@ import android.view.animation.AccelerateInterpolator
 
 import org.mozilla.focus.R
 import org.mozilla.focus.activity.MainActivity
+import org.mozilla.focus.ext.requireComponents
 import org.mozilla.focus.locale.LocaleAwareFragment
-import org.mozilla.focus.session.SessionManager
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.OneShotOnPreDrawListener
 
@@ -42,7 +42,8 @@ class SessionsSheetFragment : LocaleAwareFragment(), View.OnClickListener {
         })
 
         val sessionsAdapter = SessionsAdapter(this)
-        SessionManager.getInstance().sessions.observe(this, sessionsAdapter)
+
+        requireComponents.sessionManager.register(sessionsAdapter, owner = this)
 
         view.findViewById<RecyclerView>(R.id.sessions).let {
             it.layoutManager = LinearLayoutManager(context, LinearLayoutManager.VERTICAL, false)
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/settings/LearnMoreSwitchPreference.kt b/focus-android/app/src/main/java/org/mozilla/focus/settings/LearnMoreSwitchPreference.kt
index 575b36dce4c7..0fc19a1c797b 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/settings/LearnMoreSwitchPreference.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/settings/LearnMoreSwitchPreference.kt
@@ -1,17 +1,18 @@
 package org.mozilla.focus.settings
 
+import android.app.Activity
 import android.content.Context
 import android.graphics.Paint
 import android.support.v4.content.ContextCompat
 import android.support.v7.preference.PreferenceViewHolder
 import android.support.v7.preference.SwitchPreferenceCompat
 import android.util.AttributeSet
+import android.view.ContextThemeWrapper
 import android.view.View
 import android.widget.TextView
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
-import org.mozilla.focus.utils.asActivity
+import org.mozilla.focus.ext.components
 
 abstract class LearnMoreSwitchPreference(context: Context?, attrs: AttributeSet?) :
     SwitchPreferenceCompat(context, attrs) {
@@ -35,8 +36,15 @@ abstract class LearnMoreSwitchPreference(context: Context?, attrs: AttributeSet?
         learnMoreLink.setOnClickListener {
             // This is a hardcoded link: if we ever end up needing more of these links, we should
             // move the link into an xml parameter, but there's no advantage to making it configurable now.
-            SessionManager.getInstance().createSession(Source.MENU, getLearnMoreUrl())
-            context?.asActivity()?.finish()
+            val session = Session(getLearnMoreUrl(), source = Session.Source.MENU)
+            context.components.sessionManager.add(session, selected = true)
+            if (context is ContextThemeWrapper) {
+                if ((context as ContextThemeWrapper).baseContext is Activity) {
+                    ((context as ContextThemeWrapper).baseContext as Activity).finish()
+                }
+            } else {
+                (context as? Activity)?.finish()
+            }
         }
 
         val backgroundDrawableArray =
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/settings/MozillaSettingsFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/settings/MozillaSettingsFragment.kt
index 0f58a3e7c689..503e2b08c3df 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/settings/MozillaSettingsFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/settings/MozillaSettingsFragment.kt
@@ -6,26 +6,19 @@ package org.mozilla.focus.settings
 
 import android.content.SharedPreferences
 import android.os.Bundle
-import android.support.v14.preference.SwitchPreference
 import android.support.v7.preference.Preference
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R
-import org.mozilla.focus.activity.InfoActivity
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
+import org.mozilla.focus.browser.LocalizedContent
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.AppConstants
 import org.mozilla.focus.utils.SupportUtils
-import org.mozilla.focus.utils.app
-import org.mozilla.focus.utils.homeScreenTipsExperimentDescriptor
-import org.mozilla.focus.utils.isInExperiment
 
 class MozillaSettingsFragment : BaseSettingsFragment(),
-        SharedPreferences.OnSharedPreferenceChangeListener {
+    SharedPreferences.OnSharedPreferenceChangeListener {
     override fun onCreatePreferences(p0: Bundle?, p1: String?) {
         addPreferencesFromResource(R.xml.mozilla_settings)
-        val homeScreenTipsPref: SwitchPreference? = preferenceManager
-            .findPreference(getString(R.string.pref_key_homescreen_tips)) as SwitchPreference?
-        homeScreenTipsPref?.isChecked = activity!!.isInExperiment(homeScreenTipsExperimentDescriptor)
     }
 
     override fun onResume() {
@@ -48,25 +41,33 @@ class MozillaSettingsFragment : BaseSettingsFragment(),
         // AppCompatActivity has a Toolbar that is used as the ActionBar, and it conflicts with the ActionBar
         // used by PreferenceScreen to create the headers (with title, back navigation), so we wrap all these
         // "preference screens" into separate activities.
+        val activity = activity ?: return super.onPreferenceTreeClick(preference)
+
         when (preference.key) {
             resources.getString(R.string.pref_key_about) -> run {
-                val intent = InfoActivity.getAboutIntent(context!!)
-                startActivity(intent)
+                val session = Session(LocalizedContent.URL_ABOUT, source = Session.Source.MENU)
+                activity.components.sessionManager.add(session)
+                activity.finish()
             }
             resources.getString(R.string.pref_key_help) -> run {
-                SessionManager.getInstance().createSession(Source.MENU, SupportUtils.HELP_URL)
-                activity!!.finish()
+                val session = Session(SupportUtils.HELP_URL, source = Session.Source.MENU)
+                activity.components.sessionManager.add(session)
+                activity.finish()
             }
             resources.getString(R.string.pref_key_rights) -> run {
-                val intent = InfoActivity.getRightsIntent(context!!)
-                startActivity(intent)
+                val session = Session(LocalizedContent.URL_RIGHTS, source = Session.Source.MENU)
+                activity.components.sessionManager.add(session)
+                activity.finish()
             }
             resources.getString(R.string.pref_key_privacy_notice) -> {
-                SessionManager.getInstance().createSession(Source.MENU, if (AppConstants.isKlarBuild)
+                val url = if (AppConstants.isKlarBuild)
                     SupportUtils.PRIVACY_NOTICE_KLAR_URL
                 else
-                    SupportUtils.PRIVACY_NOTICE_URL)
-                activity!!.finish()
+                    SupportUtils.PRIVACY_NOTICE_URL
+
+                val session = Session(url, source = Session.Source.MENU)
+                activity.components.sessionManager.add(session)
+                activity.finish()
             }
         }
         return super.onPreferenceTreeClick(preference)
@@ -74,20 +75,9 @@ class MozillaSettingsFragment : BaseSettingsFragment(),
 
     override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences, key: String) {
         TelemetryWrapper.settingsEvent(key, sharedPreferences.all[key].toString())
-        when (key) {
-            getString(R.string.pref_key_homescreen_tips) -> {
-                activity!!.app.fretboard.setOverride(
-                    activity!!.app, homeScreenTipsExperimentDescriptor,
-                    sharedPreferences.getBoolean(key, false)
-                )
-            }
-        }
     }
 
     companion object {
-
-        fun newInstance(): MozillaSettingsFragment {
-            return MozillaSettingsFragment()
-        }
+        fun newInstance(): MozillaSettingsFragment = MozillaSettingsFragment()
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java
deleted file mode 100644
index 2c66082779ca..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java
+++ /dev/null
@@ -1,66 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.telemetry;
-
-import android.support.annotation.NonNull;
-
-import org.mozilla.focus.architecture.NonNullObserver;
-import org.mozilla.focus.session.Session;
-import org.mozilla.focus.session.Source;
-
-import java.util.List;
-
-public class TelemetrySessionObserver extends NonNullObserver<List<Session>> {
-    @Override
-    protected void onValueChanged(@NonNull List<Session> sessions) {
-        for (final Session session : sessions) {
-            if (!session.isRecorded()) {
-                addTelemetryEvent(session);
-
-                session.markAsRecorded();
-            }
-        }
-    }
-
-    private void addTelemetryEvent(final Session session) {
-        final Source source = session.getSource();
-
-        switch (source) {
-            case VIEW:
-                TelemetryWrapper.browseIntentEvent();
-                break;
-
-            case SHARE:
-                TelemetryWrapper.shareIntentEvent(session.isSearch());
-                break;
-
-            case TEXT_SELECTION:
-                TelemetryWrapper.textSelectionIntentEvent();
-                break;
-
-            case HOME_SCREEN:
-                TelemetryWrapper.openHomescreenShortcutEvent();
-                break;
-
-            case CUSTOM_TAB:
-                TelemetryWrapper.customTabsIntentEvent(session.getCustomTabConfig().getOptionsList());
-                break;
-
-            case USER_ENTERED:
-            case MENU:
-                // We report those events from the UI level - The events depends on how the user
-                // interacted with the UI.
-                break;
-
-            case NONE:
-                // NONE is a workaround for testing and sessions that used to have another source
-                // that we needed to remove. We do not want to report telemetry for those here.
-                break;
-
-            default:
-                throw new IllegalStateException("Unknown session source: " + source);
-        }
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.kt b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.kt
new file mode 100644
index 000000000000..18e224cbf5fe
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.kt
@@ -0,0 +1,23 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.telemetry
+
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+
+class TelemetrySessionObserver : SessionManager.Observer {
+    override fun onSessionAdded(session: Session) {
+        when (session.source) {
+            Session.Source.ACTION_VIEW -> TelemetryWrapper.browseIntentEvent()
+            Session.Source.ACTION_SEND -> TelemetryWrapper.shareIntentEvent(session.searchTerms.isNotEmpty())
+            Session.Source.TEXT_SELECTION -> TelemetryWrapper.textSelectionIntentEvent()
+            Session.Source.HOME_SCREEN -> TelemetryWrapper.openHomescreenShortcutEvent()
+            Session.Source.CUSTOM_TAB -> TelemetryWrapper.customTabsIntentEvent(session.customTabConfig!!.options)
+            else -> {
+                // For other session types we create events at the place where we create the sessions.
+            }
+        }
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySettingsProvider.kt b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySettingsProvider.kt
index a4d10841a402..cd9ebc8d6845 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySettingsProvider.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySettingsProvider.kt
@@ -5,8 +5,8 @@
 package org.mozilla.focus.telemetry
 
 import android.content.Context
-import org.mozilla.focus.Components
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.search.CustomSearchEngineStore
 import org.mozilla.focus.utils.Browsers
 import org.mozilla.focus.utils.Settings
@@ -46,7 +46,6 @@ internal class TelemetrySettingsProvider(
     }
 
     override fun getValue(key: String): Any {
-
         return when (key) {
             prefKeyDefaultBrowser -> {
                 // The default browser is not actually a setting. We determine if we are the
@@ -61,7 +60,7 @@ internal class TelemetrySettingsProvider(
                     // If the user has never selected a search engine then this value is null.
                     // However we still want to report the current search engine of the user.
                     // Therefore we inject this value at runtime.
-                    value = Components.searchEngineManager.getDefaultSearchEngine(
+                    value = context.components.searchEngineManager.getDefaultSearchEngine(
                             context,
                             Settings.getInstance(context).defaultSearchEngineName
                     ).name
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.kt b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.kt
index 9b6b5cbfd2fa..f8494dfc7866 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.kt
@@ -19,10 +19,9 @@ import kotlinx.coroutines.experimental.runBlocking
 import mozilla.components.ui.autocomplete.InlineAutocompleteEditText
 import org.json.JSONObject
 import org.mozilla.focus.BuildConfig
-import org.mozilla.focus.Components
 import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.search.CustomSearchEngineStore
-import org.mozilla.focus.session.SessionManager
 import org.mozilla.focus.utils.AppConstants
 import org.mozilla.focus.utils.Settings
 import org.mozilla.focus.utils.UrlUtils
@@ -286,10 +285,16 @@ object TelemetryWrapper {
      */
     @CheckResult
     private fun withSessionCounts(event: TelemetryEvent): TelemetryEvent {
-        val sessionManager = SessionManager.getInstance()
+        val context = TelemetryHolder.get().configuration.context
 
-        event.extra(Extra.SELECTED, sessionManager.positionOfCurrentSession.toString())
-        event.extra(Extra.TOTAL, sessionManager.numberOfSessions.toString())
+        val sessionManager = context.components.sessionManager
+        val sessions = sessionManager.sessions
+        val selectedSession = sessionManager.selectedSession
+
+        val positionOfSelectedSession = sessions.indexOf(selectedSession)
+
+        event.extra(Extra.SELECTED, positionOfSelectedSession.toString())
+        event.extra(Extra.TOTAL, sessions.size.toString())
 
         return event
     }
@@ -480,9 +485,9 @@ object TelemetryWrapper {
     }
 
     private fun getDefaultSearchEngineIdentifierForTelemetry(context: Context): String {
-        val searchEngine = Components.searchEngineManager.getDefaultSearchEngine(
-                context,
-                Settings.getInstance(context).defaultSearchEngineName
+        val searchEngine = context.components.searchEngineManager.getDefaultSearchEngine(
+            context,
+            Settings.getInstance(context).defaultSearchEngineName
         ).identifier
 
         return if (CustomSearchEngineStore.isCustomSearchEngine(searchEngine, context)) {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/tips/TipManager.kt b/focus-android/app/src/main/java/org/mozilla/focus/tips/TipManager.kt
index b098524eb6d3..c49118afbe4c 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/tips/TipManager.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/tips/TipManager.kt
@@ -9,6 +9,7 @@ import android.content.Context
 import android.content.Intent
 import android.net.Uri
 import android.os.Build
+import mozilla.components.browser.session.Session
 import org.mozilla.focus.R.string.app_name
 import org.mozilla.focus.R.string.tip_add_to_homescreen
 import org.mozilla.focus.R.string.tip_autocomplete_url
@@ -17,9 +18,8 @@ import org.mozilla.focus.R.string.tip_disable_tracking_protection
 import org.mozilla.focus.R.string.tip_open_in_new_tab
 import org.mozilla.focus.R.string.tip_request_desktop
 import org.mozilla.focus.R.string.tip_set_default_browser
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.Settings
 import org.mozilla.focus.utils.SupportUtils
@@ -53,7 +53,8 @@ class Tip(val id: Int, val text: String, val shouldDisplay: () -> Boolean, val d
                     "https://support.mozilla.org/en-US/kb/add-web-page-shortcuts-your-home-screen"
 
             val deepLinkAddToHomescreen = {
-                SessionManager.getInstance().createSession(Source.MENU, homescreenURL)
+                val session = Session(homescreenURL, source = Session.Source.MENU)
+                context.components.sessionManager.add(session, selected = true)
                 TelemetryWrapper.pressTipEvent(id)
             }
 
@@ -99,7 +100,8 @@ class Tip(val id: Int, val text: String, val shouldDisplay: () -> Boolean, val d
             }
 
             val deepLinkAutocompleteUrl = {
-                SessionManager.getInstance().createSession(Source.MENU, autocompleteURL)
+                val session = Session(autocompleteURL, source = Session.Source.MENU)
+                context.components.sessionManager.add(session, selected = true)
                 TelemetryWrapper.pressTipEvent(id)
             }
 
@@ -117,7 +119,8 @@ class Tip(val id: Int, val text: String, val shouldDisplay: () -> Boolean, val d
             }
 
             val deepLinkOpenInNewTab = {
-                SessionManager.getInstance().createSession(Source.MENU, newTabURL)
+                val session = Session(newTabURL, source = Session.Source.MENU)
+                context.components.sessionManager.add(session, selected = true)
                 TelemetryWrapper.pressTipEvent(id)
             }
 
@@ -135,7 +138,8 @@ class Tip(val id: Int, val text: String, val shouldDisplay: () -> Boolean, val d
             }
 
             val deepLinkRequestDesktop = {
-                SessionManager.getInstance().createSession(Source.MENU, requestDesktopURL)
+                val session = Session(requestDesktopURL, source = Session.Source.MENU)
+                context.components.sessionManager.add(session, selected = true)
                 TelemetryWrapper.pressTipEvent(id)
             }
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/utils/SupportUtils.kt b/focus-android/app/src/main/java/org/mozilla/focus/utils/SupportUtils.kt
index 2c50a426478d..41236fd4d7c1 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/utils/SupportUtils.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/utils/SupportUtils.kt
@@ -14,9 +14,9 @@ import android.content.Intent
 import android.content.pm.PackageManager
 import android.os.Build
 import android.provider.Settings
+import mozilla.components.browser.session.Session
+import org.mozilla.focus.ext.components
 import org.mozilla.focus.locale.Locales
-import org.mozilla.focus.session.SessionManager
-import org.mozilla.focus.session.Source
 import java.io.UnsupportedEncodingException
 import java.net.URLEncoder
 import java.util.Locale
@@ -73,7 +73,8 @@ object SupportUtils {
     }
 
     fun openDefaultBrowserSumoPage(context: Context) {
-        SessionManager.getInstance().createSession(Source.MENU, SupportUtils.DEFAULT_BROWSER_URL)
+        val session = Session(SupportUtils.DEFAULT_BROWSER_URL, source = Session.Source.MENU)
+        context.components.sessionManager.add(session, selected = true)
 
         if (context is Activity) {
             context.finish()
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/utils/UrlUtils.java b/focus-android/app/src/main/java/org/mozilla/focus/utils/UrlUtils.java
index 7070e6fa11b5..5bdb01163ff6 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/utils/UrlUtils.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/utils/UrlUtils.java
@@ -11,15 +11,13 @@
 import android.support.annotation.Nullable;
 import android.text.TextUtils;
 import android.webkit.URLUtil;
-
-import org.mozilla.focus.Components;
+import mozilla.components.browser.search.SearchEngine;
+import org.mozilla.focus.browser.LocalizedContent;
+import org.mozilla.focus.ext.ContextKt;
 
 import java.net.URI;
 import java.net.URISyntaxException;
 
-import mozilla.components.browser.search.SearchEngine;
-import org.mozilla.focus.browser.LocalizedContent;
-
 public class UrlUtils {
     public static String normalize(@NonNull String input) {
         String trimmedInput = input.trim();
@@ -70,7 +68,7 @@ public static boolean isHttpOrHttps(String url) {
     public static String createSearchUrl(Context context, String searchTerm) {
         final String defaultIdentifier = Settings.getInstance(context).getDefaultSearchEngineName();
 
-        final SearchEngine searchEngine = Components.INSTANCE.getSearchEngineManager()
+        final SearchEngine searchEngine = ContextKt.getComponents(context).getSearchEngineManager()
                 .getDefaultSearchEngine(context, defaultIdentifier);
 
         return searchEngine.buildSearchUrl(searchTerm);
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java
deleted file mode 100644
index a93c8f699516..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java
+++ /dev/null
@@ -1,30 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.web;
-
-
-import android.content.Context;
-import android.support.annotation.NonNull;
-
-import org.mozilla.focus.architecture.NonNullObserver;
-import org.mozilla.focus.session.Session;
-
-import java.util.List;
-
-public class CleanupSessionObserver extends NonNullObserver<List<Session>> {
-    private final Context context;
-
-    public CleanupSessionObserver(Context context) {
-        this.context = context;
-    }
-
-    @Override
-    protected void onValueChanged(@NonNull List<Session> sessions) {
-        if (sessions.isEmpty()) {
-            // Make sure no browsing data remains on the device if there's no active session (anymore).
-            WebViewProvider.INSTANCE.performCleanup(context);
-        }
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.kt b/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.kt
new file mode 100644
index 000000000000..3280f2b18a62
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.kt
@@ -0,0 +1,25 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.web
+
+import android.content.Context
+import mozilla.components.browser.session.Session
+import mozilla.components.browser.session.SessionManager
+import org.mozilla.focus.ext.components
+
+class CleanupSessionObserver(
+    private val context: Context
+) : SessionManager.Observer {
+
+    override fun onSessionRemoved(session: Session) {
+        if (context.components.sessionManager.sessions.isEmpty()) {
+            WebViewProvider.performCleanup(context)
+        }
+    }
+
+    override fun onAllSessionsRemoved() {
+        WebViewProvider.performCleanup(context)
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/GeckoWebViewProvider.kt b/focus-android/app/src/main/java/org/mozilla/focus/web/GeckoWebViewProvider.kt
index 485abdb88969..7fa10ce6abf9 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/GeckoWebViewProvider.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/web/GeckoWebViewProvider.kt
@@ -18,12 +18,13 @@ import android.util.AttributeSet
 import android.util.Log
 import android.view.View
 import android.webkit.WebSettings
+import mozilla.components.browser.session.Session
 import org.json.JSONException
 import org.mozilla.focus.R
 import org.mozilla.focus.browser.LocalizedContent
+import org.mozilla.focus.ext.savedWebViewState
 import org.mozilla.focus.gecko.GeckoViewPrompt
 import org.mozilla.focus.gecko.NestedGeckoView
-import org.mozilla.focus.session.Session
 import org.mozilla.focus.telemetry.SentryWrapper
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.AppConstants
@@ -522,7 +523,7 @@ class GeckoWebViewProvider : IWebViewProvider {
         }
 
         override fun restoreWebViewState(session: Session) {
-            val stateData = session.webViewState
+            val stateData = session.savedWebViewState!!
             val savedSession = stateData.getParcelable<GeckoSession>(GECKO_SESSION)!!
 
             if (geckoSession != savedSession) {
@@ -568,7 +569,7 @@ class GeckoWebViewProvider : IWebViewProvider {
             sessionBundle.putBoolean(IS_SECURE, isSecure)
             sessionBundle.putString(WEBVIEW_TITLE, webViewTitle)
             sessionBundle.putString(CURRENT_URL, currentUrl)
-            session.saveWebViewState(sessionBundle)
+            session.savedWebViewState = sessionBundle
         }
 
         override fun getTitle(): String? {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java b/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
index a75521973718..5fe8d79225f5 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
@@ -9,7 +9,7 @@
 import android.support.annotation.Nullable;
 import android.view.View;
 
-import org.mozilla.focus.session.Session;
+import mozilla.components.browser.session.Session;
 
 public interface IWebView {
     class HitTarget {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/webview/SystemWebView.kt b/focus-android/app/src/main/java/org/mozilla/focus/webview/SystemWebView.kt
index 8f817ead9b79..801d7b9ef04a 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/webview/SystemWebView.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/webview/SystemWebView.kt
@@ -25,9 +25,10 @@ import android.webkit.WebChromeClient
 import android.webkit.WebStorage
 import android.webkit.WebView
 import android.webkit.WebViewDatabase
+import mozilla.components.browser.session.Session
 import mozilla.components.support.utils.ThreadUtils
 import org.mozilla.focus.BuildConfig
-import org.mozilla.focus.session.Session
+import org.mozilla.focus.ext.savedWebViewState
 import org.mozilla.focus.telemetry.TelemetryWrapper
 import org.mozilla.focus.utils.AppConstants
 import org.mozilla.focus.utils.FileUtils
@@ -110,14 +111,14 @@ class SystemWebView(context: Context, attrs: AttributeSet) : NestedWebView(conte
     }
 
     override fun restoreWebViewState(session: Session) {
-        val stateData = session.webViewState
+        val stateData = session.savedWebViewState
 
         val backForwardList = if (stateData != null)
             super.restoreState(stateData)
         else
             null
 
-        val desiredURL = session.url.value
+        val desiredURL = session.url
 
         client.restoreState(stateData)
         client.notifyCurrentURL(desiredURL)
@@ -149,7 +150,7 @@ class SystemWebView(context: Context, attrs: AttributeSet) : NestedWebView(conte
         super.saveState(stateData)
         client.saveState(this, stateData)
 
-        session.saveWebViewState(stateData)
+        session.savedWebViewState = stateData
     }
 
     override fun setBlockingEnabled(enabled: Boolean) {
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java b/focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java
deleted file mode 100644
index 3b3803b05aef..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java
+++ /dev/null
@@ -1,277 +0,0 @@
-package org.mozilla.focus.customtabs;
-
-import android.app.PendingIntent;
-import android.content.Intent;
-import android.graphics.Bitmap;
-import android.graphics.Color;
-import android.os.Bundle;
-import android.os.Parcel;
-import android.os.Parcelable;
-import android.os.StrictMode;
-import android.support.customtabs.CustomTabsIntent;
-
-import org.junit.After;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.robolectric.RobolectricTestRunner;
-import org.robolectric.RuntimeEnvironment;
-import org.robolectric.annotation.Config;
-
-import java.lang.reflect.Field;
-import java.util.UUID;
-
-import mozilla.components.support.utils.SafeIntent;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-@RunWith(RobolectricTestRunner.class)
-@Config(packageName = "org.mozilla.focus")
-public class CustomTabConfigTest {
-
-    @After
-    public void cleanup() {
-        // Reset strict mode: for every test, Robolectric will create FocusApplication again.
-        // FocusApplication expects strict mode to be disabled (since it loads some preferences from disk),
-        // before enabling it itself. If we run multiple tests, strict mode will stay enabled
-        // and FocusApplication crashes during initialisation for the second test.
-        // This applies across multiple Test classes, e.g. DisconnectTest can cause
-        // TrackingProtectionWebViewCLientTest to fail, unless it clears StrictMode first.
-        // (FocusApplicaiton is initialised before @Before methods are run.)
-        StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder().build());
-    }
-
-    /**
-     * This class can't be unparceled, and can therefore be used to test that SafeIntent and SafeBundle
-     * work as expected.
-     */
-    private static class UnparcelableParcel implements Parcelable {
-        // Called when constructing for test purposes
-        UnparcelableParcel() {
-        }
-
-        // Used only when unparceling:
-        protected UnparcelableParcel(Parcel in) {
-            throw new RuntimeException("Haha");
-        }
-
-        public static final Creator<UnparcelableParcel> CREATOR = new Creator<UnparcelableParcel>() {
-            @Override
-            public UnparcelableParcel createFromParcel(Parcel in) {
-                return new UnparcelableParcel(in);
-            }
-
-            @Override
-            public UnparcelableParcel[] newArray(int size) {
-                return new UnparcelableParcel[size];
-            }
-        };
-
-        @Override
-        public void writeToParcel(Parcel dest, int flags) {
-        }
-
-        @Override
-        public int describeContents() {
-            return 0;
-        }
-    }
-
-    @Test
-    public void isCustomTabIntent() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        assertTrue(CustomTabConfig.isCustomTabIntent(new SafeIntent(customTabsIntent.intent)));
-    }
-
-    @Test
-    public void menuTest() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        final PendingIntent pendingIntent = PendingIntent.getActivity(null, 0, null, 0);
-
-        builder.addMenuItem("menuitem1", pendingIntent);
-        builder.addMenuItem("menuitem2", pendingIntent);
-        // We can only handle menu items with an actual PendingIntent, other ones should be ignored:
-        builder.addMenuItem("menuitemIGNORED", null);
-
-        final CustomTabsIntent customTabsIntent = builder.build();
-        customTabsIntent.intent.putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, UUID.randomUUID().toString());
-
-        final CustomTabConfig config = CustomTabConfig.parseCustomTabIntent(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        assertEquals("Menu should contain 2 items", 2, config.menuItems.size());
-        final String s = config.menuItems.get(0).name;
-        assertEquals("Unexpected menu item",
-                "menuitem1", config.menuItems.get(0).name);
-        assertEquals("Unexpected menu item",
-                "menuitem2", config.menuItems.get(1).name);
-    }
-
-    @Test
-    public void malformedExtras() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        customTabsIntent.intent.putExtra("garbage", new UnparcelableParcel());
-
-        // We write the extras into a parcel so that we can check what happens when unparcelling fails
-        final Parcel parcel = Parcel.obtain();
-        final Bundle extras = customTabsIntent.intent.getExtras();
-        extras.writeToParcel(parcel, 0);
-        extras.clear();
-
-        // Bundle is lazy and doesn't unparcel when calling readBundle()
-        parcel.setDataPosition(0);
-        final Bundle injectedBundle = parcel.readBundle();
-        parcel.recycle();
-
-        // We aren't usually allowed to overwrite an intent's extras:
-        final Field extrasField = Intent.class.getDeclaredField("mExtras");
-        extrasField.setAccessible(true);
-        extrasField.set(customTabsIntent.intent, injectedBundle);
-        extrasField.setAccessible(false);
-
-        // And we can't access any extras now because unparcelling fails:
-        assertFalse(CustomTabConfig.isCustomTabIntent(new SafeIntent(customTabsIntent.intent)));
-
-        customTabsIntent.intent.putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, UUID.randomUUID().toString());
-
-        // Ensure we don't crash regardless
-        final CustomTabConfig c = CustomTabConfig.parseCustomTabIntent(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        // And we don't have any data:
-        assertNull(c.actionButtonConfig);
-    }
-
-    @Test
-    public void malformedActionButtonConfig() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        final Bundle garbage = new Bundle();
-        garbage.putParcelable("foobar", new UnparcelableParcel());
-        customTabsIntent.intent.putExtra(CustomTabsIntent.EXTRA_ACTION_BUTTON_BUNDLE, garbage);
-
-        // We should still detect that this is a custom tab
-        assertTrue(CustomTabConfig.isCustomTabIntent(new SafeIntent(customTabsIntent.intent)));
-
-        // And we still don't crash
-        final CustomTabConfig.ActionButtonConfig actionButtonConfig = CustomTabConfig.getActionButtonConfig(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        // But we weren't able to read the action button data because of the unparcelable data
-        assertNull(actionButtonConfig);
-    }
-
-    @Test
-    public void actionButtonConfig() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-
-        final String description = "description";
-        final String intentAction = "ACTION";
-        {
-            final Bitmap bitmap = Bitmap.createBitmap(new int[]{Color.RED}, 1, 1, Bitmap.Config.ARGB_8888);
-            final PendingIntent intent = PendingIntent.getActivity(RuntimeEnvironment.application, 0, new Intent(intentAction), 0);
-
-            builder.setActionButton(bitmap, description, intent);
-        }
-
-        final CustomTabsIntent customTabsIntent = builder.build();
-        final CustomTabConfig.ActionButtonConfig actionButtonConfig = CustomTabConfig.getActionButtonConfig(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        assertEquals(description, actionButtonConfig.description);
-        assertNotNull(actionButtonConfig.pendingIntent);
-
-        final Bitmap bitmap = actionButtonConfig.icon;
-        assertEquals(1, bitmap.getWidth());
-        assertEquals(1, bitmap.getHeight());
-        assertEquals(Color.RED, bitmap.getPixel(0, 0));
-    }
-
-    // Tests that a small icon is correctly processed
-    @Test
-    public void closeButton() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-
-        {
-            final Bitmap bitmap = Bitmap.createBitmap(new int[]{Color.RED}, 1, 1, Bitmap.Config.ARGB_8888);
-
-            builder.setCloseButtonIcon(bitmap);
-        }
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        final Bitmap bitmap = CustomTabConfig.getCloseButtonIcon(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        // An arbitrary icon
-        assertEquals(1, bitmap.getWidth());
-        assertEquals(1, bitmap.getHeight());
-        assertEquals(Color.RED, bitmap.getPixel(0, 0));
-    }
-
-    // Tests that a non-Bitmap is ignored
-    @Test
-    public void malformedCloseButton() throws Exception {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        // Intent is a parcelable but not a Bitmap
-        customTabsIntent.intent.putExtra(CustomTabsIntent.EXTRA_CLOSE_BUTTON_ICON, new Intent());
-
-        final Bitmap bitmap = CustomTabConfig.getCloseButtonIcon(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        assertNull(bitmap);
-    }
-
-    // Tests that a max-size bitmap is OK:
-    @Test
-    public void maxSizeCloseButton() throws Exception {
-        final int maxSize = RuntimeEnvironment.application.getResources().getDimensionPixelSize(R.dimen.customtabs_toolbar_icon_size);
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-
-        {
-            final Bitmap bitmap = Bitmap.createBitmap(new int[maxSize * maxSize], maxSize, maxSize, Bitmap.Config.ARGB_8888);
-
-            builder.setCloseButtonIcon(bitmap);
-        }
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        final Bitmap bitmap = CustomTabConfig.getCloseButtonIcon(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        // An arbitrary icon
-        assertNotNull(bitmap);
-        assertEquals(maxSize, bitmap.getWidth());
-        assertEquals(maxSize, bitmap.getHeight());
-    }
-
-    // Tests that a close bitmap that's too large is ignored:
-    @Test
-    public void oversizedCloseButton() throws Exception {
-        final int maxSize = RuntimeEnvironment.application.getResources().getDimensionPixelSize(R.dimen.customtabs_toolbar_icon_size);
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-
-        {
-            final Bitmap bitmap = Bitmap.createBitmap(new int[(maxSize + 1) * (maxSize + 1)], maxSize + 1, maxSize + 1, Bitmap.Config.ARGB_8888);
-
-            builder.setCloseButtonIcon(bitmap);
-        }
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        final Bitmap bitmap = CustomTabConfig.getCloseButtonIcon(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-
-        assertNull(bitmap);
-    }
-
-    // Test that parser throws an exception if no ID is in the intent
-    @Test(expected = IllegalArgumentException.class)
-    public void idIsRequired() {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        final CustomTabsIntent customTabsIntent = builder.build();
-
-        CustomTabConfig.parseCustomTabIntent(RuntimeEnvironment.application, new SafeIntent(customTabsIntent.intent));
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java
deleted file mode 100644
index 28a2224354a4..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java
+++ /dev/null
@@ -1,81 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.content.Context;
-import android.content.Intent;
-
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.robolectric.RobolectricTestRunner;
-
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.List;
-
-import static org.mockito.ArgumentMatchers.any;
-import static org.mockito.Mockito.mock;
-import static org.mockito.Mockito.never;
-import static org.mockito.Mockito.verify;
-
-@RunWith(RobolectricTestRunner.class)
-public class NotificationSessionObserverTest {
-    @Test
-    public void testEmptySession() {
-        final Context context = mock(Context.class);
-
-        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
-        observer.onChanged(Collections.<Session>emptyList());
-
-        verify(context).stopService(anyIntent());
-        verify(context, never()).startService(anyIntent());
-        verify(context, never()).startForegroundService(anyIntent());
-    }
-
-    @Test
-    public void testNullSession() {
-        final Context context = mock(Context.class);
-
-        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
-        observer.onChanged(null);
-
-        verify(context, never()).stopService(anyIntent());
-        verify(context, never()).startService(anyIntent());
-        verify(context, never()).startForegroundService(anyIntent());
-    }
-
-    @Test
-    public void testSingleSession() {
-        final Context context = mock(Context.class);
-
-        final List<Session> sessions = Collections.singletonList(mock(Session.class));
-
-        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
-        observer.onChanged(sessions);
-
-        verify(context, never()).stopService(anyIntent());
-        verify(context).startForegroundService(anyIntent());
-    }
-
-    @Test
-    public void testMultipleSessions() {
-        final Context context = mock(Context.class);
-
-        final List<Session> sessions = Arrays.asList(
-                mock(Session.class),
-                mock(Session.class),
-                mock(Session.class));
-
-        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
-        observer.onChanged(sessions);
-
-        verify(context, never()).stopService(anyIntent());
-        verify(context).startForegroundService(anyIntent());
-    }
-
-    private Intent anyIntent() {
-        return any(Intent.class);
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java
deleted file mode 100644
index 5bfff9684093..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java
+++ /dev/null
@@ -1,87 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.architecture.NonNullMutableLiveData;
-import org.mozilla.focus.web.IWebView;
-import org.robolectric.RobolectricTestRunner;
-
-import static org.mockito.Mockito.doReturn;
-import static org.mockito.Mockito.mock;
-import static org.mockito.Mockito.verify;
-
-@RunWith(RobolectricTestRunner.class)
-public class SessionCallbackProxyTest {
-    private static final String TEST_URL = "https://github.com/mozilla-mobile/focus-android/";
-
-    @Test
-    public void testOnPageStarted() {
-        final Session session = mock(Session.class);
-        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
-
-        proxy.onPageStarted(TEST_URL);
-
-        verify(session).setUrl(TEST_URL);
-        verify(session).setLoading(true);
-        verify(session).setSecure(false);
-        verify(session).setProgress(SessionCallbackProxy.MINIMUM_PROGRESS);
-    }
-
-    @Test
-    public void testOnPageFinished() {
-        final Session session = mock(Session.class);
-        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
-
-        proxy.onPageFinished(true);
-
-        verify(session).setLoading(false);
-        verify(session).setSecure(true);
-    }
-
-    @Test
-    public void testOnProgress() {
-        final Session session = mock(Session.class);
-        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
-
-        proxy.onProgress(1);
-
-        verify(session).setProgress(SessionCallbackProxy.MINIMUM_PROGRESS);
-
-        proxy.onProgress(42);
-
-        verify(session).setProgress(42);
-    }
-
-    @Test
-    public void testOnUrlChanged() {
-        final Session session = mock(Session.class);
-        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
-
-        proxy.onURLChanged(TEST_URL);
-
-        verify(session).setUrl(TEST_URL);
-    }
-
-    @Test
-    public void testBlockedTrackerCounter() {
-        final NonNullMutableLiveData<Integer> blockedTrackerCounter = new NonNullMutableLiveData<>(50);
-
-        final Session session = mock(Session.class);
-        doReturn(blockedTrackerCounter).when(session).getBlockedTrackers();
-
-        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
-
-        proxy.countBlockedTracker();
-
-        verify(session).getBlockedTrackers();
-        verify(session).setTrackersBlocked(51);
-
-        proxy.resetBlockedTrackers();
-
-        verify(session).setTrackersBlocked(0);
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java
deleted file mode 100644
index 09d55c774ead..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java
+++ /dev/null
@@ -1,382 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.content.Intent;
-import android.graphics.Color;
-import android.net.Uri;
-import android.os.Bundle;
-import android.support.customtabs.CustomTabsIntent;
-
-import org.junit.Before;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.customtabs.CustomTabConfig;
-import org.robolectric.RobolectricTestRunner;
-import org.robolectric.RuntimeEnvironment;
-
-import java.util.List;
-import java.util.UUID;
-
-import mozilla.components.support.utils.SafeIntent;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-
-@RunWith(RobolectricTestRunner.class)
-public class SessionManagerTest {
-    private static final String TEST_URL = "https://github.com/mozilla-mobile/focus-android";
-    private static final String TEST_URL_2 = "https://www.mozilla.org";
-    private static final String TEST_URL_3 = "https://www.mozilla.org/en-US/firefox/focus/";
-
-    @Before
-    public void setUp() {
-        // Always start tests with a clean session manager
-        SessionManager sessionManager = SessionManager.getInstance();
-
-        sessionManager.removeAllSessions();
-        sessionManager.removeAllCustomTabSessions();
-    }
-
-    @Test
-    public void testInitialState() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        assertNotNull(sessionManager.getSessions().getValue());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-        assertFalse(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testViewIntent() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final SafeIntent intent = new SafeIntent(new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL)));
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(1, sessions.size());
-
-        final Session session = sessions.get(0);
-        assertEquals(TEST_URL, session.getUrl().getValue());
-        assertFalse(session.isCustomTab());
-        assertNull(session.getCustomTabConfig());
-
-        assertTrue(sessionManager.hasSession());
-    }
-
-    /**
-     * In production we see apps send VIEW intents without an URL. (#1373)
-     */
-    @Test
-    public void testViewIntentWithNullURL() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        assertFalse(sessionManager.hasSession());
-
-        final SafeIntent intent = new SafeIntent(new Intent(Intent.ACTION_VIEW, null));
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        // We ignored the Intent and no session has been created.
-        assertFalse(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testCustomTabIntent() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final SafeIntent intent = new SafeIntent(new CustomTabsIntent.Builder()
-                .setToolbarColor(Color.GREEN)
-                .addDefaultShareMenuItem()
-                .build()
-                .intent
-                .setData(Uri.parse(TEST_URL))
-                .putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, UUID.randomUUID().toString()));
-
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(0, sessions.size());
-
-        final List<Session> customTabSessions = sessionManager.getCustomTabSessions().getValue();
-        assertNotNull(customTabSessions);
-        assertEquals(1, customTabSessions.size());
-
-        final Session session = customTabSessions.get(0);
-        assertEquals(TEST_URL, session.getUrl().getValue());
-        assertTrue(session.isCustomTab());
-        assertNotNull(session.getCustomTabConfig());
-
-        final CustomTabConfig config = session.getCustomTabConfig();
-        assertNotNull(config.toolbarColor);
-        assertEquals(Color.GREEN, config.toolbarColor.intValue());
-        assertTrue(config.showShareMenuItem);
-
-        assertFalse(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testViewIntentFromHistoryIsIgnored() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final Intent unsafeIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL));
-        unsafeIntent.addFlags(Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY);
-
-        final SafeIntent intent = new SafeIntent(unsafeIntent);
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(0, sessions.size());
-
-        assertFalse(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testNoSessionIsCreatedIfWeAreRestoring() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final Bundle instanceState = new Bundle();
-
-        final SafeIntent intent = new SafeIntent(new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL)));
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, instanceState);
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(0, sessions.size());
-
-        assertFalse(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testShareIntentViaNewIntent() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final Intent unsafeIntent = new Intent(Intent.ACTION_SEND);
-        unsafeIntent.putExtra(Intent.EXTRA_TEXT, TEST_URL);
-
-        sessionManager.handleNewIntent(RuntimeEnvironment.application, new SafeIntent(unsafeIntent));
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(1, sessions.size());
-
-        final Session session = sessions.get(0);
-        assertFalse(session.isSearch());
-        assertEquals(TEST_URL, session.getUrl().getValue());
-        assertFalse(session.isCustomTab());
-        assertNull(session.getCustomTabConfig());
-
-        assertTrue(sessionManager.hasSession());
-    }
-
-    @Test
-    public void testShareIntentWithTextViaNewIntent() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        final Intent unsafeIntent = new Intent(Intent.ACTION_SEND);
-        unsafeIntent.putExtra(Intent.EXTRA_TEXT, "Hello World Focus");
-
-        sessionManager.handleNewIntent(RuntimeEnvironment.application, new SafeIntent(unsafeIntent));
-
-        final List<Session> sessions = sessionManager.getSessions().getValue();
-        assertNotNull(sessions);
-        assertEquals(1, sessions.size());
-
-        final String SEARCH_QUERY = "https://www.google.com/search?q=Hello%20World%20Focus&ie=utf-8&oe=utf-8&client=firefox-b";
-        final Session session = sessions.get(0);
-        assertTrue(session.isSearch());
-        assertEquals("Hello World Focus", session.getSearchTerms());
-        assertEquals(SEARCH_QUERY, session.getUrl().getValue());
-        assertFalse(session.isCustomTab());
-        assertNull(session.getCustomTabConfig());
-
-        assertTrue(sessionManager.hasSession());
-    }
-
-    @Test(expected = IllegalAccessError.class)
-    public void getCurrentSessionThrowsExceptionIfThereIsNoSession() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        sessionManager.getCurrentSession();
-    }
-
-    @Test
-    public void testHasSessionWithUUID() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        assertFalse(sessionManager.hasSessionWithUUID(UUID.randomUUID().toString()));
-
-        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
-
-        assertTrue(sessionManager.hasSession());
-
-        final Session session = sessionManager.getCurrentSession();
-        assertNotNull(session);
-        assertTrue(sessionManager.hasSessionWithUUID(session.getUUID()));
-        assertNotNull(sessionManager.getSessionByUUID(session.getUUID()));
-    }
-
-    @Test(expected = IllegalAccessError.class)
-    public void getSessionByUUIDThrowsExceptionIfSessionDoesNotExist() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        sessionManager.getSessionByUUID(UUID.randomUUID().toString());
-    }
-
-    @Test
-    public void testRemovingSessions() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
-        sessionManager.createSession(Source.VIEW, TEST_URL_2);
-        sessionManager.createSession(Source.SHARE, TEST_URL_3);
-
-        {
-            final List<Session> sessions = sessionManager.getSessions().getValue();
-            assertEquals(3, sessions.size());
-        }
-
-        {
-            final Session currentSession = sessionManager.getCurrentSession();
-            assertEquals(Source.SHARE, currentSession.getSource());
-            assertEquals(TEST_URL_3, currentSession.getUrl().getValue());
-        }
-
-        sessionManager.removeCurrentSession();
-
-        {
-            final Session currentSession = sessionManager.getCurrentSession();
-            assertEquals(Source.VIEW, currentSession.getSource());
-            assertEquals(TEST_URL_2, currentSession.getUrl().getValue());
-        }
-
-        sessionManager.removeCurrentSession();
-
-        {
-            final Session currentSession = sessionManager.getCurrentSession();
-            assertEquals(Source.USER_ENTERED, currentSession.getSource());
-            assertEquals(TEST_URL, currentSession.getUrl().getValue());
-        }
-
-        sessionManager.removeCurrentSession();
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-    }
-
-    @Test
-    public void testRemovingAllSessions() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
-        sessionManager.createSession(Source.VIEW, TEST_URL_2);
-        sessionManager.createSession(Source.SHARE, TEST_URL_3);
-
-        assertTrue(sessionManager.hasSession());
-        assertEquals(3, sessionManager.getSessions().getValue().size());
-
-        sessionManager.removeAllSessions();
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-    }
-
-    @Test
-    public void testHasSessionWithUUIDWithUnknownUUID() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
-
-        assertFalse(sessionManager.hasSessionWithUUID(UUID.randomUUID().toString()));
-    }
-
-    @Test
-    public void testRemovingUnknownSessionHasNoEffect() {
-        final SessionManager sessionManager = SessionManager.getInstance();
-        sessionManager.removeRegularSession(UUID.randomUUID().toString());
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-    }
-
-    @Test
-    public void testSeparateCustomTabSessions() {
-        final String customTabId = "342d6440-760a-43ba-86c4-fe896eb20a29";
-
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getCustomTabSessions().getValue().size());
-
-        final SafeIntent intent = new SafeIntent(new CustomTabsIntent.Builder()
-                .build()
-                .intent
-                .setData(Uri.parse(TEST_URL))
-                .putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, customTabId));
-
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(1, sessionManager.getCustomTabSessions().getValue().size());
-
-        assertNotNull(sessionManager.getCustomTabSessionByCustomTabId(customTabId));
-    }
-
-    @Test(expected = IllegalAccessError.class)
-    public void testThrowsIfCustomTabDoesNotExist() {
-        final String customTabId = "342d6440-760a-43ba-86c4-fe896eb20a29";
-
-        final SessionManager sessionManager = SessionManager.getInstance();
-        sessionManager.getCustomTabSessionByCustomTabIdOrThrow(customTabId);
-    }
-
-    @Test
-    public void testNullReturnedIfCustomTabDoesNotExist() {
-        final String customTabId = "342d6440-760a-43ba-86c4-fe896eb20a29";
-
-        final SessionManager sessionManager = SessionManager.getInstance();
-        assertNull(sessionManager.getCustomTabSessionByCustomTabId(customTabId));
-    }
-
-    @Test
-    public void testTransformingCustomTabIntoRegularSession() {
-        final String customTabId = "342d6440-760a-43ba-86c4-fe896eb20a29";
-
-        final SessionManager sessionManager = SessionManager.getInstance();
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getCustomTabSessions().getValue().size());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-
-        final SafeIntent intent = new SafeIntent(new CustomTabsIntent.Builder()
-                .build()
-                .intent
-                .setData(Uri.parse(TEST_URL))
-                .putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, customTabId));
-
-        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
-
-        assertFalse(sessionManager.hasSession());
-        assertEquals(1, sessionManager.getCustomTabSessions().getValue().size());
-        assertEquals(0, sessionManager.getSessions().getValue().size());
-
-        final Session session = sessionManager.getCustomTabSessionByCustomTabId(customTabId);
-        assertNotNull(session);
-        assertTrue(session.isCustomTab());
-        assertEquals(Source.CUSTOM_TAB, session.getSource());
-        assertNotNull(session.getCustomTabConfig());
-
-        sessionManager.moveCustomTabToRegularSessions(session);
-
-        assertTrue(sessionManager.hasSession());
-        assertEquals(0, sessionManager.getCustomTabSessions().getValue().size());
-        assertEquals(1, sessionManager.getSessions().getValue().size());
-
-        assertFalse(session.isCustomTab());
-        assertEquals(Source.NONE, session.getSource());
-        assertNull(session.getCustomTabConfig());
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java
deleted file mode 100644
index 59c0c5cad9c6..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java
+++ /dev/null
@@ -1,228 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.session;
-
-import android.arch.lifecycle.Lifecycle;
-import android.arch.lifecycle.LifecycleOwner;
-import android.arch.lifecycle.LifecycleRegistry;
-import android.arch.lifecycle.Observer;
-import android.content.Intent;
-import android.graphics.Color;
-import android.os.Bundle;
-import android.support.customtabs.CustomTabsIntent;
-import android.text.TextUtils;
-
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.customtabs.CustomTabConfig;
-import org.robolectric.RobolectricTestRunner;
-import org.robolectric.RuntimeEnvironment;
-
-import java.util.UUID;
-
-import mozilla.components.support.utils.SafeIntent;
-
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.assertTrue;
-import static org.mockito.Mockito.doReturn;
-import static org.mockito.Mockito.mock;
-import static org.mockito.Mockito.verify;
-
-@RunWith(RobolectricTestRunner.class)
-public class SessionTest {
-    private static final String TEST_URL = "https://www.mozilla.org";
-    private static final String TEST_URL_2 = "https://www.example.org";
-
-    @Test
-    public void testEmptySession() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-
-        assertFalse(TextUtils.isEmpty(session.getUUID()));
-        assertEquals(TEST_URL, session.getUrl().getValue());
-
-        assertEquals(0, (int) session.getProgress().getValue());
-        assertFalse(session.getSecure().getValue());
-        assertFalse(session.getLoading().getValue());
-        assertEquals(0, (int) session.getBlockedTrackers().getValue());
-
-        assertNull(session.getCustomTabConfig());
-        assertFalse(session.isCustomTab());
-    }
-
-    @Test
-    public void testObserversGetInitialValues() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-
-        {
-            final Observer<String> urlObserver = mockObserver();
-            session.getUrl().observe(mockLifecycleOwner(), urlObserver);
-            verify(urlObserver).onChanged(TEST_URL);
-        }
-        {
-            final Observer<Integer> progressObserver = mockObserver();
-            session.getProgress().observe(mockLifecycleOwner(), progressObserver);
-            verify(progressObserver).onChanged(0);
-        }
-        {
-            final Observer<Boolean> secureObserver = mockObserver();
-            session.getSecure().observe(mockLifecycleOwner(), secureObserver);
-            verify(secureObserver).onChanged(false);
-        }
-        {
-            final Observer<Boolean> loadingObserver = mockObserver();
-            session.getLoading().observe(mockLifecycleOwner(), loadingObserver);
-            verify(loadingObserver).onChanged(false);
-        }
-        {
-            final Observer<Integer> blockedTrackersObserver = mockObserver();
-            session.getBlockedTrackers().observe(mockLifecycleOwner(), blockedTrackersObserver);
-            verify(blockedTrackersObserver).onChanged(0);
-        }
-    }
-
-    @Test
-    public void testObservingValueChanges() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-
-        {
-            final Observer<String> urlObserver = mockObserver();
-            session.getUrl().observe(mockLifecycleOwner(), urlObserver);
-            verify(urlObserver).onChanged(TEST_URL);
-
-            session.setUrl(TEST_URL_2);
-            verify(urlObserver).onChanged(TEST_URL_2);
-        }
-        {
-            final Observer<Integer> progressObserver = mockObserver();
-            session.getProgress().observe(mockLifecycleOwner(), progressObserver);
-            verify(progressObserver).onChanged(0);
-
-            session.setProgress(42);
-            verify(progressObserver).onChanged(42);
-        }
-        {
-            final Observer<Boolean> secureObserver = mockObserver();
-            session.getSecure().observe(mockLifecycleOwner(), secureObserver);
-            verify(secureObserver).onChanged(false);
-
-            session.setSecure(true);
-            verify(secureObserver).onChanged(true);
-        }
-        {
-            final Observer<Boolean> loadingObserver = mockObserver();
-            session.getLoading().observe(mockLifecycleOwner(), loadingObserver);
-            verify(loadingObserver).onChanged(false);
-
-            session.setLoading(true);
-            verify(loadingObserver).onChanged(true);
-        }
-        {
-            final Observer<Integer> blockedTrackersObserver = mockObserver();
-            session.getBlockedTrackers().observe(mockLifecycleOwner(), blockedTrackersObserver);
-            verify(blockedTrackersObserver).onChanged(0);
-
-            session.setTrackersBlocked(23);
-            verify(blockedTrackersObserver).onChanged(23);
-        }
-    }
-
-    @Test
-    public void testCustomTabConfiguration() {
-        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
-        builder.setToolbarColor(Color.GREEN);
-
-        final Intent rawIntent = builder.build().intent;
-        rawIntent.putExtra(CustomTabConfig.EXTRA_CUSTOM_TAB_ID, UUID.randomUUID().toString());
-
-        final SafeIntent intent = new SafeIntent(rawIntent);
-        final CustomTabConfig customTabConfig = CustomTabConfig.parseCustomTabIntent(RuntimeEnvironment.application, intent);
-        final Session session = new Session(TEST_URL, customTabConfig);
-
-        assertTrue(session.isCustomTab());
-        assertNotNull(session.getCustomTabConfig());
-        assertNotNull(session.getCustomTabConfig().toolbarColor);
-        assertEquals(Color.GREEN, (int) session.getCustomTabConfig().toolbarColor);
-    }
-
-    @Test
-    public void testSavingAndRetrievingWebViewState() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-
-        assertNull(session.getWebViewState());
-
-        {
-            final Bundle bundle = new Bundle();
-            bundle.putInt("friday", 13);
-
-            session.saveWebViewState(bundle);
-        }
-
-        assertNotNull(session.getWebViewState());
-
-        {
-            final Bundle bundle = session.getWebViewState();
-            assertTrue(bundle.containsKey("friday"));
-            assertEquals(13, bundle.getInt("friday"));
-        }
-    }
-
-    @Test
-    public void testIsSearch() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-        assertFalse(session.isSearch());
-
-        session.setSearchTerms("hello world");
-        assertTrue(session.isSearch());
-
-        session.clearSearchTerms();
-        assertFalse(session.isSearch());
-
-        session.setSearchTerms(null);
-        assertFalse(session.isSearch());
-
-        session.setSearchTerms("");
-        assertFalse(session.isSearch());
-    }
-
-    @Test
-    public void testIsRecorded() {
-        final Session session = new Session(Source.VIEW, TEST_URL);
-        assertFalse(session.isRecorded());
-
-        session.markAsRecorded();
-        assertTrue(session.isRecorded());
-    }
-
-    @Test
-    public void testSameAs() {
-        final Session session1 = new Session(Source.VIEW, TEST_URL);
-        final Session session2 = new Session(Source.VIEW, TEST_URL);
-
-        assertFalse(session1.isSameAs(session2));
-        assertFalse(session2.isSameAs(session1));
-
-        assertTrue(session1.isSameAs(session1));
-        assertTrue(session2.isSameAs(session2));
-    }
-
-    @SuppressWarnings("unchecked")
-    private <T> Observer<T> mockObserver() {
-        return mock(Observer.class);
-    }
-
-    private LifecycleOwner mockLifecycleOwner() {
-        final LifecycleOwner lifecycleOwner = mock(LifecycleOwner.class);
-
-        LifecycleRegistry registry = new LifecycleRegistry(lifecycleOwner);
-        registry.handleLifecycleEvent(Lifecycle.Event.ON_RESUME);
-
-        doReturn(registry).when(lifecycleOwner).getLifecycle();
-
-        return lifecycleOwner;
-    }
-}
\ No newline at end of file
