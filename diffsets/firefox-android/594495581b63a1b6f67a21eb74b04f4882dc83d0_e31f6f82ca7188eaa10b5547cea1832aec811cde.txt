diff --git a/focus-android/app/src/main/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegration.kt b/focus-android/app/src/main/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegration.kt
index e470b21da61e..ba1032247d2e 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegration.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegration.kt
@@ -4,18 +4,26 @@
 
 package org.mozilla.focus.browser.integration
 
+import android.graphics.Color
+import androidx.annotation.VisibleForTesting
 import androidx.appcompat.content.res.AppCompatResources
 import androidx.core.content.ContextCompat
 import androidx.core.content.res.ResourcesCompat
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.cancel
+import kotlinx.coroutines.flow.collect
+import kotlinx.coroutines.flow.mapNotNull
 import mozilla.components.browser.state.selector.findCustomTabOrSelectedTab
 import mozilla.components.browser.state.store.BrowserStore
 import mozilla.components.browser.toolbar.BrowserToolbar
-import mozilla.components.browser.toolbar.display.DisplayToolbar
+import mozilla.components.browser.toolbar.display.DisplayToolbar.Indicators
 import mozilla.components.feature.customtabs.CustomTabsToolbarFeature
 import mozilla.components.feature.session.SessionUseCases
 import mozilla.components.feature.tabs.CustomTabsUseCases
 import mozilla.components.feature.toolbar.ToolbarPresenter
+import mozilla.components.lib.state.ext.flowScoped
 import mozilla.components.support.base.feature.LifecycleAwareFeature
+import mozilla.components.support.ktx.kotlinx.coroutines.flow.ifChanged
 import mozilla.components.support.utils.ColorUtils
 import org.mozilla.focus.GleanMetrics.TrackingProtection
 import org.mozilla.focus.R
@@ -33,7 +41,8 @@ class BrowserToolbarIntegration(
     sessionUseCases: SessionUseCases,
     customTabsUseCases: CustomTabsUseCases,
     private val onUrlLongClicked: () -> Boolean,
-    private val customTabId: String? = null
+    private val customTabId: String? = null,
+    inTesting: Boolean = false
 ) : LifecycleAwareFeature {
     private val presenter = ToolbarPresenter(
         toolbar,
@@ -41,6 +50,8 @@ class BrowserToolbarIntegration(
         customTabId
     )
 
+    @VisibleForTesting
+    internal var securityIndicatorScope: CoroutineScope? = null
     private var customTabsFeature: CustomTabsToolbarFeature? = null
     private var navigationButtonsIntegration: NavigationButtonsIntegration? = null
 
@@ -50,17 +61,17 @@ class BrowserToolbarIntegration(
         toolbar.display.apply {
             colors = colors.copy(
                 hint = ContextCompat.getColor(toolbar.context, R.color.photonLightGrey05),
+                securityIconInsecure = Color.TRANSPARENT,
                 text = ContextCompat.getColor(toolbar.context, R.color.primaryText)
             )
 
-            indicators = listOf(
-                DisplayToolbar.Indicators.TRACKING_PROTECTION
-            )
+            addTrackingProtectionIndicator()
 
             displayIndicatorSeparator = false
 
             setOnSiteSecurityClickedListener {
-                fragment.showSecurityPopUp()
+                TrackingProtection.toolbarShieldClicked.add()
+                fragment.showTrackingProtectionPanel()
             }
 
             onUrlClicked = {
@@ -91,7 +102,9 @@ class BrowserToolbarIntegration(
             fragment.showTrackingProtectionPanel()
         }
 
-        setUrlBackground()
+        if (!inTesting) {
+            setUrlBackground()
+        }
 
         if (customTabId != null) {
             val menu = CustomTabMenu(
@@ -150,6 +163,26 @@ class BrowserToolbarIntegration(
 
         customTabsFeature?.start()
         navigationButtonsIntegration?.start()
+        observerSecurityIndicatorChanges()
+    }
+
+    @VisibleForTesting
+    internal fun observerSecurityIndicatorChanges() {
+        securityIndicatorScope = store.flowScoped { flow ->
+            flow.mapNotNull { state -> state.findCustomTabOrSelectedTab(customTabId) }
+                .ifChanged { tab -> tab.content.securityInfo }
+                .collect {
+                    val secure = it.content.securityInfo.secure
+                    val url = it.content.url
+                    if (secure && Indicators.SECURITY in toolbar.display.indicators) {
+                        addTrackingProtectionIndicator()
+                    } else if (!secure && Indicators.SECURITY !in toolbar.display.indicators &&
+                        !url.trim().startsWith("about:")
+                    ) {
+                        addSecurityIndicator()
+                    }
+                }
+        }
     }
 
     override fun stop() {
@@ -157,5 +190,21 @@ class BrowserToolbarIntegration(
 
         customTabsFeature?.stop()
         navigationButtonsIntegration?.stop()
+        stopObserverSecurityIndicatorChanges()
+    }
+
+    @VisibleForTesting
+    internal fun stopObserverSecurityIndicatorChanges() {
+        securityIndicatorScope?.cancel()
+    }
+
+    @VisibleForTesting
+    internal fun addSecurityIndicator() {
+        toolbar.display.indicators = listOf(Indicators.SECURITY)
+    }
+
+    @VisibleForTesting
+    internal fun addTrackingProtectionIndicator() {
+        toolbar.display.indicators = listOf(Indicators.TRACKING_PROTECTION)
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
index 991e0465dfbb..e30f10690921 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.kt
@@ -8,11 +8,8 @@ import android.content.ClipData
 import android.content.ClipboardManager
 import android.content.Context
 import android.content.Intent
-import android.graphics.Color
-import android.graphics.drawable.ColorDrawable
 import android.net.Uri
 import android.os.Bundle
-import android.view.Gravity
 import android.view.LayoutInflater
 import android.view.View
 import android.view.ViewGroup
@@ -76,7 +73,6 @@ import org.mozilla.focus.ext.requireComponents
 import org.mozilla.focus.ext.titleOrDomain
 import org.mozilla.focus.menu.browser.DefaultBrowserMenu
 import org.mozilla.focus.open.OpenWithFragment
-import org.mozilla.focus.popup.PopupUtils
 import org.mozilla.focus.settings.privacy.ConnectionDetailsPanel
 import org.mozilla.focus.settings.privacy.TrackingProtectionPanel
 import org.mozilla.focus.state.AppAction
@@ -797,29 +793,6 @@ class BrowserFragment :
         requireComponents.sessionUseCases.requestDesktopSite(enabled, tab.id)
     }
 
-    fun showSecurityPopUp() {
-        if (crashReporterIsVisible()) {
-            return
-        }
-
-        // Don't show Security Popup if the page is loading
-        if (tab.content.loading) {
-            return
-        }
-        val securityPopup = PopupUtils.createSecurityPopup(requireContext(), tab)
-        if (securityPopup != null) {
-            securityPopup.setOnDismissListener { popupTint!!.visibility = View.GONE }
-            securityPopup.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))
-            securityPopup.animationStyle = android.R.style.Animation_Dialog
-            securityPopup.isTouchable = true
-            securityPopup.isFocusable = true
-            securityPopup.elevation = resources.getDimension(R.dimen.menu_elevation)
-            val offsetY = requireContext().resources.getDimensionPixelOffset(R.dimen.doorhanger_offsetY)
-            securityPopup.showAtLocation(urlBar, Gravity.TOP or Gravity.CENTER_HORIZONTAL, 0, offsetY)
-            popupTint!!.visibility = View.VISIBLE
-        }
-    }
-
     fun showTrackingProtectionPanel() {
         trackingProtectionPanel = TrackingProtectionPanel(
             context = requireContext(),
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt b/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt
deleted file mode 100644
index c92d5128b621..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/popup/PopupUtils.kt
+++ /dev/null
@@ -1,149 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.popup
-
-import android.content.Context
-import android.graphics.drawable.BitmapDrawable
-import android.graphics.drawable.Drawable
-import android.text.TextUtils
-import android.view.LayoutInflater
-import android.view.View
-import android.view.ViewGroup
-import android.webkit.URLUtil
-import android.widget.ImageView
-import android.widget.PopupWindow
-import android.widget.TextView
-import androidx.core.content.ContextCompat
-import androidx.core.graphics.drawable.toBitmap
-import mozilla.components.browser.state.state.SessionState
-import mozilla.components.support.utils.DrawableUtils
-import org.mozilla.focus.R
-import java.net.MalformedURLException
-import java.net.URL
-
-object PopupUtils {
-
-    fun createSecurityPopup(context: Context, tab: SessionState): PopupWindow? {
-        val isSecure = tab.content.securityInfo.secure
-        val url = tab.content.url
-        val res = context.resources
-
-        val inflater = LayoutInflater.from(context)
-        val popUpView = inflater.inflate(R.layout.security_popup, null)
-        val origin = tab.content.securityInfo.host
-        val verifierInfo = tab.content.securityInfo.issuer
-        val hostInfo = popUpView.findViewById<TextView>(R.id.site_identity_title)
-        val securityInfoIcon = popUpView.findViewById<ImageView>(R.id.site_identity_icon)
-        val verifier = popUpView.findViewById<TextView>(R.id.verifier)
-
-        setOrigin(hostInfo, origin, url)
-
-        val identityState = popUpView.findViewById<TextView>(R.id.site_identity_state)
-        identityState.setText(
-            if (isSecure)
-                R.string.security_popup_secure_connection
-            else
-                R.string.security_popup_insecure_connection
-        )
-
-        if (isSecure) {
-            setSecurityInfoSecure(
-                context, identityState, verifierInfo, verifier,
-                securityInfoIcon
-            )
-        } else {
-            verifier.visibility = View.GONE
-            setSecurityInfoInsecure(context, identityState, url, securityInfoIcon)
-        }
-
-        identityState.compoundDrawablePadding = res.getDimension(
-            R.dimen.doorhanger_drawable_padding
-        ).toInt()
-
-        return PopupWindow(
-            popUpView, res.getDimension(R.dimen.doorhanger_width).toInt(),
-            ViewGroup.LayoutParams.WRAP_CONTENT, true
-        )
-    }
-
-    private fun setOrigin(hostInfo: TextView, origin: String?, url: String) {
-        hostInfo.text = if (!TextUtils.isEmpty(origin)) {
-            origin
-        } else {
-            try {
-                URL(url).host
-            } catch (e: MalformedURLException) {
-                url
-            }
-        }
-    }
-
-    private fun setSecurityInfoSecure(
-        context: Context,
-        identityState: TextView,
-        verifierInfo: String?,
-        verifier: TextView,
-        securityInfoIcon: ImageView
-    ) {
-        val photonGreen = ContextCompat.getColor(context, R.color.photonGreen60)
-        val checkIcon = DrawableUtils.loadAndTintDrawable(context, R.drawable.ic_check, photonGreen)
-        identityState.setCompoundDrawables(
-            getScaledDrawable(context, R.dimen.doorhanger_small_icon, checkIcon), null,
-            null, null
-        )
-        identityState.setTextColor(photonGreen)
-        if (!TextUtils.isEmpty(verifierInfo)) {
-            verifier.text = context.getString(
-                R.string.security_popup_security_verified,
-                verifierInfo
-            )
-            verifier.visibility = View.VISIBLE
-        } else {
-            verifier.visibility = View.GONE
-        }
-        securityInfoIcon.setImageResource(R.drawable.mozac_ic_lock)
-        securityInfoIcon.setColorFilter(photonGreen)
-    }
-
-    private fun setSecurityInfoInsecure(
-        context: Context,
-        identityState: TextView,
-        url: String,
-        securityInfoIcon: ImageView
-    ) {
-        identityState.setTextColor(ContextCompat.getColor(context, R.color.primaryText))
-
-        val inactiveColor = ContextCompat.getColor(context, R.color.colorTextInactive)
-        val photonYellow = ContextCompat.getColor(context, R.color.photonYellow60)
-
-        val securityIcon: Drawable
-        if (URLUtil.isHttpUrl(url)) {
-            securityInfoIcon.setImageResource(R.drawable.ic_internet)
-            securityInfoIcon.setColorFilter(inactiveColor)
-        } else {
-            securityInfoIcon.setImageResource(R.drawable.mozac_ic_warning)
-            securityInfoIcon.setColorFilter(photonYellow)
-            securityIcon = DrawableUtils.loadAndTintDrawable(
-                context, R.drawable.mozac_ic_warning,
-                photonYellow
-            )
-            identityState.setCompoundDrawables(
-                getScaledDrawable(
-                    context, R.dimen.doorhanger_small_icon,
-                    securityIcon
-                ),
-                null,
-                null, null
-            )
-        }
-    }
-
-    private fun getScaledDrawable(context: Context, size: Int, drawable: Drawable): Drawable {
-        val iconSize = context.resources.getDimension(size).toInt()
-        val icon = BitmapDrawable(context.resources, drawable.toBitmap())
-        icon.setBounds(0, 0, iconSize, iconSize)
-        return icon
-    }
-}
diff --git a/focus-android/app/src/main/res/drawable/mozac_ic_broken_lock.xml b/focus-android/app/src/main/res/drawable/mozac_ic_broken_lock.xml
new file mode 100644
index 000000000000..dc9ec5a9f419
--- /dev/null
+++ b/focus-android/app/src/main/res/drawable/mozac_ic_broken_lock.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="24dp"
+        android:height="24dp"
+        android:viewportWidth="24.0"
+        android:viewportHeight="24.0">
+    <path
+        android:fillColor="?attr/primaryText"
+        android:pathData="M7 7.562V11H6.5A2.5 2.5 0 0 0 4 13.5v6A2.5 2.5 0 0 0 6.5 22h11c1.066 0 1.97-0.67 2.329-1.61L18.5 19.061V19.7l-0.8 0.8H6.3l-0.8-0.8v-6.4l0.8-0.8h5.638l-1.5-1.5H8.5V9.062L7 7.562z" />
+    <path
+        android:fillColor="#FF4F5E"
+        android:pathData="M4.78 3.22l17.5 17.5A0.748 0.748 0 0 1 21.749 22a0.748 0.748 0 0 1-0.53-0.22L3.719 4.281A0.75 0.75 0 1 1 4.78 3.22z" />
+    <path
+        android:fillColor="?attr/primaryText"
+        android:pathData="M12 3.5c1.93 0 3.5 1.57 3.5 3.5v4h-0.809l1.5 1.5H17.7l0.8 0.8v1.509l1.5 1.5V13.5a2.5 2.5 0 0 0-2.5-2.5H17V7a5 5 0 0 0-5-5 4.99 4.99 0 0 0-4.127 2.182L8.971 5.28C9.574 4.222 10.698 3.5 12 3.5z" />
+</vector>
diff --git a/focus-android/app/src/main/res/layout/security_popup.xml b/focus-android/app/src/main/res/layout/security_popup.xml
deleted file mode 100644
index b362f04de159..000000000000
--- a/focus-android/app/src/main/res/layout/security_popup.xml
+++ /dev/null
@@ -1,66 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- This Source Code Form is subject to the terms of the Mozilla Public
-       - License, v. 2.0. If a copy of the MPL was not distributed with this
-       - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
-<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="wrap_content"
-    android:background="@drawable/background_gradient_dark">
-
-    <LinearLayout
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:orientation="horizontal"
-        android:paddingBottom="@dimen/doorhanger_section_padding_large"
-        android:paddingEnd="@dimen/doorhanger_section_padding_small"
-        android:paddingStart="@dimen/doorhanger_section_padding_small"
-        android:paddingTop="@dimen/doorhanger_section_padding_medium">
-
-        <ImageView
-            android:id="@+id/site_identity_icon"
-            android:layout_width="@dimen/doorhanger_icon_size"
-            android:layout_height="@dimen/doorhanger_icon_size"
-            android:layout_marginEnd="@dimen/doorhanger_section_padding_small"
-            android:gravity="center_horizontal"
-            android:padding="@dimen/doorhanger_section_padding_small" />
-
-        <LinearLayout
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:orientation="vertical"
-            android:paddingEnd="@dimen/doorhanger_section_padding_medium">
-
-            <TextView
-                android:id="@+id/site_identity_title"
-                android:layout_width="wrap_content"
-                android:layout_height="wrap_content"
-                android:ellipsize="end"
-                android:maxLines="1"
-                android:textAppearance="@style/DoorHanger.Medium.Light" />
-
-            <TextView
-                android:id="@+id/site_identity_state"
-                android:layout_width="match_parent"
-                android:layout_height="wrap_content"
-                android:layout_marginTop="@dimen/doorhanger_subsection_padding"
-                android:maxLines="1"
-                android:textAppearance="@style/DoorHanger.Medium.Bold" />
-
-            <!-- We don't have this information from WebView -->
-            <TextView
-                android:id="@+id/mixed_content_activity"
-                android:layout_width="match_parent"
-                android:layout_height="wrap_content"
-                android:layout_marginTop="@dimen/doorhanger_section_padding_medium"
-                android:textAppearance="@style/DoorHanger.Medium"
-                android:visibility="gone" />
-
-            <TextView
-                android:id="@+id/verifier"
-                android:layout_width="match_parent"
-                android:layout_height="wrap_content"
-                android:layout_marginTop="@dimen/doorhanger_section_padding_medium"
-                android:textAppearance="@style/DoorHanger.Medium.Light" />
-        </LinearLayout>
-    </LinearLayout>
-</FrameLayout>
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegrationTest.kt b/focus-android/app/src/test/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegrationTest.kt
new file mode 100644
index 000000000000..6393d60c2a58
--- /dev/null
+++ b/focus-android/app/src/test/java/org/mozilla/focus/browser/integration/BrowserToolbarIntegrationTest.kt
@@ -0,0 +1,175 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.browser.integration
+
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.ExperimentalCoroutinesApi
+import kotlinx.coroutines.test.TestCoroutineDispatcher
+import kotlinx.coroutines.test.resetMain
+import kotlinx.coroutines.test.setMain
+import mozilla.components.browser.state.action.ContentAction
+import mozilla.components.browser.state.state.BrowserState
+import mozilla.components.browser.state.state.SecurityInfoState
+import mozilla.components.browser.state.state.TabSessionState
+import mozilla.components.browser.state.state.createTab
+import mozilla.components.browser.state.store.BrowserStore
+import mozilla.components.browser.toolbar.BrowserToolbar
+import mozilla.components.browser.toolbar.display.DisplayToolbar.Indicators
+import mozilla.components.support.test.ext.joinBlocking
+import mozilla.components.support.test.mock
+import mozilla.components.support.test.robolectric.testContext
+import mozilla.components.support.test.whenever
+import org.junit.After
+import org.junit.Assert.assertEquals
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mock
+import org.mockito.Mockito.doNothing
+import org.mockito.Mockito.spy
+import org.mockito.Mockito.times
+import org.mockito.Mockito.verify
+import org.mockito.MockitoAnnotations
+import org.mozilla.focus.fragment.BrowserFragment
+import org.robolectric.RobolectricTestRunner
+
+@RunWith(RobolectricTestRunner::class)
+class BrowserToolbarIntegrationTest {
+    private val testDispatcher = TestCoroutineDispatcher()
+    private val selectedTab = createSecureTab()
+
+    private lateinit var toolbar: BrowserToolbar
+
+    @Mock
+    private lateinit var fragment: BrowserFragment
+
+    private lateinit var browserToolbarIntegration: BrowserToolbarIntegration
+
+    private lateinit var store: BrowserStore
+
+    @Before
+    @ExperimentalCoroutinesApi
+    fun setUp() {
+        MockitoAnnotations.openMocks(this)
+        Dispatchers.setMain(testDispatcher)
+        store = spy(
+            BrowserStore(
+                initialState = BrowserState(
+                    tabs = listOf(selectedTab),
+                    selectedTabId = selectedTab.id
+                )
+            )
+        )
+
+        toolbar = BrowserToolbar(testContext)
+
+        whenever(fragment.resources).thenReturn(testContext.resources)
+        whenever(fragment.context).thenReturn(testContext)
+
+        browserToolbarIntegration = spy(
+            BrowserToolbarIntegration(
+                store,
+                toolbar,
+                fragment,
+                mock(),
+                mock(),
+                mock(),
+                { false },
+                inTesting = true
+            )
+        )
+    }
+
+    @After
+    @ExperimentalCoroutinesApi
+    fun tearDown() {
+        Dispatchers.resetMain()
+        testDispatcher.cleanupTestCoroutines()
+    }
+
+    @Test
+    fun `WHEN starting THEN observe security changes`() {
+
+        doNothing().`when`(browserToolbarIntegration).observerSecurityIndicatorChanges()
+
+        browserToolbarIntegration.start()
+
+        verify(browserToolbarIntegration).observerSecurityIndicatorChanges()
+    }
+
+    @Test
+    fun `WHEN stopping THEN stop observe security changes`() {
+
+        doNothing().`when`(browserToolbarIntegration).stopObserverSecurityIndicatorChanges()
+
+        browserToolbarIntegration.stop()
+
+        verify(browserToolbarIntegration).stopObserverSecurityIndicatorChanges()
+    }
+
+    @Test
+    fun `GIVEN an insecure site WHEN observing security changes THEN add the security icon`() {
+        browserToolbarIntegration.start()
+
+        updateSecurityStatus(secure = false)
+
+        verify(browserToolbarIntegration).addSecurityIndicator()
+        assertEquals(listOf(Indicators.SECURITY), toolbar.display.indicators)
+    }
+
+    @Test
+    fun `GIVEN an about site WHEN observing security changes THEN DO NOT add the security icon`() {
+        browserToolbarIntegration.start()
+
+        updateTabUrl("about:")
+
+        verify(browserToolbarIntegration, times(0)).addSecurityIndicator()
+        assertEquals(listOf(Indicators.TRACKING_PROTECTION), toolbar.display.indicators)
+    }
+
+    @Test
+    fun `GIVEN a secure site after a previous insecure site WHEN observing security changes THEN add the tracking protection icon`() {
+        browserToolbarIntegration.start()
+
+        updateSecurityStatus(secure = false)
+
+        verify(browserToolbarIntegration).addSecurityIndicator()
+
+        updateSecurityStatus(secure = true)
+
+        verify(browserToolbarIntegration).addTrackingProtectionIndicator()
+        assertEquals(listOf(Indicators.TRACKING_PROTECTION), toolbar.display.indicators)
+    }
+
+    private fun updateSecurityStatus(secure: Boolean) {
+        store.dispatch(
+            ContentAction.UpdateSecurityInfoAction(
+                selectedTab.id,
+                SecurityInfoState(
+                    secure = secure,
+                    host = "mozilla.org",
+                    issuer = "Mozilla"
+                )
+            )
+        ).joinBlocking()
+
+        testDispatcher.advanceUntilIdle()
+    }
+
+    private fun updateTabUrl(url: String) {
+        store.dispatch(
+            ContentAction.UpdateUrlAction(selectedTab.id, url)
+        ).joinBlocking()
+
+        testDispatcher.advanceUntilIdle()
+    }
+
+    private fun createSecureTab(): TabSessionState {
+        val tab = createTab("https://www.mozilla.org", id = "1")
+        return tab.copy(
+            content = tab.content.copy(securityInfo = SecurityInfoState(secure = true))
+        )
+    }
+}
