diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AdBlockingTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AdBlockingTest.java
index e29e4ae8a2f1..ce3807ce147c 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AdBlockingTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AdBlockingTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 
@@ -48,6 +49,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void AdBlockTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddtoHSTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddtoHSTest.java
index fc8154b628a5..b9baccf8edd0 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddtoHSTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddtoHSTest.java
@@ -15,11 +15,13 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Assert;
 import org.junit.Ignore;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
+import org.mozilla.focus.session.SessionManager;
 
 import java.io.IOException;
 
@@ -27,6 +29,7 @@
 import okhttp3.mockwebserver.MockWebServer;
 
 import static android.support.test.espresso.action.ViewActions.click;
+import static org.mozilla.focus.activity.TestHelper.mDevice;
 import static org.mozilla.focus.activity.TestHelper.waitingTime;
 import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
 
@@ -79,6 +82,11 @@ protected void afterActivityFinished() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     private UiObject titleMsg = TestHelper.mDevice.findObject(new UiSelector()
             .description("focus test page")
             .enabled(true));
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java
index 49755da91753..e210ebe8c395 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void BadURLcheckTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java
index 39d83d7b3c57..5f3a6816e673 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java
@@ -23,6 +23,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -70,6 +71,11 @@ public class CustomTabTest {
     public ActivityTestRule<MainActivity> activityTestRule  = new ActivityTestRule<>(
             MainActivity.class, true, false);
 
+    @After
+    public void tearDown() throws Exception {
+        activityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void testCustomTabUI() throws Exception {
         try {
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadTest.java
index 7fafbbe5ca77..cff6a7b3feb2 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Assert;
 import org.junit.Rule;
 import org.junit.Test;
@@ -80,6 +81,12 @@ protected void afterActivityFinished() {
             }
         }
     };
+
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     private UiObject titleMsg = TestHelper.mDevice.findObject(new UiSelector()
             .description("focus test page")
             .enabled(true));
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java
index 7aa775a43e87..a82d6a6a96e9 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java
@@ -18,6 +18,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -85,6 +86,12 @@ protected void afterActivityFinished() {
             }
         }
     };
+
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     private UiObject titleMsg = TestHelper.mDevice.findObject(new UiSelector()
             .description("focus test page")
             .enabled(true));
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/LocalSessionStorageTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/LocalSessionStorageTest.java
index 000e6c06f22a..8526341f58c0 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/LocalSessionStorageTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/LocalSessionStorageTest.java
@@ -15,6 +15,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -77,6 +78,11 @@ protected void afterActivityFinished() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     /**
      * Make sure that session storage values are kept and written but removed at the end of a session.
      */
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OnBoardingTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OnBoardingTest.java
index 9bd853ad8977..dbd149e97195 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OnBoardingTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OnBoardingTest.java
@@ -14,6 +14,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -43,6 +44,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void OnBoardingTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenwithDialogTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenwithDialogTest.java
index 9b31f1d92a79..a2e204e0eec4 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenwithDialogTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenwithDialogTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void OpenTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/PageVisitTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/PageVisitTest.java
index 03a6ab0f7c33..7593db19cfa3 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/PageVisitTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/PageVisitTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void visitPagesTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/RestartTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/RestartTest.java
index 714d7f428f30..e60bc35853a2 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/RestartTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/RestartTest.java
@@ -20,6 +20,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -92,6 +93,11 @@ protected void afterActivityFinished() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void restartFocus() throws InterruptedException, UiObjectNotFoundException, RemoteException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SearchEngineSelectionTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SearchEngineSelectionTest.java
index 5f156f8bdd55..fc666181d57d 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SearchEngineSelectionTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SearchEngineSelectionTest.java
@@ -15,6 +15,7 @@
 import android.support.test.uiautomator.UiScrollable;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void SearchTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsAppearanceTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsAppearanceTest.java
index 3b936659ed6c..07bf33c54c96 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsAppearanceTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsAppearanceTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void settingsScreenTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareDialogTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareDialogTest.java
index 1c93bbfe08c9..9e5962347977 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareDialogTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareDialogTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -46,6 +47,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void shareTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java
index 9f1a8c1a37e3..bd37bb508fc4 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java
@@ -18,6 +18,7 @@
 import android.support.test.uiautomator.UiSelector;
 import android.support.test.uiautomator.Until;
 
+import org.junit.After;
 import org.junit.Assert;
 import org.junit.Rule;
 import org.junit.Test;
@@ -85,6 +86,11 @@ protected void afterActivityFinished() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     private UiObject titleMsg = TestHelper.mDevice.findObject(new UiSelector()
             .description("focus test page")
             .enabled(true));
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java
index 8d34e5552066..7020975322d8 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java
@@ -17,6 +17,7 @@
 import android.support.test.uiautomator.UiScrollable;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Assert;
 import org.junit.Rule;
 import org.junit.Test;
@@ -55,6 +56,11 @@ protected void beforeActivityLaunched() {
     public SwitchLocaleTest() throws UiObjectNotFoundException {
     }
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @SuppressWarnings("deprecation")
     public void changeLocale(String locale) {
         Context context = InstrumentationRegistry.getInstrumentation()
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java
index 289e0aebb60c..aea82e301e73 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java
@@ -12,6 +12,7 @@
 import android.support.test.runner.AndroidJUnit4;
 import android.support.test.uiautomator.UiObjectNotFoundException;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -47,6 +48,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void SimpleToggleTest() throws UiObjectNotFoundException {
         // Open mozilla webpage
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TrashcanTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TrashcanTest.java
index 30a4940ae141..9bb7c447cd39 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TrashcanTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TrashcanTest.java
@@ -16,6 +16,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.Until;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -51,6 +52,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void TrashTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TypicalUseScenarioTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TypicalUseScenarioTest.java
index 4279a1d144ef..e948ddc162b2 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TypicalUseScenarioTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/TypicalUseScenarioTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -45,6 +46,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void TypicalUseTest() throws InterruptedException, UiObjectNotFoundException {
 
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLCompletionTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLCompletionTest.java
index bf9c89a8d6e4..be3271ce4625 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLCompletionTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLCompletionTest.java
@@ -12,6 +12,7 @@
 import android.support.test.runner.AndroidJUnit4;
 import android.support.test.uiautomator.UiObjectNotFoundException;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -42,6 +43,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void CompletionTest() throws InterruptedException, UiObjectNotFoundException {
         /* type a partial url, and check it autocompletes*/
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java
index 00ea95359670..e1aecbbc385c 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java
@@ -14,6 +14,7 @@
 import android.support.test.uiautomator.UiObjectNotFoundException;
 import android.support.test.uiautomator.UiSelector;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -49,6 +50,11 @@ protected void beforeActivityLaunched() {
         }
     };
 
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
+
     @Test
     public void MismatchTest() throws InterruptedException, UiObjectNotFoundException {
         final long waitingTime = TestHelper.waitingTime * 3;
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/WebViewDataTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/WebViewDataTest.java
index 462c507e8f70..c16bd5052cb1 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/WebViewDataTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/WebViewDataTest.java
@@ -16,6 +16,7 @@
 
 import junit.framework.Assert;
 
+import org.junit.After;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -132,7 +133,10 @@ protected void afterActivityFinished() {
         }
     };
 
-
+    @After
+    public void tearDown() throws Exception {
+        mActivityTestRule.getActivity().finishAndRemoveTask();
+    }
 
     @Test
     public void DeleteWebViewDataTest() throws InterruptedException, UiObjectNotFoundException, IOException {
diff --git a/focus-android/app/src/gecko/java/org/mozilla/focus/web/WebViewProvider.java b/focus-android/app/src/gecko/java/org/mozilla/focus/web/WebViewProvider.java
index fe256af9a158..10d3f8ccc7c8 100644
--- a/focus-android/app/src/gecko/java/org/mozilla/focus/web/WebViewProvider.java
+++ b/focus-android/app/src/gecko/java/org/mozilla/focus/web/WebViewProvider.java
@@ -10,6 +10,7 @@
 import android.graphics.Color;
 import android.os.Bundle;
 import android.os.SystemClock;
+import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.support.v4.view.MotionEventCompat;
 import android.support.v4.view.NestedScrollingChild;
@@ -21,6 +22,7 @@
 import android.view.MotionEvent;
 import android.view.View;
 
+import org.mozilla.focus.session.Session;
 import org.mozilla.gecko.GeckoProfile;
 import org.mozilla.gecko.GeckoThread;
 import org.mozilla.gecko.GeckoView;
@@ -112,16 +114,6 @@ public boolean isBlockingEnabled() {
             return true;
         }
 
-        @Override
-        public void saveWebViewState(Bundle outState) {
-            // TODO: save anything needed for navigation history restoration.
-        }
-
-        @Override
-        public void restoreWebViewState(Bundle inState) {
-            // TODO: restore navigation history, and reopen previously opened page
-        }
-
         private ContentListener createContentListener() {
             return new ContentListener() {
                 @Override
@@ -191,6 +183,16 @@ public boolean canGoBack() {
             return canGoBack;
         }
 
+        @Override
+        public void restoreWebViewState(Session session, Bundle inState) {
+            // TODO: restore navigation history, and reopen previously opened page
+        }
+
+        @Override
+        public void saveWebViewState(@NonNull Session session, @NonNull Bundle outState) {
+            // TODO: save anything needed for navigation history restoration.
+        }
+
         @Override
         public String getTitle() {
             return "?";
diff --git a/focus-android/app/src/main/AndroidManifest.xml b/focus-android/app/src/main/AndroidManifest.xml
index d099f1ab1ce2..7693c3620019 100644
--- a/focus-android/app/src/main/AndroidManifest.xml
+++ b/focus-android/app/src/main/AndroidManifest.xml
@@ -31,7 +31,7 @@
         <activity android:name=".activity.MainActivity"
             android:launchMode="singleTask"
             android:configChanges="keyboard|keyboardHidden|mcc|mnc|orientation|screenSize|locale|layoutDirection|smallestScreenSize|screenLayout"
-            android:windowSoftInputMode="adjustResize"
+            android:windowSoftInputMode="adjustResize|stateAlwaysHidden"
             android:label="@string/app_name">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
@@ -65,7 +65,7 @@
             </intent-filter>
 
             <meta-data android:name="android.app.shortcuts" android:resource="@xml/shortcuts" />
-        </activity>"
+        </activity>
 
         <activity android:name=".activity.TextActionActivity"
             android:label="@string/text_selection_search_action"
@@ -88,6 +88,9 @@
         <activity android:name=".activity.InstallFirefoxActivity"
             android:theme="@style/Theme.AppCompat.NoActionBar" />
 
+        <activity android:name=".activity.EraseShortcutActivity"
+            android:theme="@android:style/Theme.Translucent" />
+
         <service
             android:name=".customtabs.CustomTabsService"
             android:exported="true"
@@ -97,7 +100,7 @@
             </intent-filter>
         </service>
 
-        <service android:name=".notification.BrowsingNotificationService"
+        <service android:name=".session.SessionNotificationService"
             android:exported="false" />
 
         <meta-data android:name="android.webkit.WebView.MetricsOptOut"
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.java b/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.java
index 29bac6d65726..28aa8e4f7ef9 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/FocusApplication.java
@@ -5,14 +5,27 @@
 
 package org.mozilla.focus;
 
+import android.arch.lifecycle.LiveData;
+import android.arch.lifecycle.Observer;
 import android.os.StrictMode;
 import android.preference.PreferenceManager;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
 
+import org.mozilla.focus.architecture.NonNullObserver;
 import org.mozilla.focus.locale.LocaleAwareApplication;
 import org.mozilla.focus.search.SearchEngineManager;
+import org.mozilla.focus.session.NotificationSessionObserver;
+import org.mozilla.focus.session.Session;
+import org.mozilla.focus.session.SessionManager;
+import org.mozilla.focus.session.SessionNotificationService;
+import org.mozilla.focus.telemetry.TelemetrySessionObserver;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
 import org.mozilla.focus.utils.AdjustHelper;
 import org.mozilla.focus.utils.AppConstants;
+import org.mozilla.focus.web.CleanupSessionObserver;
+
+import java.util.List;
 
 public class FocusApplication extends LocaleAwareApplication {
 
@@ -28,6 +41,11 @@ public void onCreate() {
 
         TelemetryWrapper.init(this);
         AdjustHelper.setupAdjustIfNeeded(this);
+
+        final LiveData<List<Session>> sessions = SessionManager.getInstance().getSessions();
+        sessions.observeForever(new NotificationSessionObserver(this));
+        sessions.observeForever(new TelemetrySessionObserver());
+        sessions.observeForever(new CleanupSessionObserver(this));
     }
 
     private void enableStrictMode() {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.java b/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.java
new file mode 100644
index 000000000000..da24659a06a0
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/EraseShortcutActivity.java
@@ -0,0 +1,24 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity;
+
+import android.app.Activity;
+import android.os.Bundle;
+import android.support.annotation.Nullable;
+
+import org.mozilla.focus.session.SessionManager;
+import org.mozilla.focus.telemetry.TelemetryWrapper;
+
+public class EraseShortcutActivity extends Activity {
+    @Override
+    protected void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+
+        SessionManager.getInstance().removeAllSessions();
+
+        TelemetryWrapper.eraseShortcutEvent();
+
+        finishAndRemoveTask();
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/LifecycleAppCompatActivity.java b/focus-android/app/src/main/java/org/mozilla/focus/activity/LifecycleAppCompatActivity.java
new file mode 100644
index 000000000000..6bfe22381ea3
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/LifecycleAppCompatActivity.java
@@ -0,0 +1,21 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.activity;
+
+import android.arch.lifecycle.LifecycleRegistry;
+import android.arch.lifecycle.LifecycleRegistryOwner;
+import android.support.v7.app.AppCompatActivity;
+
+/**
+ * This class is a temporary implementation detail until Lifecycles are integrated with support library.
+ */
+public abstract class LifecycleAppCompatActivity extends AppCompatActivity implements LifecycleRegistryOwner {
+    final LifecycleRegistry lifecycleRegistry = new LifecycleRegistry(this);
+
+    @Override
+    public LifecycleRegistry getLifecycle() {
+        return lifecycleRegistry;
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.java b/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.java
index 30eac3a67647..68ebb900f45a 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/activity/MainActivity.java
@@ -8,38 +8,45 @@
 import android.content.Context;
 import android.content.Intent;
 import android.os.Bundle;
+import android.support.annotation.NonNull;
 import android.support.v4.app.FragmentManager;
-import android.text.TextUtils;
+import android.support.v4.app.FragmentTransaction;
 import android.util.AttributeSet;
 import android.view.View;
 import android.view.WindowManager;
+import android.widget.Toast;
 
 import org.mozilla.focus.R;
+import org.mozilla.focus.architecture.NonNullObserver;
 import org.mozilla.focus.fragment.BrowserFragment;
 import org.mozilla.focus.fragment.FirstrunFragment;
 import org.mozilla.focus.fragment.UrlInputFragment;
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity;
-import org.mozilla.focus.notification.BrowsingNotificationService;
-import org.mozilla.focus.shortcut.HomeScreen;
+import org.mozilla.focus.session.Session;
+import org.mozilla.focus.session.SessionManager;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
 import org.mozilla.focus.utils.SafeIntent;
 import org.mozilla.focus.utils.Settings;
-import org.mozilla.focus.utils.UrlUtils;
-import org.mozilla.focus.web.BrowsingSession;
+import org.mozilla.focus.utils.ViewUtils;
 import org.mozilla.focus.web.IWebView;
 import org.mozilla.focus.web.WebViewProvider;
 
+import java.util.List;
+
 public class MainActivity extends LocaleAwareAppCompatActivity {
     public static final String ACTION_ERASE = "erase";
     public static final String ACTION_OPEN = "open";
 
-    public static final String EXTRA_FINISH = "finish";
     public static final String EXTRA_TEXT_SELECTION = "text_selection";
     public static final String EXTRA_NOTIFICATION = "notification";
 
     private static final String EXTRA_SHORTCUT = "shortcut";
 
-    private String pendingUrl;
+    private final SessionManager sessionManager;
+
+    public MainActivity() {
+        sessionManager = SessionManager.getInstance();
+    }
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
@@ -49,47 +56,32 @@ protected void onCreate(Bundle savedInstanceState) {
             getWindow().addFlags(WindowManager.LayoutParams.FLAG_SECURE);
         }
 
-        getWindow().getDecorView().setSystemUiVisibility(
-                View.SYSTEM_UI_FLAG_LAYOUT_STABLE | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN);
+        getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_STABLE | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN);
 
         setContentView(R.layout.activity_main);
 
-        SafeIntent intent = new SafeIntent(getIntent());
-
-        if ((intent.getFlags() & Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) != 0
-                && !BrowsingSession.getInstance().isActive()) {
-            // This Intent was launched from history (recent apps). Android will redeliver the
-            // original Intent (which might be a VIEW intent). However if there's no active browsing
-            // session then we do not want to re-process the Intent and potentially re-open a website
-            // from a session that the user already "erased".
-            intent = new SafeIntent(new Intent(Intent.ACTION_MAIN));
-            setIntent(intent.getUnsafe());
-        }
-
-        if (savedInstanceState == null) {
-            WebViewProvider.performCleanup(this);
-
-            if (Intent.ACTION_VIEW.equals(intent.getAction())) {
-                final String url = intent.getDataString();
+        final SafeIntent intent = new SafeIntent(getIntent());
 
-                BrowsingSession.getInstance().loadCustomTabConfig(this, intent);
+        sessionManager.handleIntent(this, intent, savedInstanceState);
 
-                if (Settings.getInstance(this).shouldShowFirstrun()) {
-                    pendingUrl = url;
-                    showFirstrun();
+        sessionManager.getSessions().observe(this,  new NonNullObserver<List<Session>>() {
+            @Override
+            public void onValueChanged(@NonNull List<Session> sessions) {
+                if (sessions.isEmpty()) {
+                    // There's no active session. Show the URL input screen so that the user can
+                    // start a new session.
+                    showUrlInputScreen();
                 } else {
-                    showBrowserScreen(url);
+                    // We have at least one session. Show a fragment for the current session.
+                    showBrowserScreenForCurrentSession();
                 }
-            } else if (Intent.ACTION_SEND.equals(intent.getAction())) {
-                setPendingUrlFromShareIntent(intent);
-            } else {
-                if (Settings.getInstance(this).shouldShowFirstrun()) {
+
+                // If needed show the first run tour on top of the browser or url input fragment.
+                if (Settings.getInstance(MainActivity.this).shouldShowFirstrun()) {
                     showFirstrun();
-                } else {
-                    showHomeScreen();
                 }
             }
-        }
+        });
 
         WebViewProvider.preload(this);
     }
@@ -99,13 +91,6 @@ public void applyLocale() {
         // We don't care here: all our fragments update themselves as appropriate
     }
 
-    @Override
-    protected void onStart() {
-        super.onStart();
-
-        BrowsingNotificationService.foreground(this);
-    }
-
     @Override
     protected void onResume() {
         super.onResume();
@@ -134,80 +119,31 @@ protected void onPause() {
     protected void onStop() {
         super.onStop();
 
-        BrowsingNotificationService.background(this);
-
         TelemetryWrapper.stopMainActivity();
     }
 
     @Override
     protected void onNewIntent(Intent unsafeIntent) {
         final SafeIntent intent = new SafeIntent(unsafeIntent);
-        if (Intent.ACTION_VIEW.equals(intent.getAction())) {
-            // We can't update our fragment right now because we need to wait until the activity is
-            // resumed. So just remember this URL and load it in onResumeFragments().
-            pendingUrl = intent.getDataString();
-        }
 
-        if (Intent.ACTION_SEND.equals(intent.getAction())) {
-            setPendingUrlFromShareIntent(intent);
-        }
+        sessionManager.handleNewIntent(this, intent);
 
-        if (ACTION_OPEN.equals(intent.getAction())) {
+        final String action = intent.getAction();
+
+        if (ACTION_OPEN.equals(action)) {
             TelemetryWrapper.openNotificationActionEvent();
         }
 
-        // We do not care about the previous intent anymore. But let's remember this one.
-        setIntent(unsafeIntent);
-        BrowsingSession.getInstance().loadCustomTabConfig(this, intent);
-    }
-
-    @Override
-    protected void onResumeFragments() {
-        super.onResumeFragments();
-
-        final SafeIntent intent = new SafeIntent(getIntent());
-
-        if (ACTION_ERASE.equals(intent.getAction())) {
+        if (ACTION_ERASE.equals(action)) {
             processEraseAction(intent);
-
-            // We do not want to erase again the next time we resume the app.
-            setIntent(new Intent(Intent.ACTION_MAIN));
-        }
-
-        if (pendingUrl != null && !Settings.getInstance(this).shouldShowFirstrun()) {
-            // We have received an URL in onNewIntent(). Let's load it now.
-            // Unless we're trying to show the firstrun screen, in which case we leave it pending until
-            // firstrun is dismissed.
-            showBrowserScreen(pendingUrl);
-            pendingUrl = null;
         }
     }
 
     private void processEraseAction(final SafeIntent intent) {
-        final boolean finishActivity = intent.getBooleanExtra(EXTRA_FINISH, false);
         final boolean fromShortcut = intent.getBooleanExtra(EXTRA_SHORTCUT, false);
         final boolean fromNotification = intent.getBooleanExtra(EXTRA_NOTIFICATION, false);
 
-        final BrowserFragment browserFragment = (BrowserFragment) getSupportFragmentManager()
-                .findFragmentByTag(BrowserFragment.FRAGMENT_TAG);
-
-        if (browserFragment != null) {
-            // We are currently displaying a browser fragment. Let the fragment handle the erase and
-            // play its animation.
-            browserFragment.eraseAndShowHomeScreen(!fromNotification);
-        } else {
-            // There's no fragment available currently. Let's delete manually and notify the service
-            // that the session should have ended (normally the fragment would do both).
-            WebViewProvider.performCleanup(this);
-            BrowsingNotificationService.stop(this);
-        }
-
-        // The service will track the foreground/background state of our activity. If we are erasing
-        // while the activity is in the background then we want to finish it immediately again.
-        if (finishActivity) {
-            finishAndRemoveTask();
-            overridePendingTransition(0, 0); // This activity should be visible - avoid any animations.
-        }
+        SessionManager.getInstance().removeAllSessions();
 
         if (fromShortcut) {
             TelemetryWrapper.eraseShortcutEvent();
@@ -216,54 +152,67 @@ private void processEraseAction(final SafeIntent intent) {
         }
     }
 
-    private void showHomeScreen() {
-        // We add the url input fragment to the layout if it doesn't exist yet. I tried adding the
-        // fragment to the layout directly but then I wasn't able to remove it later. It was still
-        // visible but without an activity attached. So let's do it manually.
+    private void showUrlInputScreen() {
         final FragmentManager fragmentManager = getSupportFragmentManager();
-        if (fragmentManager.findFragmentByTag(UrlInputFragment.FRAGMENT_TAG) == null) {
-            fragmentManager
-                    .beginTransaction()
-                    .replace(R.id.container, UrlInputFragment.createWithBackground(), UrlInputFragment.FRAGMENT_TAG)
-                    .commit();
+        final BrowserFragment browserFragment = (BrowserFragment) fragmentManager.findFragmentByTag(BrowserFragment.FRAGMENT_TAG);
+
+        final boolean isShowingBrowser = browserFragment != null;
+
+        if (isShowingBrowser) {
+            ViewUtils.showBrandedSnackbar(findViewById(android.R.id.content),
+                    R.string.feedback_erase,
+                    getResources().getInteger(R.integer.erase_snackbar_delay));
         }
-    }
 
-    private void showFirstrun() {
-        final FragmentManager fragmentManager = getSupportFragmentManager();
-        if (fragmentManager.findFragmentByTag(FirstrunFragment.FRAGMENT_TAG) == null) {
-            fragmentManager
-                    .beginTransaction()
-                    .replace(R.id.container, FirstrunFragment.create(), FirstrunFragment.FRAGMENT_TAG)
-                    .commit();
+        // We add the url input fragment to the layout if it doesn't exist yet.
+        final FragmentTransaction transaction = fragmentManager
+                .beginTransaction();
+
+        // We only want to play the animation if a browser fragment is added and resumed.
+        // If it is not resumed then the application is currently in the process of resuming
+        // and the session was removed while the app was in the background (e.g. via the
+        // notification). In this case we do not want to show the content and remove the
+        // browser fragment immediately.
+        boolean shouldAnimate = isShowingBrowser && browserFragment.isResumed();
+
+        if (shouldAnimate) {
+            transaction.setCustomAnimations(0, R.anim.erase_animation);
         }
+
+        transaction
+                .replace(R.id.container, UrlInputFragment.createWithoutSession(), UrlInputFragment.FRAGMENT_TAG)
+                .commit();
     }
 
-    private void showBrowserScreen(String url) {
+    private void showFirstrun() {
         getSupportFragmentManager()
                 .beginTransaction()
-                .replace(R.id.container,
-                        BrowserFragment.create(url), BrowserFragment.FRAGMENT_TAG)
+                .add(R.id.container, FirstrunFragment.create(), FirstrunFragment.FRAGMENT_TAG)
                 .commit();
+    }
 
-        final SafeIntent intent = new SafeIntent(getIntent());
+    private void showBrowserScreenForCurrentSession() {
+        final Session currentSession = sessionManager.getCurrentSession();
+        final FragmentManager fragmentManager = getSupportFragmentManager();
 
-        if (intent.getBooleanExtra(EXTRA_TEXT_SELECTION, false)) {
-            TelemetryWrapper.textSelectionIntentEvent();
-        } else if (intent.hasExtra(HomeScreen.ADD_TO_HOMESCREEN_TAG)) {
-            TelemetryWrapper.openHomescreenShortcutEvent();
-        } else if (BrowsingSession.getInstance().isCustomTab()) {
-            TelemetryWrapper.customTabsIntentEvent(BrowsingSession.getInstance().getCustomTabConfig().getOptionsList());
-        } else {
-            TelemetryWrapper.browseIntentEvent();
+        final BrowserFragment fragment = (BrowserFragment) fragmentManager.findFragmentByTag(BrowserFragment.FRAGMENT_TAG);
+        if (fragment != null && fragment.getSession().isSameAs(currentSession)) {
+            // There's already a BrowserFragment displaying this session.
+            return;
         }
+
+        fragmentManager
+                .beginTransaction()
+                .replace(R.id.container,
+                        BrowserFragment.createForSession(currentSession), BrowserFragment.FRAGMENT_TAG)
+                .commit();
     }
 
     @Override
     public View onCreateView(String name, Context context, AttributeSet attrs) {
         if (name.equals(IWebView.class.getName())) {
-            View v = WebViewProvider.create(this, attrs);
-            return v;
+            // Inject our implementation of IWebView from the WebViewProvider.
+            return WebViewProvider.create(this, attrs);
         }
 
         return super.onCreateView(name, context, attrs);
@@ -293,25 +242,4 @@ public void onBackPressed() {
 
         super.onBackPressed();
     }
-
-    public void firstrunFinished() {
-        if (pendingUrl != null) {
-            // We have received an URL in onNewIntent(). Let's load it now.
-            showBrowserScreen(pendingUrl);
-            pendingUrl = null;
-        } else {
-            showHomeScreen();
-        }
-    }
-
-    public void setPendingUrlFromShareIntent(SafeIntent shareIntent) {
-        final String dataString = shareIntent.getStringExtra(Intent.EXTRA_TEXT);
-        if (!TextUtils.isEmpty(dataString)) {
-            final boolean isUrl = UrlUtils.isUrl(dataString);
-            TelemetryWrapper.shareIntentEvent(isUrl);
-            // We can't update our fragment right now because we need to wait until the activity is
-            // resumed. So just remember this URL and load it in onResumeFragments().
-            pendingUrl = isUrl ? dataString : UrlUtils.createSearchUrl(this, dataString);
-        }
-    }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.java b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.java
new file mode 100644
index 000000000000..3a0ebc7565b3
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullLiveData.java
@@ -0,0 +1,49 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.architecture;
+
+import android.arch.lifecycle.LiveData;
+import android.support.annotation.NonNull;
+
+public class NonNullLiveData<T> extends LiveData<T> {
+    public NonNullLiveData(final T initialValue) {
+        setValue(initialValue);
+    }
+
+    /**
+     * Returns the current (non-null) value. Note that calling this method on a background thread
+     * does not guarantee that the latest value set will be received.
+     */
+    @NonNull
+    public T getValue() {
+        final T value = super.getValue();
+        if (value == null) {
+            throw new IllegalStateException("Value is null");
+        }
+        return value;
+    }
+
+    /**
+     * Posts a task to a main thread to set the given (non null) value.
+     */
+    @Override
+    protected void postValue(T value) {
+        if (value == null) {
+            throw new IllegalArgumentException("Value cannot be null");
+        }
+        super.postValue(value);
+    }
+
+    /**
+     * Sets the (non-null) value. If there are active observers, the value will be dispatched to them.
+     */
+    @Override
+    protected void setValue(T value) {
+        if (value == null) {
+            throw new IllegalArgumentException("Value cannot be null");
+        }
+        super.setValue(value);
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.java b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.java
new file mode 100644
index 000000000000..f49dcbc454c8
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullMutableLiveData.java
@@ -0,0 +1,27 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.architecture;
+
+public class NonNullMutableLiveData<T> extends NonNullLiveData<T> {
+    public NonNullMutableLiveData(T initialValue) {
+        super(initialValue);
+    }
+
+    /**
+     * Posts a task to a main thread to set the given (non-null) value.
+     */
+    @Override
+    public void postValue(T value) {
+        super.postValue(value);
+    }
+
+    /**
+     * Sets the (non-null) value. If there are active observers, the value will be dispatched to them.
+     */
+    @Override
+    public void setValue(T value) {
+        super.setValue(value);
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.java
new file mode 100644
index 000000000000..281b0fb9346f
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/architecture/NonNullObserver.java
@@ -0,0 +1,22 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.architecture;
+
+import android.arch.lifecycle.Observer;
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+
+public abstract class NonNullObserver<T> implements Observer<T> {
+    protected abstract void onValueChanged(@NonNull T t);
+
+    @Override
+    public final void onChanged(@Nullable T value) {
+        if (value == null) {
+            return;
+        }
+
+        onValueChanged(value);
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/CustomTabConfig.java b/focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java
similarity index 96%
rename from focus-android/app/src/main/java/org/mozilla/focus/web/CustomTabConfig.java
rename to focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java
index c81571827948..e709354bcaf1 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/CustomTabConfig.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/customtabs/CustomTabConfig.java
@@ -1,4 +1,8 @@
-package org.mozilla.focus.web;
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.customtabs;
 
 import android.app.PendingIntent;
 import android.content.Context;
@@ -74,7 +78,7 @@ public CustomTabMenuItem(final @NonNull String name, final @NonNull PendingInten
         this.unsupportedFeatureList = unsupportedFeatureList;
     }
 
-    /* package-private */ static boolean isCustomTabIntent(final @NonNull SafeIntent intent) {
+    public static boolean isCustomTabIntent(final @NonNull SafeIntent intent) {
         return intent.hasExtra(CustomTabsIntent.EXTRA_SESSION);
     }
 
@@ -140,7 +144,7 @@ public CustomTabMenuItem(final @NonNull String name, final @NonNull PendingInten
         return new ActionButtonConfig(description, icon, pendingIntent);
     }
 
-    /* package-private */ static CustomTabConfig parseCustomTabIntent(final @NonNull Context context, final @NonNull SafeIntent intent) {
+    public static CustomTabConfig parseCustomTabIntent(final @NonNull Context context, final @NonNull SafeIntent intent) {
         @ColorInt Integer toolbarColor = null;
         if (intent.hasExtra(CustomTabsIntent.EXTRA_TOOLBAR_COLOR)) {
             toolbarColor = intent.getIntExtra(CustomTabsIntent.EXTRA_TOOLBAR_COLOR, -1);
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.java
index 18aad85118b5..1ac4eacad0ee 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/BrowserFragment.java
@@ -9,6 +9,7 @@
 import android.app.Activity;
 import android.app.DownloadManager;
 import android.app.PendingIntent;
+import android.arch.lifecycle.Observer;
 import android.content.Context;
 import android.content.Intent;
 import android.content.IntentFilter;
@@ -26,7 +27,6 @@
 import android.support.v4.app.DialogFragment;
 import android.support.v4.app.Fragment;
 import android.support.v4.app.FragmentManager;
-import android.support.v4.app.FragmentTransaction;
 import android.support.v4.content.ContextCompat;
 import android.view.LayoutInflater;
 import android.view.View;
@@ -45,21 +45,24 @@
 import org.mozilla.focus.activity.InfoActivity;
 import org.mozilla.focus.activity.InstallFirefoxActivity;
 import org.mozilla.focus.animation.TransitionDrawableGroup;
+import org.mozilla.focus.architecture.NonNullObserver;
 import org.mozilla.focus.broadcastreceiver.DownloadBroadcastReceiver;
+import org.mozilla.focus.customtabs.CustomTabConfig;
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity;
 import org.mozilla.focus.menu.BrowserMenu;
 import org.mozilla.focus.menu.WebContextMenu;
-import org.mozilla.focus.notification.BrowsingNotificationService;
 import org.mozilla.focus.open.OpenWithFragment;
+import org.mozilla.focus.session.NullSession;
+import org.mozilla.focus.session.Session;
+import org.mozilla.focus.session.SessionCallbackProxy;
+import org.mozilla.focus.session.SessionManager;
+import org.mozilla.focus.session.Source;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
 import org.mozilla.focus.utils.Browsers;
 import org.mozilla.focus.utils.ColorUtils;
 import org.mozilla.focus.utils.DrawableUtils;
 import org.mozilla.focus.utils.IntentUtils;
 import org.mozilla.focus.utils.UrlUtils;
-import org.mozilla.focus.utils.ViewUtils;
-import org.mozilla.focus.web.BrowsingSession;
-import org.mozilla.focus.web.CustomTabConfig;
 import org.mozilla.focus.web.Download;
 import org.mozilla.focus.web.IWebView;
 import org.mozilla.focus.widget.AnimatedProgressBar;
@@ -74,12 +77,13 @@ public class BrowserFragment extends WebFragment implements View.OnClickListener
 
     private static int REQUEST_CODE_STORAGE_PERMISSION = 101;
     private static final int ANIMATION_DURATION = 300;
-    private static final String ARGUMENT_URL = "url";
+
+    private static final String ARGUMENT_SESSION_UUID = "sessionUUID";
     private static final String RESTORE_KEY_DOWNLOAD = "download";
 
-    public static BrowserFragment create(String url) {
-        Bundle arguments = new Bundle();
-        arguments.putString(ARGUMENT_URL, url);
+    public static BrowserFragment createForSession(Session session) {
+        final Bundle arguments = new Bundle();
+        arguments.putString(ARGUMENT_SESSION_UUID, session.getUUID());
 
         BrowserFragment fragment = new BrowserFragment();
         fragment.setArguments(arguments);
@@ -115,21 +119,54 @@ public static BrowserFragment create(String url) {
 
     private IWebView.FullscreenCallback fullscreenCallback;
 
-    private boolean isLoading = false;
-
     private DownloadManager manager;
 
     private DownloadBroadcastReceiver downloadBroadcastReceiver;
 
-    // Set an initial WeakReference so we never have to handle loadStateListenerWeakReference being null
-    // (i.e. so we can always just .get()).
-    private WeakReference<LoadStateListener> loadStateListenerWeakReference = new WeakReference<>(null);
+    private SessionManager sessionManager;
+    private Session session;
+
+    public BrowserFragment() {
+        sessionManager = SessionManager.getInstance();
+    }
 
     @Override
-    public void onAttach(Context context) {
-        super.onAttach(context);
+    public void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+
+        final String sessionUUID = getArguments().getString(ARGUMENT_SESSION_UUID);
+        if (sessionUUID == null) {
+            throw new IllegalAccessError("No session exists");
+        }
+
+        session = sessionManager.hasSessionWithUUID(sessionUUID)
+                ? sessionManager.getSessionByUUID(sessionUUID)
+                : new NullSession();
 
-        BrowsingNotificationService.start(context);
+        session.getBlockedTrackers().observe(this, new Observer<Integer>() {
+            @Override
+            public void onChanged(@Nullable Integer blockedTrackers) {
+                if (menuWeakReference == null) {
+                    return;
+                }
+
+                final BrowserMenu menu = menuWeakReference.get();
+
+                if (menu != null) {
+                    //noinspection ConstantConditions - Not null
+                    menu.updateTrackers(blockedTrackers);
+                }
+            }
+        });
+    }
+
+    public Session getSession() {
+        return session;
+    }
+
+    @Override
+    public String getInitialUrl() {
+        return session.getUrl().getValue();
     }
 
     @Override
@@ -145,15 +182,6 @@ public void onPause() {
         }
     }
 
-    @Override
-    public String getInitialUrl() {
-        return getArguments().getString(ARGUMENT_URL);
-    }
-
-    private void updateURL(final String url) {
-        urlView.setText(UrlUtils.stripUserInfo(url));
-    }
-
     @Override
     public View inflateLayout(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
         if (savedInstanceState != null && savedInstanceState.containsKey(RESTORE_KEY_DOWNLOAD)) {
@@ -171,7 +199,13 @@ public View inflateLayout(LayoutInflater inflater, @Nullable ViewGroup container
         statusBar = view.findViewById(R.id.status_bar_background);
 
         urlView = (TextView) view.findViewById(R.id.display_url);
-        updateURL(getInitialUrl());
+
+        session.getUrl().observe(this, new Observer<String>() {
+            @Override
+            public void onChanged(@Nullable String url) {
+                urlView.setText(UrlUtils.stripUserInfo(url));
+            }
+        });
 
         final View toolbarContent = view.findViewById(R.id.toolbar_content);
 
@@ -212,6 +246,33 @@ public void onOffsetChanged(AppBarLayout appBarLayout, int verticalOffset) {
                 (TransitionDrawable) statusBar.getBackground()
         );
 
+        session.getLoading().observe(this, new NonNullObserver<Boolean>() {
+            @Override
+            public void onValueChanged(@NonNull Boolean loading) {
+                if (loading) {
+                    backgroundTransitionGroup.resetTransition();
+
+                    progressView.setProgress(5);
+                    progressView.setVisibility(View.VISIBLE);
+
+
+                } else {
+                    backgroundTransitionGroup.startTransition(ANIMATION_DURATION);
+
+                    progressView.setVisibility(View.GONE);
+                }
+
+                updateBlockingBadging(loading || isBlockingEnabled());
+
+                updateToolbarButtonStates(loading);
+
+                final BrowserMenu menu = menuWeakReference.get();
+                if (menu != null) {
+                    menu.updateLoading(loading);
+                }
+            }
+        });
+
         if ((refreshButton = view.findViewById(R.id.refresh)) != null) {
             refreshButton.setOnClickListener(this);
         }
@@ -234,13 +295,25 @@ public void onOffsetChanged(AppBarLayout appBarLayout, int verticalOffset) {
         blockView = (FrameLayout) view.findViewById(R.id.block);
 
         lockView = (ImageView) view.findViewById(R.id.lock);
+        session.getSecure().observe(this, new Observer<Boolean>() {
+            @Override
+            public void onChanged(Boolean secure) {
+                lockView.setVisibility(secure ? View.VISIBLE : View.GONE);
+            }
+        });
 
         progressView = (AnimatedProgressBar) view.findViewById(R.id.progress);
+        session.getProgress().observe(this, new Observer<Integer>() {
+            @Override
+            public void onChanged(Integer progress) {
+                progressView.setProgress(progress);
+            }
+        });
 
         menuView = (ImageButton) view.findViewById(R.id.menu);
         menuView.setOnClickListener(this);
 
-        if (BrowsingSession.getInstance().isCustomTab()) {
+        if (session.isCustomTab()) {
             initialiseCustomTabUi(view);
         } else {
             initialiseNormalBrowserUi(view);
@@ -257,7 +330,7 @@ private void initialiseNormalBrowserUi(final @NonNull View view) {
     }
 
     private void initialiseCustomTabUi(final @NonNull View view) {
-        final CustomTabConfig customTabConfig = BrowsingSession.getInstance().getCustomTabConfig();
+        final CustomTabConfig customTabConfig = session.getCustomTabConfig();
 
         // Unfortunately there's no simpler way to have the FAB only in normal-browser mode.
         // - ViewStub: requires splitting attributes for the FAB between the ViewStub, and actual FAB layout file.
@@ -343,89 +416,26 @@ public void onSaveInstanceState(Bundle outState) {
         }
     }
 
-    public interface LoadStateListener {
-        void isLoadingChanged(boolean isLoading);
-    }
-
-    /**
-     * Set a (singular) LoadStateListener. Only one listener is supported at any given time. Setting
-     * a new listener means any previously set listeners will be dropped. This is only intended
-     * to be used by NavigationItemViewHolder. If you want to use this method for any other
-     * parts of the codebase, please extend it to handle a list of listeners. (We would also need
-     * to automatically clean up expired listeners from that list, probably when adding to that list.)
-     *
-     * @param listener The listener to notify of load state changes. Only a weak reference will be kept,
-     *                 no more calls will be sent once the listener is garbage collected.
-     */
-    public void setIsLoadingListener(final LoadStateListener listener) {
-        loadStateListenerWeakReference = new WeakReference<>(listener);
-    }
-
-    private void updateIsLoading(final boolean isLoading) {
-        this.isLoading = isLoading;
-        final LoadStateListener currentListener = loadStateListenerWeakReference.get();
-        if (currentListener != null) {
-            currentListener.isLoadingChanged(isLoading);
-        }
-    }
-
     @Override
     public IWebView.Callback createCallback() {
-        return new IWebView.Callback() {
+        return new SessionCallbackProxy(session, new IWebView.Callback() {
             @Override
-            public void onPageStarted(final String url) {
-                updateIsLoading(true);
-
-                lockView.setVisibility(View.GONE);
-
-                // Hide badging while loading
-                updateBlockingBadging(true);
-
-                progressView.announceForAccessibility(getString(R.string.accessibility_announcement_loading));
-
-                backgroundTransitionGroup.resetTransition();
-
-                progressView.setProgress(5);
-                progressView.setVisibility(View.VISIBLE);
-
-                updateToolbarButtonStates();
-            }
+            public void onPageStarted(final String url) {}
 
             @Override
-            public void onPageFinished(boolean isSecure) {
-                updateIsLoading(false);
-
-                backgroundTransitionGroup.startTransition(ANIMATION_DURATION);
-
-                progressView.announceForAccessibility(getString(R.string.accessibility_announcement_loading_finished));
-
-                progressView.setVisibility(View.GONE);
-
-                if (isSecure) {
-                    lockView.setVisibility(View.VISIBLE);
-                }
-
-                updateBlockingBadging(isBlockingEnabled());
-
-                updateToolbarButtonStates();
-            }
+            public void onPageFinished(boolean isSecure) {}
 
             @Override
-            public void onURLChanged(final String url) {
-                updateURL(url);
-            }
+            public void onURLChanged(final String url) {}
 
             @Override
-            public void onProgress(int progress) {
-                progressView.setProgress(progress);
-            }
+            public void onProgress(int progress) {}
 
             @Override
-            public boolean handleExternalUrl(final String url) {
-                final IWebView webView = getWebView();
+            public void countBlockedTracker() {}
 
-                return webView != null && IntentUtils.handleExternalUri(getContext(), webView, url);
-            }
+            @Override
+            public void resetBlockedTrackers() {}
 
             @Override
             public void onLongPress(final IWebView.HitTarget hitTarget) {
@@ -492,7 +502,7 @@ public void onDownloadStart(Download download) {
                     requestPermissions(new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, REQUEST_CODE_STORAGE_PERMISSION);
                 }
             }
-        };
+        });
     }
 
     /**
@@ -665,31 +675,23 @@ private void queueDownload(Download download) {
         downloadBroadcastReceiver.addQueuedDownload(downloadReference);
     }
 
-    private boolean isStartedFromExternalApp() {
-        final Activity activity = getActivity();
-        if (activity == null) {
-            return false;
-        }
-
-        // No SafeIntent needed here because intent.getAction() is safe (SafeIntent simply calls intent.getAction()
-        // without any wrapping):
-        final Intent intent = activity.getIntent();
-        return intent != null && Intent.ACTION_VIEW.equals(intent.getAction());
-    }
-
     public boolean onBackPressed() {
         if (canGoBack()) {
             // Go back in web history
             goBack();
         } else {
-            if (isStartedFromExternalApp()) {
-                // We have been started from a VIEW intent. Go back to the previous app immediately
-                // and erase the current browsing session.
+            if (session.getSource() == Source.VIEW || session.getSource() == Source.CUSTOM_TAB) {
+                // This session has been started from a VIEW intent. Go back to the previous app
+                // immediately and erase the current browsing session.
                 erase();
 
-                // We remove the whole task because otherwise the old session might still be
-                // partially visible in the app switcher.
-                getActivity().finishAndRemoveTask();
+                // If there are no other sessions then we remove the whole task because otherwise
+                // the old session might still be partially visible in the app switcher.
+                if (!SessionManager.getInstance().hasSession()) {
+                    getActivity().finishAndRemoveTask();
+                } else {
+                    getActivity().finish();
+                }
 
                 // We can't show a snackbar outside of the app. So let's show a toast instead.
                 Toast.makeText(getContext(), R.string.feedback_erase, Toast.LENGTH_SHORT).show();
@@ -697,7 +699,7 @@ public boolean onBackPressed() {
                 TelemetryWrapper.eraseBackToAppEvent();
             } else {
                 // Just go back to the home screen.
-                eraseAndShowHomeScreen(true);
+                erase();
 
                 TelemetryWrapper.eraseBackToHomeEvent();
             }
@@ -712,40 +714,14 @@ public void erase() {
             webView.cleanup();
         }
 
-        BrowsingNotificationService.stop(getContext());
-    }
-
-    public void eraseAndShowHomeScreen(final boolean animateErase) {
-        erase();
-
-        final FragmentTransaction transaction = getActivity().getSupportFragmentManager()
-                .beginTransaction();
-
-        if (animateErase) {
-            transaction.setCustomAnimations(0, R.anim.erase_animation);
-        }
-
-        transaction
-                .replace(R.id.container, UrlInputFragment.createWithBackground(), UrlInputFragment.FRAGMENT_TAG)
-                .commit();
-
-        ViewUtils.showBrandedSnackbar(getActivity().findViewById(android.R.id.content),
-                R.string.feedback_erase,
-                getResources().getInteger(R.integer.erase_snackbar_delay));
+        SessionManager.getInstance().removeCurrentSession();
     }
 
     @Override
     public void onClick(View view) {
         switch (view.getId()) {
             case R.id.menu:
-                final CustomTabConfig customTabConfig;
-                if (BrowsingSession.getInstance().isCustomTab()) {
-                    customTabConfig = BrowsingSession.getInstance().getCustomTabConfig();
-                } else {
-                    customTabConfig = null;
-                }
-
-                BrowserMenu menu = new BrowserMenu(getActivity(), this, customTabConfig);
+                BrowserMenu menu = new BrowserMenu(getActivity(), this, session.getCustomTabConfig());
                 menu.show(menuView);
 
                 menuWeakReference = new WeakReference<>(menu);
@@ -753,7 +729,7 @@ public void onClick(View view) {
 
             case R.id.display_url:
                 final Fragment urlFragment = UrlInputFragment
-                        .createAsOverlay(getUrl(), urlView);
+                        .createWithSession(session, urlView);
 
                 getActivity().getSupportFragmentManager()
                         .beginTransaction()
@@ -762,7 +738,7 @@ public void onClick(View view) {
                 break;
 
             case R.id.erase: {
-                eraseAndShowHomeScreen(true);
+                erase();
 
                 TelemetryWrapper.eraseEvent();
                 break;
@@ -887,7 +863,7 @@ public void onClick(View view) {
         }
     }
 
-    private void updateToolbarButtonStates() {
+    private void updateToolbarButtonStates(boolean isLoading) {
         if (forwardButton == null || backButton == null || refreshButton == null || stopButton == null) {
             return;
         }
@@ -923,10 +899,6 @@ public boolean canGoForward() {
         return webView != null && webView.canGoForward();
     }
 
-    public boolean isLoading() {
-        return isLoading;
-    }
-
     public boolean canGoBack() {
         final IWebView webView = getWebView();
         return webView != null && webView.canGoBack();
@@ -961,7 +933,7 @@ public void setBlockingEnabled(boolean enabled) {
 
         statusBar.setBackgroundResource(enabled ? R.drawable.animated_background : R.drawable.animated_background_disabled);
 
-        if (!BrowsingSession.getInstance().isCustomTab()) {
+        if (!session.isCustomTab()) {
             // Only update the toolbar background if this is not a custom tab. Custom tabs set their
             // own color and we do not want to override this here.
             urlBar.setBackgroundResource(enabled ? R.drawable.animated_background : R.drawable.animated_background_disabled);
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java
index 6f7ee3e84872..ec5759ba2291 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/FirstrunFragment.java
@@ -11,6 +11,7 @@
 import android.support.annotation.Nullable;
 import android.support.design.widget.TabLayout;
 import android.support.v4.app.Fragment;
+import android.support.v4.app.FragmentManager;
 import android.support.v4.view.ViewPager;
 import android.transition.Transition;
 import android.transition.TransitionInflater;
@@ -22,6 +23,7 @@
 import org.mozilla.focus.activity.MainActivity;
 import org.mozilla.focus.firstrun.FirstrunPagerAdapter;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
+import org.mozilla.focus.utils.ViewUtils;
 
 public class FirstrunFragment extends Fragment implements View.OnClickListener {
     public static final String FRAGMENT_TAG = "firstrun";
@@ -58,6 +60,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, @Nullable
         final FirstrunPagerAdapter adapter = new FirstrunPagerAdapter(container.getContext(), this);
 
         viewPager = (ViewPager) view.findViewById(R.id.pager);
+        viewPager.setFocusable(true);
 
         viewPager.setPageTransformer(true, new ViewPager.PageTransformer() {
             @Override
@@ -128,11 +131,21 @@ public void onClick(View view) {
     }
 
     private void finishFirstrun() {
+        final FragmentManager fragmentManager = getActivity().getSupportFragmentManager();
+
         PreferenceManager.getDefaultSharedPreferences(getContext())
                 .edit()
                 .putBoolean(FIRSTRUN_PREF, true)
                 .apply();
 
-        ((MainActivity) getActivity()).firstrunFinished();
+        fragmentManager
+                .beginTransaction()
+                .remove(this)
+                .commit();
+
+        final UrlInputFragment inputFragment = (UrlInputFragment) fragmentManager.findFragmentByTag(UrlInputFragment.FRAGMENT_TAG);
+        if (inputFragment != null) {
+            inputFragment.showKeyboard();
+        }
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.java
index d41e5c762726..4c551c4b48c5 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/InfoFragment.java
@@ -13,6 +13,7 @@
 import android.widget.ProgressBar;
 
 import org.mozilla.focus.R;
+import org.mozilla.focus.session.Session;
 import org.mozilla.focus.utils.IntentUtils;
 import org.mozilla.focus.web.Download;
 import org.mozilla.focus.web.IWebView;
@@ -85,14 +86,6 @@ public void onProgress(int progress) {
                 progressView.setProgress(progress);
             }
 
-            @Override
-            public boolean handleExternalUrl(final String url) {
-                final IWebView webView = getWebView();
-
-                return webView != null && IntentUtils.handleExternalUri(getContext(), webView, url);
-            }
-
-
             @Override
             public void onDownloadStart(Download download) {
             }
@@ -108,9 +101,20 @@ public void onEnterFullScreen(@NonNull IWebView.FullscreenCallback callback, @Nu
 
             @Override
             public void onExitFullScreen() {}
+
+            @Override
+            public void countBlockedTracker() {}
+
+            @Override
+            public void resetBlockedTrackers() {}
         };
     }
 
+    @Override
+    public Session getSession() {
+        return null;
+    }
+
     @Nullable
     @Override
     public String getInitialUrl() {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.java
index 1cb2993b14e4..1983613c4f0f 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/UrlInputFragment.java
@@ -11,11 +11,13 @@
 import android.content.Intent;
 import android.graphics.Typeface;
 import android.os.Bundle;
+import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.support.v4.app.FragmentManager;
 import android.support.v7.widget.PopupMenu;
 import android.text.SpannableString;
 import android.text.style.StyleSpan;
+import android.util.Log;
 import android.view.Gravity;
 import android.view.LayoutInflater;
 import android.view.MenuItem;
@@ -30,7 +32,11 @@
 import org.mozilla.focus.autocomplete.UrlAutoCompleteFilter;
 import org.mozilla.focus.locale.LocaleAwareAppCompatActivity;
 import org.mozilla.focus.locale.LocaleAwareFragment;
+import org.mozilla.focus.session.Session;
+import org.mozilla.focus.session.SessionManager;
+import org.mozilla.focus.session.Source;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
+import org.mozilla.focus.utils.Settings;
 import org.mozilla.focus.utils.ThreadUtils;
 import org.mozilla.focus.utils.UrlUtils;
 import org.mozilla.focus.utils.ViewUtils;
@@ -42,25 +48,20 @@
 public class UrlInputFragment extends LocaleAwareFragment implements View.OnClickListener, InlineAutocompleteEditText.OnCommitListener, InlineAutocompleteEditText.OnFilterListener, PopupMenu.OnMenuItemClickListener {
     public static final String FRAGMENT_TAG = "url_input";
 
-    private static final String ARGUMENT_URL = "url";
     private static final String ARGUMENT_ANIMATION = "animation";
     private static final String ARGUMENT_X = "x";
     private static final String ARGUMENT_Y = "y";
     private static final String ARGUMENT_WIDTH = "width";
     private static final String ARGUMENT_HEIGHT = "height";
-    private static final String ARGUMENT_OVERLAY = "translucent";
+
+    private static final String ARGUMENT_SESSION_UUID = "sesssion_uuid";
 
     private static final String ANIMATION_BROWSER_SCREEN = "browser_screen";
 
     private static final int ANIMATION_DURATION = 200;
 
-    /**
-     * Create a new UrlInputFragment with a gradient background (and the Focus logo). This configuration
-     * is usually shown if there's no content to be shown below (e.g. the current website).
-     */
-    public static UrlInputFragment createWithBackground() {
+    public static UrlInputFragment createWithoutSession() {
         final Bundle arguments = new Bundle();
-        arguments.putBoolean(ARGUMENT_OVERLAY, false);
 
         final UrlInputFragment fragment = new UrlInputFragment();
         fragment.setArguments(arguments);
@@ -68,30 +69,11 @@ public static UrlInputFragment createWithBackground() {
         return fragment;
     }
 
-    @Override
-    public void applyLocale() {
-        if (isOverlay()) {
-            getActivity().getSupportFragmentManager()
-                    .beginTransaction()
-                    .replace(R.id.container, UrlInputFragment.createAsOverlay(ARGUMENT_URL, urlView), UrlInputFragment.FRAGMENT_TAG)
-                    .commit();
-        } else {
-            getActivity().getSupportFragmentManager()
-                    .beginTransaction()
-                    .replace(R.id.container, UrlInputFragment.createWithBackground(), UrlInputFragment.FRAGMENT_TAG)
-                    .commit();
-        }
-    }
-
-    /**
-     * Create a new UrlInputFragment as an overlay shown on top of a different view (e.g. the
-     * current website).
-     */
-    public static UrlInputFragment createAsOverlay(String url, View urlView) {
+    public static UrlInputFragment createWithSession(@NonNull Session session, View urlView) {
         final Bundle arguments = new Bundle();
+
+        arguments.putString(ARGUMENT_SESSION_UUID, session.getUUID());
         arguments.putString(ARGUMENT_ANIMATION, ANIMATION_BROWSER_SCREEN);
-        arguments.putString(ARGUMENT_URL, url);
-        arguments.putBoolean(ARGUMENT_OVERLAY, true);
 
         int[] screenLocation = new int[2];
         urlView.getLocationOnScreen(screenLocation);
@@ -107,6 +89,19 @@ public static UrlInputFragment createAsOverlay(String url, View urlView) {
         return fragment;
     }
 
+    /**
+     * Create a new UrlInputFragment with a gradient background (and the Focus logo). This configuration
+     * is usually shown if there's no content to be shown below (e.g. the current website).
+     */
+    public static UrlInputFragment createWithBackground() {
+        final Bundle arguments = new Bundle();
+
+        final UrlInputFragment fragment = new UrlInputFragment();
+        fragment.setArguments(arguments);
+
+        return fragment;
+    }
+
     private InlineAutocompleteEditText urlView;
     private View clearView;
     private View searchViewContainer;
@@ -123,8 +118,20 @@ public static UrlInputFragment createAsOverlay(String url, View urlView) {
 
     private volatile boolean isAnimating;
 
+    private Session session;
+
+    @Override
+    public void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+
+        final String sessionUUID = getArguments().getString(ARGUMENT_SESSION_UUID);
+        if (sessionUUID != null) {
+            session = SessionManager.getInstance().getSessionByUUID(sessionUUID);
+        }
+    }
+
     @Override
-    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
+    public View onCreateView(LayoutInflater inflater, ViewGroup container, @Nullable Bundle savedInstanceState) {
         final View view = inflater.inflate(R.layout.fragment_urlinput, container, false);
 
         dismissView = view.findViewById(R.id.dismiss);
@@ -143,15 +150,6 @@ public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container,
 
         urlView = (InlineAutocompleteEditText) view.findViewById(R.id.url_edit);
         urlView.setOnFilterListener(this);
-        urlView.setOnFocusChangeListener(new View.OnFocusChangeListener() {
-            @Override
-            public void onFocusChange(View v, boolean hasFocus) {
-                // Avoid showing keyboard again when returning to the previous page by back key.
-                if (hasFocus && !isAnimating) {
-                    ViewUtils.showKeyboard(urlView);
-                }
-            }
-        });
 
         toolbarBackgroundView = view.findViewById(R.id.toolbar_background);
         urlInputBackgroundView = view.findViewById(R.id.url_input_background);
@@ -184,16 +182,31 @@ public boolean onPreDraw() {
 
         urlView.setOnCommitListener(this);
 
-        if (getArguments().containsKey(ARGUMENT_URL)) {
-            urlView.setText(getArguments().getString(ARGUMENT_URL));
+        if (session != null) {
+            urlView.setText(session.getUrl().getValue());
             clearView.setVisibility(View.VISIBLE);
         }
 
         return view;
     }
 
+    @Override
+    public void applyLocale() {
+        if (isOverlay()) {
+            getActivity().getSupportFragmentManager()
+                    .beginTransaction()
+                    .replace(R.id.container, UrlInputFragment.createWithSession(session, urlView), UrlInputFragment.FRAGMENT_TAG)
+                    .commit();
+        } else {
+            getActivity().getSupportFragmentManager()
+                    .beginTransaction()
+                    .replace(R.id.container, UrlInputFragment.createWithBackground(), UrlInputFragment.FRAGMENT_TAG)
+                    .commit();
+        }
+    }
+
     private boolean isOverlay() {
-        return getArguments().getBoolean(ARGUMENT_OVERLAY, false);
+        return session != null;
     }
 
     public boolean onBackPressed() {
@@ -209,7 +222,14 @@ public boolean onBackPressed() {
     public void onStart() {
         super.onStart();
 
-        urlView.requestFocus();
+        if (!Settings.getInstance(getContext()).shouldShowFirstrun()) {
+            // Only show keyboard if we are not displaying the first run tour on top.
+            showKeyboard();
+        }
+    }
+
+    public void showKeyboard() {
+        ViewUtils.showKeyboard(urlView);
     }
 
     @Override
@@ -476,10 +496,7 @@ private void openUrl(String url) {
                     .remove(this)
                     .commit();
         } else {
-            fragmentManager
-                    .beginTransaction()
-                    .replace(R.id.container, BrowserFragment.create(url), BrowserFragment.FRAGMENT_TAG)
-                    .commit();
+            SessionManager.getInstance().createSession(Source.USER_ENTERED, url);
         }
     }
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.java
index a4144564cb92..26bdf79f9b21 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/fragment/WebFragment.java
@@ -19,6 +19,7 @@
 import org.mozilla.focus.R;
 import org.mozilla.focus.locale.LocaleAwareFragment;
 import org.mozilla.focus.locale.LocaleManager;
+import org.mozilla.focus.session.Session;
 import org.mozilla.focus.web.IWebView;
 
 import java.util.Locale;
@@ -39,6 +40,8 @@ public abstract class WebFragment extends LocaleAwareFragment {
 
     public abstract IWebView.Callback createCallback();
 
+    public abstract Session getSession();
+
     /**
      * Get the initial URL to load after the view has been created.
      */
@@ -64,7 +67,7 @@ public final View onCreateView(LayoutInflater inflater, @Nullable ViewGroup cont
                 webView.loadUrl(url);
             }
         } else {
-            webView.restoreWebViewState(savedInstanceState);
+            webView.restoreWebViewState(getSession(), savedInstanceState);
         }
 
         onCreateViewCalled();
@@ -105,7 +108,7 @@ public void onResume() {
 
     @Override
     public void onSaveInstanceState(Bundle outState) {
-        webView.saveWebViewState(outState);
+        webView.saveWebViewState(getSession(), outState);
 
         super.onSaveInstanceState(outState);
     }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareAppCompatActivity.java b/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareAppCompatActivity.java
index c257ab015e6c..bbf0ac3927ae 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareAppCompatActivity.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareAppCompatActivity.java
@@ -12,12 +12,13 @@
 import android.support.v7.app.AppCompatActivity;
 import android.view.View;
 
+import org.mozilla.focus.activity.LifecycleAppCompatActivity;
 import org.mozilla.focus.activity.SettingsActivity;
 
 import java.util.Locale;
 
 public abstract class LocaleAwareAppCompatActivity
-        extends AppCompatActivity {
+        extends LifecycleAppCompatActivity {
 
     private volatile Locale mLastLocale;
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareFragment.java b/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareFragment.java
index 5dca49f4f1e2..3dc1a4875bd9 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareFragment.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/locale/LocaleAwareFragment.java
@@ -5,11 +5,12 @@
 
 package org.mozilla.focus.locale;
 
+import android.arch.lifecycle.LifecycleFragment;
 import android.support.v4.app.Fragment;
 
 import java.util.Locale;
 
-public abstract class LocaleAwareFragment extends Fragment {
+public abstract class LocaleAwareFragment extends LifecycleFragment {
     private Locale cachedLocale = null;
 
     /**
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/BlockingItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/BlockingItemViewHolder.java
index 877845ed8f73..faa78f9ae2dc 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/BlockingItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/BlockingItemViewHolder.java
@@ -14,11 +14,11 @@
 import org.mozilla.focus.fragment.BrowserFragment;
 import org.mozilla.focus.telemetry.TelemetryWrapper;
 import org.mozilla.focus.utils.ThreadUtils;
-import org.mozilla.focus.web.BrowsingSession;
 
 /* package */ class BlockingItemViewHolder extends BrowserMenuViewHolder implements CompoundButton.OnCheckedChangeListener {
     /* package */ static final int LAYOUT_ID = R.layout.menu_blocking_switch;
 
+    private TextView trackerCounter;
     private BrowserFragment fragment;
 
     /* package */ BlockingItemViewHolder(View itemView, final BrowserFragment fragment) {
@@ -40,18 +40,17 @@ public void onClick(View view) {
             }
         });
 
-        final TextView trackerCounter = (TextView) itemView.findViewById(R.id.trackers_count);
+        trackerCounter = (TextView) itemView.findViewById(R.id.trackers_count);
 
-        BrowsingSession.getInstance().setTrackingCountListener(new BrowsingSession.TrackingCountListener() {
-            @Override
-            public void onTrackingCountChanged(int trackingCount) {
-                if (fragment.isBlockingEnabled()) {
-                    updateTrackingCount(trackerCounter, trackingCount);
-                } else {
-                    disableTrackingCount(trackerCounter);
-                }
-            }
-        });
+        updateTrackers(fragment.getSession().getBlockedTrackers().getValue());
+    }
+
+    /* package */ void updateTrackers(int trackers) {
+        if (fragment.isBlockingEnabled()) {
+            updateTrackingCount(trackerCounter, trackers);
+        } else {
+            disableTrackingCount(trackerCounter);
+        }
     }
 
     private void updateTrackingCount(final TextView view, final int count) {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenu.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenu.java
index 0aebdb902bc4..839b217aebca 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenu.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenu.java
@@ -20,17 +20,21 @@
 import org.mozilla.focus.R;
 import org.mozilla.focus.fragment.BrowserFragment;
 import org.mozilla.focus.utils.ViewUtils;
-import org.mozilla.focus.web.CustomTabConfig;
+import org.mozilla.focus.customtabs.CustomTabConfig;
 
 public class BrowserMenu extends PopupWindow {
+    private BrowserMenuAdapter adapter;
+
     public BrowserMenu(Context context, BrowserFragment fragment, final @Nullable CustomTabConfig customTabConfig) {
         @SuppressLint("InflateParams") // This View will have it's params ignored anyway:
         final View view = LayoutInflater.from(context).inflate(R.layout.menu, null);
         setContentView(view);
 
+        adapter = new BrowserMenuAdapter(context, this, fragment, customTabConfig);
+
         RecyclerView menuList = (RecyclerView) view.findViewById(R.id.list);
         menuList.setLayoutManager(new LinearLayoutManager(context, LinearLayoutManager.VERTICAL, false));
-        menuList.setAdapter(new BrowserMenuAdapter(context, this, fragment, customTabConfig));
+        menuList.setAdapter(adapter);
 
         setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));
 
@@ -42,6 +46,14 @@ public BrowserMenu(Context context, BrowserFragment fragment, final @Nullable Cu
         setElevation(context.getResources().getDimension(R.dimen.menu_elevation));
     }
 
+    public void updateTrackers(int trackers) {
+        adapter.updateTrackers(trackers);
+    }
+
+    public void updateLoading(boolean loading) {
+        adapter.updateLoading(loading);
+    }
+
     public void show(View anchor) {
         final int xOffset = ViewUtils.isRTL(anchor) ? -anchor.getWidth() : 0;
 
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenuAdapter.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenuAdapter.java
index 5163c11d8e38..3b4cecf01715 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenuAdapter.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/BrowserMenuAdapter.java
@@ -19,8 +19,9 @@
 import org.mozilla.focus.fragment.BrowserFragment;
 import org.mozilla.focus.utils.Browsers;
 import org.mozilla.focus.utils.HardwareUtils;
-import org.mozilla.focus.web.CustomTabConfig;
+import org.mozilla.focus.customtabs.CustomTabConfig;
 
+import java.lang.ref.WeakReference;
 import java.util.ArrayList;
 import java.util.List;
 
@@ -46,6 +47,8 @@ public MenuItem(int id, String label, @Nullable PendingIntent pendingIntent) {
     private final BrowserFragment fragment;
 
     private List<MenuItem> items;
+    private WeakReference<NavigationItemViewHolder> navigationItemViewHolderReference;
+    private WeakReference<BlockingItemViewHolder> blockingItemViewHolderReference;
 
     public BrowserMenuAdapter(Context context, BrowserMenu menu, BrowserFragment fragment,
                               final @Nullable CustomTabConfig customTabConfig) {
@@ -107,16 +110,44 @@ private void addCustomTabMenuItems(final List<MenuItem> items, final @NonNull Cu
         }
     }
 
+    public void updateTrackers(int trackers) {
+        if (blockingItemViewHolderReference == null) {
+            return;
+        }
+
+        final BlockingItemViewHolder navigationItemViewHolder = blockingItemViewHolderReference.get();
+        if (navigationItemViewHolder != null) {
+            navigationItemViewHolder.updateTrackers(trackers);
+        }
+    }
+
+    public void updateLoading(boolean loading) {
+        if (navigationItemViewHolderReference == null) {
+            return;
+        }
+
+        final NavigationItemViewHolder navigationItemViewHolder = navigationItemViewHolderReference.get();
+        if (navigationItemViewHolder != null) {
+            navigationItemViewHolder.updateLoading(loading);
+        }
+    }
+
     @Override
     public BrowserMenuViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
         final LayoutInflater inflater = LayoutInflater.from(parent.getContext());
 
         if (viewType == NavigationItemViewHolder.LAYOUT_ID) {
-            return new NavigationItemViewHolder(inflater.inflate(R.layout.menu_navigation, parent, false), fragment);
+            NavigationItemViewHolder navigationItemViewHolder = new NavigationItemViewHolder(
+                    inflater.inflate(R.layout.menu_navigation, parent, false), fragment);
+            navigationItemViewHolderReference = new WeakReference<>(navigationItemViewHolder);
+            return navigationItemViewHolder;
         } else if (viewType == MenuItemViewHolder.LAYOUT_ID) {
             return new MenuItemViewHolder(inflater.inflate(R.layout.menu_item, parent, false));
         } else if (viewType == BlockingItemViewHolder.LAYOUT_ID) {
-            return new BlockingItemViewHolder(inflater.inflate(R.layout.menu_blocking_switch, parent, false), fragment);
+            final BlockingItemViewHolder blockingItemViewHolder = new BlockingItemViewHolder(
+                    inflater.inflate(R.layout.menu_blocking_switch, parent, false), fragment);
+            blockingItemViewHolderReference = new WeakReference<>(blockingItemViewHolder);
+            return blockingItemViewHolder;
         } else if (viewType == CustomTabMenuItemViewHolder.LAYOUT_ID) {
             return new CustomTabMenuItemViewHolder(inflater.inflate(R.layout.custom_tab_menu_item, parent, false));
         }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/MenuItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/MenuItemViewHolder.java
index e53995e885ab..0deab863ce91 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/MenuItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/MenuItemViewHolder.java
@@ -25,7 +25,10 @@
     /* package-private */ void bind(BrowserMenuAdapter.MenuItem menuItem) {
         menuItemView.setId(menuItem.id);
         menuItemView.setText(menuItem.label);
-        if (menuItem.id == R.id.add_to_homescreen && browserFragment.isLoading()) {
+
+        final boolean isLoading = browserFragment.getSession().getLoading().getValue();
+
+        if (menuItem.id == R.id.add_to_homescreen && isLoading) {
             menuItemView.setTextColor(browserFragment.getResources().getColor(R.color.inactive_text));
             menuItemView.setClickable(false);
         } else {
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/menu/NavigationItemViewHolder.java b/focus-android/app/src/main/java/org/mozilla/focus/menu/NavigationItemViewHolder.java
index e80c26de22b5..14c067be8e5a 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/menu/NavigationItemViewHolder.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/menu/NavigationItemViewHolder.java
@@ -10,8 +10,7 @@
 import org.mozilla.focus.R;
 import org.mozilla.focus.fragment.BrowserFragment;
 
-public class NavigationItemViewHolder extends BrowserMenuViewHolder
-        implements BrowserFragment.LoadStateListener {
+public class NavigationItemViewHolder extends BrowserMenuViewHolder {
     public static final int LAYOUT_ID = R.layout.menu_navigation;
 
     final View refreshButton;
@@ -26,8 +25,7 @@ public NavigationItemViewHolder(View itemView, BrowserFragment fragment) {
         stopButton = itemView.findViewById(R.id.stop);
         stopButton.setOnClickListener(this);
 
-        isLoadingChanged(fragment.isLoading());
-        fragment.setIsLoadingListener(this);
+        updateLoading(fragment.getSession().getLoading().getValue());
 
         final View forwardView = itemView.findViewById(R.id.forward);
         if (!fragment.canGoForward()) {
@@ -38,9 +36,8 @@ public NavigationItemViewHolder(View itemView, BrowserFragment fragment) {
         }
     }
 
-    @Override
-    public void isLoadingChanged(boolean isLoading) {
-        refreshButton.setVisibility(isLoading ? View.GONE : View.VISIBLE);
-        stopButton.setVisibility(isLoading ? View.VISIBLE : View.GONE);
+    public void updateLoading(boolean loading) {
+        refreshButton.setVisibility(loading ? View.GONE : View.VISIBLE);
+        stopButton.setVisibility(loading ? View.VISIBLE : View.GONE);
     }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/notification/BrowsingNotificationService.java b/focus-android/app/src/main/java/org/mozilla/focus/notification/BrowsingNotificationService.java
deleted file mode 100644
index 1714df4e442c..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/notification/BrowsingNotificationService.java
+++ /dev/null
@@ -1,203 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.notification;
-
-import android.app.Notification;
-import android.app.PendingIntent;
-import android.app.Service;
-import android.content.Context;
-import android.content.Intent;
-import android.os.IBinder;
-import android.support.annotation.Nullable;
-import android.support.v4.app.NotificationCompat;
-import android.support.v4.content.ContextCompat;
-
-import org.mozilla.focus.R;
-import org.mozilla.focus.activity.MainActivity;
-import org.mozilla.focus.telemetry.TelemetryWrapper;
-import org.mozilla.focus.web.BrowsingSession;
-import org.mozilla.focus.web.WebViewProvider;
-
-/**
- * This service tracks the background/foreground state of our main activity and whether a browsing
- * session is active or not.
- *
- * As long as a browsing session is active we will show a notification. Clicking the notification
- * will erase the session.
- */
-public class BrowsingNotificationService extends Service {
-    private static final int NOTIFICATION_ID = 83;
-
-    private static final String ACTION_START = "start";
-    private static final String ACTION_STOP = "stop";
-    private static final String ACTION_ERASE = "erase";
-    private static final String ACTION_FOREGROUND = "foreground";
-    private static final String ACTION_BACKGROUND = "background";
-
-    private static final String EXTRA_NOTIFICATION_ACTION = "notification_action";
-
-    private boolean foreground;
-
-    public static void start(Context context) {
-        final Intent intent = new Intent(context, BrowsingNotificationService.class);
-        intent.setAction(ACTION_START);
-
-        context.startService(intent);
-    }
-
-    public static void foreground(Context context) {
-        final Intent intent = new Intent(context, BrowsingNotificationService.class);
-        intent.setAction(ACTION_FOREGROUND);
-
-        context.startService(intent);
-    }
-
-    public static void background(Context context) {
-        final Intent intent = new Intent(context, BrowsingNotificationService.class);
-        intent.setAction(ACTION_BACKGROUND);
-
-        context.startService(intent);
-    }
-
-    public static void stop(Context context) {
-        final Intent intent = new Intent(context, BrowsingNotificationService.class);
-        intent.setAction(ACTION_STOP);
-
-        context.startService(intent);
-    }
-
-    @Override
-    public int onStartCommand(Intent intent, int flags, int startId) {
-        switch (intent.getAction()) {
-            case ACTION_START:
-                // When we use ACTION_STOP to stop the browsing session, we also stop this Service (to conserve
-                // resources) so we lose track of the MainActivity's foreground/background state. If we start the
-                // session again (ACTION_START), we assume the default Activity state, backgrounded, and our handling
-                // of an additional ACTION_STOP will unexpectedly take the backgrounded code path even though the
-                // MainActivity is actually in the foreground, which closes the app.
-                //
-                // We can assume we would only start a browsing session with the MainActivity foregrounded,
-                // so we fix this problem by setting the MainActivity to the foreground state whenever ACTION_START
-                // is received.
-                foreground = true;
-                startBrowsingSession();
-                break;
-
-            case ACTION_STOP:
-                stopBrowsingSession();
-                break;
-
-            case ACTION_FOREGROUND:
-                foreground = true;
-                break;
-
-            case ACTION_BACKGROUND:
-                foreground = false;
-                break;
-
-            case ACTION_ERASE:
-                final Intent activityIntent = new Intent(this, MainActivity.class);
-                activityIntent.setAction(MainActivity.ACTION_ERASE);
-                activityIntent.putExtra(MainActivity.EXTRA_FINISH, !foreground);
-
-                if (!foreground) {
-                    activityIntent.setFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
-                }
-
-                // This doesn't seem to be needed on Android 7.1. It is needed on Android 6, or otherwise
-                // we crash with "AndroidRuntimeException: Calling startActivity() from outside of an Activity context requires the FLAG_ACTIVITY_NEW_TASK flag."
-                activityIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
-
-                startActivity(activityIntent);
-
-                if (intent.hasExtra(EXTRA_NOTIFICATION_ACTION)) {
-                    TelemetryWrapper.eraseNotificationActionEvent();
-                } else {
-                    TelemetryWrapper.eraseNotificationEvent();
-                }
-                break;
-
-            default:
-                throw new IllegalStateException("Unknown intent: " + intent);
-        }
-
-        return START_NOT_STICKY;
-    }
-
-    @Override
-    public void onTaskRemoved(Intent rootIntent) {
-        // If our task got removed then we might have been killed in the task switcher. In this case
-        // our activity had no chance to cleanup the browsing data. Let's try to do it from here.
-        WebViewProvider.performCleanup(this);
-
-        stopBrowsingSession();
-    }
-
-    private void startBrowsingSession() {
-        BrowsingSession.getInstance().start();
-
-        startForeground(NOTIFICATION_ID, buildNotification());
-    }
-
-    private void stopBrowsingSession() {
-        BrowsingSession.getInstance().stop();
-
-        stopForeground(true);
-        stopSelf();
-    }
-
-    private Notification buildNotification() {
-        return new NotificationCompat.Builder(this)
-                .setOngoing(true)
-                .setSmallIcon(R.drawable.ic_notification)
-                .setContentTitle(getString(R.string.app_name))
-                .setContentText(getString(R.string.notification_erase_text))
-                .setContentIntent(createNotificationIntent())
-                .setVisibility(Notification.VISIBILITY_SECRET)
-                .setShowWhen(false)
-                .setLocalOnly(true)
-                .setColor(ContextCompat.getColor(this, R.color.colorFloatingActionButtonTint))
-                .addAction(new NotificationCompat.Action(
-                        R.drawable.ic_notification,
-                        getString(R.string.notification_action_open),
-                        createOpenActionIntent()))
-                .addAction(new NotificationCompat.Action(
-                        R.drawable.ic_delete,
-                        getString(R.string.notification_action_erase_and_open),
-                        createOpenAndEraseActionIntent()))
-                .build();
-    }
-
-    private PendingIntent createNotificationIntent() {
-        final Intent intent = new Intent(this, BrowsingNotificationService.class);
-        intent.setAction(ACTION_ERASE);
-
-        return PendingIntent.getService(this, 0, intent, PendingIntent.FLAG_ONE_SHOT);
-    }
-
-    private PendingIntent createOpenActionIntent() {
-        final Intent intent = new Intent(this, MainActivity.class);
-        intent.setAction(MainActivity.ACTION_OPEN);
-
-        return PendingIntent.getActivity(this, 1, intent, PendingIntent.FLAG_UPDATE_CURRENT);
-    }
-
-    private PendingIntent createOpenAndEraseActionIntent() {
-        final Intent intent = new Intent(this, MainActivity.class);
-        intent.setAction(MainActivity.ACTION_ERASE);
-        intent.putExtra(MainActivity.EXTRA_FINISH, false);
-        intent.putExtra(MainActivity.EXTRA_NOTIFICATION, true);
-        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
-
-        return PendingIntent.getActivity(this, 2, intent, PendingIntent.FLAG_UPDATE_CURRENT);
-    }
-
-    @Nullable
-    @Override
-    public IBinder onBind(Intent intent) {
-        return null;
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.java
new file mode 100644
index 000000000000..758918f8026b
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/NotificationSessionObserver.java
@@ -0,0 +1,29 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+
+import org.mozilla.focus.architecture.NonNullObserver;
+
+import java.util.List;
+
+public class NotificationSessionObserver extends NonNullObserver<List<Session>> {
+    private Context context;
+
+    public NotificationSessionObserver(Context context) {
+        this.context = context;
+    }
+
+    @Override
+    protected void onValueChanged(@NonNull List<Session> sessions) {
+        if (sessions.isEmpty()) {
+            SessionNotificationService.stop(context);
+        } else {
+            SessionNotificationService.start(context);
+        }
+    }
+}
\ No newline at end of file
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java b/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java
new file mode 100644
index 000000000000..9aac00aae0ee
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/NullSession.java
@@ -0,0 +1,14 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+/**
+ * An "empty" session object that can be used instead of <code>null</code>.
+ */
+public class NullSession extends Session {
+    public NullSession() {
+        super(Source.NONE, "focusabout:");
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java b/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java
new file mode 100644
index 000000000000..07b3498920ba
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/Session.java
@@ -0,0 +1,134 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+
+import org.mozilla.focus.architecture.NonNullLiveData;
+import org.mozilla.focus.architecture.NonNullMutableLiveData;
+import org.mozilla.focus.customtabs.CustomTabConfig;
+
+import java.util.UUID;
+
+/**
+ * Keeping track of state / data of a single browsing session (tab).
+ */
+public class Session {
+    private final Source source;
+    private final String uuid;
+    private final NonNullMutableLiveData<String> url;
+    private final NonNullMutableLiveData<Integer> progress;
+    private final NonNullMutableLiveData<Boolean> secure;
+    private final NonNullMutableLiveData<Boolean> loading;
+    private final NonNullMutableLiveData<Integer> trackersBlocked;
+    private CustomTabConfig customTabConfig;
+    private Bundle webviewState;
+    private boolean isRecorded;
+    private boolean isSearch;
+
+    /* package */ Session(Source source, String url) {
+        this.uuid = UUID.randomUUID().toString();
+        this.source = source;
+
+        this.url = new NonNullMutableLiveData<>(url);
+        this.progress = new NonNullMutableLiveData<>(0);
+        this.secure = new NonNullMutableLiveData<>(false);
+        this.loading = new NonNullMutableLiveData<>(false);
+        this.trackersBlocked = new NonNullMutableLiveData<>(0);
+
+        this.isRecorded = false;
+    }
+
+    /* package */ Session(String url, @NonNull CustomTabConfig customTabConfig) {
+        this(Source.CUSTOM_TAB, url);
+
+        this.customTabConfig = customTabConfig;
+    }
+
+    public Source getSource() {
+        return source;
+    }
+
+    public String getUUID() {
+        return uuid;
+    }
+
+    /* package */ void setUrl(String url) {
+        this.url.setValue(url);
+    }
+
+    public NonNullLiveData<String> getUrl() {
+        return url;
+    }
+
+    /* package */ void setProgress(int progress) {
+        this.progress.setValue(progress);
+    }
+
+    public NonNullLiveData<Integer> getProgress() {
+        return progress;
+    }
+
+    /* package */ void setSecure(boolean secure) {
+        this.secure.setValue(secure);
+    }
+
+    public NonNullLiveData<Boolean> getSecure() {
+        return secure;
+    }
+
+    /* package */ void setLoading(boolean loading) {
+        this.loading.setValue(loading);
+    }
+
+    public NonNullLiveData<Boolean> getLoading() {
+        return loading;
+    }
+
+    /* package */ void setTrackersBlocked(int trackersBlocked) {
+        this.trackersBlocked.postValue(trackersBlocked);
+    }
+
+    public NonNullLiveData<Integer> getBlockedTrackers() {
+        return trackersBlocked;
+    }
+
+    public void saveWebViewState(Bundle bundle) {
+        this.webviewState = bundle;
+    }
+
+    public Bundle getWebViewState() {
+        return webviewState;
+    }
+
+    public boolean isCustomTab() {
+        return customTabConfig != null;
+    }
+
+    public CustomTabConfig getCustomTabConfig() {
+        return customTabConfig;
+    }
+
+    public boolean isRecorded() {
+        return isRecorded;
+    }
+
+    public void markAsRecorded() {
+        isRecorded = true;
+    }
+
+    public boolean isSearch() {
+        return isSearch;
+    }
+
+    public void setSearch(boolean isSearch) {
+        this.isSearch = isSearch;
+    }
+
+    public boolean isSameAs(@NonNull Session session) {
+        return uuid.equals(session.getUUID());
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java
new file mode 100644
index 000000000000..609ed6d9683d
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionCallbackProxy.java
@@ -0,0 +1,91 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.support.annotation.NonNull;
+import android.support.annotation.Nullable;
+import android.view.View;
+
+import org.mozilla.focus.web.Download;
+import org.mozilla.focus.web.IWebView;
+
+public class SessionCallbackProxy implements IWebView.Callback {
+    /* package */ static final int MINIMUM_PROGRESS = 5;
+
+    private final Session session;
+    private final IWebView.Callback delegate;
+
+    public SessionCallbackProxy(Session session, IWebView.Callback delegate) {
+        this.session = session;
+        this.delegate = delegate;
+    }
+
+    @Override
+    public void onPageStarted(String url) {
+        session.setLoading(true);
+        session.setSecure(false);
+
+        // We are always setting the progress to 5% when a new page starts loading. Otherwise it might
+        // look like the browser is doing nothing (on a slow network) until we receive a progress
+        // from the WebView.
+        session.setProgress(MINIMUM_PROGRESS);
+
+        session.setUrl(url);
+    }
+
+    @Override
+    public void onPageFinished(boolean isSecure) {
+        session.setLoading(false);
+        session.setSecure(isSecure);
+    }
+
+    @Override
+    public void onProgress(int progress) {
+        // We do not want the progress to go backwards - so we always set it to at least the minimum.
+        session.setProgress(Math.max(MINIMUM_PROGRESS, progress));
+    }
+
+    @Override
+    public void onURLChanged(String url) {
+        session.setUrl(url);
+    }
+
+
+    @Override
+    public void countBlockedTracker() {
+        //noinspection ConstantConditions - The value is never null
+        session.setTrackersBlocked(session.getBlockedTrackers().getValue() + 1);
+    }
+
+    @Override
+    public void resetBlockedTrackers() {
+        session.setTrackersBlocked(0);
+    }
+
+    @Override
+    public void onDownloadStart(Download download) {
+        // TODO: Replace with session property
+        delegate.onDownloadStart(download);
+    }
+
+    @Override
+    public void onLongPress(IWebView.HitTarget hitTarget) {
+        // TODO: Replace with session property
+        delegate.onLongPress(hitTarget);
+    }
+
+    @Override
+    public void onEnterFullScreen(@NonNull IWebView.FullscreenCallback callback, @Nullable View view) {
+        // TODO: Replace with session property
+        delegate.onEnterFullScreen(callback, view);
+    }
+
+    @Override
+    public void onExitFullScreen() {
+        // TODO: Replace with session property
+        delegate.onExitFullScreen();
+    }
+
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java
new file mode 100644
index 000000000000..e455cb4b4fe5
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionManager.java
@@ -0,0 +1,207 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.content.Context;
+import android.content.Intent;
+import android.os.Bundle;
+import android.support.annotation.NonNull;
+import android.support.annotation.VisibleForTesting;
+import android.text.TextUtils;
+
+import org.mozilla.focus.architecture.NonNullLiveData;
+import org.mozilla.focus.architecture.NonNullMutableLiveData;
+import org.mozilla.focus.customtabs.CustomTabConfig;
+import org.mozilla.focus.shortcut.HomeScreen;
+import org.mozilla.focus.utils.SafeIntent;
+import org.mozilla.focus.utils.UrlUtils;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+/**
+ * Sessions are managed by this global SessionManager instance.
+ */
+public class SessionManager {
+    private static final SessionManager INSTANCE = new SessionManager();
+
+    private NonNullMutableLiveData<List<Session>> sessions;
+    private String currentSessionUUID;
+
+    public static SessionManager getInstance() {
+        return INSTANCE;
+    }
+
+    private SessionManager() {
+        this.sessions = new NonNullMutableLiveData<>(
+                Collections.unmodifiableList(Collections.<Session>emptyList()));
+    }
+
+    /**
+     * Handle this incoming intent (via onCreate()) and create a new session if required.
+     */
+    public void handleIntent(final Context context, final SafeIntent intent, final Bundle savedInstanceState) {
+        if ((intent.getFlags() & Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) != 0) {
+            // This Intent was launched from history (recent apps). Android will redeliver the
+            // original Intent (which might be a VIEW intent). However if there's no active browsing
+            // session then we do not want to re-process the Intent and potentially re-open a website
+            // from a session that the user already "erased".
+            return;
+        }
+
+        if (savedInstanceState != null) {
+            // We are restoring a previous session - No need to handle this Intent.
+            return;
+        }
+
+        createSessionFromIntent(context, intent);
+    }
+
+    /**
+     * Handle this incoming intent (via onNewIntent()) and create a new session if required.
+     */
+    public void handleNewIntent(final Context context, final SafeIntent intent) {
+        createSessionFromIntent(context, intent);
+    }
+
+    private void createSessionFromIntent(Context context, SafeIntent intent) {
+        final String action = intent.getAction();
+
+        if (Intent.ACTION_VIEW.equals(action)) {
+            final Source source = intent.hasExtra(HomeScreen.ADD_TO_HOMESCREEN_TAG)
+                    ? Source.HOME_SCREEN
+                    : Source.VIEW;
+
+            createSession(context, source, intent, intent.getDataString());
+        } else if (Intent.ACTION_SEND.equals(action)) {
+            final String dataString = intent.getStringExtra(Intent.EXTRA_TEXT);
+            if (!TextUtils.isEmpty(dataString)) {
+                final boolean isSearch = !UrlUtils.isUrl(dataString);
+                final String url = isSearch
+                        ? UrlUtils.createSearchUrl(context, dataString)
+                        : dataString;
+
+                createSession(Source.SHARE, url, isSearch);
+            }
+        }
+    }
+
+    /**
+     * Is there at least one browsing session?
+     */
+    public boolean hasSession() {
+        return !sessions.getValue().isEmpty();
+    }
+
+    /**
+     * Get the current session. This method will throw an exception if there's no active session.
+     */
+    public Session getCurrentSession() {
+        if (currentSessionUUID == null) {
+            throw new IllegalAccessError("There's no active session");
+        }
+
+        return getSessionByUUID(currentSessionUUID);
+    }
+
+    public boolean hasSessionWithUUID(@NonNull String uuid) {
+        for (Session session : sessions.getValue()) {
+            if (uuid.equals(session.getUUID())) {
+                return true;
+            }
+        }
+
+        return false;
+    }
+
+    public Session getSessionByUUID(@NonNull String uuid) {
+        for (Session session : sessions.getValue()) {
+            if (uuid.equals(session.getUUID())) {
+                return session;
+            }
+        }
+
+        throw new IllegalAccessError("There's no active session with UUID " + uuid);
+    }
+
+    public NonNullLiveData<List<Session>> getSessions() {
+        return sessions;
+    }
+
+    public void createSession(@NonNull Source source, @NonNull String url) {
+        final Session session = new Session(source, url);
+        addSession(session);
+    }
+
+    private void createSession(@NonNull Source source, @NonNull String url, boolean isSearch) {
+        final Session session = new Session(source, url);
+        session.setSearch(isSearch);
+        addSession(session);
+    }
+
+    private void createSession(Context context, Source source, SafeIntent intent, String url) {
+        final Session session = CustomTabConfig.isCustomTabIntent(intent)
+                ? new Session(url, CustomTabConfig.parseCustomTabIntent(context, intent))
+                : new Session(source, url);
+        addSession(session);
+    }
+
+    private void addSession(Session session) {
+        currentSessionUUID = session.getUUID();
+
+        final List<Session> sessions = new ArrayList<>(this.sessions.getValue());
+        sessions.add(session);
+
+        this.sessions.setValue(Collections.unmodifiableList(sessions));
+    }
+
+    /**
+     * Remove all sessions.
+     */
+    public void removeAllSessions() {
+        currentSessionUUID = null;
+
+        sessions.setValue(Collections.unmodifiableList(Collections.<Session>emptyList()));
+    }
+
+    /**
+     * Remove the current (selected) session.
+     */
+    public void removeCurrentSession() {
+        removeSession(currentSessionUUID);
+    }
+
+    @VisibleForTesting void removeSession(String uuid) {
+        final List<Session> sessions = new ArrayList<>();
+
+        int removedFromPosition = -1;
+
+        for (int i = 0; i < this.sessions.getValue().size(); i++) {
+            final Session currentSession = this.sessions.getValue().get(i);
+
+            if (currentSession.getUUID().equals(uuid)) {
+                removedFromPosition = i;
+                continue;
+            }
+
+            sessions.add(currentSession);
+        }
+
+        if (removedFromPosition == -1) {
+            return;
+        }
+
+        if (sessions.isEmpty()) {
+            currentSessionUUID = null;
+        } else {
+            final Session currentSession = this.sessions.getValue().get(
+                    Math.min(removedFromPosition, sessions.size() - 1));
+            currentSessionUUID = currentSession.getUUID();
+        }
+
+        this.sessions.setValue(sessions);
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.java b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.java
new file mode 100644
index 000000000000..871615173d20
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/SessionNotificationService.java
@@ -0,0 +1,127 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.app.Notification;
+import android.app.PendingIntent;
+import android.app.Service;
+import android.content.Context;
+import android.content.Intent;
+import android.os.IBinder;
+import android.support.annotation.Nullable;
+import android.support.v4.app.NotificationCompat;
+import android.support.v4.content.ContextCompat;
+
+import org.mozilla.focus.R;
+import org.mozilla.focus.activity.MainActivity;
+import org.mozilla.focus.telemetry.TelemetryWrapper;
+
+/**
+ * As long as a session is active this service will keep the notification (and our process) alive.
+ */
+public class SessionNotificationService extends Service {
+    private static final int NOTIFICATION_ID = 83;
+
+    private static final String ACTION_START = "start";
+    private static final String ACTION_ERASE = "erase";
+
+    /* package */ static void start(Context context) {
+        final Intent intent = new Intent(context, SessionNotificationService.class);
+        intent.setAction(ACTION_START);
+
+        context.startService(intent);
+    }
+
+    /* package */ static void stop(Context context) {
+        final Intent intent = new Intent(context, SessionNotificationService.class);
+
+        context.stopService(intent);
+    }
+
+    @Override
+    public int onStartCommand(Intent intent, int flags, int startId) {
+        final String action = intent.getAction();
+        if (action == null) {
+            return START_NOT_STICKY;
+        }
+
+        switch (action) {
+            case ACTION_START:
+                startForeground(NOTIFICATION_ID, buildNotification());
+                break;
+
+            case ACTION_ERASE:
+                SessionManager.getInstance().removeAllSessions();
+
+                TelemetryWrapper.eraseNotificationEvent();
+                break;
+
+            default:
+                throw new IllegalStateException("Unknown intent: " + intent);
+        }
+
+        return START_NOT_STICKY;
+    }
+
+    @Override
+    public void onTaskRemoved(Intent rootIntent) {
+        SessionManager.getInstance().removeAllSessions();
+
+        stopForeground(true);
+        stopSelf();
+    }
+
+    private Notification buildNotification() {
+        return new NotificationCompat.Builder(this)
+                .setOngoing(true)
+                .setSmallIcon(R.drawable.ic_notification)
+                .setContentTitle(getString(R.string.app_name))
+                .setContentText(getString(R.string.notification_erase_text))
+                .setContentIntent(createNotificationIntent())
+                .setVisibility(Notification.VISIBILITY_SECRET)
+                .setShowWhen(false)
+                .setLocalOnly(true)
+                .setColor(ContextCompat.getColor(this, R.color.colorFloatingActionButtonTint))
+                .addAction(new NotificationCompat.Action(
+                        R.drawable.ic_notification,
+                        getString(R.string.notification_action_open),
+                        createOpenActionIntent()))
+                .addAction(new NotificationCompat.Action(
+                        R.drawable.ic_delete,
+                        getString(R.string.notification_action_erase_and_open),
+                        createOpenAndEraseActionIntent()))
+                .build();
+    }
+
+    private PendingIntent createNotificationIntent() {
+        final Intent intent = new Intent(this, SessionNotificationService.class);
+        intent.setAction(ACTION_ERASE);
+
+        return PendingIntent.getService(this, 0, intent, PendingIntent.FLAG_ONE_SHOT);
+    }
+
+    private PendingIntent createOpenActionIntent() {
+        final Intent intent = new Intent(this, MainActivity.class);
+        intent.setAction(MainActivity.ACTION_OPEN);
+
+        return PendingIntent.getActivity(this, 1, intent, PendingIntent.FLAG_UPDATE_CURRENT);
+    }
+
+    private PendingIntent createOpenAndEraseActionIntent() {
+        final Intent intent = new Intent(this, MainActivity.class);
+
+        intent.setAction(MainActivity.ACTION_ERASE);
+        intent.putExtra(MainActivity.EXTRA_NOTIFICATION, true);
+        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+
+        return PendingIntent.getActivity(this, 2, intent, PendingIntent.FLAG_UPDATE_CURRENT);
+    }
+
+    @Nullable
+    @Override
+    public IBinder onBind(Intent intent) {
+        return null;
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java b/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java
new file mode 100644
index 000000000000..83b261e77309
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/session/Source.java
@@ -0,0 +1,46 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+/**
+ * The source of a sessio: How was this session created? E.g. did we receive an Intent or did the
+ * user start this session?
+ */
+public enum Source {
+    /**
+     * Intent.ACTION_VIEW
+     */
+    VIEW,
+
+    /**
+     * Intent.ACTION_SEND
+     */
+    SHARE,
+
+    /**
+     * Via text selection action ("Search privately")
+     */
+    TEXT_SELECTION,
+
+    /**
+     * Via a home screen shortcut.
+     */
+    HOME_SCREEN,
+
+    /**
+     * The user entered a URL (or search ter,s)
+     */
+    USER_ENTERED,
+
+    /**
+     * Custom tab from a third-party application.
+     */
+    CUSTOM_TAB,
+
+    /**
+     * Only used internally if we need to temporarily create a session object with no specific source.
+     */
+    NONE
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java
new file mode 100644
index 000000000000..9a53541c1838
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetrySessionObserver.java
@@ -0,0 +1,60 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.telemetry;
+
+import android.support.annotation.NonNull;
+
+import org.mozilla.focus.architecture.NonNullObserver;
+import org.mozilla.focus.session.Session;
+import org.mozilla.focus.session.Source;
+
+import java.util.List;
+
+public class TelemetrySessionObserver extends NonNullObserver<List<Session>> {
+    @Override
+    protected void onValueChanged(@NonNull List<Session> sessions) {
+        for (final Session session : sessions) {
+            if (!session.isRecorded()) {
+                addTelemetryEvent(session);
+
+                session.markAsRecorded();
+            }
+        }
+    }
+
+    private void addTelemetryEvent(final Session session) {
+        final Source source = session.getSource();
+
+        switch (source) {
+            case VIEW:
+                TelemetryWrapper.browseIntentEvent();
+                break;
+
+            case SHARE:
+                TelemetryWrapper.shareIntentEvent(session.isSearch());
+                break;
+
+            case TEXT_SELECTION:
+                TelemetryWrapper.textSelectionIntentEvent();
+                break;
+
+            case HOME_SCREEN:
+                TelemetryWrapper.openHomescreenShortcutEvent();
+                break;
+
+            case USER_ENTERED:
+                // We report this event from the UI components - The event depends on how the user
+                // interacted with the UI.
+                break;
+
+            case CUSTOM_TAB:
+                TelemetryWrapper.customTabsIntentEvent(session.getCustomTabConfig().getOptionsList());
+                break;
+
+            default:
+                throw new IllegalStateException("Unknown session source: " + source);
+        }
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.java b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.java
index e64c8c2401be..29bb920e6bb1 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/telemetry/TelemetryWrapper.java
@@ -233,11 +233,11 @@ public static void browseIntentEvent() {
         TelemetryEvent.create(Category.ACTION, Method.INTENT_URL, Object.APP).queue();
     }
 
-    public static void shareIntentEvent(boolean isURL) {
-        if (isURL) {
-            TelemetryEvent.create(Category.ACTION, Method.SHARE_INTENT, Object.APP, Value.URL).queue();
-        } else {
+    public static void shareIntentEvent(boolean isSearch) {
+        if (isSearch) {
             TelemetryEvent.create(Category.ACTION, Method.SHARE_INTENT, Object.APP, Value.SEARCH).queue();
+        } else {
+            TelemetryEvent.create(Category.ACTION, Method.SHARE_INTENT, Object.APP, Value.URL).queue();
         }
     }
 
@@ -324,10 +324,6 @@ public static void eraseNotificationEvent() {
         TelemetryEvent.create(Category.ACTION, Method.CLICK, Object.NOTIFICATION, Value.ERASE).queue();
     }
 
-    public static void eraseNotificationActionEvent() {
-        TelemetryEvent.create(Category.ACTION, Method.CLICK, Object.NOTIFICATION_ACTION, Value.ERASE).queue();
-    }
-
     public static void eraseAndOpenNotificationActionEvent() {
         TelemetryEvent.create(Category.ACTION, Method.CLICK, Object.NOTIFICATION_ACTION, Value.ERASE_AND_OPEN).queue();
     }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/utils/ViewUtils.java b/focus-android/app/src/main/java/org/mozilla/focus/utils/ViewUtils.java
index 18d5c18965cb..685d41b796e2 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/utils/ViewUtils.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/utils/ViewUtils.java
@@ -7,29 +7,103 @@
 
 import android.app.Activity;
 import android.content.Context;
-import android.support.annotation.IdRes;
-import android.support.annotation.Nullable;
+import android.os.Handler;
+import android.os.Looper;
 import android.support.annotation.StringRes;
 import android.support.design.widget.Snackbar;
 import android.support.v4.content.ContextCompat;
 import android.support.v4.view.ViewCompat;
+import android.util.Log;
 import android.view.Gravity;
 import android.view.View;
+import android.view.WindowManager;
 import android.view.inputmethod.InputMethodManager;
 import android.widget.TextView;
 
 import org.mozilla.focus.R;
 
+import java.lang.ref.WeakReference;
+
 public class ViewUtils {
+    /**
+     * Runnable to show the keyboard for a specific view.
+     */
+    private static class ShowKeyboard implements Runnable {
+        private static final int INTERVAL_MS = 100;
+
+        private final WeakReference<View> viewReferemce;
+        private final Handler handler;
+
+        private int tries;
+
+        private ShowKeyboard(View view) {
+            this.viewReferemce= new WeakReference<>(view);
+            this.handler = new Handler(Looper.getMainLooper());
+            this.tries = 10;
+        }
+
+        @Override
+        public void run() {
+            if (tries <= 0) {
+                return;
+            }
+
+            final View view = viewReferemce.get();
+            if (view == null) {
+                // The view is gone. No need to continue.
+                return;
+            }
+
+            if (!view.isFocusable() || !view.isFocusableInTouchMode()) {
+                // The view is not focusable - we can't show the keyboard for it.
+                return;
+            }
+
+            if (!view.requestFocus()) {
+                // Focus this view first.
+                post();
+                return;
+            }
+
+            final Activity activity = (Activity) view.getContext();
+            if (activity == null) {
+                return;
+            }
+
+            final InputMethodManager imm = (InputMethodManager) activity.getSystemService(Context.INPUT_METHOD_SERVICE);
+            if (imm == null) {
+                return;
+            }
+
+            if (!imm.isActive(view)) {
+                // This view is not the currently active view for the input method yet.
+                post();
+                return;
+            }
+
+            if (!imm.showSoftInput(view, InputMethodManager.SHOW_IMPLICIT)) {
+                // Showing they keyboard failed. Try again later.
+                post();
+            }
+        }
+
+        private void post() {
+            tries--;
+            handler.postDelayed(this, INTERVAL_MS);
+        }
+    }
+
     public static void showKeyboard(View view) {
-        InputMethodManager imm = (InputMethodManager) view.getContext()
-                .getSystemService(Context.INPUT_METHOD_SERVICE);
-        imm.showSoftInput(view, 0);
+        final ShowKeyboard showKeyboard = new ShowKeyboard(view);
+        showKeyboard.post();
     }
 
     public static void hideKeyboard(View view) {
-        InputMethodManager imm = (InputMethodManager) view.getContext()
-                .getSystemService(Context.INPUT_METHOD_SERVICE);
+        InputMethodManager imm = (InputMethodManager) view.getContext().getSystemService(Context.INPUT_METHOD_SERVICE);
+        if (imm == null) {
+            return;
+        }
+
         imm.hideSoftInputFromWindow(view.getWindowToken(), 0);
     }
 
@@ -59,21 +133,4 @@ public void run() {
     public static boolean isRTL(View view) {
         return ViewCompat.getLayoutDirection(view) == ViewCompat.LAYOUT_DIRECTION_RTL;
     }
-
-    /**
-     * Update the alpha value of the view with the given id. All kinds of failures (null activity,
-     * view not found, ..) will be ignored by this method.
-     */
-    public static void updateAlphaIfViewExists(@Nullable Activity activity, @IdRes int id, float alpha) {
-        if (activity == null) {
-            return;
-        }
-
-        final View view = activity.findViewById(id);
-        if (view == null) {
-            return;
-        }
-
-        view.setAlpha(alpha);
-    }
 }
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/BrowsingSession.java b/focus-android/app/src/main/java/org/mozilla/focus/web/BrowsingSession.java
deleted file mode 100644
index c1e74fc28dae..000000000000
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/BrowsingSession.java
+++ /dev/null
@@ -1,126 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.web;
-
-import android.content.Context;
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-
-import org.mozilla.focus.utils.SafeIntent;
-
-import java.lang.ref.WeakReference;
-import java.util.HashMap;
-import java.util.Map;
-
-/**
- * A global object keeping the state of the current browsing session.
- *
- * For now it only tracks whether a browsing session is active or not.
- */
-public class BrowsingSession {
-    private static BrowsingSession instance;
-
-    public interface TrackingCountListener {
-        void onTrackingCountChanged(int trackingCount);
-    }
-
-    public static synchronized BrowsingSession getInstance() {
-        if (instance == null) {
-            instance = new BrowsingSession();
-        }
-        return instance;
-    }
-
-    private boolean isActive;
-    private int blockedTrackers;
-    private WeakReference<TrackingCountListener> listenerWeakReference;
-    private @Nullable CustomTabConfig customTabConfig;
-
-    private Map<String, Bundle> webViewStates;
-
-    private BrowsingSession() {
-        listenerWeakReference = new WeakReference<>(null);
-        webViewStates = new HashMap<>();
-    }
-
-    public void start() {
-        isActive = true;
-    }
-
-    public void stop() {
-        isActive = false;
-        customTabConfig = null;
-        webViewStates.clear();
-    }
-
-    public boolean isActive() {
-        return isActive;
-    }
-
-    public void countBlockedTracker() {
-        blockedTrackers++;
-
-        final TrackingCountListener listener = listenerWeakReference.get();
-        if (listener != null) {
-            listener.onTrackingCountChanged(blockedTrackers);
-        }
-    }
-
-    public void setTrackingCountListener(TrackingCountListener listener) {
-        listenerWeakReference = new WeakReference<>(listener);
-        listener.onTrackingCountChanged(blockedTrackers);
-    }
-
-    public void resetTrackerCount() {
-        blockedTrackers = 0;
-    }
-
-    public void loadCustomTabConfig(final @NonNull Context context, final @NonNull SafeIntent intent) {
-        if (!CustomTabConfig.isCustomTabIntent(intent)) {
-            customTabConfig = null;
-            return;
-        }
-
-        customTabConfig = CustomTabConfig.parseCustomTabIntent(context, intent);
-    }
-
-    /**
-     * Keep a reference to this WebView state (saved in Bundle) linked to the given UUID so that
-     * we can restore it later.
-     */
-    public void putWebViewState(@NonNull String uuid, @NonNull Bundle bundle) {
-        webViewStates.put(uuid, bundle);
-    }
-
-    /**
-     * Get the WebView state saved linked to the given UUID or null if no such state exists.
-     */
-    @Nullable
-    public Bundle getWebViewState(@Nullable String uuid) {
-        return uuid != null ? webViewStates.get(uuid) : null;
-    }
-
-    /**
-     * Do we have a WebView state linked to the given UUID?
-     */
-    public boolean hasWebViewState(@Nullable String uuid) {
-        return uuid != null && webViewStates.containsKey(uuid);
-
-    }
-
-    public boolean isCustomTab() {
-        return customTabConfig != null;
-    }
-
-    public @NonNull CustomTabConfig getCustomTabConfig() {
-        if (!isCustomTab()) {
-            throw new IllegalStateException("Can't retrieve custom tab config for normal browsing session");
-        }
-
-        return customTabConfig;
-    }
-}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java b/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java
new file mode 100644
index 000000000000..967625ea332e
--- /dev/null
+++ b/focus-android/app/src/main/java/org/mozilla/focus/web/CleanupSessionObserver.java
@@ -0,0 +1,30 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.web;
+
+
+import android.content.Context;
+import android.support.annotation.NonNull;
+
+import org.mozilla.focus.architecture.NonNullObserver;
+import org.mozilla.focus.session.Session;
+
+import java.util.List;
+
+public class CleanupSessionObserver extends NonNullObserver<List<Session>> {
+    private final Context context;
+
+    public CleanupSessionObserver(Context context) {
+        this.context = context;
+    }
+
+    @Override
+    protected void onValueChanged(@NonNull List<Session> sessions) {
+        if (sessions.isEmpty()) {
+            // Make sure no browsing data remains on the device if there's no active session (anymore).
+            WebViewProvider.performCleanup(context);
+        }
+    }
+}
diff --git a/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java b/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
index f59faa80e366..0450a75e9b5b 100644
--- a/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
+++ b/focus-android/app/src/main/java/org/mozilla/focus/web/IWebView.java
@@ -5,12 +5,13 @@
 
 package org.mozilla.focus.web;
 
-import android.graphics.Bitmap;
 import android.os.Bundle;
 import android.support.annotation.NonNull;
 import android.support.annotation.Nullable;
 import android.view.View;
 
+import org.mozilla.focus.session.Session;
+
 public interface IWebView {
     class HitTarget {
         public final boolean isLink;
@@ -43,9 +44,6 @@ interface Callback {
 
         void onURLChanged(final String url);
 
-        /** Return true if the URL was handled, false if we should continue loading the current URL. */
-        boolean handleExternalUrl(String url);
-
         void onDownloadStart(Download download);
 
         void onLongPress(final HitTarget hitTarget);
@@ -67,6 +65,10 @@ interface Callback {
          * be hidden now.
          */
         void onExitFullScreen();
+
+        void countBlockedTracker();
+
+        void resetBlockedTrackers();
     }
 
     interface FullscreenCallback {
@@ -106,9 +108,9 @@ interface FullscreenCallback {
 
     boolean canGoBack();
 
-    void restoreWebViewState(Bundle inState);
+    void restoreWebViewState(Session session, Bundle inState);
 
-    void saveWebViewState(Bundle outState);
+    void saveWebViewState(@NonNull Session session, @NonNull Bundle outState);
 
     /**
      * Get the title of the currently displayed website.
diff --git a/focus-android/app/src/main/res/values/strings.xml b/focus-android/app/src/main/res/values/strings.xml
index 4fd0916b927d..7ae1f9caec86 100644
--- a/focus-android/app/src/main/res/values/strings.xml
+++ b/focus-android/app/src/main/res/values/strings.xml
@@ -76,7 +76,7 @@
 
     <!-- This is the label of an action we offer when the user selects text in other third-party apps.
          Clicking this action will launch Focus and perform a search in the default search engine. -->
-    <string name="text_selection_search_action">Search Privately</string>
+    <string name="text_selection_search_action">Search Secretly</string>
 
     <!-- Content of about focus. Argument 1 is the app name (Firefox Focus/Firefox Klar/etc).
          Argument 2 is the url for the learn-more link. -->
diff --git a/focus-android/app/src/main/res/xml-v25/shortcuts.xml b/focus-android/app/src/main/res/xml-v25/shortcuts.xml
index 1df54b3a2842..2ee682f1c2c5 100644
--- a/focus-android/app/src/main/res/xml-v25/shortcuts.xml
+++ b/focus-android/app/src/main/res/xml-v25/shortcuts.xml
@@ -12,8 +12,7 @@
         <intent
             android:action="erase"
             android:targetPackage="${applicationId}"
-            android:targetClass="org.mozilla.focus.activity.MainActivity">
-                <extra android:name="finish" android:value="true" />
+            android:targetClass="org.mozilla.focus.activity.EraseShortcutActivity">
                 <extra android:name="shortcut" android:value="true" />
         </intent>
     </shortcut>
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/web/CustomTabConfigTest.java b/focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java
similarity index 99%
rename from focus-android/app/src/test/java/org/mozilla/focus/web/CustomTabConfigTest.java
rename to focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java
index 29fd767b925e..4419209b1703 100644
--- a/focus-android/app/src/test/java/org/mozilla/focus/web/CustomTabConfigTest.java
+++ b/focus-android/app/src/test/java/org/mozilla/focus/customtabs/CustomTabConfigTest.java
@@ -1,4 +1,4 @@
-package org.mozilla.focus.web;
+package org.mozilla.focus.customtabs;
 
 import android.app.PendingIntent;
 import android.content.Intent;
@@ -15,6 +15,7 @@
 import org.junit.runner.RunWith;
 import org.mozilla.focus.BuildConfig;
 import org.mozilla.focus.R;
+import org.mozilla.focus.customtabs.CustomTabConfig;
 import org.mozilla.focus.utils.SafeIntent;
 import org.robolectric.RobolectricTestRunner;
 import org.robolectric.RuntimeEnvironment;
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java
new file mode 100644
index 000000000000..4fbf8da5fcaf
--- /dev/null
+++ b/focus-android/app/src/test/java/org/mozilla/focus/session/NotificationSessionObserverTest.java
@@ -0,0 +1,79 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.content.Context;
+import android.content.Intent;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.robolectric.RobolectricTestRunner;
+
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+@RunWith(RobolectricTestRunner.class)
+public class NotificationSessionObserverTest {
+    @Test
+    public void testEmptySession() {
+        final Context context = mock(Context.class);
+
+        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
+        observer.onChanged(Collections.<Session>emptyList());
+
+        verify(context).stopService(anyIntent());
+        verify(context, never()).startService(anyIntent());
+    }
+
+    @Test
+    public void testNullSession() {
+        final Context context = mock(Context.class);
+
+        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
+        observer.onChanged(null);
+
+        verify(context, never()).stopService(anyIntent());
+        verify(context, never()).startService(anyIntent());
+    }
+
+    @Test
+    public void testSingleSession() {
+        final Context context = mock(Context.class);
+
+        final List<Session> sessions = Collections.singletonList(mock(Session.class));
+
+        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
+        observer.onChanged(sessions);
+
+        verify(context, never()).stopService(anyIntent());
+        verify(context).startService(anyIntent());
+    }
+
+    @Test
+    public void testMultipleSessions() {
+        final Context context = mock(Context.class);
+
+        final List<Session> sessions = Arrays.asList(
+                mock(Session.class),
+                mock(Session.class),
+                mock(Session.class));
+
+        final NotificationSessionObserver observer = new NotificationSessionObserver(context);
+        observer.onChanged(sessions);
+
+        verify(context, never()).stopService(anyIntent());
+        verify(context).startService(anyIntent());
+    }
+
+    private Intent anyIntent() {
+        return any(Intent.class);
+    }
+}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java
new file mode 100644
index 000000000000..5bfff9684093
--- /dev/null
+++ b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionCallbackProxyTest.java
@@ -0,0 +1,87 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mozilla.focus.architecture.NonNullMutableLiveData;
+import org.mozilla.focus.web.IWebView;
+import org.robolectric.RobolectricTestRunner;
+
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+
+@RunWith(RobolectricTestRunner.class)
+public class SessionCallbackProxyTest {
+    private static final String TEST_URL = "https://github.com/mozilla-mobile/focus-android/";
+
+    @Test
+    public void testOnPageStarted() {
+        final Session session = mock(Session.class);
+        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
+
+        proxy.onPageStarted(TEST_URL);
+
+        verify(session).setUrl(TEST_URL);
+        verify(session).setLoading(true);
+        verify(session).setSecure(false);
+        verify(session).setProgress(SessionCallbackProxy.MINIMUM_PROGRESS);
+    }
+
+    @Test
+    public void testOnPageFinished() {
+        final Session session = mock(Session.class);
+        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
+
+        proxy.onPageFinished(true);
+
+        verify(session).setLoading(false);
+        verify(session).setSecure(true);
+    }
+
+    @Test
+    public void testOnProgress() {
+        final Session session = mock(Session.class);
+        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
+
+        proxy.onProgress(1);
+
+        verify(session).setProgress(SessionCallbackProxy.MINIMUM_PROGRESS);
+
+        proxy.onProgress(42);
+
+        verify(session).setProgress(42);
+    }
+
+    @Test
+    public void testOnUrlChanged() {
+        final Session session = mock(Session.class);
+        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
+
+        proxy.onURLChanged(TEST_URL);
+
+        verify(session).setUrl(TEST_URL);
+    }
+
+    @Test
+    public void testBlockedTrackerCounter() {
+        final NonNullMutableLiveData<Integer> blockedTrackerCounter = new NonNullMutableLiveData<>(50);
+
+        final Session session = mock(Session.class);
+        doReturn(blockedTrackerCounter).when(session).getBlockedTrackers();
+
+        final SessionCallbackProxy proxy = new SessionCallbackProxy(session, mock(IWebView.Callback.class));
+
+        proxy.countBlockedTracker();
+
+        verify(session).getBlockedTrackers();
+        verify(session).setTrackersBlocked(51);
+
+        proxy.resetBlockedTrackers();
+
+        verify(session).setTrackersBlocked(0);
+    }
+}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java
new file mode 100644
index 000000000000..03681614466a
--- /dev/null
+++ b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionManagerTest.java
@@ -0,0 +1,256 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.content.Intent;
+import android.graphics.Color;
+import android.net.Uri;
+import android.os.Bundle;
+import android.support.customtabs.CustomTabsIntent;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mozilla.focus.customtabs.CustomTabConfig;
+import org.mozilla.focus.utils.SafeIntent;
+import org.robolectric.RobolectricTestRunner;
+import org.robolectric.RuntimeEnvironment;
+
+import java.util.List;
+import java.util.UUID;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
+import static org.junit.Assert.assertTrue;
+
+@RunWith(RobolectricTestRunner.class)
+public class SessionManagerTest {
+    private static final String TEST_URL = "https://github.com/mozilla-mobile/focus-android";
+    private static final String TEST_URL_2 = "https://www.mozilla.org";
+    private static final String TEST_URL_3 = "https://www.mozilla.org/en-US/firefox/focus/";
+
+    @Before
+    public void setUp() {
+        // Always start tests with a clean session manager
+        SessionManager.getInstance().removeAllSessions();
+    }
+
+    @Test
+    public void testInitialState() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        assertNotNull(sessionManager.getSessions().getValue());
+        assertEquals(0, sessionManager.getSessions().getValue().size());
+        assertFalse(sessionManager.hasSession());
+    }
+
+    @Test
+    public void testViewIntent() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        final SafeIntent intent = new SafeIntent(new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL)));
+        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
+
+        final List<Session> sessions = sessionManager.getSessions().getValue();
+        assertNotNull(sessions);
+        assertEquals(1, sessions.size());
+
+        final Session session = sessions.get(0);
+        assertEquals(TEST_URL, session.getUrl().getValue());
+        assertFalse(session.isCustomTab());
+        assertNull(session.getCustomTabConfig());
+
+        assertTrue(sessionManager.hasSession());
+    }
+
+    @Test
+    public void testCustomTabIntent() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        final SafeIntent intent = new SafeIntent(new CustomTabsIntent.Builder()
+                .setToolbarColor(Color.GREEN)
+                .addDefaultShareMenuItem()
+                .build()
+                .intent
+                .setData(Uri.parse(TEST_URL)));
+
+        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
+
+        final List<Session> sessions = sessionManager.getSessions().getValue();
+        assertNotNull(sessions);
+        assertEquals(1, sessions.size());
+
+        final Session session = sessions.get(0);
+        assertEquals(TEST_URL, session.getUrl().getValue());
+        assertTrue(session.isCustomTab());
+        assertNotNull(session.getCustomTabConfig());
+
+        final CustomTabConfig config = session.getCustomTabConfig();
+        assertNotNull(config.toolbarColor);
+        assertEquals(Color.GREEN, config.toolbarColor.intValue());
+        assertTrue(config.showShareMenuItem);
+
+        assertTrue(sessionManager.hasSession());
+    }
+
+    @Test
+    public void testViewIntentFromHistoryIsIgnored() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        final Intent unsafeIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL));
+        unsafeIntent.addFlags(Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY);
+
+        final SafeIntent intent = new SafeIntent(unsafeIntent);
+        sessionManager.handleIntent(RuntimeEnvironment.application, intent, null);
+
+        final List<Session> sessions = sessionManager.getSessions().getValue();
+        assertNotNull(sessions);
+        assertEquals(0, sessions.size());
+
+        assertFalse(sessionManager.hasSession());
+    }
+
+    @Test
+    public void testNoSessionIsCreatedIfWeAreRestoring() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        final Bundle instanceState = new Bundle();
+
+        final SafeIntent intent = new SafeIntent(new Intent(Intent.ACTION_VIEW, Uri.parse(TEST_URL)));
+        sessionManager.handleIntent(RuntimeEnvironment.application, intent, instanceState);
+
+        final List<Session> sessions = sessionManager.getSessions().getValue();
+        assertNotNull(sessions);
+        assertEquals(0, sessions.size());
+
+        assertFalse(sessionManager.hasSession());
+    }
+
+    @Test
+    public void testShareIntentViaNewIntent() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        final Intent unsafeIntent = new Intent(Intent.ACTION_SEND);
+        unsafeIntent.putExtra(Intent.EXTRA_TEXT, TEST_URL);
+
+        sessionManager.handleNewIntent(RuntimeEnvironment.application, new SafeIntent(unsafeIntent));
+
+        final List<Session> sessions = sessionManager.getSessions().getValue();
+        assertNotNull(sessions);
+        assertEquals(1, sessions.size());
+
+        final Session session = sessions.get(0);
+        assertFalse(session.isSearch());
+        assertEquals(TEST_URL, session.getUrl().getValue());
+        assertFalse(session.isCustomTab());
+        assertNull(session.getCustomTabConfig());
+
+        assertTrue(sessionManager.hasSession());
+    }
+
+    @Test(expected = IllegalAccessError.class)
+    public void getCurrentSessionThrowsExceptionIfThereIsNoSession() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+        sessionManager.getCurrentSession();
+    }
+
+    @Test
+    public void testHasSessionWithUUID() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+        assertFalse(sessionManager.hasSessionWithUUID(UUID.randomUUID().toString()));
+
+        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
+
+        assertTrue(sessionManager.hasSession());
+
+        final Session session = sessionManager.getCurrentSession();
+        assertNotNull(session);
+        assertTrue(sessionManager.hasSessionWithUUID(session.getUUID()));
+        assertNotNull(sessionManager.getSessionByUUID(session.getUUID()));
+    }
+
+    @Test(expected = IllegalAccessError.class)
+    public void getSessionByUUIDThrowsExceptionIfSessionDoesNotExist() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+        sessionManager.getSessionByUUID(UUID.randomUUID().toString());
+    }
+
+    @Test
+    public void testRemovingSessions() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
+        sessionManager.createSession(Source.VIEW, TEST_URL_2);
+        sessionManager.createSession(Source.CUSTOM_TAB, TEST_URL_3);
+
+        {
+            final List<Session> sessions = sessionManager.getSessions().getValue();
+            assertEquals(3, sessions.size());
+        }
+
+        {
+            final Session currentSession = sessionManager.getCurrentSession();
+            assertEquals(Source.CUSTOM_TAB, currentSession.getSource());
+            assertEquals(TEST_URL_3, currentSession.getUrl().getValue());
+        }
+
+        sessionManager.removeCurrentSession();
+
+        {
+            final Session currentSession = sessionManager.getCurrentSession();
+            assertEquals(Source.VIEW, currentSession.getSource());
+            assertEquals(TEST_URL_2, currentSession.getUrl().getValue());
+        }
+
+        sessionManager.removeCurrentSession();
+
+        {
+            final Session currentSession = sessionManager.getCurrentSession();
+            assertEquals(Source.USER_ENTERED, currentSession.getSource());
+            assertEquals(TEST_URL, currentSession.getUrl().getValue());
+        }
+
+        sessionManager.removeCurrentSession();
+
+        assertFalse(sessionManager.hasSession());
+        assertEquals(0, sessionManager.getSessions().getValue().size());
+    }
+
+    @Test
+    public void testRemovingAllSessions() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+
+        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
+        sessionManager.createSession(Source.VIEW, TEST_URL_2);
+        sessionManager.createSession(Source.CUSTOM_TAB, TEST_URL_3);
+
+        assertTrue(sessionManager.hasSession());
+        assertEquals(3, sessionManager.getSessions().getValue().size());
+
+        sessionManager.removeAllSessions();
+
+        assertFalse(sessionManager.hasSession());
+        assertEquals(0, sessionManager.getSessions().getValue().size());
+    }
+
+    @Test
+    public void testHasSessionWithUUIDWithUnknownUUID() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+        sessionManager.createSession(Source.USER_ENTERED, TEST_URL);
+
+        assertFalse(sessionManager.hasSessionWithUUID(UUID.randomUUID().toString()));
+    }
+
+    @Test
+    public void testRemovingUnknownSessionHasNoEffect() {
+        final SessionManager sessionManager = SessionManager.getInstance();
+        sessionManager.removeSession(UUID.randomUUID().toString());
+
+        assertFalse(sessionManager.hasSession());
+        assertEquals(0, sessionManager.getSessions().getValue().size());
+    }
+}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java
new file mode 100644
index 000000000000..3048235b33d5
--- /dev/null
+++ b/focus-android/app/src/test/java/org/mozilla/focus/session/SessionTest.java
@@ -0,0 +1,216 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+package org.mozilla.focus.session;
+
+import android.arch.lifecycle.Lifecycle;
+import android.arch.lifecycle.LifecycleOwner;
+import android.arch.lifecycle.Observer;
+import android.content.Intent;
+import android.graphics.Color;
+import android.net.Uri;
+import android.os.Bundle;
+import android.support.customtabs.CustomTabsIntent;
+import android.text.TextUtils;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mozilla.focus.customtabs.CustomTabConfig;
+import org.mozilla.focus.utils.SafeIntent;
+import org.robolectric.RobolectricTestRunner;
+import org.robolectric.RuntimeEnvironment;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertNull;
+import static org.junit.Assert.assertTrue;
+import static org.mockito.ArgumentMatchers.same;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+
+@RunWith(RobolectricTestRunner.class)
+public class SessionTest {
+    private static final String TEST_URL = "https://www.mozilla.org";
+    private static final String TEST_URL_2 = "https://www.example.org";
+
+    @Test
+    public void testEmptySession() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+
+        assertFalse(TextUtils.isEmpty(session.getUUID()));
+        assertEquals(TEST_URL, session.getUrl().getValue());
+
+        assertEquals(0, (int) session.getProgress().getValue());
+        assertFalse(session.getSecure().getValue());
+        assertFalse(session.getLoading().getValue());
+        assertEquals(0, (int) session.getBlockedTrackers().getValue());
+
+        assertNull(session.getCustomTabConfig());
+        assertFalse(session.isCustomTab());
+    }
+
+    @Test
+    public void testObserversGetInitialValues() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+
+        {
+            final Observer<String> urlObserver = mockObserver();
+            session.getUrl().observe(mockLifeCycleOwner(), urlObserver);
+            verify(urlObserver).onChanged(TEST_URL);
+        }
+        {
+            final Observer<Integer> progressObserver = mockObserver();
+            session.getProgress().observe(mockLifeCycleOwner(), progressObserver);
+            verify(progressObserver).onChanged(0);
+        }
+        {
+            final Observer<Boolean> secureObserver = mockObserver();
+            session.getSecure().observe(mockLifeCycleOwner(), secureObserver);
+            verify(secureObserver).onChanged(false);
+        }
+        {
+            final Observer<Boolean> loadingObserver = mockObserver();
+            session.getLoading().observe(mockLifeCycleOwner(), loadingObserver);
+            verify(loadingObserver).onChanged(false);
+        }
+        {
+            final Observer<Integer> blockedTrackersObserver = mockObserver();
+            session.getBlockedTrackers().observe(mockLifeCycleOwner(), blockedTrackersObserver);
+            verify(blockedTrackersObserver).onChanged(0);
+        }
+    }
+
+    @Test
+    public void testObservingValueChanges() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+
+        {
+            final Observer<String> urlObserver = mockObserver();
+            session.getUrl().observe(mockLifeCycleOwner(), urlObserver);
+            verify(urlObserver).onChanged(TEST_URL);
+
+            session.setUrl(TEST_URL_2);
+            verify(urlObserver).onChanged(TEST_URL_2);
+        }
+        {
+            final Observer<Integer> progressObserver = mockObserver();
+            session.getProgress().observe(mockLifeCycleOwner(), progressObserver);
+            verify(progressObserver).onChanged(0);
+
+            session.setProgress(42);
+            verify(progressObserver).onChanged(42);
+        }
+        {
+            final Observer<Boolean> secureObserver = mockObserver();
+            session.getSecure().observe(mockLifeCycleOwner(), secureObserver);
+            verify(secureObserver).onChanged(false);
+
+            session.setSecure(true);
+            verify(secureObserver).onChanged(true);
+        }
+        {
+            final Observer<Boolean> loadingObserver = mockObserver();
+            session.getLoading().observe(mockLifeCycleOwner(), loadingObserver);
+            verify(loadingObserver).onChanged(false);
+
+            session.setLoading(true);
+            verify(loadingObserver).onChanged(true);
+        }
+        {
+            final Observer<Integer> blockedTrackersObserver = mockObserver();
+            session.getBlockedTrackers().observe(mockLifeCycleOwner(), blockedTrackersObserver);
+            verify(blockedTrackersObserver).onChanged(0);
+
+            session.setTrackersBlocked(23);
+            verify(blockedTrackersObserver).onChanged(23);
+        }
+    }
+
+    @Test
+    public void testCustomTabConfiguration() {
+        final CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
+        builder.setToolbarColor(Color.GREEN);
+
+        final SafeIntent intent = new SafeIntent(builder.build().intent);
+        final CustomTabConfig customTabConfig = CustomTabConfig.parseCustomTabIntent(RuntimeEnvironment.application, intent);
+        final Session session = new Session(TEST_URL, customTabConfig);
+
+        assertTrue(session.isCustomTab());
+        assertNotNull(session.getCustomTabConfig());
+        assertNotNull(session.getCustomTabConfig().toolbarColor);
+        assertEquals(Color.GREEN, (int) session.getCustomTabConfig().toolbarColor);
+    }
+
+    @Test
+    public void testSavingAndRetrievingWebViewState() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+
+        assertNull(session.getWebViewState());
+
+        {
+            final Bundle bundle = new Bundle();
+            bundle.putInt("friday", 13);
+
+            session.saveWebViewState(bundle);
+        }
+
+        assertNotNull(session.getWebViewState());
+
+        {
+            final Bundle bundle = session.getWebViewState();
+            assertTrue(bundle.containsKey("friday"));
+            assertEquals(13, bundle.getInt("friday"));
+        }
+    }
+
+    @Test
+    public void testIsSearch() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+        assertFalse(session.isSearch());
+
+        session.setSearch(true);
+        assertTrue(session.isSearch());
+
+        session.setSearch(false);
+        assertFalse(session.isSearch());
+    }
+
+    @Test
+    public void testIsRecorded() {
+        final Session session = new Session(Source.VIEW, TEST_URL);
+        assertFalse(session.isRecorded());
+
+        session.markAsRecorded();
+        assertTrue(session.isRecorded());
+    }
+
+    @Test
+    public void testSameAs() {
+        final Session session1 = new Session(Source.VIEW, TEST_URL);
+        final Session session2 = new Session(Source.VIEW, TEST_URL);
+
+        assertFalse(session1.isSameAs(session2));
+        assertFalse(session2.isSameAs(session1));
+
+        assertTrue(session1.isSameAs(session1));
+        assertTrue(session2.isSameAs(session2));
+    }
+
+    @SuppressWarnings("unchecked")
+    private <T> Observer<T> mockObserver() {
+        return mock(Observer.class);
+    }
+
+    private LifecycleOwner mockLifeCycleOwner() {
+        final Lifecycle lifecycle = mock(Lifecycle.class);
+        doReturn(Lifecycle.State.RESUMED).when(lifecycle).getCurrentState();
+
+        final LifecycleOwner lifecycleOwner = mock(LifecycleOwner.class);
+        doReturn(lifecycle).when(lifecycleOwner).getLifecycle();
+
+        return lifecycleOwner;
+    }
+}
\ No newline at end of file
diff --git a/focus-android/app/src/test/java/org/mozilla/focus/web/BrowsingSessionTest.java b/focus-android/app/src/test/java/org/mozilla/focus/web/BrowsingSessionTest.java
deleted file mode 100644
index f5cd1d46424c..000000000000
--- a/focus-android/app/src/test/java/org/mozilla/focus/web/BrowsingSessionTest.java
+++ /dev/null
@@ -1,39 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.web;
-
-import org.junit.Test;
-
-import static org.junit.Assert.*;
-
-public class BrowsingSessionTest {
-    @Test
-    public void testSingleton() {
-        assertNotNull(BrowsingSession.getInstance());
-
-        assertEquals(BrowsingSession.getInstance(), BrowsingSession.getInstance());
-    }
-
-    @Test
-    public void testActive() {
-        assertFalse(BrowsingSession.getInstance().isActive());
-
-        BrowsingSession.getInstance().start();
-
-        assertTrue(BrowsingSession.getInstance().isActive());
-
-        BrowsingSession.getInstance().stop();
-
-        assertFalse(BrowsingSession.getInstance().isActive());
-
-        BrowsingSession.getInstance().start();
-        BrowsingSession.getInstance().start();
-
-        BrowsingSession.getInstance().stop();
-
-        assertFalse(BrowsingSession.getInstance().isActive());
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/FocusWebViewClient.java b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/FocusWebViewClient.java
index 9975cfd4c292..e3480d5dd5da 100644
--- a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/FocusWebViewClient.java
+++ b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/FocusWebViewClient.java
@@ -23,6 +23,7 @@
 import org.mozilla.focus.R;
 import org.mozilla.focus.locale.Locales;
 import org.mozilla.focus.utils.HtmlLoader;
+import org.mozilla.focus.utils.IntentUtils;
 import org.mozilla.focus.utils.SupportUtils;
 import org.mozilla.focus.utils.UrlUtils;
 import org.mozilla.focus.web.IWebView;
@@ -36,19 +37,14 @@
 /* package */ class FocusWebViewClient extends TrackingProtectionWebViewClient {
     private final static String ERROR_PROTOCOL = "error:";
 
-    private IWebView.Callback callback;
     private boolean errorReceived;
     private Context context;
 
-    public FocusWebViewClient(Context context) {
+    /* package */ FocusWebViewClient(Context context) {
         super(context);
         this.context = context;
     }
 
-    public void setCallback(IWebView.Callback callback) {
-        this.callback = callback;
-    }
-
     /**
      * Always ensure the following is wrapped in an anonymous function before execution.
      * (We don't wrap here, since this code might be run as part of a larger function, see
@@ -214,7 +210,7 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {
         final Uri uri = Uri.parse(url);
         if (!UrlUtils.isSupportedProtocol(uri.getScheme()) &&
                 callback != null &&
-                callback.handleExternalUrl(url)) {
+                IntentUtils.handleExternalUri(view.getContext(), (IWebView) view, url)) {
             return true;
         }
 
diff --git a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/TrackingProtectionWebViewClient.java b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/TrackingProtectionWebViewClient.java
index fe40b8e5237b..e276440c1254 100644
--- a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/TrackingProtectionWebViewClient.java
+++ b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/TrackingProtectionWebViewClient.java
@@ -7,25 +7,20 @@
 import android.content.Context;
 import android.graphics.Bitmap;
 import android.net.Uri;
-import android.net.http.SslError;
 import android.os.AsyncTask;
 import android.support.annotation.WorkerThread;
-import android.webkit.SslErrorHandler;
 import android.webkit.WebResourceRequest;
 import android.webkit.WebResourceResponse;
 import android.webkit.WebView;
 import android.webkit.WebViewClient;
 
 import org.mozilla.focus.R;
-import org.mozilla.focus.web.BrowsingSession;
+import org.mozilla.focus.web.IWebView;
 import org.mozilla.focus.webkit.matcher.UrlMatcher;
 
 public class TrackingProtectionWebViewClient extends WebViewClient {
     private static volatile UrlMatcher MATCHER;
 
-    private boolean blockingEnabled;
-    /* package */ String currentPageURL;
-
     public static void triggerPreload(final Context context) {
         // Only trigger loading if MATCHER is null. (If it's null, MATCHER could already be loading,
         // but we don't have any way of being certain - and there's no real harm since we're not
@@ -49,6 +44,10 @@ protected Void doInBackground(Void... voids) {
         return MATCHER;
     }
 
+    private boolean blockingEnabled;
+    /* package */ String currentPageURL;
+    protected IWebView.Callback callback;
+
     /* package */ TrackingProtectionWebViewClient(final Context context) {
         // Hopefully we have loaded background data already. We call triggerPreload() to try to trigger
         // background loading of the lists as early as possible.
@@ -57,6 +56,10 @@ protected Void doInBackground(Void... voids) {
         this.blockingEnabled = true;
     }
 
+    public void setCallback(IWebView.Callback callback) {
+        this.callback = callback;
+    }
+
     public void setBlockingEnabled(boolean enabled) {
         this.blockingEnabled = enabled;
     }
@@ -103,7 +106,9 @@ public WebResourceResponse shouldInterceptRequest(final WebView view, final WebR
         final Uri pageUri = Uri.parse(currentPageURL);
         if ((!request.isForMainFrame()) &&
                 matcher.matches(resourceUri, pageUri)) {
-            BrowsingSession.getInstance().countBlockedTracker();
+            if (callback != null) {
+                callback.countBlockedTracker();
+            }
             return new WebResourceResponse(null, null, null);
         }
 
@@ -123,8 +128,8 @@ public void notifyCurrentURL(final String url) {
 
     @Override
     public void onPageStarted(WebView view, String url, Bitmap favicon) {
-        if (blockingEnabled) {
-            BrowsingSession.getInstance().resetTrackerCount();
+        if (callback != null) {
+            callback.resetBlockedTrackers();
         }
 
         currentPageURL = url;
diff --git a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/WebkitView.java b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/WebkitView.java
index c97aff8cb645..a402675a94b3 100644
--- a/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/WebkitView.java
+++ b/focus-android/app/src/webkit/java/org/mozilla/focus/webkit/WebkitView.java
@@ -7,7 +7,6 @@
 
 import android.content.Context;
 import android.content.SharedPreferences;
-import android.graphics.Bitmap;
 import android.net.Uri;
 import android.os.Bundle;
 import android.os.Environment;
@@ -24,17 +23,15 @@
 import android.webkit.WebViewDatabase;
 
 import org.mozilla.focus.BuildConfig;
+import org.mozilla.focus.session.Session;
 import org.mozilla.focus.utils.AppConstants;
 import org.mozilla.focus.utils.FileUtils;
 import org.mozilla.focus.utils.ThreadUtils;
 import org.mozilla.focus.utils.UrlUtils;
-import org.mozilla.focus.web.BrowsingSession;
 import org.mozilla.focus.web.Download;
 import org.mozilla.focus.web.IWebView;
 import org.mozilla.focus.web.WebViewProvider;
 
-import java.util.UUID;
-
 public class WebkitView extends NestedWebView implements IWebView, SharedPreferences.OnSharedPreferenceChangeListener {
     private static final String TAG = "WebkitView";
     private static final String KEY_CURRENTURL = "currenturl";
@@ -83,14 +80,18 @@ public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, Strin
     }
 
     @Override
-    public void restoreWebViewState(Bundle inBundle) {
-        final BrowsingSession session = BrowsingSession.getInstance();
-
+    public void restoreWebViewState(Session session, Bundle inBundle) {
         // Let's see if there's a UUID in the bundle and whether we have a state assigned to this UUID.
         final String uuid = inBundle.getString(KEY_STATE_UUID);
+        if (!session.getUUID().equals(uuid)) {
+            // This session and the stored state do not match.
+            return;
+        }
+
+        final Bundle stateData = session.getWebViewState();
 
-        final WebBackForwardList backForwardList = session.hasWebViewState(uuid)
-                ? super.restoreState(session.getWebViewState(uuid))
+        final WebBackForwardList backForwardList = stateData != null
+                ? super.restoreState(stateData)
                 : null;
 
         // Pages are only added to the back/forward list when loading finishes. If a new page is
@@ -116,21 +117,19 @@ public void restoreWebViewState(Bundle inBundle) {
     }
 
     @Override
-    public void saveWebViewState(Bundle outState) {
+    public void saveWebViewState(Session session, Bundle outState) {
         // We store the actual state into another bundle that we will keep in memory as long as this
         // browsing session is active. The data that WebView stores in this bundle is too large for
         // Android to save and restore as part of the state bundle.
         final Bundle stateData = new Bundle();
         super.saveState(stateData);
 
-        // We generate a UUID that we will store in the bundle that Android saves and restores. The
+        session.saveWebViewState(stateData);
+
+        // We will only store the session UUID in the bundle that Android saves and restores. The
         // actual data will be kept in memory and we are going to use the UUID to lookup the data
         // when restoring.
-        final String uuid = UUID.randomUUID().toString();
-
-        BrowsingSession.getInstance().putWebViewState(uuid, stateData);
-
-        outState.putString(KEY_STATE_UUID, uuid);
+        outState.putString(KEY_STATE_UUID, session.getUUID());
 
         // See restoreWebViewState() for an explanation of why we need to save this in _addition_
         // to WebView's state
@@ -219,7 +218,7 @@ public void onProgressChanged(WebView view, int newProgress) {
                     // so we can only check the updated url in onProgressChanges(), or in onPageFinished()
                     // (which is even later).
                     final String viewURL = view.getUrl();
-                    if (!UrlUtils.isInternalErrorURL(viewURL)) {
+                    if (!UrlUtils.isInternalErrorURL(viewURL) && viewURL != null) {
                         callback.onURLChanged(viewURL);
                     }
                     callback.onProgress(newProgress);
diff --git a/focus-android/build.gradle b/focus-android/build.gradle
index b1c78fe784e8..914b8e078205 100644
--- a/focus-android/build.gradle
+++ b/focus-android/build.gradle
@@ -16,6 +16,7 @@ buildscript {
 allprojects {
     repositories {
         jcenter()
+        maven { url 'https://maven.google.com' }
     }
 }
 
