diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.java
deleted file mode 100644
index 315163e9dd9c..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.java
+++ /dev/null
@@ -1,131 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import androidx.annotation.IdRes;
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.IdlingRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.SessionLoadedIdlingResource;
-import org.mozilla.focus.utils.AppConstants;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.Espresso.pressBack;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static org.hamcrest.Matchers.containsString;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.openMenu;
-
-// This test visits each page and checks whether some essential elements are being displayed
-// https://testrail.stage.mozaws.net/index.php?/cases/view/81664
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class AccessAboutAndYourRightsPagesTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-        }
-    };
-
-    private SessionLoadedIdlingResource loadingIdlingResource;
-
-    @Before
-    public void setUp() {
-
-        loadingIdlingResource = new SessionLoadedIdlingResource();
-        IdlingRegistry.getInstance().register(loadingIdlingResource);
-    }
-
-    @After
-    public void tearDown() {
-        IdlingRegistry.getInstance().unregister(loadingIdlingResource);
-
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void AboutAndYourRightsPagesTest() {
-        final Context context = InstrumentationRegistry.getInstrumentation().getTargetContext();
-
-        // What's new page
-        openMenu();
-        clickMenuItem(R.id.whats_new);
-        assertWebsiteUrlContains("support.mozilla.org");
-        pressBack();
-
-        // Help page
-        openMenu();
-        clickMenuItem(R.id.help);
-        assertWebsiteUrlContains("what-firefox-focus-android");
-        pressBack();
-
-        // Go to settings "About" page
-        openMenu();
-        clickMenuItem(R.id.settings);
-        final String mozillaMenuLabel = context.getString(R.string.preference_category_mozilla, context.getString(R.string.app_name));
-        onView(withText(mozillaMenuLabel))
-                .check(matches(isDisplayed()))
-                .perform(click());
-
-        final String aboutLabel = context.getString(R.string.preference_about, context.getString(R.string.app_name));
-        onView(withText(aboutLabel))
-                .check(matches(isDisplayed()))
-                .perform(click());
-        onView(withId(R.id.infofragment))
-                .check(matches(isDisplayed()))
-                .perform(click());
-        pressBack();  // This takes to Mozilla Submenu of settings
-
-        // "Your rights" page
-        onView(withText(context.getString(R.string.your_rights)))
-                .check(matches(isDisplayed()))
-                .perform(click());
-        onView(withId(R.id.infofragment))
-                .check(matches(isDisplayed()))
-                .perform(click());
-    }
-
-    private void clickMenuItem(@IdRes int id) {
-        onView(withId(id))
-                .check(matches(isDisplayed()))
-                .perform(click());
-    }
-
-    private void assertWebsiteUrlContains(String substring) {
-        onView(withId(R.id.display_url))
-                .check(matches(isDisplayed()))
-                .check(matches(withText(containsString(substring))));
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.kt
new file mode 100644
index 000000000000..6cf6157ad591
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessAboutAndYourRightsPagesTest.kt
@@ -0,0 +1,104 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.annotation.IdRes
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.IdlingRegistry
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import org.hamcrest.Matchers
+import org.junit.After
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.EspressoHelper.openMenu
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.SessionLoadedIdlingResource
+
+// This test visits each page and checks whether some essential elements are being displayed
+// https://testrail.stage.mozaws.net/index.php?/cases/view/81664
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class AccessAboutAndYourRightsPagesTest {
+    @get: Rule
+    val mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    private var loadingIdlingResource: SessionLoadedIdlingResource? = null
+    @Before
+    fun setUp() {
+        loadingIdlingResource = SessionLoadedIdlingResource()
+        IdlingRegistry.getInstance().register(loadingIdlingResource)
+    }
+
+    @After
+    fun tearDown() {
+        IdlingRegistry.getInstance().unregister(loadingIdlingResource)
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Test
+    fun AboutAndYourRightsPagesTest() {
+        val context = InstrumentationRegistry.getInstrumentation().targetContext
+
+        // What's new page
+        openMenu()
+        clickMenuItem(R.id.whats_new)
+        assertWebsiteUrlContains("support.mozilla.org")
+        Espresso.pressBack()
+
+        // Help page
+        openMenu()
+        clickMenuItem(R.id.help)
+        assertWebsiteUrlContains("what-firefox-focus-android")
+        Espresso.pressBack()
+
+        // Go to settings "About" page
+        openMenu()
+        clickMenuItem(R.id.settings)
+        val mozillaMenuLabel = context.getString(
+            R.string.preference_category_mozilla,
+            context.getString(R.string.app_name)
+        )
+        Espresso.onView(ViewMatchers.withText(mozillaMenuLabel))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        val aboutLabel =
+            context.getString(R.string.preference_about, context.getString(R.string.app_name))
+        Espresso.onView(ViewMatchers.withText(aboutLabel))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.infofragment))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        Espresso.pressBack() // This takes to Mozilla Submenu of settings
+
+        // "Your rights" page
+        Espresso.onView(ViewMatchers.withText(context.getString(R.string.your_rights)))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.infofragment))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+    }
+
+    private fun clickMenuItem(@IdRes id: Int) {
+        Espresso.onView(ViewMatchers.withId(id))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+    }
+
+    private fun assertWebsiteUrlContains(substring: String) {
+        Espresso.onView(ViewMatchers.withId(R.id.display_url))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.withText(Matchers.containsString(substring))))
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.java
deleted file mode 100644
index 09391eb0f6dc..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.java
+++ /dev/null
@@ -1,90 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import static junit.framework.Assert.assertTrue;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test checks all the headings in the Settings menu are there
-// https://testrail.stage.mozaws.net/index.php?/cases/view/40064
-@RunWith(AndroidJUnit4.class)
-public class AccessSettingsTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void AccessSettingsTest() {
-
-        UiObject generalHeading = TestHelper.mDevice.findObject(new UiSelector()
-                .text("General")
-                .resourceId("android:id/title"));
-
-        UiObject privacyHeading = TestHelper.mDevice.findObject(new UiSelector()
-                .text("Privacy & Security")
-                .resourceId("android:id/title"));
-
-        UiObject searchHeading = TestHelper.mDevice.findObject(new UiSelector()
-                .text("Search")
-                .resourceId("android:id/title"));
-
-        UiObject mozHeading = TestHelper.mDevice.findObject(new UiSelector()
-                .text("Mozilla")
-                .resourceId("android:id/title"));
-
-        /* Go to Settings */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        openSettings();
-        generalHeading.waitForExists(waitingTime);
-
-        /* Check the first element and other headings are present */
-        assertTrue(generalHeading.exists());
-        assertTrue(searchHeading.exists());
-        assertTrue(privacyHeading.exists());
-        assertTrue(mozHeading.exists());
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.kt
new file mode 100644
index 000000000000..5b545b4a5c78
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AccessSettingsTest.kt
@@ -0,0 +1,58 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiSelector
+import org.junit.Assert
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+
+// This test checks all the headings in the Settings menu are there
+// https://testrail.stage.mozaws.net/index.php?/cases/view/40064
+@RunWith(AndroidJUnit4ClassRunner::class)
+class AccessSettingsTest {
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    val generalHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("General")
+            .resourceId("android:id/title")
+    )
+    val privacyHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Privacy & Security")
+            .resourceId("android:id/title")
+    )
+    val searchHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Search")
+            .resourceId("android:id/title")
+    )
+    val mozHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Mozilla")
+            .resourceId("android:id/title")
+    )
+
+    @Test
+    fun AccessSettingsTest() {
+        /* Go to Settings */TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        openSettings()
+        generalHeading.waitForExists(waitingTime)
+
+        /* Check the first element and other headings are present */
+        Assert.assertTrue(generalHeading.exists())
+        Assert.assertTrue(searchHeading.exists())
+        Assert.assertTrue(privacyHeading.exists())
+        Assert.assertTrue(mozHeading.exists())
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.java
deleted file mode 100644
index 09999affb30c..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.java
+++ /dev/null
@@ -1,270 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.os.Build;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Assert;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-import static org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime;
-
-// https://testrail.stage.mozaws.net/index.php?/cases/view/60852
-// includes:
-// https://testrail.stage.mozaws.net/index.php?/cases/view/40066
-@RunWith(AndroidJUnit4.class)
-public class AddToHomescreenTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-    private int webServerPort;
-    private String webServerBookmarkName;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule  = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-            final Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-
-            webServer = new MockWebServer();
-            // note: requesting getPort() will automatically start the mock server,
-            //       so if you use the 2 lines, do not try to start server or it will choke.
-            webServerPort = webServer.getPort();
-            webServerBookmarkName = "localhost_" + Integer.toString(webServerPort);
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    private UiObject welcomeBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("com.android.launcher3:id/cling_dismiss_longpress_info")
-            .text("GOT IT")
-            .enabled(true));
-
-    private void handleShortcutLayoutDialog() throws UiObjectNotFoundException {
-        TestHelper.AddautoBtn.waitForExists(waitingTime);
-        TestHelper.AddautoBtn.click();
-        TestHelper.AddautoBtn.waitUntilGone(waitingTime);
-        TestHelper.pressHomeKey();
-    }
-
-    private void openAddtoHSDialog() throws UiObjectNotFoundException {
-        TestHelper.menuButton.perform(click());
-        TestHelper.AddtoHSmenuItem.waitForExists(waitingTime);
-        // If the menu item is not clickable, wait and retry
-        while (!TestHelper.AddtoHSmenuItem.isClickable()) {
-            TestHelper.pressBackKey();
-            TestHelper.menuButton.perform(click());
-        }
-        TestHelper.AddtoHSmenuItem.click();
-    }
-
-    @Test
-    public void AddToHomeScreenTest() throws UiObjectNotFoundException {
-
-        UiObject shortcutIcon = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .description(webServerBookmarkName)
-                .enabled(true));
-
-        // Open website, and click 'Add to homescreen'
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.progressBar.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime));
-
-        openAddtoHSDialog();
-        // Add to Home screen dialog is now shown
-        TestHelper.shortcutTitle.waitForExists(waitingTime);
-
-        Assert.assertTrue(TestHelper.shortcutTitle.isEnabled());
-        Assert.assertEquals(TestHelper.shortcutTitle.getText(), "gigantic experience");
-        Assert.assertTrue(TestHelper.AddtoHSOKBtn.isEnabled());
-        Assert.assertTrue(TestHelper.AddtoHSCancelBtn.isEnabled());
-
-        //Edit shortcut text
-        TestHelper.shortcutTitle.click();
-        TestHelper.shortcutTitle.setText(webServerBookmarkName);
-        TestHelper.AddtoHSOKBtn.click();
-
-        // For Android O, we need additional steps
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
-            handleShortcutLayoutDialog();
-        }
-
-        //App is sent to background, in launcher now
-        if (welcomeBtn.exists()) {
-            welcomeBtn.click();
-        }
-        shortcutIcon.waitForExists(waitingTime);
-        Assert.assertTrue(shortcutIcon.isEnabled());
-        shortcutIcon.click();
-        TestHelper.browserURLbar.waitForExists(waitingTime);
-        Assert.assertTrue(
-                TestHelper.browserURLbar.getText()
-                        .equals(webServer.url(TEST_PATH).toString()));
-    }
-
-    @Test
-    public void NonameTest() throws UiObjectNotFoundException {
-        UiObject shortcutIcon = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .description(webServerBookmarkName)
-                .enabled(true));
-
-        // Open website, and click 'Add to homescreen'
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.progressBar.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime));
-
-        openAddtoHSDialog();
-
-        // "Add to Home screen" dialog is now shown
-        TestHelper.shortcutTitle.waitForExists(waitingTime);
-
-        Assert.assertTrue(TestHelper.shortcutTitle.isEnabled());
-        Assert.assertEquals(TestHelper.shortcutTitle.getText(), "gigantic experience");
-        Assert.assertTrue(TestHelper.AddtoHSOKBtn.isEnabled());
-        Assert.assertTrue(TestHelper.AddtoHSCancelBtn.isEnabled());
-
-        //replace shortcut text
-        TestHelper.shortcutTitle.click();
-        TestHelper.shortcutTitle.setText(webServerBookmarkName);
-        TestHelper.AddtoHSOKBtn.click();
-
-        // For Android O, we need additional steps
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
-            handleShortcutLayoutDialog();
-        }
-        if (welcomeBtn.exists()) {
-            welcomeBtn.click();
-        }
-        //App is sent to background, in launcher now
-        //Start from home and then swipe, to ensure we land where we want to search for shortcut
-        TestHelper.mDevice.pressHome();
-        TestHelper.swipeScreenLeft();
-        shortcutIcon.waitForExists(waitingTime);
-        Assert.assertTrue(shortcutIcon.isEnabled());
-        shortcutIcon.click();
-        TestHelper.browserURLbar.waitForExists(waitingTime);
-        Assert.assertTrue(
-                TestHelper.browserURLbar.getText()
-                        .equals(webServer.url(TEST_PATH).toString()));
-    }
-
-    @Test
-    public void SearchTermShortcutTest() throws UiObjectNotFoundException {
-        UiObject shortcutIcon = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .descriptionContains("helloworld")
-                .enabled(true));
-
-        // Open website, and click 'Add to homescreen'
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("helloworld");
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        // In certain cases, where progressBar disappears immediately, below will return false
-        // since it busy waits, it will unblock when the bar isn't visible, regardless of the
-        // return value
-        TestHelper.progressBar.waitForExists(waitingTime);
-        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime);
-
-        openAddtoHSDialog();
-
-        // "Add to Home screen" dialog is now shown
-        TestHelper.shortcutTitle.waitForExists(waitingTime);
-        TestHelper.AddtoHSOKBtn.click();
-
-        // For Android O, we need additional steps
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
-            handleShortcutLayoutDialog();
-        }
-
-        if (welcomeBtn.exists()) {
-            welcomeBtn.click();
-        }
-
-        //App is sent to background, in launcher now
-        //Start from home and then swipe, to ensure we land where we want to search for shortcut
-        TestHelper.mDevice.pressHome();
-        TestHelper.swipeScreenLeft();
-        shortcutIcon.waitForExists(waitingTime);
-        Assert.assertTrue(shortcutIcon.isEnabled());
-        shortcutIcon.click();
-        TestHelper.waitForIdle();
-        TestHelper.waitForWebContent();
-
-        //Tap URL bar and check the search term is still shown
-        TestHelper.browserURLbar.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.browserURLbar.getText().contains("helloworld"));
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.kt
new file mode 100644
index 000000000000..c0b247859488
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/AddToHomescreenTest.kt
@@ -0,0 +1,265 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.os.Build
+import android.os.Build.VERSION
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.pressHomeKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.swipeScreenLeft
+import org.mozilla.focus.helpers.TestHelper.waitForIdle
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime
+import java.io.IOException
+
+// https://testrail.stage.mozaws.net/index.php?/cases/view/60852
+// includes:
+// https://testrail.stage.mozaws.net/index.php?/cases/view/40066
+@RunWith(AndroidJUnit4ClassRunner::class)
+class AddToHomescreenTest {
+    private var webServer: MockWebServer? = null
+    private var webServerPort = 0
+    private var webServerBookmarkName: String? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setup() {
+        webServer = MockWebServer()
+        // note: requesting getPort() will automatically start the mock server,
+        //       so if you use the 2 lines, do not try to start server or it will choke.
+        webServerPort = webServer!!.port
+        webServerBookmarkName = "localhost_" + Integer.toString(webServerPort)
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    private val welcomeBtn = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId("com.android.launcher3:id/cling_dismiss_longpress_info")
+            .text("GOT IT")
+            .enabled(true)
+    )
+
+    @Throws(UiObjectNotFoundException::class)
+    private fun handleShortcutLayoutDialog() {
+        TestHelper.AddautoBtn.waitForExists(waitingTime)
+        TestHelper.AddautoBtn.click()
+        TestHelper.AddautoBtn.waitUntilGone(waitingTime)
+        pressHomeKey()
+    }
+
+    @Throws(UiObjectNotFoundException::class)
+    private fun openAddtoHSDialog() {
+        TestHelper.menuButton.perform(ViewActions.click())
+        TestHelper.AddtoHSmenuItem.waitForExists(waitingTime)
+        // If the menu item is not clickable, wait and retry
+        while (!TestHelper.AddtoHSmenuItem.isClickable) {
+            pressBackKey()
+            TestHelper.menuButton.perform(ViewActions.click())
+        }
+        TestHelper.AddtoHSmenuItem.click()
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    @Suppress("LongMethod")
+    fun AddToHomeScreenTest() {
+        val shortcutIcon = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .description(webServerBookmarkName)
+                .enabled(true)
+        )
+
+        // Open website, and click 'Add to homescreen'
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        TestHelper.progressBar.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime))
+        openAddtoHSDialog()
+        // Add to Home screen dialog is now shown
+        TestHelper.shortcutTitle.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.shortcutTitle.isEnabled)
+        Assert.assertEquals(TestHelper.shortcutTitle.text, "gigantic experience")
+        Assert.assertTrue(TestHelper.AddtoHSOKBtn.isEnabled)
+        Assert.assertTrue(TestHelper.AddtoHSCancelBtn.isEnabled)
+
+        // Edit shortcut text
+        TestHelper.shortcutTitle.click()
+        TestHelper.shortcutTitle.text = webServerBookmarkName
+        TestHelper.AddtoHSOKBtn.click()
+
+        // For Android O, we need additional steps
+        if (VERSION.SDK_INT >= Build.VERSION_CODES.O) {
+            handleShortcutLayoutDialog()
+        }
+
+        // App is sent to background, in launcher now
+        if (welcomeBtn.exists()) {
+            welcomeBtn.click()
+        }
+        shortcutIcon.waitForExists(waitingTime)
+        Assert.assertTrue(shortcutIcon.isEnabled)
+        shortcutIcon.click()
+        TestHelper.browserURLbar.waitForExists(waitingTime)
+        Assert.assertTrue(
+            TestHelper.browserURLbar.text
+                    == webServer!!.url(TEST_PATH).toString()
+        )
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    @Suppress("LongMethod")
+    fun NonameTest() {
+        val shortcutIcon = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .description(webServerBookmarkName)
+                .enabled(true)
+        )
+
+        // Open website, and click 'Add to homescreen'
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        TestHelper.progressBar.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime))
+        openAddtoHSDialog()
+
+        // "Add to Home screen" dialog is now shown
+        TestHelper.shortcutTitle.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.shortcutTitle.isEnabled)
+        Assert.assertEquals(TestHelper.shortcutTitle.text, "gigantic experience")
+        Assert.assertTrue(TestHelper.AddtoHSOKBtn.isEnabled)
+        Assert.assertTrue(TestHelper.AddtoHSCancelBtn.isEnabled)
+
+        // replace shortcut text
+        TestHelper.shortcutTitle.click()
+        TestHelper.shortcutTitle.text = webServerBookmarkName
+        TestHelper.AddtoHSOKBtn.click()
+
+        // For Android O, we need additional steps
+        if (VERSION.SDK_INT >= Build.VERSION_CODES.O) {
+            handleShortcutLayoutDialog()
+        }
+        if (welcomeBtn.exists()) {
+            welcomeBtn.click()
+        }
+        // App is sent to background, in launcher now
+        // Start from home and then swipe, to ensure we land where we want to search for shortcut
+        TestHelper.mDevice.pressHome()
+        swipeScreenLeft()
+        shortcutIcon.waitForExists(waitingTime)
+        Assert.assertTrue(shortcutIcon.isEnabled)
+        shortcutIcon.click()
+        TestHelper.browserURLbar.waitForExists(waitingTime)
+        Assert.assertTrue(
+            TestHelper.browserURLbar.text
+                    == webServer!!.url(TEST_PATH).toString()
+        )
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    @Suppress("LongMethod")
+    fun SearchTermShortcutTest() {
+        val shortcutIcon = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .descriptionContains("helloworld")
+                .enabled(true)
+        )
+
+        // Open website, and click 'Add to homescreen'
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "helloworld"
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        // In certain cases, where progressBar disappears immediately, below will return false
+        // since it busy waits, it will unblock when the bar isn't visible, regardless of the
+        // return value
+        TestHelper.progressBar.waitForExists(waitingTime)
+        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime)
+        openAddtoHSDialog()
+
+        // "Add to Home screen" dialog is now shown
+        TestHelper.shortcutTitle.waitForExists(waitingTime)
+        TestHelper.AddtoHSOKBtn.click()
+
+        // For Android O, we need additional steps
+        if (VERSION.SDK_INT >= Build.VERSION_CODES.O) {
+            handleShortcutLayoutDialog()
+        }
+        if (welcomeBtn.exists()) {
+            welcomeBtn.click()
+        }
+
+        // App is sent to background, in launcher now
+        // Start from home and then swipe, to ensure we land where we want to search for shortcut
+        TestHelper.mDevice.pressHome()
+        swipeScreenLeft()
+        shortcutIcon.waitForExists(waitingTime)
+        Assert.assertTrue(shortcutIcon.isEnabled)
+        shortcutIcon.click()
+        waitForIdle()
+        waitForWebContent()
+
+        // Tap URL bar and check the search term is still shown
+        TestHelper.browserURLbar.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.browserURLbar.text.contains("helloworld"))
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java
deleted file mode 100644
index d088b8c3a4ee..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.java
+++ /dev/null
@@ -1,102 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.filters.RequiresDevice;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static androidx.test.espresso.web.sugar.Web.onWebView;
-import static junit.framework.Assert.assertTrue;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test opens enters and invalid URL, and Focus should provide an appropriate error message
-@RunWith(AndroidJUnit4.class)
-@RequiresDevice
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class BadURLTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-        }
-    };
-
-    @After
-    public void tearDown() {
-       mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void BadURLcheckTest() throws UiObjectNotFoundException {
-
-        UiObject cancelOpenAppBtn = TestHelper.mDevice.findObject(new UiSelector()
-                .resourceId("android:id/button2"));
-        UiObject openAppalert = TestHelper.mDevice.findObject(new UiSelector()
-        .text("Open link in another app"));
-
-        // provide an invalid URL
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("htps://www.mozilla.org");
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-
-        // Check for error message
-        onWebView(withText(R.string.error_malformedURI_title));
-        onWebView(withText(R.string.error_malformedURI_message));
-        onWebView(withText("Try Again"));
-
-        TestHelper.floatingEraseButton.perform(click());
-
-        /* provide market URL that is handled by Google Play app */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("market://details?id=org.mozilla.firefox&referrer=" +
-                "utm_source%3Dmozilla%26utm_medium%3DReferral%26utm_campaign%3Dmozilla-org");
-        TestHelper.pressEnterKey();
-
-        // Wait for the dialog
-        cancelOpenAppBtn.waitForExists(waitingTime);
-        assertTrue(openAppalert.exists());
-        assertTrue(cancelOpenAppBtn.exists());
-        cancelOpenAppBtn.click();
-        TestHelper.floatingEraseButton.perform(click());
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.kt
new file mode 100644
index 000000000000..4f34f173157a
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/BadURLTest.kt
@@ -0,0 +1,82 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.espresso.web.sugar.Web
+import androidx.test.filters.RequiresDevice
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import org.junit.After
+import org.junit.Assert
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+
+// This test opens enters and invalid URL, and Focus should provide an appropriate error message
+@RunWith(AndroidJUnit4ClassRunner::class)
+@RequiresDevice
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class BadURLTest {
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun BadURLcheckTest() {
+        val cancelOpenAppBtn = TestHelper.mDevice.findObject(
+            UiSelector()
+                .resourceId("android:id/button2")
+        )
+        val openAppalert = TestHelper.mDevice.findObject(
+            UiSelector()
+                .text("Open link in another app")
+        )
+
+        // provide an invalid URL
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "htps://www.mozilla.org"
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+
+        // Check for error message
+        Web.onWebView(ViewMatchers.withText(R.string.error_malformedURI_title))
+        Web.onWebView(ViewMatchers.withText(R.string.error_malformedURI_message))
+        Web.onWebView(ViewMatchers.withText("Try Again"))
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+
+        /* provide market URL that is handled by Google Play app */TestHelper.inlineAutocompleteEditText.waitForExists(
+            waitingTime
+        )
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            "market://details?id=org.mozilla.firefox&referrer=" +
+                    "utm_source%3Dmozilla%26utm_medium%3DReferral%26utm_campaign%3Dmozilla-org"
+        pressEnterKey()
+
+        // Wait for the dialog
+        cancelOpenAppBtn.waitForExists(waitingTime)
+        Assert.assertTrue(openAppalert.exists())
+        Assert.assertTrue(cancelOpenAppBtn.exists())
+        cancelOpenAppBtn.click()
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.java
deleted file mode 100644
index aaec858cbf00..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.java
+++ /dev/null
@@ -1,182 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiScrollable;
-import androidx.test.uiautomator.UiSelector;
-import android.widget.RadioButton;
-
-import org.junit.After;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.junit.runners.Parameterized;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.util.Arrays;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.isDescendantOfA;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static android.view.KeyEvent.KEYCODE_SPACE;
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.Matchers.allOf;
-import static org.hamcrest.Matchers.containsString;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.childAtPosition;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-import static org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime;
-
-// This test checks the search engine can be changed
-// https://testrail.stage.mozaws.net/index.php?/cases/view/47588
-@RunWith(Parameterized.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class ChangeSearchEngineTest {
-    @Parameterized.Parameter
-    public String mSearchEngine;
-
-    @Parameterized.Parameters
-    public static Iterable<?> data() {
-        return Arrays.asList("Google", "DuckDuckGo");
-    }
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void SearchTest() throws UiObjectNotFoundException {
-        UiObject searchMenu = TestHelper.settingsMenu.getChild(new UiSelector()
-                .className("android.widget.LinearLayout")
-                .instance(2));
-
-        UiObject searchEngineSelectorLabel = searchMenu.getChild(new UiSelector()
-                .resourceId("android:id/title")
-                .text("Search")
-                .enabled(true));
-
-        String searchString = String.format("mozilla focus - %s Search", mSearchEngine);
-        UiObject googleWebView = TestHelper.mDevice.findObject(new UiSelector()
-                .description(searchString)
-                .className("android.webkit.WebView"));
-
-        // Open [settings menu] and select Search
-        assertTrue(TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime));
-        openSettings();
-        TestHelper.settingsHeading.waitForExists(waitingTime);
-        searchEngineSelectorLabel.waitForExists(waitingTime);
-        searchEngineSelectorLabel.click();
-
-        // Open [settings menu] > [search engine menu] and click "Search engine" label
-        UiObject defaultSearchEngineLabel = TestHelper.settingsMenu.getChild(new UiSelector()
-                .className("android.widget.LinearLayout")
-                .instance(0));
-        defaultSearchEngineLabel.waitForExists(waitingTime);
-        defaultSearchEngineLabel.click();
-
-        // Open [settings menu] > [search engine menu] > [search engine list menu]
-        // then select desired search engine
-        UiScrollable searchEngineList = new UiScrollable(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/search_engine_group").enabled(true));
-        UiObject defaultEngineSelection = searchEngineList.getChildByText(new UiSelector()
-                .className(RadioButton.class), mSearchEngine);
-        defaultEngineSelection.waitForExists(waitingTime);
-        assertTrue(defaultEngineSelection.getText().equals(mSearchEngine));
-        defaultEngineSelection.click();
-        TestHelper.pressBackKey();
-        TestHelper.settingsHeading.waitForExists(waitingTime);
-        UiObject defaultSearchEngine = TestHelper.mDevice.findObject(new UiSelector()
-                .text(mSearchEngine)
-                .resourceId("android:id/summary"));
-        assertTrue(defaultSearchEngine.getText().equals(mSearchEngine));
-        TestHelper.pressBackKey();
-        TestHelper.pressBackKey();
-
-        // Do search on blank spaces and press enter for search (should not do anything)
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("   ");
-        TestHelper.pressEnterKey();
-        assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-
-        // Do search on text string
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("mozilla ");
-        // Would you like to turn on search suggestions? Yes No
-        // fresh install only)
-        if (TestHelper.searchSuggestionsTitle.exists()) {
-            TestHelper.searchSuggestionsButtonYes.waitForExists(waitingTime);
-            TestHelper.searchSuggestionsButtonYes.click();
-        }
-
-        // verify search hints... "mozilla firefox", "mozilla careers", etc.TestHelper.suggestionList.waitForExists(waitingTime);
-        TestHelper.mDevice.pressKeyCode(KEYCODE_SPACE);
-        TestHelper.suggestionList.waitForExists(waitingTime);
-        assertTrue(TestHelper.suggestionList.getChildCount() >= 1);
-
-        onView(allOf(withText(containsString("mozilla")),
-                withId(R.id.searchView)))
-                .check(matches(isDisplayed()));
-        // we expect min=1, max=5
-        int count = 0;
-        int maxCount = 3;
-        //while (count <= maxCount) {
-        while (count < maxCount) {
-            onView(allOf(withText(containsString("mozilla")),
-                    withId(R.id.suggestion),
-                    isDescendantOfA(childAtPosition(withId(R.id.suggestionList), count))))
-                    .check(matches(isDisplayed()));
-            count++;
-        }
-
-        // Tap URL bar, check it displays search term (instead of URL)
-       TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-       TestHelper.inlineAutocompleteEditText.click();
-       TestHelper.inlineAutocompleteEditText.clearTextField();
-       TestHelper.inlineAutocompleteEditText.setText("mozilla focus");
-       TestHelper.pressEnterKey();
-       googleWebView.waitForExists(waitingTime);
-       TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime);
-
-       // Search for words: <Google|DuckDuckGo|etc.>, mozilla, focus
-       assertTrue(TestHelper.browserURLbar.getText().contains(mSearchEngine.toLowerCase()));
-       assertTrue(TestHelper.browserURLbar.getText().contains("mozilla"));
-       assertTrue(TestHelper.browserURLbar.getText().contains("focus"));
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.kt
new file mode 100644
index 000000000000..7c16604ff9fd
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ChangeSearchEngineTest.kt
@@ -0,0 +1,183 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.view.KeyEvent
+import android.widget.RadioButton
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiScrollable
+import androidx.test.uiautomator.UiSelector
+import org.hamcrest.Matchers
+import org.junit.After
+import org.junit.Assert
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.junit.runners.Parameterized
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.EspressoHelper.childAtPosition
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime
+import java.util.Arrays
+
+// This test checks the search engine can be changed
+// https://testrail.stage.mozaws.net/index.php?/cases/view/47588
+@RunWith(Parameterized::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class ChangeSearchEngineTest {
+    @Parameterized.Parameter
+    var mSearchEngine: String? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun SearchTest() {
+        val searchMenu = TestHelper.settingsMenu.getChild(
+            UiSelector()
+                .className("android.widget.LinearLayout")
+                .instance(2)
+        )
+        val searchEngineSelectorLabel = searchMenu.getChild(
+            UiSelector()
+                .resourceId("android:id/title")
+                .text("Search")
+                .enabled(true)
+        )
+        val searchString = String.format("mozilla focus - %s Search", mSearchEngine)
+        val googleWebView = TestHelper.mDevice.findObject(
+            UiSelector()
+                .description(searchString)
+                .className("android.webkit.WebView")
+        )
+
+        // Open [settings menu] and select Search
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime))
+        openSettings()
+        TestHelper.settingsHeading.waitForExists(waitingTime)
+        searchEngineSelectorLabel.waitForExists(waitingTime)
+        searchEngineSelectorLabel.click()
+
+        // Open [settings menu] > [search engine menu] and click "Search engine" label
+        val defaultSearchEngineLabel = TestHelper.settingsMenu.getChild(
+            UiSelector()
+                .className("android.widget.LinearLayout")
+                .instance(0)
+        )
+        defaultSearchEngineLabel.waitForExists(waitingTime)
+        defaultSearchEngineLabel.click()
+
+        // Open [settings menu] > [search engine menu] > [search engine list menu]
+        // then select desired search engine
+        val searchEngineList = UiScrollable(
+            UiSelector()
+                .resourceId(appName + ":id/search_engine_group").enabled(true)
+        )
+        val defaultEngineSelection = searchEngineList.getChildByText(
+            UiSelector()
+                .className(RadioButton::class.java), mSearchEngine
+        )
+        defaultEngineSelection.waitForExists(waitingTime)
+        Assert.assertTrue(defaultEngineSelection.text == mSearchEngine)
+        defaultEngineSelection.click()
+        pressBackKey()
+        TestHelper.settingsHeading.waitForExists(waitingTime)
+        val defaultSearchEngine = TestHelper.mDevice.findObject(
+            UiSelector()
+                .text(mSearchEngine)
+                .resourceId("android:id/summary")
+        )
+        Assert.assertTrue(defaultSearchEngine.text == mSearchEngine)
+        pressBackKey()
+        pressBackKey()
+
+        // Do search on blank spaces and press enter for search (should not do anything)
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "   "
+        pressEnterKey()
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+
+        // Do search on text string
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "mozilla "
+        // Would you like to turn on search suggestions? Yes No
+        // fresh install only)
+        if (TestHelper.searchSuggestionsTitle.exists()) {
+            TestHelper.searchSuggestionsButtonYes.waitForExists(waitingTime)
+            TestHelper.searchSuggestionsButtonYes.click()
+        }
+
+        // verify search hints... "mozilla firefox", "mozilla careers", etc.TestHelper.suggestionList.waitForExists(waitingTime);
+        TestHelper.mDevice.pressKeyCode(KeyEvent.KEYCODE_SPACE)
+        TestHelper.suggestionList.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.suggestionList.childCount >= 1)
+        Espresso.onView(
+            Matchers.allOf(
+                ViewMatchers.withText(Matchers.containsString("mozilla")),
+                ViewMatchers.withId(R.id.searchView)
+            )
+        )
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        // we expect min=1, max=5
+        var count = 0
+        val maxCount = 3
+        // while (count <= maxCount) {
+        while (count < maxCount) {
+            Espresso.onView(
+                Matchers.allOf(
+                    ViewMatchers.withText(Matchers.containsString("mozilla")),
+                    ViewMatchers.withId(R.id.suggestion),
+                    ViewMatchers.isDescendantOfA(
+                        childAtPosition(
+                            ViewMatchers.withId(R.id.suggestionList),
+                            count
+                        )
+                    )
+                )
+            )
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            count++
+        }
+
+        // Tap URL bar, check it displays search term (instead of URL)
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.click()
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "mozilla focus"
+        pressEnterKey()
+        googleWebView.waitForExists(waitingTime)
+        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime)
+
+        // Search for words: <Google|DuckDuckGo|etc.>, mozilla, focus
+        Assert.assertTrue(TestHelper.browserURLbar.text.contains(mSearchEngine!!.toLowerCase()))
+        Assert.assertTrue(TestHelper.browserURLbar.text.contains("mozilla"))
+        Assert.assertTrue(TestHelper.browserURLbar.text.contains("focus"))
+    }
+
+    companion object {
+        @Parameterized.Parameters
+        fun data(): Iterable<*> {
+            return Arrays.asList("Google", "DuckDuckGo")
+        }
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java
deleted file mode 100644
index e3c8ce76c376..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.java
+++ /dev/null
@@ -1,178 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.app.PendingIntent;
-import android.content.Context;
-import android.content.Intent;
-import android.graphics.Bitmap;
-import android.graphics.Canvas;
-import android.graphics.Color;
-import android.net.Uri;
-import androidx.browser.customtabs.CustomTabsIntent;
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.Espresso;
-import androidx.test.espresso.web.webdriver.Locator;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withContentDescription;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static androidx.test.espresso.web.assertion.WebViewAssertions.webMatches;
-import static androidx.test.espresso.web.sugar.Web.onWebView;
-import static androidx.test.espresso.web.webdriver.DriverAtoms.findElement;
-import static androidx.test.espresso.web.webdriver.DriverAtoms.getText;
-import static org.hamcrest.core.IsEqual.equalTo;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-
-
-@RunWith(AndroidJUnit4.class)
-public class CustomTabTest {
-    private static final String MENU_ITEM_LABEL = "TestItem4223";
-    private static final String ACTION_BUTTON_DESCRIPTION = "TestButton1337";
-    private static final String TEST_PAGE_HEADER_ID = "header";
-    private static final String TEST_PAGE_HEADER_TEXT = "focus test page";
-
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<IntentReceiverActivity> activityTestRule  = new ActivityTestRule<>(
-            IntentReceiverActivity.class, true, false);
-
-    @Before
-    public void setUp() {
-
-        Context appContext = InstrumentationRegistry.getInstrumentation()
-                .getTargetContext()
-                .getApplicationContext();
-
-        // This test runs on both GV and WV.
-        // Klar is used to test Geckoview. make sure it's set to Gecko
-        TestHelper.selectGeckoForKlar();
-
-    }
-
-    @After
-    public void tearDown() {
-        activityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void testCustomTabUI() {
-        try {
-            startWebServer();
-
-            // Launch activity with custom tabs intent
-            activityTestRule.launchActivity(createCustomTabIntent());
-
-            // Wait for website to load
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            // Verify action button is visible
-            onView(withContentDescription(ACTION_BUTTON_DESCRIPTION))
-                    .check(matches(isDisplayed()));
-
-            // Open menu
-            onView(withId(R.id.menuView))
-                    .perform(click());
-
-            // Verify share action is visible
-            onView(withId(R.id.share))
-                    .check(matches(isDisplayed()));
-
-            // Verify custom menu item is visible
-            onView(withText(MENU_ITEM_LABEL))
-                    .check(matches(isDisplayed()));
-
-            // Close the menu again
-            Espresso.pressBack();
-
-            // Verify close button is visible - Click it to close custom tab.
-            onView(withId(R.id.customtab_close))
-                    .check(matches(isDisplayed()))
-                    .perform(click());
-        } finally {
-            stopWebServer();
-        }
-    }
-
-    private Intent createCustomTabIntent() {
-        final Context appContext = InstrumentationRegistry.getInstrumentation()
-                .getTargetContext()
-                .getApplicationContext();
-
-        final PendingIntent pendingIntent = PendingIntent.getActivity(appContext, 0, new Intent(), 0);
-
-        final CustomTabsIntent customTabsIntent = new CustomTabsIntent.Builder()
-                .addMenuItem(MENU_ITEM_LABEL, pendingIntent)
-                .addDefaultShareMenuItem()
-                .setActionButton(createTestBitmap(), ACTION_BUTTON_DESCRIPTION, pendingIntent, true)
-                .setToolbarColor(Color.MAGENTA)
-                .build();
-
-        customTabsIntent.intent.setData(Uri.parse(webServer.url("/").toString()));
-
-        return customTabsIntent.intent;
-    }
-
-    private void startWebServer() {
-        final Context appContext = InstrumentationRegistry.getInstrumentation()
-                .getTargetContext()
-                .getApplicationContext();
-
-        PreferenceManager.getDefaultSharedPreferences(appContext)
-                .edit()
-                .putBoolean(FIRSTRUN_PREF, true)
-                .apply();
-
-        webServer = new MockWebServer();
-
-        try {
-            webServer.enqueue(new MockResponse()
-                    .setBody(TestHelper.readTestAsset("plain_test.html")));
-            webServer.start();
-        } catch (IOException e) {
-            throw new AssertionError("Could not start web server", e);
-        }
-    }
-
-    private void stopWebServer() {
-        try {
-            webServer.close();
-            webServer.shutdown();
-        } catch (IOException e) {
-            throw new AssertionError("Could not stop web server", e);
-        }
-    }
-
-    private Bitmap createTestBitmap() {
-        final Bitmap bitmap = Bitmap.createBitmap(100, 100, Bitmap.Config.ARGB_8888);
-        final Canvas canvas = new Canvas(bitmap);
-        canvas.drawColor(Color.GREEN);
-        return bitmap;
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.kt
new file mode 100644
index 000000000000..e2c139158231
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/CustomTabTest.kt
@@ -0,0 +1,141 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.app.PendingIntent
+import android.content.Intent
+import android.graphics.Bitmap
+import android.graphics.Canvas
+import android.graphics.Color
+import android.net.Uri
+import androidx.browser.customtabs.CustomTabsIntent
+import androidx.preference.PreferenceManager
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.rule.ActivityTestRule
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.fragment.FirstrunFragment
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import java.io.IOException
+
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("Crashing the instrumentation tests, no session ID error")
+class CustomTabTest {
+    private var webServer: MockWebServer? = null
+    private val MENU_ITEM_LABEL = "TestItem4223"
+    private val ACTION_BUTTON_DESCRIPTION = "TestButton1337"
+    private val TEST_PAGE_HEADER_ID = "header"
+    private val TEST_PAGE_HEADER_TEXT = "focus test page"
+
+    @get: Rule
+    var activityTestRule = ActivityTestRule(
+        IntentReceiverActivity::class.java, true, false
+    )
+
+    @Before
+    fun setUp() {}
+
+    @After
+    fun tearDown() {
+        stopWebServer()
+    }
+
+    @Test
+    fun testCustomTabUI() {
+        startWebServer()
+
+        // Launch activity with custom tabs intent
+        activityTestRule.launchActivity(createCustomTabIntent())
+
+        // Wait for website to load
+
+        // Verify action button is visible
+        Espresso.onView(ViewMatchers.withContentDescription(ACTION_BUTTON_DESCRIPTION))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        // Open menu
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .perform(ViewActions.click())
+
+        // Verify share action is visible
+        Espresso.onView(ViewMatchers.withId(R.id.share))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        // Verify custom menu item is visible
+        Espresso.onView(ViewMatchers.withText(MENU_ITEM_LABEL))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        // Close the menu again
+        Espresso.pressBack()
+
+        // Verify close button is visible - Click it to close custom tab.
+        Espresso.onView(ViewMatchers.withId(R.id.customtab_close))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+    }
+
+    @Suppress("Deprecation")
+    private fun createCustomTabIntent(): Intent {
+        val appContext = InstrumentationRegistry.getInstrumentation()
+            .targetContext
+            .applicationContext
+        val pendingIntent = PendingIntent.getActivity(appContext, 0, Intent(), 0)
+        val customTabsIntent = CustomTabsIntent.Builder()
+            .addMenuItem(MENU_ITEM_LABEL, pendingIntent)
+            .addDefaultShareMenuItem()
+            .setActionButton(createTestBitmap(), ACTION_BUTTON_DESCRIPTION, pendingIntent, true)
+            .setToolbarColor(Color.MAGENTA)
+            .build()
+        customTabsIntent.intent.data = Uri.parse(webServer!!.url("/").toString())
+        return customTabsIntent.intent
+    }
+
+    private fun startWebServer() {
+        val appContext = InstrumentationRegistry.getInstrumentation()
+            .targetContext
+            .applicationContext
+        PreferenceManager.getDefaultSharedPreferences(appContext)
+            .edit()
+            .putBoolean(FirstrunFragment.FIRSTRUN_PREF, true)
+            .apply()
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    private fun stopWebServer() {
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    private fun createTestBitmap(): Bitmap {
+        val bitmap = Bitmap.createBitmap(100, 100, Bitmap.Config.ARGB_8888)
+        val canvas = Canvas(bitmap)
+        canvas.drawColor(Color.GREEN)
+        return bitmap
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.java
deleted file mode 100644
index ae0c420f2d8e..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.java
+++ /dev/null
@@ -1,146 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.os.Build;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Assert;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-// https://testrail.stage.mozaws.net/index.php?/cases/view/53141
-public class DownloadFileTest {
-    private static final String TEST_PATH = "/";
-
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule  = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            // This test is for API 25 and greater. see https://github.com/mozilla-mobile/focus-android/issues/2696
-            org.junit.Assume.assumeTrue(Build.VERSION.SDK_INT >= Build.VERSION_CODES.N);
-
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("image_test.html"))
-                        .addHeader("Set-Cookie", "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("rabbit.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("download.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("download.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("download.jpg")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown()  {
-
-        // If notification is still up, this will take it off screen
-        TestHelper.pressBackKey();
-
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void DownloadTest() throws UiObjectNotFoundException  {
-        UiObject downloadIcon;
-
-        downloadIcon = TestHelper.mDevice.findObject(new UiSelector()
-                .resourceId("download")
-                .enabled(true));
-
-        // Load website with service worker
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-        TestHelper.progressBar.waitUntilGone(waitingTime);
-
-        downloadIcon.click();
-
-        // If permission dialog appears, grant it
-        if (TestHelper.permAllowBtn.waitForExists(waitingTime)) {
-            TestHelper.permAllowBtn.click();
-        }
-
-        TestHelper.downloadTitle.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.downloadTitle.isEnabled());
-        Assert.assertTrue(TestHelper.downloadCancelBtn.isEnabled());
-        Assert.assertTrue(TestHelper.downloadBtn.isEnabled());
-        Assert.assertEquals(TestHelper.downloadFileName.getText(), "download.jpg");
-        Assert.assertEquals(TestHelper.downloadWarning.getText(),
-                "Downloaded files will not be deleted when you erase Firefox Focus history.");
-        TestHelper.downloadBtn.click();
-        TestHelper.completedMsg.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.completedMsg.isEnabled());
-        Assert.assertTrue(TestHelper.completedMsg.getText().contains("finished"));
-        TestHelper.mDevice.openNotification();
-        TestHelper.mDevice.waitForIdle();
-        TestHelper.savedNotification.waitForExists(waitingTime);
-        TestHelper.savedNotification.swipeRight(50);
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.kt
new file mode 100644
index 000000000000..37e7a1ecf4eb
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/DownloadFileTest.kt
@@ -0,0 +1,134 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.os.Build
+import android.os.Build.VERSION
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObject
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Assume
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+@RunWith(AndroidJUnit4ClassRunner::class)
+// @Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView") // https://testrail.stage.mozaws.net/index.php?/cases/view/53141
+class DownloadFileTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        Assume.assumeTrue(VERSION.SDK_INT >= Build.VERSION_CODES.N)
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("image_test.html"))
+                    .addHeader(
+                        "Set-Cookie",
+                        "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"
+                    )
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("rabbit.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("download.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("download.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("download.jpg"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        // If notification is still up, this will take it off screen
+        pressBackKey()
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun DownloadTest() {
+        val downloadIcon: UiObject
+        downloadIcon = TestHelper.mDevice.findObject(
+            UiSelector()
+                .resourceId("download")
+                .enabled(true)
+        )
+
+        // Load website with service worker
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+        TestHelper.progressBar.waitUntilGone(waitingTime)
+        downloadIcon.click()
+
+        // If permission dialog appears, grant it
+        if (TestHelper.permAllowBtn.waitForExists(waitingTime)) {
+            TestHelper.permAllowBtn.click()
+        }
+        TestHelper.downloadTitle.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.downloadTitle.isEnabled)
+        Assert.assertTrue(TestHelper.downloadCancelBtn.isEnabled)
+        Assert.assertTrue(TestHelper.downloadBtn.isEnabled)
+        Assert.assertEquals(TestHelper.downloadFileName.text, "download.jpg")
+        Assert.assertEquals(
+            TestHelper.downloadWarning.text,
+            "Downloaded files will not be deleted when you erase Firefox Focus history."
+        )
+        TestHelper.downloadBtn.click()
+        TestHelper.completedMsg.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.completedMsg.isEnabled)
+        Assert.assertTrue(TestHelper.completedMsg.text.contains("finished"))
+        TestHelper.mDevice.openNotification()
+        TestHelper.mDevice.waitForIdle()
+        TestHelper.savedNotification.waitForExists(waitingTime)
+        TestHelper.savedNotification.swipeRight(50)
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.java
deleted file mode 100644
index b31848be32e8..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.java
+++ /dev/null
@@ -1,171 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.content.Intent;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.By;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.Until;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static junit.framework.Assert.assertFalse;
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.core.IsNull.notNullValue;
-import static org.junit.Assert.assertThat;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test erases URL and checks for message
-// https://testrail.stage.mozaws.net/index.php?/cases/view/40068
-@RunWith(AndroidJUnit4.class)
-public class EraseAllUserDataTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void TrashTest() throws UiObjectNotFoundException {
-
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-
-        // Press erase button, and check for message and return to the main page
-        TestHelper.floatingEraseButton.perform(click());
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-        assertTrue(TestHelper.erasedMsg.exists());
-        assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-    }
-
-    @Test
-    public void systemBarTest() throws UiObjectNotFoundException {
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-        TestHelper.menuButton.perform(click());
-        TestHelper.blockCounterItem.waitForExists(waitingTime);
-
-        // Pull down system bar and select delete browsing history
-        TestHelper.openNotification();
-        TestHelper.notificationBarDeleteItem.waitForExists(waitingTime);
-        TestHelper.notificationBarDeleteItem.click();
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-        assertTrue(TestHelper.erasedMsg.exists());
-        assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-        assertFalse(TestHelper.menulist.exists());
-    }
-
-    @Test
-    public void systemBarHomeViewTest() throws UiObjectNotFoundException  {
-
-        // Initialize UiDevice instance
-        final int LAUNCH_TIMEOUT = 5000;
-
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-        // Switch out of Focus, pull down system bar and select delete browsing history
-        TestHelper.pressHomeKey();
-        TestHelper.openNotification();
-        TestHelper.notificationBarDeleteItem.waitForExists(waitingTime);
-        TestHelper.notificationBarDeleteItem.click();
-
-        // Wait for launcher
-        final String launcherPackage = TestHelper.mDevice.getLauncherPackageName();
-        assertThat(launcherPackage, notNullValue());
-        TestHelper.mDevice.wait(Until.hasObject(By.pkg(launcherPackage).depth(0)),
-                LAUNCH_TIMEOUT);
-
-        // Launch the app
-        mActivityTestRule.launchActivity(new Intent(Intent.ACTION_MAIN));
-        // Verify that it's on the main view, not showing the previous browsing session
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.kt
new file mode 100644
index 000000000000..cc3fbaafcc19
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/EraseAllUserDataTest.kt
@@ -0,0 +1,156 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.content.Intent
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.By
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.Until
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.hamcrest.core.IsNull
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.openNotification
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.pressHomeKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+// This test erases URL and checks for message
+// https://testrail.stage.mozaws.net/index.php?/cases/view/40068
+@RunWith(AndroidJUnit4ClassRunner::class)
+class EraseAllUserDataTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun TrashTest() {
+
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+
+        // Press erase button, and check for message and return to the main page
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.erasedMsg.exists())
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun systemBarTest() {
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+        TestHelper.menuButton.perform(ViewActions.click())
+        TestHelper.blockCounterItem.waitForExists(waitingTime)
+
+        // Pull down system bar and select delete browsing history
+        openNotification()
+        TestHelper.notificationBarDeleteItem.waitForExists(waitingTime)
+        TestHelper.notificationBarDeleteItem.click()
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.erasedMsg.exists())
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+        Assert.assertFalse(TestHelper.menulist.exists())
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun systemBarHomeViewTest() {
+
+        // Initialize UiDevice instance
+        val LAUNCH_TIMEOUT = 5000
+
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+        // Switch out of Focus, pull down system bar and select delete browsing history
+        pressHomeKey()
+        openNotification()
+        TestHelper.notificationBarDeleteItem.waitForExists(waitingTime)
+        TestHelper.notificationBarDeleteItem.click()
+
+        // Wait for launcher
+        val launcherPackage = TestHelper.mDevice.launcherPackageName
+        org.junit.Assert.assertThat(launcherPackage, IsNull.notNullValue())
+        TestHelper.mDevice.wait(
+            Until.hasObject(By.pkg(launcherPackage).depth(0)),
+            LAUNCH_TIMEOUT.toLong()
+        )
+
+        // Launch the app
+        mActivityTestRule.launchActivity(Intent(Intent.ACTION_MAIN))
+        // Verify that it's on the main view, not showing the previous browsing session
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.java
deleted file mode 100644
index cd047a13b226..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.java
+++ /dev/null
@@ -1,82 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-
-import junit.framework.Assert;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// https://testrail.stage.mozaws.net/index.php?/cases/view/40062
-@RunWith(AndroidJUnit4.class)
-public class FirstRunDialogueTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, false)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void FirstRunDialogueTest() throws UiObjectNotFoundException {
-
-        // Let's search for something
-        TestHelper.firstSlide.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.firstSlide.exists());
-        TestHelper.nextBtn.click();
-
-        TestHelper.secondSlide.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.secondSlide.exists());
-        TestHelper.nextBtn.click();
-
-        TestHelper.thirdSlide.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.thirdSlide.exists());
-        TestHelper.nextBtn.click();
-
-        TestHelper.lastSlide.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.lastSlide.exists());
-        TestHelper.finishBtn.click();
-
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.kt
new file mode 100644
index 000000000000..b0a5ea99ccb5
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/FirstRunDialogueTest.kt
@@ -0,0 +1,47 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import org.junit.After
+import org.junit.Assert
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+
+// https://testrail.stage.mozaws.net/index.php?/cases/view/40062
+@RunWith(AndroidJUnit4ClassRunner::class)
+class FirstRunDialogueTest {
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = true)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Test
+    fun FirstRunDialogueTest() {
+        // Let's search for something
+        TestHelper.firstSlide.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.firstSlide.exists())
+        TestHelper.nextBtn.click()
+        TestHelper.secondSlide.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.secondSlide.exists())
+        TestHelper.nextBtn.click()
+        TestHelper.thirdSlide.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.thirdSlide.exists())
+        TestHelper.nextBtn.click()
+        TestHelper.lastSlide.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.lastSlide.exists())
+        TestHelper.finishBtn.click()
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java
deleted file mode 100644
index 2218b872d638..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.java
+++ /dev/null
@@ -1,249 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.os.Build;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-import android.view.KeyEvent;
-
-import junit.framework.Assert;
-
-import org.junit.After;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.mDevice;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class ImageSelectTest {
-    private static final String TEST_PATH = "/";
-
-    private MockWebServer webServer;
-    private UiObject rabbitImage;
-    private UiObject imageMenuTitle = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/topPanel")
-            .enabled(true));
-    private UiObject imageMenuTitleText = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.TextView")
-            .enabled(true)
-            .instance(0));
-    private UiObject shareMenu = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/design_menu_item_text")
-            .text("Share image")
-            .enabled(true));
-    private UiObject copyMenu = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/design_menu_item_text")
-            .text("Copy image address")
-            .enabled(true));
-    private UiObject saveMenu = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/design_menu_item_text")
-            .text("Save image")
-            .enabled(true));
-    private UiObject warning = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/warning")
-            .text("Saved and shared images will not be deleted when you erase Firefox Focus history.")
-            .enabled(true));
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule  = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-
-            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
-                rabbitImage = TestHelper.mDevice.findObject(new UiSelector()
-                        .resourceId("rabbitImage")
-                        .enabled(true));
-            } else {
-                rabbitImage = TestHelper.mDevice.findObject(new UiSelector()
-                        .description("Smiley face")
-                        .enabled(true));
-            }
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("image_test.html"))
-                        .addHeader("Set-Cookie", "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("rabbit.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("download.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("rabbit.jpg")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-       mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void ImageMenuTest() throws UiObjectNotFoundException {
-        final String imagePath = webServer.url(TEST_PATH).toString() + "rabbit.jpg";
-
-        // Load website with service worker
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        assertTrue(TestHelper.webView.waitForExists(waitingTime));
-
-        // Assert website is loaded
-        TestHelper.waitForWebSiteTitleLoad();
-
-        // Find image and long tap it
-        rabbitImage.waitForExists(waitingTime);
-        assertTrue(rabbitImage.exists());
-        rabbitImage.dragTo(rabbitImage, 10);
-        imageMenuTitle.waitForExists(waitingTime);
-        assertTrue(imageMenuTitle.exists());
-        assertEquals(imageMenuTitleText.getText(), imagePath);
-        assertTrue(shareMenu.exists());
-        assertTrue(copyMenu.exists());
-        assertTrue(saveMenu.exists());
-        assertTrue(warning.exists());
-
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
-            copyMenu.click();
-
-            // Erase browsing session
-            TestHelper.floatingEraseButton.perform(click());
-            TestHelper.erasedMsg.waitForExists(waitingTime);
-            assertTrue(TestHelper.erasedMsg.exists());
-
-            // KeyEvent.KEYCODE_PASTE) requires API 24 or above
-            TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-            TestHelper.mDevice.pressKeyCode(KeyEvent.KEYCODE_PASTE);
-            assertEquals(TestHelper.inlineAutocompleteEditText.getText(), imagePath);
-            mDevice.pressBack();
-        }
-    }
-
-    @Test
-    public void ShareImageTest() throws UiObjectNotFoundException {
-
-        // Load website with service worker
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        assertTrue(TestHelper.webView.waitForExists(waitingTime));
-
-        // Assert website is loaded
-        TestHelper.waitForWebSiteTitleLoad();
-        TestHelper.progressBar.waitUntilGone(waitingTime);
-
-        // Find image and long tap it
-        rabbitImage.waitForExists(waitingTime);
-        assertTrue(rabbitImage.exists());
-        rabbitImage.dragTo(rabbitImage, 10);
-        imageMenuTitle.waitForExists(waitingTime);
-        assertTrue(shareMenu.exists());
-        assertTrue(copyMenu.exists());
-        assertTrue(saveMenu.exists());
-        shareMenu.click();
-
-        // For simulators, where apps are not installed, it'll take to message app
-        TestHelper.shareMenuHeader.waitForExists(waitingTime);
-        assertTrue(TestHelper.shareMenuHeader.exists());
-        assertTrue(TestHelper.shareAppList.exists());
-        TestHelper.pressBackKey();
-        TestHelper.floatingEraseButton.perform(click());
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-    }
-
-    @Test
-    public void DownloadImageMenuTest() throws UiObjectNotFoundException {
-
-        // Load website with service worker
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        assertTrue(TestHelper.webView.waitForExists(waitingTime));
-
-        // Find image and long tap it
-        rabbitImage.waitForExists(waitingTime);
-        assertTrue(rabbitImage.exists());
-        rabbitImage.dragTo(rabbitImage, 10);
-        imageMenuTitle.waitForExists(waitingTime);
-        Assert.assertTrue(imageMenuTitle.exists());
-        Assert.assertTrue(shareMenu.exists());
-        Assert.assertTrue(copyMenu.exists());
-        Assert.assertTrue(saveMenu.exists());
-        saveMenu.click();
-
-        // If permission dialog appears, grant it
-        if (TestHelper.permAllowBtn.waitForExists(waitingTime)) {
-            TestHelper.permAllowBtn.click();
-            TestHelper.downloadTitle.waitForExists(waitingTime);
-            TestHelper.downloadBtn.click();
-        }
-
-        TestHelper.mDevice.openNotification();
-        TestHelper.savedNotification.waitForExists(waitingTime);
-        TestHelper.savedNotification.swipeRight(50);
-        TestHelper.pressBackKey();
-        TestHelper.floatingEraseButton.perform(click());
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.kt
new file mode 100644
index 000000000000..a06a9937d3d7
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ImageSelectTest.kt
@@ -0,0 +1,253 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 4; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.os.Build
+import android.os.Build.VERSION
+import android.view.KeyEvent
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObject
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.mDevice
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebSiteTitleLoad
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class ImageSelectTest {
+    private var webServer: MockWebServer? = null
+    private var rabbitImage: UiObject? = null
+    private val imageMenuTitle = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/topPanel")
+            .enabled(true)
+    )
+    private val imageMenuTitleText = TestHelper.mDevice.findObject(
+        UiSelector()
+            .className("android.widget.TextView")
+            .enabled(true)
+            .instance(0)
+    )
+    private val shareMenu = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/design_menu_item_text")
+            .text("Share image")
+            .enabled(true)
+    )
+    private val copyMenu = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/design_menu_item_text")
+            .text("Copy image address")
+            .enabled(true)
+    )
+    private val saveMenu = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/design_menu_item_text")
+            .text("Save image")
+            .enabled(true)
+    )
+    private val warning = TestHelper.mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/warning")
+            .text("Saved and shared images will not be deleted when you erase Firefox Focus history.")
+            .enabled(true)
+    )
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        rabbitImage = if (VERSION.SDK_INT >= Build.VERSION_CODES.N) {
+            TestHelper.mDevice.findObject(
+                UiSelector()
+                    .resourceId("rabbitImage")
+                    .enabled(true)
+            )
+        } else {
+            TestHelper.mDevice.findObject(
+                UiSelector()
+                    .description("Smiley face")
+                    .enabled(true)
+            )
+        }
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("image_test.html"))
+                    .addHeader(
+                        "Set-Cookie",
+                        "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"
+                    )
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("rabbit.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("download.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("rabbit.jpg"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun ImageMenuTest() {
+        val imagePath = webServer!!.url(TEST_PATH).toString() + "rabbit.jpg"
+
+        // Load website with service worker
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        Assert.assertTrue(TestHelper.webView.waitForExists(waitingTime))
+
+        // Assert website is loaded
+        waitForWebSiteTitleLoad()
+
+        // Find image and long tap it
+        rabbitImage!!.waitForExists(waitingTime)
+        Assert.assertTrue(rabbitImage!!.exists())
+        rabbitImage!!.dragTo(rabbitImage, 10)
+        imageMenuTitle.waitForExists(waitingTime)
+        Assert.assertTrue(imageMenuTitle.exists())
+        Assert.assertEquals(imageMenuTitleText.text, imagePath)
+        Assert.assertTrue(shareMenu.exists())
+        Assert.assertTrue(copyMenu.exists())
+        Assert.assertTrue(saveMenu.exists())
+        Assert.assertTrue(warning.exists())
+        if (VERSION.SDK_INT >= Build.VERSION_CODES.N) {
+            copyMenu.click()
+
+            // Erase browsing session
+            TestHelper.floatingEraseButton.perform(ViewActions.click())
+            TestHelper.erasedMsg.waitForExists(waitingTime)
+            Assert.assertTrue(TestHelper.erasedMsg.exists())
+
+            // KeyEvent.KEYCODE_PASTE) requires API 24 or above
+            TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+            TestHelper.mDevice.pressKeyCode(KeyEvent.KEYCODE_PASTE)
+            Assert.assertEquals(TestHelper.inlineAutocompleteEditText.text, imagePath)
+            mDevice.pressBack()
+        }
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun ShareImageTest() {
+
+        // Load website with service worker
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        Assert.assertTrue(TestHelper.webView.waitForExists(waitingTime))
+
+        // Assert website is loaded
+        waitForWebSiteTitleLoad()
+        TestHelper.progressBar.waitUntilGone(waitingTime)
+
+        // Find image and long tap it
+        rabbitImage!!.waitForExists(waitingTime)
+        Assert.assertTrue(rabbitImage!!.exists())
+        rabbitImage!!.dragTo(rabbitImage, 10)
+        imageMenuTitle.waitForExists(waitingTime)
+        Assert.assertTrue(shareMenu.exists())
+        Assert.assertTrue(copyMenu.exists())
+        Assert.assertTrue(saveMenu.exists())
+        shareMenu.click()
+
+        // For simulators, where apps are not installed, it'll take to message app
+        TestHelper.shareMenuHeader.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.shareMenuHeader.exists())
+        Assert.assertTrue(TestHelper.shareAppList.exists())
+        pressBackKey()
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun DownloadImageMenuTest() {
+
+        // Load website with service worker
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        Assert.assertTrue(TestHelper.webView.waitForExists(waitingTime))
+
+        // Find image and long tap it
+        rabbitImage!!.waitForExists(waitingTime)
+        Assert.assertTrue(rabbitImage!!.exists())
+        rabbitImage!!.dragTo(rabbitImage, 10)
+        imageMenuTitle.waitForExists(waitingTime)
+        Assert.assertTrue(imageMenuTitle.exists())
+        Assert.assertTrue(shareMenu.exists())
+        Assert.assertTrue(copyMenu.exists())
+        Assert.assertTrue(saveMenu.exists())
+        saveMenu.click()
+
+        // If permission dialog appears, grant it
+        if (TestHelper.permAllowBtn.waitForExists(waitingTime)) {
+            TestHelper.permAllowBtn.click()
+            TestHelper.downloadTitle.waitForExists(waitingTime)
+            TestHelper.downloadBtn.click()
+        }
+        TestHelper.mDevice.openNotification()
+        TestHelper.savedNotification.waitForExists(waitingTime)
+        TestHelper.savedNotification.swipeRight(50)
+        pressBackKey()
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java
deleted file mode 100644
index b95673d284c9..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.java
+++ /dev/null
@@ -1,212 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.IdlingRegistry;
-import androidx.test.espresso.web.webdriver.Locator;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.By;
-import androidx.test.uiautomator.Until;
-
-import mozilla.components.browser.session.SessionManager;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.ext.ContextKt;
-import org.mozilla.focus.helpers.SessionLoadedIdlingResource;
-import org.mozilla.focus.helpers.TestHelper;
-
-import mozilla.components.browser.session.ext.BrowserStoreExtensionsKt;
-import mozilla.components.browser.state.selector.SelectorsKt;
-import mozilla.components.browser.state.store.BrowserStore;
-import mozilla.components.feature.tabs.ext.BrowserStateKt;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withContentDescription;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static androidx.test.espresso.web.assertion.WebViewAssertions.webMatches;
-import static androidx.test.espresso.web.sugar.Web.onWebView;
-import static androidx.test.espresso.web.webdriver.DriverAtoms.findElement;
-import static androidx.test.espresso.web.webdriver.DriverAtoms.getText;
-import static junit.framework.TestCase.assertTrue;
-import static org.hamcrest.Matchers.equalTo;
-import static org.hamcrest.Matchers.is;
-import static org.hamcrest.Matchers.not;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.navigateToMockWebServer;
-import static org.mozilla.focus.helpers.EspressoHelper.onFloatingEraseButton;
-import static org.mozilla.focus.helpers.EspressoHelper.onFloatingTabsButton;
-import static org.mozilla.focus.helpers.TestHelper.createMockResponseFromAsset;
-
-/**
- * Open multiple sessions and verify that the UI looks like it should.
- */
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class MultitaskingTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-        }
-    };
-
-    private MockWebServer webServer;
-    private SessionLoadedIdlingResource loadingIdlingResource;
-
-    @Before
-    public void startWebServer() throws Exception {
-        webServer = new MockWebServer();
-
-        webServer.enqueue(createMockResponseFromAsset("tab1.html"));
-        webServer.enqueue(createMockResponseFromAsset("tab2.html"));
-        webServer.enqueue(createMockResponseFromAsset("tab3.html"));
-        webServer.enqueue(createMockResponseFromAsset("tab2.html"));
-
-        webServer.start();
-
-        loadingIdlingResource = new SessionLoadedIdlingResource();
-        IdlingRegistry.getInstance().register(loadingIdlingResource);
-    }
-
-    @After
-    public void stopWebServer() throws Exception {
-        IdlingRegistry.getInstance().unregister(loadingIdlingResource);
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-        webServer.shutdown();
-    }
-
-    @Test
-    public void testVisitingMultipleSites() {
-        {
-            // Load website: Erase button visible, Tabs button not
-            TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime);
-            navigateToMockWebServer(webServer, "tab1.html");
-
-            checkTabIsLoaded("Tab 1");
-
-            onFloatingEraseButton()
-                    .check(matches(isDisplayed()));
-            onFloatingTabsButton()
-                    .check(matches(not(isDisplayed())));
-        }
-
-        {
-            // Open link in new tab: Erase button hidden, Tabs button visible
-            longPressLink("tab2", "Tab 2", "tab2.html");
-            openInNewTab();
-
-            // verify Tab 1 is still on foreground
-            checkTabIsLoaded("Tab 1");
-            onFloatingEraseButton()
-                    .check(matches(not(isDisplayed())));
-            onFloatingTabsButton()
-                    .check(matches(isDisplayed()))
-                    .check(matches(withContentDescription(is("Tabs open: 2"))));
-        }
-
-        {
-            // Open link in new tab: Tabs button updated, Erase button still hidden
-
-            longPressLink("tab3", "Tab 3", "tab3.html");
-            openInNewTab();
-
-            // verify Tab 1 is still on foreground
-            checkTabIsLoaded("Tab 1");
-            onFloatingEraseButton()
-                    .check(matches(not(isDisplayed())));
-            onFloatingTabsButton()
-                    .check(matches(isDisplayed()))
-                    .check(matches(withContentDescription(is("Tabs open: 3"))));
-        }
-
-        {
-            // Open tabs tray and switch to second tab.
-            onFloatingTabsButton()
-                    .perform(click());
-
-            // Tab title would not have the port number, since the site isn't visited yet
-            onView(withText(webServer.getHostName() + "/tab2.html"))
-                    .perform(click());
-
-            checkTabIsLoaded("Tab 2");
-        }
-
-        {
-            // Remove all tabs via the menu
-            onFloatingTabsButton()
-                    .perform(click());
-
-            onView(withText(R.string.tabs_tray_action_erase))
-                    .check(matches(isDisplayed()))
-                    .perform(click());
-
-            // Now on main view
-            assertTrue(TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime));
-
-            final BrowserStore store = ContextKt.getComponents(InstrumentationRegistry.getTargetContext().getApplicationContext())
-                    .getStore();
-
-            assertTrue(SelectorsKt.getPrivateTabs(store.getState()).isEmpty());
-        }
-    }
-
-    private void checkTabIsLoaded(String title) {
-        onWebView()
-                .withElement(findElement(Locator.ID, "content"))
-                .check(webMatches(getText(), equalTo(title)));
-    }
-
-    private void longPressLink(String id, String label, String path) {
-        onWebView()
-                .withElement(findElement(Locator.ID, id))
-                .check(webMatches(getText(), equalTo(label)));
-
-        // Removed the following code since it depended on the IWebView abstraction that was removed
-        // in favor of the AC engine components.
-        // simulateLinkLongPress(path);
-    }
-
-    private void openInNewTab() {
-        onView(withText(R.string.contextmenu_open_in_new_tab))
-                .perform(click());
-        checkNewTabPopup();
-    }
-
-    private void checkNewTabPopup() {
-        TestHelper.mDevice.wait(Until.findObject(
-                By.res(TestHelper.getAppName(), "snackbar_text")), 5000);
-
-        TestHelper.mDevice.wait(Until.gone(
-                By.res(TestHelper.getAppName(), "snackbar_text")), 5000);
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.kt
new file mode 100644
index 000000000000..c7708b2bc19b
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/MultitaskingTest.kt
@@ -0,0 +1,211 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.IdlingRegistry
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.espresso.matcher.ViewMatchers.withText
+import androidx.test.espresso.web.assertion.WebViewAssertions
+import androidx.test.espresso.web.sugar.Web
+import androidx.test.espresso.web.webdriver.DriverAtoms
+import androidx.test.espresso.web.webdriver.Locator
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.By
+import androidx.test.uiautomator.Until
+import junit.framework.TestCase
+import mozilla.components.browser.state.selector.privateTabs
+import okhttp3.mockwebserver.MockWebServer
+import org.hamcrest.Matchers
+import org.junit.After
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.ext.components
+import org.mozilla.focus.helpers.EspressoHelper.navigateToMockWebServer
+import org.mozilla.focus.helpers.EspressoHelper.onFloatingEraseButton
+import org.mozilla.focus.helpers.EspressoHelper.onFloatingTabsButton
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.SessionLoadedIdlingResource
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.createMockResponseFromAsset
+
+/**
+ * Open multiple sessions and verify that the UI looks like it should.
+ */
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class MultitaskingTest {
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+    private var webServer: MockWebServer? = null
+    private var loadingIdlingResource: SessionLoadedIdlingResource? = null
+
+    @Before
+    @Throws(Exception::class)
+    fun startWebServer() {
+        webServer = MockWebServer()
+        webServer!!.enqueue(createMockResponseFromAsset("tab1.html"))
+        webServer!!.enqueue(createMockResponseFromAsset("tab2.html"))
+        webServer!!.enqueue(createMockResponseFromAsset("tab3.html"))
+        webServer!!.enqueue(createMockResponseFromAsset("tab2.html"))
+        webServer!!.start()
+        loadingIdlingResource = SessionLoadedIdlingResource()
+        IdlingRegistry.getInstance().register(loadingIdlingResource)
+    }
+
+    @After
+    @Throws(Exception::class)
+    fun stopWebServer() {
+        IdlingRegistry.getInstance().unregister(loadingIdlingResource)
+        mActivityTestRule.activity.finishAndRemoveTask()
+        webServer!!.shutdown()
+    }
+
+    @Test
+    fun testVisitingMultipleSites() {
+        run {
+
+            // Load website: Erase button visible, Tabs button not
+            TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime)
+            navigateToMockWebServer(webServer!!, "tab1.html")
+            checkTabIsLoaded("Tab 1")
+            onFloatingEraseButton()
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            onFloatingTabsButton()
+                .check(
+                    ViewAssertions.matches(
+                        Matchers.not(
+                            ViewMatchers.isDisplayed()
+                        )
+                    )
+                )
+        }
+        run {
+
+            // Open link in new tab: Erase button hidden, Tabs button visible
+            longPressLink("tab2", "Tab 2")
+            openInNewTab()
+
+            // verify Tab 1 is still on foreground
+            checkTabIsLoaded("Tab 1")
+            onFloatingEraseButton()
+                .check(
+                    ViewAssertions.matches(
+                        Matchers.not(
+                            ViewMatchers.isDisplayed()
+                        )
+                    )
+                )
+            onFloatingTabsButton()
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+                .check(
+                    ViewAssertions.matches(
+                        ViewMatchers.withContentDescription(
+                            Matchers.`is`(
+                                "Tabs open: 2"
+                            )
+                        )
+                    )
+                )
+        }
+        run {
+
+            // Open link in new tab: Tabs button updated, Erase button still hidden
+            longPressLink("tab3", "Tab 3")
+            openInNewTab()
+
+            // verify Tab 1 is still on foreground
+            checkTabIsLoaded("Tab 1")
+            onFloatingEraseButton()
+                .check(
+                    ViewAssertions.matches(
+                        Matchers.not(
+                            ViewMatchers.isDisplayed()
+                        )
+                    )
+                )
+            onFloatingTabsButton()
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+                .check(
+                    ViewAssertions.matches(
+                        ViewMatchers.withContentDescription(
+                            Matchers.`is`(
+                                "Tabs open: 3"
+                            )
+                        )
+                    )
+                )
+        }
+        run {
+
+            // Open tabs tray and switch to second tab.
+            onFloatingTabsButton()
+                .perform(ViewActions.click())
+
+            // Tab title would not have the port number, since the site isn't visited yet
+            Espresso.onView(ViewMatchers.withText(webServer!!.hostName + "/tab2.html"))
+                .perform(ViewActions.click())
+            checkTabIsLoaded("Tab 2")
+        }
+        run {
+
+            // Remove all tabs via the menu
+            onFloatingTabsButton()
+                .perform(ViewActions.click())
+            Espresso.onView(withText(R.string.tabs_tray_action_erase))
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+                .perform(ViewActions.click())
+
+            // Now on main view
+            TestCase.assertTrue(TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime))
+            val store = InstrumentationRegistry.getInstrumentation().getTargetContext()
+                .applicationContext.components
+                .store
+            TestCase.assertTrue(store.state.privateTabs.isEmpty())
+        }
+    }
+
+    private fun checkTabIsLoaded(title: String) {
+        Web.onWebView()
+            .withElement(DriverAtoms.findElement(Locator.ID, "content"))
+            .check(WebViewAssertions.webMatches(DriverAtoms.getText(), Matchers.equalTo(title)))
+    }
+
+    private fun longPressLink(id: String, label: String) {
+        Web.onWebView()
+            .withElement(DriverAtoms.findElement(Locator.ID, id))
+            .check(WebViewAssertions.webMatches(DriverAtoms.getText(), Matchers.equalTo(label)))
+
+        // Removed the following code since it depended on the IWebView abstraction that was removed
+        // in favor of the AC engine components.
+        // simulateLinkLongPress(path);
+    }
+
+    private fun openInNewTab() {
+        Espresso.onView(withText(R.string.contextmenu_open_in_new_tab))
+            .perform(ViewActions.click())
+        checkNewTabPopup()
+    }
+
+    private fun checkNewTabPopup() {
+        TestHelper.mDevice.wait(
+            Until.findObject(
+                By.res(appName, "snackbar_text")
+            ), 5000
+        )
+        TestHelper.mDevice.wait(
+            Until.gone(
+                By.res(appName, "snackbar_text")
+            ), 5000
+        )
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.java
deleted file mode 100644
index 451941598a3c..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.java
+++ /dev/null
@@ -1,114 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static junit.framework.Assert.assertTrue;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test opens a webpage, and selects "Open in" menu
-@RunWith(AndroidJUnit4.class)
-public class OpenInExternalBrowserDialogueTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void OpenInExternalBrowserDialogueTest() throws UiObjectNotFoundException {
-
-        UiObject openWithBtn = TestHelper.mDevice.findObject(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/open_select_browser")
-                .enabled(true));
-
-        UiObject openWithTitle = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("Open in")
-                .enabled(true));
-
-        UiObject openWithList = TestHelper.mDevice.findObject(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/apps")
-                .enabled(true));
-
-        /* Go to mozilla page */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-
-        /* Select Open with from menu, check appearance */
-        TestHelper.menuButton.perform(click());
-        openWithBtn.waitForExists(waitingTime);
-        openWithBtn.click();
-        openWithTitle.waitForExists(waitingTime);
-        assertTrue(openWithTitle.exists());
-        assertTrue(openWithList.exists());
-        TestHelper.pressBackKey();
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.kt
new file mode 100644
index 000000000000..0e6e30d1ddcc
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/OpenInExternalBrowserDialogueTest.kt
@@ -0,0 +1,95 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Rule
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+// This test opens a webpage, and selects "Open in" menu
+@RunWith(AndroidJUnit4ClassRunner::class)
+class OpenInExternalBrowserDialogueTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+
+    init {
+        val openWithBtn = TestHelper.mDevice.findObject(
+            UiSelector()
+                .resourceId(appName + ":id/open_select_browser")
+                .enabled(true)
+        )
+        val openWithTitle = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("Open in")
+                .enabled(true)
+        )
+        val openWithList = TestHelper.mDevice.findObject(
+            UiSelector()
+                .resourceId(appName + ":id/apps")
+                .enabled(true)
+        )
+
+        /* Go to mozilla page */TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+
+        /* Select Open with from menu, check appearance */TestHelper.menuButton.perform(ViewActions.click())
+        openWithBtn.waitForExists(waitingTime)
+        openWithBtn.click()
+        openWithTitle.waitForExists(waitingTime)
+        Assert.assertTrue(openWithTitle.exists())
+        Assert.assertTrue(openWithList.exists())
+        pressBackKey()
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.java
deleted file mode 100644
index c283f337d718..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.java
+++ /dev/null
@@ -1,160 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static junit.framework.Assert.assertTrue;
-import static org.junit.Assert.assertFalse;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-@RunWith(AndroidJUnit4.class)
-public class SettingsBlockToggleTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void SettingsToggleTest() throws UiObjectNotFoundException {
-
-        UiObject privacyHeading = TestHelper.mDevice.findObject(new UiSelector()
-                .text("Privacy & Security")
-                .resourceId("android:id/title"));
-        UiObject blockAdTrackerEntry = TestHelper.settingsMenu.getChild(new UiSelector()
-                .className("android.widget.LinearLayout")
-                .instance(1));
-        UiObject blockAdTrackerSwitch = blockAdTrackerEntry.getChild(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/switchWidget"));
-
-        UiObject blockAnalyticTrackerEntry = TestHelper.settingsMenu.getChild(new UiSelector()
-                .className("android.widget.LinearLayout")
-                .instance(2));
-        UiObject blockAnalyticTrackerSwitch = blockAnalyticTrackerEntry.getChild(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/switchWidget"));
-
-        UiObject blockSocialTrackerEntry = TestHelper.settingsMenu.getChild(new UiSelector()
-                .className("android.widget.LinearLayout")
-                .instance(4));
-        UiObject blockSocialTrackerSwitch = blockSocialTrackerEntry.getChild(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/switchWidget"));
-
-        // Let's go to an actual URL which is http://
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        TestHelper.waitForWebContent();
-        assertTrue (TestHelper.browserURLbar.getText().contains(webServer.url(TEST_PATH).toString()));
-        assertTrue (!TestHelper.lockIcon.exists());
-
-        /* Go to settings and disable everything */
-        openSettings();
-        privacyHeading.waitForExists(waitingTime);
-        privacyHeading.click();
-
-        String blockAdTrackerValue = blockAdTrackerSwitch.getText();
-        String blockAnalyticTrackerValue = blockAnalyticTrackerSwitch.getText();
-        String blockSocialTrackerValue = blockSocialTrackerSwitch.getText();
-
-        // Turn off and back on
-        blockAdTrackerEntry.click();
-        blockAnalyticTrackerEntry.click();
-        blockSocialTrackerEntry.click();
-
-        assertFalse(blockAdTrackerSwitch.getText().equals(blockAdTrackerValue));
-        assertFalse(blockAnalyticTrackerSwitch.getText().equals(blockAnalyticTrackerValue));
-        assertFalse(blockSocialTrackerSwitch.getText().equals(blockSocialTrackerValue));
-
-        blockAdTrackerEntry.click();
-        blockAnalyticTrackerEntry.click();
-        blockSocialTrackerEntry.click();
-
-        assertTrue(blockAdTrackerSwitch.getText().equals(blockAdTrackerValue));
-        assertTrue(blockAnalyticTrackerSwitch.getText().equals(blockAnalyticTrackerValue));
-        assertTrue(blockSocialTrackerSwitch.getText().equals(blockSocialTrackerValue));
-
-        //Back to the webpage
-        TestHelper.pressBackKey();
-        TestHelper.pressBackKey();
-        TestHelper.waitForWebContent();
-        assertTrue (TestHelper.browserURLbar.getText().contains(webServer.url(TEST_PATH).toString()));
-        assertTrue (!TestHelper.lockIcon.exists());
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.kt
new file mode 100644
index 000000000000..2a61444d9d0d
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SettingsBlockToggleTest.kt
@@ -0,0 +1,152 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+@RunWith(AndroidJUnit4ClassRunner::class)
+class SettingsBlockToggleTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun SettingsToggleTest() {
+        val privacyHeading = TestHelper.mDevice.findObject(
+            UiSelector()
+                .text("Privacy & Security")
+                .resourceId("android:id/title")
+        )
+        val blockAdTrackerEntry = TestHelper.settingsMenu.getChild(
+            UiSelector()
+                .className("android.widget.LinearLayout")
+                .instance(1)
+        )
+        val blockAdTrackerSwitch = blockAdTrackerEntry.getChild(
+            UiSelector()
+                .resourceId(appName + ":id/switchWidget")
+        )
+        val blockAnalyticTrackerEntry = TestHelper.settingsMenu.getChild(
+            UiSelector()
+                .className("android.widget.LinearLayout")
+                .instance(2)
+        )
+        val blockAnalyticTrackerSwitch = blockAnalyticTrackerEntry.getChild(
+            UiSelector()
+                .resourceId(appName + ":id/switchWidget")
+        )
+        val blockSocialTrackerEntry = TestHelper.settingsMenu.getChild(
+            UiSelector()
+                .className("android.widget.LinearLayout")
+                .instance(4)
+        )
+        val blockSocialTrackerSwitch = blockSocialTrackerEntry.getChild(
+            UiSelector()
+                .resourceId(appName + ":id/switchWidget")
+        )
+
+        // Let's go to an actual URL which is http://
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        waitForWebContent()
+        Assert.assertTrue(
+            TestHelper.browserURLbar.text.contains(
+                webServer!!.url(TEST_PATH).toString()
+            )
+        )
+        Assert.assertTrue(!TestHelper.lockIcon.exists())
+
+        /* Go to settings and disable everything */openSettings()
+        privacyHeading.waitForExists(waitingTime)
+        privacyHeading.click()
+        val blockAdTrackerValue = blockAdTrackerSwitch.text
+        val blockAnalyticTrackerValue = blockAnalyticTrackerSwitch.text
+        val blockSocialTrackerValue = blockSocialTrackerSwitch.text
+
+        // Turn off and back on
+        blockAdTrackerEntry.click()
+        blockAnalyticTrackerEntry.click()
+        blockSocialTrackerEntry.click()
+        org.junit.Assert.assertFalse(blockAdTrackerSwitch.text == blockAdTrackerValue)
+        org.junit.Assert.assertFalse(blockAnalyticTrackerSwitch.text == blockAnalyticTrackerValue)
+        org.junit.Assert.assertFalse(blockSocialTrackerSwitch.text == blockSocialTrackerValue)
+        blockAdTrackerEntry.click()
+        blockAnalyticTrackerEntry.click()
+        blockSocialTrackerEntry.click()
+        Assert.assertTrue(blockAdTrackerSwitch.text == blockAdTrackerValue)
+        Assert.assertTrue(blockAnalyticTrackerSwitch.text == blockAnalyticTrackerValue)
+        Assert.assertTrue(blockSocialTrackerSwitch.text == blockSocialTrackerValue)
+
+        // Back to the webpage
+        pressBackKey()
+        pressBackKey()
+        waitForWebContent()
+        Assert.assertTrue(
+            TestHelper.browserURLbar.text.contains(
+                webServer!!.url(TEST_PATH).toString()
+            )
+        )
+        Assert.assertTrue(!TestHelper.lockIcon.exists())
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.java
deleted file mode 100644
index f156961fbd56..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.java
+++ /dev/null
@@ -1,119 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.action.ViewActions.click;
-import static junit.framework.Assert.assertTrue;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test opens share menu
-// https://testrail.stage.mozaws.net/index.php?/cases/view/47592
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class ShareWebsiteTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("plain_test.html")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void ShareWebsiteTest() throws UiObjectNotFoundException {
-
-        UiObject shareBtn = TestHelper.mDevice.findObject(new UiSelector()
-                .resourceId(TestHelper.getAppName() + ":id/share")
-                .enabled(true));
-
-        /* Go to a webpage */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-        assertTrue(TestHelper.webView.waitForExists(waitingTime));
-
-        /* Select share */
-        TestHelper.menuButton.perform(click());
-        shareBtn.waitForExists(waitingTime);
-        shareBtn.click();
-
-        // For simulators, where apps are not installed, it'll take to message app
-        TestHelper.shareMenuHeader.waitForExists(waitingTime);
-        assertTrue(TestHelper.shareMenuHeader.exists());
-        assertTrue(TestHelper.shareAppList.exists());
-        TestHelper.pressBackKey();
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.kt
new file mode 100644
index 000000000000..572637ccdcbd
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ShareWebsiteTest.kt
@@ -0,0 +1,94 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.appName
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+// This test opens share menu
+// https://testrail.stage.mozaws.net/index.php?/cases/view/47592
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class ShareWebsiteTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("plain_test.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+
+    init {
+        val shareBtn = TestHelper.mDevice.findObject(
+            UiSelector()
+                .resourceId(appName + ":id/share")
+                .enabled(true)
+        )
+
+        /* Go to a webpage */TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+        Assert.assertTrue(TestHelper.webView.waitForExists(waitingTime))
+
+        /* Select share */TestHelper.menuButton.perform(ViewActions.click())
+        shareBtn.waitForExists(waitingTime)
+        shareBtn.click()
+
+        // For simulators, where apps are not installed, it'll take to message app
+        TestHelper.shareMenuHeader.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.shareMenuHeader.exists())
+        Assert.assertTrue(TestHelper.shareAppList.exists())
+        pressBackKey()
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java
deleted file mode 100644
index f80e1a4213a2..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.java
+++ /dev/null
@@ -1,207 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.content.Intent;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.By;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-import androidx.test.uiautomator.Until;
-
-import org.junit.After;
-import org.junit.Assert;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.core.IsNull.notNullValue;
-import static org.junit.Assert.assertThat;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test opens enters and invalid URL, and Focus should provide an appropriate error message
-@RunWith(AndroidJUnit4.class)
-@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
-public class SwitchContextTest {
-
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule  = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("image_test.html"))
-                        .addHeader("Set-Cookie", "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("rabbit.jpg")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("download.jpg")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void ForegroundTest() throws  UiObjectNotFoundException {
-
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-
-        // Assert website is loaded
-        TestHelper.waitForWebSiteTitleLoad();
-
-        // Switch out of Focus, pull down system bar and select open action
-        TestHelper.pressHomeKey();
-        TestHelper.openNotification();
-        TestHelper.waitForIdle();
-        // If simulator has more recent message, the options need to be expanded
-        TestHelper.expandNotification();
-        TestHelper.notificationOpenItem.click();
-
-        // Verify that it's on the main view, showing the previous browsing session
-        TestHelper.browserURLbar.waitForExists(waitingTime);
-        assertTrue(TestHelper.browserURLbar.exists());
-        TestHelper.waitForWebSiteTitleLoad();
-    }
-
-    @Test
-    public void eraseAndOpenTest() throws UiObjectNotFoundException {
-
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-
-        // Assert website is loaded
-        TestHelper.waitForWebSiteTitleLoad();
-
-        // Switch out of Focus, pull down system bar and select open action
-        TestHelper.pressHomeKey();
-        TestHelper.openNotification();
-
-        // If simulator has more recent message, the options need to be expanded
-        TestHelper.expandNotification();
-        TestHelper.notificationEraseOpenItem.click();
-
-        // Verify that it's on the main view, showing the initial view
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-        assertTrue(TestHelper.erasedMsg.exists());
-        assertTrue(TestHelper.inlineAutocompleteEditText.exists());
-        assertTrue(TestHelper.initialView.exists());
-    }
-
-    @Test
-    public void settingsToFocus() throws UiObjectNotFoundException {
-
-        // Initialize UiDevice instance
-        final int LAUNCH_TIMEOUT = 5000;
-        final String SETTINGS_APP = "com.android.settings";
-        final UiObject settings = TestHelper.mDevice.findObject(new UiSelector()
-                .packageName(SETTINGS_APP)
-                .enabled(true));
-
-        // Open a webpage
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText(webServer.url(TEST_PATH).toString());
-        TestHelper.hint.waitForExists(waitingTime);
-        TestHelper.pressEnterKey();
-
-        // Assert website is loaded
-        TestHelper.waitForWebSiteTitleLoad();
-
-        // Switch out of Focus, open settings app
-        TestHelper.pressHomeKey();
-
-        // Wait for launcher
-        final String launcherPackage = TestHelper.mDevice.getLauncherPackageName();
-        assertThat(launcherPackage, notNullValue());
-        TestHelper.mDevice.wait(Until.hasObject(By.pkg(launcherPackage).depth(0)),
-                LAUNCH_TIMEOUT);
-
-        // Launch the app
-        Context context = InstrumentationRegistry.getInstrumentation()
-                .getTargetContext()
-                .getApplicationContext();
-        final Intent intent = context.getPackageManager()
-                .getLaunchIntentForPackage(SETTINGS_APP);
-        context.startActivity(intent);
-
-        // switch to Focus
-        settings.waitForExists(waitingTime);
-        assertTrue(settings.exists());
-        TestHelper.openNotification();
-
-        // If simulator has more recent message, the options need to be expanded
-        TestHelper.expandNotification();
-        TestHelper.notificationOpenItem.click();
-
-        // Verify that it's on the main view, showing the previous browsing session
-        TestHelper.browserURLbar.waitForExists(waitingTime);
-        assertTrue(TestHelper.browserURLbar.exists());
-        TestHelper.waitForWebSiteTitleLoad();
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.kt
new file mode 100644
index 000000000000..8f140920ee6b
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchContextTest.kt
@@ -0,0 +1,203 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.By
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import androidx.test.uiautomator.Until
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.hamcrest.core.IsNull
+import org.junit.After
+import org.junit.Assert
+import org.junit.Before
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.expandNotification
+import org.mozilla.focus.helpers.TestHelper.openNotification
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.pressHomeKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForIdle
+import org.mozilla.focus.helpers.TestHelper.waitForWebSiteTitleLoad
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+// This test opens enters and invalid URL, and Focus should provide an appropriate error message
+@RunWith(AndroidJUnit4ClassRunner::class)
+@Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
+class SwitchContextTest {
+    private var webServer: MockWebServer? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("image_test.html"))
+                    .addHeader(
+                        "Set-Cookie",
+                        "sphere=battery; Expires=Wed, 21 Oct 2035 07:28:00 GMT;"
+                    )
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("rabbit.jpg"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("download.jpg"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun ForegroundTest() {
+
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+
+        // Assert website is loaded
+        waitForWebSiteTitleLoad()
+
+        // Switch out of Focus, pull down system bar and select open action
+        pressHomeKey()
+        openNotification()
+        waitForIdle()
+        // If simulator has more recent message, the options need to be expanded
+        expandNotification()
+        TestHelper.notificationOpenItem.click()
+
+        // Verify that it's on the main view, showing the previous browsing session
+        TestHelper.browserURLbar.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.browserURLbar.exists())
+        waitForWebSiteTitleLoad()
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun eraseAndOpenTest() {
+
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text =
+            webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+
+        // Assert website is loaded
+        waitForWebSiteTitleLoad()
+
+        // Switch out of Focus, pull down system bar and select open action
+        pressHomeKey()
+        openNotification()
+
+        // If simulator has more recent message, the options need to be expanded
+        expandNotification()
+        TestHelper.notificationEraseOpenItem.click()
+
+        // Verify that it's on the main view, showing the initial view
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.erasedMsg.exists())
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.exists())
+        Assert.assertTrue(TestHelper.initialView.exists())
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun settingsToFocus() {
+
+        // Initialize UiDevice instance
+        val LAUNCH_TIMEOUT = 5000
+        val SETTINGS_APP = "com.android.settings"
+        val settings = TestHelper.mDevice.findObject(
+            UiSelector()
+                .packageName(SETTINGS_APP)
+                .enabled(true)
+        )
+
+        // Open a webpage
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = webServer!!.url(TEST_PATH).toString()
+        TestHelper.hint.waitForExists(waitingTime)
+        pressEnterKey()
+
+        // Assert website is loaded
+        waitForWebSiteTitleLoad()
+
+        // Switch out of Focus, open settings app
+        pressHomeKey()
+
+        // Wait for launcher
+        val launcherPackage = TestHelper.mDevice.launcherPackageName
+        Assert.assertThat(launcherPackage, IsNull.notNullValue())
+        TestHelper.mDevice.wait(
+            Until.hasObject(By.pkg(launcherPackage).depth(0)),
+            LAUNCH_TIMEOUT.toLong()
+        )
+
+        // Launch the app
+        val context = InstrumentationRegistry.getInstrumentation()
+            .targetContext
+            .applicationContext
+        val intent = context.packageManager
+            .getLaunchIntentForPackage(SETTINGS_APP)
+        context.startActivity(intent)
+
+        // switch to Focus
+        settings.waitForExists(waitingTime)
+        Assert.assertTrue(settings.exists())
+        openNotification()
+
+        // If simulator has more recent message, the options need to be expanded
+        expandNotification()
+        TestHelper.notificationOpenItem.click()
+
+        // Verify that it's on the main view, showing the previous browsing session
+        TestHelper.browserURLbar.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.browserURLbar.exists())
+        waitForWebSiteTitleLoad()
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java
deleted file mode 100644
index 69f52d85d7bc..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.java
+++ /dev/null
@@ -1,273 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-import android.content.res.Configuration;
-import android.content.res.Resources;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiScrollable;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Assert;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.rules.TestRule;
-import org.junit.rules.TestWatcher;
-import org.junit.runner.Description;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.helpers.TestHelper;
-
-import java.util.Locale;
-
-import static android.os.Build.VERSION.SDK_INT;
-import static androidx.test.espresso.action.ViewActions.click;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.openMenu;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.mDevice;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test checks all the headings in the Settings menu are there
-// https://testrail.stage.mozaws.net/index.php?/cases/view/47587
-@RunWith(AndroidJUnit4.class)
-public class SwitchLocaleTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @Rule
-    public TestRule watcher = new TestWatcher() {
-        protected void starting(Description description) {
-            System.out.println("Starting test: " + description.getMethodName());
-            if (description.getMethodName().equals("FrenchLocaleTest")) {
-                changeLocale("fr");
-            }
-        }
-    };
-
-    public SwitchLocaleTest() throws UiObjectNotFoundException {
-    }
-
-    @After
-    public void tearDown() {
-        changeLocale("en");
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @SuppressWarnings("deprecation")
-    public static void changeLocale(String locale) {
-        Context context = InstrumentationRegistry.getInstrumentation()
-                .getTargetContext();
-
-        Resources res = context.getApplicationContext().getResources();
-        Configuration config = res.getConfiguration();
-
-
-        config.setLocale(new Locale(locale));
-        if (SDK_INT >= 25) {
-            context.createConfigurationContext(config);
-        } else {
-            res.updateConfiguration(config, res.getDisplayMetrics());
-        }
-    }
-
-    private UiObject sysDefaultLocale = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.CheckedTextView")
-            .instance(0)
-            .enabled(true));
-    private UiObject languageHeading = TestHelper.settingsMenu.getChild(new UiSelector()
-            .className("android.widget.LinearLayout")
-            .instance(4));
-    private UiObject englishHeading = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.TextView")
-            .text("Language"));
-    private UiObject frenchHeading = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.TextView")
-            .text("Langue"));
-    private UiObject englishGeneralHeading = TestHelper.mDevice.findObject(new UiSelector()
-            .text("General")
-            .resourceId("android:id/title"));
-    private UiObject frenchGeneralHeading = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Gnral")
-            .resourceId("android:id/title"));
-    private UiObject englishMozillaHeading = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Mozilla")
-            .resourceId("android:id/title"));
-    private UiObject showHomeScreenTips = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.Switch")
-            .instance(0));
-
-    @Test
-    public void EnglishSystemLocaleTest() throws UiObjectNotFoundException {
-        UiObject frenchMenuItem = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("Franais"));
-        UiObject englishMenuItem = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("System default"));
-        UiObject frenchLocaleinEn = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.CheckedTextView")
-                .text("Franais"));
-
-        /* Go to Settings */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-
-        openSettings();
-
-        /* Disable home screen tips */
-        englishMozillaHeading.waitForExists(waitingTime);
-        englishMozillaHeading.click();
-        showHomeScreenTips.waitForExists(waitingTime);
-        showHomeScreenTips.click();
-
-        TestHelper.pressBackKey();
-
-        // Open General Settings
-        englishGeneralHeading.waitForExists(waitingTime);
-        englishGeneralHeading.click();
-
-        languageHeading.waitForExists(waitingTime);
-
-        /* system locale is in English, check it is now set to system locale */
-        languageHeading.click();
-        sysDefaultLocale.waitForExists(waitingTime);
-        Assert.assertTrue(sysDefaultLocale.isChecked());
-
-        /* change locale to non-english in the setting, verify the locale is changed */
-        UiScrollable appViews = new UiScrollable(new UiSelector().scrollable(true));
-        appViews.scrollIntoView(frenchLocaleinEn);
-        Assert.assertTrue(frenchLocaleinEn.isClickable());
-        frenchLocaleinEn.click();
-
-        frenchHeading.waitForExists(waitingTime);
-        Assert.assertTrue(frenchHeading.exists());
-        Assert.assertTrue(frenchMenuItem.exists());
-
-        /* Exit to main and see the UI is in French as well */
-        TestHelper.pressBackKey();
-        TestHelper.pressBackKey();
-
-        UiObject frenchTitle = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("Navigation prive automatique.\nNaviguez. Effacez. Recommencez."));
-        frenchTitle.waitForExists(waitingTime);
-        Assert.assertTrue(frenchTitle.exists());
-
-        openMenu();
-        Assert.assertEquals(TestHelper.settingsMenuItem.getText(), "Paramtres");
-        Assert.assertEquals(TestHelper.HelpItem.getText(), "Aide");
-        TestHelper.settingsMenuItem.click();
-
-        /* re-enter settings and general settings, change it back to system locale, verify the locale is changed */
-        frenchGeneralHeading.waitForExists(waitingTime);
-        frenchGeneralHeading.click();
-        languageHeading.waitForExists(waitingTime);
-
-        languageHeading.click();
-        Assert.assertTrue(frenchLocaleinEn.isChecked());
-        appViews.scrollToBeginning(10);
-        sysDefaultLocale.waitForExists(waitingTime);
-        sysDefaultLocale.click();
-        languageHeading.waitForExists(waitingTime);
-        Assert.assertTrue(englishHeading.exists());
-        Assert.assertTrue(englishMenuItem.exists());
-
-        // Exit Settings
-        TestHelper.pressBackKey();
-        TestHelper.pressBackKey();
-
-        UiObject englishTitle = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("Automatic private browsing.\nBrowse. Erase. Repeat."));
-        englishTitle.waitForExists(waitingTime);
-        Assert.assertTrue(englishTitle.exists());
-
-        openSettings();
-
-        /* Enable home screen tips */
-        englishMozillaHeading.waitForExists(waitingTime);
-        englishMozillaHeading.click();
-        showHomeScreenTips.waitForExists(waitingTime);
-        showHomeScreenTips.click();
-
-        TestHelper.pressBackKey();
-        TestHelper.pressBackKey();
-
-        TestHelper.menuButton.perform(click());
-        Assert.assertEquals(TestHelper.settingsMenuItem.getText(), "Settings");
-        Assert.assertEquals(TestHelper.HelpItem.getText(), "Help");
-
-        mDevice.pressBack();
-    }
-
-    @Test
-    public void FrenchLocaleTest() throws UiObjectNotFoundException {
-
-        UiObject frenchMenuItem = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("Valeur par dfaut du systme"));
-        UiObject englishMenuItem = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.TextView")
-                .text("English (United States)"));
-        UiObject englishLocaleinFr = TestHelper.mDevice.findObject(new UiSelector()
-                .className("android.widget.CheckedTextView")
-                .text("English (United States)"));
-
-        /* Go to Settings */
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-
-        openSettings();
-        frenchGeneralHeading.waitForExists(waitingTime);
-        frenchGeneralHeading.click();
-
-        languageHeading.waitForExists(waitingTime);
-
-        /* system locale is in French, check it is now set to system locale */
-        frenchHeading.waitForExists(waitingTime);
-        Assert.assertTrue(frenchHeading.exists());
-        Assert.assertTrue(frenchMenuItem.exists());
-        languageHeading.click();
-        Assert.assertTrue(sysDefaultLocale.isChecked());
-
-        /* change locale to English in the setting, verify the locale is changed */
-        UiScrollable appViews = new UiScrollable(new UiSelector().scrollable(true));
-        appViews.scrollIntoView(englishLocaleinFr);
-        Assert.assertTrue(englishLocaleinFr.isClickable());
-        englishLocaleinFr.click();
-        englishHeading.waitForExists(waitingTime);
-        Assert.assertTrue(englishHeading.exists());
-        Assert.assertTrue(englishMenuItem.exists());
-        mDevice.pressBack();
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.kt
new file mode 100644
index 000000000000..a2f8fe6c5700
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/SwitchLocaleTest.kt
@@ -0,0 +1,254 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.os.Build.VERSION
+import androidx.test.espresso.action.ViewActions
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiScrollable
+import androidx.test.uiautomator.UiSelector
+import org.junit.After
+import org.junit.Assert
+import org.junit.Rule
+import org.junit.Test
+import org.junit.rules.TestRule
+import org.junit.rules.TestWatcher
+import org.junit.runner.Description
+import org.junit.runner.RunWith
+import org.mozilla.focus.helpers.EspressoHelper.openMenu
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.util.Locale
+
+// This test checks all the headings in the Settings menu are there
+// https://testrail.stage.mozaws.net/index.php?/cases/view/47587
+@RunWith(AndroidJUnit4ClassRunner::class)
+class SwitchLocaleTest {
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @get: Rule
+    var watcher: TestRule = object : TestWatcher() {
+        override fun starting(description: Description) {
+            println("Starting test: " + description.methodName)
+            if (description.methodName == "FrenchLocaleTest") {
+                changeLocale("fr")
+            }
+        }
+    }
+
+    @After
+    fun tearDown() {
+        changeLocale("en")
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    private val sysDefaultLocale = TestHelper.mDevice.findObject(
+        UiSelector()
+            .className("android.widget.CheckedTextView")
+            .instance(0)
+            .enabled(true)
+    )
+    private val languageHeading = TestHelper.settingsMenu.getChild(
+        UiSelector()
+            .className("android.widget.LinearLayout")
+            .instance(4)
+    )
+    private val englishHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .className("android.widget.TextView")
+            .text("Language")
+    )
+    private val frenchHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .className("android.widget.TextView")
+            .text("Langue")
+    )
+    private val englishGeneralHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("General")
+            .resourceId("android:id/title")
+    )
+    private val frenchGeneralHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Gnral")
+            .resourceId("android:id/title")
+    )
+    private val englishMozillaHeading = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Mozilla")
+            .resourceId("android:id/title")
+    )
+    private val showHomeScreenTips = TestHelper.mDevice.findObject(
+        UiSelector()
+            .className("android.widget.Switch")
+            .instance(0)
+    )
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun EnglishSystemLocaleTest() {
+        val frenchMenuItem = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("Franais")
+        )
+        val englishMenuItem = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("System default")
+        )
+        val frenchLocaleinEn = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.CheckedTextView")
+                .text("Franais")
+        )
+
+        /* Go to Settings */TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        openSettings()
+
+        /* Disable home screen tips */englishMozillaHeading.waitForExists(waitingTime)
+        englishMozillaHeading.click()
+        showHomeScreenTips.waitForExists(waitingTime)
+        showHomeScreenTips.click()
+        pressBackKey()
+
+        // Open General Settings
+        englishGeneralHeading.waitForExists(waitingTime)
+        englishGeneralHeading.click()
+        languageHeading.waitForExists(waitingTime)
+
+        /* system locale is in English, check it is now set to system locale */languageHeading.click()
+        sysDefaultLocale.waitForExists(waitingTime)
+        Assert.assertTrue(sysDefaultLocale.isChecked)
+
+        /* change locale to non-english in the setting, verify the locale is changed */
+        val appViews = UiScrollable(UiSelector().scrollable(true))
+        appViews.scrollIntoView(frenchLocaleinEn)
+        Assert.assertTrue(frenchLocaleinEn.isClickable)
+        frenchLocaleinEn.click()
+        frenchHeading.waitForExists(waitingTime)
+        Assert.assertTrue(frenchHeading.exists())
+        Assert.assertTrue(frenchMenuItem.exists())
+
+        /* Exit to main and see the UI is in French as well */pressBackKey()
+        pressBackKey()
+        val frenchTitle = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("Navigation prive automatique.\nNaviguez. Effacez. Recommencez.")
+        )
+        frenchTitle.waitForExists(waitingTime)
+        Assert.assertTrue(frenchTitle.exists())
+        openMenu()
+        Assert.assertEquals(TestHelper.settingsMenuItem.text, "Paramtres")
+        Assert.assertEquals(TestHelper.HelpItem.text, "Aide")
+        TestHelper.settingsMenuItem.click()
+
+        /* re-enter settings and general settings, change it back to system locale, verify the locale is changed */frenchGeneralHeading.waitForExists(
+            waitingTime
+        )
+        frenchGeneralHeading.click()
+        languageHeading.waitForExists(waitingTime)
+        languageHeading.click()
+        Assert.assertTrue(frenchLocaleinEn.isChecked)
+        appViews.scrollToBeginning(10)
+        sysDefaultLocale.waitForExists(waitingTime)
+        sysDefaultLocale.click()
+        languageHeading.waitForExists(waitingTime)
+        Assert.assertTrue(englishHeading.exists())
+        Assert.assertTrue(englishMenuItem.exists())
+
+        // Exit Settings
+        pressBackKey()
+        pressBackKey()
+        val englishTitle = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("Automatic private browsing.\nBrowse. Erase. Repeat.")
+        )
+        englishTitle.waitForExists(waitingTime)
+        Assert.assertTrue(englishTitle.exists())
+        openSettings()
+
+        /* Enable home screen tips */englishMozillaHeading.waitForExists(waitingTime)
+        englishMozillaHeading.click()
+        showHomeScreenTips.waitForExists(waitingTime)
+        showHomeScreenTips.click()
+        pressBackKey()
+        pressBackKey()
+        TestHelper.menuButton.perform(ViewActions.click())
+        Assert.assertEquals(TestHelper.settingsMenuItem.text, "Settings")
+        Assert.assertEquals(TestHelper.HelpItem.text, "Help")
+        TestHelper.mDevice.pressBack()
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun FrenchLocaleTest() {
+        val frenchMenuItem = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("Valeur par dfaut du systme")
+        )
+        val englishMenuItem = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.TextView")
+                .text("English (United States)")
+        )
+        val englishLocaleinFr = TestHelper.mDevice.findObject(
+            UiSelector()
+                .className("android.widget.CheckedTextView")
+                .text("English (United States)")
+        )
+
+        /* Go to Settings */TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        openSettings()
+        frenchGeneralHeading.waitForExists(waitingTime)
+        frenchGeneralHeading.click()
+        languageHeading.waitForExists(waitingTime)
+
+        /* system locale is in French, check it is now set to system locale */frenchHeading.waitForExists(
+            waitingTime
+        )
+        Assert.assertTrue(frenchHeading.exists())
+        Assert.assertTrue(frenchMenuItem.exists())
+        languageHeading.click()
+        Assert.assertTrue(sysDefaultLocale.isChecked)
+
+        /* change locale to English in the setting, verify the locale is changed */
+        val appViews = UiScrollable(UiSelector().scrollable(true))
+        appViews.scrollIntoView(englishLocaleinFr)
+        Assert.assertTrue(englishLocaleinFr.isClickable)
+        englishLocaleinFr.click()
+        englishHeading.waitForExists(waitingTime)
+        Assert.assertTrue(englishHeading.exists())
+        Assert.assertTrue(englishMenuItem.exists())
+        TestHelper.mDevice.pressBack()
+    }
+
+    companion object {
+        @Suppress("Deprecation")
+        fun changeLocale(locale: String?) {
+            val context = InstrumentationRegistry.getInstrumentation()
+                .targetContext
+            val res = context.applicationContext.resources
+            val config = res.configuration
+            config.setLocale(Locale(locale!!))
+            if (VERSION.SDK_INT >= 25) {
+                context.createConfigurationContext(config)
+            } else {
+                res.updateConfiguration(config, res.displayMetrics)
+            }
+        }
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java
deleted file mode 100644
index 733fc856bf45..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.java
+++ /dev/null
@@ -1,197 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.IdlingRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.SessionLoadedIdlingResource;
-import org.mozilla.focus.helpers.TestHelper;
-
-import java.io.IOException;
-
-import okhttp3.mockwebserver.MockResponse;
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.action.ViewActions.pressImeActionButton;
-import static androidx.test.espresso.action.ViewActions.typeText;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.hasFocus;
-import static androidx.test.espresso.matcher.ViewMatchers.isChecked;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static org.hamcrest.Matchers.not;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// This test toggles blocking within the browser view
-// mozilla.org site has one google analytics tracker - tests will see whether this gets blocked properly
-@RunWith(AndroidJUnit4.class)
-public class ToggleBlockTest {
-    private static final String TEST_PATH = "/";
-    private MockWebServer webServer;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-
-            webServer = new MockWebServer();
-
-            try {
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("ad.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("ad.html")));
-                webServer.enqueue(new MockResponse()
-                        .setBody(TestHelper.readTestAsset("ad.html")));
-
-                webServer.start();
-            } catch (IOException e) {
-                throw new AssertionError("Could not start web server", e);
-            }
-        }
-
-        @Override
-        protected void afterActivityFinished() {
-            super.afterActivityFinished();
-
-            try {
-                webServer.close();
-                webServer.shutdown();
-            } catch (IOException e) {
-                throw new AssertionError("Could not stop web server", e);
-            }
-        }
-    };
-
-    private SessionLoadedIdlingResource loadingIdlingResource;
-
-    @Before
-    public void setUp() {
-        loadingIdlingResource = new SessionLoadedIdlingResource();
-        IdlingRegistry.getInstance().register(loadingIdlingResource);
-    }
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-        IdlingRegistry.getInstance().unregister(loadingIdlingResource);
-    }
-
-    @Test
-    public void SimpleToggleTest() {
-        // Load mozilla.org
-        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime);
-        onView(withId(R.id.urlView))
-                .check(matches(isDisplayed()))
-                .check(matches(hasFocus()))
-                .perform(typeText(webServer.url(TEST_PATH).toString()), pressImeActionButton());
-
-        TestHelper.waitForWebContent();
-        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime);
-
-        // The blocking badge is not disabled
-        onView(withId(R.id.block))
-                .check(matches(not(isDisplayed())));
-
-        // Open the menu
-        onView(withId(R.id.menuView))
-                .perform(click());
-        onView(withId(R.id.trackers_count))
-                .check(matches(not(withText("-"))));
-
-        // Disable blocking
-        onView(withId(R.id.blocking_switch))
-                .check(matches(isChecked()));
-
-        onView(withId(R.id.blocking_switch))
-                .perform(click());
-        TestHelper.waitForWebContent();
-
-        // Now the blocking badge is visible
-        onView(withId(R.id.block))
-                .check(matches(isDisplayed()));
-
-        onView(withId(R.id.webview)).perform(click());
-
-        // Open the menu again. Now the switch is disabled and the tracker count should be disabled.
-        onView(withId(R.id.menuView))
-                .perform(click());
-        onView(withId(R.id.blocking_switch))
-                .check(matches(not(isChecked())));
-        onView(withId(R.id.trackers_count))
-                .check(matches(withText("-")));
-
-        // Close the menu
-        TestHelper.pressBackKey();
-
-        // Erase
-        TestHelper.floatingEraseButton.perform(click());
-        TestHelper.erasedMsg.waitForExists(waitingTime);
-
-        // Load the same site again, it should now be in the exceptions list
-        try {
-            webServer.enqueue(new MockResponse()
-                    .setBody(TestHelper.readTestAsset("ad.html")));
-            webServer.enqueue(new MockResponse()
-                    .setBody(TestHelper.readTestAsset("ad.html")));
-            webServer.enqueue(new MockResponse()
-                    .setBody(TestHelper.readTestAsset("ad.html")));
-        } catch (IOException e) {
-            throw new AssertionError("Could not start web server", e);
-        }
-
-        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime);
-        onView(withId(R.id.urlView))
-                .check(matches(isDisplayed()))
-                .check(matches(hasFocus()))
-                .perform(typeText(webServer.url(TEST_PATH).toString()), pressImeActionButton());
-
-        TestHelper.waitForWebContent();
-        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime);
-
-        // The blocking badge is disabled
-        onView(withId(R.id.block))
-                .check(matches(isDisplayed()));
-
-        // Open the menu again. Now the switch is disabled and the tracker count should be disabled.
-        onView(withId(R.id.menuView))
-                .perform(click());
-        onView(withId(R.id.blocking_switch))
-                .check(matches(not(isChecked())));
-        onView(withId(R.id.trackers_count))
-                .check(matches(withText("-")));
-    }
-}
\ No newline at end of file
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.kt
new file mode 100644
index 000000000000..d8f59ca865e1
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/ToggleBlockTest.kt
@@ -0,0 +1,174 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.IdlingRegistry
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import okhttp3.mockwebserver.MockResponse
+import okhttp3.mockwebserver.MockWebServer
+import org.hamcrest.Matchers
+import org.junit.After
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.SessionLoadedIdlingResource
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressBackKey
+import org.mozilla.focus.helpers.TestHelper.readTestAsset
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import java.io.IOException
+
+// This test toggles blocking within the browser view
+// mozilla.org site has one google analytics tracker - tests will see whether this gets blocked properly
+@RunWith(AndroidJUnit4ClassRunner::class)
+class ToggleBlockTest {
+    private var webServer: MockWebServer? = null
+    private var loadingIdlingResource: SessionLoadedIdlingResource? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @Before
+    fun setUp() {
+        loadingIdlingResource = SessionLoadedIdlingResource()
+        IdlingRegistry.getInstance().register(loadingIdlingResource)
+
+        webServer = MockWebServer()
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+            webServer!!.start()
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+    }
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+        IdlingRegistry.getInstance().unregister(loadingIdlingResource)
+        try {
+            webServer!!.close()
+            webServer!!.shutdown()
+        } catch (e: IOException) {
+            throw AssertionError("Could not stop web server", e)
+        }
+    }
+
+    @Suppress("LongMethod")
+    @Test
+    fun SimpleToggleTest() {
+        // Load mozilla.org
+        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime)
+        Espresso.onView(ViewMatchers.withId(R.id.urlView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.hasFocus()))
+            .perform(
+                ViewActions.typeText(webServer!!.url(TEST_PATH).toString()),
+                ViewActions.pressImeActionButton()
+            )
+        waitForWebContent()
+        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime)
+
+        // The blocking badge is not disabled
+        Espresso.onView(ViewMatchers.withId(R.id.block))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isDisplayed())))
+
+        // Open the menu
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.trackers_count))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.withText("-"))))
+
+        // Disable blocking
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .check(ViewAssertions.matches(ViewMatchers.isChecked()))
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .perform(ViewActions.click())
+        waitForWebContent()
+
+        // Now the blocking badge is visible
+        Espresso.onView(ViewMatchers.withId(R.id.block))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        Espresso.onView(ViewMatchers.withId(R.id.webview)).perform(ViewActions.click())
+
+        // Open the menu again. Now the switch is disabled and the tracker count should be disabled.
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isChecked())))
+        Espresso.onView(ViewMatchers.withId(R.id.trackers_count))
+            .check(ViewAssertions.matches(ViewMatchers.withText("-")))
+
+        // Close the menu
+        pressBackKey()
+
+        // Erase
+        TestHelper.floatingEraseButton.perform(ViewActions.click())
+        TestHelper.erasedMsg.waitForExists(waitingTime)
+
+        // Load the same site again, it should now be in the exceptions list
+        try {
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+            webServer!!.enqueue(
+                MockResponse()
+                    .setBody(readTestAsset("ad.html"))
+            )
+        } catch (e: IOException) {
+            throw AssertionError("Could not start web server", e)
+        }
+        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime)
+        Espresso.onView(ViewMatchers.withId(R.id.urlView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.hasFocus()))
+            .perform(
+                ViewActions.typeText(webServer!!.url(TEST_PATH).toString()),
+                ViewActions.pressImeActionButton()
+            )
+        waitForWebContent()
+        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime)
+
+        // The blocking badge is disabled
+        Espresso.onView(ViewMatchers.withId(R.id.block))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        // Open the menu again. Now the switch is disabled and the tracker count should be disabled.
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isChecked())))
+        Espresso.onView(ViewMatchers.withId(R.id.trackers_count))
+            .check(ViewAssertions.matches(ViewMatchers.withText("-")))
+    }
+
+    companion object {
+        private const val TEST_PATH = "/"
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.java
deleted file mode 100644
index f23f03805ee4..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.java
+++ /dev/null
@@ -1,293 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.DataInteraction;
-import androidx.test.espresso.Espresso;
-import androidx.test.espresso.ViewInteraction;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-
-import org.junit.After;
-import org.junit.Ignore;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-
-import static androidx.test.espresso.Espresso.onData;
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.Espresso.openActionBarOverflowOrOptionsMenu;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.action.ViewActions.closeSoftKeyboard;
-import static androidx.test.espresso.action.ViewActions.replaceText;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.contrib.RecyclerViewActions.actionOnItemAtPosition;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withClassName;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static junit.framework.Assert.assertFalse;
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.Matchers.anything;
-import static org.hamcrest.Matchers.is;
-import static org.hamcrest.core.AllOf.allOf;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.childAtPosition;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.mDevice;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-
-// https://testrail.stage.mozaws.net/index.php?/cases/view/104577
-@RunWith(AndroidJUnit4.class)
-public class URLAutocompleteTest {
-    private String site = "680news.com";
-
-    // From API 24 and above
-    private DataInteraction CustomURLRow = onData(anything())
-            .inAdapterView(allOf(withId(android.R.id.list),
-                childAtPosition(
-                        withId(android.R.id.list_container),
-            0)))
-            .atPosition(4);
-
-    // From API 23 and below
-    private DataInteraction CustomURLRow_old = onData(anything())
-            .inAdapterView(allOf(withId(android.R.id.list),
-                    childAtPosition(
-                            withClassName(is("android.widget.LinearLayout")),
-                            0)))
-            .atPosition(4);
-
-    /* TODO: Reenable after fixing AndroidX migration issues
-    private ViewInteraction AutoCompleteDialog = onView(allOf(withId(R.id.recycler_view),
-            childAtPosition(withId(android.R.id.list_container), 0)));
-    */
-    private ViewInteraction AutoCompleteDialog = null;
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void CompletionTest() throws UiObjectNotFoundException {
-        /* type a partial url, and check it autocompletes*/
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.setText("mozilla");
-        TestHelper.hint.waitForExists(waitingTime);
-        assertTrue (TestHelper.inlineAutocompleteEditText.getText().equals("mozilla.org"));
-
-        /* press x to delete the both autocomplete and suggestion */
-        TestHelper.cleartextField.click();
-        assertTrue (TestHelper.inlineAutocompleteEditText.getText().equals("Search or enter address"));
-        assertFalse (TestHelper.hint.exists());
-
-        /* type a full url, and check it does not autocomplete */
-        TestHelper.inlineAutocompleteEditText.setText("http://www.mozilla.org");
-        TestHelper.hint.waitForExists(waitingTime);
-        assertTrue (TestHelper.inlineAutocompleteEditText.getText().equals("http://www.mozilla.org"));
-    }
-
-    // TODO: Reenable after fixing AndroidX migration issues
-    @Ignore
-    @Test
-    // Add custom autocomplete, and check to see it works
-    public void CustomCompletionTest() throws UiObjectNotFoundException {
-        OpenCustomCompleteDialog();
-
-        // Enable URL autocomplete, and add URL
-        addAutoComplete(site);
-        exitToTop();
-
-        // Check for custom autocompletion
-        checkACOn(site);
-        // Remove custom autocompletion site
-        OpenCustomCompleteDialog();
-        removeACSite();
-        exitToTop();
-
-        // Check autocompletion
-        checkACOff(site.substring(0, 3));
-     }
-
-    // TODO: Reenable after fixing AndroidX migration issues
-    @Ignore
-    @Test
-    // add custom autocompletion site, but disable autocomplete
-    public void DisableCCwithSiteTest() throws UiObjectNotFoundException {
-        OpenCustomCompleteDialog();
-        addAutoComplete(site);
-        Espresso.pressBack();
-        toggleCustomAC();  // Custom autocomplete is now off
-        Espresso.pressBack();
-        Espresso.pressBack();
-        Espresso.pressBack();
-        checkACOff(site.substring(0, 3));
-
-        // Now enable autocomplete
-        OpenCustomCompleteDialog();
-        toggleCustomAC();  // Custom autocomplete is now on
-        Espresso.pressBack();
-        Espresso.pressBack();
-        Espresso.pressBack();
-
-        // Check autocompletion
-        checkACOn(site);
-        // Cleanup
-        OpenCustomCompleteDialog();
-        removeACSite();
-    }
-
-    // TODO: Reenable after fixing AndroidX migration issues
-    @Ignore
-    @Test
-    public void DuplicateACSiteTest() {
-        OpenCustomCompleteDialog();
-
-        // Enable URL autocomplete, and tap Custom URL add button
-        addAutoComplete(site);
-        exitToTop();
-
-        // Try to add same site again
-        OpenCustomCompleteDialog();
-        addAutoComplete(site, false);
-
-        // Espresso cannot detect the "Already exists" popup.  Instead, check that it's
-        // still in the same page
-        onView(withId(R.id.domainView))
-                .check(matches(isDisplayed()));
-        onView(withId(R.id.save))
-                .check(matches(isDisplayed()));
-        Espresso.pressBack();
-        Espresso.pressBack();
-
-        // Cleanup
-        removeACSite();
-        Espresso.pressBack();
-    }
-
-    // exit to the main view from custom autocomplete dialog
-    private void exitToTop() {
-        Espresso.pressBack();
-        Espresso.pressBack();
-        Espresso.pressBack();
-        Espresso.pressBack();
-    }
-
-    private void toggleTopsiteAC() {
-        onView(withText("For Top sites"))
-                .perform(click());
-    }
-
-    private void toggleCustomAC() {
-        onView(withText("For Sites You Add"))
-                .perform(click());
-    }
-
-    private void OpenCustomCompleteDialog() {
-        mDevice.waitForIdle();
-        openSettings();
-
-        onView(withText("Search"))
-                .check(matches(isDisplayed()))
-                .perform(click());
-
-        onView(withText("URL Autocomplete"))
-                .check(matches(isDisplayed()))
-                .perform(click());
-        mDevice.waitForIdle();
-    }
-
-    // Check autocompletion is turned off
-    private void checkACOff(String url) throws UiObjectNotFoundException {
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.setText(url);
-        TestHelper.hint.waitForExists(waitingTime);
-        assertTrue (TestHelper.inlineAutocompleteEditText.getText().equals(url));
-        TestHelper.cleartextField.click();
-    }
-
-    // Check autocompletion is turned on
-    private void checkACOn(String url) throws UiObjectNotFoundException {
-        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime);
-        TestHelper.inlineAutocompleteEditText.setText(url.substring(0, 1));
-        TestHelper.hint.waitForExists(waitingTime);
-        assertTrue (TestHelper.inlineAutocompleteEditText.getText().equals(url));
-        TestHelper.cleartextField.click();
-    }
-
-    private void removeACSite() {
-        AutoCompleteDialog.perform(actionOnItemAtPosition(4, click()));
-
-        mDevice.waitForIdle();
-        openActionBarOverflowOrOptionsMenu(InstrumentationRegistry.getContext());
-        mDevice.waitForIdle();   // wait until dialog fully appears
-        onView(withText("Remove"))
-                .perform(click());
-        onView(withId(R.id.checkbox))
-                .perform((click()));
-        onView(withId(R.id.remove))
-                .perform((click()));
-    }
-
-    private void addAutoComplete(String sitename, boolean... checkSuccess) {
-
-        AutoCompleteDialog.perform(actionOnItemAtPosition(4, click()));
-
-        mDevice.waitForIdle();
-
-        onView(withText("+ Add custom URL"))
-                .perform(click());
-        onView(withId(R.id.domainView))
-                .check(matches(isDisplayed()));
-
-        mDevice.waitForIdle();
-
-
-        onView(withId(R.id.domainView))
-                .perform(replaceText(sitename), closeSoftKeyboard());
-        onView(withId(R.id.save))
-                .perform(click());
-
-        if (checkSuccess == null) { // Verify new entry appears in the list
-            onView(withText("Custom URLs"))
-                    .check(matches(isDisplayed()));
-
-            onView(allOf(withText(sitename), withId(R.id.domainView)))
-                    .check(matches(isDisplayed()));
-            mDevice.waitForIdle();
-        }
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.kt
new file mode 100644
index 000000000000..c2dcbf6743b1
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLAutocompleteTest.kt
@@ -0,0 +1,276 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.recyclerview.widget.RecyclerView
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.ViewInteraction
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.contrib.RecyclerViewActions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.UiObjectNotFoundException
+import org.hamcrest.Matchers
+import org.hamcrest.core.AllOf
+import org.junit.After
+import org.junit.Assert
+import org.junit.Ignore
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.EspressoHelper.childAtPosition
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.mDevice
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+
+@Suppress("TooManyFunctions")
+// https://testrail.stage.mozaws.net/index.php?/cases/view/104577
+@RunWith(AndroidJUnit4ClassRunner::class)
+class URLAutocompleteTest {
+    private val site = "680news.com"
+
+    // From API 24 and above
+    private val CustomURLRow = Espresso.onData(Matchers.anything())
+        .inAdapterView(
+            AllOf.allOf(
+                ViewMatchers.withId(android.R.id.list),
+                childAtPosition(
+                    ViewMatchers.withId(android.R.id.list_container),
+                    0
+                )
+            )
+        )
+        .atPosition(4)
+
+    // From API 23 and below
+    private val CustomURLRow_old = Espresso.onData(Matchers.anything())
+        .inAdapterView(
+            AllOf.allOf(
+                ViewMatchers.withId(android.R.id.list),
+                childAtPosition(
+                    ViewMatchers.withClassName(Matchers.`is`("android.widget.LinearLayout")),
+                    0
+                )
+            )
+        )
+        .atPosition(4)
+
+    /* TO DO: Reenable after fixing AndroidX migration issues
+    private ViewInteraction AutoCompleteDialog = onView(allOf(withId(R.id.recycler_view),
+            childAtPosition(withId(android.R.id.list_container), 0)));
+    */
+    private val AutoCompleteDialog: ViewInteraction? = null
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun CompletionTest() {
+        /* type a partial url, and check it autocompletes*/
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.text = "mozilla"
+        TestHelper.hint.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.text == "mozilla.org")
+
+        /* press x to delete the both autocomplete and suggestion */TestHelper.cleartextField.click()
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.text == "Search or enter address")
+        Assert.assertFalse(TestHelper.hint.exists())
+
+        /* type a full url, and check it does not autocomplete */TestHelper.inlineAutocompleteEditText.text =
+            "http://www.mozilla.org"
+        TestHelper.hint.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.text == "http://www.mozilla.org")
+    }
+
+    // TO DO: Reenable after fixing AndroidX migration issues
+    @Ignore
+    @Test // Add custom autocomplete, and check to see it works
+    @Throws(UiObjectNotFoundException::class)
+    fun CustomCompletionTest() {
+        OpenCustomCompleteDialog()
+
+        // Enable URL autocomplete, and add URL
+        addAutoComplete(site)
+        exitToTop()
+
+        // Check for custom autocompletion
+        checkACOn(site)
+        // Remove custom autocompletion site
+        OpenCustomCompleteDialog()
+        removeACSite()
+        exitToTop()
+
+        // Check autocompletion
+        checkACOff(site.substring(0, 3))
+    }
+
+    // TO DO: Reenable after fixing AndroidX migration issues
+    @Ignore
+    @Test // add custom autocompletion site, but disable autocomplete
+    @Throws(UiObjectNotFoundException::class)
+    fun DisableCCwithSiteTest() {
+        OpenCustomCompleteDialog()
+        addAutoComplete(site)
+        Espresso.pressBack()
+        toggleCustomAC() // Custom autocomplete is now off
+        Espresso.pressBack()
+        Espresso.pressBack()
+        Espresso.pressBack()
+        checkACOff(site.substring(0, 3))
+
+        // Now enable autocomplete
+        OpenCustomCompleteDialog()
+        toggleCustomAC() // Custom autocomplete is now on
+        Espresso.pressBack()
+        Espresso.pressBack()
+        Espresso.pressBack()
+
+        // Check autocompletion
+        checkACOn(site)
+        // Cleanup
+        OpenCustomCompleteDialog()
+        removeACSite()
+    }
+
+    // TO DO: Reenable after fixing AndroidX migration issues
+    @Ignore
+    @Test
+    fun DuplicateACSiteTest() {
+        OpenCustomCompleteDialog()
+
+        // Enable URL autocomplete, and tap Custom URL add button
+        addAutoComplete(site)
+        exitToTop()
+
+        // Try to add same site again
+        OpenCustomCompleteDialog()
+        addAutoComplete(site, false)
+
+        // Espresso cannot detect the "Already exists" popup.  Instead, check that it's
+        // still in the same page
+        Espresso.onView(ViewMatchers.withId(R.id.domainView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        Espresso.onView(ViewMatchers.withId(R.id.save))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        Espresso.pressBack()
+        Espresso.pressBack()
+
+        // Cleanup
+        removeACSite()
+        Espresso.pressBack()
+    }
+
+    // exit to the main view from custom autocomplete dialog
+    private fun exitToTop() {
+        Espresso.pressBack()
+        Espresso.pressBack()
+        Espresso.pressBack()
+        Espresso.pressBack()
+    }
+
+    private fun toggleTopsiteAC() {
+        Espresso.onView(ViewMatchers.withText("For Top sites"))
+            .perform(ViewActions.click())
+    }
+
+    private fun toggleCustomAC() {
+        Espresso.onView(ViewMatchers.withText("For Sites You Add"))
+            .perform(ViewActions.click())
+    }
+
+    private fun OpenCustomCompleteDialog() {
+        mDevice.waitForIdle()
+        openSettings()
+        Espresso.onView(ViewMatchers.withText("Search"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withText("URL Autocomplete"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        mDevice.waitForIdle()
+    }
+
+    // Check autocompletion is turned off
+    @Throws(UiObjectNotFoundException::class)
+    private fun checkACOff(url: String) {
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.text = url
+        TestHelper.hint.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.text == url)
+        TestHelper.cleartextField.click()
+    }
+
+    // Check autocompletion is turned on
+    @Throws(UiObjectNotFoundException::class)
+    private fun checkACOn(url: String) {
+        TestHelper.inlineAutocompleteEditText.waitForExists(waitingTime)
+        TestHelper.inlineAutocompleteEditText.text = url.substring(0, 1)
+        TestHelper.hint.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.inlineAutocompleteEditText.text == url)
+        TestHelper.cleartextField.click()
+    }
+
+    private fun removeACSite() {
+        AutoCompleteDialog!!.perform(
+            RecyclerViewActions.actionOnItemAtPosition<RecyclerView.ViewHolder>(
+                4,
+                ViewActions.click()
+            )
+        )
+        mDevice.waitForIdle()
+        Espresso.openActionBarOverflowOrOptionsMenu(InstrumentationRegistry.getInstrumentation().getContext())
+        mDevice.waitForIdle() // wait until dialog fully appears
+        Espresso.onView(ViewMatchers.withText("Remove"))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.checkbox))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.remove))
+            .perform(ViewActions.click())
+    }
+
+    @Suppress("SENSELESS_COMPARISON") // build error on (checkSuccess == null) always returns false
+    private fun addAutoComplete(sitename: String, vararg checkSuccess: Boolean?) {
+        AutoCompleteDialog!!.perform(
+            RecyclerViewActions.actionOnItemAtPosition<RecyclerView.ViewHolder>(
+                4,
+                ViewActions.click()
+            )
+        )
+        mDevice.waitForIdle()
+        Espresso.onView(ViewMatchers.withText("+ Add custom URL"))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.domainView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        mDevice.waitForIdle()
+        Espresso.onView(ViewMatchers.withId(R.id.domainView))
+            .perform(ViewActions.replaceText(sitename), ViewActions.closeSoftKeyboard())
+        Espresso.onView(ViewMatchers.withId(R.id.save))
+            .perform(ViewActions.click())
+
+        if (checkSuccess == null) { // Verify new entry appears in the list
+            Espresso.onView(ViewMatchers.withText("Custom URLs"))
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            Espresso.onView(
+                AllOf.allOf(
+                    ViewMatchers.withText(sitename),
+                    ViewMatchers.withId(R.id.domainView)
+                )
+            )
+                .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            mDevice.waitForIdle()
+        }
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.java
deleted file mode 100644
index f1f0187138f7..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.java
+++ /dev/null
@@ -1,190 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiScrollable;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.Espresso.openActionBarOverflowOrOptionsMenu;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.action.ViewActions.pressImeActionButton;
-import static androidx.test.espresso.action.ViewActions.typeText;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.hasFocus;
-import static androidx.test.espresso.matcher.ViewMatchers.isChecked;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.isEnabled;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static org.hamcrest.Matchers.not;
-import static org.hamcrest.core.AllOf.allOf;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.openSettings;
-import static org.mozilla.focus.helpers.TestHelper.mDevice;
-
-// https://testrail.stage.mozaws.net/index.php?/cases/view/104577
-@RunWith(AndroidJUnit4.class)
-public class URLExceptionTest {
-    private String site = "680news.com";
-
-    private UiObject exceptionsTitle = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Exceptions")
-            .resourceId("android:id/title"));
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule
-            = new ActivityTestRule<MainActivity>(MainActivity.class) {
-
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    private void OpenExceptionsFragment() throws UiObjectNotFoundException {
-        mDevice.waitForIdle();
-        openSettings();
-
-        onView(withText("Privacy & Security"))
-                .check(matches(isDisplayed()))
-                .perform(click());
-
-        /* change locale to non-english in the setting, verify the locale is changed */
-        UiScrollable appViews = new UiScrollable(new UiSelector().scrollable(true));
-        appViews.scrollIntoView(exceptionsTitle);
-        if (exceptionsTitle.isEnabled()) {
-            exceptionsTitle.click();
-        }
-
-        mDevice.waitForIdle();
-    }
-
-    @Test
-    public void AddAndRemoveExceptionTest() throws UiObjectNotFoundException {
-        addException(site);
-
-        OpenExceptionsFragment();
-
-        onView(allOf(withText(site), withId(R.id.domainView)))
-                .check(matches(isDisplayed()));
-        mDevice.waitForIdle();
-
-        removeException();
-        mDevice.waitForIdle();
-
-        // Should be in main menu
-        onView(withText("Privacy & Security"))
-                .check(matches(isDisplayed()));
-
-        /* change locale to non-english in the setting, verify the locale is changed */
-        UiScrollable appViews = new UiScrollable(new UiSelector().scrollable(true));
-        appViews.scrollIntoView(exceptionsTitle);
-
-        onView(withText("Exceptions"))
-                .check(matches(isDisplayed()))
-                .check(matches(not(isEnabled())));
-    }
-
-    private void addException(String url) {
-        // Load site
-        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime);
-        onView(withId(R.id.urlView))
-                .check(matches(isDisplayed()))
-                .check(matches(hasFocus()))
-                .perform(typeText(url), pressImeActionButton());
-
-        TestHelper.waitForWebContent();
-        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime);
-
-        // The blocking badge is not disabled
-        onView(withId(R.id.block))
-                .check(matches(not(isDisplayed())));
-
-        // Open the menu
-        onView(withId(R.id.menuView))
-                .perform(click());
-        onView(withId(R.id.trackers_count))
-                .check(matches(not(withText("-"))));
-
-        // Disable blocking
-        onView(withId(R.id.blocking_switch))
-                .check(matches(isChecked()));
-
-        onView(withId(R.id.blocking_switch))
-                .perform(click());
-        TestHelper.waitForWebContent();
-    }
-
-    private void removeException() {
-        mDevice.waitForIdle();
-        openActionBarOverflowOrOptionsMenu(InstrumentationRegistry.getContext());
-        mDevice.waitForIdle();   // wait until dialog fully appears
-        onView(withText("Remove"))
-                .perform(click());
-        onView(withId(R.id.checkbox))
-                .perform((click()));
-        onView(withId(R.id.remove))
-                .perform((click()));
-    }
-
-    @Test
-    public void removeAllExceptionsTest() throws UiObjectNotFoundException {
-        addException(site);
-
-        OpenExceptionsFragment();
-
-        mDevice.waitForIdle();
-        onView(withId(R.id.removeAllExceptions))
-                .perform(click());
-
-        mDevice.waitForIdle();
-
-        // Should be in main menu
-        onView(withText("Privacy & Security"))
-                .check(matches(isDisplayed()));
-
-        /* change locale to non-english in the setting, verify the locale is changed */
-        UiScrollable appViews = new UiScrollable(new UiSelector().scrollable(true));
-        appViews.scrollIntoView(exceptionsTitle);
-
-        onView(withText("Exceptions"))
-                .check(matches(isDisplayed()))
-                .check(matches(not(isEnabled())));
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.kt
new file mode 100644
index 000000000000..3877a429bf9e
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLExceptionTest.kt
@@ -0,0 +1,153 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiScrollable
+import androidx.test.uiautomator.UiSelector
+import org.hamcrest.Matchers
+import org.hamcrest.core.AllOf
+import org.junit.After
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.EspressoHelper.openSettings
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.mDevice
+import org.mozilla.focus.helpers.TestHelper.waitForWebContent
+
+// https://testrail.stage.mozaws.net/index.php?/cases/view/104577
+@RunWith(AndroidJUnit4ClassRunner::class)
+class URLExceptionTest {
+    private val site = "680news.com"
+    private val exceptionsTitle = TestHelper.mDevice.findObject(
+        UiSelector()
+            .text("Exceptions")
+            .resourceId("android:id/title")
+    )
+
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Throws(UiObjectNotFoundException::class)
+    private fun OpenExceptionsFragment() {
+        mDevice.waitForIdle()
+        openSettings()
+        Espresso.onView(ViewMatchers.withText("Privacy & Security"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+
+        /* change locale to non-english in the setting, verify the locale is changed */
+        val appViews = UiScrollable(UiSelector().scrollable(true))
+        appViews.scrollIntoView(exceptionsTitle)
+        if (exceptionsTitle.isEnabled) {
+            exceptionsTitle.click()
+        }
+        mDevice.waitForIdle()
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun AddAndRemoveExceptionTest() {
+        addException(site)
+        OpenExceptionsFragment()
+        Espresso.onView(
+            AllOf.allOf(
+                ViewMatchers.withText(site),
+                ViewMatchers.withId(R.id.domainView)
+            )
+        )
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        mDevice.waitForIdle()
+        removeException()
+        mDevice.waitForIdle()
+
+        // Should be in main menu
+        Espresso.onView(ViewMatchers.withText("Privacy & Security"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        /* change locale to non-english in the setting, verify the locale is changed */
+        val appViews = UiScrollable(UiSelector().scrollable(true))
+        appViews.scrollIntoView(exceptionsTitle)
+        Espresso.onView(ViewMatchers.withText("Exceptions"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isEnabled())))
+    }
+
+    private fun addException(url: String) {
+        // Load site
+        TestHelper.inlineAutocompleteEditText.waitForExists(TestHelper.waitingTime)
+        Espresso.onView(ViewMatchers.withId(R.id.urlView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.hasFocus()))
+            .perform(ViewActions.typeText(url), ViewActions.pressImeActionButton())
+        waitForWebContent()
+        TestHelper.progressBar.waitUntilGone(TestHelper.waitingTime)
+
+        // The blocking badge is not disabled
+        Espresso.onView(ViewMatchers.withId(R.id.block))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isDisplayed())))
+
+        // Open the menu
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.trackers_count))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.withText("-"))))
+
+        // Disable blocking
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .check(ViewAssertions.matches(ViewMatchers.isChecked()))
+        Espresso.onView(ViewMatchers.withId(R.id.blocking_switch))
+            .perform(ViewActions.click())
+        waitForWebContent()
+    }
+
+    private fun removeException() {
+        mDevice.waitForIdle()
+        Espresso.openActionBarOverflowOrOptionsMenu(InstrumentationRegistry.getInstrumentation().getContext())
+        mDevice.waitForIdle() // wait until dialog fully appears
+        Espresso.onView(ViewMatchers.withText("Remove"))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.checkbox))
+            .perform(ViewActions.click())
+        Espresso.onView(ViewMatchers.withId(R.id.remove))
+            .perform(ViewActions.click())
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun removeAllExceptionsTest() {
+        addException(site)
+        OpenExceptionsFragment()
+        mDevice.waitForIdle()
+        Espresso.onView(ViewMatchers.withId(R.id.removeAllExceptions))
+            .perform(ViewActions.click())
+        mDevice.waitForIdle()
+
+        // Should be in main menu
+        Espresso.onView(ViewMatchers.withText("Privacy & Security"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        /* change locale to non-english in the setting, verify the locale is changed */
+        val appViews = UiScrollable(UiSelector().scrollable(true))
+        appViews.scrollIntoView(exceptionsTitle)
+        Espresso.onView(ViewMatchers.withText("Exceptions"))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(Matchers.not(ViewMatchers.isEnabled())))
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java
deleted file mode 100644
index 0582cd7e99ad..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.java
+++ /dev/null
@@ -1,127 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.activity;
-
-import android.content.Context;
-
-import androidx.preference.PreferenceManager;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.rule.ActivityTestRule;
-import androidx.test.runner.AndroidJUnit4;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-
-import org.junit.After;
-import org.junit.Rule;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.mozilla.focus.R;
-import org.mozilla.focus.helpers.TestHelper;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.action.ViewActions.pressImeActionButton;
-import static androidx.test.espresso.action.ViewActions.replaceText;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.isDescendantOfA;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static android.view.KeyEvent.KEYCODE_SPACE;
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.Matchers.allOf;
-import static org.hamcrest.Matchers.containsString;
-import static org.mozilla.focus.fragment.FirstrunFragment.FIRSTRUN_PREF;
-import static org.mozilla.focus.helpers.EspressoHelper.childAtPosition;
-import static org.mozilla.focus.helpers.TestHelper.waitingTime;
-import static org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime;
-
-// This test checks whether URL and displayed site are in sync
-@RunWith(AndroidJUnit4.class)
-public class URLMismatchTest {
-
-    @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule = new ActivityTestRule<MainActivity>(MainActivity.class) {
-        @Override
-        protected void beforeActivityLaunched() {
-            super.beforeActivityLaunched();
-
-            final Context appContext = InstrumentationRegistry.getInstrumentation()
-                    .getTargetContext()
-                    .getApplicationContext();
-
-            PreferenceManager.getDefaultSharedPreferences(appContext)
-                    .edit()
-                    .putBoolean(FIRSTRUN_PREF, true)
-                    .apply();
-
-            // This test runs on both GV and WV.
-            // Klar is used to test Geckoview. make sure it's set to Gecko
-            TestHelper.selectGeckoForKlar();
-        }
-    };
-
-    @After
-    public void tearDown() {
-        mActivityTestRule.getActivity().finishAndRemoveTask();
-    }
-
-    @Test
-    public void MismatchTest() throws UiObjectNotFoundException {
-        String searchString = String.format("mozilla focus - %s Search", "google");
-        UiObject googleWebView = TestHelper.mDevice.findObject(new UiSelector()
-                .description(searchString)
-                .className("android.webkit.WebView"));
-
-        // Do search on text string
-        TestHelper.inlineAutocompleteEditText.clearTextField();
-        TestHelper.inlineAutocompleteEditText.setText("mozilla ");
-        // Would you like to turn on search suggestions? Yes No
-        // fresh install only)
-        if (TestHelper.searchSuggestionsTitle.exists()) {
-            TestHelper.searchSuggestionsButtonYes.waitForExists(waitingTime);
-            TestHelper.searchSuggestionsButtonYes.click();
-        }
-
-        // Verify that at least 1 search hint is displayed and click it.
-        TestHelper.mDevice.pressKeyCode(KEYCODE_SPACE);
-        TestHelper.suggestionList.waitForExists(waitingTime);
-        assertTrue(TestHelper.suggestionList.getChildCount() >= 1);
-
-        onView(allOf(withText(containsString("mozilla")),
-                withId(R.id.suggestion),
-                isDescendantOfA(childAtPosition(withId(R.id.suggestionList), 1))))
-                .check(matches(isDisplayed()));
-
-        // WebView is displayed
-        TestHelper.pressEnterKey();
-        googleWebView.waitForExists(waitingTime);
-        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime);
-
-        // The displayed URL contains mozilla. Click on it to edit it again.
-        onView(withId(R.id.display_url))
-                .check(matches(isDisplayed()))
-                .check(matches(withText(containsString("mozilla"))))
-                .perform(click());
-
-        // Type "moz" - Verify that it auto-completes to "mozilla.org" and then load the website
-        onView(withId(R.id.urlView))
-                .perform(click(), replaceText("mozilla"))
-                .check(matches(withText("mozilla.org")))
-                .perform(pressImeActionButton());
-
-        // Wait until site is loaded
-        onView(withId(R.id.webview))
-                .check(matches(isDisplayed()));
-        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime);
-
-        // The displayed URL contains www.mozilla.org
-        onView(withId(R.id.display_url))
-                .check(matches(isDisplayed()))
-                .check(matches(withText(containsString("www.mozilla.org"))));
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.kt
new file mode 100644
index 000000000000..c5a17c5b3e57
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/activity/URLMismatchTest.kt
@@ -0,0 +1,105 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.activity
+
+import android.view.KeyEvent
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import org.hamcrest.Matchers
+import org.junit.After
+import org.junit.Assert
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mozilla.focus.R
+import org.mozilla.focus.helpers.EspressoHelper.childAtPosition
+import org.mozilla.focus.helpers.MainActivityFirstrunTestRule
+import org.mozilla.focus.helpers.TestHelper
+import org.mozilla.focus.helpers.TestHelper.pressEnterKey
+import org.mozilla.focus.helpers.TestHelper.waitingTime
+import org.mozilla.focus.helpers.TestHelper.webPageLoadwaitingTime
+
+// This test checks whether URL and displayed site are in sync
+@RunWith(AndroidJUnit4ClassRunner::class)
+class URLMismatchTest {
+    @get: Rule
+    var mActivityTestRule = MainActivityFirstrunTestRule(showFirstRun = false)
+
+    @After
+    fun tearDown() {
+        mActivityTestRule.activity.finishAndRemoveTask()
+    }
+
+    @Test
+    @Throws(UiObjectNotFoundException::class)
+    fun MismatchTest() {
+        val searchString = String.format("mozilla focus - %s Search", "google")
+        val googleWebView = TestHelper.mDevice.findObject(
+            UiSelector()
+                .description(searchString)
+                .className("android.webkit.WebView")
+        )
+
+        // Do search on text string
+        TestHelper.inlineAutocompleteEditText.clearTextField()
+        TestHelper.inlineAutocompleteEditText.text = "mozilla "
+        // Would you like to turn on search suggestions? Yes No
+        // fresh install only)
+        if (TestHelper.searchSuggestionsTitle.exists()) {
+            TestHelper.searchSuggestionsButtonYes.waitForExists(waitingTime)
+            TestHelper.searchSuggestionsButtonYes.click()
+        }
+
+        // Verify that at least 1 search hint is displayed and click it.
+        TestHelper.mDevice.pressKeyCode(KeyEvent.KEYCODE_SPACE)
+        TestHelper.suggestionList.waitForExists(waitingTime)
+        Assert.assertTrue(TestHelper.suggestionList.childCount >= 1)
+        Espresso.onView(
+            Matchers.allOf(
+                ViewMatchers.withText(Matchers.containsString("mozilla")),
+                ViewMatchers.withId(R.id.suggestion),
+                ViewMatchers.isDescendantOfA(
+                    childAtPosition(
+                        ViewMatchers.withId(R.id.suggestionList),
+                        1
+                    )
+                )
+            )
+        )
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+
+        // WebView is displayed
+        pressEnterKey()
+        googleWebView.waitForExists(waitingTime)
+        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime)
+
+        // The displayed URL contains mozilla. Click on it to edit it again.
+        Espresso.onView(ViewMatchers.withId(R.id.display_url))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.withText(Matchers.containsString("mozilla"))))
+            .perform(ViewActions.click())
+
+        // Type "moz" - Verify that it auto-completes to "mozilla.org" and then load the website
+        Espresso.onView(ViewMatchers.withId(R.id.urlView))
+            .perform(ViewActions.click(), ViewActions.replaceText("mozilla"))
+            .check(ViewAssertions.matches(ViewMatchers.withText("mozilla.org")))
+            .perform(ViewActions.pressImeActionButton())
+
+        // Wait until site is loaded
+        Espresso.onView(ViewMatchers.withId(R.id.webview))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+        TestHelper.progressBar.waitUntilGone(webPageLoadwaitingTime)
+
+        // The displayed URL contains www.mozilla.org
+        Espresso.onView(ViewMatchers.withId(R.id.display_url))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.withText(Matchers.containsString("www.mozilla.org"))))
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.java
deleted file mode 100644
index de692ede399e..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.java
+++ /dev/null
@@ -1,98 +0,0 @@
-/* This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.helpers;
-
-import androidx.annotation.NonNull;
-import androidx.annotation.StringRes;
-import androidx.test.espresso.ViewInteraction;
-import android.view.View;
-import android.view.ViewGroup;
-import android.view.ViewParent;
-
-import org.hamcrest.Description;
-import org.hamcrest.Matcher;
-import org.hamcrest.TypeSafeMatcher;
-import org.mozilla.focus.R;
-
-import okhttp3.mockwebserver.MockWebServer;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.action.ViewActions.click;
-import static androidx.test.espresso.action.ViewActions.pressImeActionButton;
-import static androidx.test.espresso.action.ViewActions.replaceText;
-import static androidx.test.espresso.assertion.ViewAssertions.matches;
-import static androidx.test.espresso.matcher.ViewMatchers.hasFocus;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withClassName;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withParent;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static org.hamcrest.Matchers.allOf;
-import static org.hamcrest.Matchers.endsWith;
-
-/**
- * Some convenient methods for testing Focus with espresso.
- */
-public class EspressoHelper {
-    public static void openSettings() {
-        openMenu();
-
-        onView(withId(R.id.settings))
-                .check(matches(isDisplayed()))
-                .perform(click());
-
-        assertToolbarMatchesText(R.string.menu_settings);
-    }
-
-    public static void openMenu() {
-        onView(withId(R.id.menuView))
-                .check(matches(isDisplayed()))
-                .perform(click());
-    }
-
-    public static void navigateToWebsite(@NonNull String input) {
-        onView(withId(R.id.urlView))
-                .check(matches(isDisplayed()))
-                .check(matches(hasFocus()))
-                .perform(replaceText(input), pressImeActionButton());
-    }
-
-    public static void assertToolbarMatchesText(@StringRes int titleResource) {
-        onView(allOf(withClassName(endsWith("TextView")), withParent(withId(R.id.toolbar))))
-                .check(matches(isDisplayed()))
-                .check(matches(withText(titleResource)));
-    }
-
-    public static void navigateToMockWebServer(@NonNull MockWebServer webServer, String path) {
-        navigateToWebsite(webServer.url(path).toString());
-    }
-
-    public static ViewInteraction onFloatingEraseButton() {
-        return onView(withId(R.id.erase));
-    }
-
-    public static ViewInteraction onFloatingTabsButton() {
-        return onView(withId(R.id.tabs));
-    }
-
-    public static Matcher<View> childAtPosition(
-            final Matcher<View> parentMatcher, final int position) {
-
-        return new TypeSafeMatcher<View>() {
-            @Override
-            public void describeTo(Description description) {
-                description.appendText("Child at position " + position + " in parent ");
-                parentMatcher.describeTo(description);
-            }
-
-            @Override
-            public boolean matchesSafely(View view) {
-                ViewParent parent = view.getParent();
-                return parent instanceof ViewGroup && parentMatcher.matches(parent)
-                        && view.equals(((ViewGroup) parent).getChildAt(position));
-            }
-        };
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.kt
new file mode 100644
index 000000000000..1487bf6b279c
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/EspressoHelper.kt
@@ -0,0 +1,93 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.helpers
+
+import android.view.View
+import android.view.ViewGroup
+import androidx.annotation.StringRes
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.ViewInteraction
+import androidx.test.espresso.action.ViewActions
+import androidx.test.espresso.assertion.ViewAssertions
+import androidx.test.espresso.matcher.ViewMatchers
+import okhttp3.mockwebserver.MockWebServer
+import org.hamcrest.Description
+import org.hamcrest.Matcher
+import org.hamcrest.Matchers
+import org.hamcrest.TypeSafeMatcher
+import org.mozilla.focus.R
+
+/**
+ * Some convenient methods for testing Focus with espresso.
+ */
+object EspressoHelper {
+    @JvmStatic
+    fun openSettings() {
+        openMenu()
+        Espresso.onView(ViewMatchers.withId(R.id.settings))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+        assertToolbarMatchesText(R.string.menu_settings)
+    }
+
+    @JvmStatic
+    fun openMenu() {
+        Espresso.onView(ViewMatchers.withId(R.id.menuView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .perform(ViewActions.click())
+    }
+
+    fun navigateToWebsite(input: String) {
+        Espresso.onView(ViewMatchers.withId(R.id.urlView))
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.hasFocus()))
+            .perform(ViewActions.replaceText(input), ViewActions.pressImeActionButton())
+    }
+
+    @JvmStatic
+    fun assertToolbarMatchesText(@StringRes titleResource: Int) {
+        Espresso.onView(
+            Matchers.allOf(
+                ViewMatchers.withClassName(Matchers.endsWith("TextView")),
+                ViewMatchers.withParent(ViewMatchers.withId(R.id.toolbar))
+            )
+        )
+            .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
+            .check(ViewAssertions.matches(ViewMatchers.withText(titleResource)))
+    }
+
+    @JvmStatic
+    fun navigateToMockWebServer(webServer: MockWebServer, path: String?) {
+        navigateToWebsite(webServer.url(path).toString())
+    }
+
+    @JvmStatic
+    fun onFloatingEraseButton(): ViewInteraction {
+        return Espresso.onView(ViewMatchers.withId(R.id.erase))
+    }
+
+    @JvmStatic
+    fun onFloatingTabsButton(): ViewInteraction {
+        return Espresso.onView(ViewMatchers.withId(R.id.tabs))
+    }
+
+    @JvmStatic
+    fun childAtPosition(
+        parentMatcher: Matcher<View?>,
+        position: Int
+    ): Matcher<View> {
+        return object : TypeSafeMatcher<View>() {
+            override fun describeTo(description: Description) {
+                description.appendText("Child at position $position in parent ")
+                parentMatcher.describeTo(description)
+            }
+
+            public override fun matchesSafely(view: View): Boolean {
+                val parent = view.parent
+                return (parent is ViewGroup && parentMatcher.matches(parent) &&
+                        view == parent.getChildAt(position))
+            }
+        }
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.kt
index c3bcdef3a956..28ff3bac6611 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.kt
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/MainActivityFirstrunTestRule.kt
@@ -13,8 +13,8 @@ import org.mozilla.focus.activity.MainActivity
 import org.mozilla.focus.ext.components
 import org.mozilla.focus.fragment.FirstrunFragment.Companion.FIRSTRUN_PREF
 
-open class MainActivityFirstrunTestRule(private val showFirstRun: Boolean) :
-    ActivityTestRule<MainActivity>(MainActivity::class.java) {
+open class MainActivityFirstrunTestRule(launchActivity: Boolean = true, private val showFirstRun: Boolean) :
+    ActivityTestRule<MainActivity>(MainActivity::class.java, launchActivity) {
 
     @CallSuper
     override fun beforeActivityLaunched() {
@@ -33,8 +33,6 @@ open class MainActivityFirstrunTestRule(private val showFirstRun: Boolean) :
     override fun afterActivityFinished() {
         super.afterActivityFinished()
 
-        activity.finishAndRemoveTask()
-
         ThreadUtils.postToMainThread {
             InstrumentationRegistry
                 .getInstrumentation()
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.java
deleted file mode 100644
index 41f2a371d640..000000000000
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.java
+++ /dev/null
@@ -1,349 +0,0 @@
-/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
- * This Source Code Form is subject to the terms of the Mozilla Public
- * License, v. 2.0. If a copy of the MPL was not distributed with this
- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
-package org.mozilla.focus.helpers;
-
-import android.content.Context;
-import android.content.res.Resources;
-import androidx.annotation.NonNull;
-import androidx.test.InstrumentationRegistry;
-import androidx.test.espresso.ViewInteraction;
-import androidx.test.uiautomator.UiDevice;
-import androidx.test.uiautomator.UiObject;
-import androidx.test.uiautomator.UiObjectNotFoundException;
-import androidx.test.uiautomator.UiSelector;
-import android.text.format.DateUtils;
-import android.util.DisplayMetrics;
-
-import org.mozilla.focus.R;
-import org.mozilla.focus.utils.AppConstants;
-
-import java.io.BufferedReader;
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.IOException;
-import java.io.InputStream;
-import java.io.InputStreamReader;
-import java.nio.charset.StandardCharsets;
-
-import okhttp3.mockwebserver.MockResponse;
-import okio.Buffer;
-import okio.Okio;
-
-import static androidx.test.espresso.Espresso.onView;
-import static androidx.test.espresso.matcher.ViewMatchers.isDisplayed;
-import static androidx.test.espresso.matcher.ViewMatchers.withId;
-import static androidx.test.espresso.matcher.ViewMatchers.withText;
-import static androidx.test.espresso.web.sugar.Web.onWebView;
-import static android.view.KeyEvent.KEYCODE_ENTER;
-import static junit.framework.Assert.assertTrue;
-import static org.hamcrest.Matchers.allOf;
-
-// This test visits each page and checks whether some essential elements are being displayed
-public final class TestHelper {
-
-    public static UiDevice mDevice =  UiDevice.getInstance(InstrumentationRegistry.getInstrumentation());
-    public static final long waitingTime = DateUtils.SECOND_IN_MILLIS * 4;
-    public static final long webPageLoadwaitingTime = DateUtils.SECOND_IN_MILLIS * 15;
-
-    public static String getAppName() {
-        return InstrumentationRegistry.getInstrumentation()
-                .getTargetContext().getPackageName();
-    }
-
-    // wait for web area to be visible
-    public static void waitForWebContent() {
-        assertTrue(geckoView.waitForExists(waitingTime));
-    }
-
-    /********* First View Locators ***********/
-    public static UiObject firstSlide = mDevice.findObject(new UiSelector()
-            .text("Power up your privacy")
-            .enabled(true));
-    public static UiObject secondSlide = mDevice.findObject(new UiSelector()
-            .text("Your search, your way")
-            .enabled(true));
-    public static UiObject thirdSlide = mDevice.findObject(new UiSelector()
-            .text("Add shortcuts to your home screen")
-            .enabled(true));
-    public static UiObject lastSlide = mDevice.findObject(new UiSelector()
-            .text("Make privacy a habit")
-            .enabled(true));
-    public static UiObject nextBtn = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/next")
-            .enabled(true));
-    public static UiObject finishBtn = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/finish")
-            .enabled(true));
-    public static UiObject initialView = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/backgroundView")
-            .enabled(true));
-
-    /********* Main View Locators ***********/
-    public static ViewInteraction menuButton = onView(
-            allOf(withId(R.id.menuView),
-                    isDisplayed()));
-
-    /********* Web View Locators ***********/
-    public static UiObject browserURLbar = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/display_url")
-            .clickable(true));
-    public static UiObject permAllowBtn = mDevice.findObject(new UiSelector()
-            .resourceId("com.android.packageinstaller:id/permission_allow_button")
-            .clickable(true));
-    public static UiObject inlineAutocompleteEditText = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/urlView")
-            .focused(true)
-            .enabled(true));
-    public static UiObject searchSuggestionsTitle = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/enable_search_suggestions_title")
-            .enabled(true));
-    public static UiObject searchSuggestionsButtonYes = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/enable_search_suggestions_button")
-            .enabled(true));
-    public static UiObject cleartextField = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/clearView")
-            .enabled(true));
-    public static UiObject hint = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/searchView")
-            .clickable(true));
-    public static UiObject suggestionList = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/suggestionList"));
-    public static UiObject suggestion = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/suggestion"));
-    public static UiObject webView = mDevice.findObject(new UiSelector()
-            .className("android.webkit.WebView")
-            .enabled(true));
-    public static UiObject geckoView = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/webview")
-            .enabled(true));
-    public static UiObject progressBar = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/progress")
-            .enabled(true));
-    public static UiObject tryAgainBtn = mDevice.findObject(new UiSelector()
-            .resourceId("errorTryAgain")
-            .clickable(true));
-    public static ViewInteraction floatingEraseButton = onView(
-            allOf(withId(R.id.erase), isDisplayed()));
-    public static UiObject browserViewSettingsMenuItem = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/settings")
-            .clickable(true));
-    public static UiObject erasedMsg = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Your browsing history has been erased.")
-            .resourceId(getAppName() + ":id/snackbar_text")
-            .enabled(true));
-    public static UiObject lockIcon = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/lock")
-            .description("Secure connection"));
-    public static UiObject notificationBarDeleteItem = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Erase browsing history")
-            .resourceId("android:id/text")
-            .enabled(true));
-    public static UiObject notificationExpandSwitch = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("android:id/expand_button")
-            .packageName(getAppName() + "")
-            .enabled(true));
-    public static UiObject notificationOpenItem = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("android:id/action0")
-            .description("Open")
-            .enabled(true));
-    public static UiObject notificationEraseOpenItem = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("android:id/action0")
-            .description("Erase and Open")
-            .enabled(true));
-    public static UiObject blockOffIcon = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/block")
-            .enabled(true));
-    public static UiObject AddtoHSmenuItem = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/add_to_homescreen")
-            .enabled(true));
-    public static UiObject AddtoHSCancelBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/addtohomescreen_dialog_cancel")
-            .enabled(true));
-    public static UiObject AddtoHSOKBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/addtohomescreen_dialog_add")
-            .enabled(true));
-    public static UiObject AddautoBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .className("android.widget.Button")
-            .instance(1)
-            .enabled(true));
-    public static UiObject shortcutTitle = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/edit_title")
-            .enabled(true));
-    public static UiObject savedNotification = TestHelper.mDevice.findObject(new UiSelector()
-            .text("Download complete.")
-            .resourceId("android:id/text")
-            .enabled(true));
-
-    public static UiObject securityInfoIcon = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/security_info")
-            .enabled(true));
-    public static UiObject identityState = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/site_identity_state")
-            .enabled(true));
-
-    public static UiObject downloadTitle = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/title_template")
-            .enabled(true));
-    public static UiObject downloadFileName = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/download_dialog_file_name")
-            .enabled(true));
-    public static UiObject downloadWarning = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/download_dialog_warning")
-            .enabled(true));
-    public static UiObject downloadCancelBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/download_dialog_cancel")
-            .enabled(true));
-    public static UiObject downloadBtn = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/download_dialog_download")
-            .enabled(true));
-    public static UiObject completedMsg = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId(TestHelper.getAppName() + ":id/snackbar_text")
-            .enabled(true));
-
-    /********* Main View Menu Item Locators ***********/
-    public static UiObject whatsNewItem = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/whats_new")
-            .enabled(true));
-    public static UiObject HelpItem = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/help")
-            .enabled(true));
-    public static UiObject settingsMenuItem = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/settings")
-            .enabled(true));
-    public static UiObject blockCounterItem = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/trackers_count"));
-    public static UiObject menulist = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/list")
-            .enabled(true));
-    public static String getMenuItemText(UiObject item) throws UiObjectNotFoundException {
-        return item.getChild(new UiSelector().index(0))
-                .getChild(new UiSelector().index(0)).getText();
-    }
-
-    /********** Share Menu Dialog ********************/
-    public static UiObject shareMenuHeader = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("android:id/title")
-            .text("Share via")
-            .enabled(true));
-    public static UiObject shareAppList = TestHelper.mDevice.findObject(new UiSelector()
-            .resourceId("android:id/resolver_list")
-            .enabled(true));
-
-    /********* Settings Menu Item Locators ***********/
-    public static UiObject settingsMenu = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/recycler_view"));
-    public static UiObject settingsHeading = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/toolbar")
-            .enabled(true));
-    public static UiObject navigateUp = mDevice.findObject(new UiSelector()
-            .description("Navigate up"));
-    public static UiObject toggleAnalyticBlock = mDevice.findObject(new UiSelector()
-            .className("android.widget.Switch")
-            .instance(1));
-    public static UiObject refreshBtn = mDevice.findObject(new UiSelector()
-            .resourceId(getAppName() + ":id/refresh")
-            .enabled(true));
-
-    public static void expandNotification() throws UiObjectNotFoundException {
-        if (!notificationOpenItem.waitForExists(waitingTime)) {
-            if (!notificationExpandSwitch.exists()) {
-                notificationBarDeleteItem.pinchOut(50, 5);
-            } else {
-                notificationExpandSwitch.click();
-            }
-            assertTrue(notificationOpenItem.exists());
-        }
-    }
-
-    public static final int X_OFFSET = 20;
-    public static final int Y_OFFSET = 500;
-    public static final int STEPS = 10;
-
-    private static DisplayMetrics devicePixels() {
-        DisplayMetrics metrics = Resources.getSystem().getDisplayMetrics();
-        return metrics;
-    }
-
-    public static void swipeScreenLeft() {
-        DisplayMetrics metrics = devicePixels();
-        mDevice.swipe(metrics.widthPixels - X_OFFSET, Y_OFFSET, 0, Y_OFFSET, STEPS);
-    }
-
-    public static void swipeScreenRight() {
-        DisplayMetrics metrics = devicePixels();
-        mDevice.swipe(X_OFFSET, Y_OFFSET, metrics.widthPixels, Y_OFFSET, STEPS);
-    }
-
-    public static void waitForIdle() {
-        mDevice.waitForIdle(waitingTime);
-    }
-    public static void pressEnterKey() {
-        mDevice.pressKeyCode(KEYCODE_ENTER);
-    }
-    public static void pressBackKey() {
-        mDevice.pressBack();
-    }
-    public static void pressHomeKey() {
-        mDevice.pressHome();
-    }
-    public static void openNotification() {
-        mDevice.openNotification();
-    }
-
-    public static MockResponse createMockResponseFromAsset(@NonNull String fileName) throws IOException {
-        return new MockResponse()
-                .setBody(TestHelper.readTestAsset(fileName));
-    }
-
-    public static Buffer readTestAsset(String filename) throws IOException {
-        try (final InputStream stream = InstrumentationRegistry.getContext().getAssets().open(filename)) {
-            return readStreamFile(stream);
-        }
-    }
-
-    public static Buffer readStreamFile(InputStream file) throws IOException {
-
-        Buffer buffer = new Buffer();
-        buffer.writeAll(Okio.source(file));
-        return buffer;
-    }
-
-    public static  String readFileToString(File file) throws IOException {
-        System.out.println("Reading file: " + file.getAbsolutePath());
-
-        try (final FileInputStream stream = new FileInputStream(file)) {
-            return readStreamIntoString(stream);
-        }
-    }
-
-    public static  String readStreamIntoString(InputStream stream) throws IOException {
-        try (final BufferedReader reader = new BufferedReader(
-                new InputStreamReader(stream, StandardCharsets.UTF_8))) {
-
-            final StringBuilder builder = new StringBuilder();
-            String line;
-
-            while ((line = reader.readLine()) != null) {
-                builder.append(line);
-            }
-            reader.close();
-
-            return builder.toString();
-        }
-    }
-
-    public static void waitForWebSiteTitleLoad() {
-        onWebView(withText("focus test page"));
-    }
-
-    public static void selectGeckoForKlar() {
-        InstrumentationRegistry.getTargetContext().getSharedPreferences("mozilla.components.service.fretboard.overrides",
-                Context.MODE_PRIVATE)
-                .edit()
-                .putBoolean("use-gecko", AppConstants.INSTANCE.isKlarBuild())
-                .commit();
-    }
-}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.kt b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.kt
new file mode 100644
index 000000000000..c63793594692
--- /dev/null
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/helpers/TestHelper.kt
@@ -0,0 +1,559 @@
+/* -*- Mode: Java; c-basic-offset: 4; tab-width: 20; indent-tabs-mode: nil; -*-
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+package org.mozilla.focus.helpers
+
+import android.content.Context
+import android.content.res.Resources
+import android.text.format.DateUtils
+import android.util.DisplayMetrics
+import android.view.KeyEvent
+import androidx.test.espresso.Espresso
+import androidx.test.espresso.matcher.ViewMatchers
+import androidx.test.espresso.web.sugar.Web
+import androidx.test.platform.app.InstrumentationRegistry
+import androidx.test.uiautomator.UiDevice
+import androidx.test.uiautomator.UiObject
+import androidx.test.uiautomator.UiObjectNotFoundException
+import androidx.test.uiautomator.UiSelector
+import okhttp3.mockwebserver.MockResponse
+import okio.Buffer
+import okio.Okio
+import org.hamcrest.Matchers
+import org.junit.Assert
+import org.mozilla.focus.R
+import org.mozilla.focus.utils.AppConstants.isKlarBuild
+import java.io.BufferedReader
+import java.io.File
+import java.io.FileInputStream
+import java.io.IOException
+import java.io.InputStream
+import java.io.InputStreamReader
+import java.nio.charset.StandardCharsets
+
+@Suppress("TooManyFunctions")
+// This test visits each page and checks whether some essential elements are being displayed
+object TestHelper {
+    @JvmField
+    var mDevice = UiDevice.getInstance(InstrumentationRegistry.getInstrumentation())
+    const val waitingTime = DateUtils.SECOND_IN_MILLIS * 4
+    const val webPageLoadwaitingTime = DateUtils.SECOND_IN_MILLIS * 15
+
+    @JvmStatic
+    val appName: String
+        get() = InstrumentationRegistry.getInstrumentation()
+            .targetContext.packageName
+
+    // wait for web area to be visible
+    @JvmStatic
+    fun waitForWebContent() {
+        Assert.assertTrue(geckoView.waitForExists(waitingTime))
+    }
+
+    /********* First View Locators  */
+    @JvmField
+    var firstSlide = mDevice.findObject(
+        UiSelector()
+            .text("Power up your privacy")
+            .enabled(true)
+    )
+
+    @JvmField
+    var secondSlide = mDevice.findObject(
+        UiSelector()
+            .text("Your search, your way")
+            .enabled(true)
+    )
+
+    @JvmField
+    var thirdSlide = mDevice.findObject(
+        UiSelector()
+            .text("Add shortcuts to your home screen")
+            .enabled(true)
+    )
+
+    @JvmField
+    var lastSlide = mDevice.findObject(
+        UiSelector()
+            .text("Make privacy a habit")
+            .enabled(true)
+    )
+
+    @JvmField
+    var nextBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/next")
+            .enabled(true)
+    )
+
+    @JvmField
+    var finishBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/finish")
+            .enabled(true)
+    )
+
+    @JvmField
+    var initialView = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/backgroundView")
+            .enabled(true)
+    )
+
+    /********* Main View Locators  */
+    @JvmField
+    var menuButton = Espresso.onView(
+        Matchers.allOf(
+            ViewMatchers.withId(R.id.menuView),
+            ViewMatchers.isDisplayed()
+        )
+    )
+
+    /********* Web View Locators  */
+    @JvmField
+    var browserURLbar = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/display_url")
+            .clickable(true)
+    )
+
+    @JvmField
+    var permAllowBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId("com.android.packageinstaller:id/permission_allow_button")
+            .clickable(true)
+    )
+
+    @JvmField
+    var inlineAutocompleteEditText = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/urlView")
+            .focused(true)
+            .enabled(true)
+    )
+
+    @JvmField
+    var searchSuggestionsTitle = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/enable_search_suggestions_title")
+            .enabled(true)
+    )
+
+    @JvmField
+    var searchSuggestionsButtonYes = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/enable_search_suggestions_button")
+            .enabled(true)
+    )
+
+    @JvmField
+    var cleartextField = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/clearView")
+            .enabled(true)
+    )
+
+    @JvmField
+    var hint = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/searchView")
+            .clickable(true)
+    )
+
+    @JvmField
+    var suggestionList = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/suggestionList")
+    )
+    var suggestion = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/suggestion")
+    )
+
+    @JvmField
+    var webView = mDevice.findObject(
+        UiSelector()
+            .className("android.webkit.WebView")
+            .enabled(true)
+    )
+    var geckoView = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/webview")
+            .enabled(true)
+    )
+
+    @JvmField
+    var progressBar = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/progress")
+            .enabled(true)
+    )
+    var tryAgainBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId("errorTryAgain")
+            .clickable(true)
+    )
+
+    @JvmField
+    var floatingEraseButton = Espresso.onView(
+        Matchers.allOf(ViewMatchers.withId(R.id.erase), ViewMatchers.isDisplayed())
+    )
+    var browserViewSettingsMenuItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/settings")
+            .clickable(true)
+    )
+
+    @JvmField
+    var erasedMsg = mDevice.findObject(
+        UiSelector()
+            .text("Your browsing history has been erased.")
+            .resourceId(appName + ":id/snackbar_text")
+            .enabled(true)
+    )
+
+    @JvmField
+    var lockIcon = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/lock")
+            .description("Secure connection")
+    )
+
+    @JvmField
+    var notificationBarDeleteItem = mDevice.findObject(
+        UiSelector()
+            .text("Erase browsing history")
+            .resourceId("android:id/text")
+            .enabled(true)
+    )
+    var notificationExpandSwitch = mDevice.findObject(
+        UiSelector()
+            .resourceId("android:id/expand_button")
+            .packageName(appName + "")
+            .enabled(true)
+    )
+
+    @JvmField
+    var notificationOpenItem = mDevice.findObject(
+        UiSelector()
+            .resourceId("android:id/action0")
+            .description("Open")
+            .enabled(true)
+    )
+
+    @JvmField
+    var notificationEraseOpenItem = mDevice.findObject(
+        UiSelector()
+            .resourceId("android:id/action0")
+            .description("Erase and Open")
+            .enabled(true)
+    )
+    var blockOffIcon = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/block")
+            .enabled(true)
+    )
+
+    @JvmField
+    var AddtoHSmenuItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/add_to_homescreen")
+            .enabled(true)
+    )
+
+    @JvmField
+    var AddtoHSCancelBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/addtohomescreen_dialog_cancel")
+            .enabled(true)
+    )
+
+    @JvmField
+    var AddtoHSOKBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/addtohomescreen_dialog_add")
+            .enabled(true)
+    )
+
+    @JvmField
+    var AddautoBtn = mDevice.findObject(
+        UiSelector()
+            .className("android.widget.Button")
+            .instance(1)
+            .enabled(true)
+    )
+
+    @JvmField
+    var shortcutTitle = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/edit_title")
+            .enabled(true)
+    )
+
+    @JvmField
+    var savedNotification = mDevice.findObject(
+        UiSelector()
+            .text("Download complete.")
+            .resourceId("android:id/text")
+            .enabled(true)
+    )
+
+    @JvmField
+    var securityInfoIcon = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/security_info")
+            .enabled(true)
+    )
+
+    @JvmField
+    var identityState = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/site_identity_state")
+            .enabled(true)
+    )
+
+    @JvmField
+    var downloadTitle = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/title_template")
+            .enabled(true)
+    )
+
+    @JvmField
+    var downloadFileName = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/download_dialog_file_name")
+            .enabled(true)
+    )
+
+    @JvmField
+    var downloadWarning = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/download_dialog_warning")
+            .enabled(true)
+    )
+
+    @JvmField
+    var downloadCancelBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/download_dialog_cancel")
+            .enabled(true)
+    )
+
+    @JvmField
+    var downloadBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/download_dialog_download")
+            .enabled(true)
+    )
+
+    @JvmField
+    var completedMsg = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/snackbar_text")
+            .enabled(true)
+    )
+
+    /********* Main View Menu Item Locators  */
+    var whatsNewItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/whats_new")
+            .enabled(true)
+    )
+
+    @JvmField
+    var HelpItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/help")
+            .enabled(true)
+    )
+
+    @JvmField
+    var settingsMenuItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/settings")
+            .enabled(true)
+    )
+
+    @JvmField
+    var blockCounterItem = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/trackers_count")
+    )
+
+    @JvmField
+    var menulist = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/list")
+            .enabled(true)
+    )
+
+    @Throws(UiObjectNotFoundException::class)
+    fun getMenuItemText(item: UiObject): String {
+        return item.getChild(UiSelector().index(0))
+            .getChild(UiSelector().index(0)).text
+    }
+
+    /********** Share Menu Dialog  */
+    @JvmField
+    var shareMenuHeader = mDevice.findObject(
+        UiSelector()
+            .resourceId("android:id/title")
+            .text("Share via")
+            .enabled(true)
+    )
+
+    @JvmField
+    var shareAppList = mDevice.findObject(
+        UiSelector()
+            .resourceId("android:id/resolver_list")
+            .enabled(true)
+    )
+
+    /********* Settings Menu Item Locators  */
+    @JvmField
+    var settingsMenu = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/recycler_view")
+    )
+
+    @JvmField
+    var settingsHeading = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/toolbar")
+            .enabled(true)
+    )
+    var navigateUp = mDevice.findObject(
+        UiSelector()
+            .description("Navigate up")
+    )
+    var toggleAnalyticBlock = mDevice.findObject(
+        UiSelector()
+            .className("android.widget.Switch")
+            .instance(1)
+    )
+    var refreshBtn = mDevice.findObject(
+        UiSelector()
+            .resourceId(appName + ":id/refresh")
+            .enabled(true)
+    )
+
+    const val PINCH_PERCENT = 50
+    const val PINCH_STEPS = 5
+
+    @JvmStatic
+    @Throws(UiObjectNotFoundException::class)
+    fun expandNotification() {
+        if (!notificationOpenItem.waitForExists(waitingTime)) {
+            if (!notificationExpandSwitch.exists()) {
+                notificationBarDeleteItem.pinchOut(PINCH_PERCENT, PINCH_STEPS)
+            } else {
+                notificationExpandSwitch.click()
+            }
+            Assert.assertTrue(notificationOpenItem.exists())
+        }
+    }
+
+    const val X_OFFSET = 20
+    const val Y_OFFSET = 500
+    const val STEPS = 10
+    private fun devicePixels(): DisplayMetrics {
+        return Resources.getSystem().displayMetrics
+    }
+
+    @JvmStatic
+    fun swipeScreenLeft() {
+        val metrics = devicePixels()
+        mDevice.swipe(metrics.widthPixels - X_OFFSET, Y_OFFSET, 0, Y_OFFSET, STEPS)
+    }
+
+    fun swipeScreenRight() {
+        val metrics = devicePixels()
+        mDevice.swipe(X_OFFSET, Y_OFFSET, metrics.widthPixels, Y_OFFSET, STEPS)
+    }
+
+    @JvmStatic
+    fun waitForIdle() {
+        mDevice.waitForIdle(waitingTime)
+    }
+
+    @JvmStatic
+    fun pressEnterKey() {
+        mDevice.pressKeyCode(KeyEvent.KEYCODE_ENTER)
+    }
+
+    @JvmStatic
+    fun pressBackKey() {
+        mDevice.pressBack()
+    }
+
+    @JvmStatic
+    fun pressHomeKey() {
+        mDevice.pressHome()
+    }
+
+    @JvmStatic
+    fun openNotification() {
+        mDevice.openNotification()
+    }
+
+    @JvmStatic
+    @Throws(IOException::class)
+    fun createMockResponseFromAsset(fileName: String): MockResponse {
+        return MockResponse()
+            .setBody(readTestAsset(fileName))
+    }
+
+    @JvmStatic
+    @Throws(IOException::class)
+    fun readTestAsset(filename: String?): Buffer {
+        InstrumentationRegistry.getInstrumentation().getContext().assets.open(filename!!)
+            .use { stream -> return readStreamFile(stream) }
+    }
+
+    @Throws(IOException::class)
+    fun readStreamFile(file: InputStream?): Buffer {
+        val buffer = Buffer()
+        buffer.writeAll(Okio.source(file!!))
+        return buffer
+    }
+
+    @JvmStatic
+    @Throws(IOException::class)
+    fun readFileToString(file: File): String {
+        println("Reading file: " + file.absolutePath)
+        FileInputStream(file).use { stream -> return readStreamIntoString(stream) }
+    }
+
+    @Throws(IOException::class)
+    fun readStreamIntoString(stream: InputStream?): String {
+        BufferedReader(
+            InputStreamReader(stream, StandardCharsets.UTF_8)
+        ).use { reader ->
+            val builder = StringBuilder()
+            var line: String?
+            while (reader.readLine().also { line = it } != null) {
+                builder.append(line)
+            }
+            reader.close()
+            return builder.toString()
+        }
+    }
+
+    @JvmStatic
+    fun waitForWebSiteTitleLoad() {
+        Web.onWebView(ViewMatchers.withText("focus test page"))
+    }
+
+    @JvmStatic
+    fun selectGeckoForKlar() {
+        InstrumentationRegistry.getInstrumentation().getTargetContext().getSharedPreferences(
+            "mozilla.components.service.fretboard.overrides",
+            Context.MODE_PRIVATE
+        )
+            .edit()
+            .putBoolean("use-gecko", isKlarBuild)
+            .commit()
+    }
+}
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/FirstRunScreenshots.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/FirstRunScreenshots.java
index fff798c02234..fea46483a277 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/FirstRunScreenshots.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/FirstRunScreenshots.java
@@ -34,7 +34,7 @@
 @Ignore("This test was written specifically for WebView and needs to be adapted for GeckoView")
 public class FirstRunScreenshots extends ScreenshotTest {
     @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule = new MainActivityFirstrunTestRule(true) {
+    public ActivityTestRule<MainActivity> mActivityTestRule = new MainActivityFirstrunTestRule(true,true) {
         @Override
         protected void beforeActivityLaunched() {
             super.beforeActivityLaunched();
diff --git a/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/ScreenshotTest.java b/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/ScreenshotTest.java
index e30edb26b23e..4211a223e8e6 100644
--- a/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/ScreenshotTest.java
+++ b/focus-android/app/src/androidTest/java/org/mozilla/focus/screenshots/ScreenshotTest.java
@@ -35,7 +35,7 @@ abstract class ScreenshotTest {
     UiDevice device;
 
     @Rule
-    public ActivityTestRule<MainActivity> mActivityTestRule = new MainActivityFirstrunTestRule(false) {
+    public ActivityTestRule<MainActivity> mActivityTestRule = new MainActivityFirstrunTestRule(true, false) {
         @Override
         protected void beforeActivityLaunched() {
             super.beforeActivityLaunched();
