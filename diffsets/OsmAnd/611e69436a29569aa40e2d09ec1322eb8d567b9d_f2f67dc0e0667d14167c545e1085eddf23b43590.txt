diff --git a/OsmAnd/src/net/osmand/plus/settings/backend/OsmAndPreferencesDataStore.java b/OsmAnd/src/net/osmand/plus/settings/backend/OsmAndPreferencesDataStore.java
index 22e662bbe54..ea02a21395a 100644
--- a/OsmAnd/src/net/osmand/plus/settings/backend/OsmAndPreferencesDataStore.java
+++ b/OsmAnd/src/net/osmand/plus/settings/backend/OsmAndPreferencesDataStore.java
@@ -50,7 +50,8 @@ public void putFloat(String key, float value) {
 
 	@Override
 	public void putBoolean(String key, boolean value) {
-		if (osmandSettings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(key)) {
+		if (osmandSettings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(key) ||
+				osmandSettings.DISABLE_OFFROUTE_RECALC.getId().equals(key)) {
 			osmandSettings.setPreference(key, !value, appMode);
 		} else {
 			osmandSettings.setPreference(key, value, appMode);
@@ -112,9 +113,9 @@ public float getFloat(String key, float defValue) {
 	@Override
 	public boolean getBoolean(String key, boolean defValue) {
 		OsmandPreference<?> preference = osmandSettings.getPreference(key);
-		if (preference instanceof BooleanPreference) {
-			BooleanPreference booleanPreference = (BooleanPreference) preference;
-			if (osmandSettings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(booleanPreference.getId())) {
+		if (preference instanceof BooleanPreference booleanPreference) {
+			if (osmandSettings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(booleanPreference.getId())
+					|| osmandSettings.DISABLE_OFFROUTE_RECALC.getId().equals(booleanPreference.getId())) {
 				return !booleanPreference.getModeValue(appMode);
 			}
 			return booleanPreference.getModeValue(appMode);
diff --git a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/RecalculateRouteInDeviationBottomSheet.java b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/RecalculateRouteInDeviationBottomSheet.java
index 00b208773b1..af987d64ee5 100644
--- a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/RecalculateRouteInDeviationBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/RecalculateRouteInDeviationBottomSheet.java
@@ -1,7 +1,9 @@
 package net.osmand.plus.settings.bottomsheets;
 
+import static net.osmand.plus.settings.fragments.ApplyQueryType.SNACK_BAR;
 import static net.osmand.plus.settings.fragments.RouteParametersFragment.DEFAULT_MODE;
 import static net.osmand.plus.settings.fragments.RouteParametersFragment.DISABLE_MODE;
+import static net.osmand.plus.utils.OsmAndFormatterParams.NO_TRAILING_ZEROS;
 
 import android.content.Context;
 import android.os.Bundle;
@@ -15,7 +17,6 @@
 
 import com.google.android.material.slider.Slider;
 
-import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
 import net.osmand.plus.base.bottomsheetmenu.BottomSheetItemWithCompoundButton;
@@ -25,14 +26,12 @@
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.TitleItem;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
-import net.osmand.plus.settings.backend.preferences.CommonPreference;
-import net.osmand.plus.settings.fragments.ApplyQueryType;
+import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.settings.fragments.OnConfirmPreferenceChange;
 import net.osmand.plus.settings.preferences.SwitchPreferenceEx;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
-import net.osmand.plus.utils.OsmAndFormatterParams;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.shared.settings.enums.MetricsConstants;
 
@@ -42,8 +41,6 @@ public class RecalculateRouteInDeviationBottomSheet extends BooleanPreferenceBot
 
 	private static final String CURRENT_VALUE = "current_value";
 
-	private CommonPreference<Float> preference;
-
 	private Slider slider;
 	private TextView tvSliderTitle;
 	private TextView tvSliderSummary;
@@ -55,13 +52,13 @@ public class RecalculateRouteInDeviationBottomSheet extends BooleanPreferenceBot
 
 	@Override
 	public void createMenuItems(Bundle savedInstanceState) {
-		preference = settings.ROUTE_RECALCULATION_DISTANCE;
 		getPreferenceStateAndValue();
 
 		SwitchPreferenceEx switchPref = (SwitchPreferenceEx) getPreference();
 		if (switchPref == null) {
 			return;
 		}
+		enabled = switchPref.isChecked();
 
 		if (savedInstanceState != null && savedInstanceState.containsKey(CURRENT_VALUE)) {
 			currentValue = savedInstanceState.getFloat(CURRENT_VALUE);
@@ -70,11 +67,11 @@ public void createMenuItems(Bundle savedInstanceState) {
 		int contentPaddingSmall = getDimensionPixelSize(R.dimen.content_padding_small);
 		int contentPadding = getDimensionPixelSize(R.dimen.content_padding);
 
-		MetricsConstants mc = settings.METRIC_SYSTEM.get();
+		MetricsConstants mc = settings.METRIC_SYSTEM.getModeValue(getAppMode());
 		if (mc == MetricsConstants.KILOMETERS_AND_METERS) {
-			entryValues = new Float[]{10.f, 20.0f, 30.0f, 50.0f, 100.0f, 200.0f, 500.0f, 1000.0f, 1500.0f};
+			entryValues = new Float[] {10.f, 20.0f, 30.0f, 50.0f, 100.0f, 200.0f, 500.0f, 1000.0f, 1500.0f};
 		} else {
-			entryValues = new Float[]{9.1f, 18.3f, 30.5f, 45.7f, 91.5f, 183.0f, 482.0f, 965.0f, 1609.0f};
+			entryValues = new Float[] {9.1f, 18.3f, 30.5f, 45.7f, 91.5f, 183.0f, 482.0f, 965.0f, 1609.0f};
 		}
 
 		int appModeColor = appMode.getProfileColor(nightMode);
@@ -107,17 +104,18 @@ public void createMenuItems(Bundle savedInstanceState) {
 				.setOnClickListener(v -> {
 					enabled = !enabled;
 					sliderPositionChanged = false;
+
 					switchPref.setChecked(enabled);
 					preferenceBtn[0].setTitle(enabled ? on : off);
 					preferenceBtn[0].setTitleColorId(enabled ? activeColor : disabledColor);
 					preferenceBtn[0].setChecked(enabled);
-					getDefaultValue();
+
 					updateSliderView();
 					updateCustomButtonView(context, getAppMode(), v, enabled, nightMode);
+
 					Fragment target = getTargetFragment();
-					float newValue = enabled ? DEFAULT_MODE : DISABLE_MODE;
-					if (target instanceof OnConfirmPreferenceChange) {
-						((OnConfirmPreferenceChange) target).onConfirmPreferenceChange(switchPref.getKey(), newValue, ApplyQueryType.NONE);
+					if (target instanceof BaseSettingsFragment settingsFragment) {
+						settingsFragment.onPreferenceChange(switchPref, enabled);
 					}
 				})
 				.create();
@@ -130,7 +128,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 			sliderPositionChanged = true;
 			if (fromUser) {
 				currentValue = entryValues[(int) slider.getValue()];
-				tvSliderSummary.setText(getFormattedDistance(app, currentValue));
+				tvSliderSummary.setText(OsmAndFormatter.getFormattedDistance(currentValue, app, NO_TRAILING_ZEROS));
 			}
 		});
 		UiUtilities.setupSlider(slider, nightMode, appModeColor, true);
@@ -146,7 +144,7 @@ protected void onRightBottomButtonClick() {
 			Fragment target = getTargetFragment();
 			if (target instanceof OnConfirmPreferenceChange) {
 				((OnConfirmPreferenceChange) target).onConfirmPreferenceChange(
-						preference.getId(), currentValue, ApplyQueryType.SNACK_BAR);
+						settings.ROUTE_RECALCULATION_DISTANCE.getId(), currentValue, SNACK_BAR);
 			}
 		}
 		dismiss();
@@ -169,23 +167,19 @@ private void updateSliderView() {
 		int textColorPrimary = ColorUtilities.getPrimaryTextColor(app, nightMode);
 		tvSliderTitle.setTextColor(enabled ? textColorPrimary : disabledColor);
 		tvSliderSummary.setTextColor(enabled ? activeColor : disabledColor);
-		tvSliderSummary.setText(getFormattedDistance(app, currentValue));
+		tvSliderSummary.setText(OsmAndFormatter.getFormattedDistance(currentValue, app, NO_TRAILING_ZEROS));
 		slider.setValue(findIndexOfValue(currentValue));
 		slider.setEnabled(enabled);
 	}
 
 	private void getPreferenceStateAndValue() {
-		float allowedValue = preference.getModeValue(appMode);
+		float allowedValue = settings.ROUTE_RECALCULATION_DISTANCE.getModeValue(appMode);
 		if (allowedValue == DISABLE_MODE) {
-			enabled = false;
+			getDefaultValue();
+		} else if (allowedValue == DEFAULT_MODE) {
 			getDefaultValue();
 		} else {
-			enabled = true;
-			if (allowedValue == DEFAULT_MODE) {
-				getDefaultValue();
-			} else {
-				currentValue = allowedValue;
-			}
+			currentValue = allowedValue;
 		}
 	}
 
@@ -205,13 +199,8 @@ private int findIndexOfValue(float allowedValue) {
 		return 0;
 	}
 
-	@NonNull
-	private static String getFormattedDistance(@NonNull OsmandApplication app, float value) {
-		return OsmAndFormatter.getFormattedDistance(value, app, OsmAndFormatterParams.NO_TRAILING_ZEROS);
-	}
-
-	public static boolean showInstance(@NonNull FragmentManager fragmentManager, String key, Fragment target,
-	                                   boolean usedOnMap, @Nullable ApplicationMode appMode) {
+	public static boolean showInstance(@NonNull FragmentManager fragmentManager, String key,
+			@Nullable Fragment target, boolean usedOnMap, @Nullable ApplicationMode appMode) {
 		if (AndroidUtils.isFragmentCanBeAdded(fragmentManager, TAG)) {
 			Bundle args = new Bundle();
 			args.putString(PREFERENCE_ID, key);
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
index e6f6e724d3c..0b7c08b9bf7 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
@@ -6,6 +6,7 @@
 import static net.osmand.plus.settings.fragments.DangerousGoodsFragment.getHazmatUsaClass;
 import static net.osmand.plus.settings.fragments.SettingsScreenType.DANGEROUS_GOODS;
 import static net.osmand.plus.utils.AndroidUtils.getRoutingStringPropertyName;
+import static net.osmand.plus.utils.OsmAndFormatterParams.NO_TRAILING_ZEROS;
 import static net.osmand.router.GeneralRouter.*;
 
 import android.app.Activity;
@@ -64,7 +65,6 @@
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
-import net.osmand.plus.utils.OsmAndFormatterParams;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.popup.PopUpMenu;
 import net.osmand.plus.widgets.popup.PopUpMenuDisplayData;
@@ -91,6 +91,7 @@ public class RouteParametersFragment extends BaseSettingsFragment {
 	private static final String ROUTE_PARAMETERS_IMAGE = "route_parameters_image";
 	private static final String ROUTING_SHORT_WAY = "prouting_short_way";
 	private static final String ROUTING_RECALC_DISTANCE = "routing_recalc_distance";
+	private static final String DISABLE_OFFROUTE_RECALC = "disable_offroute_recalc";
 	private static final String ROUTING_RECALC_WRONG_DIRECTION = "disable_wrong_direction_recalc";
 	private static final String HAZMAT_TRANSPORTING_ENABLED = "hazmat_transporting_enabled";
 	private static final String DANGEROUS_GOODS_USA = "dangerous_goods_usa";
@@ -574,7 +575,7 @@ public void onDisplayPreferenceDialog(Preference preference) {
 		ApplicationMode appMode = getSelectedAppMode();
 		FragmentManager manager = getFragmentManager();
 
-		if (settings.ROUTE_RECALCULATION_DISTANCE.getId().equals(prefId)) {
+		if (DISABLE_OFFROUTE_RECALC.equals(prefId)) {
 			if (manager != null) {
 				RecalculateRouteInDeviationBottomSheet.showInstance(manager, prefId, this, false, getSelectedAppMode());
 			}
@@ -634,29 +635,30 @@ private static void setupAngleSlider(float[] angleValue, View sliderView, boolea
 	}
 
 	private void setupSelectRouteRecalcDistance(@NonNull PreferenceScreen screen) {
-		SwitchPreferenceEx switchPref = createSwitchPreferenceEx(ROUTING_RECALC_DISTANCE,
+		SwitchPreferenceEx switchPref = createSwitchPreferenceEx(DISABLE_OFFROUTE_RECALC,
 				R.string.route_recalculation_dist_title, R.layout.preference_with_descr_dialog_and_switch);
-		switchPref.setIcon(getRoutingPrefIcon(ROUTING_RECALC_DISTANCE));
+		switchPref.setIcon(getRoutingPrefIcon(DISABLE_OFFROUTE_RECALC));
 		screen.addPreference(switchPref);
 		updateRouteRecalcDistancePref();
 	}
 
 	private void updateRouteRecalcDistancePref() {
-		SwitchPreferenceEx switchPref = findPreference(ROUTING_RECALC_DISTANCE);
+		SwitchPreferenceEx switchPref = findPreference(DISABLE_OFFROUTE_RECALC);
 		if (switchPref == null) {
 			return;
 		}
 		ApplicationMode appMode = getSelectedAppMode();
 		float allowedValue = settings.ROUTE_RECALCULATION_DISTANCE.getModeValue(appMode);
-		boolean enabled = allowedValue != DISABLE_MODE;
 		if (allowedValue <= 0) {
 			allowedValue = RoutingHelper.getDefaultAllowedDeviation(settings, appMode);
 		}
-		String summary = String.format(getString(R.string.ltr_or_rtl_combine_via_bold_point),
-				enabled ? getString(R.string.shared_string_enabled) : getString(R.string.shared_string_disabled),
-				OsmAndFormatter.getFormattedDistance(allowedValue, app, OsmAndFormatterParams.NO_TRAILING_ZEROS));
-		switchPref.setSummary(summary);
-		switchPref.setChecked(enabled);
+		switchPref.setSummaryOn(getString(R.string.ltr_or_rtl_combine_via_bold_point,
+				getString(R.string.shared_string_enabled),
+				OsmAndFormatter.getFormattedDistance(allowedValue, app, NO_TRAILING_ZEROS)));
+
+		switchPref.setSummaryOff(getString(R.string.ltr_or_rtl_combine_via_bold_point,
+				getString(R.string.shared_string_disabled),
+				OsmAndFormatter.getFormattedDistance(allowedValue, app, NO_TRAILING_ZEROS)));
 	}
 
 	private void setupViaFerrataPreference(@NonNull RoutingParameter parameter,
@@ -849,7 +851,9 @@ private void removeRoutingPrefListeners() {
 	@Override
 	public boolean onPreferenceChange(Preference preference, Object newValue) {
 		String prefId = preference.getKey();
-		if (settings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(prefId) && newValue instanceof Boolean) {
+		if ((settings.DISABLE_WRONG_DIRECTION_RECALC.getId().equals(prefId)
+				|| settings.DISABLE_OFFROUTE_RECALC.getId().equals(prefId))
+				&& newValue instanceof Boolean) {
 			return onConfirmPreferenceChange(prefId, !(Boolean) newValue, getApplyQueryType()); // pref ui was inverted
 		}
 		return onConfirmPreferenceChange(prefId, newValue, getApplyQueryType());
@@ -864,18 +868,8 @@ public void onApplyPreferenceChange(String prefId, boolean applyToAllProfiles,
 		} else if (ROUTING_SHORT_WAY.equals(prefId) && newValue instanceof Boolean) {
 			applyPreference(ROUTING_SHORT_WAY, applyToAllProfiles, newValue);
 			applyPreference(settings.FAST_ROUTE_MODE.getId(), applyToAllProfiles, !(Boolean) newValue);
-		} else if (ROUTING_RECALC_DISTANCE.equals(prefId)) {
-			boolean enabled = false;
-			float valueToSave = DISABLE_MODE;
-			if (newValue instanceof Boolean) {
-				enabled = (boolean) newValue;
-				valueToSave = enabled ? DEFAULT_MODE : DISABLE_MODE;
-			} else if (newValue instanceof Float) {
-				valueToSave = (float) newValue;
-				enabled = valueToSave != DISABLE_MODE;
-			}
-			applyPreference(ROUTING_RECALC_DISTANCE, applyToAllProfiles, valueToSave);
-			applyPreference(settings.DISABLE_OFFROUTE_RECALC.getId(), applyToAllProfiles, !enabled);
+		} else if (ROUTING_RECALC_DISTANCE.equals(prefId) && newValue instanceof Float) {
+			applyPreference(ROUTING_RECALC_DISTANCE, applyToAllProfiles, newValue);
 			updateRouteRecalcDistancePref();
 		} else if (HAZMAT_TRANSPORTING_ENABLED.equals(prefId)) {
 			if (newValue instanceof String) {
@@ -1042,7 +1036,7 @@ private Drawable getRoutingPrefIcon(String prefId) {
 					getIcon(R.drawable.ic_action_hazmat_limit_colored),
 					getContentIcon(R.drawable.ic_action_hazmat_limit));
 			case GOODS_RESTRICTIONS_PREFERENCE -> getPersistentPrefIcon(R.drawable.ic_action_van);
-			case ROUTING_RECALC_DISTANCE ->
+			case ROUTING_RECALC_DISTANCE, DISABLE_OFFROUTE_RECALC ->
 					getPersistentPrefIcon(R.drawable.ic_action_minimal_distance);
 			case ROUTING_RECALC_WRONG_DIRECTION ->
 					getPersistentPrefIcon(R.drawable.ic_action_reverse_direction);
