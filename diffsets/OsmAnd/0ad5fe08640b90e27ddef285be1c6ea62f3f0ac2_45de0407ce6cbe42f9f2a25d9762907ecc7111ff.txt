diff --git a/OsmAnd/res/layout/add_widget_item.xml b/OsmAnd/res/layout/add_widget_item.xml
new file mode 100644
index 00000000000..ad28273cb0f
--- /dev/null
+++ b/OsmAnd/res/layout/add_widget_item.xml
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="utf-8"?>
+<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	xmlns:tools="http://schemas.android.com/tools"
+	android:layout_width="match_parent"
+	android:layout_height="wrap_content"
+	android:background="?attr/selectableItemBackground"
+	android:layout_marginBottom="@dimen/content_padding_small"
+	android:orientation="vertical">
+
+	<LinearLayout
+		android:id="@+id/container"
+		android:layout_width="match_parent"
+		android:layout_height="match_parent"
+		android:orientation="horizontal"
+		android:minHeight="@dimen/card_row_min_height"
+		android:background="?attr/ripple_solid_6dp"
+		tools:ignore="UselessParent">
+
+		<androidx.appcompat.widget.AppCompatImageView
+			android:id="@+id/icon"
+			android:layout_marginStart="@dimen/content_padding"
+			android:layout_marginVertical="@dimen/content_padding_small"
+			android:layout_width="@dimen/dialog_content_margin"
+			android:layout_height="@dimen/dialog_content_margin"
+			tools:srcCompat="@drawable/widget_next_turn_day" />
+
+		<LinearLayout
+			android:layout_width="match_parent"
+			android:layout_height="match_parent"
+			android:layout_marginStart="@dimen/title_padding"
+			android:gravity="center_vertical"
+			android:orientation="vertical">
+
+			<net.osmand.plus.widgets.TextViewEx
+				android:id="@+id/title"
+				style="@style/TitleStyle"
+				android:layout_width="wrap_content"
+				android:layout_height="0dp"
+				android:gravity="center_vertical"
+				android:layout_weight="1"
+				android:maxLines="1"
+				android:ellipsize="end"
+				android:textColor="?android:textColorPrimary"
+				tools:text="Widget name" />
+
+			<View
+				android:id="@+id/bottom_divider"
+				android:layout_width="match_parent"
+				android:layout_height="1dp"
+				android:background="?attr/divider_color_basic" />
+
+		</LinearLayout>
+
+	</LinearLayout>
+
+</FrameLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/base_widget_fragment_layout.xml b/OsmAnd/res/layout/base_widget_fragment_layout.xml
index 35076a0463a..ef9a0a7b0fe 100644
--- a/OsmAnd/res/layout/base_widget_fragment_layout.xml
+++ b/OsmAnd/res/layout/base_widget_fragment_layout.xml
@@ -1,104 +1,54 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
 	xmlns:app="http://schemas.android.com/apk/res-auto"
-	xmlns:tools="http://schemas.android.com/tools"
 	android:layout_width="match_parent"
 	android:layout_height="match_parent"
-	android:orientation="vertical"
-	android:background="?attr/list_background_color"
+	android:background="?attr/activity_background_color"
 	android:clickable="true"
 	android:focusable="true">
 
-	<LinearLayout
+	<com.google.android.material.appbar.AppBarLayout
+		android:id="@+id/appbar"
 		android:layout_width="match_parent"
 		android:layout_height="wrap_content"
-		android:orientation="horizontal"
-		android:minHeight="@dimen/action_bar_height"
-		android:gravity="center_vertical">
+		android:background="@android:color/transparent"
+		android:stateListAnimator="@animator/appbar_always_elevated">
 
-		<androidx.appcompat.widget.AppCompatImageButton
-			android:id="@+id/close_button"
-			style="@style/Widget.AppCompat.ActionButton"
-			android:layout_width="@dimen/dialog_content_margin"
-			android:layout_height="@dimen/dialog_content_margin"
-			android:layout_marginStart="@dimen/title_padding"
-			android:src="@drawable/ic_action_close"
-			android:tint="?attr/primary_icon_color"
-			android:contentDescription="@string/shared_string_close"/>
-
-		<View
-			android:layout_width="0dp"
-			android:layout_height="match_parent"
-			android:layout_weight="1" />
-
-		<androidx.appcompat.widget.AppCompatImageButton
-			android:id="@+id/help_button"
-			style="@style/Widget.AppCompat.ActionButton"
-			android:layout_width="@dimen/dialog_content_margin"
-			android:layout_height="@dimen/dialog_content_margin"
-			android:layout_marginEnd="@dimen/content_padding"
-			android:src="@drawable/ic_action_help_online"
-			android:tint="?default_icon_color" />
-
-	</LinearLayout>
-
-	<LinearLayout
-		android:layout_width="match_parent"
-		android:layout_height="wrap_content"
-		android:layout_marginHorizontal="@dimen/content_padding"
-		android:orientation="horizontal"
-		android:minHeight="@dimen/setting_list_item_large_height"
-		android:gravity="center_vertical">
-
-		<LinearLayout
-			android:layout_width="0dp"
-			android:layout_height="wrap_content"
-			android:layout_weight="1"
-			android:orientation="vertical"
-			android:gravity="center_vertical">
-
-			<net.osmand.plus.widgets.TextViewEx
-				android:id="@+id/title"
-				style="@style/TitleStyle.Medium"
-				android:layout_width="match_parent"
-				android:layout_height="wrap_content"
-				android:maxLines="1"
-				android:ellipsize="end"
-				android:textSize="@dimen/dialog_header_text_size"
-				android:textColor="?android:textColorPrimary"
-				tools:text="Widget name" />
-
-			<net.osmand.plus.widgets.TextViewEx
-				android:id="@+id/sub_title"
+		<com.google.android.material.appbar.CollapsingToolbarLayout
+			android:id="@+id/toolbar_layout"
+			android:layout_width="match_parent"
+			android:layout_height="@dimen/toolbar_height_expanded_large"
+			android:background="?attr/list_background_color"
+			app:collapsedTitleTextAppearance="@style/AppBarTitlePrimary"
+			app:expandedTitleGravity="start|bottom"
+			app:expandedTitleMarginBottom="@dimen/content_padding_small"
+			app:expandedTitleMarginEnd="@dimen/content_padding"
+			app:expandedTitleMarginStart="@dimen/content_padding"
+			app:expandedTitleTextAppearance="@style/AppBarTitlePrimary"
+			app:layout_scrollFlags="scroll|exitUntilCollapsed">
+
+			<androidx.appcompat.widget.Toolbar
+				android:id="@+id/toolbar"
 				android:layout_width="match_parent"
-				android:layout_height="wrap_content"
-				android:maxLines="1"
-				android:ellipsize="end"
-				android:textColor="?android:textColorSecondary"
-				tools:text="Widget" />
+				android:layout_height="@dimen/toolbar_height"
+				android:minHeight="@dimen/toolbar_height"
+				app:layout_collapseMode="pin"
+				app:layout_scrollFlags="scroll|enterAlways|exitUntilCollapsed"
+				app:title="@string/default_appearance"
+				app:titleMarginEnd="0dp"
+				app:titleMarginStart="0dp" />
 
-		</LinearLayout>
+		</com.google.android.material.appbar.CollapsingToolbarLayout>
 
-		<androidx.appcompat.widget.AppCompatImageView
-			android:id="@+id/icon"
-			android:layout_width="@dimen/bottom_sheet_descr_height"
-			android:layout_height="@dimen/bottom_sheet_descr_height"
-			app:srcCompat="@drawable/widget_lanes_day" />
-
-	</LinearLayout>
+	</com.google.android.material.appbar.AppBarLayout>
 
 	<FrameLayout
 		android:layout_width="match_parent"
-		android:layout_height="0dp"
-		android:layout_weight="1">
-
-		<androidx.appcompat.widget.AppCompatImageView
-			android:layout_width="match_parent"
-			android:layout_height="@dimen/abp__shadow_height"
-			android:scaleType="fitXY"
-			app:srcCompat="@drawable/bg_shadow_list_bottom" />
+		android:layout_height="match_parent"
+		android:background="?attr/activity_background_color"
+		app:layout_behavior="@string/appbar_scrolling_view_behavior">
 
-		<ScrollView
+		<androidx.core.widget.NestedScrollView
 			android:layout_width="match_parent"
 			android:layout_height="match_parent"
 			android:fillViewport="true">
@@ -108,11 +58,16 @@
 				android:layout_height="wrap_content"
 				android:orientation="vertical">
 
+				<include
+					android:id="@+id/available_widgets_divider"
+					layout="@layout/list_item_divider" />
+
 				<LinearLayout
 					android:id="@+id/main_content"
 					android:layout_width="match_parent"
 					android:layout_height="wrap_content"
-					android:orientation="vertical"/>
+					android:background="?attr/list_background_color"
+					android:orientation="vertical" />
 
 				<View
 					android:layout_width="match_parent"
@@ -120,18 +75,8 @@
 
 			</LinearLayout>
 
-		</ScrollView>
-
-		<androidx.appcompat.widget.AppCompatImageView
-			android:id="@+id/buttons_shadow"
-			android:layout_width="match_parent"
-			android:layout_height="@dimen/abp__shadow_height"
-			android:layout_gravity="bottom"
-			android:scaleType="fitXY"
-			app:srcCompat="@drawable/bg_shadow_list_top" />
+		</androidx.core.widget.NestedScrollView>
 
 	</FrameLayout>
 
-	<include layout="@layout/bottom_buttons" />
-
-</LinearLayout>
\ No newline at end of file
+</androidx.coordinatorlayout.widget.CoordinatorLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/resizable_widget_setting.xml b/OsmAnd/res/layout/resizable_widget_setting.xml
index e1bc88e42fb..f25e74f3f2d 100644
--- a/OsmAnd/res/layout/resizable_widget_setting.xml
+++ b/OsmAnd/res/layout/resizable_widget_setting.xml
@@ -1,32 +1,45 @@
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-	xmlns:tools="http://schemas.android.com/tools"
 	android:layout_width="match_parent"
 	android:layout_height="wrap_content"
 	android:orientation="vertical">
 
+	<include layout="@layout/divider" />
+
 	<LinearLayout
-		android:id="@+id/widget_size_container"
 		android:layout_width="match_parent"
 		android:layout_height="wrap_content"
-		android:paddingHorizontal="@dimen/content_padding"
-		android:paddingVertical="@dimen/content_padding_small"
-		android:orientation="vertical">
+		android:background="?attr/list_background_color"
+		android:orientation="horizontal"
+		android:paddingVertical="4dp">
 
-		<net.osmand.plus.widgets.TextViewEx
+		<TextView
+			android:id="@+id/height"
 			style="@style/TitleStyle"
-			android:layout_width="match_parent"
+			android:layout_width="0dp"
 			android:layout_height="wrap_content"
-			android:text="@string/shared_string_size"
+			android:layout_marginHorizontal="@dimen/content_padding"
+			android:layout_marginVertical="@dimen/content_padding_small"
+			android:layout_weight="1"
+			android:ellipsize="end"
+			android:gravity="center_vertical"
+			android:maxLines="1"
+			android:text="@string/shared_string_height"
 			android:textColor="?android:textColorPrimary" />
 
-		<TextView
-			android:id="@+id/widget_size_description"
-			style="@style/DescStyle"
-			android:layout_width="match_parent"
+		<LinearLayout
+			android:layout_width="wrap_content"
 			android:layout_height="wrap_content"
-			android:textColor="?android:textColorSecondary"
-			tools:text="Small" />
+			android:layout_gravity="center|end"
+			android:layout_marginStart="@dimen/content_padding"
+			android:layout_marginEnd="@dimen/content_padding"
+			android:baselineAligned="false"
+			android:minHeight="@dimen/dialog_button_height"
+			android:orientation="horizontal">
+
+			<include layout="@layout/custom_icon_radio_buttons" />
+
+		</LinearLayout>
 
 	</LinearLayout>
 
diff --git a/OsmAnd/res/layout/simple_widget_settings.xml b/OsmAnd/res/layout/simple_widget_settings.xml
index 1a76831ad81..cb3792b3c4e 100644
--- a/OsmAnd/res/layout/simple_widget_settings.xml
+++ b/OsmAnd/res/layout/simple_widget_settings.xml
@@ -4,6 +4,12 @@
 	android:layout_height="wrap_content"
 	android:orientation="vertical">
 
+	<include
+		layout="@layout/divider"
+		android:layout_width="match_parent"
+		android:layout_height="match_parent"
+		android:layout_marginStart="@dimen/content_padding" />
+
 	<LinearLayout
 		android:id="@+id/show_icon_container"
 		android:layout_width="match_parent"
@@ -35,10 +41,5 @@
 
 	</LinearLayout>
 
-	<View
-		android:layout_width="match_parent"
-		android:layout_height="1dp"
-		android:background="?divider_color_basic" />
-
 </LinearLayout>
 
diff --git a/OsmAnd/res/layout/widget_settings_info_fragment.xml b/OsmAnd/res/layout/widget_settings_info_fragment.xml
new file mode 100644
index 00000000000..b0878e31cd8
--- /dev/null
+++ b/OsmAnd/res/layout/widget_settings_info_fragment.xml
@@ -0,0 +1,181 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	xmlns:app="http://schemas.android.com/apk/res-auto"
+	xmlns:tools="http://schemas.android.com/tools"
+	android:layout_width="match_parent"
+	android:layout_height="match_parent"
+	android:background="?attr/activity_background_color"
+	android:clickable="true"
+	android:focusable="true">
+
+	<com.google.android.material.appbar.AppBarLayout
+		android:id="@+id/appbar"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:background="@android:color/transparent"
+		android:stateListAnimator="@animator/appbar_always_elevated">
+
+		<com.google.android.material.appbar.CollapsingToolbarLayout
+			android:id="@+id/toolbar_layout"
+			android:layout_width="match_parent"
+			android:layout_height="@dimen/toolbar_height_expanded_large"
+			android:background="?attr/list_background_color"
+			app:collapsedTitleTextAppearance="@style/AppBarTitlePrimary"
+
+			app:expandedTitleGravity="start|bottom"
+			app:expandedTitleMarginBottom="@dimen/content_padding_small"
+			app:expandedTitleMarginEnd="@dimen/content_padding"
+			app:expandedTitleMarginStart="@dimen/content_padding"
+			app:expandedTitleTextAppearance="@style/AppBarTitlePrimary"
+			app:layout_scrollFlags="scroll|exitUntilCollapsed">
+
+			<androidx.appcompat.widget.Toolbar
+				android:id="@+id/toolbar"
+				android:layout_width="match_parent"
+				android:layout_height="@dimen/toolbar_height"
+				android:minHeight="@dimen/toolbar_height"
+				app:layout_collapseMode="pin"
+				app:layout_scrollFlags="scroll|enterAlways|exitUntilCollapsed"
+				app:title="@string/default_appearance"
+				app:titleMarginEnd="0dp"
+				app:titleMarginStart="0dp" />
+
+		</com.google.android.material.appbar.CollapsingToolbarLayout>
+
+	</com.google.android.material.appbar.AppBarLayout>
+
+	<FrameLayout
+		android:layout_width="match_parent"
+		android:layout_height="match_parent"
+		app:layout_behavior="@string/appbar_scrolling_view_behavior">
+
+		<androidx.core.widget.NestedScrollView
+			android:id="@+id/scroll_view"
+			android:layout_width="match_parent"
+			android:layout_height="match_parent"
+			android:fillViewport="true"
+			android:overScrollMode="never">
+
+			<LinearLayout
+				android:layout_width="match_parent"
+				android:layout_height="wrap_content"
+				android:orientation="vertical">
+
+				<include layout="@layout/list_item_divider" />
+
+				<LinearLayout
+					android:layout_width="match_parent"
+					android:layout_height="wrap_content"
+					android:background="?attr/list_background_color"
+					android:orientation="vertical">
+
+					<TextView
+						android:id="@+id/widget_description"
+						style="@style/TitleStyle"
+						android:layout_width="match_parent"
+						android:layout_height="wrap_content"
+						android:layout_marginHorizontal="@dimen/content_padding"
+						android:layout_marginVertical="@dimen/content_padding_small"
+						android:textColor="?android:textColorPrimary"
+						android:textSize="16sp"
+						tools:text="Widget description" />
+
+					<LinearLayout
+						android:id="@+id/promo_banner_container"
+						android:layout_width="match_parent"
+						android:layout_height="wrap_content"
+						android:background="?attr/list_background_color"
+						android:visibility="gone">
+
+						<FrameLayout
+							android:id="@+id/promo_banner"
+							android:layout_width="match_parent"
+							android:layout_height="wrap_content"
+							android:layout_marginHorizontal="@dimen/content_padding"
+							android:layout_marginVertical="@dimen/content_padding" />
+
+					</LinearLayout>
+
+					<LinearLayout
+						android:id="@+id/top_settings_container"
+						android:layout_width="match_parent"
+						android:layout_height="wrap_content"
+						android:orientation="vertical" />
+
+				</LinearLayout>
+
+				<LinearLayout
+					android:id="@+id/main_container"
+					android:layout_width="match_parent"
+					android:layout_height="wrap_content"
+					android:orientation="vertical">
+
+					<include layout="@layout/card_bottom_divider" />
+
+					<View
+						android:id="@+id/resizable_item_divider"
+						android:layout_width="match_parent"
+						android:layout_height="12dp" />
+
+					<include layout="@layout/card_top_divider" />
+
+					<LinearLayout
+						android:layout_width="match_parent"
+						android:layout_height="wrap_content"
+						android:background="?attr/list_background_color"
+						android:orientation="vertical">
+
+						<net.osmand.plus.widgets.TextViewEx
+							android:id="@+id/settings"
+							style="@style/TitleStyle.Medium"
+							android:layout_width="match_parent"
+							android:layout_height="wrap_content"
+							android:layout_marginHorizontal="@dimen/content_padding"
+							android:layout_marginVertical="@dimen/content_padding_small"
+							android:text="@string/shared_string_settings"
+							android:textColor="?android:textColorPrimary" />
+
+						<LinearLayout
+							android:id="@+id/main_settings_container"
+							android:layout_width="match_parent"
+							android:layout_height="wrap_content"
+							android:orientation="vertical"
+							android:paddingBottom="@dimen/content_padding_small" />
+
+					</LinearLayout>
+
+				</LinearLayout>
+
+				<include layout="@layout/card_bottom_divider" />
+
+				<View
+					android:id="@+id/compensation_view"
+					android:layout_width="match_parent"
+					android:layout_height="@dimen/dialog_button_ex_height" />
+
+			</LinearLayout>
+
+		</androidx.core.widget.NestedScrollView>
+
+	</FrameLayout>
+
+	<LinearLayout
+		android:id="@+id/apply_button_container"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:layout_gravity="bottom"
+		android:orientation="vertical">
+
+		<androidx.appcompat.widget.AppCompatImageView
+			android:id="@+id/buttons_shadow"
+			android:layout_width="match_parent"
+			android:layout_height="@dimen/abp__shadow_height"
+			android:layout_gravity="bottom"
+			android:scaleType="fitXY"
+			app:srcCompat="@drawable/bg_shadow_list_top" />
+
+		<include layout="@layout/bottom_buttons" />
+
+	</LinearLayout>
+
+</androidx.coordinatorlayout.widget.CoordinatorLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/values/strings.xml b/OsmAnd/res/values/strings.xml
index b7056570135..a73be93bb44 100644
--- a/OsmAnd/res/values/strings.xml
+++ b/OsmAnd/res/values/strings.xml
@@ -10,7 +10,8 @@
 	- For wording and consistency, please note https://docs.osmand.net/docs/technical/contributions/translating-osmand
 	Thx - Hardy
 -->
-
+    <string name="row_height">Row height</string>
+    <string name="add_widget">Add widget</string>
     <string name="choose_location">Choose a location</string>
     <string name="point_location">Point location</string>
     <string name="shared_string_manual">Manual</string>
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/WidgetsSettingsHelper.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/WidgetsSettingsHelper.java
index 6d6a88edd69..f0b586a253d 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/WidgetsSettingsHelper.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/WidgetsSettingsHelper.java
@@ -139,6 +139,26 @@ public void copyWidgetsForPanel(@NonNull ApplicationMode fromAppMode, @NonNull W
 		panel.setWidgetsOrder(appMode, newPagedOrder, settings);
 	}
 
+	public List<List<MapWidgetInfo>> getWidgetInfoPagedOrder(@NonNull ApplicationMode fromAppMode, @NonNull ApplicationMode toAppMode, @NonNull WidgetsPanel panel, int filter) {
+		int previousPage = -1;
+		List<WidgetsPanel> panels = Collections.singletonList(panel);
+		Set<MapWidgetInfo> widgetInfos = widgetRegistry.getWidgetsForPanel(mapActivity, fromAppMode, filter, panels);
+		List<List<MapWidgetInfo>> pagedOrder = new ArrayList<>();
+		for (MapWidgetInfo widgetInfo : widgetInfos) {
+			String widgetId = widgetInfo.key;
+			if (!Algorithms.isEmpty(widgetId) && WidgetsAvailabilityHelper.isWidgetAvailable(app, widgetId, appMode)) {
+				if (previousPage != widgetInfo.pageIndex || pagedOrder.isEmpty()) {
+					previousPage = widgetInfo.pageIndex;
+					pagedOrder.add(new ArrayList<>());
+				}
+				if (WidgetsAvailabilityHelper.isWidgetAvailable(app, widgetId, toAppMode)) {
+					pagedOrder.get(pagedOrder.size() - 1).add(widgetInfo);
+				}
+			}
+		}
+		return pagedOrder;
+	}
+
 	public List<List<String>> getWidgetsPagedOrder(@NonNull ApplicationMode fromAppMode, @NonNull WidgetsPanel panel, int filter) {
 		int previousPage = -1;
 		List<WidgetsPanel> panels = Collections.singletonList(panel);
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/dialogs/AddWidgetFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/dialogs/AddWidgetFragment.java
index 0c23f1084a0..84a6c088470 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/dialogs/AddWidgetFragment.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/dialogs/AddWidgetFragment.java
@@ -1,7 +1,5 @@
 package net.osmand.plus.views.mapwidgets.configure.dialogs;
 
-import static net.osmand.plus.views.mapwidgets.MapWidgetRegistry.ENABLED_MODE;
-import static net.osmand.plus.views.mapwidgets.MapWidgetRegistry.MATCHING_PANELS_MODE;
 import static net.osmand.plus.views.mapwidgets.configure.dialogs.WidgetDataHolder.KEY_EXTERNAL_PROVIDER_PACKAGE;
 import static net.osmand.plus.views.mapwidgets.configure.dialogs.WidgetDataHolder.KEY_EXTERNAL_WIDGET_ID;
 import static net.osmand.plus.views.mapwidgets.configure.dialogs.WidgetDataHolder.KEY_GROUP_NAME;
@@ -9,19 +7,17 @@
 import static net.osmand.plus.views.mapwidgets.configure.dialogs.WidgetDataHolder.KEY_WIDGET_TYPE;
 
 import android.graphics.drawable.Drawable;
-import android.net.Uri;
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
-import android.widget.CheckBox;
 import android.widget.ImageView;
 import android.widget.TextView;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.appcompat.widget.Toolbar;
 import androidx.fragment.app.Fragment;
-import androidx.fragment.app.FragmentActivity;
 import androidx.fragment.app.FragmentManager;
 
 import net.osmand.Collator;
@@ -35,27 +31,21 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
-import net.osmand.plus.utils.UiUtilities.CompoundButtonType;
-import net.osmand.plus.widgets.dialogbutton.DialogButtonType;
-import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
-import net.osmand.plus.views.mapwidgets.MapWidgetRegistry;
 import net.osmand.plus.views.mapwidgets.WidgetGroup;
 import net.osmand.plus.views.mapwidgets.WidgetType;
 import net.osmand.plus.views.mapwidgets.WidgetsPanel;
 import net.osmand.plus.views.mapwidgets.banner.WidgetPromoBanner;
-import net.osmand.plus.views.mapwidgets.configure.WidgetIconsHelper;
 import net.osmand.plus.views.mapwidgets.configure.panel.WidgetsListFragment;
 import net.osmand.plus.views.mapwidgets.configure.reorder.ReorderWidgetsFragment;
-import net.osmand.plus.widgets.dialogbutton.DialogButton;
 import net.osmand.util.Algorithms;
 
 import java.io.Serializable;
 import java.util.ArrayList;
-import java.util.Arrays;
+import java.util.Collections;
 import java.util.List;
 import java.util.Map;
-import java.util.Set;
 import java.util.TreeMap;
 
 public class AddWidgetFragment extends BaseWidgetFragment {
@@ -71,7 +61,6 @@ public class AddWidgetFragment extends BaseWidgetFragment {
 	private List<String> alreadySelectedWidgetsIds;
 
 	private View view;
-	private DialogButton applyButton;
 
 	@Nullable
 	@Override
@@ -93,11 +82,16 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 
 		setupToolbar();
 		setupContent();
-		setupApplyButton();
 
 		return view;
 	}
 
+	@Override
+	public int getStatusBarColorId() {
+		AndroidUiHelper.setStatusBarContentColor(getView(), nightMode);
+		return ColorUtilities.getStatusBarSecondaryColorId(nightMode);
+	}
+
 	private void initFromBundle(@NonNull Bundle bundle) {
 		String appModeKey = bundle.getString(KEY_APP_MODE);
 		appMode = ApplicationMode.valueOfStringKey(appModeKey, app.getSettings().getApplicationMode());
@@ -114,43 +108,14 @@ private void initFromBundle(@NonNull Bundle bundle) {
 	}
 
 	private void setupToolbar() {
-		View closeButton = view.findViewById(R.id.close_button);
-		closeButton.setOnClickListener(v -> dismiss());
-
-		View helpButton = view.findViewById(R.id.help_button);
-		int docsUrlId = widgetsDataHolder.getDocsUrl();
-		if (docsUrlId != 0) {
-			String docsUrl = getString(docsUrlId);
-			helpButton.setOnClickListener(v -> {
-				FragmentActivity activity = getActivity();
-				if (activity != null) {
-					AndroidUtils.openUrl(activity, Uri.parse(docsUrl), nightMode);
-				}
-			});
-		} else {
-			AndroidUiHelper.updateVisibility(helpButton, false);
-		}
-
-		TextView title = view.findViewById(R.id.title);
-		title.setText(widgetsDataHolder.getTitle());
-
-		TextView subTitle = view.findViewById(R.id.sub_title);
-		int widgetsCount = widgetsDataHolder.getWidgetsCount();
-		if (widgetsCount > 1) {
-			String widgetsString = getString(R.string.shared_string_widgets);
-			String widgetsCountString = String.valueOf(widgetsCount);
-			subTitle.setText(getString(R.string.ltr_or_rtl_combine_via_colon, widgetsString, widgetsCountString));
-		} else {
-			subTitle.setText(R.string.shared_string_widget);
-		}
-
-		ImageView icon = view.findViewById(R.id.icon);
-		int iconId = widgetsDataHolder.getIconId(nightMode);
-		if (iconId != 0) {
-			WidgetIconsHelper iconsHelper = new WidgetIconsHelper(app, appMode.getProfileColor(nightMode), nightMode);
-			boolean externalWidget = !Algorithms.isEmpty(widgetsDataHolder.getAidlWidgetId());
-			iconsHelper.updateWidgetIcon(icon, 0, iconId, externalWidget);
-		}
+		Toolbar toolbar = view.findViewById(R.id.toolbar);
+		toolbar.setNavigationIcon(getContentIcon(AndroidUtils.getNavigationIconResId(app)));
+		toolbar.setNavigationContentDescription(R.string.access_shared_string_navigate_up);
+		toolbar.setNavigationOnClickListener(v -> {
+			closeFragment();
+		});
+		toolbar.setTitle(widgetsDataHolder.getTitle());
+		toolbar.setTitleTextColor(ColorUtilities.getPrimaryTextColor(app, nightMode));
 	}
 
 	private void setupContent() {
@@ -187,15 +152,17 @@ private void inflateWidgetsList(@NonNull List<WidgetType> widgets) {
 		WidgetGroup group = widgetsDataHolder.getWidgetGroup();
 		MapActivity activity = requireMapActivity();
 
-		for (WidgetType widget : widgets) {
+		for (int i = 0; i < widgets.size(); i++) {
+			WidgetType widget = widgets.get(i);
 			if (widget.isPurchased(app)) {
-				int layoutId = widget.descId != 0 ? R.layout.selectable_widget_item : R.layout.selectable_widget_item_no_description;
+				int layoutId = R.layout.add_widget_item;
 				View view = inflater.inflate(layoutId, container, false);
 				String title = getString(widget.titleId);
 				int descId = group != null ? widget.getGroupDescriptionId() : widget.descId;
 				String desc = descId == 0 ? null : getString(descId);
 				Drawable icon = getIcon(widget.getIconId(nightMode));
-				setupWidgetItemView(view, widget.id, title, desc, icon, widget.getDefaultOrder());
+				boolean showDivider = i + 1 < widgets.size() && widgets.get(i + 1).isPurchased(app);
+				setupWidgetItemView(view, widget.id, title, desc, icon, showDivider);
 				container.addView(view);
 			} else if (widget.isOBDWidget()) {
 				View view = inflater.inflate(R.layout.selectable_widget_item_pro_banner, container, false);
@@ -214,65 +181,40 @@ private void inflateAidlWidget(@NonNull AidlMapWidgetWrapper aidlWidgetData) {
 		ViewGroup container = view.findViewById(R.id.widgets_container);
 		LayoutInflater inflater = UiUtilities.getInflater(requireContext(), nightMode);
 
-		View view = inflater.inflate(R.layout.selectable_widget_item_no_description, container, false);
+		View view = inflater.inflate(R.layout.add_widget_item, container, false);
 		String widgetId = getAidlWidgetId(aidlWidgetData);
 		String title = aidlWidgetData.getMenuTitle();
 		String iconName = aidlWidgetData.getMenuIconName();
 		int iconId = AndroidUtils.getDrawableId(app, iconName);
 		Drawable icon = iconId != 0 ? getPaintedContentIcon(iconId, appMode.getProfileColor(nightMode)) : null;
-		setupWidgetItemView(view, widgetId, title, null, icon, 0);
+		setupWidgetItemView(view, widgetId, title, null, icon, false);
 
 		container.addView(view);
 	}
 
 	private void setupWidgetItemView(@NonNull View view,
-									 @NonNull String widgetId,
-									 @NonNull String title,
-									 @Nullable String description,
-									 @Nullable Drawable icon,
-									 int order) {
+	                                 @NonNull String widgetId,
+	                                 @NonNull String title,
+	                                 @Nullable String description,
+	                                 @Nullable Drawable icon,
+	                                 boolean showDivider) {
 		((ImageView) view.findViewById(R.id.icon)).setImageDrawable(icon);
 		((TextView) view.findViewById(R.id.title)).setText(title);
-
-		if (widgetsDataHolder.getWidgetGroup() != null && !Algorithms.isEmpty(description)) {
-			TextView descriptionText = view.findViewById(R.id.description);
-			descriptionText.setText(description);
-			AndroidUiHelper.updateVisibility(descriptionText, true);
-		}
-
-		CheckBox checkBox = view.findViewById(R.id.compound_button);
-		UiUtilities.setupCompoundButton(checkBox, nightMode, CompoundButtonType.GLOBAL);
-
-		if (selectedWidgetsIds.containsValue(widgetId)) {
-			view.setSelected(true);
-			checkBox.setChecked(true);
-		}
+		AndroidUiHelper.updateVisibility(view.findViewById(R.id.bottom_divider), showDivider);
 
 		view.setOnClickListener(v -> {
-			boolean selected = !view.isSelected();
-			view.setSelected(selected);
-			checkBox.setChecked(selected);
-			updateWidgetSelection(order, widgetId, selected);
-			enableDisableApplyButton();
-		});
-
-	}
+			closeFragment();
 
-	private boolean isWidgetEnabled(@NonNull MapActivity mapActivity, @NonNull String widgetId) {
-		MapWidgetRegistry widgetRegistry = app.getOsmandMap().getMapLayers().getMapWidgetRegistry();
-		Set<MapWidgetInfo> enabledWidgets = widgetRegistry.getWidgetsForPanel(mapActivity, appMode,
-				ENABLED_MODE | MATCHING_PANELS_MODE, Arrays.asList(WidgetsPanel.values()));
-
-		for (MapWidgetInfo widgetInfo : enabledWidgets) {
-			if (widgetId.equals(widgetInfo.key)) {
-				return true;
+			Fragment target = getTargetFragment();
+			if (target instanceof AddWidgetListener) {
+				WidgetsPanel widgetsPanel = widgetsDataHolder.getWidgetsPanel();
+				((AddWidgetListener) target).onWidgetSelectedToAdd(widgetId, widgetsPanel, true);
 			}
-		}
-
-		return false;
+		});
 	}
 
-	private String getAidlWidgetId(AidlMapWidgetWrapper aidlWidgetData) {
+	@NonNull
+	private String getAidlWidgetId(@NonNull AidlMapWidgetWrapper aidlWidgetData) {
 		return OsmandAidlApi.WIDGET_ID_PREFIX + aidlWidgetData.getId();
 	}
 
@@ -294,24 +236,8 @@ private void updateWidgetSelection(int order, @NonNull String widgetId, boolean
 		}
 	}
 
-	private void setupApplyButton() {
-		applyButton = view.findViewById(R.id.dismiss_button);
-		applyButton.setOnClickListener(v -> {
-			Fragment target = getTargetFragment();
-			if (target instanceof AddWidgetListener) {
-				List<String> widgetsIds = new ArrayList<>(selectedWidgetsIds.values());
-				WidgetsPanel widgetsPanel = widgetsDataHolder.getWidgetsPanel();
-				((AddWidgetListener) target).onWidgetsSelectedToAdd(widgetsIds, widgetsPanel, true);
-			}
-			dismiss();
-		});
-		applyButton.setButtonType(DialogButtonType.PRIMARY);
-		applyButton.setTitleId(R.string.shared_string_add);
-		enableDisableApplyButton();
-	}
-
-	private void enableDisableApplyButton() {
-		applyButton.setEnabled(!selectedWidgetsIds.isEmpty());
+	private void closeFragment() {
+		requireActivity().getSupportFragmentManager().popBackStack();
 	}
 
 	@Override
@@ -339,11 +265,11 @@ protected String getFragmentTag() {
 	 *                                  ({@link WidgetsListFragment})
 	 */
 	public static void showGroupDialog(@NonNull FragmentManager manager,
-									   @Nullable Fragment target,
-									   @NonNull ApplicationMode appMode,
-									   @NonNull WidgetsPanel widgetsPanel,
-									   @NonNull WidgetGroup widgetGroup,
-									   @Nullable List<String> alreadySelectedWidgetsIds) {
+	                                   @Nullable Fragment target,
+	                                   @NonNull ApplicationMode appMode,
+	                                   @NonNull WidgetsPanel widgetsPanel,
+	                                   @NonNull WidgetGroup widgetGroup,
+	                                   @Nullable List<String> alreadySelectedWidgetsIds) {
 		Bundle args = new Bundle();
 		args.putString(KEY_APP_MODE, appMode.getStringKey());
 		args.putString(KEY_WIDGETS_PANEL_ID, widgetsPanel.name());
@@ -359,11 +285,11 @@ public static void showGroupDialog(@NonNull FragmentManager manager,
 	 * @see AddWidgetListener#showGroupDialog
 	 */
 	public static void showWidgetDialog(@NonNull FragmentManager manager,
-										@Nullable Fragment target,
-										@NonNull ApplicationMode appMode,
-										@NonNull WidgetsPanel widgetsPanel,
-										@NonNull WidgetType widgetType,
-										@Nullable List<String> alreadySelectedWidgetsIds) {
+	                                    @Nullable Fragment target,
+	                                    @NonNull ApplicationMode appMode,
+	                                    @NonNull WidgetsPanel widgetsPanel,
+	                                    @NonNull WidgetType widgetType,
+	                                    @Nullable List<String> alreadySelectedWidgetsIds) {
 		Bundle args = new Bundle();
 		args.putString(KEY_APP_MODE, appMode.getStringKey());
 		args.putString(KEY_WIDGETS_PANEL_ID, widgetsPanel.name());
@@ -379,12 +305,12 @@ public static void showWidgetDialog(@NonNull FragmentManager manager,
 	 * @see AddWidgetListener#showGroupDialog
 	 */
 	public static void showExternalWidgetDialog(@NonNull FragmentManager manager,
-												@Nullable Fragment target,
-												@NonNull ApplicationMode appMode,
-												@NonNull WidgetsPanel widgetsPanel,
-												@NonNull String widgetId,
-												@NonNull String externalProviderPackage,
-												@Nullable List<String> alreadySelectedWidgetsIds) {
+	                                            @Nullable Fragment target,
+	                                            @NonNull ApplicationMode appMode,
+	                                            @NonNull WidgetsPanel widgetsPanel,
+	                                            @NonNull String widgetId,
+	                                            @NonNull String externalProviderPackage,
+	                                            @Nullable List<String> alreadySelectedWidgetsIds) {
 		Bundle args = new Bundle();
 		args.putString(KEY_APP_MODE, appMode.getStringKey());
 		args.putString(KEY_WIDGETS_PANEL_ID, widgetsPanel.name());
@@ -407,6 +333,6 @@ private static void showFragment(@NonNull FragmentManager manager, @NonNull AddW
 	}
 
 	public interface AddWidgetListener {
-		void onWidgetsSelectedToAdd(@NonNull List<String> widgetsIds, @NonNull WidgetsPanel widgetsPanel, boolean recreateControls);
+		void onWidgetSelectedToAdd(@NonNull String widgetsId, @NonNull WidgetsPanel widgetsPanel, boolean recreateControls);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsConfigurationChangeListener.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsConfigurationChangeListener.java
index d86b3f1d49b..b415d79fe01 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsConfigurationChangeListener.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsConfigurationChangeListener.java
@@ -1,6 +1,11 @@
 package net.osmand.plus.views.mapwidgets.configure.panel;
 
+import androidx.annotation.NonNull;
+
+import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
+
 public interface WidgetsConfigurationChangeListener {
 
 	void onWidgetsConfigurationChanged();
+	void onWidgetAdded(@NonNull MapWidgetInfo widgetInfo);
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsTabAdapter.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsTabAdapter.java
index 62142f51e39..4d28ce9e9c5 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsTabAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsTabAdapter.java
@@ -15,7 +15,7 @@ public WidgetsTabAdapter(@NonNull Fragment fragment) {
 	@NonNull
 	@Override
 	public Fragment createFragment(int position) {
-		WidgetsListFragment fragment = new WidgetsListFragment();
+		WidgetsListFragmentV2 fragment = new WidgetsListFragmentV2();
 		fragment.setSelectedPanel(WidgetsPanel.values()[position]);
 		return fragment;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/WidgetInfoBaseFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/WidgetInfoBaseFragment.java
new file mode 100644
index 00000000000..dd8f2aa646b
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/WidgetInfoBaseFragment.java
@@ -0,0 +1,418 @@
+package net.osmand.plus.views.mapwidgets.configure.settings;
+
+import static net.osmand.plus.views.mapwidgets.MapWidgetRegistry.ENABLED_MODE;
+import static net.osmand.plus.views.mapwidgets.MapWidgetRegistry.MATCHING_PANELS_MODE;
+
+import android.app.Activity;
+import android.graphics.drawable.Drawable;
+import android.os.Bundle;
+import android.view.LayoutInflater;
+import android.view.Menu;
+import android.view.MenuInflater;
+import android.view.MenuItem;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.appcompat.widget.Toolbar;
+import androidx.core.view.MenuProvider;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+
+import com.google.android.material.snackbar.Snackbar;
+
+import net.osmand.aidl.AidlMapWidgetWrapper;
+import net.osmand.aidl.ConnectedApp;
+import net.osmand.plus.R;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.base.BaseOsmAndFragment;
+import net.osmand.plus.base.dialog.DialogManager;
+import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.utils.UiUtilities;
+import net.osmand.plus.views.layers.MapInfoLayer;
+import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
+import net.osmand.plus.views.mapwidgets.MapWidgetRegistry;
+import net.osmand.plus.views.mapwidgets.MapWidgetsFactory;
+import net.osmand.plus.views.mapwidgets.WidgetInfoCreator;
+import net.osmand.plus.views.mapwidgets.WidgetType;
+import net.osmand.plus.views.mapwidgets.WidgetsPanel;
+import net.osmand.plus.views.mapwidgets.banner.WidgetPromoBanner;
+import net.osmand.plus.views.mapwidgets.configure.panel.ConfigureWidgetsController;
+import net.osmand.plus.views.mapwidgets.configure.panel.WidgetsConfigurationChangeListener;
+import net.osmand.plus.views.mapwidgets.widgets.MapWidget;
+import net.osmand.plus.views.mapwidgets.widgetstates.WidgetState;
+import net.osmand.plus.widgets.dialogbutton.DialogButton;
+import net.osmand.plus.widgets.dialogbutton.DialogButtonType;
+import net.osmand.plus.widgets.popup.PopUpMenu;
+import net.osmand.plus.widgets.popup.PopUpMenuDisplayData;
+import net.osmand.plus.widgets.popup.PopUpMenuItem;
+import net.osmand.util.Algorithms;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.LinkedHashMap;
+import java.util.List;
+import java.util.Map;
+
+public class WidgetInfoBaseFragment extends BaseOsmAndFragment {
+
+	public static final String KEY_APP_MODE = "app_mode";
+	public static final String KEY_WIDGET_ID = "widget_id";
+	public static final String KEY_ADD_MODE = "add_mode_key";
+	public static final String IS_VERTICAL_PANEL_KEY = "is_vertical_panel_key";
+	public static final String KEY_SELECTED_PANEL = "selected_panel_key";
+
+	protected ConfigureWidgetsController controller;
+	protected ApplicationMode appMode;
+	protected MapWidgetRegistry widgetRegistry;
+
+	protected MapWidgetInfo widgetInfo;
+	protected WidgetsPanel widgetPanel;
+	protected String widgetId;
+
+	private View promoBannerContainer;
+	private ViewGroup promoBanner;
+	private MenuProvider menuProvider;
+	protected View view;
+
+	private boolean addNewWidgetMode = false;
+	protected boolean isVerticalPanel;
+
+	@NonNull
+	public WidgetType getWidget() {
+		return widgetInfo.widget.getWidgetType();
+	}
+
+	@Override
+	public void onCreate(@Nullable Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		widgetRegistry = app.getOsmandMap().getMapLayers().getMapWidgetRegistry();
+		DialogManager dialogManager = app.getDialogManager();
+		controller = (ConfigureWidgetsController) dialogManager.findController(ConfigureWidgetsController.PROCESS_ID);
+
+		createMenuProvider();
+	}
+
+	private void createMenuProvider() {
+		menuProvider = new MenuProvider() {
+			@Override
+			public void onCreateMenu(@NonNull Menu menu, @NonNull MenuInflater menuInflater) {
+				menu.clear();
+				if (!addNewWidgetMode) {
+					MenuItem deleteAction = menu.add(0, R.id.delete_button, 0, R.string.delete_widget);
+					deleteAction.setIcon(getContentIcon(R.drawable.ic_action_delete_outlined));
+					deleteAction.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
+					deleteAction.setOnMenuItemClickListener(item -> {
+						if (widgetInfo != null) {
+							widgetRegistry.enableDisableWidgetForMode(appMode, widgetInfo, false, true);
+							dismiss();
+						}
+						return true;
+					});
+
+					MenuItem menuAction = menu.add(0, R.id.menu_button, 1, R.string.shared_string_menu);
+					menuAction.setIcon(getContentIcon(R.drawable.ic_overflow_menu_white));
+					menuAction.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
+					menuAction.setOnMenuItemClickListener(item -> {
+						View anchorView = view.findViewById(R.id.menu_button);
+						List<PopUpMenuItem> items = new ArrayList<>();
+
+						items.add(new PopUpMenuItem.Builder(app)
+								.setTitle(app.getString(R.string.shared_string_duplicate))
+								.setIcon(getContentIcon(R.drawable.ic_action_copy))
+								.setOnClickListener(v -> {
+									String duplicateId = createDuplicateWidget();
+									if (duplicateId != null) {
+										showDuplicateAddedSnackbar();
+									}
+								}).create());
+
+						PopUpMenuDisplayData displayData = new PopUpMenuDisplayData();
+						displayData.anchorView = anchorView;
+						displayData.menuItems = items;
+						displayData.nightMode = nightMode;
+						PopUpMenu.show(displayData);
+						return false;
+					});
+				}
+			}
+
+			@Override
+			public boolean onMenuItemSelected(@NonNull MenuItem menuItem) {
+				return false;
+			}
+		};
+	}
+
+	private void showDuplicateAddedSnackbar() {
+		Snackbar snackbar = Snackbar.make(view, R.string.duplacate_widget_added_snackbar, Snackbar.LENGTH_LONG);
+		UiUtilities.setupSnackbar(snackbar, nightMode);
+		snackbar.show();
+	}
+
+	@Nullable
+	private String createDuplicateWidget() {
+		MapActivity mapActivity = getMapActivity();
+		if (mapActivity == null) {
+			return null;
+		}
+
+		int filter = ENABLED_MODE | MATCHING_PANELS_MODE;
+		List<WidgetsPanel> panels = Collections.singletonList(widgetPanel);
+		List<MapWidgetInfo> widgetInfos = new ArrayList<>(widgetRegistry.getWidgetsForPanel(mapActivity, appMode, filter, panels));
+
+		int index = widgetInfos.indexOf(widgetInfo);
+		if (index == -1) {
+			return null;
+		}
+
+		WidgetType widgetType = getWidget();
+		String duplicateId = WidgetType.getDuplicateWidgetId(widgetType);
+		MapWidget duplicateWidget = new MapWidgetsFactory(mapActivity).createMapWidget(duplicateId, widgetType, widgetPanel);
+		WidgetInfoCreator creator = new WidgetInfoCreator(app, appMode);
+		MapWidgetInfo duplicateWidgetInfo = creator.askCreateWidgetInfo(duplicateId, duplicateWidget, widgetType, widgetPanel);
+		if (duplicateWidgetInfo == null) {
+			return null;
+		}
+		settings.CUSTOM_WIDGETS_KEYS.addModeValue(appMode, duplicateId);
+		WidgetState widgetState = widgetInfo.getWidgetState();
+		if (widgetState != null) {
+			widgetState.copyPrefs(appMode, duplicateId);
+		}
+		duplicateWidgetInfo.enableDisableForMode(appMode, true);
+		widgetInfo.widget.copySettings(appMode, duplicateId);
+
+		Map<Integer, List<String>> pagedOrder = new LinkedHashMap<>();
+		for (MapWidgetInfo widgetInfo : widgetInfos) {
+			List<String> orderOfPage = pagedOrder.computeIfAbsent(widgetInfo.pageIndex, k -> new ArrayList<>());
+
+			orderOfPage.add(widgetInfo.key);
+			if (this.widgetInfo.key.equals(widgetInfo.key)) {
+				orderOfPage.add(duplicateId);
+			}
+		}
+
+		widgetPanel.setWidgetsOrder(appMode, new ArrayList<>(pagedOrder.values()), settings);
+
+		MapInfoLayer mapInfoLayer = app.getOsmandMap().getMapLayers().getMapInfoLayer();
+		if (mapInfoLayer != null) {
+			mapInfoLayer.recreateAllControls(mapActivity);
+		}
+
+		return duplicateId;
+	}
+
+	@Nullable
+	@Override
+	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
+		Bundle args = getArguments();
+		if (savedInstanceState != null) {
+			initParams(savedInstanceState);
+		} else if (args != null) {
+			initParams(args);
+		}
+
+		updateNightMode();
+		view = themedInflater.inflate(R.layout.widget_settings_info_fragment, container, false);
+		AndroidUtils.addStatusBarPadding21v(requireMyActivity(), view);
+		promoBannerContainer = view.findViewById(R.id.promo_banner_container);
+		promoBanner = view.findViewById(R.id.promo_banner);
+
+		setupToolbar();
+		setupInfo();
+		setupTopContent(themedInflater, view.findViewById(R.id.top_settings_container));
+		setupMainContent(themedInflater, view.findViewById(R.id.main_settings_container));
+		setupApplyButton();
+		updateStatusBar();
+
+		return view;
+	}
+
+	protected void initParams(@NonNull Bundle bundle) {
+		widgetId = bundle.getString(KEY_WIDGET_ID);
+		appMode = ApplicationMode.valueOfStringKey(bundle.getString(KEY_APP_MODE), settings.getApplicationMode());
+		addNewWidgetMode = bundle.getBoolean(KEY_ADD_MODE, false);
+		isVerticalPanel = bundle.getBoolean(IS_VERTICAL_PANEL_KEY);
+		widgetPanel = WidgetsPanel.valueOf(bundle.getString(KEY_SELECTED_PANEL));
+
+		if (addNewWidgetMode && controller != null) {
+			MapWidgetInfo controllerAddedWidgetInfo = controller.getAddedWidget();
+			if (controllerAddedWidgetInfo != null) {
+				widgetInfo = controllerAddedWidgetInfo;
+			}
+		}
+		if (widgetInfo == null) {
+			widgetInfo = widgetRegistry.getWidgetInfoById(widgetId);
+		}
+
+		if (widgetInfo == null) {
+			dismiss();
+		}
+	}
+
+	private void setupToolbar() {
+		WidgetType widget = getWidget();
+
+		String title = app.getString(widget.titleId);
+		if (widgetInfo.isExternal() && !Algorithms.isEmpty(widgetInfo.getExternalProviderPackage())) {
+			ConnectedApp connectedApp = app.getAidlApi().getConnectedApp(widgetInfo.getExternalProviderPackage());
+			if (connectedApp != null) {
+				AidlMapWidgetWrapper aidlMapWidgetWrapper = connectedApp.getWidgetData(widgetId);
+				title = aidlMapWidgetWrapper.getMenuTitle();
+			}
+		}
+
+		Toolbar toolbar = view.findViewById(R.id.toolbar);
+		toolbar.setNavigationIcon(getContentIcon(addNewWidgetMode ? R.drawable.ic_action_close : AndroidUtils.getNavigationIconResId(app)));
+		toolbar.setNavigationContentDescription(addNewWidgetMode ? R.string.shared_string_close : R.string.access_shared_string_navigate_up);
+		toolbar.setNavigationOnClickListener(v -> {
+			dismiss();
+		});
+		toolbar.addMenuProvider(menuProvider);
+		toolbar.setTitle(title);
+		toolbar.setTitleTextColor(ColorUtilities.getPrimaryTextColor(app, nightMode));
+	}
+
+	protected void dismiss() {
+		requireActivity().getSupportFragmentManager().popBackStack();
+		if (controller != null) {
+			controller.resetAddedWidget();
+		}
+	}
+
+	private void setupInfo() {
+		WidgetType widgetType = widgetInfo.getWidgetType();
+
+		TextView tvDesc = view.findViewById(R.id.widget_description);
+		String externalProviderPackage = widgetInfo.getExternalProviderPackage();
+		if (widgetInfo.isExternal() && externalProviderPackage != null) {
+			ConnectedApp connectedApp = app.getAidlApi().getConnectedApp(externalProviderPackage);
+			if (connectedApp != null) {
+				tvDesc.setText(connectedApp.getName());
+			}
+		} else {
+			tvDesc.setText(widgetType.descId);
+			MapActivity mapActivity = getMapActivity();
+			if (!widgetType.isPurchased(app) && mapActivity != null) {
+				AndroidUiHelper.updateVisibility(promoBannerContainer, true);
+				WidgetPromoBanner banner = new WidgetPromoBanner(mapActivity, widgetType, false);
+				promoBanner.addView(banner.build());
+			}
+		}
+	}
+
+	protected void setupTopContent(@NonNull LayoutInflater themedInflater, @NonNull ViewGroup container) {
+
+	}
+
+	protected void setupMainContent(@NonNull LayoutInflater themedInflater, @NonNull ViewGroup container) {
+		AndroidUiHelper.updateVisibility(view.findViewById(R.id.main_container), false);
+	}
+
+	private void setupApplyButton() {
+		View buttonsContainer = view.findViewById(R.id.buttons_container);
+		if (addNewWidgetMode) {
+			buttonsContainer.setBackgroundColor(ColorUtilities.getListBgColor(app, nightMode));
+			DialogButton applyButton = view.findViewById(R.id.dismiss_button);
+			applyButton.setOnClickListener(v -> {
+				Fragment target = getTargetFragment();
+				if (target instanceof WidgetsConfigurationChangeListener configurationChangeListener) {
+					if (addNewWidgetMode && widgetInfo != null) {
+						configurationChangeListener.onWidgetAdded(widgetInfo);
+					}
+				}
+				dismiss();
+			});
+			applyButton.setButtonType(DialogButtonType.PRIMARY);
+			applyButton.setTitleId(addNewWidgetMode ? R.string.add_widget : R.string.shared_string_apply);
+		}
+		AndroidUiHelper.updateVisibility(view.findViewById(R.id.apply_button_container), addNewWidgetMode);
+	}
+
+	protected void applySettings() {
+
+	}
+
+	@Override
+	public void onDestroy() {
+		super.onDestroy();
+		applySettings();
+		MapInfoLayer mapInfoLayer = app.getOsmandMap().getMapLayers().getMapInfoLayer();
+		if (mapInfoLayer != null) {
+			mapInfoLayer.recreateControls();
+		}
+		Fragment target = getTargetFragment();
+		if (target instanceof WidgetsConfigurationChangeListener) {
+			((WidgetsConfigurationChangeListener) target).onWidgetsConfigurationChanged();
+		}
+	}
+
+	@Override
+	public void onSaveInstanceState(@NonNull Bundle outState) {
+		super.onSaveInstanceState(outState);
+		outState.putString(KEY_APP_MODE, appMode.getStringKey());
+		outState.putString(KEY_WIDGET_ID, widgetId);
+		outState.putBoolean(KEY_ADD_MODE, addNewWidgetMode);
+		outState.putBoolean(IS_VERTICAL_PANEL_KEY, isVerticalPanel);
+	}
+
+	@Override
+	public int getStatusBarColorId() {
+		AndroidUiHelper.setStatusBarContentColor(getView(), nightMode);
+		return nightMode ? R.color.status_bar_main_dark : R.color.activity_background_color_light;
+	}
+
+	public boolean getContentStatusBarNightMode() {
+		return nightMode;
+	}
+
+	@NonNull
+	protected Drawable getPressedStateDrawable() {
+		int activeColor = ColorUtilities.getActiveColor(app, nightMode);
+		return UiUtilities.getColoredSelectableDrawable(app, activeColor);
+	}
+
+	@Nullable
+	protected MapActivity getMapActivity() {
+		Activity activity = getActivity();
+		return activity != null ? ((MapActivity) activity) : null;
+	}
+
+	private static void showFragment(@NonNull FragmentManager manager, @NonNull WidgetInfoBaseFragment fragment,
+	                                 @Nullable Fragment target, @NonNull ApplicationMode appMode, @NonNull String widgetId, @NonNull WidgetsPanel widgetsPanel, boolean addNewWidgetMode) {
+		String tag = fragment.getClass().getSimpleName();
+		if (AndroidUtils.isFragmentCanBeAdded(manager, tag, true)) {
+			Bundle args = new Bundle();
+			args.putString(KEY_WIDGET_ID, widgetId);
+			args.putString(KEY_APP_MODE, appMode.getStringKey());
+			args.putBoolean(KEY_ADD_MODE, addNewWidgetMode);
+			args.putString(KEY_SELECTED_PANEL, widgetsPanel.name());
+
+			fragment.setArguments(args);
+			fragment.setTargetFragment(target, 0);
+
+			manager.beginTransaction()
+					.add(R.id.fragmentContainer, fragment, tag)
+					.addToBackStack(tag)
+					.commitAllowingStateLoss();
+		}
+	}
+
+	public static void showFragment(@NonNull FragmentManager manager, @NonNull WidgetInfoBaseFragment fragment,
+	                                @Nullable Fragment target, @NonNull ApplicationMode appMode, @NonNull String widgetId, @NonNull WidgetsPanel widgetsPanel) {
+		showFragment(manager, fragment, target, appMode, widgetId, widgetsPanel, false);
+
+	}
+
+	public static void showAddWidgetFragment(@NonNull FragmentManager manager, @NonNull WidgetInfoBaseFragment fragment,
+	                                         @Nullable Fragment target, @NonNull ApplicationMode appMode, @NonNull String widgetId, @NonNull WidgetsPanel widgetsPanel) {
+		showFragment(manager, fragment, target, appMode, widgetId, widgetsPanel, true);
+	}
+
+
+}
\ No newline at end of file
