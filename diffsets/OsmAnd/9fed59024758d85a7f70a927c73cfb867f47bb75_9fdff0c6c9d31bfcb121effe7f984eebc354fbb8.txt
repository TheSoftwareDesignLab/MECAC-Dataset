diff --git a/OsmAnd/res/layout/fragment_external_input_device_type.xml b/OsmAnd/res/layout/fragment_external_input_device_type.xml
index 50dec39a1f1..57510a5157f 100644
--- a/OsmAnd/res/layout/fragment_external_input_device_type.xml
+++ b/OsmAnd/res/layout/fragment_external_input_device_type.xml
@@ -12,7 +12,7 @@
 		android:layout_width="match_parent"
 		android:layout_height="wrap_content">
 
-		<include layout="@layout/global_preference_toolbar" />
+		<include layout="@layout/preference_toolbar_with_action_button" />
 
 	</com.google.android.material.appbar.AppBarLayout>
 
diff --git a/OsmAnd/res/layout/list_item_external_input_device_type.xml b/OsmAnd/res/layout/list_item_external_input_device_type.xml
index dd9c0bf3ea1..ac709347ab4 100644
--- a/OsmAnd/res/layout/list_item_external_input_device_type.xml
+++ b/OsmAnd/res/layout/list_item_external_input_device_type.xml
@@ -18,6 +18,7 @@
 			android:layout_width="wrap_content"
 			android:layout_height="wrap_content"
 			android:layout_marginHorizontal="@dimen/content_padding"
+			android:layout_marginBottom="1dp"
 			android:layout_gravity="center_vertical"
 			android:background="@null"
 			android:clickable="false"
@@ -27,12 +28,12 @@
 		<LinearLayout
 			android:layout_width="match_parent"
 			android:layout_height="match_parent"
+			android:layout_marginStart="@dimen/content_padding_small"
 			android:orientation="vertical">
 
 			<LinearLayout
 				android:layout_width="match_parent"
 				android:layout_height="0dp"
-				android:layout_marginStart="@dimen/content_padding"
 				android:layout_weight="1"
 				android:orientation="horizontal">
 
@@ -52,6 +53,7 @@
 					android:id="@+id/overflow_menu"
 					android:layout_width="@dimen/acceptable_touch_radius"
 					android:layout_height="@dimen/acceptable_touch_radius"
+					android:layout_marginEnd="@dimen/list_item_button_padding"
 					android:layout_gravity="center_vertical">
 
 					<androidx.appcompat.widget.AppCompatImageButton
@@ -61,6 +63,8 @@
 						android:layout_gravity="center"
 						android:layout_margin="@dimen/content_padding"
 						android:duplicateParentState="true"
+						android:clickable="false"
+						android:focusable="false"
 						android:tint="?attr/default_icon_color"
 						app:srcCompat="@drawable/ic_overflow_menu_dark" />
 
diff --git a/OsmAnd/res/values/strings.xml b/OsmAnd/res/values/strings.xml
index 8528f34cc2b..200b6b1d5b4 100644
--- a/OsmAnd/res/values/strings.xml
+++ b/OsmAnd/res/values/strings.xml
@@ -10,6 +10,8 @@
 	- For wording and consistency, please note https://docs.osmand.net/docs/technical/contributions/translating-osmand
 	Thx - Hardy
 -->
+    <string name="remove_type_q">Are you sure you want to remove \"%1$s\" type?</string>
+    <string name="add_new_type">Add new type</string>
     <string name="enable_to_use_external_input_device">Enable to use external input device with OsmAnd</string>
     <string name="key_bindings">Key bindings</string>
     <string name="external_input_device_title">External input device</string>
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/InputDeviceHelper.java b/OsmAnd/src/net/osmand/plus/keyevent/InputDeviceHelper.java
index 0118e1bc87a..9a60d75166e 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/InputDeviceHelper.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/InputDeviceHelper.java
@@ -82,24 +82,50 @@ public void selectInputDevice(@NonNull ApplicationMode appMode, @NonNull String
 	}
 
 	@NonNull
-	public InputDeviceProfile createAndSaveCustomDevice(@NonNull String newName) {
-		return saveCustomDevice(makeCustomDevice(newName));
+	public void createAndSaveCustomDevice(@NonNull String newName) {
+		saveCustomDevice(makeCustomDevice(newName));
 	}
 
-	public InputDeviceProfile createAndSaveDeviceDuplicate(@NonNull InputDeviceProfile device) {
-		return saveCustomDevice(makeCustomDeviceDuplicate(device));
+	public void createAndSaveDeviceDuplicate(@NonNull InputDeviceProfile device) {
+		saveCustomDevice(makeCustomDeviceDuplicate(device));
+	}
+
+	public void renameCustomDevice(@NonNull CustomInputDeviceProfile device, @NonNull String newName) {
+		device.setCustomName(newName);
+		syncSettings();
+		notifyListeners();
 	}
 
 	private InputDeviceProfile makeCustomDeviceDuplicate(@NonNull InputDeviceProfile device) {
 		String prevName = device.toHumanString(app);
-		String uniqueName = prevName;
-		int index = 0;
-		while (hasNameDuplicate(uniqueName)) {
-			uniqueName = prevName + " " + ++index;
-		}
+		String uniqueName = makeUniqueName(prevName);
 		return makeCustomDevice(uniqueName, device);
 	}
 
+	private String makeUniqueName(@NonNull String oldName) {
+		int suffix = 0;
+		int i = oldName.length() - 1;
+		do {
+			try {
+				if (oldName.charAt(i) == ' ' || oldName.charAt(i) == '-') {
+					throw new NumberFormatException();
+				}
+				suffix = Integer.parseInt(oldName.substring(i));
+			} catch (NumberFormatException e) {
+				break;
+			}
+			i--;
+		} while (i >= 0);
+		String newName;
+		String divider = suffix == 0 ? " " : "";
+		do {
+			suffix++;
+			newName = oldName.substring(0, i + 1) + divider + suffix;
+		}
+		while (hasNameDuplicate(newName));
+		return newName;
+	}
+
 	@NonNull
 	private InputDeviceProfile makeCustomDevice(@NonNull String newName) {
 		return makeCustomDevice(newName, KEYBOARD);
@@ -122,12 +148,11 @@ private InputDeviceProfile makeCustomDevice(
 		return customDevice;
 	}
 
-	private InputDeviceProfile saveCustomDevice(@NonNull InputDeviceProfile device) {
+	private void saveCustomDevice(@NonNull InputDeviceProfile device) {
 		customDevices.add(device);
 		cachedDevices.put(device.getId(), device);
 		syncSettings();
 		notifyListeners();
-		return device;
 	}
 
 	public void removeCustomDevice(@NonNull String deviceId) {
@@ -175,7 +200,7 @@ public String getSelectedDeviceId(@NonNull ApplicationMode appMode) {
 
 	public boolean hasNameDuplicate(@NonNull String newName) {
 		for (InputDeviceProfile device : getAvailableDevices()) {
-			if (Algorithms.objectEquals(device.toHumanString(app), newName)) {
+			if (Algorithms.objectEquals(device.toHumanString(app).trim(), newName.trim())) {
 				return true;
 			}
 		}
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/devices/CustomInputDeviceProfile.java b/OsmAnd/src/net/osmand/plus/keyevent/devices/CustomInputDeviceProfile.java
index f20a6bd1f95..5ea37e5c9fd 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/devices/CustomInputDeviceProfile.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/devices/CustomInputDeviceProfile.java
@@ -20,7 +20,7 @@
 public class CustomInputDeviceProfile extends InputDeviceProfile {
 
 	private final String customId;
-	private final String customName;
+	private String customName;
 
 	private final Map<Integer, String> mappedCommandIds = new HashMap<>();
 
@@ -55,6 +55,10 @@ protected void collectCommands() {
 		}
 	}
 
+	public void setCustomName(@NonNull String customName) {
+		this.customName = customName;
+	}
+
 	@NonNull
 	@Override
 	public String getId() {
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenAdapter.java b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenAdapter.java
index 73104cd97ca..9b43628444f 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenAdapter.java
@@ -127,7 +127,7 @@ private void showOverflowMenu(@NonNull View anchorView, @NonNull InputDeviceProf
 				.setIcon(getContentIcon(R.drawable.ic_action_delete_outlined))
 				.showTopDivider(true)
 				.setOnClickListener(v -> {
-					controller.removeDevice(device);
+					controller.askRemoveDevice(device);
 				}).create());
 
 		PopUpMenuDisplayData displayData = new PopUpMenuDisplayData();
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenController.java b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenController.java
index 28187b29ec6..9810c6af445 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenController.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/ScreenController.java
@@ -1,22 +1,38 @@
 package net.osmand.plus.keyevent.ui.devicetype;
 
+import android.widget.EditText;
+
 import androidx.annotation.NonNull;
+import androidx.fragment.app.FragmentActivity;
 
+import net.osmand.CallbackWithObject;
 import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.R;
 import net.osmand.plus.keyevent.InputDeviceHelper;
+import net.osmand.plus.keyevent.devices.CustomInputDeviceProfile;
 import net.osmand.plus.keyevent.devices.InputDeviceProfile;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.widgets.alert.AlertDialogData;
+import net.osmand.plus.widgets.alert.AlertDialogExtra;
+import net.osmand.plus.widgets.alert.CustomAlert;
+import net.osmand.util.Algorithms;
 
 import java.util.ArrayList;
 import java.util.List;
 
 class ScreenController {
 
+	private final OsmandApplication app;
 	private final ApplicationMode appMode;
 	private final InputDeviceHelper deviceHelper;
+	private final boolean usedOnMap;
 
-	public ScreenController(@NonNull OsmandApplication app, @NonNull ApplicationMode appMode) {
+	public ScreenController(@NonNull OsmandApplication app,
+	                        @NonNull ApplicationMode appMode, boolean usedOnMap) {
+		this.app = app;
 		this.appMode = appMode;
+		this.usedOnMap = usedOnMap;
 		this.deviceHelper = app.getInputDeviceHelper();
 	}
 
@@ -36,16 +52,72 @@ public void selectDevice(@NonNull InputDeviceProfile device) {
 		deviceHelper.selectInputDevice(appMode, device.getId());
 	}
 
+	public void askAddNewCustomDevice() {
+		String title = app.getString(R.string.add_new_type);
+		showEnterNameDialog(title, "", newName -> {
+			deviceHelper.createAndSaveCustomDevice(newName);
+			return true;
+		});
+	}
+
 	public void askRenameDevice(@NonNull InputDeviceProfile device) {
+		String title = app.getString(R.string.shared_string_rename);
+		showEnterNameDialog(title, device.toHumanString(app), newName -> {
+			if (device instanceof CustomInputDeviceProfile) {
+				deviceHelper.renameCustomDevice((CustomInputDeviceProfile) device, newName);
+			}
+			return true;
+		});
+	}
 
+	private void showEnterNameDialog(@NonNull String title, @NonNull String oldName,
+	                                 @NonNull CallbackWithObject<String> callback) {
+		FragmentActivity activity = app.getKeyEventHelper().getMapActivity();
+		if (activity == null) return;
+
+		boolean nightMode = isNightMode();
+		AlertDialogData dialogData = new AlertDialogData(activity, nightMode)
+				.setTitle(title)
+				.setControlsColor(ColorUtilities.getActiveColor(activity, nightMode))
+				.setNegativeButton(R.string.shared_string_cancel, null);
+		dialogData.setPositiveButton(R.string.shared_string_apply, (dialog, which) -> {
+			Object extra = dialogData.getExtra(AlertDialogExtra.EDIT_TEXT);
+			if (extra instanceof EditText) {
+				EditText editText = (EditText) extra;
+				String newName = editText.getText().toString();
+				if (Algorithms.isBlank(newName)) {
+					app.showToastMessage(R.string.empty_filename);
+				} else {
+					if (deviceHelper.hasNameDuplicate(newName)) {
+						app.showToastMessage(R.string.message_name_is_already_exists);
+					} else {
+						callback.processResult(newName.trim());
+					}
+				}
+			}
+		});
+		String caption = activity.getString(R.string.shared_string_name);
+		CustomAlert.showInput(dialogData, activity, oldName, caption);
 	}
 
 	public void duplicateDevice(@NonNull InputDeviceProfile device) {
-
+		deviceHelper.createAndSaveDeviceDuplicate(device);
 	}
 
-	public void removeDevice(@NonNull InputDeviceProfile device) {
-
+	public void askRemoveDevice(@NonNull InputDeviceProfile device) {
+		FragmentActivity activity = app.getKeyEventHelper().getMapActivity();
+		if (activity == null) return;
+
+		AlertDialogData dialogData = new AlertDialogData(activity, isNightMode())
+				.setTitle(R.string.shared_string_remove)
+				.setNegativeButton(R.string.shared_string_cancel, null)
+				.setPositiveButtonTextColor(ColorUtilities.getColor(app, R.color.color_warning))
+				.setPositiveButton(R.string.shared_string_delete, (dialog, which) -> {
+					deviceHelper.removeCustomDevice(device.getId());
+				});
+		String typeName = device.toHumanString(app);
+		String message = app.getString(R.string.remove_type_q, typeName);
+		CustomAlert.showSimpleMessage(dialogData, message);
 	}
 
 	public boolean isSelected(@NonNull InputDeviceProfile device) {
@@ -55,4 +127,8 @@ public boolean isSelected(@NonNull InputDeviceProfile device) {
 	public boolean isCustom(@NonNull InputDeviceProfile device) {
 		return deviceHelper.isCustomDevice(device);
 	}
+
+	private boolean isNightMode() {
+		return app.getDaynightHelper().isNightMode(usedOnMap);
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/SelectInputDeviceFragment.java b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/SelectInputDeviceFragment.java
index db531d7f36e..74a2ee1132c 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/SelectInputDeviceFragment.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/ui/devicetype/SelectInputDeviceFragment.java
@@ -21,6 +21,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.base.BaseOsmAndFragment;
+import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.keyevent.InputDeviceHelper;
 import net.osmand.plus.keyevent.InputDeviceHelperListener;
 import net.osmand.plus.settings.backend.ApplicationMode;
@@ -43,7 +44,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		Bundle arguments = getArguments();
 		String appModeKey = arguments != null ? arguments.getString(APP_MODE_KEY) : "";
 		appMode = ApplicationMode.valueOfStringKey(appModeKey, settings.getApplicationMode());
-		controller = new ScreenController(app, appMode);
+		controller = new ScreenController(app, appMode, isUsedOnMap());
 		deviceHelper = app.getInputDeviceHelper();
 	}
 
@@ -66,19 +67,27 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 
 	private void setupToolbar(@NonNull View view) {
 		Toolbar toolbar = view.findViewById(R.id.toolbar);
-		ViewCompat.setElevation(view.findViewById(R.id.appbar), 5.0f);
-
-		TextView toolbarTitle = toolbar.findViewById(R.id.toolbar_title);
-		toolbarTitle.setText(R.string.shared_string_type);
 
 		ImageView closeButton = toolbar.findViewById(R.id.close_button);
-		closeButton.setImageDrawable(getIcon(AndroidUtils.getNavigationIconResId(view.getContext())));
+		closeButton.setImageResource(R.drawable.ic_action_close);
 		closeButton.setOnClickListener(v -> {
 			FragmentActivity activity = getActivity();
 			if (activity != null) {
 				activity.onBackPressed();
 			}
 		});
+
+		TextView title = toolbar.findViewById(R.id.toolbar_title);
+		title.setText(getString(R.string.shared_string_type));
+		toolbar.findViewById(R.id.toolbar_subtitle).setVisibility(View.GONE);
+
+		View actionButton = toolbar.findViewById(R.id.action_button);
+		ImageView actionButtonImage = toolbar.findViewById(R.id.action_button_icon);
+		actionButtonImage.setImageDrawable(getContentIcon(R.drawable.ic_action_add_no_bg));
+		actionButton.setOnClickListener(v -> {
+			controller.askAddNewCustomDevice();
+		});
+		ViewCompat.setElevation(view.findViewById(R.id.appbar), 5.0f);
 	}
 
 	@Override
@@ -117,7 +126,8 @@ private MapActivity getMapActivity() {
 
 	@Override
 	public int getStatusBarColorId() {
-		return ColorUtilities.getStatusBarColorId(nightMode);
+		AndroidUiHelper.setStatusBarContentColor(getView(), nightMode);
+		return ColorUtilities.getActivityBgColorId(nightMode);
 	}
 
 	public static void showInstance(@NonNull FragmentManager manager,
