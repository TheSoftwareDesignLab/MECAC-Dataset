diff --git a/OsmAnd/src/net/osmand/plus/GpxSelectionHelper.java b/OsmAnd/src/net/osmand/plus/GpxSelectionHelper.java
index b26783cd1dc..b0f88483070 100644
--- a/OsmAnd/src/net/osmand/plus/GpxSelectionHelper.java
+++ b/OsmAnd/src/net/osmand/plus/GpxSelectionHelper.java
@@ -392,7 +392,7 @@ public SelectedGpxFile getSelectedCurrentRecordingTrack() {
 	public void setGpxFileToDisplay(GPXFile... gpxs) {
 		// special case for gpx current route
 		for (GPXFile gpx : gpxs) {
-			selectGpxFileImpl(gpx, true, false);
+			selectGpxFileImpl(gpx, true, false, true);
 		}
 		saveCurrentSelections();
 	}
@@ -458,7 +458,7 @@ private void saveCurrentSelections() {
 		app.getSettings().SELECTED_GPX.set(ar.toString());
 	}
 
-	private SelectedGpxFile selectGpxFileImpl(GPXFile gpx, boolean show, boolean notShowNavigationDialog) {
+	private SelectedGpxFile selectGpxFileImpl(GPXFile gpx, boolean show, boolean notShowNavigationDialog, boolean syncGroup) {
 		boolean displayed;
 		SelectedGpxFile sf;
 		if (gpx != null && gpx.showCurrentTrack) {
@@ -482,12 +482,18 @@ private SelectedGpxFile selectGpxFileImpl(GPXFile gpx, boolean show, boolean not
 				selectedGPXFiles.remove(sf);
 			}
 		}
-		syncGpx(gpx, true);
+		if (syncGroup) {
+			syncGpx(gpx, true);
+		}
 		return sf;
 	}
 
 	public SelectedGpxFile selectGpxFile(GPXFile gpx, boolean show, boolean notShowNavigationDialog) {
-		SelectedGpxFile sf = selectGpxFileImpl(gpx, show, notShowNavigationDialog);
+		return selectGpxFile(gpx, show, notShowNavigationDialog, true);
+	}
+
+	public SelectedGpxFile selectGpxFile(GPXFile gpx, boolean show, boolean notShowNavigationDialog, boolean syncGroup) {
+		SelectedGpxFile sf = selectGpxFileImpl(gpx, show, notShowNavigationDialog, syncGroup);
 		saveCurrentSelections();
 		return sf;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/MapMarkersHelper.java b/OsmAnd/src/net/osmand/plus/MapMarkersHelper.java
index 67471ea0ecf..7e999213d71 100644
--- a/OsmAnd/src/net/osmand/plus/MapMarkersHelper.java
+++ b/OsmAnd/src/net/osmand/plus/MapMarkersHelper.java
@@ -54,6 +54,10 @@ public interface MapMarkerChangedListener {
 		void onMapMarkersChanged();
 	}
 
+	public interface OnGroupSyncedListener {
+		void onSyncDone();
+	}
+
 	public static class MapMarker implements LocationPoint {
 		private static int[] colors;
 
@@ -452,14 +456,19 @@ public void syncAllGroups() {
 	}
 
 	public void syncGroup(MarkersSyncGroup group) {
-		syncGroup(group, true);
+		syncGroup(group, true, null);
 	}
 
 	public void syncGroup(MarkersSyncGroup group, boolean enabled) {
-		if (!isGroupSynced(group.getId())) {
-			return;
-		}
-		SyncGroupTask syncGroupTask = new SyncGroupTask(group, enabled);
+		syncGroup(group, enabled, null);
+	}
+
+	public void syncGroup(MarkersSyncGroup group, OnGroupSyncedListener groupSyncedListener) {
+		syncGroup(group, true, groupSyncedListener);
+	}
+
+	private void syncGroup(MarkersSyncGroup group, boolean enabled, OnGroupSyncedListener groupSyncedListener) {
+		SyncGroupTask syncGroupTask = new SyncGroupTask(group, enabled, groupSyncedListener);
 		syncGroupTask.executeOnExecutor(executorService);
 	}
 
@@ -467,25 +476,37 @@ private class SyncGroupTask extends AsyncTask<Void, Void, Void> {
 
 		private MarkersSyncGroup group;
 		private boolean enabled;
+		private OnGroupSyncedListener listener;
 
-		SyncGroupTask(MarkersSyncGroup group, boolean enabled) {
+		SyncGroupTask(MarkersSyncGroup group, boolean enabled, OnGroupSyncedListener listener) {
 			this.group = group;
 			this.enabled = enabled;
+			this.listener = listener;
 		}
 
 		@Override
 		protected Void doInBackground(Void... voids) {
+			runGroupSynchronization();
+			onGroupSynced();
+			return null;
+		}
+
+		private void runGroupSynchronization() {
+			if (!isGroupSynced(group.getId())) {
+				return;
+			}
+
 			List<MapMarker> dbMarkers = markersDbHelper.getMarkersFromGroup(group);
 
 			if (group.getType() == MarkersSyncGroup.FAVORITES_TYPE) {
 				FavoriteGroup favGroup = ctx.getFavorites().getGroup(group.getName());
 				if (favGroup == null) {
-					return null;
+					return;
 				}
 				if (!favGroup.visible) {
 					removeActiveMarkersFromSyncGroup(group.getId());
 					removeActiveMarkersFromGroup(group.getId());
-					return null;
+					return;
 				}
 				if (group.getColor() == -1) {
 					group.setColor(favGroup.color);
@@ -500,7 +521,7 @@ protected Void doInBackground(Void... voids) {
 				GpxSelectionHelper gpxHelper = ctx.getSelectedGpxHelper();
 				File file = new File(group.getId());
 				if (!file.exists()) {
-					return null;
+					return;
 				}
 
 				SelectedGpxFile selectedGpxFile = gpxHelper.getSelectedFileByPath(group.getId());
@@ -508,7 +529,7 @@ protected Void doInBackground(Void... voids) {
 				if (gpx == null) {
 					removeActiveMarkersFromSyncGroup(group.getId());
 					removeActiveMarkersFromGroup(group.getId());
-					return null;
+					return;
 				}
 
 				List<WptPt> gpxPoints = new LinkedList<>(gpx.getPoints());
@@ -520,7 +541,17 @@ protected Void doInBackground(Void... voids) {
 
 				removeOldMarkersIfNeeded(dbMarkers);
 			}
-			return null;
+		}
+
+		private void onGroupSynced() {
+			if (listener != null) {
+				ctx.runInUIThread(new Runnable() {
+					@Override
+					public void run() {
+						listener.onSyncDone();
+					}
+				});
+			}
 		}
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/AddGroupBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/AddGroupBottomSheetDialogFragment.java
index 84757059f47..d2beab227d5 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/AddGroupBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/AddGroupBottomSheetDialogFragment.java
@@ -1,5 +1,6 @@
 package net.osmand.plus.mapmarkers;
 
+import android.app.Dialog;
 import android.os.AsyncTask;
 import android.os.Bundle;
 import android.support.annotation.Nullable;
@@ -25,7 +26,6 @@ public abstract class AddGroupBottomSheetDialogFragment extends MenuBottomSheetD
 	protected View mainView;
 	protected GroupsAdapter adapter;
 	protected MapMarkersHelper mapMarkersHelper;
-	private CreateGpxGroupTask createGpxGroupTask;
 
 	public void setListener(AddGroupListener listener) {
 		this.listener = listener;
@@ -43,6 +43,14 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa
 		final int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		mainView = View.inflate(new ContextThemeWrapper(getContext(), themeRes), R.layout.fragment_marker_add_group_bottom_sheet_dialog, container);
 
+		setupHeightAndBackground(mainView, R.id.groups_recycler_view);
+
+		return mainView;
+	}
+
+	@Override
+	public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
+		super.onViewCreated(view, savedInstanceState);
 		final RecyclerView recyclerView = mainView.findViewById(R.id.groups_recycler_view);
 		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
 		createAdapter();
@@ -53,8 +61,18 @@ public void onItemClick(View view) {
 				if (position == RecyclerView.NO_POSITION) {
 					return;
 				}
-				createGpxGroupTask = new CreateGpxGroupTask();
-				createGpxGroupTask.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, position);
+				mainView.findViewById(R.id.groups_recycler_view).setVisibility(View.GONE);
+				mainView.findViewById(R.id.progress_bar).setVisibility(View.VISIBLE);
+				MarkersSyncGroup group = createMapMarkersSyncGroup(position);
+				mapMarkersHelper.addMarkersSyncGroup(group);
+				mapMarkersHelper.syncGroup(group, new MapMarkersHelper.OnGroupSyncedListener() {
+					@Override
+					public void onSyncDone() {
+						if (listener != null) {
+							listener.onGroupAdded();
+						}
+					}
+				});
 			}
 		});
 		recyclerView.setAdapter(adapter);
@@ -65,19 +83,15 @@ public void onClick(View view) {
 				dismiss();
 			}
 		});
-
-		setupHeightAndBackground(mainView, R.id.groups_recycler_view);
-
-		return mainView;
 	}
 
 	@Override
 	public void onDestroyView() {
-		super.onDestroyView();
-		if (createGpxGroupTask != null) {
-			createGpxGroupTask.cancel(true);
-			createGpxGroupTask = null;
+		Dialog dialog = getDialog();
+		if (dialog != null && getRetainInstance()) {
+			dialog.setDismissMessage(null);
 		}
+		super.onDestroyView();
 	}
 
 	protected abstract void createAdapter();
@@ -87,32 +101,4 @@ public void onDestroyView() {
 	public interface AddGroupListener {
 		void onGroupAdded();
 	}
-
-	public class CreateGpxGroupTask extends AsyncTask<Integer, Void, MarkersSyncGroup> {
-
-		private ProgressBar progressBar = (ProgressBar) mainView.findViewById(R.id.progress_bar);;
-		private RecyclerView recyclerView = (RecyclerView) mainView.findViewById(R.id.groups_recycler_view);
-
-		@Override
-		protected void onPreExecute() {
-			recyclerView.setVisibility(View.GONE);
-			progressBar.setVisibility(View.VISIBLE);
-		}
-
-		@Override
-		protected MarkersSyncGroup doInBackground(Integer... integers) {
-			return createMapMarkersSyncGroup(integers[0]);
-		}
-
-		@Override
-		protected void onPostExecute(MarkersSyncGroup group) {
-			createGpxGroupTask = null;
-			mapMarkersHelper.addMarkersSyncGroup(group);
-			mapMarkersHelper.syncGroup(group);
-			if (listener != null) {
-				listener.onGroupAdded();
-			}
-			dismiss();
-		}
-	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/AddTracksGroupBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/AddTracksGroupBottomSheetDialogFragment.java
index 5609ab4b5ef..6ca9ae0a9d6 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/AddTracksGroupBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/AddTracksGroupBottomSheetDialogFragment.java
@@ -32,11 +32,12 @@
 public class AddTracksGroupBottomSheetDialogFragment extends AddGroupBottomSheetDialogFragment {
 
 	private ProcessGpxTask asyncProcessor;
-	private List<GpxDataItem> gpxList = new ArrayList<>();
+	private List<GpxDataItem> gpxList;
 	private GpxSelectionHelper gpxSelectionHelper;
 
 	@Override
 	public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
+		gpxList = new ArrayList<>();
 		super.onViewCreated(view, savedInstanceState);
 		gpxSelectionHelper = getMyApplication().getSelectedGpxHelper();
 		asyncProcessor = new ProcessGpxTask();
@@ -55,7 +56,7 @@ public MarkersSyncGroup createMapMarkersSyncGroup(int position) {
 		SelectedGpxFile selectedGpxFile = gpxSelectionHelper.getSelectedFileByPath(gpx.getAbsolutePath());
 		if (selectedGpxFile == null) {
 			GPXFile res = GPXUtilities.loadGPXFile(getContext(), gpx);
-			gpxSelectionHelper.selectGpxFile(res, true, false);
+			gpxSelectionHelper.selectGpxFile(res, true, false, false);
 		}
 		return new MarkersSyncGroup(gpx.getAbsolutePath(), AndroidUtils.trimExtension(gpx.getName()), MarkersSyncGroup.GPX_TYPE);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
index 333d05f833d..375ccd8d849 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
@@ -295,6 +295,7 @@ private void openAddGroupMenu() {
 	private void openAddGroupMenu(AddGroupBottomSheetDialogFragment fragment) {
 		fragment.setListener(createAddGroupListener());
 		fragment.setUsedOnMap(false);
+		fragment.setRetainInstance(true);
 		fragment.show(getChildFragmentManager(), AddGroupBottomSheetDialogFragment.TAG);
 	}
 
