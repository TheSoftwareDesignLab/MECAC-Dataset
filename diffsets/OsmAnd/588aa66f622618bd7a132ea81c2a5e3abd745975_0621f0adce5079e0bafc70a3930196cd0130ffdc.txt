diff --git a/OsmAnd/src/net/osmand/plus/AppInitializer.java b/OsmAnd/src/net/osmand/plus/AppInitializer.java
index 5b425729ec1..dbdfdcb1a1d 100644
--- a/OsmAnd/src/net/osmand/plus/AppInitializer.java
+++ b/OsmAnd/src/net/osmand/plus/AppInitializer.java
@@ -57,7 +57,7 @@
 import net.osmand.plus.settings.backend.backup.FileSettingsHelper;
 import net.osmand.plus.views.OsmandMap;
 import net.osmand.plus.views.corenative.NativeCoreContext;
-import net.osmand.plus.voice.BaseCommandPlayer;
+import net.osmand.plus.voice.CommandPlayer;
 import net.osmand.plus.voice.CommandPlayerException;
 import net.osmand.plus.wikivoyage.data.TravelDbHelper;
 import net.osmand.plus.wikivoyage.data.TravelHelper;
@@ -575,7 +575,7 @@ public synchronized void initVoiceDataInDifferentThread(@NonNull final Activity
 				if (app.player != null) {
 					app.player.clear();
 				}
-				app.player = BaseCommandPlayer.createCommandPlayer(app, applicationMode, voiceProvider);
+				app.player = CommandPlayer.createCommandPlayer(app, applicationMode, voiceProvider);
 				app.getRoutingHelper().getVoiceRouter().setPlayer(app.player);
 			} catch (CommandPlayerException e) {
 				app.showToastMessage(e.getError());
diff --git a/OsmAnd/src/net/osmand/plus/development/TestVoiceActivity.java b/OsmAnd/src/net/osmand/plus/development/TestVoiceActivity.java
index b98b3fc6858..5bc774a2b7e 100644
--- a/OsmAnd/src/net/osmand/plus/development/TestVoiceActivity.java
+++ b/OsmAnd/src/net/osmand/plus/development/TestVoiceActivity.java
@@ -14,7 +14,6 @@
 import android.widget.LinearLayout.LayoutParams;
 import android.widget.ScrollView;
 import android.widget.TextView;
-import android.widget.Toast;
 
 import androidx.appcompat.app.AlertDialog;
 
@@ -23,9 +22,8 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.OsmandActionBarActivity;
 import net.osmand.plus.routing.data.StreetName;
-import net.osmand.plus.voice.BaseCommandPlayer;
-import net.osmand.plus.voice.JsCommandBuilder;
 import net.osmand.plus.voice.CommandPlayer;
+import net.osmand.plus.voice.JsCommandBuilder;
 import net.osmand.plus.voice.JsTtsCommandPlayer;
 
 import java.util.HashMap;
@@ -142,7 +140,7 @@ private String getVoiceSystemInfo() {
 		v += "\n \u25CF TTS voice actually used: " + JsTtsCommandPlayer.getTtsVoiceUsed();
 
 		if (stream == 0) {
-			v += "\n \u25CF BT SCO: " + BaseCommandPlayer.getBluetoothScoStatus();
+			v += "\n \u25CF BT SCO: " + CommandPlayer.getBluetoothScoStatus();
 		} else {
 			v += "\n \u25CF BT SCO: The current app profile is not set to use 'Phone call audio'.";
 		}
@@ -167,26 +165,26 @@ private void addButtons(final LinearLayout ll, CommandPlayer p) {
 		addButton(ll, "\u25BA (2.4)  Route recalculated 125900m, 92700sec (25:45)", builder(p).routeRecalculated(125900, 92700) );
 
 		addButton(ll, "All turn types: prepareTurn, makeTurnIn, turn, takeExit, takeExitIn:", builder(p));
-		addButton(ll, "\u25BA (3.1)  After 1520m turn slightly left", builder(p).prepareTurn(BaseCommandPlayer.A_LEFT_SL, 1520, street(p, "")));
-		addButton(ll, "\u25BA (3.2)  In 450m turn sharply left onto 'Hauptstra"+"\u00df"+"e', then bear right", builder(p).turn(BaseCommandPlayer.A_LEFT_SH, 450, street(p, "Hauptstraße")).then().bearRight(street(p, "")));
-		addButton(ll, "\u25BA (3.3)  Turn left, then in 100m turn slightly right", builder(p).turn(BaseCommandPlayer.A_LEFT, street(p, "")).then().turn(BaseCommandPlayer.A_RIGHT_SL, 100, street(p, "")));
-		addButton(ll, "\u25BA (3.4)  After 3100m turn right onto 'SR 80' toward 'Rome'", builder(p).prepareTurn(BaseCommandPlayer.A_RIGHT, 3100, street(p,  "SR 80", "", "Rome")));
-		addButton(ll, "\u25BA (3.5)  In 370m turn slightly right onto 'Route 23' 'Main Street', then bear left", builder(p).turn(BaseCommandPlayer.A_RIGHT_SL, 370, street(p, "Route 23", "Main Street", "")).then().bearLeft(street(p, "")));
-		addButton(ll, "\u25BA (3.6)  Turn sharply right onto 'Dr.-Quinn-Stra"+"\u00df"+"e'", builder(p).turn(BaseCommandPlayer.A_RIGHT_SH, street(p, "", "Dr.-Quinn-Straße", "")));
-		addButton(ll, "\u25BA (3.7)  Turn slightly right onto exit 6 onto 'Amsterdam-Osdorp'", builder(p).takeExit(BaseCommandPlayer.A_RIGHT_SL, "6", 6, street(p, "", "Amsterdam-Osdorp", "")));
-		addButton(ll, "\u25BA (3.8)  In 350m turn slightly right onto exit 6, 'Amsterdam-Osdorp'", builder(p).takeExit(BaseCommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "Amsterdam-Osdorp", "")));
-		addButton(ll, "\u25BA (3.9)  In 350m turn slightly right onto exit 6, 'Amsterdam-Osdorp' towards Osdorp", builder(p).takeExit(BaseCommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "Amsterdam-Osdorp", "Osdorp")));
-		addButton(ll, "\u25BA (3.10)  In 350m turn slightly right to exit 6 towards 'Osdorp'", builder(p).takeExit(BaseCommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "", "Osdorp")));
-		addButton(ll, "\u25BA (3.11)  Turn slightly right to exit 260B ", builder(p).takeExit(BaseCommandPlayer.A_RIGHT_SL, "260 B", 260, street(p, "", "", "")));
-		addButton(ll, "\u25BA (3.12)  Turn slightly left to exit 15B ", builder(p).takeExit(BaseCommandPlayer.A_LEFT_SL, "15 B", 15, street(p, "", "", "")));
+		addButton(ll, "\u25BA (3.1)  After 1520m turn slightly left", builder(p).prepareTurn(CommandPlayer.A_LEFT_SL, 1520, street(p, "")));
+		addButton(ll, "\u25BA (3.2)  In 450m turn sharply left onto 'Hauptstra"+"\u00df"+"e', then bear right", builder(p).turn(CommandPlayer.A_LEFT_SH, 450, street(p, "Hauptstraße")).then().bearRight(street(p, "")));
+		addButton(ll, "\u25BA (3.3)  Turn left, then in 100m turn slightly right", builder(p).turn(CommandPlayer.A_LEFT, street(p, "")).then().turn(CommandPlayer.A_RIGHT_SL, 100, street(p, "")));
+		addButton(ll, "\u25BA (3.4)  After 3100m turn right onto 'SR 80' toward 'Rome'", builder(p).prepareTurn(CommandPlayer.A_RIGHT, 3100, street(p,  "SR 80", "", "Rome")));
+		addButton(ll, "\u25BA (3.5)  In 370m turn slightly right onto 'Route 23' 'Main Street', then bear left", builder(p).turn(CommandPlayer.A_RIGHT_SL, 370, street(p, "Route 23", "Main Street", "")).then().bearLeft(street(p, "")));
+		addButton(ll, "\u25BA (3.6)  Turn sharply right onto 'Dr.-Quinn-Stra"+"\u00df"+"e'", builder(p).turn(CommandPlayer.A_RIGHT_SH, street(p, "", "Dr.-Quinn-Straße", "")));
+		addButton(ll, "\u25BA (3.7)  Turn slightly right onto exit 6 onto 'Amsterdam-Osdorp'", builder(p).takeExit(CommandPlayer.A_RIGHT_SL, "6", 6, street(p, "", "Amsterdam-Osdorp", "")));
+		addButton(ll, "\u25BA (3.8)  In 350m turn slightly right onto exit 6, 'Amsterdam-Osdorp'", builder(p).takeExit(CommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "Amsterdam-Osdorp", "")));
+		addButton(ll, "\u25BA (3.9)  In 350m turn slightly right onto exit 6, 'Amsterdam-Osdorp' towards Osdorp", builder(p).takeExit(CommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "Amsterdam-Osdorp", "Osdorp")));
+		addButton(ll, "\u25BA (3.10)  In 350m turn slightly right to exit 6 towards 'Osdorp'", builder(p).takeExit(CommandPlayer.A_RIGHT_SL, 350, "6", 6, street(p, "", "", "Osdorp")));
+		addButton(ll, "\u25BA (3.11)  Turn slightly right to exit 260B ", builder(p).takeExit(CommandPlayer.A_RIGHT_SL, "260 B", 260, street(p, "", "", "")));
+		addButton(ll, "\u25BA (3.12)  Turn slightly left to exit 15B ", builder(p).takeExit(CommandPlayer.A_LEFT_SL, "15 B", 15, street(p, "", "", "")));
 
 		addButton(ll, "Keep left/right: prepareTurn, makeTurnIn, turn:", builder(p));
-		addButton(ll, "\u25BA (4.1)  After 1810m keep left ' '", builder(p).prepareTurn(BaseCommandPlayer.A_LEFT_KEEP, 1810, street(p, "")));
-		addButton(ll, "\u25BA (4.2)  In 400m keep left ' ' then in 80m keep right onto 'A1'", builder(p).turn(BaseCommandPlayer.A_LEFT_KEEP, 400, street(p, "")).then().turn(BaseCommandPlayer.A_RIGHT_KEEP, 80, street(p,"", "A1")));
-		addButton(ll, "\u25BA (4.3)  Keep right on 'Highway 60'", builder(p).turn(BaseCommandPlayer.A_RIGHT_KEEP, street(p, "Highway 60", "", "", "Highway 60")));
+		addButton(ll, "\u25BA (4.1)  After 1810m keep left ' '", builder(p).prepareTurn(CommandPlayer.A_LEFT_KEEP, 1810, street(p, "")));
+		addButton(ll, "\u25BA (4.2)  In 400m keep left ' ' then in 80m keep right onto 'A1'", builder(p).turn(CommandPlayer.A_LEFT_KEEP, 400, street(p, "")).then().turn(CommandPlayer.A_RIGHT_KEEP, 80, street(p,"", "A1")));
+		addButton(ll, "\u25BA (4.3)  Keep right on 'Highway 60'", builder(p).turn(CommandPlayer.A_RIGHT_KEEP, street(p, "Highway 60", "", "", "Highway 60")));
 		addButton(ll, "\u25BA (4.4)  Turn left onto 'Broadway', then in 100m keep right and arrive at your destination 'Town Hall'",  
-				builder(p).turn(BaseCommandPlayer.A_LEFT, street(p, "Broadway"))
-				.then().turn(BaseCommandPlayer.A_RIGHT_KEEP, 100, street(p, "")).andArriveAtDestination("Town Hall"));
+				builder(p).turn(CommandPlayer.A_LEFT, street(p, "Broadway"))
+				.then().turn(CommandPlayer.A_RIGHT_KEEP, 100, street(p, "")).andArriveAtDestination("Town Hall"));
 		addButton(ll, "Roundabouts: prepareTurn, makeTurnIn, turn:", builder(p));
 		addButton(ll, "\u25BA (5.1)  After 1250m enter a roundabout", builder(p).prepareRoundAbout(1250, 3, street(p,"", "I 15", "Los Angeles")));
 		addButton(ll, "\u25BA (5.2)  In 450m enter the roundabout and take the 1st exit onto 'I 15' toward 'Los Angeles'", builder(p).roundAbout(450, 0, 1, street(p,"", "I 15", "Los Angeles")));
diff --git a/OsmAnd/src/net/osmand/plus/routing/VoiceRouter.java b/OsmAnd/src/net/osmand/plus/routing/VoiceRouter.java
index 3facece6528..8bd22135347 100644
--- a/OsmAnd/src/net/osmand/plus/routing/VoiceRouter.java
+++ b/OsmAnd/src/net/osmand/plus/routing/VoiceRouter.java
@@ -23,9 +23,8 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmAndAppCustomization.OsmAndAppCustomizationListener;
 import net.osmand.plus.settings.backend.OsmandSettings;
-import net.osmand.plus.voice.BaseCommandPlayer;
-import net.osmand.plus.voice.JsCommandBuilder;
 import net.osmand.plus.voice.CommandPlayer;
+import net.osmand.plus.voice.JsCommandBuilder;
 import net.osmand.router.ExitInfo;
 import net.osmand.router.RouteSegmentResult;
 import net.osmand.router.TurnType;
@@ -808,21 +807,21 @@ private void playMakeTurn(RouteSegmentResult currentSegment, RouteDirectionInfo
 	
 	private String getTurnType(TurnType t) {
 		if (TurnType.TL == t.getValue()) {
-			return BaseCommandPlayer.A_LEFT;
+			return CommandPlayer.A_LEFT;
 		} else if (TurnType.TSHL == t.getValue()) {
-			return BaseCommandPlayer.A_LEFT_SH;
+			return CommandPlayer.A_LEFT_SH;
 		} else if (TurnType.TSLL == t.getValue()) {
-			return BaseCommandPlayer.A_LEFT_SL;
+			return CommandPlayer.A_LEFT_SL;
 		} else if (TurnType.TR == t.getValue()) {
-			return BaseCommandPlayer.A_RIGHT;
+			return CommandPlayer.A_RIGHT;
 		} else if (TurnType.TSHR == t.getValue()) {
-			return BaseCommandPlayer.A_RIGHT_SH;
+			return CommandPlayer.A_RIGHT_SH;
 		} else if (TurnType.TSLR == t.getValue()) {
-			return BaseCommandPlayer.A_RIGHT_SL;
+			return CommandPlayer.A_RIGHT_SL;
 		} else if (TurnType.KL == t.getValue()) {
-			return BaseCommandPlayer.A_LEFT_KEEP;
+			return CommandPlayer.A_LEFT_KEEP;
 		} else if (TurnType.KR == t.getValue()) {
-			return BaseCommandPlayer.A_RIGHT_KEEP;
+			return CommandPlayer.A_RIGHT_KEEP;
 		}
 		return null;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/routing/data/AnnounceTimeDistances.java b/OsmAnd/src/net/osmand/plus/routing/data/AnnounceTimeDistances.java
index 80239f43418..dc829f48af2 100644
--- a/OsmAnd/src/net/osmand/plus/routing/data/AnnounceTimeDistances.java
+++ b/OsmAnd/src/net/osmand/plus/routing/data/AnnounceTimeDistances.java
@@ -10,7 +10,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
-import net.osmand.plus.voice.BaseCommandPlayer;
+import net.osmand.plus.voice.CommandPlayer;
 
 public class AnnounceTimeDistances {
 	// Avoids false negatives: Pre-pone close announcements by this distance to allow for the possible over-estimation of the 'true' lead distance due to positioning error.
@@ -88,7 +88,7 @@ public AnnounceTimeDistances(ApplicationMode appMode, OsmandSettings settings) {
 
 		// Trigger close prompts earlier to allow BT SCO link being established, or when VOICE_PROMPT_DELAY is set >0 for the other stream types
 		int ams = settings.AUDIO_MANAGER_STREAM.getModeValue(appMode);
-		if ((ams == 0 && !BaseCommandPlayer.isBluetoothScoRunning()) || ams > 0) {
+		if ((ams == 0 && !CommandPlayer.isBluetoothScoRunning()) || ams > 0) {
 			if (settings.VOICE_PROMPT_DELAY[ams] != null) {
 				voicePromptDelayTimeSec = (double) settings.VOICE_PROMPT_DELAY[ams].get() / 1000;
 			}
diff --git a/OsmAnd/src/net/osmand/plus/voice/BaseCommandPlayer.java b/OsmAnd/src/net/osmand/plus/voice/BaseCommandPlayer.java
deleted file mode 100644
index 0d8b0f1f93f..00000000000
--- a/OsmAnd/src/net/osmand/plus/voice/BaseCommandPlayer.java
+++ /dev/null
@@ -1,207 +0,0 @@
-package net.osmand.plus.voice;
-
-import android.content.Context;
-import android.media.AudioManager;
-
-import net.osmand.IndexConstants;
-import net.osmand.PlatformUtil;
-import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.R;
-import net.osmand.plus.api.AudioFocusHelper;
-import net.osmand.plus.api.AudioFocusHelperImpl;
-import net.osmand.plus.routing.VoiceRouter;
-import net.osmand.plus.settings.backend.ApplicationMode;
-import net.osmand.plus.settings.backend.OsmandSettings;
-
-import org.apache.commons.logging.Log;
-import org.mozilla.javascript.ScriptableObject;
-
-import java.io.BufferedReader;
-import java.io.File;
-import java.io.FileReader;
-
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-
-public abstract class BaseCommandPlayer implements CommandPlayer {
-
-	private static final Log log = PlatformUtil.getLog(BaseCommandPlayer.class);
-
-	// Turn types
-	public static final String A_LEFT = "left";
-	public static final String A_LEFT_SH = "left_sh";
-	public static final String A_LEFT_SL = "left_sl";
-	public static final String A_LEFT_KEEP = "left_keep";
-	public static final String A_RIGHT = "right";
-	public static final String A_RIGHT_SH = "right_sh";
-	public static final String A_RIGHT_SL = "right_sl";
-	public static final String A_RIGHT_KEEP = "right_keep";
-
-	private static boolean bluetoothScoRunning = false;
-	// Only for debugging
-	private static String bluetoothScoStatus = "-";
-
-	protected OsmandApplication app;
-	protected OsmandSettings settings;
-	protected ApplicationMode applicationMode;
-
-	protected final ScriptableObject jsScope;
-	protected final VoiceRouter voiceRouter;
-
-	private AudioFocusHelper mAudioFocusHelper;
-
-	protected final File voiceProviderDir;
-	protected final String language;
-	protected int streamType;
-
-	public static CommandPlayer createCommandPlayer(@NonNull OsmandApplication app,
-	                                                @NonNull ApplicationMode appMode,
-	                                                @NonNull String voiceProvider) throws CommandPlayerException {
-
-		File voicesDir = app.getAppPath(IndexConstants.VOICE_INDEX_DIR);
-		File voiceProviderDir = new File(voicesDir, voiceProvider);
-		if (!voiceProviderDir.exists()) {
-			throw new CommandPlayerException(app.getString(R.string.voice_data_unavailable));
-		}
-
-		VoiceRouter voiceRouter = app.getRoutingHelper().getVoiceRouter();
-		if (JsTtsCommandPlayer.isMyData(voiceProviderDir)) {
-			return new JsTtsCommandPlayer(app, appMode, voiceRouter, voiceProviderDir);
-		} else if (JsMediaCommandPlayer.isMyData(voiceProviderDir)) {
-			return new JsMediaCommandPlayer(app, appMode, voiceRouter, voiceProviderDir);
-		}
-		throw new CommandPlayerException(app.getString(R.string.voice_data_not_supported));
-	}
-
-	protected BaseCommandPlayer(OsmandApplication app, ApplicationMode applicationMode,
-	                            VoiceRouter voiceRouter,
-	                            File voiceProviderDir) throws CommandPlayerException {
-		this.app = app;
-		this.settings = app.getSettings();
-		this.applicationMode = applicationMode;
-		this.voiceRouter = voiceRouter;
-		this.streamType = settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode);
-		this.voiceProviderDir = voiceProviderDir;
-		this.language = defineVoiceProviderLanguage();
-		jsScope = initializeJsScope();
-	}
-
-	private String defineVoiceProviderLanguage() {
-		return voiceProviderDir.getName()
-				.replace(IndexConstants.VOICE_PROVIDER_SUFFIX, "")
-				.replace("-formal", "")
-				.replace("-casual", "");
-	}
-
-	private ScriptableObject initializeJsScope() {
-		org.mozilla.javascript.Context context = org.mozilla.javascript.Context.enter();
-		context.setOptimizationLevel(-1);
-		ScriptableObject jsScope = context.initSafeStandardObjects();
-		try {
-			String pathToTtsFile = voiceProviderDir.getAbsolutePath() + "/" + language
-					+ "_" + IndexConstants.TTSVOICE_INDEX_EXT_JS;
-			BufferedReader bufferedReader = new BufferedReader(new FileReader(pathToTtsFile));
-			context.evaluateReader(jsScope, bufferedReader, "JS", 1, null);
-			bufferedReader.close();
-		} catch (Exception e) {
-			log.error(e.getMessage(), e);
-		} finally {
-			org.mozilla.javascript.Context.exit();
-		}
-		return jsScope;
-	}
-
-	public String getLanguage() {
-		return language;
-	}
-
-	@Override
-	public String getCurrentVoice() {
-		return voiceProviderDir.getName();
-	}
-
-	@Override
-	public void clear() {
-		abandonAudioFocus();
-		app = null;
-	}
-
-	@Override
-	public void updateAudioStream(int streamType) {
-		this.streamType = streamType;
-	}
-
-	protected synchronized void requestAudioFocus() {
-		log.debug("requestAudioFocus");
-		mAudioFocusHelper = createAudioFocusHelper();
-		if (mAudioFocusHelper != null && app != null) {
-			boolean audioFocusGranted = mAudioFocusHelper.requestAudFocus(app, applicationMode, streamType);
-			if (audioFocusGranted && settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode) == 0) {
-				startBluetoothSco();
-			}
-		}
-	}
-
-	@Nullable
-	private AudioFocusHelper createAudioFocusHelper() {
-		try {
-			return new AudioFocusHelperImpl();
-		} catch (Exception e) {
-			log.error(e.getMessage(), e);
-			return null;
-		}
-	}
-	
-	protected synchronized void abandonAudioFocus() {
-		log.debug("abandonAudioFocus");
-		if ((app != null && settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode) == 0)
-				|| bluetoothScoRunning) {
-			stopBluetoothSco();
-		}
-		if (app != null && mAudioFocusHelper != null) {
-			mAudioFocusHelper.abandonAudFocus(app, applicationMode, streamType);
-		}
-		mAudioFocusHelper = null;
-	}
-
-	// Hardy, 2016-07-03: Establish a low quality BT SCO (Synchronous Connection-Oriented) link to interrupt e.g. a car stereo FM radio
-	private synchronized void startBluetoothSco() {
-		try {
-			AudioManager mAudioManager = (AudioManager) app.getSystemService(Context.AUDIO_SERVICE);
-			if (mAudioManager == null || !mAudioManager.isBluetoothScoAvailableOffCall()) {
-				bluetoothScoRunning = false;
-				bluetoothScoStatus = "Reported not available.";
-				return;
-			}
-
-			mAudioManager.setMode(AudioManager.MODE_NORMAL);
-			mAudioManager.startBluetoothSco();
-			mAudioManager.setBluetoothScoOn(true);
-			mAudioManager.setMode(AudioManager.MODE_IN_COMMUNICATION);
-			bluetoothScoRunning = true;
-			bluetoothScoStatus = "Available, initialized OK.";
-		} catch (Exception e) {
-			log.error("Failed to start Bluetooth SCO", e);
-			bluetoothScoRunning = false;
-			bluetoothScoStatus = "Available, but not initialized.\n(" + e.getMessage() + ")";
-		}
-	}
-
-	private synchronized void stopBluetoothSco() {
-		AudioManager mAudioManager = (AudioManager) app.getSystemService(Context.AUDIO_SERVICE);
-		if (mAudioManager != null) {
-			mAudioManager.setBluetoothScoOn(false);
-			mAudioManager.stopBluetoothSco();
-			mAudioManager.setMode(AudioManager.MODE_NORMAL);
-			bluetoothScoRunning = false;
-		}
-	}
-
-	public static boolean isBluetoothScoRunning() {
-		return bluetoothScoRunning;
-	}
-
-	public static String getBluetoothScoStatus() {
-		return bluetoothScoStatus;
-	}
-}
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/voice/CommandPlayer.java b/OsmAnd/src/net/osmand/plus/voice/CommandPlayer.java
index 4f051b14988..d6c9e090f8c 100644
--- a/OsmAnd/src/net/osmand/plus/voice/CommandPlayer.java
+++ b/OsmAnd/src/net/osmand/plus/voice/CommandPlayer.java
@@ -1,22 +1,214 @@
 package net.osmand.plus.voice;
 
+import android.content.Context;
+import android.media.AudioManager;
+
+import net.osmand.IndexConstants;
+import net.osmand.PlatformUtil;
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.R;
+import net.osmand.plus.api.AudioFocusHelper;
+import net.osmand.plus.api.AudioFocusHelperImpl;
+import net.osmand.plus.routing.VoiceRouter;
+import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.backend.OsmandSettings;
+
+import org.apache.commons.logging.Log;
+import org.mozilla.javascript.ScriptableObject;
+
+import java.io.BufferedReader;
+import java.io.File;
+import java.io.FileReader;
 import java.util.List;
 
-public interface CommandPlayer {
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+public abstract class CommandPlayer {
+
+	private static final Log log = PlatformUtil.getLog(CommandPlayer.class);
+
+	// Turn types
+	public static final String A_LEFT = "left";
+	public static final String A_LEFT_SH = "left_sh";
+	public static final String A_LEFT_SL = "left_sl";
+	public static final String A_LEFT_KEEP = "left_keep";
+	public static final String A_RIGHT = "right";
+	public static final String A_RIGHT_SH = "right_sh";
+	public static final String A_RIGHT_SL = "right_sl";
+	public static final String A_RIGHT_KEEP = "right_keep";
+
+	private static boolean bluetoothScoRunning = false;
+	// Only for debugging
+	private static String bluetoothScoStatus = "-";
+
+	protected OsmandApplication app;
+	protected OsmandSettings settings;
+	protected ApplicationMode applicationMode;
+
+	protected final ScriptableObject jsScope;
+	protected final VoiceRouter voiceRouter;
+
+	private AudioFocusHelper mAudioFocusHelper;
+
+	protected final File voiceProviderDir;
+	protected final String language;
+	protected int streamType;
+
+	public static CommandPlayer createCommandPlayer(@NonNull OsmandApplication app,
+	                                                @NonNull ApplicationMode appMode,
+	                                                @NonNull String voiceProvider) throws CommandPlayerException {
+
+		File voicesDir = app.getAppPath(IndexConstants.VOICE_INDEX_DIR);
+		File voiceProviderDir = new File(voicesDir, voiceProvider);
+		if (!voiceProviderDir.exists()) {
+			throw new CommandPlayerException(app.getString(R.string.voice_data_unavailable));
+		}
+
+		VoiceRouter voiceRouter = app.getRoutingHelper().getVoiceRouter();
+		if (JsTtsCommandPlayer.isMyData(voiceProviderDir)) {
+			return new JsTtsCommandPlayer(app, appMode, voiceRouter, voiceProviderDir);
+		} else if (JsMediaCommandPlayer.isMyData(voiceProviderDir)) {
+			return new JsMediaCommandPlayer(app, appMode, voiceRouter, voiceProviderDir);
+		}
+		throw new CommandPlayerException(app.getString(R.string.voice_data_not_supported));
+	}
+
+	protected CommandPlayer(OsmandApplication app,
+	                        ApplicationMode applicationMode,
+	                        VoiceRouter voiceRouter,
+	                        File voiceProviderDir) throws CommandPlayerException {
+		this.app = app;
+		this.settings = app.getSettings();
+		this.applicationMode = applicationMode;
+		this.voiceRouter = voiceRouter;
+		this.streamType = settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode);
+		this.voiceProviderDir = voiceProviderDir;
+		this.language = defineVoiceProviderLanguage();
+		jsScope = initializeJsScope();
+	}
+
+	private String defineVoiceProviderLanguage() {
+		return voiceProviderDir.getName()
+				.replace(IndexConstants.VOICE_PROVIDER_SUFFIX, "")
+				.replace("-formal", "")
+				.replace("-casual", "");
+	}
+
+	private ScriptableObject initializeJsScope() {
+		org.mozilla.javascript.Context context = org.mozilla.javascript.Context.enter();
+		context.setOptimizationLevel(-1);
+		ScriptableObject jsScope = context.initSafeStandardObjects();
+		try {
+			String pathToTtsFile = voiceProviderDir.getAbsolutePath() + "/" + language
+					+ "_" + IndexConstants.TTSVOICE_INDEX_EXT_JS;
+			BufferedReader bufferedReader = new BufferedReader(new FileReader(pathToTtsFile));
+			context.evaluateReader(jsScope, bufferedReader, "JS", 1, null);
+			bufferedReader.close();
+		} catch (Exception e) {
+			log.error(e.getMessage(), e);
+		} finally {
+			org.mozilla.javascript.Context.exit();
+		}
+		return jsScope;
+	}
+
+	public abstract JsCommandBuilder newCommandBuilder();
+
+	public abstract boolean supportsStructuredStreetNames();
+
+	public abstract List<String> playCommands(JsCommandBuilder builder);
+
+	public abstract void stop();
+
+	public String getLanguage() {
+		return language;
+	}
+
+	public String getCurrentVoice() {
+		return voiceProviderDir.getName();
+	}
+
+	public void clear() {
+		abandonAudioFocus();
+		app = null;
+	}
+
+	public void updateAudioStream(int streamType) {
+		this.streamType = streamType;
+	}
 
-	String getCurrentVoice();
+	protected synchronized void requestAudioFocus() {
+		log.debug("requestAudioFocus");
+		mAudioFocusHelper = createAudioFocusHelper();
+		if (mAudioFocusHelper != null && app != null) {
+			boolean audioFocusGranted = mAudioFocusHelper.requestAudFocus(app, applicationMode, streamType);
+			if (audioFocusGranted && settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode) == 0) {
+				startBluetoothSco();
+			}
+		}
+	}
 
-	JsCommandBuilder newCommandBuilder();
+	@Nullable
+	private AudioFocusHelper createAudioFocusHelper() {
+		try {
+			return new AudioFocusHelperImpl();
+		} catch (Exception e) {
+			log.error(e.getMessage(), e);
+			return null;
+		}
+	}
+	
+	protected synchronized void abandonAudioFocus() {
+		log.debug("abandonAudioFocus");
+		if ((app != null && settings.AUDIO_MANAGER_STREAM.getModeValue(applicationMode) == 0)
+				|| bluetoothScoRunning) {
+			stopBluetoothSco();
+		}
+		if (app != null && mAudioFocusHelper != null) {
+			mAudioFocusHelper.abandonAudFocus(app, applicationMode, streamType);
+		}
+		mAudioFocusHelper = null;
+	}
 
-	List<String> playCommands(JsCommandBuilder builder);
+	// Hardy, 2016-07-03: Establish a low quality BT SCO (Synchronous Connection-Oriented) link to interrupt e.g. a car stereo FM radio
+	private synchronized void startBluetoothSco() {
+		try {
+			AudioManager mAudioManager = (AudioManager) app.getSystemService(Context.AUDIO_SERVICE);
+			if (mAudioManager == null || !mAudioManager.isBluetoothScoAvailableOffCall()) {
+				bluetoothScoRunning = false;
+				bluetoothScoStatus = "Reported not available.";
+				return;
+			}
 
-	void clear();
+			mAudioManager.setMode(AudioManager.MODE_NORMAL);
+			mAudioManager.startBluetoothSco();
+			mAudioManager.setBluetoothScoOn(true);
+			mAudioManager.setMode(AudioManager.MODE_IN_COMMUNICATION);
+			bluetoothScoRunning = true;
+			bluetoothScoStatus = "Available, initialized OK.";
+		} catch (Exception e) {
+			log.error("Failed to start Bluetooth SCO", e);
+			bluetoothScoRunning = false;
+			bluetoothScoStatus = "Available, but not initialized.\n(" + e.getMessage() + ")";
+		}
+	}
 
-	void updateAudioStream(int streamType);
+	private synchronized void stopBluetoothSco() {
+		AudioManager mAudioManager = (AudioManager) app.getSystemService(Context.AUDIO_SERVICE);
+		if (mAudioManager != null) {
+			mAudioManager.setBluetoothScoOn(false);
+			mAudioManager.stopBluetoothSco();
+			mAudioManager.setMode(AudioManager.MODE_NORMAL);
+			bluetoothScoRunning = false;
+		}
+	}
 
-    String getLanguage();
-    
-    boolean supportsStructuredStreetNames();
+	public static boolean isBluetoothScoRunning() {
+		return bluetoothScoRunning;
+	}
 
-	void stop();
+	public static String getBluetoothScoStatus() {
+		return bluetoothScoStatus;
+	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/voice/JSCommandBuilder.java b/OsmAnd/src/net/osmand/plus/voice/JSCommandBuilder.java
index 26d52db44da..f58b0eac2ee 100644
--- a/OsmAnd/src/net/osmand/plus/voice/JSCommandBuilder.java
+++ b/OsmAnd/src/net/osmand/plus/voice/JSCommandBuilder.java
@@ -156,8 +156,8 @@ public JsCommandBuilder takeExit(String turnType, double dist, String exitString
 	}
 
 	/**
-	 * @param turnType {@link net.osmand.plus.voice.BaseCommandPlayer#A_LEFT},
-	 *                 {@link net.osmand.plus.voice.BaseCommandPlayer#A_LEFT},..
+	 * @param turnType {@link CommandPlayer#A_LEFT},
+	 *                 {@link CommandPlayer#A_LEFT},..
 	 */
 	public JsCommandBuilder prepareTurn(String turnType, double dist, StreetName streetName) {
 		return addCommand(C_PREPARE_TURN, turnType, dist, convertStreetName(streetName));
diff --git a/OsmAnd/src/net/osmand/plus/voice/JsMediaCommandPlayer.java b/OsmAnd/src/net/osmand/plus/voice/JsMediaCommandPlayer.java
index a50cf6760da..bc1a02815dd 100644
--- a/OsmAnd/src/net/osmand/plus/voice/JsMediaCommandPlayer.java
+++ b/OsmAnd/src/net/osmand/plus/voice/JsMediaCommandPlayer.java
@@ -25,7 +25,7 @@
  * It gets commands from input, analyze what files should be played and play
  * them using media player
  */
-public class JsMediaCommandPlayer extends BaseCommandPlayer implements OnCompletionListener {
+public class JsMediaCommandPlayer extends CommandPlayer implements OnCompletionListener {
 
 	private static final Log log = PlatformUtil.getLog(JsMediaCommandPlayer.class);
 
diff --git a/OsmAnd/src/net/osmand/plus/voice/JsTtsCommandPlayer.java b/OsmAnd/src/net/osmand/plus/voice/JsTtsCommandPlayer.java
index ad7950f7e50..2fd1cfa5428 100644
--- a/OsmAnd/src/net/osmand/plus/voice/JsTtsCommandPlayer.java
+++ b/OsmAnd/src/net/osmand/plus/voice/JsTtsCommandPlayer.java
@@ -15,22 +15,18 @@
 import net.osmand.plus.routing.VoiceRouter;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandPreference;
-import net.osmand.util.Algorithms;
 
 import org.apache.commons.logging.Log;
 import org.json.JSONArray;
 import org.json.JSONObject;
-import org.mozilla.javascript.ScriptableObject;
 
-import java.io.BufferedReader;
 import java.io.File;
-import java.io.FileReader;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Locale;
 import java.util.Map;
 
-public class JsTtsCommandPlayer extends BaseCommandPlayer {
+public class JsTtsCommandPlayer extends CommandPlayer {
 
 	private static final Log log = PlatformUtil.getLog(JsTtsCommandPlayer.class);
 
@@ -293,6 +289,11 @@ private void internalClear() {
 		ttsVoiceUsed = "-";
 	}
 
+	@Override
+	public boolean supportsStructuredStreetNames() {
+		return true;
+	}
+
 	public static String getTtsVoiceStatus() {
 		return ttsVoiceStatus;
 	}
@@ -301,11 +302,6 @@ public static String getTtsVoiceUsed() {
 		return ttsVoiceUsed;
 	}
 
-	@Override
-	public boolean supportsStructuredStreetNames() {
-		return true;
-	}
-
 	public static boolean isMyData(File voiceDir) {
 		if (!voiceDir.getName().contains("tts")) {
 			return false;
