diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index eac9e208b9e..60ce109b5bf 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -105,6 +105,7 @@
 import net.osmand.plus.settings.backend.OsmAndAppCustomization.OsmAndAppCustomizationListener;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.datastorage.SharedStorageWarningFragment;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.settings.fragments.SettingsScreenType;
 import net.osmand.plus.simulation.LoadSimulatedLocationsTask.LoadSimulatedLocationsListener;
@@ -116,6 +117,7 @@
 import net.osmand.plus.track.helpers.GpxDisplayItem;
 import net.osmand.plus.track.helpers.SelectedGpxFile;
 import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.AddGpxPointBottomSheetHelper.NewGpxPoint;
 import net.osmand.plus.views.AnimateDraggingMapThread;
@@ -460,8 +462,8 @@ public void setupRouteCalculationProgressBar(@NonNull ProgressBar pb) {
 	public void setupProgressBar(@NonNull ProgressBar pb, boolean indeterminate) {
 		DayNightHelper dayNightHelper = getMyApplication().getDaynightHelper();
 
-		boolean nightMode = dayNightHelper.isNightModeForMapControls();
-		boolean useRouteLineColor = nightMode == dayNightHelper.isNightMode();
+		boolean nightMode = dayNightHelper.isNightMode(ThemeUsageContext.OVER_MAP);
+		boolean useRouteLineColor = nightMode == dayNightHelper.isNightMode(ThemeUsageContext.MAP);
 
 		int bgColorId = nightMode ? R.color.map_progress_bar_bg_dark : R.color.map_progress_bar_bg_light;
 		int bgColor = ContextCompat.getColor(this, bgColorId);
@@ -1116,11 +1118,8 @@ public void updateApplicationModeSettings(boolean forceUpdatePoiFilters) {
 	}
 
 	public void updateNavigationBarColor() {
-		if (getMyApplication().getDaynightHelper().isNightModeForMapControls() || getMyApplication().getDaynightHelper().isNightMode()) {
-			getWindow().setNavigationBarColor(ContextCompat.getColor(app, R.color.navigation_bar_bg_dark));
-		} else {
-			getWindow().setNavigationBarColor(ContextCompat.getColor(app, R.color.navigation_bar_bg_light));
-		}
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
+		getWindow().setNavigationBarColor(ColorUtilities.getNavBarBackgroundColor(app, nightMode));
 	}
 
 	public void updateMapSettings(boolean updateMapRenderer) {
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java b/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
index b248f99a7e3..71f4e98ca14 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
@@ -12,7 +12,6 @@
 import android.net.Uri;
 import android.widget.ImageView;
 import android.widget.ListView;
-import android.widget.Toast;
 
 import androidx.annotation.DrawableRes;
 import androidx.annotation.NonNull;
@@ -56,6 +55,7 @@
 import net.osmand.plus.routepreparationmenu.WaypointsFragment;
 import net.osmand.plus.search.ShowQuickSearchMode;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.settings.fragments.SettingsScreenType;
 import net.osmand.plus.track.helpers.GpxSelectionHelper;
@@ -245,7 +245,8 @@ public void showAdditionalActionsFragment(ContextMenuAdapter adapter,
 
 	public ContextMenuItemClickListener getContextMenuItemClickListener(MapActivity activity, double latitude,
 			double longitude, ContextMenuAdapter adapter) {
-		ViewCreator viewCreator = new ViewCreator(activity, !settings.isLightContent());
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		ViewCreator viewCreator = new ViewCreator(activity, nightMode);
 		ContextMenuListAdapter listAdapter = adapter.toListAdapter(activity, viewCreator);
 
 		return (view, position) -> {
@@ -344,7 +345,7 @@ public ContextMenuAdapter createMainOptionsMenu() {
 		ContextMenuAdapter adapter = new ContextMenuAdapter(app);
 		MapActivity activity = getMapActivity();
 		if (activity != null) {
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			if (drawerMode == DRAWER_MODE_SWITCH_PROFILE) {
 				return createSwitchProfileOptionsMenu(activity, adapter, nightMode);
 			}
@@ -358,7 +359,7 @@ public ContextMenuAdapter createNormalOptionsMenu() {
 		ContextMenuAdapter adapter = new ContextMenuAdapter(app);
 		MapActivity activity = getMapActivity();
 		if (activity != null) {
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			return createNormalOptionsMenu(activity, adapter, nightMode);
 		}
 		return adapter;
@@ -760,7 +761,7 @@ public void updateDrawerMenu() {
 		if (activity == null) {
 			return;
 		}
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		ListView menuItemsListView = activity.findViewById(R.id.menuItems);
 		menuItemsListView.setBackgroundColor(ColorUtilities.getListBgColor(activity, nightMode));
 		if (drawerLogoHeader != null) {
diff --git a/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java b/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
index a3604e28b9f..bb703744003 100644
--- a/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
@@ -5,9 +5,9 @@
 import android.view.View;
 import android.view.ViewGroup;
 
-import androidx.annotation.NonNull;
 import androidx.appcompat.app.ActionBar;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
@@ -26,7 +26,7 @@ protected void setupHomeButton() {
 		ActionBar supportActionBar = getSupportActionBar();
 		if (supportActionBar != null) {
 			OsmandApplication app = getMyApplication();
-			boolean nightMode = !app.getSettings().isLightContent();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			int iconId = AndroidUtils.getNavigationIconResId(app);
 			int colorId = ColorUtilities.getActiveButtonsAndLinksTextColorId(nightMode);
 
diff --git a/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java b/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
index 2dbb2dd10d9..adf15d5e43e 100644
--- a/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
+++ b/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
@@ -20,6 +20,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -110,30 +111,26 @@ public static void updateButtonState(@NonNull Context context, List<ApplicationM
 				iv.setContentDescription(String.format("%s %s", mode.toHumanString(), app.getString(R.string.item_unchecked)));
 				selection.setVisibility(View.INVISIBLE);
 			}
-			tb.setOnClickListener(new View.OnClickListener() {
-
-				@Override
-				public void onClick(View v) {
-					boolean isChecked = !checked;
-					if (singleChoice) {
-						if (isChecked) {
-							selected.clear();
-							selected.add(mode);
-						}
-					} else {
-						if (isChecked) {
-							selected.add(mode);
-						} else {
-							selected.remove(mode);
-						}
-					}
-					if (onClickListener != null) {
-						onClickListener.onClick(null);
+			tb.setOnClickListener(v -> {
+				boolean isChecked = !checked;
+				if (singleChoice) {
+					if (isChecked) {
+						selected.clear();
+						selected.add(mode);
 					}
-					for (int i = 0; i < visible.size(); i++) {
-						updateButtonState(context, visible, selected, onClickListener, buttons, i, singleChoice, useMapTheme, nightMode);
+				} else {
+					if (isChecked) {
+						selected.add(mode);
+					} else {
+						selected.remove(mode);
 					}
 				}
+				if (onClickListener != null) {
+					onClickListener.onClick(null);
+				}
+				for (int i1 = 0; i1 < visible.size(); i1++) {
+					updateButtonState(context, visible, selected, onClickListener, buttons, i1, singleChoice, useMapTheme, nightMode);
+				}
 			});
 		}
 	}
@@ -165,30 +162,26 @@ public static void updateButtonStateForRoute(OsmandApplication ctx, List<Applica
 				}
 				iv.setContentDescription(String.format("%s %s", mode.toHumanString(), ctx.getString(R.string.item_unchecked)));
 			}
-			tb.setOnClickListener(new View.OnClickListener() {
-
-				@Override
-				public void onClick(View v) {
-					boolean isChecked = !checked;
-					if (singleChoice) {
-						if (isChecked) {
-							selected.clear();
-							selected.add(mode);
-						}
-					} else {
-						if (isChecked) {
-							selected.add(mode);
-						} else {
-							selected.remove(mode);
-						}
-					}
-					if (onClickListener != null) {
-						onClickListener.onClick(null);
+			tb.setOnClickListener(v -> {
+				boolean isChecked = !checked;
+				if (singleChoice) {
+					if (isChecked) {
+						selected.clear();
+						selected.add(mode);
 					}
-					for (int i = 0; i < visible.size(); i++) {
-						updateButtonStateForRoute(ctx, visible, selected, onClickListener, buttons, i, singleChoice, useMapTheme, nightMode);
+				} else {
+					if (isChecked) {
+						selected.add(mode);
+					} else {
+						selected.remove(mode);
 					}
 				}
+				if (onClickListener != null) {
+					onClickListener.onClick(null);
+				}
+				for (int i1 = 0; i1 < visible.size(); i1++) {
+					updateButtonStateForRoute(ctx, visible, selected, onClickListener, buttons, i1, singleChoice, useMapTheme, nightMode);
+				}
 			});
 		}
 	}
@@ -206,6 +199,6 @@ public static View createToggle(LayoutInflater layoutInflater, OsmandApplication
 	}
 
 	private static boolean isNightMode(OsmandApplication app, boolean usedOnMap) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/activities/actions/StartGPSStatus.java b/OsmAnd/src/net/osmand/plus/activities/actions/StartGPSStatus.java
index 4c058188c24..846f5b4793a 100644
--- a/OsmAnd/src/net/osmand/plus/activities/actions/StartGPSStatus.java
+++ b/OsmAnd/src/net/osmand/plus/activities/actions/StartGPSStatus.java
@@ -12,7 +12,6 @@
 import android.widget.LinearLayout.LayoutParams;
 import android.widget.ListView;
 import android.widget.TextView;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AlertDialog;
@@ -23,6 +22,7 @@
 import net.osmand.plus.Version;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -139,6 +139,6 @@ private void runChosenGPSStatus(GpsStatusApps g) {
 	}
 
 	public boolean isNightMode() {
-		return app.getDaynightHelper().isNightModeForMapControls();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/auto/TripHelper.java b/OsmAnd/src/net/osmand/plus/auto/TripHelper.java
index 07bec2bb153..d1d3944de54 100644
--- a/OsmAnd/src/net/osmand/plus/auto/TripHelper.java
+++ b/OsmAnd/src/net/osmand/plus/auto/TripHelper.java
@@ -26,6 +26,7 @@
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.routing.data.AnnounceTimeDistances;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.mapwidgets.LanesDrawable;
 import net.osmand.plus.views.mapwidgets.TurnDrawable;
 import net.osmand.router.TurnType;
@@ -257,7 +258,7 @@ private Bitmap createLanesBitmap(@NonNull Step.Builder builder, int[] lanes, int
 				TURN_LANE_IMAGE_SIZE * density);
 		lanesDrawable.lanes = lanes;
 		lanesDrawable.imminent = imminent == 0;
-		lanesDrawable.isNightMode = app.getDaynightHelper().isNightMode();
+		lanesDrawable.isNightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		lanesDrawable.updateBounds(); // prefer 500 x 74 dp
 		return drawableToBitmap(lanesDrawable, lanesDrawable.getIntrinsicWidth(), lanesDrawable.getIntrinsicHeight());
 	}
@@ -268,7 +269,7 @@ private Bitmap createTurnBitmap(@NonNull TurnType turnType, boolean deviatedFrom
 		drawable.setBounds(0, 0, width, height);
 		drawable.setTurnType(turnType);
 		drawable.setTurnImminent(imminent, deviatedFromRoute);
-		drawable.updateColors(app.getDaynightHelper().isNightMode());
+		drawable.updateColors(app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP));
 		return drawableToBitmap(drawable, width, height);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/auto/screens/TracksFoldersScreen.kt b/OsmAnd/src/net/osmand/plus/auto/screens/TracksFoldersScreen.kt
index 526542d7aa1..2af335364ee 100644
--- a/OsmAnd/src/net/osmand/plus/auto/screens/TracksFoldersScreen.kt
+++ b/OsmAnd/src/net/osmand/plus/auto/screens/TracksFoldersScreen.kt
@@ -17,6 +17,7 @@ import net.osmand.plus.R
 import net.osmand.plus.configmap.tracks.TrackTab
 import net.osmand.plus.configmap.tracks.TrackTabType
 import net.osmand.plus.configmap.tracks.TrackTabsHelper
+import net.osmand.plus.settings.enums.ThemeUsageContext
 import net.osmand.plus.settings.enums.TracksSortMode
 import net.osmand.plus.utils.AndroidUtils
 import net.osmand.plus.utils.ColorUtilities
@@ -101,7 +102,8 @@ class TracksFoldersScreen(
                 break
             }
             val title = trackTab.getName()
-            val iconColorId = ColorUtilities.getDefaultIconColorId(app.daynightHelper.isNightMode)
+            val nightMode = app.daynightHelper.isNightMode(ThemeUsageContext.MAP)
+            val iconColorId = ColorUtilities.getDefaultIconColorId(nightMode)
             val iconDrawable = app.uiUtilities.getIcon(trackTab.type.iconId, iconColorId)
             val icon = CarIcon.Builder(
                 IconCompat.createWithBitmap(AndroidUtils.drawableToBitmap(iconDrawable))).build()
diff --git a/OsmAnd/src/net/osmand/plus/auto/views/AndroidAutoMapPlaceholderView.java b/OsmAnd/src/net/osmand/plus/auto/views/AndroidAutoMapPlaceholderView.java
index 38648f12137..1249e21181c 100644
--- a/OsmAnd/src/net/osmand/plus/auto/views/AndroidAutoMapPlaceholderView.java
+++ b/OsmAnd/src/net/osmand/plus/auto/views/AndroidAutoMapPlaceholderView.java
@@ -10,6 +10,7 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -42,7 +43,7 @@ public AndroidAutoMapPlaceholderView(@NonNull Context context, @Nullable Attribu
 	public AndroidAutoMapPlaceholderView(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
 		super(context, attrs, defStyleAttr, defStyleRes);
 
-		boolean nightMode = getMyApplication().getDaynightHelper().isNightMode();
+		boolean nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		inflate(UiUtilities.getThemedContext(context, nightMode), R.layout.android_auto_map_placeholder, this);
 
 		container = findViewById(R.id.container);
diff --git a/OsmAnd/src/net/osmand/plus/avoidroads/AvoidRoadsDialog.java b/OsmAnd/src/net/osmand/plus/avoidroads/AvoidRoadsDialog.java
index 03af5350b5e..17571036d45 100644
--- a/OsmAnd/src/net/osmand/plus/avoidroads/AvoidRoadsDialog.java
+++ b/OsmAnd/src/net/osmand/plus/avoidroads/AvoidRoadsDialog.java
@@ -22,6 +22,7 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.utils.UiUtilities;
@@ -36,7 +37,7 @@ public static void showDialog(@NonNull MapActivity activity, @Nullable Applicati
 		if (AndroidUtils.isActivityNotDestroyed(activity)) {
 			OsmandApplication app = activity.getMyApplication();
 			AvoidRoadsHelper avoidRoadsHelper = app.getAvoidSpecificRoads();
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 			AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(activity, nightMode));
 			builder.setTitle(R.string.impassable_road);
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/ChangeItemActionsBottomSheet.java b/OsmAnd/src/net/osmand/plus/backup/ui/ChangeItemActionsBottomSheet.java
index 1eae6edddee..bba186f3bb2 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/ChangeItemActionsBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/ChangeItemActionsBottomSheet.java
@@ -36,6 +36,7 @@
 import net.osmand.plus.base.BottomSheetDialogFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.backup.SettingsItemType;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -56,7 +57,7 @@ public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = requiredMyApplication();
 		settingsHelper = app.getNetworkSettingsHelper();
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
index 1d2c2824246..027ac8579e5 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
@@ -14,6 +14,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 
 public abstract class BaseBottomSheetDialogFragment extends BottomSheetDialogFragment {
@@ -47,6 +48,6 @@ public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
index 6eb2ebf2019..e103854fd0b 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
@@ -17,9 +17,9 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
-import net.osmand.plus.helpers.RequestThemeParams;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -110,7 +110,6 @@ protected Drawable getContentIcon(@DrawableRes int id) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		RequestThemeParams params = new RequestThemeParams(appMode, true);
-		return app.getDaynightHelper().isNightMode(usedOnMap, params);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
index fcdaaa2f8e9..778a9a4b0b1 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
@@ -22,9 +22,9 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.activities.OsmandActionBarActivity;
-import net.osmand.plus.helpers.RequestThemeParams;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -215,7 +215,6 @@ protected int getDimensionPixelSize(@DimenRes int resId) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		RequestThemeParams params = new RequestThemeParams(appMode, true);
-		return app.getDaynightHelper().isNightMode(usedOnMap, params);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
index 000df4300d3..3b71988ea1a 100644
--- a/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
@@ -20,6 +20,7 @@
 
 import com.google.android.material.bottomsheet.BottomSheetBehavior;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -241,6 +242,6 @@ private int getButtonsContainerBg() {
 	}
 
 	protected boolean isNightMode(@NonNull OsmandApplication app) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/base/BottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BottomSheetDialogFragment.java
index bf7bdd6fa63..3f613e95a59 100644
--- a/OsmAnd/src/net/osmand/plus/base/BottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BottomSheetDialogFragment.java
@@ -21,6 +21,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 public abstract class BottomSheetDialogFragment extends DialogFragment {
 
@@ -32,7 +33,8 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
 		Context context = requireContext();
 		OsmandApplication app = (OsmandApplication) context.getApplicationContext();
 		OsmandSettings settings = app.getSettings();
-		int themeId = settings.isLightContent() ? R.style.OsmandLightTheme_BottomSheet : R.style.OsmandDarkTheme_BottomSheet;
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		int themeId = nightMode ? R.style.OsmandDarkTheme_BottomSheet : R.style.OsmandLightTheme_BottomSheet;
 
 		BottomSheetDialog dialog = new BottomSheetDialog(context, themeId);
 		dialog.setCanceledOnTouchOutside(true);
diff --git a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
index ffbf5c5866a..f2bc7879332 100644
--- a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
@@ -32,6 +32,7 @@
 import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -476,7 +477,7 @@ protected LayerDrawable createBackgroundDrawable(@NonNull Context ctx, @Drawable
 	}
 
 	public boolean isNightMode(@NonNull OsmandApplication app) {
-		return app.getDaynightHelper().isNightMode(usedOnMap, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	private void showShadowButton() {
diff --git a/OsmAnd/src/net/osmand/plus/base/OsmAndListFragment.java b/OsmAnd/src/net/osmand/plus/base/OsmAndListFragment.java
index 4503474533e..31f30625ee4 100644
--- a/OsmAnd/src/net/osmand/plus/base/OsmAndListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/OsmAndListFragment.java
@@ -5,6 +5,7 @@
 
 import androidx.fragment.app.ListFragment;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 
@@ -14,7 +15,7 @@ public abstract class OsmAndListFragment extends ListFragment {
 	public void onActivityCreated(Bundle savedInstanceState) {
 		super.onActivityCreated(savedInstanceState);
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		getListView().setBackgroundColor(ColorUtilities.getListBgColor(app, nightMode));
 	}
 	
diff --git a/OsmAnd/src/net/osmand/plus/base/OsmandExpandableListFragment.java b/OsmAnd/src/net/osmand/plus/base/OsmandExpandableListFragment.java
index 6e0545265f8..516f61dc7fa 100644
--- a/OsmAnd/src/net/osmand/plus/base/OsmandExpandableListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/OsmandExpandableListFragment.java
@@ -18,6 +18,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.OsmandActionBarActivity;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 
@@ -70,7 +71,7 @@ public void setListView(ExpandableListView listView) {
 	}
 
 	public MenuItem createMenuItem(Menu m, int id, int titleRes, int iconId, int menuItemType) {
-		int color = ColorUtilities.getActiveButtonsAndLinksTextColorId(!isLightActionBar());
+		int color = ColorUtilities.getActiveButtonsAndLinksTextColorId(isNightMode());
 		return createMenuItem(m, id, titleRes, iconId, menuItemType, false, color);
 	}
 
@@ -89,10 +90,13 @@ public MenuItem createMenuItem(Menu m, int id, int titleRes, int iconId, int men
 		return menuItem;
 	}
 
-
-	public boolean isLightActionBar() {
+	public boolean isNightMode() {
 		Activity activity = getActivity();
-		return activity == null || ((OsmandApplication) activity.getApplication()).getSettings().isLightContent();
+		if (activity != null) {
+			OsmandApplication app = (OsmandApplication) activity.getApplication();
+			return app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		}
+		return false;
 	}
 
 	public void collapseTrees(int count) {
diff --git a/OsmAnd/src/net/osmand/plus/base/OsmandListActivity.java b/OsmAnd/src/net/osmand/plus/base/OsmandListActivity.java
index 6d317629635..7d617123842 100644
--- a/OsmAnd/src/net/osmand/plus/base/OsmandListActivity.java
+++ b/OsmAnd/src/net/osmand/plus/base/OsmandListActivity.java
@@ -13,6 +13,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.ActionBarProgressActivity;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 
@@ -31,7 +32,7 @@ protected void onCreate(Bundle savedInstanceState) {
 	protected void onStart() {
 		super.onStart();
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		getListView().setBackgroundColor(ColorUtilities.getListBgColor(app, nightMode));
 		getListView().setDivider(app.getUIUtilities().getIcon(R.drawable.divider_solid, ColorUtilities.getDividerColorId(nightMode)));
 		getListView().setDividerHeight(AndroidUtils.dpToPx(app, 1));
@@ -52,12 +53,7 @@ public MenuItem createMenuItem(Menu m, int id, int titleRes, int iconDark, int m
 		if (iconDark != 0) {
 			menuItem.setIcon(getMyApplication().getUIUtilities().getIcon(iconDark));
 		}
-		menuItem.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener() {
-			@Override
-			public boolean onMenuItemClick(MenuItem item) {
-				return onOptionsItemSelected(item);
-			}
-		});
+		menuItem.setOnMenuItemClickListener(this::onOptionsItemSelected);
 		menuItem.setShowAsAction(menuItemType);
 		return menuItem;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/charts/ChartUtils.java b/OsmAnd/src/net/osmand/plus/charts/ChartUtils.java
index 24706ba30bb..071bbeaa145 100644
--- a/OsmAnd/src/net/osmand/plus/charts/ChartUtils.java
+++ b/OsmAnd/src/net/osmand/plus/charts/ChartUtils.java
@@ -47,6 +47,7 @@
 import net.osmand.plus.download.local.dialogs.MemoryInfo.MemoryItem;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.settings.enums.MetricsConstants;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
@@ -509,7 +510,7 @@ public int getPointsCount() {
 		dataSet.setDivX(divX);
 		dataSet.setUnits(mainUnitY);
 
-		boolean nightMode = !settings.isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int color = ColorUtilities.getColor(app, graphType.getFillColorId(false));
 		setupDataSet(app, dataSet, color, color, drawFilled, graphType == GPXDataSetType.ALTITUDE_EXTRM, useRightAxis, nightMode);
 		dataSet.setFillFormatter((ds, dataProvider) -> dataProvider.getYChartMin());
@@ -570,8 +571,7 @@ public static OrderedLineDataSet createGPXSpeedDataSet(@NonNull OsmandApplicatio
 	                                                       boolean setYAxisMinimum,
 	                                                       boolean drawFilled,
 	                                                       boolean calcWithoutGaps) {
-		OsmandSettings settings = app.getSettings();
-		boolean nightMode = !settings.isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		float divX = getDivX(app, chart, analysis, axisType, calcWithoutGaps);
 
@@ -714,7 +714,7 @@ public static OrderedLineDataSet createGPXSlopeDataSet(@NonNull OsmandApplicatio
 	                                                       boolean drawFilled,
 	                                                       boolean calcWithoutGaps) {
 		OsmandSettings settings = app.getSettings();
-		boolean nightMode = !settings.isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		MetricsConstants mc = settings.METRIC_SYSTEM.get();
 		boolean useFeet = (mc == MetricsConstants.MILES_AND_FEET) || (mc == MetricsConstants.MILES_AND_YARDS) || (mc == MetricsConstants.NAUTICAL_MILES_AND_FEET);
 		float convEle = useFeet ? 3.28084f : 1.0f;
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/button/PurchasingUtils.java b/OsmAnd/src/net/osmand/plus/chooseplan/button/PurchasingUtils.java
index 11caabcb96b..92075a5414e 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/button/PurchasingUtils.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/button/PurchasingUtils.java
@@ -8,6 +8,7 @@
 import androidx.annotation.Nullable;
 import androidx.annotation.StringRes;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.ctxmenu.ContextMenuAdapter;
 import net.osmand.plus.widgets.ctxmenu.callback.ItemClickListener;
@@ -98,7 +99,7 @@ public static void createPromoItem(@NonNull ContextMenuAdapter adapter,
 	                                   @StringRes int titleId,
 	                                   @StringRes int descriptionId) {
 		OsmandApplication app = mapActivity.getMyApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		ItemClickListener listener = (uiAdapter, view, item, isChecked) -> {
 			ChoosePlanFragment.showInstance(mapActivity, feature);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
index 1ae556b3096..0b570401473 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
@@ -51,6 +51,7 @@
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
 import net.osmand.plus.settings.enums.DayNightMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.helpers.GpxSelectionHelper;
 import net.osmand.plus.transport.TransportLinesMenu;
 import net.osmand.plus.utils.AndroidUtils;
@@ -95,7 +96,7 @@ public ConfigureMapMenu(@NonNull OsmandApplication app) {
 
 	@NonNull
 	public ContextMenuAdapter createListAdapter(@NonNull MapActivity mapActivity) {
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		ContextMenuAdapter adapter = new ContextMenuAdapter(app);
 
diff --git a/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java b/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
index 1168eecdc69..a37c4f87858 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
@@ -18,6 +18,7 @@
 import net.osmand.plus.base.containers.Limits;
 import net.osmand.plus.base.dialog.BaseDialogController;
 import net.osmand.plus.base.dialog.DialogManager;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.layers.CoordinatesGridSettings;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.enums.EnumWithTitleId;
@@ -183,7 +184,7 @@ private ApplicationMode getSelectedAppMode() {
 	}
 
 	public boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 	}
 
 	@DrawableRes
diff --git a/OsmAnd/src/net/osmand/plus/configmap/MapColorPaletteController.java b/OsmAnd/src/net/osmand/plus/configmap/MapColorPaletteController.java
index 8cef8951723..3d1bbc23bd6 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/MapColorPaletteController.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/MapColorPaletteController.java
@@ -19,6 +19,7 @@
 import net.osmand.plus.helpers.DayNightHelper;
 import net.osmand.plus.helpers.DayNightHelper.MapThemeProvider;
 import net.osmand.plus.settings.enums.DayNightMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 import java.util.Arrays;
 import java.util.List;
@@ -50,7 +51,7 @@ public MapColorPaletteController(@NonNull OsmandApplication app,
 		super(app);
 		this.colorDay = this.initialColorDay = initialColorDay;
 		this.colorNight = this.initialColorNight = initialColorNight;
-		initialNightMode = app.getDaynightHelper().isNightModeForMapControls();
+		initialNightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/configmap/routes/actions/BaseRouteQuickAction.java b/OsmAnd/src/net/osmand/plus/configmap/routes/actions/BaseRouteQuickAction.java
index 3db4777a6f2..016ba55f665 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/routes/actions/BaseRouteQuickAction.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/routes/actions/BaseRouteQuickAction.java
@@ -18,8 +18,7 @@
 import net.osmand.plus.configmap.ConfigureMapUtils;
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.quickaction.QuickActionType;
-import net.osmand.plus.settings.backend.OsmandSettings;
-import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.render.RenderingRuleProperty;
 
 public abstract class BaseRouteQuickAction extends QuickAction {
@@ -57,7 +56,7 @@ public void execute(@NonNull MapActivity mapActivity) {
 			mapActivity.refreshMapComplete();
 			mapActivity.updateLayers();
 		} else {
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			showRendererSnackbarForAttr(mapActivity, attrName, nightMode, null);
 		}
 	}
diff --git a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
index 5b9ee81817c..7531f0a6dfa 100644
--- a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
+++ b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
@@ -78,6 +78,7 @@
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
 import net.osmand.plus.transport.TransportLinesFragment;
 import net.osmand.plus.utils.AndroidUtils;
@@ -508,7 +509,7 @@ public void setDashboardVisibility(boolean visible, DashboardType type, boolean
 			return;
 		}
 		mapActivity.getRoutingHelper().removeListener(this);
-		nightMode = getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		this.visible = visible;
 		updateVisibilityStack(type, visible);
 
@@ -694,7 +695,7 @@ public void updateListAdapter(ContextMenuAdapter cm) {
 		OsmandSettings settings = app.getSettings();
 		ApplicationMode appMode = settings.getApplicationMode();
 
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		if (this.nightMode != nightMode) {
 			this.nightMode = nightMode;
 			applyDayNightMode();
diff --git a/OsmAnd/src/net/osmand/plus/dashboard/tools/DashboardSettingsDialogFragment.java b/OsmAnd/src/net/osmand/plus/dashboard/tools/DashboardSettingsDialogFragment.java
index 924cafbd3df..2f906088ebf 100644
--- a/OsmAnd/src/net/osmand/plus/dashboard/tools/DashboardSettingsDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/dashboard/tools/DashboardSettingsDialogFragment.java
@@ -27,6 +27,7 @@
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 
 import java.util.ArrayList;
@@ -295,6 +296,6 @@ public void onClick(View v) {
 	}
 
 	private boolean isNightMode() {
-		return mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		return mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java b/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
index 9796e6bec9c..90a95fc611d 100644
--- a/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
+++ b/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
@@ -12,6 +12,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.myplaces.favorites.FavouritesHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 
 public class FavoriteDialogs {
@@ -47,7 +48,7 @@ public static AlertDialog.Builder checkDuplicates(@NonNull FavouritePoint point,
 			}
 		}
 		if ((!index.isEmpty() || emoticons)) {
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 			AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 			builder.setTitle(R.string.fav_point_dublicate);
diff --git a/OsmAnd/src/net/osmand/plus/dialogs/MapRenderingEngineDialog.java b/OsmAnd/src/net/osmand/plus/dialogs/MapRenderingEngineDialog.java
index 64e2afdda14..ac0bf988af3 100644
--- a/OsmAnd/src/net/osmand/plus/dialogs/MapRenderingEngineDialog.java
+++ b/OsmAnd/src/net/osmand/plus/dialogs/MapRenderingEngineDialog.java
@@ -17,6 +17,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.Version;
 import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.corenative.NativeCoreContext;
@@ -35,7 +36,7 @@ public MapRenderingEngineDialog(OsmandApplication app, FragmentActivity fragment
 	}
 
 	private AlertDialog createDialog(@Nullable OnRenderChangeListener renderChangeListener) {
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		Context themedContext = UiUtilities.getThemedContext(fragmentActivity, nightMode);
 		AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 		View alertDialogView = LayoutInflater.from(themedContext).inflate(R.layout.alert_dialog_message_with_choice_list, null, false);
diff --git a/OsmAnd/src/net/osmand/plus/dialogs/WhatsNewDialogFragment.java b/OsmAnd/src/net/osmand/plus/dialogs/WhatsNewDialogFragment.java
index 24f9652cfe8..ab99efaa36f 100644
--- a/OsmAnd/src/net/osmand/plus/dialogs/WhatsNewDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/dialogs/WhatsNewDialogFragment.java
@@ -18,6 +18,7 @@
 import net.osmand.plus.Version;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.settings.datastorage.SharedStorageWarningFragment;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 
 import java.lang.reflect.Field;
@@ -66,7 +67,7 @@ private void showArticle() {
 		if (mapActivity != null) {
 			OsmandApplication app = requireMyApplication();
 			Uri uri = Uri.parse(app.getString(R.string.docs_latest_version));
-			boolean nightMode = !app.getSettings().isLightContent();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			AndroidUtils.openUrl(mapActivity, uri, nightMode);
 		}
 	}
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/DownloadItemFragment.java b/OsmAnd/src/net/osmand/plus/download/ui/DownloadItemFragment.java
index 684712675ab..ae7342e81a0 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/DownloadItemFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/DownloadItemFragment.java
@@ -30,6 +30,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.plugins.custom.CustomIndexItem;
 import net.osmand.plus.plugins.custom.CustomRegion;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.dialogbutton.DialogButton;
@@ -61,7 +62,7 @@ public class DownloadItemFragment extends DialogFragment implements DownloadEven
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = !getMyApplication().getSettings().isLightContent();
+		nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/SearchDialogFragment.java b/OsmAnd/src/net/osmand/plus/download/ui/SearchDialogFragment.java
index 7f22db50ad7..7a182e69914 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/SearchDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/SearchDialogFragment.java
@@ -39,6 +39,7 @@
 import net.osmand.map.WorldRegion;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.widgets.tools.SimpleTextWatcher;
 import net.osmand.plus.download.CityItem;
 import net.osmand.plus.download.DownloadActivity;
@@ -94,7 +95,7 @@ public class SearchDialogFragment extends DialogFragment implements DownloadEven
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = requireMyApplication();
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/SuggestMapToolbarController.java b/OsmAnd/src/net/osmand/plus/download/ui/SuggestMapToolbarController.java
index b5ef0cd28e6..d79bb7e9125 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/SuggestMapToolbarController.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/SuggestMapToolbarController.java
@@ -15,6 +15,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.FontCache;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.mapwidgets.TopToolbarController;
@@ -45,7 +46,7 @@ public SuggestMapToolbarController(@NonNull MapActivity mapActivity, @NonNull St
 		SuggestMapToolbarController.regionName = regionName;
 		this.mapActivity = mapActivity;
 		this.app = mapActivity.getMyApplication();
-		this.nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		this.nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		this.mainView = UiUtilities.inflate(mapActivity, nightMode, R.layout.banner_suggest_map);
 		if (!AndroidUiHelper.isOrientationPortrait(mapActivity)) {
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/UpdatesIndexFragment.java b/OsmAnd/src/net/osmand/plus/download/ui/UpdatesIndexFragment.java
index 0dd541be067..7366d35a42a 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/UpdatesIndexFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/UpdatesIndexFragment.java
@@ -50,6 +50,7 @@
 import net.osmand.plus.liveupdates.LoadLiveMapsTask;
 import net.osmand.plus.liveupdates.LoadLiveMapsTask.LocalIndexInfoAdapter;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.util.Algorithms;
@@ -242,7 +243,7 @@ public void onCreateOptionsMenu(@NonNull Menu menu, @NonNull MenuInflater inflat
 			actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
 		}
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		if (app.getAppCustomization().showDownloadExtraActions()) {
 			int colorResId = ColorUtilities.getActiveButtonsAndLinksTextColorId(nightMode);
@@ -352,7 +353,7 @@ public View getView(int position, View convertView, @NonNull ViewGroup parent) {
 					view.setTag(new ItemViewHolder(view, getMyActivity()));
 				} else if (viewType == OSM_LIVE_BANNER) {
 					OsmandApplication app = getMyApplication();
-					boolean nightMode = !app.getSettings().isLightContent();
+					boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 					if (showSubscriptionPurchaseBanner) {
 						view = inflater.inflate(R.layout.osm_subscription_banner_list_item, parent, false);
 						ColorStateList stateList = AndroidUtils.createPressedColorStateList(app, nightMode,
diff --git a/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java b/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
index 6e8e39d8ec2..304bfa12ea7 100644
--- a/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
+++ b/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
@@ -58,6 +58,7 @@
 import net.osmand.plus.settings.datastorage.DataStorageFragment.StorageSelectionListener;
 import net.osmand.plus.settings.datastorage.DataStorageHelper;
 import net.osmand.plus.settings.datastorage.item.StorageItem;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.settings.fragments.SettingsScreenType;
 import net.osmand.plus.utils.AndroidNetworkUtils;
@@ -284,7 +285,7 @@ private void setupNightMode() {
 				deviceNightMode = false;
 				break;
 			case Configuration.UI_MODE_NIGHT_UNDEFINED:
-				deviceNightMode = !app.getSettings().isLightContent();
+				deviceNightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 				break;
 		}
 	}
diff --git a/OsmAnd/src/net/osmand/plus/help/HelpArticleDialogFragment.java b/OsmAnd/src/net/osmand/plus/help/HelpArticleDialogFragment.java
index cbc6157103f..021b2312e9b 100644
--- a/OsmAnd/src/net/osmand/plus/help/HelpArticleDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/help/HelpArticleDialogFragment.java
@@ -22,6 +22,7 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.util.Algorithms;
 
@@ -44,7 +45,7 @@ public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = (OsmandApplication) requireActivity().getApplication();
 
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 
diff --git a/OsmAnd/src/net/osmand/plus/help/HelpArticlesHelper.java b/OsmAnd/src/net/osmand/plus/help/HelpArticlesHelper.java
index 4a9863e9297..1520c75a8f0 100644
--- a/OsmAnd/src/net/osmand/plus/help/HelpArticlesHelper.java
+++ b/OsmAnd/src/net/osmand/plus/help/HelpArticlesHelper.java
@@ -11,7 +11,6 @@
 import android.content.Intent;
 import android.net.Uri;
 import android.os.AsyncTask;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.fragment.app.FragmentManager;
@@ -21,6 +20,7 @@
 import net.osmand.plus.Version;
 import net.osmand.plus.help.LoadArticlesTask.LoadArticlesListener;
 import net.osmand.plus.mapcontextmenu.other.ShareMenu;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.ctxmenu.data.ContextMenuItem;
@@ -197,7 +197,7 @@ private void createReportIssuesCategory(@NonNull List<ContextMenuItem> items) {
 
 	private void createAboutCategory(@NonNull List<ContextMenuItem> items) {
 		items.add(createCategory(app.getString(R.string.about_osmand)));
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		items.add(createMenuItem(app.getString(R.string.about_osmand), null, R.drawable.ic_action_osmand_logo,
 				getArticleItemClickListener(activity, app.getString(R.string.about_osmand), app.getString(R.string.osmand_about)))
diff --git a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
index 4f0c4557b00..04da1e8f4f5 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
@@ -22,6 +22,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.DayNightMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.util.SunriseSunset;
 
 import org.apache.commons.logging.Log;
@@ -110,63 +111,51 @@ private StateChangedListener<DayNightMode> getPreferenceStateListener() {
 		return preferenceStateListener;
 	}
 
-	public boolean isNightMode(boolean usedOnMap) {
-		return isNightMode(usedOnMap, new RequestThemeParams());
+	/**
+	 * @deprecated This method relies on the active application mode, which may produce incorrect theme results
+	 * when editing a profile different from the active one. Use {@link #isNightMode(ApplicationMode, ThemeUsageContext)}
+	 * instead and pass an explicit {@link ApplicationMode} to ensure correct theme resolution.
+	 */
+	@Deprecated
+	public boolean isNightMode(@NonNull ThemeUsageContext usageContext) {
+		return isNightMode(settings.getApplicationMode(), usageContext);
 	}
 
-	public boolean isNightMode(boolean usedOnMap, @NonNull ApplicationMode appMode) {
-		return isNightMode(usedOnMap, new RequestThemeParams(appMode));
-	}
-
-	public boolean isNightMode(boolean usedOnMap, @NonNull RequestThemeParams params) {
-		if (usedOnMap) {
-			return isNightModeForMapControls(params);
-		} else {
-			return !settings.isLightContentForMode(params.requireAppMode(app));
+	public boolean isNightMode(@NonNull ApplicationMode appMode,
+	                           @NonNull ThemeUsageContext usageContext) {
+		boolean appNightMode = !settings.isLightContentForMode(appMode);
+		if (usageContext == ThemeUsageContext.APP) {
+			return appNightMode;
 		}
-	}
-
-	public boolean isNightModeForMapControls() {
-		return isNightModeForMapControls(new RequestThemeParams());
-	}
-
-	public boolean isNightModeForMapControlsForProfile(ApplicationMode mode) {
-		return isNightModeForMapControls(new RequestThemeParams(mode));
-	}
 
-	public boolean isNightModeForMapControls(@NonNull RequestThemeParams params) {
-		if (settings.isLightContentForMode(params.requireAppMode(app))) {
-			return isNightModeForProfile(params);
-		} else {
+		if (usageContext == ThemeUsageContext.OVER_MAP && appNightMode) {
+			// Use Dark theme for UI over map if App Theme is Dark
 			return true;
 		}
-	}
 
-	public boolean isNightMode() {
-		return isNightModeForProfile(new RequestThemeParams());
-	}
-
-	private boolean isNightModeForProfile(@NonNull RequestThemeParams params) {
-		ApplicationMode appMode = params.requireAppMode(app);
 		DayNightMode dayNightMode = settings.DAYNIGHT_MODE.getModeValue(appMode);
-		if (externalMapThemeProvider != null && !params.shouldIgnoreExternalProvider()) {
+		if (externalMapThemeProvider != null) {
 			DayNightMode providedTheme = externalMapThemeProvider.getMapTheme();
 			dayNightMode = providedTheme != null ? providedTheme : dayNightMode;
 		}
+
 		NavigationSession carNavigationSession = app.getCarNavigationSession();
 		if (carNavigationSession != null && carNavigationSession.isStateAtLeast(State.CREATED)) {
 			boolean carDarkMode = carNavigationSession.getCarContext().isDarkMode();
 			dayNightMode = carDarkMode ? DayNightMode.NIGHT : DayNightMode.DAY;
 		}
+
 		if (dayNightMode.isDay()) {
 			return false;
-		} else if (dayNightMode.isNight()) {
+		}
+		if (dayNightMode.isNight()) {
 			return true;
-		} else if (dayNightMode.isAuto()) { // We are in auto mode!
+		}
+		if (dayNightMode.isAuto()) {
 			long currentTime = System.currentTimeMillis();
 			// allow recalculation each 60 seconds
 			if (currentTime - lastTime > 60000) {
-				lastTime = System.currentTimeMillis();
+				lastTime = currentTime;
 				try {
 					SunriseSunset daynightSwitch = getSunriseSunset();
 					if (daynightSwitch != null) {
@@ -181,10 +170,12 @@ private boolean isNightModeForProfile(@NonNull RequestThemeParams params) {
 				}
 			}
 			return lastNightMode;
-		} else if (dayNightMode.isSensor()) {
+		}
+		if (dayNightMode.isSensor()) {
 			return lastNightMode;
-		} else if (dayNightMode.isAppTheme()) {
-			return !settings.isLightContentForMode(appMode);
+		}
+		if (dayNightMode.isAppTheme()) {
+			return appNightMode;
 		}
 		return false;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/RequestThemeParams.java b/OsmAnd/src/net/osmand/plus/helpers/RequestThemeParams.java
deleted file mode 100644
index 69583625984..00000000000
--- a/OsmAnd/src/net/osmand/plus/helpers/RequestThemeParams.java
+++ /dev/null
@@ -1,35 +0,0 @@
-package net.osmand.plus.helpers;
-
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-
-import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.settings.backend.ApplicationMode;
-
-public class RequestThemeParams {
-
-	private final ApplicationMode appMode;
-	private final boolean ignoreExternalProvider;
-
-	public RequestThemeParams() {
-		this(null, false);
-	}
-
-	public RequestThemeParams(@Nullable ApplicationMode appMode) {
-		this(appMode, false);
-	}
-
-	public RequestThemeParams(@Nullable ApplicationMode appMode, boolean ignoreExternalProvider) {
-		this.appMode = appMode;
-		this.ignoreExternalProvider = ignoreExternalProvider;
-	}
-
-	@NonNull
-	public ApplicationMode requireAppMode(@NonNull OsmandApplication app) {
-		return appMode != null ? appMode : app.getSettings().getApplicationMode();
-	}
-
-	public boolean shouldIgnoreExternalProvider() {
-		return ignoreExternalProvider;
-	}
-}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/TrackSelectSegmentAdapter.java b/OsmAnd/src/net/osmand/plus/helpers/TrackSelectSegmentAdapter.java
index d55368b3871..e213fcef51f 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/TrackSelectSegmentAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/TrackSelectSegmentAdapter.java
@@ -11,6 +11,7 @@
 import androidx.recyclerview.widget.RecyclerView;
 import androidx.recyclerview.widget.RecyclerView.ViewHolder;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.primitives.Route;
 import net.osmand.shared.gpx.primitives.Track;
@@ -41,7 +42,7 @@ public class TrackSelectSegmentAdapter extends RecyclerView.Adapter<ItemViewHold
 
 	public TrackSelectSegmentAdapter(@NonNull Context ctx, @NonNull GpxFile gpxFile) {
 		app = (OsmandApplication) ctx.getApplicationContext();
-		themedInflater = UiUtilities.getInflater(ctx, app.getDaynightHelper().isNightModeForMapControls());
+		themedInflater = UiUtilities.getInflater(ctx, app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP));
 		iconsCache = app.getUIUtilities();
 		this.gpxItems = getGpxItems(gpxFile);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java b/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
index d9e2a35b426..e93367cc355 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
@@ -49,7 +49,7 @@
 import net.osmand.PlatformUtil;
 import net.osmand.plus.activities.OsmandActionBarActivity;
 import net.osmand.plus.importfiles.tasks.CopyToFileTask;
-import net.osmand.plus.myplaces.MyPlacesActivity;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.plus.AppInitializer;
@@ -599,7 +599,8 @@ public void onGpxSavingFinished(@NonNull List<String> warnings) {
 										BaseTransientBottomBar.LENGTH_LONG)
 								.setAction(R.string.shared_string_open, view -> openTrack(gpxFile, onGpxImport));
 
-						UiUtilities.setupSnackbar(snackbar, !app.getSettings().isLightContent());
+						boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+						UiUtilities.setupSnackbar(snackbar, nightMode);
 						snackbar.show();
 					} else {
 						openTrack(gpxFile, onGpxImport);
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
index 906f6f5943c..2029f55c5c7 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
@@ -16,6 +16,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.importfiles.ImportHelper;
 import net.osmand.plus.importfiles.ImportType;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.router.RoutingConfiguration.Builder;
@@ -93,7 +94,8 @@ private void showSuccessSnackbar(@NonNull String filename) {
 		if (AndroidUtils.isActivityNotDestroyed(activity)) {
 			Snackbar snackbar = Snackbar.make(activity.findViewById(android.R.id.content),
 					app.getString(R.string.is_imported, filename), Snackbar.LENGTH_LONG);
-			UiUtilities.setupSnackbar(snackbar, !app.getSettings().isLightContent());
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+			UiUtilities.setupSnackbar(snackbar, nightMode);
 			snackbar.show();
 		}
 	}
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentAdapter.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentAdapter.java
index 06666b8d89a..020722d24cf 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentAdapter.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.base.containers.ScreenItem;
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.FlowLayout;
 
@@ -215,7 +216,7 @@ private void setupSelectableBackground(@NonNull View view, @ColorInt int color)
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	private int getDimen(@DimenRes int resId) {
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
index 6ad20b02df1..cd3504e5d4b 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
@@ -39,6 +39,7 @@
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.quickaction.controller.AddQuickActionController;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.widgets.alert.AlertDialogData;
 import net.osmand.plus.widgets.alert.AlertDialogExtra;
 import net.osmand.plus.widgets.alert.CustomAlert;
@@ -347,7 +348,7 @@ private void askDismissDialog() {
 	}
 
 	public boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(false, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.APP);
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesAdapter.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesAdapter.java
index 2a9ce6cd99c..b88896edbe7 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesAdapter.java
@@ -27,6 +27,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.keyevent.devices.InputDeviceProfile;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.popup.PopUpMenu;
 import net.osmand.plus.widgets.popup.PopUpMenuDisplayData;
@@ -173,7 +174,7 @@ private void setupSelectableBackground(@NonNull View view, @ColorInt int color)
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	private int getDimen(@DimenRes int resId) {
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesController.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesController.java
index 2d1c4563fbd..d5416a5cab4 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesController.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/inputdevices/InputDevicesController.java
@@ -18,6 +18,7 @@
 import net.osmand.plus.keyevent.devices.CustomInputDeviceProfile;
 import net.osmand.plus.keyevent.devices.InputDeviceProfile;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.alert.AlertDialogData;
 import net.osmand.plus.widgets.alert.AlertDialogExtra;
@@ -133,6 +134,6 @@ public boolean isSelected(@NonNull InputDeviceProfile device) {
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/AdditionalActionsBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/AdditionalActionsBottomSheetDialogFragment.java
index 936e9d61490..feb37e86d1c 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/AdditionalActionsBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/AdditionalActionsBottomSheetDialogFragment.java
@@ -19,6 +19,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.widgets.ctxmenu.ContextMenuAdapter;
 import net.osmand.plus.widgets.ctxmenu.data.ContextMenuItem;
 import net.osmand.plus.R;
@@ -51,7 +52,7 @@ public void setAdapter(ContextMenuAdapter adapter, ContextMenuItemClickListener
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
 		Activity activity = requireActivity();
-		nightMode = requiredMyApplication().getDaynightHelper().isNightModeForMapControls();
+		nightMode = requiredMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		portrait = AndroidUiHelper.isOrientationPortrait(activity);
 		int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		availableScreenH = AndroidUtils.getScreenHeight(activity) - AndroidUtils.getStatusBarHeight(activity);
@@ -69,24 +70,16 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 		mainView.findViewById(R.id.divider).setBackgroundResource(nightMode
 				? R.color.card_and_list_background_dark : R.color.divider_color_light);
 
-		View.OnClickListener dismissOnClickListener = new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				dismiss();
-			}
-		};
+		View.OnClickListener dismissOnClickListener = view -> dismiss();
 
 		mainView.findViewById(R.id.cancel_row).setOnClickListener(dismissOnClickListener);
 		mainView.findViewById(R.id.scroll_view_container).setOnClickListener(dismissOnClickListener);
 
-		View.OnClickListener onClickListener = new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				if (listener != null) {
-					listener.onItemClick(view, (int) view.getTag());
-				}
-				dismiss();
+		View.OnClickListener onClickListener = view -> {
+			if (listener != null) {
+				listener.onItemClick(view, (int) view.getTag());
 			}
+			dismiss();
 		};
 
 		if (adapter != null) {
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/BaseMenuController.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/BaseMenuController.java
index 02a4c5fb9ed..ef24e674082 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/BaseMenuController.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/BaseMenuController.java
@@ -7,6 +7,7 @@
 import androidx.annotation.StringRes;
 
 import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.R;
@@ -56,7 +57,7 @@ public boolean isLight() {
 
 	public void updateNightMode() {
 		if (mapActivity != null) {
-			nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+			nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		}
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MenuBuilder.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MenuBuilder.java
index bcd30106fad..784ec72717b 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MenuBuilder.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MenuBuilder.java
@@ -88,6 +88,7 @@
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.search.dialogs.QuickSearchToolbarController;
 import net.osmand.plus.settings.backend.OsmAndAppCustomization;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.transport.TransportStopRoute;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
@@ -623,7 +624,7 @@ protected void buildNearestRowDividerIfMissing(@NonNull ViewGroup viewGroup, int
 	protected void buildNearestPhotosRow(View view) {
 		boolean needUpdateOnly = onlinePhotoCardsRow != null && onlinePhotoCardsRow.getMenuBuilder() == this;
 		onlinePhotoCardsRow = new CardsRowBuilder(this);
-		onlinePhotoCardsRow.build(galleryController, true, getApplication().getDaynightHelper().isNightModeForMapControls());
+		onlinePhotoCardsRow.build(galleryController, true, getApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP));
 
 		LinearLayout parent = new LinearLayout(view.getContext());
 		parent.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
@@ -1353,7 +1354,7 @@ private void buildTransportRowItem(View view, TransportStopRoute route, OnClickL
 		LinearLayout.LayoutParams typeTextParams = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);
 		typeTextView.setLayoutParams(typeTextParams);
 		typeTextView.setText(route.getTypeStrRes());
-		AndroidUtils.setTextSecondaryColor(getMapActivity(), typeTextView, getApplication().getDaynightHelper().isNightModeForMapControls());
+		AndroidUtils.setTextSecondaryColor(getMapActivity(), typeTextView, getApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP));
 		typeView.addView(typeTextView);
 
 		baseView.setOnClickListener(listener);
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/builders/AmenityMenuBuilder.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/builders/AmenityMenuBuilder.java
index a43e98906cc..e602ac660ff 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/builders/AmenityMenuBuilder.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/builders/AmenityMenuBuilder.java
@@ -37,6 +37,7 @@
 import net.osmand.plus.mapcontextmenu.controllers.AmenityMenuController;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.plugins.osmedit.OsmEditingPlugin;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.FontCache;
@@ -156,7 +157,8 @@ protected void buildReadFullWikiButton(@NonNull ViewGroup container, @Nullable L
 				}
 				MapActivity activity = app.getOsmandMap().getMapView().getMapActivity();
 				if (activity != null) {
-					AndroidUtils.openUrl(activity, Uri.parse(wikipediaUrl), app.getDaynightHelper().isNightMode());
+					boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
+					AndroidUtils.openUrl(activity, Uri.parse(wikipediaUrl), nightMode);
 				}
 			}
 		});
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/FavoritePointEditorFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/FavoritePointEditorFragment.java
index b6a1ccb5126..632fb937072 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/FavoritePointEditorFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/FavoritePointEditorFragment.java
@@ -23,6 +23,7 @@
 import net.osmand.data.BackgroundType;
 import net.osmand.data.FavouritePoint;
 import net.osmand.data.LatLon;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxUtilities.PointsGroup;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -284,7 +285,7 @@ protected void delete(boolean needDismiss) {
 		FavouritePoint favorite = getFavorite();
 		if (activity != null && favorite != null) {
 			OsmandApplication app = (OsmandApplication) activity.getApplication();
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(activity, nightMode));
 			builder.setMessage(getString(R.string.favourites_remove_dialog_msg, favorite.getName()));
 			builder.setNegativeButton(R.string.shared_string_no, null);
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/WptPtEditorFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/WptPtEditorFragment.java
index 147fefa20bf..d807e03dd29 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/WptPtEditorFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/WptPtEditorFragment.java
@@ -16,6 +16,7 @@
 import net.osmand.data.BackgroundType;
 import net.osmand.data.LatLon;
 import net.osmand.data.WptLocationPoint;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.GpxUtilities.PointsGroup;
 import net.osmand.shared.gpx.primitives.WptPt;
@@ -282,7 +283,7 @@ protected void delete(boolean needDismiss) {
 		FragmentActivity activity = getActivity();
 		if (activity != null) {
 			OsmandApplication app = (OsmandApplication) activity.getApplication();
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(activity, nightMode));
 			builder.setMessage(getString(R.string.context_menu_item_delete_waypoint));
 			builder.setNegativeButton(R.string.shared_string_no, null);
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconScreenAdapter.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconScreenAdapter.java
index f1d2108167b..b3e227b34f6 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconScreenAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconScreenAdapter.java
@@ -22,6 +22,7 @@
 import net.osmand.plus.mapcontextmenu.editors.icon.data.IconSearchResult;
 import net.osmand.plus.mapcontextmenu.editors.icon.data.IconsCategory;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.FlowLayout;
@@ -149,7 +150,7 @@ private View inflate(@LayoutRes int layoutResId) {
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap, appMode);
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	static class IconsCategoryViewHolder extends ViewHolder {
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedFragment.java
index 7b8b70a7364..57a43ffbc4d 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedFragment.java
@@ -30,6 +30,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmAndAppCustomization;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -56,7 +57,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		app = mapActivity.getMyApplication();
 		iconsCache = app.getUIUtilities();
 		ctxMenu = mapActivity.getContextMenu();
-		nighMode = app.getDaynightHelper().isNightModeForMapControls();
+		nighMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		isLandscapeLayout = !AndroidUiHelper.isOrientationPortrait(mapActivity);
 		app.getRoutingHelper().addCalculationProgressListener(this);
 		if (savedInstanceState != null) {
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/TrackDetailsMenu.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/TrackDetailsMenu.java
index 253f8bc50cd..7ac22baf6ac 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/TrackDetailsMenu.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/TrackDetailsMenu.java
@@ -32,6 +32,7 @@
 import net.osmand.data.QuadRect;
 import net.osmand.data.RotatedTileBox;
 import net.osmand.plus.charts.ElevationChartAppearance;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.GpxTrackAnalysis;
 import net.osmand.shared.gpx.primitives.TrkSegment;
@@ -574,7 +575,7 @@ private void updateView(View parentView, boolean forceFitTrackOnMap) {
 		}
 		OsmandApplication app = mapActivity.getMyApplication();
 		UiUtilities ic = app.getUIUtilities();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		GpxTrackAnalysis analysis = gpxItem.analysis;
 		if (analysis == null || gpxItem.chartTypes == null) {
 			parentView.setVisibility(View.GONE);
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
index de8586c0acf..d8e99f3c985 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
@@ -60,6 +60,7 @@
 import net.osmand.plus.mapmarkers.adapters.CoordinateInputAdapter;
 import net.osmand.plus.plugins.monitoring.SavingTrackHelper;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
 import net.osmand.plus.track.helpers.GpxSelectionHelper;
 import net.osmand.plus.utils.AndroidUtils;
@@ -127,7 +128,7 @@ public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 
 		app = getMyApplication();
-		lightTheme = app.getSettings().isLightContent();
+		lightTheme = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		setStyle(STYLE_NO_FRAME, lightTheme ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme);
 		newGpxFile = new GpxFile(Version.getFullVersion(app));
 		savingTrackHelper = app.getSavingTrackHelper();
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
index 003a674f2ca..212f05a884e 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
@@ -28,7 +28,6 @@
 
 import com.github.ksoichiro.android.observablescrollview.ObservableScrollView;
 import com.github.ksoichiro.android.observablescrollview.ObservableScrollViewCallbacks;
-import com.github.ksoichiro.android.observablescrollview.ScrollState;
 
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
@@ -93,7 +92,7 @@ public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging)
 		menuTv.setText(settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get() == 1 ? R.string.shared_string_one : R.string.shared_string_two);
 		menuTv.setCompoundDrawablesWithIntrinsicBounds(null, null, getContentIcon(R.drawable.ic_action_arrow_drop_down), null);
 		menuTv.setOnClickListener(view -> {
-			Context themedContext = UiUtilities.getThemedContext(getActivity(), !settings.isLightContent());
+			Context themedContext = UiUtilities.getThemedContext(getActivity(), nightMode);
 			CharSequence[] titles = getMenuTitles();
 			Paint paint = new Paint();
 			paint.setTextSize(getResources().getDimensionPixelSize(R.dimen.default_list_text_size));
@@ -146,7 +145,7 @@ public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging)
 
 	@Override
 	protected Drawable getContentIcon(int id) {
-		return getIcon(id, ColorUtilities.getDefaultIconColorId(!settings.isLightContent()));
+		return getIcon(id, ColorUtilities.getDefaultIconColorId(nightMode));
 	}
 
 	private MapActivity getMapActivity() {
@@ -163,7 +162,7 @@ private CharSequence[] getMenuTitles() {
 
 	private SpannableString getActiveString(int id) {
 		SpannableString res = new SpannableString(getString(id));
-		int activeColor = ColorUtilities.getActiveColor(getActivity(), !settings.isLightContent());
+		int activeColor = ColorUtilities.getActiveColor(app, nightMode);
 		res.setSpan(new ForegroundColorSpan(activeColor), 0, res.length(), 0);
 		return res;
 	}
@@ -196,37 +195,37 @@ private void updateHelpImage() {
 	}
 
 	private Drawable getTopBar2Img() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_topbar_2_day : R.drawable.img_help_markers_direction_topbar_2_night);
 	}
 
 	private Drawable getTopBar1Img() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_topbar_1_day : R.drawable.img_help_markers_direction_topbar_1_night);
 	}
 
 	private Drawable getArrowOneImg() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_arrow_one_day : R.drawable.img_help_markers_direction_arrow_one_night);
 	}
 
 	private Drawable getArrowTwoImg() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_arrow_two_day : R.drawable.img_help_markers_direction_arrow_two_night);
 	}
 
 	private Drawable getGuideLineOneImg() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_guideline_one_day : R.drawable.img_help_markers_direction_guideline_one_night);
 	}
 
 	private Drawable getGuideLineTwoImg() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_guideline_two_day : R.drawable.img_help_markers_direction_guideline_two_night);
 	}
 
 	private Drawable getDeviceImg() {
-		return getIcon(settings.isLightContent()
+		return getIcon(!nightMode
 				? R.drawable.img_help_markers_direction_device_day : R.drawable.img_help_markers_direction_device_night);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersActiveFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersActiveFragment.java
index ada9558bf49..00f2be344d2 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersActiveFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersActiveFragment.java
@@ -6,6 +6,7 @@
 import android.view.ViewGroup;
 import android.widget.ImageView;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.Location;
 import net.osmand.data.Amenity;
@@ -44,7 +45,9 @@ public class MapMarkersActiveFragment extends Fragment implements OsmAndCompassL
 	@Nullable
 	@Override
 	public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		MapActivity mapActivity = (MapActivity) getActivity();
+		MapActivity mapActivity = (MapActivity) requireActivity();
+		OsmandApplication app = mapActivity.getMyApplication();
+
 		View mainView = inflater.inflate(R.layout.fragment_map_markers_active, container, false);
 		EmptyStateRecyclerView recyclerView = mainView.findViewById(R.id.list);
 		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
@@ -65,7 +68,6 @@ public void onItemClick(View view) {
 				}
 
 				MapMarker marker = adapter.getItem(pos);
-				OsmandApplication app = mapActivity.getMyApplication();
 				if (app.getSettings().SELECT_MARKER_ON_SINGLE_TAP.get()) {
 					app.getMapMarkersHelper().moveMarkerToTop(marker);
 					updateAdapter();
@@ -95,7 +97,7 @@ public void onItemClick(View view) {
 			}
 
 			private void showMap(LatLon latLon, PointDescription desc, Object objToShow) {
-				mapActivity.getMyApplication().getSettings().setMapLocationToShow(latLon.getLatitude(),
+				app.getSettings().setMapLocationToShow(latLon.getLatitude(),
 						latLon.getLongitude(), 15, desc, true, objToShow);
 				MapActivity.launchMapActivityMoveToTop(mapActivity);
 				((DialogFragment) getParentFragment()).dismiss();
@@ -114,7 +116,7 @@ public void onDragOrSwipeEnded(RecyclerView.ViewHolder holder) {
 				toPosition = holder.getAdapterPosition();
 				if (toPosition >= 0 && fromPosition >= 0 && toPosition != fromPosition) {
 					hideSnackbar();
-					mapActivity.getMyApplication().getMapMarkersHelper().saveGroups(false);
+					app.getMapMarkersHelper().saveGroups(false);
 					adapter.notifyDataSetChanged();
 				}
 			}
@@ -127,8 +129,10 @@ public void onSwipeStarted() {
 
 		View emptyView = mainView.findViewById(R.id.empty_view);
 		ImageView emptyImageView = emptyView.findViewById(R.id.empty_state_image_view);
-		emptyImageView.setImageResource(mapActivity.getMyApplication().getSettings().isLightContent()
-				? R.drawable.ic_empty_state_marker_list_day : R.drawable.ic_empty_state_marker_list_night);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		emptyImageView.setImageResource(nightMode
+				? R.drawable.ic_empty_state_marker_list_night
+				: R.drawable.ic_empty_state_marker_list_day);
 		recyclerView.setEmptyView(emptyView);
 		recyclerView.setAdapter(adapter);
 		recyclerView.addOnScrollListener(new RecyclerView.OnScrollListener() {
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
index 549bb562c8d..139d73e9e52 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
@@ -8,7 +8,6 @@
 import android.view.ViewGroup;
 import android.widget.ProgressBar;
 import android.widget.TextView;
-import android.widget.Toast;
 
 import com.google.android.material.bottomnavigation.BottomNavigationView;
 import com.google.android.material.snackbar.Snackbar;
@@ -23,6 +22,7 @@
 import net.osmand.plus.mapmarkers.OrderByBottomSheetDialogFragment.OrderByFragmentListener;
 import net.osmand.plus.mapmarkers.SaveAsTrackBottomSheetDialogFragment.MarkerSaveAsTrackFragmentListener;
 import net.osmand.plus.mapmarkers.SyncGroupTask.OnGroupSyncedListener;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
@@ -75,7 +75,7 @@ public class MapMarkersDialogFragment extends DialogFragment implements OnGroupS
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = getMyApplication();
-		lightTheme = app.getSettings().isLightContent();
+		lightTheme = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		setStyle(STYLE_NO_FRAME, lightTheme ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme);
 	}
 
@@ -99,7 +99,7 @@ public void onBackPressed() {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, Bundle savedInstanceState) {
-		lightTheme = app.getSettings().isLightContent();
+		lightTheme = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		inflater = UiUtilities.getInflater(getContext(), !lightTheme);
 		List<Fragment> fragments = getChildFragmentManager().getFragments();
 		for (Fragment fragment : fragments) {
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
index 64ae6028f7a..32dcbccae80 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersGroupsFragment.java
@@ -22,6 +22,7 @@
 import com.google.android.material.snackbar.Snackbar;
 
 import net.osmand.Location;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.data.Amenity;
 import net.osmand.data.FavouritePoint;
@@ -79,9 +80,10 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 	@Nullable
 	@Override
 	public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		MapActivity mapActivity = (MapActivity) getActivity();
-		boolean night = !mapActivity.getMyApplication().getSettings().isLightContent();
-		mainView = UiUtilities.getInflater(mapActivity, night).inflate(R.layout.fragment_map_markers_groups, container, false);
+		MapActivity mapActivity = (MapActivity) requireActivity();
+		OsmandApplication app = mapActivity.getMyApplication();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		mainView = UiUtilities.getInflater(mapActivity, nightMode).inflate(R.layout.fragment_map_markers_groups, container, false);
 
 		Fragment selectionMarkersGroupFragment = getChildFragmentManager().findFragmentByTag(SelectionMarkersGroupBottomSheetDialogFragment.TAG);
 		if (selectionMarkersGroupFragment != null) {
@@ -102,7 +104,7 @@ public void onScrollStateChanged(RecyclerView recyclerView, int newState) {
 			}
 		});
 
-		backgroundPaint.setColor(ColorUtilities.getDividerColor(getActivity(), night));
+		backgroundPaint.setColor(ColorUtilities.getDividerColor(getActivity(), nightMode));
 		backgroundPaint.setStyle(Paint.Style.FILL_AND_STROKE);
 		backgroundPaint.setAntiAlias(true);
 		textPaint.setTextSize(getResources().getDimension(R.dimen.default_desc_text_size));
@@ -157,8 +159,8 @@ public void onChildDraw(Canvas c, RecyclerView recyclerView, RecyclerView.ViewHo
 						colorIcon = R.color.map_widget_blue;
 						colorText = R.color.map_widget_blue;
 					} else {
-						colorIcon = ColorUtilities.getDefaultIconColorId(night);
-						colorText = ColorUtilities.getSecondaryTextColorId(night);
+						colorIcon = ColorUtilities.getDefaultIconColorId(nightMode);
+						colorText = ColorUtilities.getSecondaryTextColorId(nightMode);
 					}
 					textPaint.setColor(ContextCompat.getColor(app, colorText));
 					Drawable icon = app.getUIUtilities().getIcon(
@@ -211,18 +213,15 @@ public void onSwiped(RecyclerView.ViewHolder viewHolder, int direction) {
 					}
 					updateAdapter();
 					snackbar = Snackbar.make(viewHolder.itemView, snackbarStringRes, Snackbar.LENGTH_LONG)
-							.setAction(R.string.shared_string_undo, new View.OnClickListener() {
-								@Override
-								public void onClick(View view) {
-									if (direction == ItemTouchHelper.RIGHT) {
-										app.getMapMarkersHelper().restoreMarkerFromHistory(marker, 0);
-									} else {
-										app.getMapMarkersHelper().addMarker(marker);
-									}
-									updateAdapter();
+							.setAction(R.string.shared_string_undo, view -> {
+								if (direction == ItemTouchHelper.RIGHT) {
+									app.getMapMarkersHelper().restoreMarkerFromHistory(marker, 0);
+								} else {
+									app.getMapMarkersHelper().addMarker(marker);
 								}
+								updateAdapter();
 							});
-					UiUtilities.setupSnackbar(snackbar, night);
+					UiUtilities.setupSnackbar(snackbar, nightMode);
 					snackbar.show();
 				}
 			}
@@ -239,9 +238,7 @@ public void onItemClick(View view) {
 					return;
 				}
 				Object item = adapter.getItem(pos);
-				if (item instanceof MapMarker) {
-					MapMarker marker = (MapMarker) item;
-					OsmandApplication app = mapActivity.getMyApplication();
+				if (item instanceof MapMarker marker) {
 					if (!marker.history) {
 						if (app.getSettings().SELECT_MARKER_ON_SINGLE_TAP.get()) {
 							app.getMapMarkersHelper().moveMarkerToTop(marker);
@@ -276,7 +273,7 @@ public void onItemClick(View view) {
 			}
 
 			private void showMap(LatLon latLon, PointDescription desc, Object objToShow) {
-				mapActivity.getMyApplication().getSettings().setMapLocationToShow(latLon.getLatitude(),
+				app.getSettings().setMapLocationToShow(latLon.getLatitude(),
 						latLon.getLongitude(), 15, desc, true, objToShow);
 				MapActivity.launchMapActivityMoveToTop(mapActivity);
 				((DialogFragment) getParentFragment()).dismiss();
@@ -321,7 +318,7 @@ public void onClick(View view) {
 		});
 		ImageView emptyImageView = emptyView.findViewById(R.id.empty_state_image_view);
 		if (Build.VERSION.SDK_INT >= 18) {
-			emptyImageView.setImageResource(night ? R.drawable.ic_empty_state_marker_group_night : R.drawable.ic_empty_state_marker_group_day);
+			emptyImageView.setImageResource(nightMode ? R.drawable.ic_empty_state_marker_group_night : R.drawable.ic_empty_state_marker_group_day);
 		} else {
 			emptyImageView.setVisibility(View.INVISIBLE);
 		}
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersHistoryFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersHistoryFragment.java
index 745b2e769e8..cca14180fd4 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersHistoryFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersHistoryFragment.java
@@ -24,6 +24,7 @@
 
 import com.google.android.material.snackbar.Snackbar;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
@@ -57,10 +58,10 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 	@Nullable
 	@Override
 	public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		boolean night = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		MapActivity mapActivity = (MapActivity) requireActivity();
 
-		backgroundPaint.setColor(ColorUtilities.getDividerColor(mapActivity, night));
+		backgroundPaint.setColor(ColorUtilities.getDividerColor(mapActivity, nightMode));
 		backgroundPaint.setStyle(Paint.Style.FILL_AND_STROKE);
 		backgroundPaint.setAntiAlias(true);
 		textPaint.setTextSize(getResources().getDimension(R.dimen.default_desc_text_size));
@@ -80,7 +81,7 @@ public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container,
 			((HistoryMarkerMenuBottomSheetDialogFragment) historyMarkerMenuFragment).setListener(createHistoryMarkerMenuListener());
 		}
 
-		View mainView = UiUtilities.getInflater(mapActivity, night).inflate(R.layout.fragment_map_markers_history, container, false);
+		View mainView = UiUtilities.getInflater(mapActivity, nightMode).inflate(R.layout.fragment_map_markers_history, container, false);
 		EmptyStateRecyclerView recyclerView = mainView.findViewById(R.id.list);
 		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
 
@@ -115,8 +116,8 @@ public void onChildDraw(Canvas c, RecyclerView recyclerView, RecyclerView.ViewHo
 						colorIcon = R.color.map_widget_blue;
 						colorText = R.color.map_widget_blue;
 					} else {
-						colorIcon = ColorUtilities.getDefaultIconColorId(night);
-						colorText = ColorUtilities.getSecondaryTextColorId(night);
+						colorIcon = ColorUtilities.getDefaultIconColorId(nightMode);
+						colorText = ColorUtilities.getSecondaryTextColorId(nightMode);
 					}
 					textPaint.setColor(ContextCompat.getColor(app, colorText));
 					Drawable icon = app.getUIUtilities().getIcon(
@@ -177,7 +178,7 @@ public void onClick(View view) {
 									}
 								}
 							});
-					UiUtilities.setupSnackbar(snackbar, night);
+					UiUtilities.setupSnackbar(snackbar, nightMode);
 					snackbar.show();
 				}
 			}
@@ -186,30 +187,26 @@ public void onClick(View view) {
 		itemTouchHelper.attachToRecyclerView(recyclerView);
 
 		adapter = new MapMarkersHistoryAdapter(mapActivity.getMyApplication());
-		adapter.setAdapterListener(new MapMarkersHistoryAdapter.MapMarkersHistoryAdapterListener() {
-			@Override
-			public void onItemClick(View view) {
-				int pos = recyclerView.getChildAdapterPosition(view);
-				if (pos == RecyclerView.NO_POSITION) {
-					return;
-				}
-				Object item = adapter.getItem(pos);
-				if (item instanceof MapMarker) {
-					MapMarker marker = (MapMarker) item;
-					HistoryMarkerMenuBottomSheetDialogFragment fragment = new HistoryMarkerMenuBottomSheetDialogFragment();
-					fragment.setUsedOnMap(false);
-					Bundle arguments = new Bundle();
-					arguments.putInt(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_POSITION, pos);
-					arguments.putString(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_NAME, marker.getName(mapActivity));
-					arguments.putInt(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_COLOR_INDEX, marker.colorIndex);
-					arguments.putLong(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_VISITED_DATE, marker.visitedDate);
-					fragment.setArguments(arguments);
-					fragment.setListener(createHistoryMarkerMenuListener());
-					fragment.show(mapActivity.getSupportFragmentManager(), HistoryMarkerMenuBottomSheetDialogFragment.TAG);
-				}
+		adapter.setAdapterListener(view -> {
+			int pos = recyclerView.getChildAdapterPosition(view);
+			if (pos == RecyclerView.NO_POSITION) {
+				return;
+			}
+			Object item = adapter.getItem(pos);
+			if (item instanceof MapMarker marker) {
+				HistoryMarkerMenuBottomSheetDialogFragment fragment = new HistoryMarkerMenuBottomSheetDialogFragment();
+				fragment.setUsedOnMap(false);
+				Bundle arguments = new Bundle();
+				arguments.putInt(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_POSITION, pos);
+				arguments.putString(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_NAME, marker.getName(mapActivity));
+				arguments.putInt(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_COLOR_INDEX, marker.colorIndex);
+				arguments.putLong(HistoryMarkerMenuBottomSheetDialogFragment.MARKER_VISITED_DATE, marker.visitedDate);
+				fragment.setArguments(arguments);
+				fragment.setListener(createHistoryMarkerMenuListener());
+				fragment.show(mapActivity.getSupportFragmentManager(), HistoryMarkerMenuBottomSheetDialogFragment.TAG);
 			}
 		});
-		recyclerView.setEmptyView(getEmptyView(mainView, night));
+		recyclerView.setEmptyView(getEmptyView(mainView, nightMode));
 		recyclerView.setAdapter(adapter);
 
 		app.getMapMarkersHelper().addListener(this);
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
index 87e957f8481..d6b473ecea7 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
@@ -12,6 +12,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.R;
 import net.osmand.plus.base.BottomSheetDialogFragment;
@@ -45,7 +46,8 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-		int themeRes = getMyApplication().getSettings().isLightContent() ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme;
+		boolean nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		int themeRes = !nightMode ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme;
 
 		View view = View.inflate(new ContextThemeWrapper(getContext(), themeRes), R.layout.fragment_marker_options_bottom_sheet_dialog, null);
 		view.setOnClickListener(v -> dismiss());
@@ -124,7 +126,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 			@Override
 			public void onGlobalLayout() {
 				Activity activity = getActivity();
-				boolean nightMode = !getMyApplication().getSettings().isLightContent();
+				boolean nightMode = requiredMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 				int allowedHeight = getAllowedHeight();
 
 				if (AndroidUiHelper.isOrientationPortrait(activity)) {
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/SaveAsTrackBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/SaveAsTrackBottomSheetDialogFragment.java
index 06939912ab4..15fae5b24b9 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/SaveAsTrackBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/SaveAsTrackBottomSheetDialogFragment.java
@@ -20,6 +20,7 @@
 
 import com.google.android.material.textfield.TextInputLayout;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.FileUtils;
 import net.osmand.IndexConstants;
@@ -60,7 +61,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 			}
 		}
 		portrait = AndroidUiHelper.isOrientationPortrait(getActivity());
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		int textPrimaryColor = ColorUtilities.getPrimaryTextColorId(nightMode);
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/CoordinateInputAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/CoordinateInputAdapter.java
index 2c99eee90c6..ae339b290ec 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/CoordinateInputAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/CoordinateInputAdapter.java
@@ -9,6 +9,7 @@
 import androidx.core.content.ContextCompat;
 import androidx.recyclerview.widget.RecyclerView;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.plus.OsmandApplication;
@@ -31,7 +32,7 @@ public class CoordinateInputAdapter extends RecyclerView.Adapter<MapMarkerItemVi
 	private final UiUtilities uiUtilities;
 	private final UpdateLocationViewCache updateViewCache;
 
-	private final boolean nightTheme;
+	private final boolean nightMode;
 
 	private View.OnClickListener listener;
 	private View.OnClickListener actionsListener;
@@ -50,7 +51,7 @@ public CoordinateInputAdapter(@NonNull Context context, GpxFile gpx) {
 
 		uiUtilities = app.getUIUtilities();
 		updateViewCache = UpdateLocationUtils.getUpdateLocationViewCache(context);
-		nightTheme = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	@NonNull
@@ -67,16 +68,16 @@ public void onBindViewHolder(@NonNull MapMarkerItemViewHolder holder, int positi
 
 		holder.iconDirection.setVisibility(View.VISIBLE);
 		holder.icon.setImageDrawable(PointImageUtils.getFromPoint(app, wpt.getColor(), false, wpt));
-		holder.mainLayout.setBackgroundColor(ColorUtilities.getListBgColor(app, nightTheme));
-		holder.title.setTextColor(ColorUtilities.getPrimaryTextColor(app, nightTheme));
-		holder.divider.setBackgroundColor(ContextCompat.getColor(app, nightTheme ? R.color.divider_color_dark : R.color.divider_color_light));
+		holder.mainLayout.setBackgroundColor(ColorUtilities.getListBgColor(app, nightMode));
+		holder.title.setTextColor(ColorUtilities.getPrimaryTextColor(app, nightMode));
+		holder.divider.setBackgroundColor(ContextCompat.getColor(app, nightMode ? R.color.divider_color_dark : R.color.divider_color_light));
 		holder.iconReorder.setVisibility(View.GONE);
 		holder.numberText.setVisibility(View.VISIBLE);
 		holder.numberText.setText(String.valueOf(position + 1));
 		holder.description.setVisibility(View.GONE);
 		holder.optionsBtn.setImageDrawable(app.getUIUtilities().getThemedIcon(R.drawable.ic_overflow_menu_white));
 		holder.optionsBtn.setOnClickListener(actionsListener);
-		AndroidUtils.setDashButtonBackground(app, holder.optionsBtn, nightTheme);
+		AndroidUtils.setDashButtonBackground(app, holder.optionsBtn, nightMode);
 
 		boolean singleItem = getItemCount() == 1;
 		boolean fistItem = position == 0;
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
index 47ddb8dcea2..802670d33df 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
@@ -23,6 +23,7 @@
 import net.osmand.plus.mapmarkers.ItineraryType;
 import net.osmand.plus.mapmarkers.MapMarker;
 import net.osmand.plus.mapmarkers.MapMarkersGroup;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.utils.UiUtilities;
@@ -55,7 +56,7 @@ public MapMarkersActiveAdapter(@NonNull MapActivity mapActivity) {
 		uiUtilities = app.getUIUtilities();
 		updateLocationViewCache = UpdateLocationUtils.getUpdateLocationViewCache(mapActivity);
 		markers = app.getMapMarkersHelper().getMapMarkers();
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		showDirectionEnabled = WidgetsVisibilityHelper.isWidgetEnabled(mapActivity, TOP, MARKERS_TOP_BAR.id);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
index ca939c3d57e..2a26a2913a7 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
@@ -20,6 +20,7 @@
 import com.google.android.material.snackbar.Snackbar;
 
 import net.osmand.IndexConstants;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.data.LatLon;
 import net.osmand.shared.gpx.GpxFile;
@@ -84,7 +85,7 @@ public MapMarkersGroupsAdapter(@NonNull MapActivity mapActivity) {
 		this.mapActivity = mapActivity;
 		app = mapActivity.getMyApplication();
 		updateLocationViewCache = UpdateLocationUtils.getUpdateLocationViewCache(mapActivity);
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		updateShowDirectionMarkers();
 		createDisplayGroups();
 	}
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersHistoryAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersHistoryAdapter.java
index 1dc615d7a84..fda85a27b1c 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersHistoryAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersHistoryAdapter.java
@@ -12,6 +12,7 @@
 
 import com.google.android.material.snackbar.Snackbar;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.OsmandApplication;
@@ -39,7 +40,7 @@ public class MapMarkersHistoryAdapter extends RecyclerView.Adapter<RecyclerView.
 
 	public MapMarkersHistoryAdapter(OsmandApplication app) {
 		this.app = app;
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		createHeaders();
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersItemTouchHelperCallback.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersItemTouchHelperCallback.java
index 86f1ff45410..50c43e1aa66 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersItemTouchHelperCallback.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersItemTouchHelperCallback.java
@@ -10,6 +10,7 @@
 import androidx.recyclerview.widget.ItemTouchHelper;
 import androidx.recyclerview.widget.RecyclerView;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -26,7 +27,7 @@ public class MapMarkersItemTouchHelperCallback extends ItemTouchHelper.Callback
 
 	private float marginSides;
 	private boolean iconHidden;
-	private boolean night;
+	private boolean nightMode;
 
 	private String delStr;
 	private String moveToHistoryStr;
@@ -43,9 +44,9 @@ public MapMarkersItemTouchHelperCallback(MapActivity mapActivity, ItemTouchHelpe
 		this.mapActivity = mapActivity;
 		this.adapter = adapter;
 		marginSides = mapActivity.getResources().getDimension(R.dimen.list_content_padding);
-		night = !mapActivity.getMyApplication().getSettings().isLightContent();
+		nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
-		backgroundPaint.setColor(ColorUtilities.getDividerColor(mapActivity, night));
+		backgroundPaint.setColor(ColorUtilities.getDividerColor(mapActivity, nightMode));
 		backgroundPaint.setStyle(Paint.Style.FILL_AND_STROKE);
 		backgroundPaint.setAntiAlias(true);
 		textPaint.setTextSize(mapActivity.getResources().getDimension(R.dimen.default_desc_text_size));
@@ -104,8 +105,8 @@ public void onChildDraw(Canvas c, RecyclerView recyclerView, RecyclerView.ViewHo
 				colorIcon = R.color.map_widget_blue;
 				colorText = R.color.map_widget_blue;
 			} else {
-				colorIcon = ColorUtilities.getDefaultIconColorId(night);
-				colorText = ColorUtilities.getSecondaryTextColorId(night);
+				colorIcon = ColorUtilities.getDefaultIconColorId(nightMode);
+				colorText = ColorUtilities.getSecondaryTextColorId(nightMode);
 			}
 			textPaint.setColor(ContextCompat.getColor(mapActivity, colorText));
 			Drawable icon = app.getUIUtilities().getIcon(R.drawable.ic_action_history, colorIcon);
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersListAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersListAdapter.java
index 56cca043641..85c3afa24fd 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersListAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersListAdapter.java
@@ -11,6 +11,7 @@
 import androidx.core.content.ContextCompat;
 import androidx.recyclerview.widget.RecyclerView;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.Location;
 import net.osmand.data.LatLon;
@@ -87,7 +88,7 @@ public void onClick(View view) {
 	@Override
 	public void onBindViewHolder(MapMarkerItemViewHolder holder, int pos) {
 		OsmandApplication app = mapActivity.getMyApplication();
-		boolean night = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		UiUtilities iconsCache = app.getUIUtilities();
 
 		boolean locationItem = showLocationItem && pos == 0;
@@ -109,8 +110,8 @@ public void onBindViewHolder(MapMarkerItemViewHolder holder, int pos) {
 			marker = (MapMarker) item;
 		}
 
-		holder.mainLayout.setBackgroundColor(ColorUtilities.getListBgColor(mapActivity, night));
-		holder.title.setTextColor(ContextCompat.getColor(mapActivity, night ? R.color.card_and_list_background_light : R.color.activity_background_color_dark));
+		holder.mainLayout.setBackgroundColor(ColorUtilities.getListBgColor(mapActivity, nightMode));
+		holder.title.setTextColor(ContextCompat.getColor(mapActivity, nightMode ? R.color.card_and_list_background_light : R.color.activity_background_color_dark));
 		holder.title.setText(location != null ? mapActivity.getString(R.string.shared_string_my_location) : marker.getName(mapActivity));
 		holder.iconDirection.setVisibility(View.GONE);
 		holder.optionsBtn.setVisibility(roundTripFinishItem ? View.VISIBLE : View.GONE);
@@ -119,34 +120,19 @@ public void onBindViewHolder(MapMarkerItemViewHolder holder, int pos) {
 			TypedValue outValue = new TypedValue();
 			mapActivity.getTheme().resolveAttribute(android.R.attr.selectableItemBackground, outValue, true);
 			holder.optionsBtn.setBackgroundResource(outValue.resourceId);
-			holder.optionsBtn.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View view) {
-					listener.onDisableRoundTripClick();
-				}
-			});
+			holder.optionsBtn.setOnClickListener(view -> listener.onDisableRoundTripClick());
 		}
-		holder.divider.setBackgroundColor(ContextCompat.getColor(mapActivity, night ? R.color.app_bar_main_dark : R.color.divider_color_light));
+		holder.divider.setBackgroundColor(ContextCompat.getColor(mapActivity, nightMode ? R.color.app_bar_main_dark : R.color.divider_color_light));
 		holder.divider.setVisibility(lastMarkerItem ? View.GONE : View.VISIBLE);
 		holder.checkBox.setVisibility(roundTripFinishItem ? View.GONE : View.VISIBLE);
 		if (!roundTripFinishItem) {
-			holder.checkBox.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View view) {
-					listener.onCheckBoxClick(holder.itemView);
-				}
-			});
-			holder.checkBoxContainer.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View view) {
-					holder.checkBox.performClick();
-				}
-			});
+			holder.checkBox.setOnClickListener(view -> listener.onCheckBoxClick(holder.itemView));
+			holder.checkBoxContainer.setOnClickListener(view -> holder.checkBox.performClick());
 		}
 		holder.bottomShadow.setVisibility(lastMarkerItem ? View.VISIBLE : View.GONE);
 		holder.iconReorder.setVisibility(View.VISIBLE);
 		holder.iconReorder.setImageDrawable(iconsCache.getThemedIcon(R.drawable.ic_action_item_move));
-		holder.description.setTextColor(ColorUtilities.getDefaultIconColor(app, night));
+		holder.description.setTextColor(ColorUtilities.getDefaultIconColor(app, nightMode));
 
 		holder.firstDescription.setVisibility((start || finish) ? View.VISIBLE : View.GONE);
 		if (start) {
@@ -180,20 +166,17 @@ public void onClick(View view) {
 			holder.checkBox.setChecked(marker.selected);
 
 			holder.iconReorder.setAlpha(1f);
-			holder.iconReorder.setOnTouchListener(new View.OnTouchListener() {
-				@Override
-				public boolean onTouch(View view, MotionEvent event) {
-					if (event.getActionMasked() == MotionEvent.ACTION_DOWN) {
-						inDragAndDrop = true;
-						if (showRoundTripItem) {
-							int roundTripItemPos = finishPos;
-							reloadData();
-							notifyItemRemoved(roundTripItemPos);
-						}
-						listener.onDragStarted(holder);
+			holder.iconReorder.setOnTouchListener((view, event) -> {
+				if (event.getActionMasked() == MotionEvent.ACTION_DOWN) {
+					inDragAndDrop = true;
+					if (showRoundTripItem) {
+						int roundTripItemPos = finishPos;
+						reloadData();
+						notifyItemRemoved(roundTripItemPos);
 					}
-					return false;
+					listener.onDragStarted(holder);
 				}
+				return false;
 			});
 
 			String descr;
@@ -214,7 +197,7 @@ public boolean onTouch(View view, MotionEvent event) {
 		holder.leftPointSpace.setVisibility(visibility);
 		holder.rightPointSpace.setVisibility(visibility);
 		if (showDistance) {
-			holder.distance.setTextColor(ContextCompat.getColor(mapActivity, night ? R.color.color_distance : R.color.color_myloc_distance));
+			holder.distance.setTextColor(ContextCompat.getColor(mapActivity, nightMode ? R.color.color_distance : R.color.color_myloc_distance));
 			LatLon first = firstSelectedMarker && useLocation
 					? new LatLon(myLoc.getLatitude(), myLoc.getLongitude())
 					: getPreviousSelectedMarkerLatLon(pos);
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/RouteBetweenPointsBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/measurementtool/RouteBetweenPointsBottomSheetDialogFragment.java
index ec8af6af4f8..bf792fa1a07 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/RouteBetweenPointsBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/RouteBetweenPointsBottomSheetDialogFragment.java
@@ -26,6 +26,7 @@
 import net.osmand.plus.base.BottomSheetBehaviourDialogFragment;
 import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.utils.UiUtilities;
@@ -84,7 +85,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 			dialogType = (RouteBetweenPointsDialogType) savedInstanceState.get(DIALOG_TYPE_KEY);
 			defaultDialogMode = (RouteBetweenPointsDialogMode) savedInstanceState.get(DEFAULT_DIALOG_MODE_KEY);
 		}
-		nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		View mainView = UiUtilities.getInflater(getContext(), nightMode)
 				.inflate(R.layout.fragment_route_between_points_bottom_sheet_dialog,
 						null, false);
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/adapter/MeasurementToolAdapter.java b/OsmAnd/src/net/osmand/plus/measurementtool/adapter/MeasurementToolAdapter.java
index 8baee8f141e..1b2ea3e2f3b 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/adapter/MeasurementToolAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/adapter/MeasurementToolAdapter.java
@@ -13,6 +13,7 @@
 import androidx.recyclerview.widget.RecyclerView;
 import androidx.recyclerview.widget.RecyclerView.ViewHolder;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.Location;
 import net.osmand.plus.utils.ColorUtilities;
@@ -46,7 +47,7 @@ public void setAdapterListener(MeasurementAdapterListener listener) {
 
 	@Override
 	public MeasureToolItemVH onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) {
-		nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		LayoutInflater inflater = UiUtilities.getInflater(mapActivity, nightMode);
 		View view = inflater.inflate(R.layout.measure_points_list_item, viewGroup, false);
 		if (!nightMode) {
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java b/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
index d2d2a0ce9cf..7d342c670ec 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
@@ -10,6 +10,7 @@
 import com.github.mikephil.charting.listener.ChartTouchListener;
 
 import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -87,7 +88,7 @@ public void setLayoutChangeListener(@Nullable LayoutChangeListener layoutChangeL
 	}
 
 	protected boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	public interface ExternalValueSelectedListener {
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesSearchFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesSearchFragment.java
index 5fc4bf02640..8f60486cbcf 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesSearchFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesSearchFragment.java
@@ -47,6 +47,7 @@
 import net.osmand.plus.myplaces.favorites.FavouritesHelper;
 import net.osmand.plus.plugins.accessibility.AccessibilityAssistant;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -85,7 +86,7 @@ public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = getMyApplication();
 		accessibilityAssistant = new AccessibilityAssistant(requireActivity());
-		boolean isLightTheme = app.getSettings().isLightContent();
+		boolean isLightTheme = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = isLightTheme ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 	}
@@ -302,7 +303,7 @@ public FavoritesSearchListAdapter(@NonNull OsmandApplication app) {
 			this.app = app;
 			this.helper = app.getFavoritesHelper();
 			location = app.getSettings().getLastKnownMapLocation();
-			boolean light = app.getSettings().isLightContent();
+			boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			enabledColor = ColorUtilities.getPrimaryTextColorId(!light);
 			disabledColor = ColorUtilities.getSecondaryTextColorId(!light);
 			disabledIconColor = ColorUtilities.getDefaultIconColorId(!light);
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
index 60f7e02b907..1b15dae9f10 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
@@ -57,6 +57,7 @@
 import net.osmand.plus.myplaces.favorites.ShareFavoritesAsyncTask;
 import net.osmand.plus.myplaces.favorites.ShareFavoritesAsyncTask.ShareFavoritesListener;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.FontCache;
@@ -167,7 +168,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 		listView = view.findViewById(android.R.id.list);
 		adapter.synchronizeGroups();
 		if (!adapter.isEmpty()) {
-			boolean nightMode = !app.getSettings().isLightContent();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			View searchView = inflater.inflate(R.layout.search_fav_list_item, listView, false);
 			searchView.setBackgroundResource(ColorUtilities.getListBgColorId(nightMode));
 
@@ -192,7 +193,8 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 		}
 		View emptyView = view.findViewById(android.R.id.empty);
 		ImageView emptyImageView = emptyView.findViewById(R.id.empty_state_image_view);
-		emptyImageView.setImageResource(app.getSettings().isLightContent() ? R.drawable.ic_empty_state_favorites_day : R.drawable.ic_empty_state_favorites_night);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		emptyImageView.setImageResource(!nightMode ? R.drawable.ic_empty_state_favorites_day : R.drawable.ic_empty_state_favorites_night);
 		Button importButton = emptyView.findViewById(R.id.import_button);
 		importButton.setOnClickListener(view1 -> importFavourites());
 		listView.setEmptyView(emptyView);
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/MapBitmapDrawer.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/MapBitmapDrawer.java
index 4cf04ed1bfa..2d5c197f042 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/MapBitmapDrawer.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/MapBitmapDrawer.java
@@ -9,6 +9,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.render.MapRenderRepositories;
 import net.osmand.plus.resources.ResourceManager;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
 
 import java.util.ArrayList;
@@ -70,7 +71,8 @@ public void initAndDraw() {
 		notifyDrawing();
 		createTileBox();
 
-		DrawSettings drawSettings = new DrawSettings(!app.getSettings().isLightContent(), true);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		DrawSettings drawSettings = new DrawSettings(nightMode, true);
 		ResourceManager resourceManager = app.getResourceManager();
 		MapRenderRepositories renderer = resourceManager.getRenderer();
 		if (resourceManager.updateRenderedMapNeeded(tileBox, drawSettings)) {
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/SearchMyPlacesTracksFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/SearchMyPlacesTracksFragment.java
index 5de3ba9c7c0..0f4f5b22cbc 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/SearchMyPlacesTracksFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/SearchMyPlacesTracksFragment.java
@@ -11,7 +11,6 @@
 import android.view.ViewGroup;
 import android.widget.ImageButton;
 import android.widget.TextView;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -21,6 +20,7 @@
 import androidx.fragment.app.FragmentActivity;
 import androidx.fragment.app.FragmentManager;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.plus.R;
 import net.osmand.plus.configmap.tracks.SearchTracksAdapter;
@@ -233,7 +233,7 @@ protected void setupToolbar(@NonNull View view) {
 				Set<TrackItem> trackItems = selectionHelper.getSelectedItems();
 				SearchMyPlacesTracksFragment currentFragment = SearchMyPlacesTracksFragment.this;
 				foldersHelper.showItemsOptionsMenu(actionButton, null, trackItems, new HashSet<>(),
-						currentFragment, currentFragment, app.getDaynightHelper().isNightMode(false));
+						currentFragment, currentFragment, app.getDaynightHelper().isNightMode(ThemeUsageContext.APP));
 			}
 		});
 
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/controller/SmartFolderOptionsController.kt b/OsmAnd/src/net/osmand/plus/myplaces/tracks/controller/SmartFolderOptionsController.kt
index 6c4040c0c6f..c4d6da3b199 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/controller/SmartFolderOptionsController.kt
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/controller/SmartFolderOptionsController.kt
@@ -11,6 +11,7 @@ import net.osmand.plus.base.dialog.data.DisplayItem
 import net.osmand.plus.base.dialog.interfaces.controller.IDialogItemClicked
 import net.osmand.plus.base.dialog.interfaces.controller.IDisplayDataProvider
 import net.osmand.plus.settings.bottomsheets.CustomizableOptionsBottomSheet
+import net.osmand.plus.settings.enums.ThemeUsageContext
 import net.osmand.plus.widgets.alert.AlertDialogData
 import net.osmand.plus.widgets.alert.AlertDialogExtra
 import net.osmand.plus.widgets.alert.CustomAlert
@@ -33,16 +34,14 @@ class SmartFolderOptionsController(
 	override fun getDisplayData(processId: String): DisplayData? {
 		val iconsCache = app.uiUtilities
 		val displayData = DisplayData()
-		iconsCache.getActiveIcon(R.drawable.ic_action_folder_smart, app.daynightHelper.isNightMode)
+		val nightMode = app.daynightHelper.isNightMode(ThemeUsageContext.MAP)
+		iconsCache.getActiveIcon(R.drawable.ic_action_folder_smart, nightMode)
 		displayData.addDisplayItem(
 			DisplayItem()
 				.setTitle(smartFolder.getName())
 				.setDescription("${smartFolder.getTrackItems().size} ${app.getString(R.string.shared_string_tracks)}")
 				.setLayoutId(R.layout.bottom_sheet_item_with_descr_72dp)
-				.setIcon(
-					iconsCache.getActiveIcon(
-						R.drawable.ic_action_folder_smart,
-						app.daynightHelper.isNightMode))
+				.setIcon(iconsCache.getActiveIcon(R.drawable.ic_action_folder_smart, nightMode))
 				.setShowBottomDivider(true, 0)
 		)
 		val dividerPadding = calculateSubtitleDividerPadding()
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentDialogFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentDialogFragment.java
index f80d801ce03..9970d6d1771 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentDialogFragment.java
@@ -27,6 +27,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.base.BaseOsmAndDialogFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.GpxSplitParams;
 import net.osmand.plus.track.GpxSplitType;
 import net.osmand.plus.track.SplitTrackAsyncTask.SplitTrackListener;
@@ -299,7 +300,7 @@ private void setupSplitIntervalView(@NonNull View view) {
 		TextView title = view.findViewById(R.id.split_interval_title);
 		TextView text = view.findViewById(R.id.split_interval_text);
 		ImageView img = view.findViewById(R.id.split_interval_arrow);
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int colorId;
 		List<GpxDisplayGroup> groups = getDisplayGroups();
 		if (!groups.isEmpty()) {
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentsAdapter.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentsAdapter.java
index 98b990520df..ee1d3a3f845 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentsAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/SplitSegmentsAdapter.java
@@ -23,6 +23,7 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.helpers.GpxDisplayItem;
 import net.osmand.plus.track.helpers.TrackDisplayGroup;
 import net.osmand.plus.utils.AndroidUtils;
@@ -74,12 +75,12 @@ public View getView(int position, @Nullable View convertView, @NonNull ViewGroup
 			convertView = activity.getLayoutInflater().inflate(R.layout.gpx_split_segment_fragment, parent, false);
 		}
 		convertView.setOnClickListener(null);
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int activeColorId = ColorUtilities.getActiveColorId(nightMode);
 		TextView overviewTextView = convertView.findViewById(R.id.overview_text);
 		ImageView overviewImageView = convertView.findViewById(R.id.overview_image);
 		if (position == 0) {
-			overviewImageView.setImageDrawable(getIcon(R.drawable.ic_action_time_span_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+			overviewImageView.setImageDrawable(getIcon(R.drawable.ic_action_time_span_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 			if (defaultTextColor == null) {
 				defaultTextColor = overviewTextView.getTextColors();
 			}
@@ -134,21 +135,21 @@ public View getView(int position, @Nullable View convertView, @NonNull ViewGroup
 		}
 
 		((ImageView) convertView.findViewById(R.id.start_time_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_time_start_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_time_start_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.end_time_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_time_end_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_time_end_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.average_altitude_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_average_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_average_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.altitude_range_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_range_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_range_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.ascent_descent_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_descent_ascent_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_altitude_descent_ascent_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.moving_time_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_time_moving_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_time_moving_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.average_speed_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_speed_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_speed_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 		((ImageView) convertView.findViewById(R.id.max_speed_image))
-				.setImageDrawable(getIcon(R.drawable.ic_action_max_speed_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+				.setImageDrawable(getIcon(R.drawable.ic_action_max_speed_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 
 		if (currentGpxDisplayItem != null) {
 			GpxTrackAnalysis analysis = currentGpxDisplayItem.analysis;
@@ -157,13 +158,13 @@ public View getView(int position, @Nullable View convertView, @NonNull ViewGroup
 				TextView distanceOrTimeSpanValue = convertView.findViewById(R.id.distance_or_time_span_value);
 				TextView distanceOrTimeSpanText = convertView.findViewById(R.id.distance_or_time_span_text);
 				if (position == 0) {
-					distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_track_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+					distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_track_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 					float totalDistance = displayItem.isGeneralTrack() ? analysis.getTotalDistanceWithoutGaps() : analysis.getTotalDistance();
 					distanceOrTimeSpanValue.setText(OsmAndFormatter.getFormattedDistance(totalDistance, app));
 					distanceOrTimeSpanText.setText(app.getString(R.string.distance));
 				} else {
 					if (trackGroup != null && trackGroup.isSplitDistance()) {
-						distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_time_span_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+						distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_time_span_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 						if (analysis.getDurationInMs() > 0) {
 							distanceOrTimeSpanValue.setText(Algorithms.formatDuration(analysis.getDurationInSeconds(), app.accessibilityEnabled()));
 						} else {
@@ -171,7 +172,7 @@ public View getView(int position, @Nullable View convertView, @NonNull ViewGroup
 						}
 						distanceOrTimeSpanText.setText(app.getString(R.string.shared_string_time_span));
 					} else if (trackGroup != null && trackGroup.isSplitTime()) {
-						distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_track_16, app.getSettings().isLightContent() ? R.color.gpx_split_segment_icon_color : 0));
+						distanceOrTimeSpanImageView.setImageDrawable(getIcon(R.drawable.ic_action_track_16, !nightMode ? R.color.gpx_split_segment_icon_color : 0));
 						distanceOrTimeSpanValue.setText(OsmAndFormatter.getFormattedDistance(analysis.getTotalDistance(), app));
 						distanceOrTimeSpanText.setText(app.getString(R.string.distance));
 					}
diff --git a/OsmAnd/src/net/osmand/plus/plugins/audionotes/AudioVideoNotesPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/audionotes/AudioVideoNotesPlugin.java
index 9df4657286a..ba1b0f5faea 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/audionotes/AudioVideoNotesPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/audionotes/AudioVideoNotesPlugin.java
@@ -40,7 +40,6 @@
 import android.view.SurfaceHolder.Callback;
 import android.view.SurfaceView;
 import android.view.WindowManager;
-import android.widget.Toast;
 
 import androidx.annotation.IntDef;
 import androidx.annotation.NonNull;
@@ -72,6 +71,7 @@
 import net.osmand.plus.settings.backend.WidgetsAvailabilityHelper;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.SettingsScreenType;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
@@ -464,7 +464,7 @@ public void makeAction(@NonNull MapActivity mapActivity, int actionId) {
 	}
 
 	private void chooseDefaultAction(double lat, double lon, MapActivity mapActivity) {
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		AlertDialog.Builder ab = new AlertDialog.Builder(UiUtilities.getThemedContext(mapActivity, nightMode));
 		ab.setItems(
 				new String[] {mapActivity.getString(R.string.recording_context_menu_arecord),
diff --git a/OsmAnd/src/net/osmand/plus/plugins/audionotes/NotesFragment.java b/OsmAnd/src/net/osmand/plus/plugins/audionotes/NotesFragment.java
index 494ec96e09f..4b1a3c3e932 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/audionotes/NotesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/audionotes/NotesFragment.java
@@ -45,6 +45,7 @@
 import net.osmand.plus.plugins.audionotes.ItemMenuBottomSheetDialogFragment.ItemMenuFragmentListener;
 import net.osmand.plus.plugins.audionotes.adapters.NotesAdapter;
 import net.osmand.plus.plugins.audionotes.adapters.NotesAdapter.NotesAdapterListener;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 
@@ -93,7 +94,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		setHasOptionsMenu(true);
 
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		View view = inflater.inflate(R.layout.update_index, container, false);
 		view.findViewById(R.id.header_layout).setVisibility(View.GONE);
 		ViewStub emptyStub = view.findViewById(R.id.empty_view_stub);
@@ -112,7 +113,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 	public void onActivityCreated(Bundle savedInstanceState) {
 		super.onActivityCreated(savedInstanceState);
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		getListView().setBackgroundColor(ColorUtilities.getActivityBgColor(app, nightMode));
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/audionotes/adapters/NotesAdapter.java b/OsmAnd/src/net/osmand/plus/plugins/audionotes/adapters/NotesAdapter.java
index ca1243b514a..391e0e5fb06 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/audionotes/adapters/NotesAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/audionotes/adapters/NotesAdapter.java
@@ -15,6 +15,7 @@
 import androidx.annotation.NonNull;
 import androidx.core.content.ContextCompat;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -68,7 +69,7 @@ public NotesAdapter(OsmandApplication app, List<Object> items) {
 	@NonNull
 	@Override
 	public View getView(int position, View row, @NonNull ViewGroup parent) {
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		Context themedCtx = UiUtilities.getThemedContext(getContext(), nightMode);
 		if (portrait) {
 			int type = getItemViewType(position);
@@ -216,7 +217,7 @@ private void setupItem(int position, Recording recording, ItemViewHolder holder)
 			holder.description.setText(recording.getExtendedDescription(app));
 			int iconRes = recording.isAudio() ? R.drawable.ic_type_audio
 					: (recording.isVideo() ? R.drawable.ic_type_video : R.drawable.ic_type_img);
-			int colorRes = ColorUtilities.getDefaultIconColorId(!app.getSettings().isLightContent());
+			int colorRes = ColorUtilities.getDefaultIconColorId(app.getDaynightHelper().isNightMode(ThemeUsageContext.APP));
 			holder.icon.setImageDrawable(app.getUIUtilities().getIcon(iconRes, colorRes));
 		}
 
@@ -226,35 +227,26 @@ private void setupItem(int position, Recording recording, ItemViewHolder holder)
 		holder.options.setVisibility(selectionMode ? View.GONE : View.VISIBLE);
 		if (selectionMode) {
 			holder.checkBox.setChecked(selected.contains(recording));
-			holder.checkBox.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					if (listener != null) {
-						listener.onCheckBoxClick(recording, holder.checkBox.isChecked());
-					}
+			holder.checkBox.setOnClickListener(v -> {
+				if (listener != null) {
+					listener.onCheckBoxClick(recording, holder.checkBox.isChecked());
 				}
 			});
 		} else {
 			holder.options.setImageDrawable(app.getUIUtilities().getThemedIcon(R.drawable.ic_overflow_menu_white));
-			holder.options.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					if (listener != null) {
-						listener.onOptionsClick(recording);
-					}
+			holder.options.setOnClickListener(v -> {
+				if (listener != null) {
+					listener.onOptionsClick(recording);
 				}
 			});
 		}
 
-		holder.view.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				if (selectionMode) {
-					holder.checkBox.performClick();
-				} else {
-					if (listener != null) {
-						listener.onItemClick(recording, position);
-					}
+		holder.view.setOnClickListener(v -> {
+			if (selectionMode) {
+				holder.checkBox.performClick();
+			} else {
+				if (listener != null) {
+					listener.onItemClick(recording, position);
 				}
 			}
 		});
diff --git a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/SensorAttributesUtils.java b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/SensorAttributesUtils.java
index d3c36b73b25..e54bf90246f 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/SensorAttributesUtils.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/SensorAttributesUtils.java
@@ -18,6 +18,7 @@
 import com.github.mikephil.charting.components.YAxis;
 import com.github.mikephil.charting.data.Entry;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxTrackAnalysis;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.shared.gpx.PointAttributes;
@@ -26,7 +27,6 @@
 import net.osmand.plus.charts.GPXDataSetAxisType;
 import net.osmand.plus.charts.GPXDataSetType;
 import net.osmand.plus.charts.OrderedLineDataSet;
-import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.util.Algorithms;
@@ -146,8 +146,7 @@ public static OrderedLineDataSet createSensorDataSet(@NonNull OsmandApplication
 	                                                     boolean useRightAxis,
 	                                                     boolean drawFilled,
 	                                                     boolean calcWithoutGaps) {
-		OsmandSettings settings = app.getSettings();
-		boolean nightMode = !settings.isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		float divX = ChartUtils.getDivX(app, chart, analysis, axisType, calcWithoutGaps);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/ForgetDeviceBaseDialog.kt b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/ForgetDeviceBaseDialog.kt
index 3a6a0e7251b..d237e2dd2f1 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/ForgetDeviceBaseDialog.kt
+++ b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/ForgetDeviceBaseDialog.kt
@@ -9,6 +9,7 @@ import androidx.core.content.ContextCompat
 import net.osmand.plus.OsmandApplication
 import net.osmand.plus.R
 import net.osmand.plus.base.BottomSheetDialogFragment
+import net.osmand.plus.settings.enums.ThemeUsageContext
 import net.osmand.plus.utils.AndroidUtils
 import net.osmand.plus.utils.ColorUtilities
 
@@ -27,7 +28,7 @@ abstract class ForgetDeviceBaseDialog : BottomSheetDialogFragment() {
 		super.onCreate(savedInstanceState)
 		val context = requireContext()
 		app = context.applicationContext as OsmandApplication
-		nightMode = app.daynightHelper.isNightModeForMapControls
+		nightMode = app.daynightHelper.isNightMode(ThemeUsageContext.OVER_MAP)
 		val deviceId = arguments?.getString(DEVICE_ID_KEY)
 		deviceId?.let { initDevice(it) }
 	}
diff --git a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/PairNewDeviceBottomSheet.java b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/PairNewDeviceBottomSheet.java
index 8840cf6aae7..534c6f025d8 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/PairNewDeviceBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/PairNewDeviceBottomSheet.java
@@ -15,6 +15,7 @@
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.DividerItem;
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.DividerSpaceItem;
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.TitleItem;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.widgets.dialogbutton.DialogButtonType;
 
@@ -66,7 +67,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 				.setOnClickListener(v -> {
 					dismiss();
 					FragmentActivity activity = getActivity();
-					boolean nightMode = getMyApplication().getDaynightHelper().isNightMode(false);
+					boolean nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 					AndroidUtils.openUrl(activity, Uri.parse(getString(R.string.docs_external_sensors)), nightMode);
 				})
 				.create();
diff --git a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryInstallDialogFragment.java b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryInstallDialogFragment.java
index 2471e6763de..9928644c984 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryInstallDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryInstallDialogFragment.java
@@ -9,6 +9,7 @@
 import androidx.fragment.app.DialogFragment;
 
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.activities.MapActivity;
 
@@ -21,7 +22,7 @@ public class MapillaryInstallDialogFragment extends DialogFragment {
 	public Dialog onCreateDialog(Bundle savedInstanceState) {
 
 		MapActivity mapActivity = (MapActivity) getActivity();
-		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(mapActivity, nightMode));
 		builder.setCancelable(true);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryPlugin.java
index 6bdebfde86e..e32e99120ab 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryPlugin.java
@@ -41,6 +41,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.views.OsmandMapTileView;
 import net.osmand.plus.views.layers.MapInfoLayer;
@@ -258,7 +259,7 @@ public void buildContextMenuGalleryRows(@NonNull MenuBuilder menuBuilder, @NonNu
 		if (controller == null) {
 			return;
 		}
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		boolean needUpdateOnly = mapillaryCardsRow != null && mapillaryCardsRow.getMenuBuilder() == menuBuilder;
 
 		mapillaryCardsRow = new CardsRowBuilder(menuBuilder);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/SaveGPXBottomSheet.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/SaveGPXBottomSheet.java
index 6b9dc8c6ee5..9c4bd1ebe33 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/monitoring/SaveGPXBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/SaveGPXBottomSheet.java
@@ -10,7 +10,6 @@
 import android.view.View;
 import android.view.inputmethod.EditorInfo;
 import android.widget.EditText;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.widget.SwitchCompat;
@@ -20,6 +19,7 @@
 
 import net.osmand.IndexConstants;
 import net.osmand.PlatformUtil;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.primitives.WptPt;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -75,7 +75,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 
 		Context ctx = requireContext();
 		GpxSelectionHelper gpxSelectionHelper = app.getSelectedGpxHelper();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int textPrimaryColor = ColorUtilities.getPrimaryTextColorId(nightMode);
 		View mainView = UiUtilities.getInflater(ctx, nightMode).inflate(R.layout.save_gpx_fragment, null);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/odb/OBDWidgetSettingFragment.kt b/OsmAnd/src/net/osmand/plus/plugins/odb/OBDWidgetSettingFragment.kt
index 1a0d4e6d527..23ce49d19bb 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/odb/OBDWidgetSettingFragment.kt
+++ b/OsmAnd/src/net/osmand/plus/plugins/odb/OBDWidgetSettingFragment.kt
@@ -13,6 +13,7 @@ import net.osmand.plus.R
 import net.osmand.plus.helpers.AndroidUiHelper
 import net.osmand.plus.settings.backend.ApplicationMode
 import net.osmand.plus.settings.backend.preferences.OsmandPreference
+import net.osmand.plus.settings.enums.ThemeUsageContext
 import net.osmand.plus.utils.AndroidUtils
 import net.osmand.plus.utils.ColorUtilities
 import net.osmand.plus.utils.UiUtilities
@@ -158,7 +159,7 @@ class OBDWidgetSettingFragment : BaseSimpleWidgetInfoFragment() {
 	}
 
 	private fun showSeekbarSettingsDialog() {
-		val nightMode = !app.settings.isLightContentForMode(appMode)
+		val nightMode = app.daynightHelper.isNightMode(appMode, ThemeUsageContext.APP)
 		seekBarIntervalMillis = selectedIntervalMillis
 		val themedContext = UiUtilities.getThemedContext(requireContext(), nightMode)
 		val builder = AlertDialog.Builder(themedContext)
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditingPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditingPlugin.java
index 9e39ea9d485..0b4ca16692c 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditingPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditingPlugin.java
@@ -67,6 +67,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.SettingsScreenType;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.plus.utils.AndroidUtils;
@@ -484,7 +485,7 @@ public boolean onContextMenuClick(@Nullable OnDataChangeUiAdapter uiAdapter, @Nu
 				})
 				.setItemDeleteAction(SHOW_OSM_EDITS));
 
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		Iterator<RenderingRuleProperty> iterator = customRules.iterator();
 		while (iterator.hasNext()) {
 			RenderingRuleProperty property = iterator.next();
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditsAdapter.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditsAdapter.java
index b95e748d7cd..c463341ee85 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditsAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/OsmEditsAdapter.java
@@ -20,6 +20,7 @@
 import net.osmand.osm.edit.Entity;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.plugins.osmedit.data.OpenstreetmapPoint;
 import net.osmand.plus.plugins.osmedit.data.OsmPoint;
@@ -72,7 +73,7 @@ public void setAdapterListener(OsmEditsAdapterListener listener) {
 	@NonNull
 	@Override
 	public View getView(int position, View convertView, @NonNull ViewGroup parent) {
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		Context themedCtx = UiUtilities.getThemedContext(getContext(), nightMode);
 		if (portrait) {
 			if (convertView == null) {
@@ -104,7 +105,7 @@ public View getView(int position, View convertView, @NonNull ViewGroup parent) {
 			FrameLayout fl = new FrameLayout(themedCtx);
 			LinearLayout ll = new LinearLayout(themedCtx);
 			ll.setOrientation(LinearLayout.VERTICAL);
-			ll.setBackgroundResource(app.getSettings().isLightContent() ? R.drawable.bg_card_light : R.drawable.bg_card_dark);
+			ll.setBackgroundResource(nightMode ? R.drawable.bg_card_dark : R.drawable.bg_card_light);
 			fl.addView(ll);
 			((FrameLayout.LayoutParams) ll.getLayoutParams()).setMargins(sideMargin, margin, sideMargin, margin);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/DeletePoiHelper.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/DeletePoiHelper.java
index a1444e0e486..4af7e88d780 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/DeletePoiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/DeletePoiHelper.java
@@ -25,6 +25,7 @@
 import net.osmand.plus.plugins.osmedit.helpers.OpenstreetmapLocalUtil;
 import net.osmand.plus.plugins.osmedit.helpers.OpenstreetmapUtil;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -68,7 +69,7 @@ protected void onPostExecute(Entity entity) {
 
 	void deletePoiWithDialog(Entity entity) {
 		OsmandApplication app = AndroidUtils.getApp(activity);
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 		if (entity == null) {
 			app.showToastMessage(R.string.poi_cannot_be_found);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
index 6bdf73ee7b1..5b476fc915c 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
@@ -4,6 +4,7 @@
 import android.content.Context;
 import android.os.Bundle;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -40,7 +41,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
 
 	private boolean isNightMode() {
 		OsmandApplication app = ((OsmandApplication) requireActivity().getApplication());
-		return app.getDaynightHelper().isNightMode(false);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	private String getMessageToShow() {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SendPoiBottomSheetFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SendPoiBottomSheetFragment.java
index ab17f1b2406..7ce41cd7ea4 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SendPoiBottomSheetFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SendPoiBottomSheetFragment.java
@@ -6,7 +6,6 @@
 import android.os.Bundle;
 import android.view.ContextThemeWrapper;
 import android.view.View;
-import android.widget.CompoundButton;
 import android.widget.EditText;
 import android.widget.LinearLayout;
 import android.widget.TextView;
@@ -28,6 +27,7 @@
 import net.osmand.plus.plugins.osmedit.OsmEditingPlugin;
 import net.osmand.plus.plugins.osmedit.data.OpenstreetmapPoint;
 import net.osmand.plus.plugins.osmedit.data.OsmPoint;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.widgets.dialogbutton.DialogButtonType;
 import net.osmand.util.Algorithms;
@@ -60,7 +60,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 		if (app == null || plugin == null) return;
 
 		poi = AndroidUtils.getSerializable(getArguments(), OPENSTREETMAP_POINT, OsmPoint[].class);
-		boolean isNightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean isNightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		View sendOsmPoiView = View.inflate(new ContextThemeWrapper(getContext(), themeRes),
 				R.layout.send_poi_fragment, null);
 		sendOsmPoiView.getViewTreeObserver().addOnGlobalLayoutListener(getShadowLayoutListener());
@@ -78,12 +78,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 		int paddingSmall = app.getResources().getDimensionPixelSize(R.dimen.content_padding_small);
 		closeChangeSet.setChecked(true);
 		setCloseChangeSet(isNightMode, paddingSmall);
-		closeChangeSet.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
-			@Override
-			public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
-				setCloseChangeSet(isNightMode, paddingSmall);
-			}
-		});
+		closeChangeSet.setOnCheckedChangeListener((buttonView, isChecked) -> setCloseChangeSet(isNightMode, paddingSmall));
 		LinearLayout account = sendOsmPoiView.findViewById(R.id.account_container);
 		account.setOnClickListener(v -> {
 			FragmentActivity activity = getActivity();
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/ValueExceedLimitDialogFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/ValueExceedLimitDialogFragment.java
index cecf2138a2e..cf4df1a752b 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/ValueExceedLimitDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/ValueExceedLimitDialogFragment.java
@@ -4,6 +4,7 @@
 import android.content.Context;
 import android.os.Bundle;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -44,7 +45,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
 
 	private boolean isNightMode() {
 		OsmandApplication app = ((OsmandApplication) requireActivity().getApplication());
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	private String getTagName() {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/OsmEditsFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/OsmEditsFragment.java
index a67d51e7e83..46d55f2a189 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/OsmEditsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/OsmEditsFragment.java
@@ -70,6 +70,7 @@
 import net.osmand.plus.plugins.osmedit.helpers.OsmEditsUploadListenerHelper;
 import net.osmand.plus.plugins.osmedit.oauth.OsmOAuthHelper.OsmAuthorizationListener;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.util.Algorithms;
@@ -153,7 +154,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		app = getMyApplication();
 		settings = app.getSettings();
 		plugin = PluginsHelper.getActivePlugin(OsmEditingPlugin.class);
-		nightMode = !settings.isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
index 3a691b09df5..e4dc0138c7d 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
@@ -1,19 +1,17 @@
 package net.osmand.plus.plugins.osmedit.menu;
 
 import android.content.Context;
-import android.view.ContextThemeWrapper;
 import android.view.View;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
-import androidx.appcompat.app.AlertDialog;
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.plugins.osmedit.OsmEditingPlugin;
-import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.alert.AlertDialogData;
 import net.osmand.plus.widgets.alert.CustomAlert;
@@ -132,6 +130,6 @@ private static String[] getZoomStrings(Context context) {
 	}
 
 	public static boolean isNightMode(@NonNull OsmandApplication app) {
-		return app.getDaynightHelper().isNightMode(true);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/quickactions/AddPOIAction.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/quickactions/AddPOIAction.java
index 30953dfa5e9..a7f562ac166 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/quickactions/AddPOIAction.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/quickactions/AddPOIAction.java
@@ -57,6 +57,7 @@
 import net.osmand.plus.quickaction.actions.SelectMapLocationAction;
 import net.osmand.plus.render.RenderingIcons;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.OsmandTextFieldBoxes;
@@ -231,10 +232,10 @@ public void drawUI(@NonNull ViewGroup parent, @NonNull MapActivity mapActivity)
 				.inflate(R.layout.quick_action_add_poi_layout, parent, false);
 		setupPointLocationView(view.findViewById(R.id.point_location_container), mapActivity);
 
-		OsmandApplication application = mapActivity.getMyApplication();
-		boolean isLightTheme = application.getSettings().isLightContent();
+		OsmandApplication app = mapActivity.getMyApplication();
+		boolean isLightTheme = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		boolean isLayoutRtl = AndroidUtils.isLayoutRtl(mapActivity);
-		Drawable deleteDrawable = application.getUIUtilities().getIcon(R.drawable.ic_action_remove_dark, isLightTheme);
+		Drawable deleteDrawable = app.getUIUtilities().getIcon(R.drawable.ic_action_remove_dark, isLightTheme);
 
 		LinearLayout editTagsLineaLayout = view.findViewById(R.id.editTagsList);
 
@@ -242,7 +243,7 @@ public void drawUI(@NonNull ViewGroup parent, @NonNull MapActivity mapActivity)
 		// It is possible to not restart initialization every time, and probably move initialization to appInit
 		HashSet<String> tagKeys = new HashSet<>();
 		HashSet<String> valueKeys = new HashSet<>();
-		for (AbstractPoiType abstractPoiType : getAllTranslatedNames(application).values()) {
+		for (AbstractPoiType abstractPoiType : getAllTranslatedNames(app).values()) {
 			addPoiToStringSet(abstractPoiType, tagKeys, valueKeys);
 		}
 		addPoiToStringSet(getPoiTypes(mapActivity).getOtherMapCategory(), tagKeys, valueKeys);
@@ -273,13 +274,13 @@ public void drawUI(@NonNull ViewGroup parent, @NonNull MapActivity mapActivity)
 			public void afterTextChanged(Editable s) {
 				String tp = s.toString();
 				putTagIntoParams(POI_TYPE_TAG, tp);
-				PoiCategory category = getCategory(application);
+				PoiCategory category = getCategory(app);
 
 				if (category != null) {
 					poiTypeTextInputLayout.setHint(category.getTranslation());
 				}
 
-				String add = application.getString(R.string.shared_string_add);
+				String add = app.getString(R.string.shared_string_add);
 
 				if (title != null) {
 
@@ -288,7 +289,7 @@ public void afterTextChanged(Editable s) {
 							|| title.getText().toString().equals((add + " "))) {
 
 						if (!tp.isEmpty()) {
-							title.setText(application.getString(R.string.ltr_or_rtl_combine_via_space, add, tp));
+							title.setText(app.getString(R.string.ltr_or_rtl_combine_via_space, add, tp));
 							prevType = title.getText().toString();
 						}
 					}
@@ -328,7 +329,7 @@ public void afterTextChanged(Editable s) {
 
 		ImageButton onlineDocumentationButton = view.findViewById(R.id.onlineDocumentationButton);
 		onlineDocumentationButton.setOnClickListener(v -> {
-			String url = application.getString(R.string.url_osm_wiki_map_features);
+			String url = app.getString(R.string.url_osm_wiki_map_features);
 			Uri uri = Uri.parse(url);
 			Intent intent = new Intent(Intent.ACTION_VIEW, uri);
 			AndroidUtils.startActivityIfSafe(mapActivity, intent);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/parking/ParkingPositionPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/parking/ParkingPositionPlugin.java
index c6d38278d1d..85c83a60cef 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/parking/ParkingPositionPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/parking/ParkingPositionPlugin.java
@@ -37,6 +37,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.WidgetsAvailabilityHelper;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
@@ -284,7 +285,7 @@ public AlertDialog showDeleteDialog(Activity activity) {
 	 */
 	void showSetTimeLimitDialog(MapActivity mapActivity, DialogInterface choose) {
 		OsmandApplication app = mapActivity.getMyApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		View setTimeParking = UiUtilities.getInflater(mapActivity, nightMode).inflate(R.layout.parking_set_time_limit, null);
 		AlertDialog.Builder setTime = new AlertDialog.Builder(mapActivity);
 		setTime.setView(setTimeParking);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapOverlayAction.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapOverlayAction.java
index f9dc5a90f4e..3c5fef97417 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapOverlayAction.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapOverlayAction.java
@@ -23,6 +23,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.quickaction.SwitchableAction;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -182,7 +183,7 @@ public void onClick(View view) {
 				OsmandApplication app = activity.getMyApplication();
 				Map<String, String> entriesMap = app.getSettings().getTileSourceEntries();
 				entriesMap.put(KEY_NO_OVERLAY, activity.getString(R.string.no_overlay));
-				boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+				boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 				Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 				AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 				ArrayList<String> keys = new ArrayList<>(entriesMap.keySet());
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapSourceAction.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapSourceAction.java
index f17b2d14605..4aa2f2ef01d 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapSourceAction.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapSourceAction.java
@@ -6,7 +6,6 @@
 import android.content.DialogInterface;
 import android.view.View;
 import android.widget.ArrayAdapter;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AlertDialog;
@@ -20,6 +19,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.activities.MapActivity;
@@ -179,7 +179,7 @@ public void onClick(View view) {
 
 				List<Map.Entry<String, String>> entriesMapList = new ArrayList<>(entriesMap.entrySet());
 
-				boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+				boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 				Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 				AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapUnderlayAction.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapUnderlayAction.java
index 88fd869a33a..25502ec2e07 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapUnderlayAction.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/MapUnderlayAction.java
@@ -5,7 +5,6 @@
 import android.content.Context;
 import android.view.View;
 import android.widget.ArrayAdapter;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AlertDialog;
@@ -19,6 +18,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.activities.MapActivity;
@@ -184,7 +184,7 @@ protected View.OnClickListener getOnAddBtnClickListener(MapActivity activity, Ad
 			Map<String, String> entriesMap = app.getSettings().getTileSourceEntries();
 			entriesMap.put(KEY_NO_UNDERLAY, activity.getString(R.string.no_underlay));
 
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 
 			AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
index 879e6e5fd57..f0c06ec1111 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
@@ -14,7 +14,6 @@
 import android.os.AsyncTask;
 import android.view.ContextThemeWrapper;
 import android.view.View;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -41,6 +40,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.enums.MapLayerType;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.views.MapLayers;
@@ -650,7 +650,8 @@ private static boolean isNightMode(Context context) {
 			return false;
 		}
 		OsmandApplication app = (OsmandApplication) context.getApplicationContext();
-		return app.getDaynightHelper().isNightMode(context instanceof MapActivity);
+		boolean usedOnMap = context instanceof MapActivity;
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	private static int getThemeRes(Context context) {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesPreviewDrawer.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesPreviewDrawer.java
index ad24148ed4b..0b528202785 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesPreviewDrawer.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesPreviewDrawer.java
@@ -14,6 +14,7 @@
 import net.osmand.map.ITileSource;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.OsmandMapTileView;
 import net.osmand.plus.views.layers.MapTileLayer;
 import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
@@ -54,8 +55,8 @@ public Pair<Bitmap, Bitmap> drawTilesPreview(@Nullable ITileSource tileSource,
 		minZoomBitmap.eraseColor(Color.TRANSPARENT);
 		maxZoomBitmap.eraseColor(Color.TRANSPARENT);
 
-		boolean night = app.getDaynightHelper().isNightModeForMapControls();
-		DrawSettings drawSettings = new DrawSettings(night);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
+		DrawSettings drawSettings = new DrawSettings(nightMode);
 		drawTilePreview(minZoomCanvas, center, minZoom, drawSettings);
 		drawTilePreview(maxZoomCanvas, center, maxZoom, drawSettings);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
index acc44092714..9674c986960 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.ctxmenu.ContextMenuAdapter;
@@ -144,7 +145,7 @@ private void onPropertyValueSelected(@NonNull OnDataChangeUiAdapter uiAdapter,
 			}
 		};
 
-		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int toggleIconColorId;
 		int toggleIconId;
 		if (selected) {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
index 335fe805ebb..c5569d5466a 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
@@ -34,6 +34,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -618,7 +619,8 @@ private static boolean isNightMode(Activity activity, OsmandApplication app) {
 		if (activity == null || app == null) {
 			return false;
 		}
-		return app.getDaynightHelper().isNightMode(activity instanceof MapActivity);
+		boolean usedOnMap = activity instanceof MapActivity;
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainColorSchemeAction.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainColorSchemeAction.java
index e24446fef26..8e5d3b2c233 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainColorSchemeAction.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainColorSchemeAction.java
@@ -10,7 +10,6 @@
 import android.widget.ArrayAdapter;
 import android.widget.ImageView;
 import android.widget.ProgressBar;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -26,6 +25,7 @@
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.quickaction.SwitchableAction;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.shared.ColorPalette;
 import net.osmand.shared.ColorPalette.ColorValue;
@@ -156,7 +156,7 @@ protected String getListKey() {
 	protected View.OnClickListener getOnAddBtnClickListener(MapActivity activity, Adapter adapter) {
 		return view -> {
 			OsmandApplication app = activity.getMyApplication();
-			boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 
 			AlertDialog.Builder bld = new AlertDialog.Builder(themedContext);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
index 5c0cd7dd495..06dd5944566 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.plugins.weather.WeatherPlugin;
 import net.osmand.plus.plugins.weather.WeatherSettings;
 import net.osmand.plus.plugins.weather.listener.RemoveLocalForecastListener;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.transport.TransportLinesFragment;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
@@ -56,7 +57,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		forecastHelper = app.getOfflineForecastHelper();
 		weatherSettings = weatherHelper.getWeatherSettings();
 		weatherPlugin = PluginsHelper.getPlugin(WeatherPlugin.class);
-		nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java b/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
index 1a1ced9c614..d47601d36b9 100644
--- a/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
+++ b/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
@@ -38,6 +38,7 @@
 import com.google.android.material.snackbar.BaseTransientBottomBar;
 import com.google.android.material.snackbar.Snackbar;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.PlatformUtil;
 import net.osmand.plus.utils.ColorUtilities;
@@ -483,7 +484,7 @@ protected OsmandApplication requireMyApplication() {
 	}
 
 	public static boolean isNightMode(@NonNull OsmandApplication app, boolean usedOnMap) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/profiles/EditProfilesFragment.java b/OsmAnd/src/net/osmand/plus/profiles/EditProfilesFragment.java
index cec761647b3..83df4b736b4 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/EditProfilesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/EditProfilesFragment.java
@@ -31,6 +31,7 @@
 import net.osmand.plus.profiles.data.ProfileDataObject;
 import net.osmand.plus.profiles.data.ProfileDataUtils;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -315,7 +316,7 @@ private class EditProfilesAdapter extends RecyclerView.Adapter<RecyclerView.View
 			setHasStableIds(true);
 			this.app = app;
 			uiUtilities = app.getUIUtilities();
-			nightMode = !app.getSettings().isLightContent();
+			nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		}
 
 		public void setItems(List<Object> items) {
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SelectCopyAppModeBottomSheet.java b/OsmAnd/src/net/osmand/plus/profiles/SelectCopyAppModeBottomSheet.java
index 5b3741c9d00..c30c7874864 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/SelectCopyAppModeBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/SelectCopyAppModeBottomSheet.java
@@ -10,6 +10,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 import org.apache.commons.logging.Log;
 
@@ -80,11 +81,7 @@ public void onSaveInstanceState(@NonNull Bundle outState) {
 
 	@Override
 	public boolean isNightMode(@NonNull OsmandApplication app) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControlsForProfile(currentAppMode);
-		} else {
-			return !app.getSettings().isLightContentForMode(currentAppMode);
-		}
+		return app.getDaynightHelper().isNightMode(currentAppMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	@Override
@@ -105,8 +102,7 @@ protected int getRightBottomButtonTextId() {
 	@Override
 	protected void onRightBottomButtonClick() {
 		Fragment targetFragment = getTargetFragment();
-		if (selectedAppMode != null && targetFragment instanceof CopyAppModePrefsListener) {
-			CopyAppModePrefsListener listener = (CopyAppModePrefsListener) targetFragment;
+		if (selectedAppMode != null && targetFragment instanceof CopyAppModePrefsListener listener) {
 			listener.copyAppModePrefs(selectedAppMode);
 		}
 		dismiss();
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/CreateEditActionDialog.java b/OsmAnd/src/net/osmand/plus/quickaction/CreateEditActionDialog.java
index 38f89ece595..ce997130f4a 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/CreateEditActionDialog.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/CreateEditActionDialog.java
@@ -33,6 +33,7 @@
 import net.osmand.plus.quickaction.ConfirmationBottomSheet.OnConfirmButtonClickListener;
 import net.osmand.plus.quickaction.controller.AddQuickActionController;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -74,7 +75,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 			dismiss();
 		} else {
 			controller.registerDialog(TAG, this);
-			nightMode = !settings.isLightContent() || app.getDaynightHelper().isNightMode();
+			nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 			setStyle(DialogFragment.STYLE_NORMAL, nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme);
 
 			Bundle args = requireArguments();
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/QuickActionsWidget.java b/OsmAnd/src/net/osmand/plus/quickaction/QuickActionsWidget.java
index ea310dd8863..4294bb93864 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/QuickActionsWidget.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/QuickActionsWidget.java
@@ -37,6 +37,7 @@
 import net.osmand.plus.quickaction.actions.NewAction;
 import net.osmand.plus.quickaction.controller.AddQuickActionController;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -106,7 +107,7 @@ public void setSelectionListener(QuickActionSelectionListener selectionListener)
 	}
 
 	private void setupLayout(@NonNull Context context, int pageCount) {
-		boolean light = settings.isLightContent() && !app.getDaynightHelper().isNightMode();
+		boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		inflate(new ContextThemeWrapper(context, light ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme), R.layout.quick_action_widget, this);
 
@@ -171,7 +172,7 @@ public void onPageSelected(int position) {
 
 	private void updateControls(int position) {
 		OsmandApplication application = ((OsmandApplication) getContext().getApplicationContext());
-		boolean light = application.getSettings().isLightContent() && !application.getDaynightHelper().isNightMode();
+		boolean light = !application.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		int colorEnabled = light ? R.color.icon_color_default_light : R.color.card_and_list_background_light;
 		int colorDisabled = light ? R.color.icon_color_default_dark : R.color.white_50_transparent;
@@ -196,7 +197,7 @@ private void updateControls(int position) {
 
 	private View createPageView(@NonNull ViewGroup container, int position) {
 		Context context = getContext();
-		boolean light = settings.isLightContent() && !app.getDaynightHelper().isNightMode();
+		boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		LayoutInflater inflater = UiUtilities.getInflater(context, !light);
 
 		View page = inflater.inflate(R.layout.quick_action_widget_page, container, false);
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/SwitchableAction.java b/OsmAnd/src/net/osmand/plus/quickaction/SwitchableAction.java
index f2ef2cd80dd..5c5a4238ec0 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/SwitchableAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/SwitchableAction.java
@@ -18,7 +18,6 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.StringRes;
 import androidx.appcompat.widget.SwitchCompat;
-import androidx.core.content.ContextCompat;
 import androidx.core.util.Pair;
 import androidx.fragment.app.FragmentManager;
 import androidx.recyclerview.widget.ItemTouchHelper;
@@ -29,6 +28,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.quickaction.QuickActionListFragment.OnStartDragListener;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.views.controls.ReorderItemTouchHelperCallback;
 import net.osmand.plus.views.controls.ReorderItemTouchHelperCallback.OnItemMoveCallback;
@@ -363,9 +363,8 @@ protected int getItemIconRes(Context context, T item) {
 
 	@ColorInt
 	protected int getItemIconColor(OsmandApplication app, T item) {
-		boolean nightMode = !app.getSettings().isLightContent();
-		int colorRes = ColorUtilities.getDefaultIconColorId(nightMode);
-		return ContextCompat.getColor(app, colorRes);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		return ColorUtilities.getDefaultIconColor(app, nightMode);
 	}
 
 	@StringRes
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/ChangeMapOrientationAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/ChangeMapOrientationAction.java
index a4f14588a10..a235ca33f5e 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/ChangeMapOrientationAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/ChangeMapOrientationAction.java
@@ -17,6 +17,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.CompassMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 public class ChangeMapOrientationAction extends QuickAction {
 
@@ -46,7 +47,8 @@ public int getIconRes(Context context) {
 		OsmandApplication app = (OsmandApplication) context.getApplicationContext();
 		OsmandSettings settings = app.getSettings();
 		CompassMode compassMode = settings.getCompassMode();
-		return compassMode.getIconId(!settings.isLightContent());
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		return compassMode.getIconId(nightMode);
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/DayNightModeAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/DayNightModeAction.java
index 022ebc4f420..3b1fda94d56 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/DayNightModeAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/DayNightModeAction.java
@@ -16,6 +16,7 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.quickaction.QuickActionType;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 
 public class DayNightModeAction extends QuickAction {
 
@@ -30,7 +31,7 @@ public class DayNightModeAction extends QuickAction {
 
 	@Override
 	public void execute(@NonNull MapActivity mapActivity) {
-		if (mapActivity.getMyApplication().getDaynightHelper().isNightMode()) {
+		if (mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.MAP)) {
 			mapActivity.getMyApplication().getSettings().DAYNIGHT_MODE.set(DayNightMode.DAY);
 		} else {
 			mapActivity.getMyApplication().getSettings().DAYNIGHT_MODE.set(DayNightMode.NIGHT);
@@ -49,13 +50,13 @@ public void drawUI(@NonNull ViewGroup parent, @NonNull MapActivity mapActivity)
 	@Override
 	public int getIconRes(Context context) {
 		OsmandApplication app = (OsmandApplication) context.getApplicationContext();
-		boolean nightMode = app.getDaynightHelper().isNightMode();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		return nightMode ? R.drawable.ic_action_map_day : R.drawable.ic_action_map_night;
 	}
 
 	@Override
 	public String getActionText(@NonNull OsmandApplication app) {
-		if (app.getDaynightHelper().isNightMode()) {
+		if (app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP)) {
 			return String.format(app.getString(R.string.quick_action_day_night_mode),
 				DayNightMode.DAY.toHumanString(app));
 		} else {
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/GPXAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/GPXAction.java
index a6bf09a8663..2458082732e 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/GPXAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/GPXAction.java
@@ -24,6 +24,7 @@
 import androidx.fragment.app.Fragment;
 
 import net.osmand.CallbackWithObject;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.data.BackgroundType;
 import net.osmand.data.LatLon;
@@ -616,6 +617,6 @@ public void onGpxFileSelected(@NonNull View container, @NonNull MapActivity mapA
 	}
 
 	private boolean isNightMode(@NonNull MapActivity mapActivity) {
-		return mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		return mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/LocationSimulationAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/LocationSimulationAction.java
index 53583ce4563..2c035e2b6fa 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/LocationSimulationAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/LocationSimulationAction.java
@@ -20,6 +20,7 @@
 import com.google.android.material.slider.Slider;
 
 import net.osmand.CallbackWithObject;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.shared.SharedUtil;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.GpxTrackAnalysis;
@@ -426,6 +427,6 @@ public void onGpxFileSelected(@NonNull View container, @NonNull MapActivity mapA
 	}
 
 	private boolean isNightMode(@NonNull OsmandApplication app) {
-		return app.getDaynightHelper().isNightModeForMapControls();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/MapStyleAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/MapStyleAction.java
index 06c4bb47e01..af3db39dfd7 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/MapStyleAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/MapStyleAction.java
@@ -3,11 +3,9 @@
 import static net.osmand.plus.quickaction.QuickActionIds.MAP_STYLE_ACTION_ID;
 
 import android.content.Context;
-import android.content.DialogInterface;
 import android.text.TextUtils;
 import android.view.View;
 import android.widget.ArrayAdapter;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AlertDialog;
@@ -22,6 +20,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.quickaction.SwitchableAction;
 import net.osmand.plus.render.RendererRegistry;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.OsmandMapTileView;
@@ -158,59 +157,53 @@ protected String getListKey() {
 
 	@Override
 	protected View.OnClickListener getOnAddBtnClickListener(MapActivity activity, Adapter adapter) {
-		return new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				OsmandApplication app = activity.getMyApplication();
-				boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
-				Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
-
-				AlertDialog.Builder bld = new AlertDialog.Builder(themedContext);
-				bld.setTitle(R.string.renderers);
-
-				Map<String, String> renderers = app.getRendererRegistry().getRenderers(false);
-				List<String> disabledRendererNames = PluginsHelper.getDisabledRendererNames();
-
-				if (!Algorithms.isEmpty(disabledRendererNames)) {
-					Iterator<Map.Entry<String, String>> iterator = renderers.entrySet().iterator();
-					while (iterator.hasNext()) {
-						String rendererVal = iterator.next().getValue();
-						String rendererFileName = Algorithms.getFileWithoutDirs(rendererVal);
-						if (disabledRendererNames.contains(rendererFileName)) {
-							iterator.remove();
-						}
+		return view -> {
+			OsmandApplication app = activity.getMyApplication();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
+			Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
+
+			AlertDialog.Builder bld = new AlertDialog.Builder(themedContext);
+			bld.setTitle(R.string.renderers);
+
+			Map<String, String> renderers = app.getRendererRegistry().getRenderers(false);
+			List<String> disabledRendererNames = PluginsHelper.getDisabledRendererNames();
+
+			if (!Algorithms.isEmpty(disabledRendererNames)) {
+				Iterator<Map.Entry<String, String>> iterator = renderers.entrySet().iterator();
+				while (iterator.hasNext()) {
+					String rendererVal = iterator.next().getValue();
+					String rendererFileName = Algorithms.getFileWithoutDirs(rendererVal);
+					if (disabledRendererNames.contains(rendererFileName)) {
+						iterator.remove();
 					}
 				}
+			}
 
-				List<String> visibleNamesList = new ArrayList<>();
-				List<String> items = new ArrayList<>(renderers.keySet());
-				for (String item : items) {
-					String name = RendererRegistry.getRendererName(activity, item);
-					visibleNamesList.add(name);
-				}
+			List<String> visibleNamesList = new ArrayList<>();
+			List<String> items = new ArrayList<>(renderers.keySet());
+			for (String item : items) {
+				String name = RendererRegistry.getRendererName(activity, item);
+				visibleNamesList.add(name);
+			}
 
-				ArrayAdapter<String> arrayAdapter = new ArrayAdapter<>(themedContext, R.layout.dialog_text_item);
+			ArrayAdapter<String> arrayAdapter = new ArrayAdapter<>(themedContext, R.layout.dialog_text_item);
 
-				arrayAdapter.addAll(visibleNamesList);
-				bld.setAdapter(arrayAdapter, new DialogInterface.OnClickListener() {
-					@Override
-					public void onClick(DialogInterface dialogInterface, int i) {
+			arrayAdapter.addAll(visibleNamesList);
+			bld.setAdapter(arrayAdapter, (dialogInterface, i) -> {
 
-						String renderer = items.get(i);
-						RenderingRulesStorage loaded = app.getRendererRegistry().getRenderer(renderer);
+				String renderer = items.get(i);
+				RenderingRulesStorage loaded = app.getRendererRegistry().getRenderer(renderer);
 
-						if (loaded != null) {
+				if (loaded != null) {
 
-							adapter.addItem(renderer, activity);
-						}
+					adapter.addItem(renderer, activity);
+				}
 
-						dialogInterface.dismiss();
-					}
-				});
+				dialogInterface.dismiss();
+			});
 
-				bld.setNegativeButton(R.string.shared_string_dismiss, null);
-				bld.show();
-			}
+			bld.setNegativeButton(R.string.shared_string_dismiss, null);
+			bld.show();
 		};
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/ShowHidePoiAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/ShowHidePoiAction.java
index ffdbcdd8b4a..84f0ef6cec5 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/ShowHidePoiAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/ShowHidePoiAction.java
@@ -27,6 +27,7 @@
 import net.osmand.plus.quickaction.QuickAction;
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.render.RenderingIcons;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.widgets.ctxmenu.ContextMenuAdapter;
 import net.osmand.plus.widgets.ctxmenu.ViewCreator;
@@ -135,7 +136,7 @@ private boolean isCurrentFilters(@NonNull OsmandApplication app,
 
 	@Override
 	public void drawUI(@NonNull ViewGroup parent, @NonNull MapActivity mapActivity) {
-		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		View view = UiUtilities.getInflater(mapActivity, nightMode).inflate(R.layout.quick_action_show_hide_poi, parent, false);
 
 		RecyclerView list = view.findViewById(R.id.list);
@@ -282,7 +283,7 @@ private void showSingleChoicePoiFilterDialog(MapActivity mapActivity, Adapter fi
 			}
 		}
 
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		ViewCreator viewCreator = new ViewCreator(mapActivity, nightMode);
 		ArrayAdapter<ContextMenuItem> listAdapter = adapter.toListAdapter(mapActivity, viewCreator);
 		AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(mapActivity, nightMode));
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
index 5362ba60e5a..f3e9a5fb523 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
@@ -5,7 +5,6 @@
 import android.content.Context;
 import android.text.TextUtils;
 import android.view.View;
-import android.widget.Toast;
 
 import androidx.annotation.ColorInt;
 import androidx.annotation.NonNull;
@@ -23,6 +22,7 @@
 import net.osmand.plus.quickaction.QuickActionType;
 import net.osmand.plus.quickaction.SwitchableAction;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.views.MapLayers;
 import net.osmand.plus.views.controls.maphudbuttons.QuickActionButton;
@@ -208,7 +208,7 @@ protected int getItemIconRes(Context context, String item) {
 	protected int getItemIconColor(OsmandApplication app, String item) {
 		ApplicationMode appMode = getModeForKey(item);
 		if (appMode != null) {
-			boolean nightMode = !app.getSettings().isLightContent();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			return appMode.getProfileColor(nightMode);
 		}
 		return super.getItemIconColor(app, item);
@@ -216,15 +216,12 @@ protected int getItemIconColor(OsmandApplication app, String item) {
 
 	@Override
 	protected View.OnClickListener getOnAddBtnClickListener(MapActivity activity, Adapter adapter) {
-		return new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				CreateEditActionDialog targetFragment = (CreateEditActionDialog) activity
-						.getSupportFragmentManager().findFragmentByTag(CreateEditActionDialog.TAG);
-				List<String> selectedProfilesKeys = new ArrayList<>(adapter.getItemsList());
-				SelectMultipleProfilesBottomSheet.showInstance(activity, targetFragment,
-						selectedProfilesKeys, selectedProfilesKeys, false);
-			}
+		return v -> {
+			CreateEditActionDialog targetFragment = (CreateEditActionDialog) activity
+					.getSupportFragmentManager().findFragmentByTag(CreateEditActionDialog.TAG);
+			List<String> selectedProfilesKeys = new ArrayList<>(adapter.getItemsList());
+			SelectMultipleProfilesBottomSheet.showInstance(activity, targetFragment,
+					selectedProfilesKeys, selectedProfilesKeys, false);
 		};
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/render/MapRenderRepositories.java b/OsmAnd/src/net/osmand/plus/render/MapRenderRepositories.java
index 5917b032b48..b66d22df5f8 100644
--- a/OsmAnd/src/net/osmand/plus/render/MapRenderRepositories.java
+++ b/OsmAnd/src/net/osmand/plus/render/MapRenderRepositories.java
@@ -4,7 +4,6 @@
 import android.graphics.Bitmap.Config;
 import android.os.Handler;
 import android.os.Looper;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 
@@ -31,6 +30,7 @@
 import net.osmand.plus.render.OsmandRenderer.RenderingContext;
 import net.osmand.plus.settings.backend.OsmAndAppCustomization.OsmAndAppCustomizationListener;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
 import net.osmand.render.RenderingRuleProperty;
 import net.osmand.render.RenderingRuleSearchRequest;
@@ -660,7 +660,7 @@ public synchronized void loadMap(RotatedTileBox tileRect, MapTileDownloader mapT
 		}
 		try {
 			// find selected rendering type
-			boolean nightMode = app.getDaynightHelper().isNightMode();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 
 			// boolean moreDetail = prefs.SHOW_MORE_MAP_DETAIL.get();
 			RenderingRulesStorage storage = app.getRendererRegistry().getCurrentSelectedRenderer();
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/AddPointBottomSheetDialog.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/AddPointBottomSheetDialog.java
index b7eefa0e35e..dd9f19961cb 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/AddPointBottomSheetDialog.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/AddPointBottomSheetDialog.java
@@ -51,6 +51,7 @@
 import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu.PointType;
 import net.osmand.plus.search.ShowQuickSearchMode;
 import net.osmand.plus.search.dialogs.QuickSearchDialogFragment;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.FontCache;
@@ -620,7 +621,7 @@ private void bindFavoritesButton(ItemViewHolder viewHolder) {
 
 		private void bindFavoritePoint(ItemViewHolder favoriteViewHolder, FavouritePoint point) {
 			OsmandApplication app = getApp();
-			boolean nightMode = !app.getSettings().isLightContent();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 			favoriteViewHolder.title.setText(point.getDisplayName(app));
 			if (point.getSpecialPointType() != null) {
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
index c70a8ecc832..18daa7d1d50 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
@@ -55,6 +55,7 @@
 import net.osmand.plus.routepreparationmenu.data.parameters.MuteSoundRoutingParameter;
 import net.osmand.plus.routepreparationmenu.data.parameters.OtherLocalRoutingParameter;
 import net.osmand.plus.routepreparationmenu.data.parameters.ShowAlongTheRouteItem;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.layers.MapSelectionResult;
 import net.osmand.plus.views.layers.MapSelectionResult.SelectedMapObject;
 import net.osmand.shared.gpx.GpxFile;
@@ -553,7 +554,7 @@ public void updateInfo(@NonNull View main) {
 
 		mainView = main;
 		OsmandApplication app = mapActivity.getMyApplication();
-		nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		updateStartPointView();
 		updateViaView();
@@ -583,7 +584,7 @@ private void updateCards() {
 		}
 
 		OsmandApplication app = mapActivity.getMyApplication();
-		nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		TargetPointsHelper targetPointsHelper = app.getTargetPointsHelper();
 		RoutingHelper routingHelper = app.getRoutingHelper();
@@ -602,7 +603,7 @@ private void updateCards() {
 		} else if (isTransportRouteCalculated()) {
 			TransportRoutingHelper transportRoutingHelper = app.getTransportRoutingHelper();
 			List<TransportRouteResult> routes = transportRoutingHelper.getRoutes();
-			if (routes != null && routes.size() > 0) {
+			if (routes != null && !routes.isEmpty()) {
 				TransportRouteResult route = routes.get(0);
 				int walkTimeReal = transportRoutingHelper.getWalkingTime(route.getSegments());
 				int walkTimePT = (int) route.getWalkTime();
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
index 8ccccfabc8a..29b6e15f313 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
@@ -41,6 +41,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -597,7 +598,7 @@ public RoutingParameter getRoutingPrefsForAppModeById(ApplicationMode applicatio
 	}
 
 	public boolean isNightMode() {
-		return app.getDaynightHelper().isNightModeForMapControls();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 
 	private List<String> getRoutingParametersForProfileType(ApplicationMode appMode) {
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
index 008594b6427..598b53d5d17 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
@@ -41,6 +41,7 @@
 import net.osmand.plus.helpers.WaypointDialogHelper;
 import net.osmand.plus.helpers.WaypointHelper;
 import net.osmand.plus.helpers.LocationPointWrapper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -341,7 +342,7 @@ public void applyDayNightMode() {
 			return;
 		}
 		boolean landscapeLayout = !portrait;
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int colorActive = ContextCompat.getColor(mapActivity, ColorUtilities.getActiveColorId(nightMode));
 		if (!landscapeLayout) {
 			AndroidUtils.setBackground(mapActivity, mainView, nightMode, R.drawable.route_info_menu_bg_light, R.drawable.route_info_menu_bg_dark);
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
index 52f3b5e93ab..30c56be75e9 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
@@ -19,9 +19,9 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.helpers.AndroidUiHelper;
-import net.osmand.plus.helpers.RequestThemeParams;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.shared.util.Localization;
@@ -70,8 +70,7 @@ public BaseCard(@NonNull FragmentActivity activity, @Nullable ApplicationMode ap
 		this.settings = app.getSettings();
 		this.usedOnMap = usedOnMap;
 		this.appMode = appMode != null ? appMode : settings.getApplicationMode();
-		RequestThemeParams requestThemeParams = new RequestThemeParams(appMode, true);
-		nightMode = app.getDaynightHelper().isNightMode(usedOnMap, requestThemeParams);
+		nightMode = app.getDaynightHelper().isNightMode(this.appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	public abstract int getCardLayoutId();
diff --git a/OsmAnd/src/net/osmand/plus/routing/ColoringStyleAlgorithms.java b/OsmAnd/src/net/osmand/plus/routing/ColoringStyleAlgorithms.java
index a7fe376ae76..87a8f2a61a3 100644
--- a/OsmAnd/src/net/osmand/plus/routing/ColoringStyleAlgorithms.java
+++ b/OsmAnd/src/net/osmand/plus/routing/ColoringStyleAlgorithms.java
@@ -4,6 +4,7 @@
 import androidx.annotation.Nullable;
 
 import net.osmand.Location;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxFile;
 import net.osmand.shared.gpx.GpxTrackAnalysis;
 import net.osmand.shared.gpx.GradientScaleType;
@@ -102,12 +103,12 @@ public static boolean isAttributeAvailableForDrawing(@NonNull OsmandApplication
 			return false;
 		}
 
-		boolean night = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		MapRenderRepositories maps = app.getResourceManager().getRenderer();
 		RenderingRuleSearchRequest currentSearchRequest =
-				maps.getSearchRequestWithAppliedCustomRules(currentRenderer, night);
+				maps.getSearchRequestWithAppliedCustomRules(currentRenderer, nightMode);
 		RenderingRuleSearchRequest defaultSearchRequest =
-				maps.getSearchRequestWithAppliedCustomRules(defaultRenderer, night);
+				maps.getSearchRequestWithAppliedCustomRules(defaultRenderer, nightMode);
 
 		List<RouteStatistics> routeStatisticsList =
 				RouteStatisticsHelper.calculateRouteStatistic(routeSegments,
diff --git a/OsmAnd/src/net/osmand/plus/search/NearbyPlacesAdapter.kt b/OsmAnd/src/net/osmand/plus/search/NearbyPlacesAdapter.kt
index f8a39fbd790..aba7764b805 100644
--- a/OsmAnd/src/net/osmand/plus/search/NearbyPlacesAdapter.kt
+++ b/OsmAnd/src/net/osmand/plus/search/NearbyPlacesAdapter.kt
@@ -21,6 +21,7 @@ import net.osmand.plus.helpers.AndroidUiHelper
 import net.osmand.plus.helpers.LocaleHelper
 import net.osmand.plus.plugins.PluginsHelper
 import net.osmand.plus.render.RenderingIcons
+import net.osmand.plus.settings.enums.ThemeUsageContext
 import net.osmand.plus.utils.AndroidUtils
 import net.osmand.plus.utils.OsmAndFormatter
 import net.osmand.plus.utils.PicassoUtils
@@ -64,7 +65,7 @@ class NearbyPlacesAdapter(
 	}
 
 	private fun isNightMode(): Boolean {
-		return !getApp().getSettings().isLightContent
+		return getApp().daynightHelper.isNightMode(ThemeUsageContext.APP)
 	}
 
 	override fun onBindViewHolder(holder: NearbyViewHolder, position: Int) {
@@ -120,7 +121,7 @@ class NearbyPlacesAdapter(
 			val poiIcon =
 				if (subType == null) null else RenderingIcons.getBigIcon(app, subType.keyName)
 			val uiUtilities = app.uiUtilities
-			val nightMode = app.daynightHelper.isNightMode
+			val nightMode = app.daynightHelper.isNightMode(ThemeUsageContext.MAP)
 			val coloredIcon = if (poiIcon != null) {
 				uiUtilities.getRenderingIcon(
 					app,
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCoordinatesFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCoordinatesFragment.java
index c3810c39720..63f9e6844e7 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCoordinatesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCoordinatesFragment.java
@@ -50,6 +50,7 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.search.dialogs.SearchCitiesTask.SearchCitiesListener;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -127,7 +128,7 @@ private OsmandApplication getMyApplication() {
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		isLightTheme = getMyApplication().getSettings().isLightContent();
+		isLightTheme = !getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = isLightTheme ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 	}
@@ -345,7 +346,8 @@ private View setupCoordinatesView(View view) {
 		coordinatesView.setClickable(true);
 
 		OsmandApplication app = getMyApplication();
-		int iconColorRes = app.getSettings().isLightContent() ? R.color.osmand_orange : R.color.osmand_orange_dark;
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		int iconColorRes = !nightMode ? R.color.osmand_orange : R.color.osmand_orange_dark;
 		Drawable icon = app.getUIUtilities().getIcon(R.drawable.ic_action_world_globe, iconColorRes);
 		((ImageView) coordinatesView.findViewById(R.id.imageView)).setImageDrawable(icon);
 
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCustomPoiFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCustomPoiFragment.java
index e9f057f78d8..e7b0b425938 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCustomPoiFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchCustomPoiFragment.java
@@ -45,6 +45,7 @@
 import net.osmand.plus.poi.PoiFiltersHelper;
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.render.RenderingIcons;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -103,7 +104,7 @@ public void onCreate(Bundle savedInstanceState) {
 		app = (OsmandApplication) requireActivity().getApplication();
 		uiUtilities = app.getUIUtilities();
 		searchUICore = app.getSearchUICore().getCore();
-		this.nightMode = !app.getSettings().isLightContent();
+		this.nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		setStyle(STYLE_NO_FRAME, nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme);
 		poiCategoryList = app.getPoiTypes().getCategories(false);
 		Collections.sort(poiCategoryList, (category1, category2) ->
@@ -115,7 +116,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 	                         @Nullable Bundle savedInstanceState) {
 		LayoutInflater layoutInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		helper = app.getPoiFilters();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		if (getArguments() != null) {
 			filterId = getArguments().getString(QUICK_SEARCH_CUSTOM_POI_FILTER_ID_KEY);
 		} else if (savedInstanceState != null) {
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchDialogFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchDialogFragment.java
index 1fb2efce284..12064a18125 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchDialogFragment.java
@@ -87,6 +87,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.HistorySource;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.OnPreferenceChanged;
 import net.osmand.plus.settings.fragments.SearchHistorySettingsFragment;
 import net.osmand.plus.utils.AndroidUtils;
@@ -424,7 +425,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 		);
 
 		toolbar = view.findViewById(R.id.toolbar);
-		if (!app.getSettings().isLightContent()) {
+		if (app.getDaynightHelper().isNightMode(ThemeUsageContext.APP)) {
 			toolbar.setBackgroundColor(ContextCompat.getColor(mapActivity, R.color.app_bar_main_dark));
 		}
 		Drawable icBack = iconsCache.getThemedIcon(AndroidUtils.getNavigationIconResId(app));
@@ -841,7 +842,7 @@ public void addMainSearchFragment() {
 	}
 
 	private void updateToolbarButton() {
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		SearchWord word = searchUICore.getPhrase().getLastSelectedWord();
 		if (foundPartialLocation) {
 			buttonToolbarText.setText(app.getString(R.string.advanced_coords_search).toUpperCase());
@@ -867,7 +868,7 @@ private void updateToolbarButton() {
 		if (filterButtonVisible) {
 			if (word.getResult().object instanceof PoiUIFilter) {
 				buttonToolbarFilter.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_filter_dark, ColorUtilities.getActiveColorId(nightMode)));
-				buttonToolbarFilter.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_filter_dark, app.getSettings().isLightContent() ? R.color.active_color_primary_light : R.color.active_color_primary_dark));
+				buttonToolbarFilter.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_filter_dark, !nightMode ? R.color.active_color_primary_light : R.color.active_color_primary_dark));
 			} else {
 				buttonToolbarFilter.setImageDrawable(app.getUIUtilities().getThemedIcon(R.drawable.ic_action_filter_dark));
 			}
@@ -1334,7 +1335,7 @@ private void updateCitiesItems() {
 			String selectStreets = app.getString(R.string.search_street).toUpperCase();
 			String inCityName = app.getString(R.string.shared_string_in_name, lastCityName);
 			Spannable spannable = new SpannableString((selectStreets + " " + inCityName).toUpperCase());
-			boolean light = settings.isLightContent();
+			boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 			spannable.setSpan(new ForegroundColorSpan(app.getColor(light ? R.color.icon_color_default_light : R.color.card_and_list_background_light)),
 					selectStreets.length() + 1, spannable.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
 
@@ -2178,7 +2179,7 @@ public void reloadIndexFiles() {
 	}
 
 	public boolean isNightMode() {
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	public interface SearchResultListener {
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
index 79d10118e68..a6e9ea387a9 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
@@ -14,13 +14,13 @@
 import net.osmand.data.Amenity;
 import net.osmand.osm.MapPoiTypes;
 import net.osmand.plus.R;
-import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.download.DownloadIndexesThread;
 import net.osmand.plus.helpers.SearchHistoryHelper.HistoryEntry;
 import net.osmand.plus.search.NearbyPlacesAdapter.NearbyItemClickListener;
 import net.osmand.plus.search.dialogs.QuickSearchDialogFragment.SearchVisibilityListener;
 import net.osmand.plus.search.listitems.NearbyPlacesCard;
 import net.osmand.plus.search.listitems.QuickSearchListItem;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.HistoryItemsFragment;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.search.SearchUICore;
@@ -152,9 +152,10 @@ public void onViewCreated(@NonNull View view, Bundle savedInstanceState) {
 	}
 
 	private void setupNearByCard(@NonNull View view) {
-		LayoutInflater themedInflater = UiUtilities.getInflater(view.getContext(), !app.getSettings().isLightContent());
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		LayoutInflater themedInflater = UiUtilities.getInflater(view.getContext(), nightMode);
 		QuickSearchDialogFragment dialogFragment = (QuickSearchDialogFragment) getParentFragment();
-		nearbyPlacesCard = new NearbyPlacesCard(requireMapActivity(), this, dialogFragment.isNightMode(), !dialogFragment.isSearchHidden());
+		nearbyPlacesCard = new NearbyPlacesCard(requireMapActivity(), this, nightMode, !dialogFragment.isSearchHidden());
 		getListView().addHeaderView(nearbyPlacesCard, null, false);
 		getListView().addHeaderView(themedInflater.inflate(R.layout.recently_visited_header, getListView(), false));
 	}
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListAdapter.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListAdapter.java
index 2a9fe2de023..fe93155f13a 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListAdapter.java
@@ -1,13 +1,11 @@
 package net.osmand.plus.search.dialogs;
 
-import static net.osmand.CollatorStringMatcher.StringMatcherMode.CHECK_STARTS_FROM_SPACE;
 import static net.osmand.plus.search.listitems.QuickSearchBannerListItem.ButtonItem;
 import static net.osmand.plus.search.listitems.QuickSearchBannerListItem.INVALID_ID;
 import static net.osmand.search.core.ObjectType.POI_TYPE;
 
 import android.graphics.drawable.ColorDrawable;
 import android.graphics.drawable.Drawable;
-import android.text.SpannableString;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -15,14 +13,10 @@
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
-import androidx.core.content.ContextCompat;
 import androidx.core.view.ViewCompat;
 import androidx.fragment.app.FragmentActivity;
 
-import net.osmand.StringMatcher;
-import net.osmand.data.Amenity;
 import net.osmand.data.LatLon;
-import net.osmand.osm.AbstractPoiType;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.chooseplan.ChoosePlanFragment;
@@ -30,13 +24,12 @@
 import net.osmand.plus.download.DownloadIndexesThread;
 import net.osmand.plus.download.IndexItem;
 import net.osmand.plus.helpers.AndroidUiHelper;
-import net.osmand.plus.mapcontextmenu.MenuController;
 import net.osmand.plus.plugins.accessibility.AccessibilityAssistant;
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.search.SearchResultViewHolder;
 import net.osmand.plus.search.WikiItemViewHolder;
-import net.osmand.plus.search.QuickSearchHelper;
 import net.osmand.plus.search.listitems.*;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.data.GPXInfo;
 import net.osmand.plus.track.helpers.GpxUiHelper;
 import net.osmand.plus.utils.*;
@@ -44,17 +37,13 @@
 import net.osmand.search.SearchUICore;
 import net.osmand.search.core.ObjectType;
 import net.osmand.search.core.SearchPhrase;
-import net.osmand.search.core.SearchPhrase.NameStringMatcher;
 import net.osmand.search.core.SearchResult;
 import net.osmand.search.core.SearchWord;
 import net.osmand.shared.gpx.GpxHelper;
 import net.osmand.util.Algorithms;
-import net.osmand.util.OpeningHoursParser;
-import net.osmand.util.OpeningHoursParser.OpeningHours;
 
 import java.text.DateFormat;
 import java.util.ArrayList;
-import java.util.Calendar;
 import java.util.List;
 
 public class QuickSearchListAdapter extends ArrayAdapter<QuickSearchListItem> {
@@ -640,7 +629,7 @@ public static void updateLocationView(@NonNull View view, @NonNull QuickSearchLi
 	}
 
 	private boolean isNightMode() {
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 	}
 
 	public void setPoiUIFilter(@Nullable PoiUIFilter poiUIFilter) {
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListFragment.java
index 07a70eedbd2..9aa65588193 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchListFragment.java
@@ -37,6 +37,7 @@
 import net.osmand.plus.search.listitems.QuickSearchListItemType;
 import net.osmand.plus.search.listitems.QuickSearchTopShadowListItem;
 import net.osmand.plus.settings.enums.HistorySource;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.data.GPXInfo;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
 import net.osmand.plus.track.helpers.GpxFileLoaderTask;
@@ -82,8 +83,8 @@ protected int getLayoutId() {
 
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), !app.getSettings().isLightContent());
-		return themedInflater.inflate(getLayoutId(), container, false);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		return UiUtilities.inflate(requireContext(), nightMode, getLayoutId(), container, false);
 	}
 
 	@Override
@@ -146,7 +147,7 @@ public void onAttach(@NonNull Context context) {
 	@Override
 	public void onActivityCreated(Bundle savedInstanceState) {
 		super.onActivityCreated(savedInstanceState);
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		dialogFragment = (QuickSearchDialogFragment) getParentFragment();
 		listAdapter = new QuickSearchListAdapter(app, requireMapActivity());
 		listAdapter.setAccessibilityAssistant(dialogFragment.getAccessibilityAssistant());
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchPoiFilterFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchPoiFilterFragment.java
index dfaa9276ac4..04a1a3ca95c 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchPoiFilterFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchPoiFilterFragment.java
@@ -20,7 +20,6 @@
 import android.widget.LinearLayout;
 import android.widget.ListView;
 import android.widget.TextView;
-import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -41,6 +40,7 @@
 import net.osmand.plus.dialogs.DirectionsDialogs;
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.render.RenderingIcons;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -98,7 +98,7 @@ private OsmandApplication getMyApplication() {
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		isLightTheme = getMyApplication().getSettings().isLightContent();
+		isLightTheme = !getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int themeId = isLightTheme ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 	}
@@ -108,7 +108,7 @@ public View onCreateView(@NonNull LayoutInflater inflater,
 	                         @Nullable ViewGroup container,
 							 @Nullable Bundle savedInstanceState) {
 		OsmandApplication app = getMyApplication();
-		boolean nightMode = !app.getSettings().isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		if (getArguments() != null) {
 			filterId = getArguments().getString(QUICK_SEARCH_POI_FILTER_ID_KEY);
@@ -773,8 +773,10 @@ public View getView(int position, View convertView, ViewGroup parent) {
 				}
 
 				if (item.iconId != 0) {
-					icon.setImageDrawable(app.getUIUtilities().getIcon(item.iconId,
-							app.getSettings().isLightContent() ? R.color.icon_color_default_light : R.color.card_and_list_background_light));
+					boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+					icon.setImageDrawable(app.getUIUtilities().getIcon(item.iconId, nightMode
+							? R.color.card_and_list_background_light
+							: R.color.icon_color_default_light));
 					icon.setVisibility(View.VISIBLE);
 				} else {
 					icon.setVisibility(View.GONE);
diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/SubCategoriesAdapter.java b/OsmAnd/src/net/osmand/plus/search/dialogs/SubCategoriesAdapter.java
index 20641f3fbd6..a703a647f5f 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/SubCategoriesAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/SubCategoriesAdapter.java
@@ -16,6 +16,7 @@
 import net.osmand.osm.PoiType;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.render.RenderingIcons;
 
@@ -47,7 +48,7 @@ public SubCategoriesAdapter(@NonNull OsmandApplication app,
 		this.items = new ArrayList<>(items);
 		selectedItems = new ArrayList<>();
 		uiUtilities = app.getUIUtilities();
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		activeIconColorRes = nightMode
 				? R.color.icon_color_osmand_dark
 				: R.color.icon_color_osmand_light;
diff --git a/OsmAnd/src/net/osmand/plus/search/listitems/NearbyPlacesCard.java b/OsmAnd/src/net/osmand/plus/search/listitems/NearbyPlacesCard.java
index 19dfb0cdf3e..ed4c9449b77 100644
--- a/OsmAnd/src/net/osmand/plus/search/listitems/NearbyPlacesCard.java
+++ b/OsmAnd/src/net/osmand/plus/search/listitems/NearbyPlacesCard.java
@@ -33,6 +33,7 @@
 import net.osmand.plus.search.NearbyPlacesAdapter.NearbyItemClickListener;
 import net.osmand.plus.search.dialogs.QuickSearchDialogFragment;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.wikipedia.WikipediaPlugin;
 
@@ -151,7 +152,8 @@ public void update() {
 
 	private void updateExpandState() {
 		int iconRes = collapsed ? R.drawable.ic_action_arrow_down : R.drawable.ic_action_arrow_up;
-		explicitIndicator.setImageDrawable(app.getUIUtilities().getIcon(iconRes, !app.getSettings().isLightContent()));
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		explicitIndicator.setImageDrawable(app.getUIUtilities().getIcon(iconRes, nightMode));
 		boolean nearbyPointFound = getNearbyAdapter().hasData();
 		AndroidUiHelper.updateVisibility(cardContent, !collapsed && isDataSourceAvailable());
 		AndroidUiHelper.updateVisibility(noInternetCard, !collapsed && !isDataSourceAvailable());
diff --git a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchButtonListItem.java b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchButtonListItem.java
index 98f5976de3b..e844e690cf6 100644
--- a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchButtonListItem.java
+++ b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchButtonListItem.java
@@ -8,6 +8,7 @@
 
 import androidx.annotation.NonNull;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 
@@ -21,18 +22,20 @@ public class QuickSearchButtonListItem extends QuickSearchListItem {
 
 	public QuickSearchButtonListItem(OsmandApplication app, int iconId, @NonNull String title, View.OnClickListener onClickListener) {
 		super(app, null);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		this.iconId = iconId;
 		this.title = title.toUpperCase();
 		this.onClickListener = onClickListener;
-		this.colorId = ColorUtilities.getActiveColorId(!app.getSettings().isLightContent());
+		this.colorId = ColorUtilities.getActiveColorId(nightMode);
 	}
 
 	public QuickSearchButtonListItem(OsmandApplication app, int iconId, @NonNull Spannable title, View.OnClickListener onClickListener) {
 		super(app, null);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		this.iconId = iconId;
 		this.spannableTitle = spannedToUpperCase(title);
 		this.onClickListener = onClickListener;
-		this.colorId = ColorUtilities.getActiveColorId(!app.getSettings().isLightContent());
+		this.colorId = ColorUtilities.getActiveColorId(nightMode);
 	}
 
 	public QuickSearchListItemType getType() {
diff --git a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchListItem.java b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchListItem.java
index f72a3bcf0fa..5cf3999d852 100644
--- a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchListItem.java
+++ b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchListItem.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.poi.PoiFilterUtils;
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.render.RenderingIcons;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.views.PointImageUtils;
 import net.osmand.search.core.CustomSearchPoiFilter;
@@ -357,8 +358,8 @@ public static Drawable getIcon(OsmandApplication app, SearchResult searchResult)
 			case POI:
 				Amenity amenity = (Amenity) searchResult.object;
 				if (amenity.isRouteTrack()) {
-					boolean isNightMode = !app.getSettings().isLightContent();
-					Drawable shieldIcon = NetworkRouteDrawable.getIconByAmenityShieldTags(amenity, app, isNightMode);
+					boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+					Drawable shieldIcon = NetworkRouteDrawable.getIconByAmenityShieldTags(amenity, app, nightMode);
 					if (shieldIcon != null) {
 						return shieldIcon;
 					}
@@ -542,8 +543,8 @@ public static Pair<PointDescription, Object> getPointDescriptionObject(
 	}
 
 	private static Drawable getIcon(@NonNull OsmandApplication app, @DrawableRes int iconId) {
-		return app.getUIUtilities().getIcon(iconId,
-				app.getSettings().isLightContent() ? R.color.osmand_orange : R.color.osmand_orange_dark);
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		return app.getUIUtilities().getIcon(iconId, !nightMode ? R.color.osmand_orange : R.color.osmand_orange_dark);
 	}
 
 	@DrawableRes
diff --git a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchWikiItem.java b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchWikiItem.java
index 0124b5ff48e..68742486d8e 100644
--- a/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchWikiItem.java
+++ b/OsmAnd/src/net/osmand/plus/search/listitems/QuickSearchWikiItem.java
@@ -13,6 +13,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.plugins.PluginsHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.wikipedia.WikiArticleHelper;
 import net.osmand.search.core.SearchCoreFactory;
 import net.osmand.search.core.SearchPhrase;
@@ -73,7 +74,7 @@ private String getPoiTypeKey(@NonNull Amenity amenity) {
 
 	@NonNull
 	private Drawable getPoiTypeIcon(@NonNull OsmandApplication app, @NonNull Amenity amenity) {
-		boolean nightMode = app.getDaynightHelper().isNightMode();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		Drawable drawable = app.getUIUtilities().getIcon(R.drawable.ic_action_info_dark, nightMode);
 		PoiType subType = app.getPoiTypes().getPoiTypeByKey(getPoiTypeKey(amenity));
 		if (subType != null) {
diff --git a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/ElevationDateBottomSheet.java b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/ElevationDateBottomSheet.java
index 761cf4c02f6..bd23c267576 100644
--- a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/ElevationDateBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/ElevationDateBottomSheet.java
@@ -2,7 +2,6 @@
 
 import static net.osmand.plus.settings.bottomsheets.BooleanPreferenceBottomSheet.getCustomButtonView;
 import static net.osmand.plus.settings.bottomsheets.BooleanPreferenceBottomSheet.updateCustomButtonView;
-import static net.osmand.plus.settings.fragments.BaseSettingsFragment.APP_MODE_KEY;
 import static net.osmand.plus.settings.fragments.RouteParametersFragment.RELIEF_SMOOTHNESS_FACTOR;
 import static net.osmand.plus.settings.fragments.RouteParametersFragment.getRoutingParameterTitle;
 import static net.osmand.plus.settings.fragments.RouteParametersFragment.isRoutingParameterSelected;
@@ -35,6 +34,7 @@
 import net.osmand.plus.routing.RoutingHelperUtils;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.ApplyQueryType;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.settings.fragments.OnConfirmPreferenceChange;
@@ -235,11 +235,7 @@ public void onResume() {
 
 	@Override
 	public boolean isNightMode(@NonNull OsmandApplication app) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControlsForProfile(appMode);
-		} else {
-			return !app.getSettings().isLightContentForMode(appMode);
-		}
+		return app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.valueOf(usedOnMap));
 	}
 
 	private List<RoutingParameter> getReliefParametersForMode(Map<String, RoutingParameter> parameters) {
diff --git a/OsmAnd/src/net/osmand/plus/settings/controllers/MapFocusDialogController.java b/OsmAnd/src/net/osmand/plus/settings/controllers/MapFocusDialogController.java
index fb250fc4b83..b012712d262 100644
--- a/OsmAnd/src/net/osmand/plus/settings/controllers/MapFocusDialogController.java
+++ b/OsmAnd/src/net/osmand/plus/settings/controllers/MapFocusDialogController.java
@@ -21,6 +21,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.bottomsheets.CustomizableSingleSelectionBottomSheet;
 import net.osmand.plus.settings.enums.MapFocus;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -50,7 +51,7 @@ public DisplayData getDisplayData(@NonNull String processId) {
 		int dividerStartPadding = app.getResources()
 				.getDimensionPixelSize(R.dimen.bottom_sheet_divider_margin_start);
 		UiUtilities iconsCache = app.getUIUtilities();
-		boolean nightMode = !settings.isLightContentForMode(appMode);
+		boolean nightMode = app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.APP);
 		int profileColor = appMode.getProfileColor(nightMode);
 		int profileColorAlpha = ColorUtilities.getColorWithAlpha(profileColor, 0.3f);
 
diff --git a/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java b/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
index 17269d26bdc..f895e50f8a7 100644
--- a/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
+++ b/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
@@ -13,6 +13,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.base.dialog.DialogManager;
 import net.osmand.plus.base.dialog.interfaces.controller.IDialogController;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.ColoringPurpose;
 import net.osmand.plus.card.color.ColoringStyle;
 import net.osmand.plus.card.color.ColoringStyleCardController;
@@ -247,7 +248,7 @@ public void onDestroy(@Nullable FragmentActivity activity) {
 	}
 
 	public void onResume() {
-		initialNightMode = app.getDaynightHelper().isNightModeForMapControls();
+		initialNightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		setMapThemeProvider(this);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/settings/enums/ThemeUsageContext.java b/OsmAnd/src/net/osmand/plus/settings/enums/ThemeUsageContext.java
new file mode 100644
index 00000000000..c349cd24a39
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/settings/enums/ThemeUsageContext.java
@@ -0,0 +1,14 @@
+package net.osmand.plus.settings.enums;
+
+/**
+ * Defines the UI context in which a theme is applied.
+ */
+public enum ThemeUsageContext {
+	MAP,        // Used for the map itself and its direct UI components (e.g., widgets, map buttons)
+	OVER_MAP,   // Used for UI elements displayed over the visible map (e.g., dialogs, bottom sheets opened on top of map)
+	APP;        // Used for screens, dialogs, and bottom sheets opened in contexts where the map is not visible
+
+	public static ThemeUsageContext valueOf(boolean usedOnMap) {
+		return usedOnMap ? OVER_MAP : APP;
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
index 77a6906cfea..ade32166158 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
@@ -59,6 +59,7 @@
 import net.osmand.plus.settings.bottomsheets.EditTextPreferenceBottomSheet;
 import net.osmand.plus.settings.bottomsheets.MultiSelectPreferencesBottomSheet;
 import net.osmand.plus.settings.bottomsheets.SingleSelectPreferenceBottomSheet;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.preferences.ListPreferenceEx;
 import net.osmand.plus.settings.preferences.MultiSelectBooleanPreference;
 import net.osmand.plus.settings.preferences.SwitchPreferenceEx;
@@ -138,7 +139,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
 
 	private boolean updateTheme() {
 		ApplicationMode appMode = getSelectedAppMode();
-		boolean nightMode = !settings.isLightContentForMode(appMode);
+		boolean nightMode = app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.APP);
 		boolean changed = this.nightMode != nightMode;
 		this.nightMode = nightMode;
 		this.themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/GeneralProfileSettingsFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/GeneralProfileSettingsFragment.java
index d6b863da6b6..2ec033ab4fc 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/GeneralProfileSettingsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/GeneralProfileSettingsFragment.java
@@ -37,6 +37,7 @@
 import net.osmand.plus.settings.enums.DrivingRegion;
 import net.osmand.plus.settings.enums.CompassMode;
 import net.osmand.plus.settings.enums.TemperatureUnitsMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.enums.VolumeUnit;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.router.GeneralRouter;
@@ -110,7 +111,8 @@ private Drawable getOsmandThemeIcon() {
 		if (settings.isSystemThemeUsed(mode)) {
 			iconId = R.drawable.ic_action_android;
 		} else {
-			iconId = settings.isLightContentForMode(mode) ? R.drawable.ic_action_sun : R.drawable.ic_action_moon;
+			boolean nightMode = app.getDaynightHelper().isNightMode(mode, ThemeUsageContext.APP);
+			iconId = nightMode ? R.drawable.ic_action_moon : R.drawable.ic_action_sun;
 		}
 		return getActiveIcon(iconId);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
index 52a38336ee4..64120b37ca8 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteParametersFragment.java
@@ -56,6 +56,7 @@
 import net.osmand.plus.settings.enums.ApproximationType;
 import net.osmand.plus.settings.enums.DrivingRegion;
 import net.osmand.plus.settings.enums.RoutingType;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.preferences.ListParameters;
 import net.osmand.plus.settings.preferences.ListPreferenceEx;
 import net.osmand.plus.settings.preferences.MultiSelectBooleanPreference;
@@ -598,26 +599,26 @@ public void onDisplayPreferenceDialog(Preference preference) {
 		}
 	}
 
-	private void showSeekbarSettingsDialog(Activity activity, ApplicationMode mode) {
-		if (activity == null || mode == null) {
+	private void showSeekbarSettingsDialog(Activity activity, ApplicationMode appMode) {
+		if (activity == null || appMode == null) {
 			return;
 		}
 		OsmandApplication app = (OsmandApplication) activity.getApplication();
-		float[] angleValue = {mode.getStrAngle()};
-		boolean nightMode = !app.getSettings().isLightContentForMode(mode);
+		float[] angleValue = {appMode.getStrAngle()};
+		boolean nightMode = app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.APP);
 		Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
 		AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 		View sliderView = LayoutInflater.from(themedContext).inflate(
 				R.layout.recalculation_angle_dialog, null, false);
 		builder.setView(sliderView);
 		builder.setPositiveButton(R.string.shared_string_ok, (dialog, which) -> {
-			mode.setStrAngle(angleValue[0]);
+			appMode.setStrAngle(angleValue[0]);
 			updateAllSettings();
-			app.getRoutingHelper().onSettingsChanged(mode);
+			app.getRoutingHelper().onSettingsChanged(appMode);
 		});
 		builder.setNegativeButton(R.string.shared_string_cancel, null);
 
-		int selectedModeColor = mode.getProfileColor(nightMode);
+		int selectedModeColor = appMode.getProfileColor(nightMode);
 		setupAngleSlider(angleValue, sliderView, nightMode, selectedModeColor);
 		builder.show();
 	}
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/VehicleSpeedHelper.java b/OsmAnd/src/net/osmand/plus/settings/fragments/VehicleSpeedHelper.java
index 8afae1dd278..846d7437f72 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/VehicleSpeedHelper.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/VehicleSpeedHelper.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.routing.RouteService;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.settings.enums.SpeedConstants;
 import net.osmand.plus.settings.enums.SpeedSliderType;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -48,7 +49,7 @@ public VehicleSpeedHelper(@NonNull OsmandApplication app, @NonNull ApplicationMo
 		this.app = app;
 		this.mode = mode;
 		this.settings = app.getSettings();
-		this.nightMode = !settings.isLightContentForMode(mode);
+		this.nightMode = app.getDaynightHelper().isNightMode(mode, ThemeUsageContext.APP);
 	}
 
 	public void showSeekbarSettingsDialog(@NonNull Activity activity) {
diff --git a/OsmAnd/src/net/osmand/plus/simulation/SimulateRouteDialog.java b/OsmAnd/src/net/osmand/plus/simulation/SimulateRouteDialog.java
index 7e4aca5ad83..4f86eb05384 100644
--- a/OsmAnd/src/net/osmand/plus/simulation/SimulateRouteDialog.java
+++ b/OsmAnd/src/net/osmand/plus/simulation/SimulateRouteDialog.java
@@ -14,6 +14,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.GpxDialogs;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -23,7 +24,7 @@ public static void showInstance(@NonNull FragmentActivity activity,
 	                                @NonNull OsmAndLocationSimulation simulation,
 	                                @Nullable Runnable runnable) {
 		OsmandApplication app = (OsmandApplication) activity.getApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(activity, nightMode));
 		builder.setTitle(R.string.animate_route);
 
@@ -40,7 +41,8 @@ public static void showInstance(@NonNull FragmentActivity activity,
 
 		builder.setView(view);
 		builder.setPositiveButton(R.string.shared_string_ok, (dialog, which) -> {
-			boolean mode = app.getDaynightHelper().isNightMode(activity instanceof MapActivity);
+			boolean usedOnMap = activity instanceof MapActivity;
+			boolean mode = app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 			GpxDialogs.selectGPXFile(activity, false, false, result -> {
 				simulation.startSimulationThread(app, result[0], 0, true, speedup.getValue() + 1);
 				if (runnable != null) {
diff --git a/OsmAnd/src/net/osmand/plus/track/GpxTrackAdapter.java b/OsmAnd/src/net/osmand/plus/track/GpxTrackAdapter.java
index bf7f5e41e5e..a90bcab5d6b 100644
--- a/OsmAnd/src/net/osmand/plus/track/GpxTrackAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/track/GpxTrackAdapter.java
@@ -15,6 +15,7 @@
 import net.osmand.IndexConstants;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.data.GPXInfo;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -58,7 +59,7 @@ public class GpxTrackAdapter extends RecyclerView.Adapter<RecyclerView.ViewHolde
 
 	public GpxTrackAdapter(@NonNull Context ctx, @NonNull List<GPXInfo> gpxInfoList) {
 		app = (OsmandApplication) ctx.getApplicationContext();
-		themedInflater = UiUtilities.getInflater(ctx, app.getDaynightHelper().isNightModeForMapControls());
+		themedInflater = UiUtilities.getInflater(ctx, app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP));
 		iconsCache = app.getUIUtilities();
 		this.gpxInfoList = gpxInfoList;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/track/helpers/GpsFilterHelper.java b/OsmAnd/src/net/osmand/plus/track/helpers/GpsFilterHelper.java
index 6a004478838..be206020260 100644
--- a/OsmAnd/src/net/osmand/plus/track/helpers/GpsFilterHelper.java
+++ b/OsmAnd/src/net/osmand/plus/track/helpers/GpsFilterHelper.java
@@ -26,6 +26,7 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
 import net.osmand.plus.utils.FormattedValue;
@@ -229,7 +230,7 @@ public GpsFilter(@NonNull OsmandApplication app, @NonNull SelectedGpxFile select
 				this.selectedMinValue = getMinValue();
 			}
 
-			nightMode = app.getDaynightHelper().isNightModeForMapControls();
+			nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 			blackTextSpan = new ForegroundColorSpan(ColorUtilities.getPrimaryTextColor(app, nightMode));
 			greyTextSpan = new ForegroundColorSpan(ColorUtilities.getSecondaryTextColor(app, nightMode));
diff --git a/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java b/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
index 7a18fde18f0..0c5ea10f230 100644
--- a/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
@@ -21,6 +21,7 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.base.BaseOsmAndFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -134,7 +135,7 @@ protected boolean isUsedOnMap() {
 	public static void setupButton(@NonNull View view, int iconId, @NonNull String title, boolean enabled,
 	                               boolean showDivider, @Nullable OnClickListener listener) {
 		OsmandApplication app = (OsmandApplication) view.getContext().getApplicationContext();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int activeColor = app.getSettings().getApplicationMode().getProfileColor(nightMode);
 		int defColor = ColorUtilities.getDefaultIconColor(app, nightMode);
 		ImageView ivIcon = view.findViewById(R.id.icon);
diff --git a/OsmAnd/src/net/osmand/plus/utils/ColorUtilities.java b/OsmAnd/src/net/osmand/plus/utils/ColorUtilities.java
index 946698f859c..01a4c4150cb 100644
--- a/OsmAnd/src/net/osmand/plus/utils/ColorUtilities.java
+++ b/OsmAnd/src/net/osmand/plus/utils/ColorUtilities.java
@@ -464,4 +464,14 @@ public static int getMapButtonBackgroundPressedColor(@NonNull Context ctx, boole
 	public static int getTransparentColor(@NonNull Context ctx) {
 		return getColor(ctx, R.color.color_transparent);
 	}
+
+	@ColorInt
+	public static int getNavBarBackgroundColor(@NonNull Context ctx, boolean nightMode) {
+		return getColor(ctx, getNavBarBackgroundColorId(nightMode));
+	}
+
+	@ColorRes
+	public static int getNavBarBackgroundColorId(boolean nightMode) {
+		return nightMode ? R.color.navigation_bar_bg_dark : R.color.navigation_bar_bg_light;
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java b/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
index 25b3a6f8283..4107a322794 100644
--- a/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
+++ b/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
@@ -62,6 +62,7 @@
 import net.osmand.plus.render.RenderingIcons;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
 import net.osmand.plus.views.MapLayers;
 import net.osmand.plus.views.mapwidgets.MapWidgetRegistry;
@@ -758,19 +759,19 @@ public static void updateStatusBarColor(@NonNull MapActivity activity) {
 		int color = TopToolbarController.NO_COLOR;
 		boolean mapControlsVisible = activity.findViewById(R.id.map_hud_layout).getVisibility() == View.VISIBLE;
 		boolean topToolbarVisible = mapLayers.getMapInfoLayer().isTopToolbarViewVisible();
-		boolean night = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 
 		TopToolbarController toolbarController = mapLayers.getMapInfoLayer().getTopToolbarController();
 		if (toolbarController != null && mapControlsVisible && topToolbarVisible) {
-			color = toolbarController.getStatusBarColor(activity, night);
+			color = toolbarController.getStatusBarColor(activity, nightMode);
 		}
 		if (color == TopToolbarController.NO_COLOR) {
 			ApplicationMode appMode = settings.getApplicationMode();
 			MapWidgetRegistry widgetRegistry = mapLayers.getMapWidgetRegistry();
-			int defaultColorId = night ? R.color.status_bar_transparent_dark : R.color.status_bar_transparent_light;
-			int colorIdForTopWidget = widgetRegistry.getStatusBarColor(appMode, night);
+			int defaultColorId = nightMode ? R.color.status_bar_transparent_dark : R.color.status_bar_transparent_light;
+			int colorIdForTopWidget = widgetRegistry.getStatusBarColor(appMode, nightMode);
 			if (colorIdForTopWidget != -1) {
-				nightModeForContent = widgetRegistry.getStatusBarContentNightMode(appMode, night);
+				nightModeForContent = widgetRegistry.getStatusBarContentNightMode(appMode, nightMode);
 			}
 
 			colorId = mapControlsVisible && colorIdForTopWidget != -1 ? colorIdForTopWidget : defaultColorId;
diff --git a/OsmAnd/src/net/osmand/plus/views/AutoZoomBySpeedHelper.java b/OsmAnd/src/net/osmand/plus/views/AutoZoomBySpeedHelper.java
index 8ed457ec322..a0d993874ac 100644
--- a/OsmAnd/src/net/osmand/plus/views/AutoZoomBySpeedHelper.java
+++ b/OsmAnd/src/net/osmand/plus/views/AutoZoomBySpeedHelper.java
@@ -13,6 +13,7 @@
 import net.osmand.core.jni.PointI;
 import net.osmand.data.LatLon;
 import net.osmand.data.RotatedTileBox;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.shared.gpx.GpxTrackAnalysis;
 import net.osmand.shared.gpx.GpxTrackAnalysis.TrackPointsAnalyser;
 import net.osmand.shared.gpx.primitives.WptPt;
@@ -401,8 +402,7 @@ private static OrderedLineDataSet getZoomDataSet(@NonNull OsmandApplication app,
 	                                                 @NonNull GPXDataSetAxisType chartAxisType,
 	                                                 boolean calcWithoutGaps,
 	                                                 boolean useRightAxis) {
-		OsmandSettings settings = app.getSettings();
-		boolean nightMode = !settings.isLightContent();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		float divX = ChartUtils.getDivX(app, chart, analysis, chartAxisType, calcWithoutGaps);
 
diff --git a/OsmAnd/src/net/osmand/plus/views/MapLayers.java b/OsmAnd/src/net/osmand/plus/views/MapLayers.java
index 4f52ee4b15f..4ccdf6c339d 100644
--- a/OsmAnd/src/net/osmand/plus/views/MapLayers.java
+++ b/OsmAnd/src/net/osmand/plus/views/MapLayers.java
@@ -33,6 +33,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.layers.*;
@@ -590,7 +591,7 @@ private void updateRoutingPoiFiltersIfNeeded() {
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightModeForMapControls();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 
 	public RouteLayer getRouteLayer() {
diff --git a/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java b/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
index 61e52259bd0..c535a82d478 100644
--- a/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
+++ b/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
@@ -23,6 +23,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.inapp.InAppPurchaseUtils;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.OsmandMap.RenderingViewSetupListener;
@@ -63,7 +64,7 @@ public MapViewWithLayers(@NonNull Context context, @Nullable AttributeSet attrs,
 		mapView = osmandMap.getMapView();
 		mapView.setupTouchDetectors(getContext());
 
-		boolean nightMode = app.getDaynightHelper().isNightMode();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		inflate(UiUtilities.getThemedContext(context, nightMode), R.layout.map_view_with_layers, this);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/views/OsmAndMapLayersView.java b/OsmAnd/src/net/osmand/plus/views/OsmAndMapLayersView.java
index 0b2dc866613..320b61c78d9 100644
--- a/OsmAnd/src/net/osmand/plus/views/OsmAndMapLayersView.java
+++ b/OsmAnd/src/net/osmand/plus/views/OsmAndMapLayersView.java
@@ -10,6 +10,7 @@
 import androidx.annotation.Nullable;
 
 import net.osmand.core.android.MapRendererView;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
 
 public class OsmAndMapLayersView extends View {
@@ -79,7 +80,7 @@ protected void onDraw(Canvas canvas) {
 		if (mapView == null) {
 			return;
 		}
-		boolean nightMode = mapView.getApplication().getDaynightHelper().isNightMode();
+		boolean nightMode = mapView.getApplication().getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		DrawSettings drawSettings = new DrawSettings(nightMode, false);
 		mapView.drawOverMap(canvas, mapView.getRotatedTileBox(), drawSettings);
 
diff --git a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
index 8b65301ff48..3b1a68e5803 100644
--- a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
+++ b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
@@ -61,6 +61,7 @@
 import net.osmand.plus.render.UpdateRendererAsyncTask;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.CompassMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.NativeUtilities;
 import net.osmand.plus.utils.OsmAndFormatter;
@@ -1319,7 +1320,7 @@ public void refreshMap() {
 	// this method could be called in non UI thread
 	public void refreshMap(boolean updateVectorRendering) {
 		if (view != null && view.isShown()) {
-			boolean nightMode = app.getDaynightHelper().isNightMode();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 			Boolean currentNightMode = this.nightMode;
 			boolean forceUpdateVectorDrawing = currentNightMode != null && currentNightMode != nightMode;
 			if (forceUpdateVectorDrawing) {
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java b/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
index 79cea9d308f..fa0c22e2845 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
@@ -31,6 +31,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.controls.MapHudLayout.ViewChangeListener;
@@ -80,7 +81,7 @@ public SideWidgetsPanel(@NonNull Context context, @Nullable AttributeSet attrs,
 
 	public SideWidgetsPanel(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
 		super(context, attrs, defStyleAttr, defStyleRes);
-		nightMode = getMyApplication().getDaynightHelper().isNightMode();
+		nightMode = getMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		context = UiUtilities.getThemedContext(getContext(), nightMode);
 
 		definePanelSide(context, attrs);
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java b/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
index 6ecab747842..8a5d1906e85 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
@@ -22,6 +22,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.controls.MapHudLayout.ViewChangeListener;
 import net.osmand.plus.views.controls.MapHudLayout.ViewChangeProvider;
@@ -65,7 +66,7 @@ public VerticalWidgetPanel(@NonNull Context context, AttributeSet attrs, int def
 		super(context, attrs, defStyleAttr, defStyleRes);
 		app = (OsmandApplication) context.getApplicationContext();
 		settings = app.getSettings();
-		nightMode = app.getDaynightHelper().isNightMode();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		widgetRegistry = app.getOsmandMap().getMapLayers().getMapWidgetRegistry();
 		definePanelSide(context, attrs);
 		init();
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java b/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
index f0a05be3143..07643f7777b 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
@@ -41,6 +41,7 @@
 import net.osmand.plus.quickaction.ButtonAppearanceParams;
 import net.osmand.plus.render.RenderingIcons;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -141,7 +142,7 @@ protected void init() {
 		addOnAttachStateChangeListener(this);
 		setBackgroundColor(Color.TRANSPARENT);
 		setPadding((int) shadowPadding, (int) shadowPadding, (int) shadowPadding, (int) shadowPadding);
-		setNightMode(app.getDaynightHelper().isNightMode());
+		setNightMode(app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP));
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/AidlMapLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/AidlMapLayer.java
index 7628537f763..a34ba40096e 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/AidlMapLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/AidlMapLayer.java
@@ -29,6 +29,7 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.mapcontextmenu.MapContextMenu;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.NativeUtilities;
 import net.osmand.plus.views.OsmandMapTileView;
@@ -117,7 +118,7 @@ public void initLayer(@NonNull OsmandMapTileView view) {
 		super.initLayer(view);
 
 		Resources res = view.getResources();
-		boolean night = getApplication().getDaynightHelper().isNightMode();
+		boolean nightMode = getApplication().getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 
 		pointInnerCircle = new Paint();
 		pointInnerCircle.setColor(getColor(R.color.poi_background));
@@ -134,8 +135,8 @@ public void initLayer(@NonNull OsmandMapTileView view) {
 		bitmapPaint.setDither(true);
 		bitmapPaint.setFilterBitmap(true);
 
-		nightMode = night;
-		recreateBitmaps(night);
+		this.nightMode = nightMode;
+		recreateBitmaps(nightMode);
 
 		mapTextLayer = view.getLayerByClass(MapTextLayer.class);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/CoordinatesGridLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/CoordinatesGridLayer.java
index 511a6644d88..150e7cdef86 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/CoordinatesGridLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/CoordinatesGridLayer.java
@@ -27,6 +27,7 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.GridFormat;
 import net.osmand.plus.settings.enums.GridLabelsPosition;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.NativeUtilities;
@@ -335,7 +336,7 @@ private void cleanupMarksProvider(@NonNull MapRendererView mapRenderer) {
 	}
 
 	private boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode();
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
index c9a111308af..bbb8a5d43c0 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
@@ -25,6 +25,7 @@
 import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.OsmandMapTileView;
@@ -128,7 +129,7 @@ public void initMapButtons() {
 			mapHudLayout.removeMapButton(button);
 		}
 
-		boolean nightMode = app.getDaynightHelper().isNightMode();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		LayoutInflater inflater = UiUtilities.getInflater(activity, nightMode);
 
 		addMapButton(createMapButton(inflater, R.layout.configure_map_button));
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
index 93bb7c97d3d..c0d9517a96e 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
@@ -33,6 +33,7 @@
 import net.osmand.plus.quickaction.QuickActionsWidget;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.MapPosition;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.NativeUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -122,7 +123,7 @@ public void setMapActivity(@Nullable MapActivity mapActivity) {
 	private void updateButtons() {
 		MapActivity activity = getMapActivity();
 		if (activity != null) {
-			boolean nightMode = app.getDaynightHelper().isNightMode();
+			boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 			LayoutInflater inflater = UiUtilities.getInflater(activity, nightMode);
 
 			for (QuickActionButton button : actionButtons) {
@@ -407,7 +408,7 @@ public boolean onBackPressed() {
 
 	private void updateButton(@NonNull QuickActionButton button, boolean invalidated) {
 		button.setInvalidated(invalidated);
-		button.setNightMode(app.getDaynightHelper().isNightMode());
+		button.setNightMode(app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP));
 		button.update();
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapTransparencyHelper.java b/OsmAnd/src/net/osmand/plus/views/layers/MapTransparencyHelper.java
index e33f78bdd4c..7c7ddaffa8d 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapTransparencyHelper.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapTransparencyHelper.java
@@ -16,6 +16,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 
 public class MapTransparencyHelper {
@@ -128,7 +129,7 @@ public void showTransparencyBar(@NonNull CommonPreference<Integer> preference) {
 
 	protected void updateTransparencySliderUi() {
 		ApplicationMode appMode = app.getSettings().getApplicationMode();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int selectedModeColor = appMode.getProfileColor(nightMode);
 		UiUtilities.setupSlider(transparencySlider, nightMode, selectedModeColor);
 	}
@@ -169,7 +170,7 @@ public void showParameterBar(@NonNull MapTileLayer layer) {
 
 	private void updateParameterSliderUi() {
 		ApplicationMode appMode = app.getSettings().getApplicationMode();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int selectedModeColor = appMode.getProfileColor(nightMode);
 		UiUtilities.setupSlider(parameterSlider, nightMode, selectedModeColor);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/POIMapLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/POIMapLayer.java
index 925b23ee6ff..dafc801de29 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/POIMapLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/POIMapLayer.java
@@ -43,7 +43,6 @@
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.card.color.palette.main.data.DefaultColors;
 import net.osmand.plus.exploreplaces.ExplorePlacesFragment;
-import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.helpers.WaypointHelper;
 import net.osmand.plus.mapcontextmenu.MapContextMenu;
 import net.osmand.plus.plugins.PluginsHelper;
@@ -55,6 +54,7 @@
 import net.osmand.plus.routing.IRouteInformationListener;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.search.listitems.QuickSearchWikiItem;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.NativeUtilities;
@@ -62,7 +62,6 @@
 import net.osmand.plus.views.PointImageDrawable;
 import net.osmand.plus.views.PointImageUtils;
 import net.osmand.plus.views.layers.ContextMenuLayer.IContextMenuProvider;
-import net.osmand.plus.views.layers.MapSelectionResult.SelectedMapObject;
 import net.osmand.plus.views.layers.MapTextLayer.MapTextProvider;
 import net.osmand.plus.views.layers.base.OsmandMapLayer;
 import net.osmand.plus.views.layers.core.POITileProvider;
@@ -898,7 +897,7 @@ public static void showPlainDescriptionDialog(Context ctx, OsmandApplication app
 		TextView textView = new TextView(ctx);
 		LinearLayout.LayoutParams llTextParams = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);
 		int textMargin = dpToPx(app, 10f);
-		boolean light = app.getSettings().isLightContent();
+		boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		textView.setLayoutParams(llTextParams);
 		textView.setPadding(textMargin, textMargin, textMargin, textMargin);
 		textView.setTextSize(16);
@@ -920,7 +919,7 @@ public static void showHtmlDescriptionDialog(Context ctx, OsmandApplication app,
 		webView.setVerticalScrollBarEnabled(false);
 		webView.setBackgroundColor(Color.TRANSPARENT);
 		webView.getSettings().setTextZoom((int) (app.getResources().getConfiguration().fontScale * 100f));
-		boolean light = app.getSettings().isLightContent();
+		boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		int textColor = ColorUtilities.getPrimaryTextColor(app, !light);
 		String rgbHex = Algorithms.colorToString(textColor);
 		html = "<body style=\"color:" + rgbHex + ";\">" + html + "</body>";
@@ -940,8 +939,8 @@ static int getResIdFromAttribute(Context ctx, int attr) {
 	}
 
 	private static void showText(Context ctx, OsmandApplication app, View view, String title) {
-		Dialog dialog = new Dialog(ctx,
-				app.getSettings().isLightContent() ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme);
+		boolean light = !app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+		Dialog dialog = new Dialog(ctx, light ? R.style.OsmandLightTheme : R.style.OsmandDarkTheme);
 
 		LinearLayout ll = new LinearLayout(ctx);
 		ll.setOrientation(LinearLayout.VERTICAL);
@@ -1162,7 +1161,7 @@ private void showTopPlaceContextMenu(@NonNull MapActivity mapActivity,
 
 	private Bitmap createImageBitmap(Bitmap bitmap, boolean isSelected) {
 		OsmandApplication app = getApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		int borderWidth = AndroidUtils.dpToPxAuto(app, IMAGE_ICON_BORDER_DP);
 		int bigIconSize = getBigIconSize();
 		Bitmap circle = getCircle(bigIconSize);
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/geometry/MultiColoringGeometryWay.java b/OsmAnd/src/net/osmand/plus/views/layers/geometry/MultiColoringGeometryWay.java
index 7c7dd664527..e37d92c05c8 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/geometry/MultiColoringGeometryWay.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/geometry/MultiColoringGeometryWay.java
@@ -12,6 +12,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.helpers.ColorPaletteHelper;
 import net.osmand.plus.render.MapRenderRepositories;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.Gpx3DLinePositionType;
 import net.osmand.plus.track.Gpx3DVisualizationType;
 import net.osmand.shared.routing.Gpx3DWallColorType;
@@ -263,14 +264,14 @@ protected int getIdxOfFirstSegmentLocation(List<Location> locations, List<RouteS
 
 	private RouteStatisticComputer createRouteStatisticsComputer() {
 		OsmandApplication app = getContext().getApp();
-		boolean night = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		RenderingRulesStorage currentRenderer = app.getRendererRegistry().getCurrentSelectedRenderer();
 		RenderingRulesStorage defaultRenderer = app.getRendererRegistry().defaultRender();
 		MapRenderRepositories maps = app.getResourceManager().getRenderer();
 		RenderingRuleSearchRequest currentSearchRequest =
-				maps.getSearchRequestWithAppliedCustomRules(currentRenderer, night);
+				maps.getSearchRequestWithAppliedCustomRules(currentRenderer, nightMode);
 		RenderingRuleSearchRequest defaultSearchRequest =
-				maps.getSearchRequestWithAppliedCustomRules(defaultRenderer, night);
+				maps.getSearchRequestWithAppliedCustomRules(defaultRenderer, nightMode);
 
 		return new RouteStatisticComputer(currentRenderer, defaultRenderer,
 				currentSearchRequest, defaultSearchRequest);
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/buttons/CompassButtonState.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/buttons/CompassButtonState.java
index ebf63b1282f..d4417fab4bc 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/buttons/CompassButtonState.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/buttons/CompassButtonState.java
@@ -1,9 +1,7 @@
 package net.osmand.plus.views.mapwidgets.configure.buttons;
 
 import static net.osmand.aidlapi.OsmAndCustomizationConstants.COMPASS_HUD_ID;
-import static net.osmand.plus.quickaction.ButtonAppearanceParams.ROUND_RADIUS_DP;
 import static net.osmand.plus.quickaction.ButtonAppearanceParams.SMALL_SIZE_DP;
-import static net.osmand.plus.quickaction.ButtonAppearanceParams.TRANSPARENT_ALPHA;
 import static net.osmand.plus.settings.enums.CompassVisibility.ALWAYS_HIDDEN;
 import static net.osmand.plus.settings.enums.CompassVisibility.ALWAYS_VISIBLE;
 import static net.osmand.plus.views.controls.maphudbuttons.ButtonPositionSize.POS_LEFT;
@@ -24,6 +22,7 @@
 import net.osmand.plus.settings.backend.preferences.EnumStringPreference;
 import net.osmand.plus.settings.enums.CompassMode;
 import net.osmand.plus.settings.enums.CompassVisibility;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.views.controls.maphudbuttons.ButtonPositionSize;
 import net.osmand.plus.views.controls.maphudbuttons.CompassDrawable;
@@ -129,7 +128,7 @@ public ButtonAppearanceParams createAppearanceParams() {
 	@Override
 	public String getDefaultIconName() {
 		CompassMode compassMode = settings.getCompassMode();
-		boolean nightMode = app.getDaynightHelper().isNightMode();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		return app.getResources().getResourceEntryName(compassMode.getIconId().getIconId(nightMode));
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/SearchWidgetsFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/SearchWidgetsFragment.java
index 1176227fb01..b9e187cc4c6 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/SearchWidgetsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/SearchWidgetsFragment.java
@@ -35,6 +35,7 @@
 import net.osmand.plus.chooseplan.OsmAndFeature;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
@@ -87,7 +88,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		app = (OsmandApplication) requireContext().getApplicationContext();
 		widgetRegistry = app.getOsmandMap().getMapLayers().getMapWidgetRegistry();
 		settings = app.getSettings();
-		nightMode = !settings.isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		selectedAppMode = settings.getApplicationMode();
 		iconsHelper = new WidgetIconsHelper(app, selectedAppMode.getProfileColor(nightMode), nightMode);
 
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsListFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsListFragment.java
index 4a5ff552624..45889874d6b 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/panel/WidgetsListFragment.java
@@ -33,6 +33,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.bottomsheets.ConfirmationBottomSheet;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.layers.MapInfoLayer;
 import net.osmand.plus.views.mapwidgets.MapWidgetInfo;
@@ -79,7 +80,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = (OsmandApplication) requireContext().getApplicationContext();
 		settings = app.getSettings();
-		nightMode = !settings.isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		selectedAppMode = settings.getApplicationMode();
 		widgetRegistry = app.getOsmandMap().getMapLayers().getMapWidgetRegistry();
 
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/MapMarkerSideWidgetInfoFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/MapMarkerSideWidgetInfoFragment.java
index 474d5b0e417..e7ac7293272 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/MapMarkerSideWidgetInfoFragment.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/settings/MapMarkerSideWidgetInfoFragment.java
@@ -20,6 +20,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -200,9 +201,9 @@ private View createButtonWithDescription(int iconId,
 	}
 
 	private void showSeekbarSettingsDialog() {
-		boolean nightMode = !app.getSettings().isLightContentForMode(appMode);
+		boolean nightMode = app.getDaynightHelper().isNightMode(appMode, ThemeUsageContext.APP);
 		localSeekBarIntervalMillis = selectedIntervalMillis;
-		Context themedContext = UiUtilities.getThemedContext(getActivity(), nightMode);
+		Context themedContext = UiUtilities.getThemedContext(requireActivity(), nightMode);
 		AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
 		View seekbarView = themedInflater.inflate(R.layout.map_marker_interval_dialog, null, false);
 		builder.setView(seekbarView);
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/MapWidget.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/MapWidget.java
index 87b9a812150..5d42f96aa50 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/MapWidget.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/MapWidget.java
@@ -19,6 +19,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.views.mapwidgets.OutlinedTextContainer;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
@@ -63,7 +64,7 @@ public MapWidget(@NonNull MapActivity mapActivity, @NonNull WidgetType widgetTyp
 		this.iconsCache = app.getUIUtilities();
 		this.locationProvider = app.getLocationProvider();
 		this.routingHelper = app.getRoutingHelper();
-		this.nightMode = app.getDaynightHelper().isNightMode();
+		this.nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		this.visibilityHelper = mapActivity.getWidgetsVisibilityHelper();
 		this.view = UiUtilities.getInflater(mapActivity, nightMode).inflate(getLayoutId(), null);
 
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/SpeedometerWidget.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/SpeedometerWidget.java
index 1c1a0eb0dff..4a43d5cbaf7 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/SpeedometerWidget.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/SpeedometerWidget.java
@@ -44,6 +44,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.DrivingRegion;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.router.RouteSegmentResult;
 import net.osmand.shared.settings.enums.SpeedConstants;
 import net.osmand.plus.settings.enums.WidgetSize;
@@ -261,7 +262,7 @@ public void updatePreviewInfo(boolean nightMode) {
 	}
 
 	public void updateInfo(@Nullable DrawSettings drawSettings) {
-		boolean nightMode = drawSettings != null ? drawSettings.isNightMode() : app.getDaynightHelper().isNightMode();
+		boolean nightMode = drawSettings != null ? drawSettings.isNightMode() : app.getDaynightHelper().isNightMode(ThemeUsageContext.MAP);
 		updateInfo(drawSettings, false, nightMode);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/voice/VoiceProviderDialog.java b/OsmAnd/src/net/osmand/plus/voice/VoiceProviderDialog.java
index c33635ef2ee..f2cb006bca3 100644
--- a/OsmAnd/src/net/osmand/plus/voice/VoiceProviderDialog.java
+++ b/OsmAnd/src/net/osmand/plus/voice/VoiceProviderDialog.java
@@ -13,6 +13,7 @@
 import net.osmand.plus.routepreparationmenu.RoutingOptionsHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.util.Algorithms;
 
@@ -23,7 +24,7 @@ public class VoiceProviderDialog {
 	public static void showVoiceProviderDialog(@NonNull MapActivity activity, ApplicationMode appMode, boolean applyAllModes) {
 		OsmandApplication app = activity.getMyApplication();
 		OsmandSettings settings = app.getSettings();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 		RoutingOptionsHelper routingOptionsHelper = app.getRoutingOptionsHelper();
 		AlertDialog.Builder builder = new AlertDialog.Builder(UiUtilities.getThemedContext(activity, nightMode));
 		String[] firstSelectedVoiceProvider = new String[1];
@@ -31,7 +32,7 @@ public static void showVoiceProviderDialog(@NonNull MapActivity activity, Applic
 		View view = UiUtilities.getInflater(activity, nightMode).inflate(R.layout.select_voice_first, null);
 
 		((ImageView) view.findViewById(R.id.icon))
-				.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_volume_up, settings.isLightContent()));
+				.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_volume_up, !nightMode));
 
 		view.findViewById(R.id.spinner).setOnClickListener(v -> routingOptionsHelper.selectVoiceGuidance(activity, result -> {
 			boolean acceptableValue = MORE_VALUE.equals(firstSelectedVoiceProvider[0]);
@@ -44,7 +45,7 @@ public static void showVoiceProviderDialog(@NonNull MapActivity activity, Applic
 		}, appMode));
 
 		((ImageView) view.findViewById(R.id.dropDownIcon))
-				.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_arrow_drop_down, settings.isLightContent()));
+				.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_arrow_drop_down, !nightMode));
 
 		builder.setCancelable(true);
 		builder.setNegativeButton(R.string.shared_string_cancel, null);
diff --git a/OsmAnd/src/net/osmand/plus/wikipedia/WikipediaPoiMenu.java b/OsmAnd/src/net/osmand/plus/wikipedia/WikipediaPoiMenu.java
index 06750c12f7c..de1fc45369d 100644
--- a/OsmAnd/src/net/osmand/plus/wikipedia/WikipediaPoiMenu.java
+++ b/OsmAnd/src/net/osmand/plus/wikipedia/WikipediaPoiMenu.java
@@ -21,6 +21,7 @@
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.poi.PoiUIFilter;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.widgets.ctxmenu.ContextMenuAdapter;
 import net.osmand.plus.widgets.ctxmenu.callback.OnDataChangeUiAdapter;
@@ -54,7 +55,7 @@ public WikipediaPoiMenu(@NonNull MapActivity activity) {
 		this.activity = activity;
 		this.app = activity.getMyApplication();
 		this.settings = app.getSettings();
-		this.nightMode = app.getDaynightHelper().isNightModeForMapControls();
+		this.nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java b/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
index 339dc483797..4101603ffd4 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
@@ -17,6 +17,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.track.fragments.ReadDescriptionFragment;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.wikipedia.WikiArticleHelper;
@@ -100,6 +101,6 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {
 	}
 
 	protected boolean isNightMode() {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		return app.getDaynightHelper().isNightMode(ThemeUsageContext.valueOf(usedOnMap));
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/WikivoyageShowPicturesDialogFragment.java b/OsmAnd/src/net/osmand/plus/wikivoyage/WikivoyageShowPicturesDialogFragment.java
index a4c278e5faf..bdd199c94ab 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/WikivoyageShowPicturesDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/WikivoyageShowPicturesDialogFragment.java
@@ -15,6 +15,7 @@
 import androidx.annotation.NonNull;
 import androidx.fragment.app.Fragment;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
@@ -33,33 +34,27 @@ public class WikivoyageShowPicturesDialogFragment extends BottomSheetDialogFragm
 
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-		nightMode = !getMyApplication().getSettings().isLightContent();
+		nightMode = requiredMyApplication().getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		View view = inflater.inflate(R.layout.fragment_wikivoyage_show_images_first_time, container, false);
 		TextView buttonNo = view.findViewById(R.id.button_no);
 		buttonNo.setText(R.string.shared_string_only_with_wifi);
-		buttonNo.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				OsmandApplication app = getMyApplication();
-				if (app != null) {
-					app.getSettings().WIKI_ARTICLE_SHOW_IMAGES.set(WikiArticleShowImages.WIFI);
-				}
-				sendResult();
-				dismiss();
+		buttonNo.setOnClickListener(v -> {
+			OsmandApplication app = getMyApplication();
+			if (app != null) {
+				app.getSettings().WIKI_ARTICLE_SHOW_IMAGES.set(WikiArticleShowImages.WIFI);
 			}
+			sendResult();
+			dismiss();
 		});
 		TextView buttonDownload = view.findViewById(R.id.button_download);
 		buttonDownload.setText(R.string.shared_string_always);
-		buttonDownload.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				OsmandApplication app = getMyApplication();
-				if (app != null) {
-					app.getSettings().WIKI_ARTICLE_SHOW_IMAGES.set(WikiArticleShowImages.ON);
-				}
-				sendResult();
-				dismiss();
+		buttonDownload.setOnClickListener(v -> {
+			OsmandApplication app = getMyApplication();
+			if (app != null) {
+				app.getSettings().WIKI_ARTICLE_SHOW_IMAGES.set(WikiArticleShowImages.ON);
 			}
+			sendResult();
+			dismiss();
 		});
 		setupHeightAndBackground(view);
 		return view;
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/SavedArticlesRvAdapter.java b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/SavedArticlesRvAdapter.java
index c75f83c048c..6a4cb3322d9 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/SavedArticlesRvAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/SavedArticlesRvAdapter.java
@@ -18,6 +18,7 @@
 import com.squareup.picasso.Picasso;
 import com.squareup.picasso.RequestCreator;
 
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.PicassoUtils;
 import net.osmand.osm.OsmRouteType;
@@ -65,7 +66,7 @@ public void setListener(Listener listener) {
 		this.app = app;
 		this.settings = app.getSettings();
 		picasso = PicassoUtils.getPicasso(app);
-		nightMode = !app.getSettings().isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 		readIcon = getActiveIcon(R.drawable.ic_action_read_article);
 		deleteIcon = getActiveIcon(R.drawable.ic_action_read_later_fill);
 	}
@@ -263,27 +264,18 @@ public void onClick(View view) {
 			itemView.setOnClickListener(readClickListener);
 			leftButton.setOnClickListener(readClickListener);
 
-			rightButton.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View view) {
-					Object item = getItemByPosition();
-					if (item instanceof TravelArticle) {
-						TravelArticle article = (TravelArticle) item;
-						TravelHelper helper = app.getTravelHelper();
-						helper.saveOrRemoveArticle(article, false);
-						Snackbar snackbar = Snackbar.make(itemView, R.string.article_removed, Snackbar.LENGTH_LONG)
-								.setAction(R.string.shared_string_undo, new View.OnClickListener() {
-									@Override
-									public void onClick(View view) {
-										helper.saveOrRemoveArticle(article, true);
-									}
-								});
-						boolean nightMode = !settings.isLightContent();
-						UiUtilities.setupSnackbar(snackbar, nightMode);
-						int wikivoyageActiveColorResId = nightMode ? R.color.active_color_primary_dark : R.color.active_color_primary_light;
-						UiUtilities.setupSnackbar(snackbar, nightMode, null, null, wikivoyageActiveColorResId, null);
-						snackbar.show();
-					}
+			rightButton.setOnClickListener(view -> {
+				Object item = getItemByPosition();
+				if (item instanceof TravelArticle article) {
+					TravelHelper helper = app.getTravelHelper();
+					helper.saveOrRemoveArticle(article, false);
+					Snackbar snackbar = Snackbar.make(itemView, R.string.article_removed, Snackbar.LENGTH_LONG)
+							.setAction(R.string.shared_string_undo, v -> helper.saveOrRemoveArticle(article, true));
+					boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
+					UiUtilities.setupSnackbar(snackbar, nightMode);
+					int wikivoyageActiveColorResId = nightMode ? R.color.active_color_primary_dark : R.color.active_color_primary_light;
+					UiUtilities.setupSnackbar(snackbar, nightMode, null, null, wikivoyageActiveColorResId, null);
+					snackbar.show();
 				}
 			});
 		}
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
index 142e1ab918b..6732cf223f8 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
@@ -34,6 +34,7 @@
 import net.osmand.plus.activities.TabActivity;
 import net.osmand.plus.download.DownloadIndexesThread.DownloadEvents;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.ThemeUsageContext;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.wikipedia.WikiArticleHelper;
@@ -69,7 +70,7 @@ public class WikivoyageExploreActivity extends TabActivity implements DownloadEv
 	public void onCreate(Bundle savedInstanceState) {
 		app = getMyApplication();
 		OsmandSettings settings = app.getSettings();
-		nightMode = !settings.isLightContent();
+		nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.APP);
 
 		int themeId = nightMode ? R.style.OsmandDarkTheme_NoActionbar : R.style.OsmandLightTheme_NoActionbar_LightStatusBar;
 		app.getLocaleHelper().setLanguage(this);
