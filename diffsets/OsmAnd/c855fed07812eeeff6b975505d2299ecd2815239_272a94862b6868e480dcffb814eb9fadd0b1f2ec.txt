diff --git a/OsmAnd/res/layout-land/add_gpx_point_bottom_sheet.xml b/OsmAnd/res/layout-land/add_gpx_point_bottom_sheet.xml
index ca545376440..c3643020b24 100644
--- a/OsmAnd/res/layout-land/add_gpx_point_bottom_sheet.xml
+++ b/OsmAnd/res/layout-land/add_gpx_point_bottom_sheet.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout
+<net.osmand.plus.widgets.LinearLayoutEx
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/add_gpx_point_bottom_sheet"
     xmlns:android="http://schemas.android.com/apk/res/android"
@@ -69,4 +69,5 @@
         android:layout_gravity="center_vertical"
         android:text="@string/shared_string_cancel"
         android:layout_marginEnd="@dimen/content_padding" />
-</LinearLayout>
\ No newline at end of file
+
+</net.osmand.plus.widgets.LinearLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/res/layout-land/map_hud_bottom.xml b/OsmAnd/res/layout-land/map_hud_bottom.xml
index 6ac79314a1e..cf533c33361 100644
--- a/OsmAnd/res/layout-land/map_hud_bottom.xml
+++ b/OsmAnd/res/layout-land/map_hud_bottom.xml
@@ -65,7 +65,7 @@
 					android:orientation="horizontal">
 
 
-					<FrameLayout
+					<net.osmand.plus.widgets.FrameLayoutEx
 						android:id="@+id/measurement_buttons"
 						android:layout_width="wrap_content"
 						android:layout_height="wrap_content">
@@ -87,7 +87,8 @@
 							android:layout_height="@dimen/map_button_size"
 							android:layout_gravity="bottom"
 							android:visibility="gone" />
-					</FrameLayout>
+
+					</net.osmand.plus.widgets.FrameLayoutEx>
 
 				</LinearLayout>
 			</LinearLayout>
diff --git a/OsmAnd/res/layout-land/recording_note_fragment.xml b/OsmAnd/res/layout-land/recording_note_fragment.xml
index 0e34af0ce85..89e9b82a8e4 100644
--- a/OsmAnd/res/layout-land/recording_note_fragment.xml
+++ b/OsmAnd/res/layout-land/recording_note_fragment.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<FrameLayout
+<net.osmand.plus.widgets.FrameLayoutEx
     android:id="@+id/recording_note_layout"
     xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
@@ -177,4 +177,4 @@
 
     </LinearLayout>
 
-</FrameLayout>
\ No newline at end of file
+</net.osmand.plus.widgets.FrameLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/add_gpx_point_bottom_sheet.xml b/OsmAnd/res/layout/add_gpx_point_bottom_sheet.xml
index 02b438f87ee..0d2f548f439 100644
--- a/OsmAnd/res/layout/add_gpx_point_bottom_sheet.xml
+++ b/OsmAnd/res/layout/add_gpx_point_bottom_sheet.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout
+<net.osmand.plus.widgets.LinearLayoutEx
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/add_gpx_point_bottom_sheet"
     xmlns:android="http://schemas.android.com/apk/res/android"
@@ -77,6 +77,6 @@
                 android:text="@string/shared_string_cancel" />
         </LinearLayout>
 
-
     </LinearLayout>
-</LinearLayout>
\ No newline at end of file
+
+</net.osmand.plus.widgets.LinearLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/map_hud_bottom.xml b/OsmAnd/res/layout/map_hud_bottom.xml
index 889726110c2..236d1b52953 100644
--- a/OsmAnd/res/layout/map_hud_bottom.xml
+++ b/OsmAnd/res/layout/map_hud_bottom.xml
@@ -1,5 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<net.osmand.plus.widgets.LinearLayoutEx
+	xmlns:android="http://schemas.android.com/apk/res/android"
 	xmlns:app="http://schemas.android.com/apk/res-auto"
 	xmlns:tools="http://schemas.android.com/tools"
 	android:layout_width="match_parent"
@@ -132,4 +133,4 @@
 
 	</FrameLayout>
 
-</LinearLayout>
\ No newline at end of file
+</net.osmand.plus.widgets.LinearLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/recording_note_fragment.xml b/OsmAnd/res/layout/recording_note_fragment.xml
index aaafd99a98b..d7fe327792d 100644
--- a/OsmAnd/res/layout/recording_note_fragment.xml
+++ b/OsmAnd/res/layout/recording_note_fragment.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<FrameLayout
+<net.osmand.plus.widgets.FrameLayoutEx
     android:id="@+id/recording_note_layout"
     xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
@@ -186,4 +186,4 @@
 
     </LinearLayout>
 
-</FrameLayout>
\ No newline at end of file
+</net.osmand.plus.widgets.FrameLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/recording_note_fragment_fullscreen.xml b/OsmAnd/res/layout/recording_note_fragment_fullscreen.xml
index 4176532c6d3..981e7da0029 100644
--- a/OsmAnd/res/layout/recording_note_fragment_fullscreen.xml
+++ b/OsmAnd/res/layout/recording_note_fragment_fullscreen.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<FrameLayout
+<net.osmand.plus.widgets.FrameLayoutEx
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/recording_note_layout"
     xmlns:android="http://schemas.android.com/apk/res/android"
@@ -197,4 +197,4 @@
 
     </LinearLayout>
 
-</FrameLayout>
\ No newline at end of file
+</net.osmand.plus.widgets.FrameLayoutEx>
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java b/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
index 5f1b16d6c84..ee86f66c817 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/SideWidgetsPanel.java
@@ -14,7 +14,6 @@
 import android.util.AttributeSet;
 import android.view.View;
 import android.view.ViewGroup;
-import android.widget.FrameLayout;
 import android.widget.ImageView;
 import android.widget.LinearLayout;
 
@@ -38,14 +37,12 @@
 import net.osmand.plus.views.layers.MapInfoLayer.TextState;
 import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
 import net.osmand.plus.views.mapwidgets.WidgetsPanel;
+import net.osmand.plus.widgets.FrameLayoutEx;
 import net.osmand.util.Algorithms;
 
-import java.util.Collection;
-import java.util.HashSet;
 import java.util.List;
-import java.util.Set;
 
-public class SideWidgetsPanel extends FrameLayout implements WidgetsContainer, ViewChangeProvider {
+public class SideWidgetsPanel extends FrameLayoutEx implements WidgetsContainer {
 
 	private static final int BORDER_WIDTH_DP = 2;
 	private static final int BORDER_RADIUS_DP = 5;
@@ -62,7 +59,6 @@ public class SideWidgetsPanel extends FrameLayout implements WidgetsContainer, V
 	protected WidgetsPagerAdapter adapter;
 	protected LinearLayout dots;
 
-	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
 	private int screenWidth = -1;
 
 	public SideWidgetsPanel(@NonNull Context context) {
@@ -321,24 +317,6 @@ protected OsmandApplication getMyApplication() {
 		return ((OsmandApplication) getContext().getApplicationContext());
 	}
 
-	@NonNull
-	@Override
-	public Collection<ViewChangeListener> getViewChangeListeners() {
-		return viewChangeListeners;
-	}
-
-	@Override
-	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
-		super.onSizeChanged(w, h, oldw, oldh);
-		notifySizeChanged(this, w, h, oldw, oldh);
-	}
-
-	@Override
-	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
-		super.onVisibilityChanged(changedView, visibility);
-		notifyVisibilityChanged(changedView, visibility);
-	}
-
 	public void setScreenWidth(@NonNull Activity activity) {
 		screenWidth = AndroidUtils.getScreenWidth(activity);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java b/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
index 69f094219a4..d573a5825e0 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/VerticalWidgetPanel.java
@@ -34,18 +34,18 @@
 import net.osmand.plus.views.mapwidgets.widgets.LanesWidget;
 import net.osmand.plus.views.mapwidgets.widgets.MapMarkersBarWidget;
 import net.osmand.plus.views.mapwidgets.widgets.MapWidget;
+import net.osmand.plus.widgets.LinearLayoutEx;
 import net.osmand.util.Algorithms;
 
 import java.util.*;
 
-public class VerticalWidgetPanel extends LinearLayout implements WidgetsContainer, ViewChangeProvider {
+public class VerticalWidgetPanel extends LinearLayoutEx implements WidgetsContainer {
 
 	private final OsmandApplication app;
 	private final OsmandSettings settings;
 	private final MapWidgetRegistry widgetRegistry;
 	private final List<Row> visibleRows = new ArrayList<>();
 	private boolean topPanel;
-	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
 	private boolean nightMode;
 
 	public VerticalWidgetPanel(@NonNull Context context) {
@@ -308,24 +308,6 @@ private void addVerticalDivider(@NonNull ViewGroup container) {
 		inflate(UiUtilities.getThemedContext(getContext(), nightMode), R.layout.vertical_divider, container);
 	}
 
-	@Override
-	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
-		super.onSizeChanged(w, h, oldw, oldh);
-		notifySizeChanged(this, w, h, oldw, oldh);
-	}
-
-	@NonNull
-	@Override
-	public Collection<ViewChangeListener> getViewChangeListeners() {
-		return viewChangeListeners;
-	}
-
-	@Override
-	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
-		super.onVisibilityChanged(changedView, visibility);
-		notifyVisibilityChanged(changedView, visibility);
-	}
-
 	private class Row {
 
 		private final View view;
diff --git a/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java b/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
index 1574130be19..dbceafb670e 100644
--- a/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
+++ b/OsmAnd/src/net/osmand/plus/views/controls/maphudbuttons/MapButton.java
@@ -50,15 +50,12 @@
 import net.osmand.plus.views.layers.base.OsmandMapLayer;
 import net.osmand.plus.views.mapwidgets.WidgetsVisibilityHelper;
 import net.osmand.plus.views.mapwidgets.configure.buttons.MapButtonState;
+import net.osmand.plus.widgets.FrameLayoutEx;
 import net.osmand.util.Algorithms;
 
 import org.jetbrains.annotations.NotNull;
 
-import java.util.Collection;
-import java.util.HashSet;
-import java.util.Set;
-
-public abstract class MapButton extends FrameLayout implements OnAttachStateChangeListener, ViewChangeProvider {
+public abstract class MapButton extends FrameLayoutEx implements OnAttachStateChangeListener, ViewChangeProvider {
 
 	protected final OsmandApplication app;
 	protected final OsmandSettings settings;
@@ -94,8 +91,6 @@ public abstract class MapButton extends FrameLayout implements OnAttachStateChan
 	@ColorInt
 	protected int backgroundPressedColor;
 
-	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
-
 	public MapButton(@NonNull Context context) {
 		this(context, null);
 	}
@@ -457,24 +452,6 @@ public ButtonAppearanceParams createDefaultAppearanceParams() {
 		return new ButtonAppearanceParams("ic_quick_action", BIG_SIZE_DP, TRANSPARENT_ALPHA, ROUND_RADIUS_DP);
 	}
 
-	@NonNull
-	@Override
-	public Collection<ViewChangeListener> getViewChangeListeners() {
-		return viewChangeListeners;
-	}
-
-	@Override
-	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
-		super.onSizeChanged(w, h, oldw, oldh);
-		notifySizeChanged(this, w, h, oldw, oldh);
-	}
-
-	@Override
-	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
-		super.onVisibilityChanged(changedView, visibility);
-		notifyVisibilityChanged(changedView, visibility);
-	}
-
 	public int getSize() {
 		if (customAppearanceParams != null) {
 			int size = customAppearanceParams.getSize();
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/TopToolbarView.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/TopToolbarView.java
index 743b4e4bf8c..3b944c8763a 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/TopToolbarView.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/TopToolbarView.java
@@ -10,7 +10,6 @@
 import android.view.ViewGroup;
 import android.view.ViewTreeObserver;
 import android.view.ViewTreeObserver.OnGlobalLayoutListener;
-import android.widget.FrameLayout;
 import android.widget.ImageButton;
 import android.widget.LinearLayout;
 import android.widget.TextView;
@@ -28,14 +27,12 @@
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.controls.ViewChangeProvider;
 import net.osmand.plus.views.mapwidgets.TopToolbarController.TopToolbarControllerType;
+import net.osmand.plus.widgets.FrameLayoutEx;
 
-import java.util.Collection;
-import java.util.HashSet;
 import java.util.Iterator;
 import java.util.LinkedList;
-import java.util.Set;
 
-public class TopToolbarView extends FrameLayout implements ViewChangeProvider {
+public class TopToolbarView extends FrameLayoutEx implements ViewChangeProvider {
 
 	private final OsmandApplication app;
 	private final UiUtilities uiUtilities;
@@ -58,8 +55,6 @@ public class TopToolbarView extends FrameLayout implements ViewChangeProvider {
 	private SwitchCompat topBarSwitch;
 	private View shadowView;
 
-	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
-
 	private boolean nightMode;
 
 	private int savedInitialGravity = 0;
@@ -415,22 +410,4 @@ public void setupAnimationParams() {
 	public boolean isNightMode() {
 		return nightMode;
 	}
-
-	@NonNull
-	@Override
-	public Collection<ViewChangeListener> getViewChangeListeners() {
-		return viewChangeListeners;
-	}
-
-	@Override
-	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
-		super.onSizeChanged(w, h, oldw, oldh);
-		notifySizeChanged(this, w, h, oldw, oldh);
-	}
-
-	@Override
-	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
-		super.onVisibilityChanged(changedView, visibility);
-		notifyVisibilityChanged(changedView, visibility);
-	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/RulerWidget.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/RulerWidget.java
index 357e07963a2..a92712399be 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/RulerWidget.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/widgets/RulerWidget.java
@@ -4,7 +4,6 @@
 import android.util.AttributeSet;
 import android.view.View;
 import android.view.ViewGroup;
-import android.widget.FrameLayout;
 import android.widget.ImageView;
 import android.widget.TextView;
 
@@ -20,12 +19,9 @@
 import net.osmand.plus.views.OsmandMap;
 import net.osmand.plus.views.OsmandMapTileView;
 import net.osmand.plus.views.controls.ViewChangeProvider;
+import net.osmand.plus.widgets.FrameLayoutEx;
 
-import java.util.Collection;
-import java.util.HashSet;
-import java.util.Set;
-
-public class RulerWidget extends FrameLayout implements ViewChangeProvider {
+public class RulerWidget extends FrameLayoutEx implements ViewChangeProvider {
 
 	private final OsmandApplication app;
 	private final OsmandMap osmandMap;
@@ -41,8 +37,6 @@ public class RulerWidget extends FrameLayout implements ViewChangeProvider {
 	private double cacheRulerTileX;
 	private double cacheRulerTileY;
 
-	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
-
 	public RulerWidget(@NonNull Context context) {
 		this(context, null);
 	}
@@ -124,22 +118,4 @@ public static double getRulerDistance(@NonNull OsmandApplication app,
 		int maxWidth = app.getResources().getDimensionPixelSize(R.dimen.map_ruler_width);
 		return OsmAndFormatter.calculateRoundedDist(maxWidth / pixDensity, app);
 	}
-
-	@NonNull
-	@Override
-	public Collection<ViewChangeListener> getViewChangeListeners() {
-		return viewChangeListeners;
-	}
-
-	@Override
-	protected void onSizeChanged(int w, int h, int oldWidth, int oldHeight) {
-		super.onSizeChanged(w, h, oldWidth, oldHeight);
-		notifySizeChanged(this, w, h, oldWidth, oldHeight);
-	}
-
-	@Override
-	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
-		super.onVisibilityChanged(changedView, visibility);
-		notifyVisibilityChanged(changedView, visibility);
-	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/widgets/FrameLayoutEx.java b/OsmAnd/src/net/osmand/plus/widgets/FrameLayoutEx.java
new file mode 100644
index 00000000000..1e70c2b1815
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/widgets/FrameLayoutEx.java
@@ -0,0 +1,54 @@
+package net.osmand.plus.widgets;
+
+import android.content.Context;
+import android.util.AttributeSet;
+import android.view.View;
+import android.widget.FrameLayout;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import net.osmand.plus.views.controls.ViewChangeProvider;
+
+import java.util.Collection;
+import java.util.HashSet;
+import java.util.Set;
+
+public class FrameLayoutEx extends FrameLayout implements ViewChangeProvider {
+
+	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
+
+	public FrameLayoutEx(@NonNull Context context) {
+		super(context);
+	}
+
+	public FrameLayoutEx(@NonNull Context context, @Nullable AttributeSet attrs) {
+		super(context, attrs);
+	}
+
+	public FrameLayoutEx(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
+		super(context, attrs, defStyleAttr);
+	}
+
+	public FrameLayoutEx(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
+		super(context, attrs, defStyleAttr, defStyleRes);
+	}
+
+	@NonNull
+	@Override
+	public Collection<ViewChangeListener> getViewChangeListeners() {
+		return viewChangeListeners;
+	}
+
+	@Override
+	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
+		super.onSizeChanged(w, h, oldw, oldh);
+		notifySizeChanged(this, w, h, oldw, oldh);
+	}
+
+	@Override
+	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
+		super.onVisibilityChanged(changedView, visibility);
+		notifyVisibilityChanged(changedView, visibility);
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/widgets/LinearLayoutEx.java b/OsmAnd/src/net/osmand/plus/widgets/LinearLayoutEx.java
new file mode 100644
index 00000000000..b5022ac3cdf
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/widgets/LinearLayoutEx.java
@@ -0,0 +1,54 @@
+package net.osmand.plus.widgets;
+
+import android.content.Context;
+import android.util.AttributeSet;
+import android.view.View;
+import android.widget.LinearLayout;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import net.osmand.plus.views.controls.ViewChangeProvider;
+
+import java.util.Collection;
+import java.util.HashSet;
+import java.util.Set;
+
+public class LinearLayoutEx extends LinearLayout implements ViewChangeProvider {
+
+	private final Set<ViewChangeListener> viewChangeListeners = new HashSet<>();
+
+	public LinearLayoutEx(Context context) {
+		super(context);
+	}
+
+	public LinearLayoutEx(Context context, @Nullable AttributeSet attrs) {
+		super(context, attrs);
+	}
+
+	public LinearLayoutEx(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
+		super(context, attrs, defStyleAttr);
+	}
+
+	public LinearLayoutEx(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
+		super(context, attrs, defStyleAttr, defStyleRes);
+	}
+
+	@NonNull
+	@Override
+	public Collection<ViewChangeListener> getViewChangeListeners() {
+		return viewChangeListeners;
+	}
+
+	@Override
+	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
+		super.onSizeChanged(w, h, oldw, oldh);
+		notifySizeChanged(this, w, h, oldw, oldh);
+	}
+
+	@Override
+	protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
+		super.onVisibilityChanged(changedView, visibility);
+		notifyVisibilityChanged(changedView, visibility);
+	}
+}
