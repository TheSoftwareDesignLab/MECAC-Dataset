diff --git a/OsmAnd/res/layout/bottom_sheet_item_with_descr_and_radio_btn.xml b/OsmAnd/res/layout/bottom_sheet_item_with_descr_and_radio_btn.xml
index 77f126f4d4e..a6eb4639e0f 100644
--- a/OsmAnd/res/layout/bottom_sheet_item_with_descr_and_radio_btn.xml
+++ b/OsmAnd/res/layout/bottom_sheet_item_with_descr_and_radio_btn.xml
@@ -11,11 +11,11 @@
 
   <LinearLayout
     android:layout_width="match_parent"
-    android:layout_height="match_parent"
-    android:paddingStart="@dimen/content_padding"
-    android:paddingEnd="@dimen/content_padding_small"
-    android:paddingLeft="@dimen/content_padding"
-    android:paddingRight="@dimen/content_padding_small"
+    android:layout_height="63dp"
+    android:paddingStart="@dimen/list_content_padding"
+    android:paddingEnd="@dimen/list_content_padding"
+    android:paddingLeft="@dimen/list_content_padding"
+    android:paddingRight="@dimen/list_content_padding"
     android:gravity="center_vertical"
     android:orientation="horizontal">
 
@@ -50,7 +50,7 @@
         tools:text="Item Title"/>
 
       <TextView
-        android:id="@+id/subtitle"
+        android:id="@+id/description"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:ellipsize="end"
@@ -75,6 +75,6 @@
     android:layout_height="1dp"
     android:layout_marginStart="64dp"
     android:layout_marginLeft="64dp"
-    android:background="?android:attr/listDivider"/>
+    android:background="@color/divider_light"/>
 
 </LinearLayout>
diff --git a/OsmAnd/res/layout/profile_list_item.xml b/OsmAnd/res/layout/profile_list_item.xml
index 39a7a438638..883166c146f 100644
--- a/OsmAnd/res/layout/profile_list_item.xml
+++ b/OsmAnd/res/layout/profile_list_item.xml
@@ -14,7 +14,7 @@
     android:layout_height="@dimen/standard_icon_size"
     android:layout_marginLeft="@dimen/setting_profile_image_margin"
     android:layout_marginRight="@dimen/setting_profile_image_margin"
-    android:src="@drawable/ic_action_bicycle_dark"/>
+    tools:src="@drawable/ic_action_bicycle_dark"/>
 
   <LinearLayout
     android:layout_width="match_parent"
diff --git a/OsmAnd/res/values/strings.xml b/OsmAnd/res/values/strings.xml
index 011d096e277..c012aacfaec 100644
--- a/OsmAnd/res/values/strings.xml
+++ b/OsmAnd/res/values/strings.xml
@@ -13,8 +13,8 @@
 -->
     <string name="profile_type_descr_string">Type: %s</string>
     <string name="profile_type_base_string">Base Profile</string>
-    <string name="profile_alert_need_routing_type_title">Select Routing Type</string>
-    <string name="profile_alert_need_routing_type_msg">You need to select Routing Type to create New Application Profile</string>
+    <string name="profile_alert_need_routing_type_title">Select navigation type</string>
+    <string name="profile_alert_need_routing_type_msg">You need to select Navigation type to create New Application Profile</string>
     <string name="profile_alert_need_profile_name_title">Enter Profile Name</string>
     <string name="profile_alert_need_profile_name_msg">Profile name shouldn\'t be empty!</string>
     <string name="profile_alert_duplicate_name_title">Duplicate Name</string>
@@ -25,7 +25,7 @@
     <string name="profile_alert_delete_title">Delete Profile</string>
     <string name="profile_alert_delete_msg">Are you sure you want to delete %s profile</string>
     <string name="select_base_profile_dialog_title">Select base profile</string>
-    <string name="select_base_profile_dialog_message">The new Application Profile should be based on one of the default App Profiles. Selected Profile defines basic settings: setup of Widgets, units of speed and distance. In string below Profile\'s name, you could learn which Navigation Profiles are suitable for each Application Profile.</string>
+    <string name="select_base_profile_dialog_message">Custom Application Profile should be based on one of the default App Profiles. Selected Profile defines basic settings: setup of Widgets, units of speed and distance. In string below Profile\'s name, you could learn which Navigation Profiles are suitable for each Application Profile.</string>
     <string name="select_nav_profile_dialog_title">Select navigation type</string>
     <string name="base_profile_descr_car">Car, Truck, Motorcycle</string>
     <string name="base_profile_descr_bicycle">MBT, Moped, Skiing, Horse</string>
@@ -3150,5 +3150,6 @@
     <string name="run_full_osmand_header">Launch OsmAnd?</string>
     <string name="routing_attr_avoid_sett_name">Avoid cobblestone and sett</string>
     <string name="routing_attr_avoid_sett_description">Avoid cobblestone and sett</string>
+  <string name="select_icon_profile_dialog_title">Select icon</string>
 
 </resources>
diff --git a/OsmAnd/src/net/osmand/plus/OsmandApplication.java b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
index efe9e43b366..2cb50eca876 100644
--- a/OsmAnd/src/net/osmand/plus/OsmandApplication.java
+++ b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
@@ -135,7 +135,7 @@ public class OsmandApplication extends MultiDexApplication {
 	InAppPurchaseHelper inAppPurchaseHelper;
 	MapViewTrackingUtilities mapViewTrackingUtilities;
 
-	RoutingConfiguration.Builder routingConfig;
+	private RoutingConfiguration.Builder routingConfig;
 	private Locale preferredLocale = null;
 	private Locale defaultLocale;
 	private File externalStorageDirectory;
@@ -808,10 +808,13 @@ public String getLanguage() {
 	}
 	
 	public synchronized RoutingConfiguration.Builder getRoutingConfig() {
+		RoutingConfiguration.Builder rc;
 		if(routingConfig == null) {
-			routingConfig = new RoutingConfiguration.Builder();
+			rc = new RoutingConfiguration.Builder();
+		} else {
+			rc = routingConfig;
 		}
-		return routingConfig;
+		return rc;
 	}
 
 	public void updateRoutingConfig(Builder update) {
diff --git a/OsmAnd/src/net/osmand/plus/profiles/EditProfileActivity.java b/OsmAnd/src/net/osmand/plus/profiles/EditProfileActivity.java
index cef0e061fef..f417a1e4cb8 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/EditProfileActivity.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/EditProfileActivity.java
@@ -54,4 +54,16 @@ public boolean onOptionsItemSelected(MenuItem item) {
 		}
 		return false;
 	}
+
+	@Override
+	public void onBackPressed() {
+		final EditProfileFragment epf = (EditProfileFragment) getSupportFragmentManager()
+			.findFragmentByTag(EDIT_PROFILE_FRAGMENT_TAG);
+		if (epf.onBackPressedAllowed()) {
+			super.onBackPressed();
+		} else {
+			epf.confirmCancelDialog(this);
+		}
+
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/profiles/EditProfileFragment.java b/OsmAnd/src/net/osmand/plus/profiles/EditProfileFragment.java
index 32201360903..5a71f8d8f09 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/EditProfileFragment.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/EditProfileFragment.java
@@ -1,10 +1,11 @@
 package net.osmand.plus.profiles;
 
 import static net.osmand.plus.activities.SettingsNavigationActivity.INTENT_SKIP_DIALOG;
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.DIALOG_TYPE;
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.SELECTED_KEY;
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.TYPE_APP_PROFILE;
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.TYPE_NAV_PROFILE;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.DIALOG_TYPE;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.SELECTED_KEY;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.TYPE_APP_PROFILE;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.TYPE_ICON;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.TYPE_NAV_PROFILE;
 import static net.osmand.plus.profiles.SettingsProfileFragment.IS_NEW_PROFILE;
 import static net.osmand.plus.profiles.SettingsProfileFragment.IS_USER_PROFILE;
 import static net.osmand.plus.profiles.SettingsProfileFragment.PROFILE_STRING_KEY;
@@ -21,6 +22,7 @@
 import android.support.v4.content.ContextCompat;
 import android.support.v7.app.ActionBar;
 import android.support.v7.app.AlertDialog;
+import android.support.v7.app.AlertDialog.Builder;
 import android.text.Editable;
 import android.text.TextWatcher;
 import android.view.LayoutInflater;
@@ -48,8 +50,6 @@
 import net.osmand.plus.activities.OsmandActionBarActivity;
 import net.osmand.plus.activities.SettingsNavigationActivity;
 import net.osmand.plus.base.BaseOsmAndFragment;
-import net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.ProfileTypeDialogListener;
-import net.osmand.plus.profiles.SelectIconBottomSheetDialogFragment.IconIdListener;
 import net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.SelectProfileListener;
 import net.osmand.plus.routing.RouteProvider.RouteService;
 import net.osmand.plus.widgets.OsmandTextFieldBoxes;
@@ -66,7 +66,7 @@ public class EditProfileFragment extends BaseOsmAndFragment {
 	public static final String MAP_CONFIG = "openMapConfigMenu";
 	public static final String NAV_CONFIG = "openNavConfigMenu";
 	public static final String SCREEN_CONFIG = "openScreenConfigMenu";
-	public static final String SELECTED_PROFILE = "editedProfile";
+	public static final String SELECTED_ITEM = "editedProfile";
 	public static final String SELECTED_ICON = "selectedIcon";
 
 	OsmandApplication app;
@@ -81,7 +81,7 @@ public class EditProfileFragment extends BaseOsmAndFragment {
 	private boolean isDataChanged = false;
 
 	private SelectProfileListener navTypeListener = null;
-	private IconIdListener iconIdListener = null;
+	private SelectProfileListener iconIdListener = null;
 	private SelectProfileListener baseTypeListener = null;
 
 	private ImageView profileIcon;
@@ -106,7 +106,8 @@ public class EditProfileFragment extends BaseOsmAndFragment {
 	private Button cancelBtnSV;
 	private Button saveButtonSV;
 
-	boolean isNightMode;
+	private boolean isCancelAllowed = true;
+	private boolean isNightMode;
 
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
@@ -202,7 +203,6 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 			@Override
 			public void onClick(View v) {
 				if (isUserProfile || isNew) {
-					//final ProfileBottomSheetDialogFragment dialog = new ProfileBottomSheetDialogFragment();
 					final SelectProfileBottomSheetDialogFragment dialog = new SelectProfileBottomSheetDialogFragment();
 					Bundle bundle = new Bundle();
 					if (profile.parent != null) {
@@ -273,6 +273,7 @@ public void afterTextChanged(Editable s) {
 					if (actionBar != null) {
 						actionBar.setTitle(s.toString());
 						profile.userProfileTitle = s.toString();
+						isCancelAllowed = false;
 					}
 				}
 			}
@@ -282,7 +283,6 @@ public void afterTextChanged(Editable s) {
 			@Override
 			public void onClick(View v) {
 				if (isNew || isUserProfile) {
-					//ProfileBottomSheetDialogFragment fragment = new ProfileBottomSheetDialogFragment();
 					final SelectProfileBottomSheetDialogFragment fragment = new SelectProfileBottomSheetDialogFragment();
 					Bundle bundle = new Bundle();
 					if (profile.routingProfileDataObject != null) {
@@ -306,9 +306,9 @@ public void onClick(View v) {
 		profileIconBtn.setOnClickListener(new OnClickListener() {
 			@Override
 			public void onClick(View v) {
-				final SelectIconBottomSheetDialogFragment iconSelectDialog = new SelectIconBottomSheetDialogFragment();
-				iconSelectDialog.setIconIdListener(iconIdListener);
+				final SelectProfileBottomSheetDialogFragment iconSelectDialog = new SelectProfileBottomSheetDialogFragment();
 				Bundle bundle = new Bundle();
+				bundle.putString(DIALOG_TYPE, TYPE_ICON);
 				bundle.putInt(SELECTED_ICON, profile.iconId);
 				iconSelectDialog.setArguments(bundle);
 				if (getActivity() != null) {
@@ -329,7 +329,7 @@ public void onClick(View v) {
 					getSettings().APPLICATION_MODE.set(mode);
 					Intent i = new Intent(getActivity(), MapActivity.class);
 					i.putExtra(OPEN_CONFIG_ON_MAP, MAP_CONFIG);
-					i.putExtra(SELECTED_PROFILE, profile.stringKey);
+					i.putExtra(SELECTED_ITEM, profile.stringKey);
 					startActivity(i);
 				}
 			}
@@ -345,7 +345,7 @@ public void onClick(View v) {
 					getSettings().APPLICATION_MODE.set(mode);
 					Intent i = new Intent(getActivity(), MapActivity.class);
 					i.putExtra(OPEN_CONFIG_ON_MAP, SCREEN_CONFIG);
-					i.putExtra(SELECTED_PROFILE, profile.stringKey);
+					i.putExtra(SELECTED_ITEM, profile.stringKey);
 					startActivity(i);
 				}
 			}
@@ -362,7 +362,7 @@ public void onClick(View v) {
 					Intent i = new Intent(getActivity(), SettingsNavigationActivity.class);
 					i.putExtra(INTENT_SKIP_DIALOG, true);
 					i.putExtra(OPEN_CONFIG_ON_MAP, NAV_CONFIG);
-					i.putExtra(SELECTED_PROFILE, profile.stringKey);
+					i.putExtra(SELECTED_ITEM, profile.stringKey);
 					startActivity(i);
 				}
 			}
@@ -433,47 +433,26 @@ public void onGlobalLayout() {
 
 	@Override
 	public void onResume() {
-		baseTypeListener = new SelectProfileListener() {
-			@Override
-			public void onSelectedType(int pos) {
-				String key = SettingsProfileFragment.getBaseProfiles(getMyApplication()).get(pos)
-					.getStringKey();
-				setupBaseProfileView(key);
-				profile.parent = ApplicationMode.valueOfStringKey(key, ApplicationMode.DEFAULT);
-			}
-		};
-
-		navTypeListener = new SelectProfileListener() {
-			@Override
-			public void onSelectedType(int pos) {
-				updateRoutingProfile(pos);
-			}
-		};
-
-		iconIdListener = new IconIdListener() {
-			@Override
-			public void selectedIconId(int iconRes) {
-				isDataChanged = true;
-				profile.iconId = iconRes;
-				profileIcon.setImageDrawable(app.getUIUtilities().getIcon(iconRes,
-					isNightMode ? R.color.active_buttons_and_links_dark
-						: R.color.active_buttons_and_links_light));
-			}
-		};
+		getBaseProfileListener();
+		getNavProfileListener();
+		getIconListener();
 		super.onResume();
 	}
 
-	IconIdListener getIconListener() {
+	boolean onBackPressedAllowed() {
+		return isCancelAllowed;
+	}
+
+	SelectProfileListener getIconListener() {
 		if (iconIdListener == null) {
-			iconIdListener = new IconIdListener() {
+			iconIdListener = new SelectProfileListener() {
 				@Override
-				public void selectedIconId(int iconRes) {
+				public void onSelectedType(int pos) {
 					isDataChanged = true;
-					profile.iconId = iconRes;
-					profileIcon.setImageDrawable(app.getUIUtilities().getIcon(iconRes,
+					profile.iconId = pos;
+					profileIcon.setImageDrawable(app.getUIUtilities().getIcon(pos,
 						isNightMode ? R.color.active_buttons_and_links_dark
 							: R.color.active_buttons_and_links_light));
-					profile.iconId = iconRes;
 				}
 			};
 		}
@@ -663,6 +642,22 @@ private void showSaveWarningDialog(String title, String message, Activity activi
 		bld.show();
 	}
 
+	void confirmCancelDialog(final Activity activity) {
+		AlertDialog.Builder bld = new Builder(activity);
+		bld.setTitle(R.string.shared_string_dismiss);
+		bld.setMessage(R.string.exit_without_saving);
+		bld.setPositiveButton(R.string.shared_string_ok, new DialogInterface.OnClickListener() {
+			@Override
+			public void onClick(DialogInterface dialog, int which) {
+				isCancelAllowed = true;
+				activity.onBackPressed();
+			}
+		});
+		bld.setNegativeButton(R.string.shared_string_cancel, null);
+		bld.show();
+
+	}
+
 	void onDeleteProfileClick() {
 		if (getActivity() != null) {
 			if (isUserProfile) {
@@ -680,6 +675,7 @@ public void onClick(DialogInterface dialog, int which) {
 							if (getActivity() != null) {
 								getActivity().onBackPressed();
 							}
+							getSettings().APPLICATION_MODE.set(ApplicationMode.DEFAULT);
 						}
 					});
 				bld.setNegativeButton(R.string.shared_string_dismiss, null);
@@ -710,7 +706,7 @@ static List<RoutingProfileDataObject> getRoutingProfiles(OsmandApplication conte
 
 		Map<String, GeneralRouter> inputProfiles = context.getRoutingConfig().getAllRoutes();
 		for (Entry<String, GeneralRouter> e : inputProfiles.entrySet()) {
-			int iconRes = R.drawable.ic_action_world_globe;
+			int iconRes = R.drawable.ic_action_gdirections_dark;
 			String name = e.getValue().getProfileName();
 			String description;
 			if (e.getValue().getFilename() == null) {
@@ -719,7 +715,7 @@ static List<RoutingProfileDataObject> getRoutingProfiles(OsmandApplication conte
 					.getString(RoutingProfilesResources.valueOf(name.toUpperCase()).getStringRes());
 				description = context.getString(R.string.osmand_default_routing);
 			} else {
-				description = context.getString(R.string.custom_routing);
+				description = e.getValue().getFilename();
 			}
 			profilesObjects
 				.add(new RoutingProfileDataObject(e.getKey(), name, description, iconRes, false,
diff --git a/OsmAnd/src/net/osmand/plus/profiles/ProfileBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/profiles/ProfileBottomSheetDialogFragment.java
deleted file mode 100644
index 11f9a6f09b3..00000000000
--- a/OsmAnd/src/net/osmand/plus/profiles/ProfileBottomSheetDialogFragment.java
+++ /dev/null
@@ -1,231 +0,0 @@
-package net.osmand.plus.profiles;
-
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.v7.widget.LinearLayoutManager;
-import android.support.v7.widget.RecyclerView;
-import android.view.ContextThemeWrapper;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
-import android.widget.Button;
-import android.widget.ImageView;
-import android.widget.RadioButton;
-import android.widget.TextView;
-import java.util.ArrayList;
-import java.util.List;
-import net.osmand.PlatformUtil;
-import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.R;
-import net.osmand.plus.base.BottomSheetDialogFragment;
-import org.apache.commons.logging.Log;
-
-public class ProfileBottomSheetDialogFragment extends BottomSheetDialogFragment {
-
-	private static final Log LOG = PlatformUtil.getLog(ProfileBottomSheetDialogFragment.class);
-
-	private List<ProfileDataObject> profiles;
-	private ProfileTypeDialogListener listener;
-	private ProfileTypeDialogListener listListener;
-	private RecyclerView recyclerView;
-	private ProfileTypeAdapter adapter;
-	private TextView titleTV;
-	private TextView fragmentDescriptionTV;
-
-	private String selectedKey = null;
-
-	public final static String DIALOG_TYPE = "dialog_type";
-	public final static String TYPE_APP_PROFILE = "base_profiles";
-	public final static String TYPE_NAV_PROFILE = "routing_profiles";
-	public final static String SELECTED_KEY = "selected_base";
-	private String type;
-
-	@Override
-	public void onCreate(@Nullable Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		profiles = new ArrayList<>();
-	}
-
-	@Nullable
-	@Override
-	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
-		Bundle savedInstanceState) {
-
-		Bundle args = getArguments();
-		if (args != null) {
-			if (args.get(DIALOG_TYPE) != null) {
-				type = args.getString(DIALOG_TYPE);
-			} else {
-				dismiss();
-			}
-
-			selectedKey = args.getString(SELECTED_KEY, "");
-
-			if (type.equals(TYPE_NAV_PROFILE) && getMyApplication() != null) {
-				profiles.addAll(EditProfileFragment.getRoutingProfiles(getMyApplication()));
-			} else if (type.equals(TYPE_APP_PROFILE)) {
-				profiles.addAll(SettingsProfileFragment.getBaseProfiles(getActivity()));
-			}
-		}
-
-		final int themeRes = getMyApplication().getSettings().isLightContent()
-			? R.style.OsmandLightTheme
-			: R.style.OsmandDarkTheme;
-		View view = View.inflate(new ContextThemeWrapper(getContext(), themeRes),
-			R.layout.bottom_sheet_select_type_fragment, null);
-
-		titleTV = view.findViewById(R.id.dialog_title);
-		fragmentDescriptionTV = view.findViewById(R.id.dialog_description_text);
-
-		if (type.equals(TYPE_APP_PROFILE)) {
-			titleTV.setText(R.string.select_base_profile_dialog_title);
-			fragmentDescriptionTV.setVisibility(View.VISIBLE);
-			fragmentDescriptionTV.setText(R.string.select_base_profile_dialog_message);
-		} else if (type.equals(TYPE_NAV_PROFILE)) {
-			titleTV.setText(R.string.select_nav_profile_dialog_title);
-		}
-		view.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				dismiss();
-			}
-		});
-		listListener = new ProfileTypeDialogListener() {
-			@Override
-			public void onSelectedType(int pos) {
-				if (listener == null) {
-					getListener();
-				}
-				listener.onSelectedType(pos);
-				dismiss();
-			}
-		};
-		recyclerView = view.findViewById(R.id.menu_list_view);
-		adapter = new ProfileTypeAdapter(profiles, isNightMode(getMyApplication()),
-			listListener);
-		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
-		recyclerView.setAdapter(adapter);
-		Button cancelBtn = view.findViewById(R.id.cancel_selection);
-		cancelBtn.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				dismiss();
-			}
-		});
-
-		return view;
-	}
-
-	private static boolean isNightMode(OsmandApplication ctx) {
-		return !ctx.getSettings().isLightContent();
-	}
-
-	class ProfileTypeAdapter extends RecyclerView.Adapter<ItemViewHolder> {
-
-		private final List<ProfileDataObject> items;
-		private final boolean isNightMode;
-		private ProfileTypeDialogListener listener;
-		private int previousSelection;
-
-
-		ProfileTypeAdapter(List<ProfileDataObject> items, boolean isNightMode,
-			ProfileTypeDialogListener listener) {
-			this.items = items;
-			this.isNightMode = isNightMode;
-			this.listener = listener;
-		}
-
-		@NonNull
-		@Override
-		public ItemViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
-			return new ItemViewHolder(LayoutInflater.from(parent.getContext())
-				.inflate(R.layout.bottom_sheet_item_with_descr_and_radio_btn, parent, false));
-		}
-
-		@Override
-		public void onBindViewHolder(@NonNull final ItemViewHolder holder, final int position) {
-			final ProfileDataObject item = items.get(position);
-			holder.title.setText(item.getName());
-
-
-			holder.itemView.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-						listener.onSelectedType(position);
-
-					holder.radioButton.setChecked(true);
-
-					if (item instanceof RoutingProfileDataObject) {
-						items.get(position).setSelected(true);
-						items.get(previousSelection).setSelected(false);
-					}
-					notifyItemChanged(previousSelection);
-					previousSelection = position;
-				}
-			});
-
-			if(item instanceof RoutingProfileDataObject) {
-				if (((RoutingProfileDataObject) item).getFileName() != null) {
-					holder.descr
-						.setText(String.format("From %s", ((RoutingProfileDataObject) item).getFileName()));
-				} else {
-					holder.descr
-						.setText(item.getDescription());
-				}
-			} else {
-				holder.descr.setText(item.getDescription());
-			}
-
-			if (selectedKey != null && selectedKey.equals(item.getStringKey())) {
-				holder.radioButton.setChecked(true);
-				previousSelection = position;
-				holder.icon.setImageDrawable(getIcon(item.getIconRes(), isNightMode
-					? R.color.active_buttons_and_links_dark
-					: R.color.active_buttons_and_links_light));
-			} else {
-				holder.radioButton.setChecked(false);
-				holder.icon.setImageDrawable(getIcon(item.getIconRes(), R.color.icon_color));
-			}
-		}
-
-		@Override
-		public int getItemCount() {
-			return items.size();
-		}
-	}
-
-	void getListener() {
-		if (getActivity() != null && getActivity() instanceof EditProfileActivity) {
-			EditProfileFragment f = (EditProfileFragment) getActivity().getSupportFragmentManager()
-				.findFragmentByTag(EditProfileActivity.EDIT_PROFILE_FRAGMENT_TAG);
-//			if (type.equals(TYPE_APP_PROFILE)) {
-//				listener = f.getBaseProfileListener();
-//			} else if (type.equals(TYPE_NAV_PROFILE)) {
-//				listener = f.getNavProfileListener();
-//			}
-		} else if (getActivity() != null && getActivity() instanceof SettingsProfileActivity) {
-			SettingsProfileFragment f = (SettingsProfileFragment) getActivity().getSupportFragmentManager()
-				.findFragmentByTag(SettingsProfileActivity.SETTINGS_PROFILE_FRAGMENT_TAG);
-//			listener = f.getBaseProfileListener();
-		}
-	}
-
-	class ItemViewHolder extends RecyclerView.ViewHolder {
-		TextView title, descr;
-		RadioButton radioButton;
-		ImageView icon;
-
-		public ItemViewHolder(View itemView) {
-			super(itemView);
-			title = itemView.findViewById(R.id.title);
-			descr = itemView.findViewById(R.id.subtitle);
-			radioButton = itemView.findViewById(R.id.compound_button);
-			icon = itemView.findViewById(R.id.icon);
-		}
-	}
-
-	interface ProfileTypeDialogListener {
-		void onSelectedType(int pos);
-	}
-}
diff --git a/OsmAnd/src/net/osmand/plus/profiles/ProfileMenuAdapter.java b/OsmAnd/src/net/osmand/plus/profiles/ProfileMenuAdapter.java
index 0b3b8a2063c..ee90020d861 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/ProfileMenuAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/ProfileMenuAdapter.java
@@ -1,5 +1,6 @@
 package net.osmand.plus.profiles;
 
+import android.support.annotation.ColorRes;
 import android.support.annotation.NonNull;
 import android.support.v7.widget.RecyclerView;
 import android.support.v7.widget.SwitchCompat;
@@ -25,12 +26,16 @@ public class ProfileMenuAdapter extends RecyclerView.Adapter<ProfileViewHolder>
 	private Set<ApplicationMode> selectedItems;
 	private ProfileListener listener;
 	private final OsmandApplication app;
+	@ColorRes private int selectedIconColorRes;
 
 	public ProfileMenuAdapter(List<ApplicationMode> items, Set<ApplicationMode> selectedItems, OsmandApplication app, ProfileListener listener) {
 		this.items = items;
 		this.listener = listener;
 		this.app = app;
 		this.selectedItems = selectedItems;
+		selectedIconColorRes = isNightMode(app)
+			? R.color.active_buttons_and_links_dark
+			: R.color.active_buttons_and_links_light;
 	}
 
 	public List<ApplicationMode> getItems() {
@@ -75,9 +80,7 @@ public void onBindViewHolder(@NonNull final ProfileViewHolder holder, int positi
 			: R.color.main_font_light));
 		if (selectedItems.contains(item)) {
 			holder.aSwitch.setChecked(true);
-			holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), isNightMode(app)
-				? R.color.active_buttons_and_links_dark
-				: R.color.active_buttons_and_links_light));
+			holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), selectedIconColorRes));
 		} else {
 			holder.aSwitch.setChecked(false);
 			holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), R.color.icon_color));
@@ -88,9 +91,7 @@ public void onBindViewHolder(@NonNull final ProfileViewHolder holder, int positi
 			public void onClick(View v) {
 				listener.changeProfileStatus(item, holder.aSwitch.isChecked());
 				if (selectedItems.contains(item)) {
-					holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), isNightMode(app)
-						? R.color.active_buttons_and_links_dark
-						: R.color.active_buttons_and_links_light));
+					holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), selectedIconColorRes));
 				} else {
 					holder.icon.setImageDrawable(app.getUIUtilities().getIcon(item.getSmallIconDark(), R.color.icon_color));
 				}
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SelectIconBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/profiles/SelectIconBottomSheetDialogFragment.java
deleted file mode 100644
index 52b4c95ed90..00000000000
--- a/OsmAnd/src/net/osmand/plus/profiles/SelectIconBottomSheetDialogFragment.java
+++ /dev/null
@@ -1,224 +0,0 @@
-package net.osmand.plus.profiles;
-
-import android.os.Bundle;
-import android.support.annotation.NonNull;
-import android.support.annotation.Nullable;
-import android.support.v7.widget.LinearLayoutManager;
-import android.support.v7.widget.RecyclerView;
-import android.view.ContextThemeWrapper;
-import android.view.LayoutInflater;
-import android.view.View;
-import android.view.ViewGroup;
-import android.widget.Button;
-import android.widget.ImageView;
-import android.widget.RadioButton;
-import android.widget.TextView;
-import java.util.ArrayList;
-import java.util.List;
-import net.osmand.PlatformUtil;
-import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.R;
-import net.osmand.plus.base.BottomSheetDialogFragment;
-import org.apache.commons.logging.Log;
-
-public class SelectIconBottomSheetDialogFragment extends BottomSheetDialogFragment {
-
-	private static final Log LOG = PlatformUtil.getLog(SelectIconBottomSheetDialogFragment.class);
-
-	private List<IconResWithDescr> icons;
-	private IconIdListener listener;
-	private IconIdListener listListener;
-	private RecyclerView recyclerView;
-	private IconIdAdapter adapter;
-	private TextView title;
-
-
-	public void setIconIdListener(IconIdListener listener) {
-		this.listener = listener;
-	}
-
-	@Nullable
-	@Override
-	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-
-		icons = getProfileIcons();
-
-		Bundle args = getArguments();
-		if (args != null) {
-			int selectedIcon = args.getInt(EditProfileFragment.SELECTED_ICON, -1);
-			if(selectedIcon != -1) {
-				for (IconResWithDescr icon : icons) {
-					if (icon.resId == selectedIcon) {
-						icon.setSelected(true);
-					}
-				}
-			}
-		}
-
-		final int themeRes = getMyApplication().getSettings().isLightContent()
-			? R.style.OsmandLightTheme
-			: R.style.OsmandDarkTheme;
-
-		View view = View.inflate(new ContextThemeWrapper(getContext(), themeRes),
-			R.layout.bottom_sheet_select_type_fragment, null);
-
-		view.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				dismiss();
-			}
-		});
-
-		listListener = new IconIdListener() {
-			@Override
-			public void selectedIconId(int iconRes) {
-				if (listener == null) {
-					if (getActivity() != null && getActivity() instanceof EditProfileActivity) {
-						EditProfileFragment f = (EditProfileFragment) getActivity().getSupportFragmentManager()
-							.findFragmentByTag(EditProfileActivity.EDIT_PROFILE_FRAGMENT_TAG);
-						listener = f.getIconListener();
-					}
-				}
-				listener.selectedIconId(iconRes);
-				dismiss();
-			}
-		};
-		recyclerView = view.findViewById(R.id.menu_list_view);
-		title = view.findViewById(R.id.dialog_title);
-		title.setText("Select icon");
-		adapter = new IconIdAdapter(icons, isNightMode(getMyApplication()), listListener);
-		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
-		recyclerView.setAdapter(adapter);
-
-
-		Button cancelBtn = view.findViewById(R.id.cancel_selection);
-		cancelBtn.setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				dismiss();
-			}
-		});
-
-		return view;
-	}
-
-	private static boolean isNightMode(OsmandApplication ctx) {
-		return !ctx.getSettings().isLightContent();
-	}
-
-	class IconIdAdapter extends RecyclerView.Adapter<SelectIconBottomSheetDialogFragment.ItemViewHolder> {
-		private final List<IconResWithDescr> items;
-		private final boolean isNightMode;
-		private IconIdListener listener;
-		private int previousSelection;
-
-		private IconIdAdapter(@NonNull List<IconResWithDescr> objects,
-			@NonNull boolean isNightMode, IconIdListener listener) {
-			this.items = objects;
-			this.isNightMode = isNightMode;
-			this.listener = listener;
-		}
-
-		@NonNull
-		@Override
-		public ItemViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
-			return new ItemViewHolder(LayoutInflater.from(parent.getContext()).inflate(
-				R.layout.bottom_sheet_item_with_radio_btn, parent, false));
-		}
-
-		@Override
-		public void onBindViewHolder(@NonNull final ItemViewHolder holder, int position) {
-			final int pos = position;
-			final IconResWithDescr item = items.get(position);
-			holder.title.setText(item.getTitleId());
-			if (item.isSelected) {
-				holder.icon.setImageDrawable(getIcon(item.getResId(), isNightMode
-					? R.color.active_buttons_and_links_dark
-					: R.color.active_buttons_and_links_light));
-				holder.radioButton.setChecked(true);
-				previousSelection = position;
-			} else {
-				holder.radioButton.setChecked(false);
-				holder.icon.setImageDrawable(getIcon(item.getResId(), R.color.icon_color));
-			}
-
-
-			holder.itemView.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					listener.selectedIconId(item.resId);
-					holder.radioButton.setChecked(true);
-					items.get(pos).setSelected(true);
-					items.get(previousSelection).setSelected(false);
-					notifyItemChanged(previousSelection);
-					previousSelection = pos;
-				}
-			});
-		}
-
-		@Override
-		public int getItemCount() {
-			return items.size();
-		}
-	}
-
-	class ItemViewHolder extends RecyclerView.ViewHolder {
-		TextView title;
-		RadioButton radioButton;
-		ImageView icon;
-
-		public ItemViewHolder(View itemView) {
-			super(itemView);
-			title = itemView.findViewById(R.id.title);
-			radioButton = itemView.findViewById(R.id.compound_button);
-			icon = itemView.findViewById(R.id.icon);
-		}
-	}
-
-	interface IconIdListener {
-		void selectedIconId(int iconRes);
-	}
-
-	public class IconResWithDescr {
-		private int resId;
-		private int titleId;
-		private boolean isSelected;
-
-		public IconResWithDescr(int resId, int titleId, boolean isSelected) {
-			this.resId = resId;
-			this.titleId = titleId;
-			this.isSelected = isSelected;
-		}
-
-		public int getResId() {
-			return resId;
-		}
-
-		public int getTitleId() {
-			return titleId;
-		}
-
-		public boolean isSelected() {
-			return isSelected;
-		}
-
-		public void setSelected(boolean selected) {
-			isSelected = selected;
-		}
-	}
-
-	private List<IconResWithDescr> getProfileIcons() {
-		List<IconResWithDescr> icons = new ArrayList<>();
-		icons.add(new IconResWithDescr(R.drawable.ic_action_car_dark, R.string.rendering_value_car_name,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_bicycle_dark, R.string.rendering_value_bicycle_name,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_pedestrian_dark, R.string.rendering_value_pedestrian_name,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_bus_dark, R.string.app_mode_bus,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_sail_boat_dark, R.string.app_mode_boat,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_aircraft, R.string.app_mode_aircraft,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_truck_dark, R.string.app_mode_truck,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_motorcycle_dark, R.string.app_mode_motorcycle,false));
-		icons.add(new IconResWithDescr(R.drawable.ic_action_trekking_dark, R.string.app_mode_hiking,false));
-		return icons;
-	}
-
-}
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SelectProfileBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/profiles/SelectProfileBottomSheetDialogFragment.java
index 5c85143172d..7964c7f6d1b 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/SelectProfileBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/SelectProfileBottomSheetDialogFragment.java
@@ -1,5 +1,8 @@
 package net.osmand.plus.profiles;
 
+import static net.osmand.plus.profiles.EditProfileFragment.SELECTED_ICON;
+
+import android.content.res.ColorStateList;
 import android.graphics.drawable.Drawable;
 import android.os.Bundle;
 import android.view.View;
@@ -24,6 +27,7 @@ public class SelectProfileBottomSheetDialogFragment extends MenuBottomSheetDialo
 	public final static String DIALOG_TYPE = "dialog_type";
 	public final static String TYPE_APP_PROFILE = "base_profiles";
 	public final static String TYPE_NAV_PROFILE = "routing_profiles";
+	public final static String TYPE_ICON = "icon_type";
 	public final static String SELECTED_KEY = "selected_base";
 
 	String type;
@@ -31,7 +35,9 @@ public class SelectProfileBottomSheetDialogFragment extends MenuBottomSheetDialo
 	private SelectProfileListener listener;
 
 	private List<ProfileDataObject> profiles = new ArrayList<>();
+	private List<IconResWithDescr> icons;
 	private String selectedItemKey;
+	private int selectedIconRes;
 
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
@@ -46,8 +52,10 @@ public void onCreate(Bundle savedInstanceState) {
 				profiles.addAll(EditProfileFragment.getRoutingProfiles(app));
 			} else if (type.equals(TYPE_APP_PROFILE)) {
 				profiles.addAll(SettingsProfileFragment.getBaseProfiles(app));
+			} else if (type.equals(TYPE_ICON)) {
+				selectedIconRes = args.getInt(SELECTED_ICON, -1);
+				icons = getProfileIcons();
 			} else {
-
 				LOG.error("Check intent data!");
 				dismiss();
 			}
@@ -56,6 +64,7 @@ public void onCreate(Bundle savedInstanceState) {
 
 	@Override
 	public void createMenuItems(Bundle savedInstanceState) {
+
 		if (type.equals(TYPE_APP_PROFILE)) {
 			items.add(new TitleItem(getString(R.string.select_base_profile_dialog_title)));
 			items.add(new LongDescriptionItem(getString(R.string.select_base_profile_dialog_message)));
@@ -76,15 +85,18 @@ public void createMenuItems(Bundle savedInstanceState) {
 
 				items.add(new BottomSheetItemWithCompoundButton.Builder()
 					.setChecked(isSelected)
+					.setButtonTintList(isSelected
+						? ColorStateList.valueOf(getResolvedColor(getActiveColorId()))
+						: null)
 					.setDescription(profile.getDescription())
 					.setTitle(profile.getName())
 					.setIcon(drawableIcon)
-					.setLayoutId(R.layout.bottom_sheet_item_with_descr_and_checkbox_56dp)
+					.setLayoutId(R.layout.bottom_sheet_item_with_descr_and_radio_btn)
 					.setOnClickListener(new OnClickListener() {
 						@Override
 						public void onClick(View v) {
 							if (listener == null) {
-								getProfileListener();
+								getListener();
 							}
 							if (listener != null) {
 								listener.onSelectedType(pos);
@@ -114,29 +126,69 @@ public void onClick(View v) {
 
 				items.add(new BottomSheetItemWithCompoundButton.Builder()
 					.setChecked(isSelected)
+					.setButtonTintList(isSelected
+						? ColorStateList.valueOf(getResolvedColor(getActiveColorId()))
+						: null)
 					.setDescription(profile.getDescription())
 					.setTitle(profile.getName())
 					.setIcon(drawableIcon)
-					.setLayoutId(R.layout.bottom_sheet_item_with_descr_and_checkbox_56dp)
+					.setLayoutId(R.layout.bottom_sheet_item_with_descr_and_radio_btn)
 					.setOnClickListener(new OnClickListener() {
 						@Override
 						public void onClick(View v) {
 							if (listener == null) {
-								getProfileListener();
+								getListener();
 							}
 							if (listener != null) {
 								listener.onSelectedType(pos);
 							}
-
 							dismiss();
 						}
 					})
 					.create());
 			}
+		} else if (type.equals(TYPE_ICON)) {
+			items.add(new TitleItem(getString(R.string.select_icon_profile_dialog_title)));
+			for (final IconResWithDescr icon : icons) {
+				Drawable drawableIcon;
+				boolean isSelected = icon.resId == selectedIconRes;
+				if (isSelected) {
+					drawableIcon = getMyApplication().getUIUtilities()
+						.getIcon(icon.resId, nightMode
+							? R.color.active_buttons_and_links_dark
+							: R.color.active_buttons_and_links_light);
+				} else {
+					drawableIcon = getMyApplication().getUIUtilities()
+						.getIcon(icon.resId, R.color.icon_color);
+				}
+
+				items.add(new BottomSheetItemWithCompoundButton.Builder()
+					.setChecked(icon.resId == selectedIconRes)
+					.setButtonTintList(isSelected
+						? ColorStateList.valueOf(getResolvedColor(getActiveColorId()))
+						: null)
+					.setTitle(getMyApplication().getString(icon.titleId))
+					.setIcon(drawableIcon)
+					.setLayoutId(R.layout.bottom_sheet_item_with_radio_btn)
+					.setOnClickListener(new OnClickListener() {
+						@Override
+						public void onClick(View v) {
+							if(listener == null) {
+								getListener();
+							}
+							if (listener != null) {
+								listener.onSelectedType(icon.resId);
+							}
+							dismiss();
+						}
+					})
+					.create()
+				);
+			}
 		}
 	}
 
-	private void getProfileListener() {
+	private void getListener() {
 		if (getActivity() != null && getActivity() instanceof  EditProfileActivity) {
 			EditProfileFragment f = (EditProfileFragment) getActivity().getSupportFragmentManager()
 				.findFragmentByTag(EditProfileActivity.EDIT_PROFILE_FRAGMENT_TAG);
@@ -144,16 +196,44 @@ private void getProfileListener() {
 				listener = f.getBaseProfileListener();
 			} else if (type.equals(TYPE_NAV_PROFILE)) {
 				listener = f.getNavProfileListener();
+			} else if (type.equals(TYPE_ICON)) {
+				listener = f.getIconListener();
 			}
 		} else if (getActivity() != null && getActivity() instanceof SettingsProfileActivity) {
 			SettingsProfileFragment f = (SettingsProfileFragment) getActivity().getSupportFragmentManager()
 				.findFragmentByTag(SettingsProfileActivity.SETTINGS_PROFILE_FRAGMENT_TAG);
 			listener = f.getBaseProfileListener();
-
 		}
 	}
 
+	private List<IconResWithDescr> getProfileIcons() {
+		List<IconResWithDescr> icons = new ArrayList<>();
+		icons.add(new IconResWithDescr(R.drawable.ic_action_car_dark, R.string.rendering_value_car_name,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_bicycle_dark, R.string.rendering_value_bicycle_name,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_pedestrian_dark, R.string.rendering_value_pedestrian_name,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_bus_dark, R.string.app_mode_bus,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_sail_boat_dark, R.string.app_mode_boat,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_aircraft, R.string.app_mode_aircraft,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_truck_dark, R.string.app_mode_truck,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_motorcycle_dark, R.string.app_mode_motorcycle,false));
+		icons.add(new IconResWithDescr(R.drawable.ic_action_trekking_dark, R.string.app_mode_hiking,false));
+		return icons;
+	}
+
 	interface SelectProfileListener {
 		void onSelectedType(int pos);
 	}
+
+	private class IconResWithDescr {
+		private int resId;
+		private int titleId;
+		private boolean isSelected;
+
+		public IconResWithDescr(int resId, int titleId, boolean isSelected) {
+			this.resId = resId;
+			this.titleId = titleId;
+			this.isSelected = isSelected;
+		}
+	}
+
 }
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SettingsProfileFragment.java b/OsmAnd/src/net/osmand/plus/profiles/SettingsProfileFragment.java
index 2b236921e99..15fb6335901 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/SettingsProfileFragment.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/SettingsProfileFragment.java
@@ -1,7 +1,9 @@
 package net.osmand.plus.profiles;
 
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.DIALOG_TYPE;
-import static net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.TYPE_APP_PROFILE;
+
+
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.DIALOG_TYPE;
+import static net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.TYPE_APP_PROFILE;
 
 import android.content.Context;
 import android.content.Intent;
@@ -23,7 +25,6 @@
 import net.osmand.plus.ApplicationMode;
 import net.osmand.plus.R;
 import net.osmand.plus.base.BaseOsmAndFragment;
-import net.osmand.plus.profiles.ProfileBottomSheetDialogFragment.ProfileTypeDialogListener;
 import net.osmand.plus.profiles.ProfileMenuAdapter.ProfileListener;
 import net.osmand.plus.profiles.SelectProfileBottomSheetDialogFragment.SelectProfileListener;
 import net.osmand.util.Algorithms;
@@ -86,17 +87,6 @@ public void editProfile(ApplicationMode item) {
 			}
 		};
 
-		typeListener = new SelectProfileListener() {
-			@Override
-			public void onSelectedType(int pos) {
-				Intent intent = new Intent(getActivity(), EditProfileActivity.class);
-				intent.putExtra(IS_NEW_PROFILE, true);
-				intent.putExtra(IS_USER_PROFILE, true);
-				intent.putExtra(PROFILE_STRING_KEY, baseProfiles.get(pos).getStringKey());
-				startActivity(intent);
-			}
-		};
-
 		View view = inflater.inflate(R.layout.profiles_list_fragment, container, false);
 		recyclerView = view.findViewById(R.id.profiles_list);
 		addNewProfileBtn = view.findViewById(R.id.add_profile_btn);
@@ -127,16 +117,7 @@ public void onClick(View v) {
 	public void onResume() {
 		super.onResume();
 
-		typeListener = new SelectProfileListener() {
-			@Override
-			public void onSelectedType(int pos) {
-				Intent intent = new Intent(getActivity(), EditProfileActivity.class);
-				intent.putExtra(IS_NEW_PROFILE, true);
-				intent.putExtra(IS_USER_PROFILE, true);
-				intent.putExtra(PROFILE_STRING_KEY, baseProfiles.get(pos).getStringKey());
-				startActivity(intent);
-			}
-		};
+		getBaseProfileListener();
 
 		allAppModes = ApplicationMode.allPossibleValues();
 		allAppModes.remove(ApplicationMode.DEFAULT);
@@ -144,18 +125,18 @@ public void onSelectedType(int pos) {
 	}
 
 	SelectProfileListener getBaseProfileListener() {
-//		if (typeListener == null) {
-//			typeListener = new SelectProfileListener() {
-//				@Override
-//				public void onSelectedType(int pos) {
-//					Intent intent = new Intent(getActivity(), EditProfileActivity.class);
-//					intent.putExtra(IS_NEW_PROFILE, true);
-//					intent.putExtra(IS_USER_PROFILE, true);
-//					intent.putExtra(PROFILE_STRING_KEY, baseProfiles.get(pos).getStringKey());
-//					startActivity(intent);
-//				}
-//			};
-//		}
+		if (typeListener == null) {
+			typeListener = new SelectProfileListener() {
+				@Override
+				public void onSelectedType(int pos) {
+					Intent intent = new Intent(getActivity(), EditProfileActivity.class);
+					intent.putExtra(IS_NEW_PROFILE, true);
+					intent.putExtra(IS_USER_PROFILE, true);
+					intent.putExtra(PROFILE_STRING_KEY, baseProfiles.get(pos).getStringKey());
+					startActivity(intent);
+				}
+			};
+		}
 		return typeListener;
 	}
 
