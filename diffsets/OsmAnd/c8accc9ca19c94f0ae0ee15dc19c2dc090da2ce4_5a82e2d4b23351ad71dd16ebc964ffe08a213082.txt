diff --git a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
index acc5677352f..88307a259e1 100644
--- a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
+++ b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
@@ -2366,7 +2366,7 @@ public void run() {
 					if (!ApplicationMode.values(app).contains(appMode)) {
 						ApplicationMode.changeProfileAvailability(appMode, true, app);
 					}
-					app.getSettings().APPLICATION_MODE.set(appMode);
+					app.getSettings().setApplicationMode(appMode);
 				}
 			});
 			return true;
diff --git a/OsmAnd/src/net/osmand/plus/AppInitializer.java b/OsmAnd/src/net/osmand/plus/AppInitializer.java
index c372a4de988..eda57e3c281 100644
--- a/OsmAnd/src/net/osmand/plus/AppInitializer.java
+++ b/OsmAnd/src/net/osmand/plus/AppInitializer.java
@@ -419,10 +419,10 @@ public void onCreateApplication() {
 		if (osmandSettings.FOLLOW_THE_ROUTE.get()) {
 			ApplicationMode savedMode = osmandSettings.readApplicationMode();
 			if (!osmandSettings.APPLICATION_MODE.get().getStringKey().equals(savedMode.getStringKey())) {
-				osmandSettings.APPLICATION_MODE.set(savedMode);
+				osmandSettings.setApplicationMode(savedMode);
 			}
 		} else {
-			osmandSettings.APPLICATION_MODE.set(osmandSettings.DEFAULT_APPLICATION_MODE.get());
+			osmandSettings.setApplicationMode(osmandSettings.DEFAULT_APPLICATION_MODE.get());
 		}
 		startTime = System.currentTimeMillis();
 		getLazyRoutingConfig();
diff --git a/OsmAnd/src/net/osmand/plus/ContextMenuAdapter.java b/OsmAnd/src/net/osmand/plus/ContextMenuAdapter.java
index d188a7d0ee3..381125e0ec8 100644
--- a/OsmAnd/src/net/osmand/plus/ContextMenuAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/ContextMenuAdapter.java
@@ -258,7 +258,7 @@ public View getView(final int position, View convertView, ViewGroup parent) {
 							@Override
 							public void onClick(View view) {
 								if (selected.size() > 0) {
-									app.getSettings().APPLICATION_MODE.set(selected.iterator().next());
+									app.getSettings().setApplicationMode(selected.iterator().next());
 									notifyDataSetChanged();
 								}
 								if (changeAppModeListener != null) {
diff --git a/OsmAnd/src/net/osmand/plus/OsmandApplication.java b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
index 36c566a7a69..121976f32b6 100644
--- a/OsmAnd/src/net/osmand/plus/OsmandApplication.java
+++ b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
@@ -537,7 +537,7 @@ public void stopNavigation() {
 		routingHelper.clearCurrentRoute(null, new ArrayList<LatLon>());
 		routingHelper.setRoutePlanningMode(false);
 		osmandSettings.LAST_ROUTING_APPLICATION_MODE = osmandSettings.APPLICATION_MODE.get();
-		osmandSettings.APPLICATION_MODE.set(osmandSettings.DEFAULT_APPLICATION_MODE.get());
+		osmandSettings.setApplicationMode(osmandSettings.DEFAULT_APPLICATION_MODE.get());
 		targetPointsHelper.removeAllWayPoints(false, false);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java b/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
index 1eca37b0586..57bf80725af 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivityActions.java
@@ -555,7 +555,7 @@ public void enterRoutePlanningModeGivenGpx(GPXFile gpxFile, ApplicationMode appM
 		TargetPointsHelper targets = app.getTargetPointsHelper();
 
 		ApplicationMode mode = appMode != null ? appMode : getRouteMode(from);
-		//app.getSettings().APPLICATION_MODE.set(mode);
+		//app.getSettings().setApplicationMode(mode);
 		app.getRoutingHelper().setAppMode(mode);
 		app.initVoiceCommandPlayer(mapActivity, mode, true, null, false, false, showMenu);
 		// save application mode controls
@@ -588,7 +588,7 @@ public void recalculateRoute(boolean showDialog) {
 		TargetPointsHelper targets = app.getTargetPointsHelper();
 
 		ApplicationMode mode = getRouteMode(null);
-		//app.getSettings().APPLICATION_MODE.set(mode);
+		//app.getSettings().setApplicationMode(mode, false);
 		app.getRoutingHelper().setAppMode(mode);
 		//Test for #2810: No need to init player here?
 		//app.initVoiceCommandPlayer(mapActivity, true, null, false, false);
@@ -756,7 +756,7 @@ private ContextMenuAdapter createSwitchProfileOptionsMenu(final OsmandApplicatio
 					.setListener(new ItemClickListener() {
 						@Override
 						public boolean onContextMenuClick(ArrayAdapter<ContextMenuItem> adapter, int itemId, int position, boolean isChecked, int[] viewCoordinates) {
-							app.getSettings().APPLICATION_MODE.set(appMode);
+							app.getSettings().setApplicationMode(appMode);
 							updateDrawerMenu();
 							return false;
 						}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
index 23c65ac932e..d0d2b6dbd7a 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
@@ -737,7 +737,7 @@ static private void startNavigation(MapActivity mapActivity,
 		OsmandApplication app = mapActivity.getMyApplication();
 		RoutingHelper routingHelper = app.getRoutingHelper();
 		if (gpx == null) {
-			app.getSettings().APPLICATION_MODE.set(mode);
+			app.getSettings().setApplicationMode(mode);
 			final TargetPointsHelper targets = mapActivity.getMyApplication().getTargetPointsHelper();
 			targets.removeAllWayPoints(false, true);
 			targets.navigateToPoint(to, true, -1, toDesc);
@@ -747,7 +747,7 @@ static private void startNavigation(MapActivity mapActivity,
 			mapActivity.getMapRouteInfoMenu().show();
 		} else {
 			if (app.getSettings().APPLICATION_MODE.get() != routingHelper.getAppMode()) {
-				app.getSettings().APPLICATION_MODE.set(routingHelper.getAppMode());
+				app.getSettings().setApplicationMode(routingHelper.getAppMode(), false);
 			}
 			mapActivity.getMapViewTrackingUtilities().backToLocationImpl();
 			app.getSettings().FOLLOW_THE_ROUTE.set(true);
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenu.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenu.java
index 1bb1e1146e9..c1a6a6cc0ac 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenu.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenu.java
@@ -953,7 +953,7 @@ public void navigateButtonPressed() {
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
 			if (navigateInPedestrianMode()) {
-				mapActivity.getMyApplication().getSettings().APPLICATION_MODE.set(ApplicationMode.PEDESTRIAN);
+				mapActivity.getMyApplication().getSettings().setApplicationMode(ApplicationMode.PEDESTRIAN, false);
 			}
 			mapActivity.getMapLayers().getMapControlsLayer().navigateButton();
 		}
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedMenuFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedMenuFragment.java
index 0bd0ca59d2a..951e9a1b524 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/DestinationReachedMenuFragment.java
@@ -178,7 +178,7 @@ private void finishNavigation() {
 				}
 			}
 			OsmandSettings settings = mapActivity.getMyApplication().getSettings();
-			settings.APPLICATION_MODE.set(settings.DEFAULT_APPLICATION_MODE.get());
+			settings.setApplicationMode(settings.DEFAULT_APPLICATION_MODE.get());
 			mapActivity.getMapActions().stopNavigationWithoutConfirm();
 			dismissMenu();
 		}
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SelectAppModesBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/profiles/SelectAppModesBottomSheetDialogFragment.java
index c7a49a7ab50..825bc61b044 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/SelectAppModesBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/SelectAppModesBottomSheetDialogFragment.java
@@ -88,7 +88,7 @@ public void onProfilePressed(ApplicationMode appMode) {
 		OsmandSettings settings = getMyApplication().getSettings();
 		if (appMode != this.appMode) {
 			if (appModeChangeable) {
-				settings.APPLICATION_MODE.set(appMode);
+				settings.setApplicationMode(appMode);
 			}
 			Fragment targetFragment = getTargetFragment();
 			if (targetFragment instanceof AppModeChangedListener) {
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java b/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
index 50f932e7ce1..3710f9832b9 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/actions/SwitchProfileAction.java
@@ -123,7 +123,7 @@ public void executeWithParams(final MapActivity activity, final String params) {
 		ApplicationMode appMode = getModeForKey(params);
 		if (appMode != null) {
 			OsmandApplication app = activity.getMyApplication();
-			app.getSettings().APPLICATION_MODE.set(appMode);
+			app.getSettings().setApplicationMode(appMode);
 			app.getQuickActionRegistry().setQuickActionFabState(true);
 
 			String message = String.format(activity.getString(
diff --git a/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java b/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
index e080f7b3bdb..b1a6c44c273 100644
--- a/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
+++ b/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
@@ -637,7 +637,7 @@ private boolean updateCurrentRouteStatus(Location currentLocation, double posTol
 					@Override
 					public void run() {
 						settings.LAST_ROUTING_APPLICATION_MODE = settings.APPLICATION_MODE.get();
-						//settings.APPLICATION_MODE.set(settings.DEFAULT_APPLICATION_MODE.get());
+						//settings.setApplicationMode(settings.DEFAULT_APPLICATION_MODE.get());
 					}
 				});
 				finishCurrentRoute();
diff --git a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
index 31c081ae23a..b3cd8fb9a69 100644
--- a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
+++ b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
@@ -238,7 +238,7 @@ public boolean setPreference(String key, Object value, ApplicationMode mode) {
 					String appModeKey = (String) value;
 					ApplicationMode appMode = ApplicationMode.valueOfStringKey(appModeKey, null);
 					if (appMode != null) {
-						APPLICATION_MODE.set(appMode);
+						setApplicationMode(appMode);
 						return true;
 					}
 				}
@@ -380,6 +380,18 @@ private boolean prefCanBeCopiedOrReset(OsmandPreference pref) {
 
 	public ApplicationMode LAST_ROUTING_APPLICATION_MODE = null;
 
+	public boolean setApplicationMode(ApplicationMode appMode) {
+		return setApplicationMode(appMode, true);
+	}
+
+	public boolean setApplicationMode(ApplicationMode appMode, boolean markAsLastUsed) {
+		boolean valueSaved = APPLICATION_MODE.set(appMode);
+		if (markAsLastUsed && valueSaved) {
+			LAST_USED_APPLICATION_MODE.set(appMode.getStringKey());
+		}
+		return valueSaved;
+	}
+
 	// this value string is synchronized with settings_pref.xml preference name
 	public final OsmandPreference<ApplicationMode> APPLICATION_MODE = new PreferenceWithListener<ApplicationMode>() {
 
@@ -425,7 +437,6 @@ public boolean set(ApplicationMode val) {
 			if (valueSaved) {
 				currentMode = val;
 				profilePreferences = getProfilePreferences(currentMode);
-				LAST_USED_APPLICATION_MODE.set(currentMode.getStringKey());
 
 				fireEvent(oldMode);
 			}
@@ -757,7 +768,7 @@ protected ApplicationMode getValue(Object prefs, ApplicationMode defaultValue) {
 		protected boolean setValue(Object prefs, ApplicationMode val) {
 			boolean valueSaved = settingsAPI.edit(prefs).putString(getId(), val.getStringKey()).commit();
 			if (valueSaved) {
-				APPLICATION_MODE.set(val);
+				setApplicationMode(val);
 			}
 
 			return valueSaved;
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/ConfigureProfileFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/ConfigureProfileFragment.java
index 48ceba0a111..cea9b0e17c1 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/ConfigureProfileFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/ConfigureProfileFragment.java
@@ -417,7 +417,7 @@ public boolean onPreferenceClick(Preference preference) {
 						if (!ApplicationMode.values(app).contains(selectedMode)) {
 							ApplicationMode.changeProfileAvailability(selectedMode, true, app);
 						}
-						settings.APPLICATION_MODE.set(selectedMode);
+						settings.setApplicationMode(selectedMode);
 						fragmentManager.beginTransaction()
 								.remove(this)
 								.addToBackStack(TAG)
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
index f73a504dfb8..b2697cecf22 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
@@ -800,7 +800,7 @@ public void startNavigation() {
 		if (routingHelper.isFollowingMode()) {
 			switchToRouteFollowingLayout();
 			if (app.getSettings().APPLICATION_MODE.get() != routingHelper.getAppMode()) {
-				app.getSettings().APPLICATION_MODE.set(routingHelper.getAppMode());
+				app.getSettings().setApplicationMode(routingHelper.getAppMode(), false);
 			}
 		} else {
 			if (!app.getTargetPointsHelper().checkPointToNavigateShort()) {
@@ -808,7 +808,7 @@ public void startNavigation() {
 			} else {
 				touchEvent = 0;
 				app.logEvent("start_navigation");
-				app.getSettings().APPLICATION_MODE.set(routingHelper.getAppMode());
+				app.getSettings().setApplicationMode(routingHelper.getAppMode(), false);
 				mapActivity.getMapViewTrackingUtilities().backToLocationImpl(17, true);
 				app.getSettings().FOLLOW_THE_ROUTE.set(true);
 				routingHelper.setFollowingMode(true);
