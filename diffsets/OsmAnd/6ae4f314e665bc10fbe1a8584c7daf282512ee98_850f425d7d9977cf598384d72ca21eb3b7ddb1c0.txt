diff --git a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
index 3ec03eeb4eb..41df619cb1e 100644
--- a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
+++ b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
@@ -53,7 +53,7 @@ public class RouteLineColorCard extends MapBaseCard implements CardListener, Col
 	private static final int NIGHT_TITLE_ID = R.string.night;
 
 	private final Fragment targetFragment;
-	private HeaderUiAdapter headerUiAdapter;
+	private final HeaderUiAdapter headerUiAdapter;
 
 	private ColorsCard colorsCard;
 	private GradientCard gradientCard;
@@ -65,8 +65,8 @@ public class RouteLineColorCard extends MapBaseCard implements CardListener, Col
 
 	private ColoringType selectedType;
 	private String selectedRouteInfoAttribute;
-	private PreviewRouteLineInfo previewRouteLineInfo;
-	private DayNightMode initMapTheme;
+	private final PreviewRouteLineInfo previewRouteLineInfo;
+	private final DayNightMode initMapTheme;
 	private DayNightMode selectedMapTheme;
 
 	public RouteLineColorCard(@NonNull MapActivity mapActivity,
@@ -114,28 +114,11 @@ private void initSelectedMode() {
 	}
 
 	private void modeChanged() {
-		if (selectedType.isDefault()) {
-			AndroidUiHelper.updateVisibility(themeToggleContainer, false);
-			colorsCard.updateVisibility(false);
-			gradientCard.updateVisibility(false);
-			changeMapTheme(initMapTheme);
-		} else if (selectedType.isCustomColor()) {
-			AndroidUiHelper.updateVisibility(themeToggleContainer, true);
-			colorsCard.updateVisibility(true);
-			gradientCard.updateVisibility(false);
-			changeMapTheme(isNightMap() ? DayNightMode.NIGHT : DayNightMode.DAY);
-		} else if (selectedType.isGradient()) {
-			AndroidUiHelper.updateVisibility(themeToggleContainer, false);
-			gradientCard.setSelectedScaleType(selectedType.toGradientScaleType());
-			colorsCard.updateVisibility(false);
-			gradientCard.updateVisibility(true);
-			changeMapTheme(initMapTheme);
-		} else {
-			AndroidUiHelper.updateVisibility(themeToggleContainer, false);
-			colorsCard.updateVisibility(false);
-			gradientCard.updateVisibility(false);
-			changeMapTheme(initMapTheme);
-		}
+		AndroidUiHelper.updateVisibility(themeToggleContainer, selectedType.isCustomColor());
+		colorsCard.updateVisibility(selectedType.isCustomColor());
+		gradientCard.setSelectedScaleType(selectedType.toGradientScaleType());
+		changeMapTheme(!selectedType.isCustomColor() ? initMapTheme : isNightMap() ? DayNightMode.NIGHT : DayNightMode.DAY);
+
 		previewRouteLineInfo.setRouteColoringType(selectedType);
 		previewRouteLineInfo.setRouteInfoAttribute(selectedRouteInfoAttribute);
 		updateColorItems();
diff --git a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineWidthCard.java b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineWidthCard.java
index 8d56362e2eb..8b7e3abda1f 100644
--- a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineWidthCard.java
+++ b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineWidthCard.java
@@ -92,15 +92,19 @@ protected void updateContent() {
 		groupRecyclerView.setAdapter(widthAdapter);
 		groupRecyclerView.setLayoutManager(new LinearLayoutManager(app, RecyclerView.HORIZONTAL, false));
 
+		updateTopDividerVisibility(!previewRouteLineInfo.getRouteColoringType().isRouteInfoAttribute());
 		((TextView) view.findViewById(R.id.title)).setText(R.string.select_track_width);
 		tvSelectedType = view.findViewById(R.id.descr);
 		tvDescription = view.findViewById(R.id.description);
 		sliderContainer = view.findViewById(R.id.slider_container);
-		AndroidUiHelper.updateVisibility(view.findViewById(R.id.top_divider), isShowDivider());
 
 		initSelectedMode();
 	}
 
+	public void updateTopDividerVisibility(boolean visible) {
+		AndroidUiHelper.updateVisibility(view.findViewById(R.id.top_divider), visible);
+	}
+
 	private void initSelectedMode() {
 		selectedMode = findAppropriateMode(getRouteLineWidth());
 		modeChanged();
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteLineAppearanceFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteLineAppearanceFragment.java
index 985b9809074..49304a73d44 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/RouteLineAppearanceFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/RouteLineAppearanceFragment.java
@@ -22,6 +22,8 @@
 import net.osmand.plus.base.ContextMenuScrollFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.helpers.enums.DayNightMode;
+import net.osmand.plus.routepreparationmenu.cards.BaseCard;
+import net.osmand.plus.routepreparationmenu.cards.BaseCard.CardListener;
 import net.osmand.plus.routing.PreviewRouteLineInfo;
 import net.osmand.plus.routing.cards.RouteLineColorCard;
 import net.osmand.plus.routing.cards.RouteLineColorCard.OnMapThemeUpdateListener;
@@ -41,7 +43,7 @@
 
 public class RouteLineAppearanceFragment extends ContextMenuScrollFragment
 		implements ColorPickerListener, OnMapThemeUpdateListener, OnSelectedColorChangeListener,
-		HeaderUiAdapter {
+		HeaderUiAdapter, CardListener {
 
 	public static final String TAG = RouteLineAppearanceFragment.class.getName();
 
@@ -176,6 +178,7 @@ private void setupCards() {
 		cardsContainer.removeAllViews();
 
 		colorCard = new RouteLineColorCard(mapActivity, this, previewRouteLineInfo, initMapTheme, selectedMapTheme, this);
+		colorCard.setListener(this);
 		cardsContainer.addView(colorCard.build(mapActivity));
 
 		widthCard = new RouteLineWidthCard(mapActivity, previewRouteLineInfo, createScrollListener(), this);
@@ -467,6 +470,24 @@ private void updateColorItems() {
 		}
 	}
 
+	@Override
+	public void onCardLayoutNeeded(@NonNull BaseCard card) {
+	}
+
+	@Override
+	public void onCardPressed(@NonNull BaseCard card) {
+		if (card instanceof RouteLineColorCard) {
+			if (widthCard != null) {
+				boolean dividerVisible = !previewRouteLineInfo.getRouteColoringType().isRouteInfoAttribute();
+				widthCard.updateTopDividerVisibility(dividerVisible);
+			}
+		}
+	}
+
+	@Override
+	public void onCardButtonPressed(@NonNull BaseCard card, int buttonIndex) {
+	}
+
 	public static boolean showInstance(@NonNull MapActivity mapActivity,
 	                                   @NonNull PreviewRouteLineInfo drawInfo,
 	                                   @NonNull Fragment target) {
diff --git a/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java b/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
index ffc8073bd0f..e6288c450be 100644
--- a/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
@@ -351,12 +351,15 @@ public void onCardPressed(@NonNull BaseCard card) {
 				trackDrawInfo.setRouteInfoAttribute(trackColoringCard.getRouteInfoAttribute());
 				mapActivity.refreshMap();
 				if (gradientCard != null) {
-					GradientScaleType scaleType = currentColoringType == null ?
-							null : currentColoringType.toGradientScaleType();
+					GradientScaleType scaleType = currentColoringType.isGradient() ?
+							currentColoringType.toGradientScaleType() : null;
 					gradientCard.setSelectedScaleType(scaleType);
 				}
 				if (colorsCard != null) {
-					AndroidUiHelper.updateVisibility(colorsCard.getView(), currentColoringType == null);
+					AndroidUiHelper.updateVisibility(colorsCard.getView(), currentColoringType.isTrackSolid());
+				}
+				if (trackWidthCard != null) {
+					trackWidthCard.updateTopDividerVisibility(!currentColoringType.isRouteInfoAttribute());
 				}
 			} else if (card instanceof ColorsCard) {
 				int color = ((ColorsCard) card).getSelectedColor();
diff --git a/OsmAnd/src/net/osmand/plus/track/TrackColoringCard.java b/OsmAnd/src/net/osmand/plus/track/TrackColoringCard.java
index 0aa8ff678bf..463c96820e3 100644
--- a/OsmAnd/src/net/osmand/plus/track/TrackColoringCard.java
+++ b/OsmAnd/src/net/osmand/plus/track/TrackColoringCard.java
@@ -29,6 +29,7 @@
 
 import androidx.annotation.DrawableRes;
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import androidx.appcompat.content.res.AppCompatResources;
 import androidx.recyclerview.widget.LinearLayoutManager;
 import androidx.recyclerview.widget.RecyclerView;
@@ -82,10 +83,12 @@ public void updateColor() {
 		}
 	}
 
+	@NonNull
 	public ColoringType getSelectedColoringType() {
 		return ColoringType.getNonNullTrackColoringTypeByName(selectedAppearanceItem.getAttrName());
 	}
 
+	@Nullable
 	public String getRouteInfoAttribute() {
 		return ColoringType.getRouteInfoAttribute(selectedAppearanceItem.getAttrName());
 	}
diff --git a/OsmAnd/src/net/osmand/plus/track/TrackWidthCard.java b/OsmAnd/src/net/osmand/plus/track/TrackWidthCard.java
index 3f537671105..b4ced267be0 100644
--- a/OsmAnd/src/net/osmand/plus/track/TrackWidthCard.java
+++ b/OsmAnd/src/net/osmand/plus/track/TrackWidthCard.java
@@ -47,8 +47,8 @@ public class TrackWidthCard extends MapBaseCard {
 	private View sliderContainer;
 	private RecyclerView groupRecyclerView;
 
-	public TrackWidthCard(MapActivity mapActivity, TrackDrawInfo trackDrawInfo,
-	                      OnNeedScrollListener onNeedScrollListener) {
+	public TrackWidthCard(@NonNull MapActivity mapActivity, @NonNull TrackDrawInfo trackDrawInfo,
+	                      @NonNull OnNeedScrollListener onNeedScrollListener) {
 		super(mapActivity);
 		this.trackDrawInfo = trackDrawInfo;
 		this.onNeedScrollListener = onNeedScrollListener;
@@ -62,6 +62,7 @@ public int getCardLayoutId() {
 
 	@Override
 	protected void updateContent() {
+		updateTopDividerVisibility(!trackDrawInfo.getColoringType().isRouteInfoAttribute());
 		updateHeader();
 		updateCustomWidthSlider();
 
@@ -70,8 +71,6 @@ protected void updateContent() {
 		groupRecyclerView.setAdapter(widthAdapter);
 		groupRecyclerView.setLayoutManager(new LinearLayoutManager(app, RecyclerView.HORIZONTAL, false));
 		scrollMenuToSelectedItem();
-
-		AndroidUiHelper.updateVisibility(view.findViewById(R.id.top_divider), isShowDivider());
 	}
 
 	public void updateItems() {
@@ -80,6 +79,10 @@ public void updateItems() {
 		}
 	}
 
+	public void updateTopDividerVisibility(boolean visible) {
+		AndroidUiHelper.updateVisibility(view.findViewById(R.id.top_divider), visible);
+	}
+
 	@Nullable
 	private AppearanceListItem getSelectedItem() {
 		if (selectedItem == null) {
