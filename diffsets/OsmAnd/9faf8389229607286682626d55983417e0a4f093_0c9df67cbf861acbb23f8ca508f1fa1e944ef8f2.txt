diff --git a/OsmAnd/src/net/osmand/plus/AppVersionUpgradeOnInit.java b/OsmAnd/src/net/osmand/plus/AppVersionUpgradeOnInit.java
index b117fd6301c..6d32b7f8d53 100644
--- a/OsmAnd/src/net/osmand/plus/AppVersionUpgradeOnInit.java
+++ b/OsmAnd/src/net/osmand/plus/AppVersionUpgradeOnInit.java
@@ -19,6 +19,7 @@
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.EnumStringPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.views.layers.RadiusRulerControlLayer.RadiusRulerMode;
 import net.osmand.plus.views.mapwidgets.WidgetGroup;
 import net.osmand.plus.views.mapwidgets.WidgetParams;
 import net.osmand.util.Algorithms;
@@ -91,8 +92,10 @@ class AppVersionUpgradeOnInit {
 	public static final int VERSION_4_0_02 = 4002;
 	// 4003 - 4.0-03 (Migrate state dependent widgets)
 	public static final int VERSION_4_0_03 = 4003;
+	// 4004 - 4.0-04 (Migrate Radius ruler widget preference)
+	public static final int VERSION_4_0_04 = 4004;
 
-	public static final int LAST_APP_VERSION = VERSION_4_0_03;
+	public static final int LAST_APP_VERSION = VERSION_4_0_04;
 
 	static final String VERSION_INSTALLED = "VERSION_INSTALLED";
 
@@ -201,6 +204,9 @@ public void onFinish(AppInitializer init) {
 				if (prevAppVersion < VERSION_4_0_03) {
 					migrateStateDependentWidgets();
 				}
+				if (prevAppVersion < VERSION_4_0_04) {
+					migrateRadiusRulerWidgetPreference();
+				}
 				startPrefs.edit().putInt(VERSION_INSTALLED_NUMBER, lastVersion).commit();
 				startPrefs.edit().putString(VERSION_INSTALLED, Version.getFullVersion(app)).commit();
 				appVersionChanged = true;
@@ -547,4 +553,21 @@ private void hideNotReplacedWidgets(@NonNull ApplicationMode appMode) {
 		}
 		settings.MAP_INFO_CONTROLS.setModeValue(appMode, newWidgetsVisibilityString.toString());
 	}
+
+	private void migrateRadiusRulerWidgetPreference() {
+		OsmandSettings settings = app.getSettings();
+		CommonPreference<RadiusRulerMode> radiusRulerModePref = new EnumStringPreference<>(settings,
+				"ruler_mode", RadiusRulerMode.FIRST, RadiusRulerMode.values()).makeGlobal().makeShared();
+		if (radiusRulerModePref.isSet()) {
+			RadiusRulerMode radiusRulerMode = radiusRulerModePref.get();
+			for (ApplicationMode appMode : ApplicationMode.allPossibleValues()) {
+				boolean radiusRulerEnabled = radiusRulerMode == RadiusRulerMode.FIRST
+						|| radiusRulerMode == RadiusRulerMode.SECOND;
+				boolean radiusRulerNightMode = radiusRulerMode == RadiusRulerMode.SECOND;
+
+				settings.SHOW_RADIUS_RULER_ON_MAP.setModeValue(appMode, radiusRulerEnabled);
+				settings.RADIUS_RULER_NIGHT_MODE.setModeValue(appMode, radiusRulerNightMode);
+			}
+		}
+	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
index d1bca97ed07..0b2ca061b4e 100644
--- a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
+++ b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
@@ -786,25 +786,10 @@ private List<String> getWidgetsVisibilityInfo(ApplicationMode appMode) {
 		}
 	};
 
-	public final CommonPreference<RadiusRulerMode> RADIUS_RULER_MODE = new EnumStringPreference<>(this, "ruler_mode", RadiusRulerMode.FIRST, RadiusRulerMode.values()).makeGlobal().makeShared();
-	public final OsmandPreference<Boolean> SHOW_RADIUS_RULER_ON_MAP = new BooleanPreference(this, "show_radius_ruler_on_map", true) {
-
-		@Override
-		public Boolean getProfileDefaultValue(ApplicationMode mode) {
-			RadiusRulerMode radiusRulerMode = RADIUS_RULER_MODE.getProfileDefaultValue(mode);
-			return radiusRulerMode == RadiusRulerMode.FIRST || radiusRulerMode == RadiusRulerMode.SECOND;
-		}
-	}.makeProfile();
+	public final OsmandPreference<Boolean> SHOW_RADIUS_RULER_ON_MAP = new BooleanPreference(this, "show_radius_ruler_on_map", true).makeProfile();
 	public final OsmandPreference<Boolean> SHOW_DISTANCE_CIRCLES_ON_RADIUS_RULER = new BooleanPreference(this, "show_distance_circles_on_radius_rules", true).makeProfile();
 	public final OsmandPreference<Boolean> SHOW_COMPASS_ON_RADIUS_RULER = new BooleanPreference(this, "show_compass_ruler", true).makeProfile();
-	public final OsmandPreference<Boolean> RADIUS_RULER_NIGHT_MODE = new BooleanPreference(this, "radius_ruler_night_mode", false) {
-
-		@Override
-		public Boolean getProfileDefaultValue(ApplicationMode mode) {
-			RadiusRulerMode radiusRulerMode = RADIUS_RULER_MODE.getModeValue(mode);
-			return radiusRulerMode == RadiusRulerMode.SECOND;
-		}
-	}.makeProfile();
+	public final OsmandPreference<Boolean> RADIUS_RULER_NIGHT_MODE = new BooleanPreference(this, "radius_ruler_night_mode", false).makeProfile();
 
 	public final OsmandPreference<Boolean> SHOW_DISTANCE_RULER = new BooleanPreference(this, "show_distance_ruler", false).makeProfile();
 	public final OsmandPreference<Boolean> SHOW_ELEVATION_PROFILE_WIDGET = new BooleanPreference(this, "show_elevation_profile_widget", false).makeProfile();
