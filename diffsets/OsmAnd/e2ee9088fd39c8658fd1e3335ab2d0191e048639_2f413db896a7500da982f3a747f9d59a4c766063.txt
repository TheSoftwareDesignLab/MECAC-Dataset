diff --git a/OsmAnd/res/layout/main.xml b/OsmAnd/res/layout/main.xml
index 22fbabdb229..f6645454241 100644
--- a/OsmAnd/res/layout/main.xml
+++ b/OsmAnd/res/layout/main.xml
@@ -22,30 +22,7 @@
 				android:layout_height="match_parent"
 				android:orientation="vertical" />
 
-			<net.osmand.plus.views.controls.MapHudLayout
-				android:id="@+id/MapHudButtonsOverlay"
-				android:layout_width="match_parent"
-				android:layout_height="match_parent"
-				android:fitsSystemWindows="true">
-
-				<include
-					android:id="@+id/MapHudButtonsOverlayTop"
-					layout="@layout/map_hud_top" />
-
-				<FrameLayout
-					android:id="@+id/left_side_menu"
-					android:layout_width="0dp"
-					android:layout_height="0dp" />
-
-				<include
-					android:id="@+id/MapHudButtonsOverlayBottom"
-					layout="@layout/map_hud_bottom" />
-
-				<include
-					android:id="@+id/MapHudButtonsOverlayQuickActions"
-					layout="@layout/map_hud_quick_actions" />
-
-			</net.osmand.plus.views.controls.MapHudLayout>
+			<include layout="@layout/map_hud_layout" />
 
 			<FrameLayout
 				android:layout_width="match_parent"
diff --git a/OsmAnd/res/layout/map_hud_layout.xml b/OsmAnd/res/layout/map_hud_layout.xml
new file mode 100644
index 00000000000..f49de663436
--- /dev/null
+++ b/OsmAnd/res/layout/map_hud_layout.xml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="utf-8"?>
+<net.osmand.plus.views.controls.MapHudLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	xmlns:tools="http://schemas.android.com/tools"
+	android:id="@+id/map_hud_layout"
+	android:layout_width="match_parent"
+	android:layout_height="match_parent"
+	android:fitsSystemWindows="true">
+
+	<include
+		android:id="@+id/MapHudButtonsOverlayTop"
+		layout="@layout/map_hud_top" />
+
+	<FrameLayout
+		android:id="@+id/left_side_menu"
+		android:layout_width="0dp"
+		android:layout_height="0dp" />
+
+	<include
+		android:id="@+id/MapHudButtonsOverlayBottom"
+		layout="@layout/map_hud_bottom" />
+
+	<net.osmand.plus.quickaction.QuickActionsWidget
+		android:id="@+id/quick_action_widget"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:visibility="gone" />
+
+	<include
+		layout="@layout/map_3d_button"
+		android:layout_width="@dimen/map_button_size"
+		android:layout_height="@dimen/map_button_size"
+		android:layout_gravity="bottom|end"
+		tools:visibility="gone" />
+
+</net.osmand.plus.views.controls.MapHudLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/map_hud_quick_actions.xml b/OsmAnd/res/layout/map_hud_quick_actions.xml
deleted file mode 100644
index 00c63f0be4b..00000000000
--- a/OsmAnd/res/layout/map_hud_quick_actions.xml
+++ /dev/null
@@ -1,14 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
-	xmlns:tools="http://schemas.android.com/tools"
-	android:layout_width="match_parent"
-	android:layout_height="match_parent">
-
-	<net.osmand.plus.quickaction.QuickActionsWidget
-		android:id="@+id/quick_action_widget"
-		android:layout_width="match_parent"
-		android:layout_height="wrap_content"
-		android:visibility="gone"
-		tools:visibility="visible" />
-
-</FrameLayout>
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index 6c28de816c7..612178250bb 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -428,7 +428,7 @@ private void destroyProgressBarForRouting() {
 
 	public void updateProgress(int progress) {
 		ProgressBar progressBar = findViewById(R.id.map_horizontal_progress);
-		if (findViewById(R.id.MapHudButtonsOverlay).getVisibility() == View.VISIBLE) {
+		if (findViewById(R.id.map_hud_layout).getVisibility() == View.VISIBLE) {
 			if (mapRouteInfoMenu.isVisible() || dashboardOnMap.isVisible() || isOnlineRoutingWithApproximation()) {
 				AndroidUiHelper.updateVisibility(progressBar, false);
 				return;
@@ -1604,7 +1604,7 @@ public void hideTopToolbar(@NonNull TopToolbarControllerType type) {
 	@Nullable
 	protected List<View> getHidingViews() {
 		List<View> views = new ArrayList<>();
-		View mainContainer = findViewById(R.id.MapHudButtonsOverlay);
+		View mainContainer = findViewById(R.id.map_hud_layout);
 		if (mainContainer != null) {
 			views.add(mainContainer);
 		}
diff --git a/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java b/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
index 5790970a226..16f31f1f7a0 100644
--- a/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
+++ b/OsmAnd/src/net/osmand/plus/utils/UiUtilities.java
@@ -724,7 +724,7 @@ public static void updateStatusBarColor(@NonNull MapActivity activity) {
 		}
 
 		int color = TopToolbarController.NO_COLOR;
-		boolean mapControlsVisible = activity.findViewById(R.id.MapHudButtonsOverlay).getVisibility() == View.VISIBLE;
+		boolean mapControlsVisible = activity.findViewById(R.id.map_hud_layout).getVisibility() == View.VISIBLE;
 		boolean topToolbarVisible = mapLayers.getMapInfoLayer().isTopToolbarViewVisible();
 		boolean night = app.getDaynightHelper().isNightModeForMapControls();
 
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
index 25684dd7ed5..837ea2cd66c 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
@@ -1,9 +1,5 @@
 package net.osmand.plus.views.layers;
 
-import static android.view.Gravity.BOTTOM;
-import static android.view.Gravity.END;
-import static android.view.ViewGroup.LayoutParams.WRAP_CONTENT;
-
 import android.animation.Animator;
 import android.animation.AnimatorListenerAdapter;
 import android.animation.AnimatorSet;
@@ -11,11 +7,8 @@
 import android.content.Context;
 import android.graphics.Canvas;
 import android.graphics.PointF;
-import android.view.LayoutInflater;
 import android.view.MotionEvent;
 import android.view.View;
-import android.view.ViewGroup;
-import android.widget.FrameLayout;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -31,10 +24,7 @@
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.OsmandMapTileView;
-import net.osmand.plus.views.controls.MapHudLayout;
-import net.osmand.plus.views.controls.maphudbuttons.CompassButton;
 import net.osmand.plus.views.controls.maphudbuttons.Map3DButton;
 import net.osmand.plus.views.controls.maphudbuttons.MapButton;
 import net.osmand.plus.views.layers.base.OsmandMapLayer;
@@ -57,8 +47,6 @@ public class MapControlsLayer extends OsmandMapLayer {
 
 	private List<MapButton> mapButtons = new ArrayList<>();
 	private List<MapButton> customMapButtons = new ArrayList<>();
-	private Map3DButton map3DButton;
-	private CompassButton compassButton;
 
 	private MapRouteInfoMenu mapRouteInfoMenu;
 	private long touchEvent;
@@ -94,46 +82,17 @@ public void setMapActivity(@Nullable MapActivity mapActivity) {
 		super.setMapActivity(mapActivity);
 
 		if (mapActivity != null) {
-			mapRouteInfoMenu = mapActivity.getMapRouteInfoMenu();
+			mapRouteInfoMenu = MapActivity.getMapRouteInfoMenu();
 			visibilityHelper = mapActivity.getWidgetsVisibilityHelper();
-			initTopControls();
-			mapTransparencyHelper.initTransparencyBar();
 			initMapButtons();
-			initFabButtons(mapActivity);
-			updateControls(mapView.getCurrentRotatedTileBox(), null);
+			mapTransparencyHelper.initTransparencyBar();
+			updateControls(null);
 		} else {
 			mapButtons = new ArrayList<>();
 			customMapButtons = new ArrayList<>();
 			mapTransparencyHelper.destroyTransparencyBar();
 			mapRouteInfoMenu = null;
-			map3DButton = null;
-			compassButton = null;
-		}
-	}
-
-	private void initTopControls() {
-		MapActivity activity = requireMapActivity();
-		compassButton = activity.findViewById(R.id.map_compass_button);
-
-		addMapButton(activity.findViewById(R.id.map_layers_button));
-		addMapButton(activity.findViewById(R.id.map_search_button));
-		addMapButton(compassButton);
-	}
-
-	private void initFabButtons(@NonNull MapActivity activity) {
-		boolean nightMode = app.getDaynightHelper().isNightMode();
-		LayoutInflater inflater = UiUtilities.getInflater(activity, nightMode);
-		MapHudLayout container = activity.findViewById(R.id.MapHudButtonsOverlay);
-
-		if (map3DButton != null) {
-			container.removeView(map3DButton);
 		}
-		map3DButton = (Map3DButton) inflater.inflate(R.layout.map_3d_button, container, false);
-		map3DButton.setUseCustomPosition(true);
-		addMapButton(map3DButton);
-
-		container.addView(map3DButton, new FrameLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT, BOTTOM | END));
-		container.updateButtons();
 	}
 
 	public void setControlsClickable(boolean clickable) {
@@ -159,11 +118,21 @@ public boolean switchToRoutePlanningLayout() {
 
 	public void initMapButtons() {
 		MapActivity activity = requireMapActivity();
-		addMapButton(activity.findViewById(R.id.map_menu_button));
+
+		Map3DButton map3DButton = activity.findViewById(R.id.map_3d_button);
+		map3DButton.setUseCustomPosition(true);
+		addMapButton(map3DButton);
+
+		addMapButton(activity.findViewById(R.id.map_layers_button));
+		addMapButton(activity.findViewById(R.id.map_search_button));
+		addMapButton(activity.findViewById(R.id.map_compass_button));
+
 		addMapButton(activity.findViewById(R.id.map_zoom_in_button));
 		addMapButton(activity.findViewById(R.id.map_zoom_out_button));
-		addMapButton(activity.findViewById(R.id.map_route_info_button));
 		addMapButton(activity.findViewById(R.id.map_my_location_button));
+
+		addMapButton(activity.findViewById(R.id.map_menu_button));
+		addMapButton(activity.findViewById(R.id.map_route_info_button));
 	}
 
 	private void addMapButton(@NonNull MapButton mapButton) {
@@ -200,7 +169,7 @@ public void showMapControlsIfHidden() {
 	private void showMapControls() {
 		MapActivity mapActivity = requireMapActivity();
 		if (settings.DO_NOT_USE_ANIMATIONS.get()) {
-			mapActivity.findViewById(R.id.MapHudButtonsOverlay).setVisibility(View.VISIBLE);
+			mapActivity.findViewById(R.id.map_hud_layout).setVisibility(View.VISIBLE);
 		} else {
 			animateMapControls(true);
 		}
@@ -210,7 +179,7 @@ private void showMapControls() {
 	public void hideMapControls() {
 		MapActivity mapActivity = requireMapActivity();
 		if (settings.DO_NOT_USE_ANIMATIONS.get()) {
-			mapActivity.findViewById(R.id.MapHudButtonsOverlay).setVisibility(View.INVISIBLE);
+			mapActivity.findViewById(R.id.map_hud_layout).setVisibility(View.INVISIBLE);
 		} else {
 			animateMapControls(false);
 		}
@@ -218,10 +187,9 @@ public void hideMapControls() {
 
 	private void animateMapControls(boolean show) {
 		MapActivity mapActivity = requireMapActivity();
-		View mapHudButtonsOverlay = mapActivity.findViewById(R.id.MapHudButtonsOverlay);
+		View mapHudLayout = mapActivity.findViewById(R.id.map_hud_layout);
 		View mapHudButtonsTop = mapActivity.findViewById(R.id.MapHudButtonsOverlayTop);
 		View mapHudButtonsBottom = mapActivity.findViewById(R.id.MapHudButtonsOverlayBottom);
-		View mapHudButtonsQuickActions = mapActivity.findViewById(R.id.MapHudButtonsOverlayQuickActions);
 
 		float transTopInitial = show ? -mapHudButtonsTop.getHeight() : 0;
 		float transBottomInitial = show ? mapHudButtonsBottom.getHeight() : 0;
@@ -233,16 +201,16 @@ private void animateMapControls(boolean show) {
 
 		AnimatorSet set = new AnimatorSet();
 		set.setDuration(300).playTogether(
+				ObjectAnimator.ofFloat(mapHudLayout, View.ALPHA, alphaInitial, alphaFinal),
 				ObjectAnimator.ofFloat(mapHudButtonsTop, View.TRANSLATION_Y, transTopInitial, transTopFinal),
-				ObjectAnimator.ofFloat(mapHudButtonsBottom, View.TRANSLATION_Y, transBottomInitial, transBottomFinal),
-				ObjectAnimator.ofFloat(mapHudButtonsQuickActions, View.ALPHA, alphaInitial, alphaFinal)
+				ObjectAnimator.ofFloat(mapHudButtonsBottom, View.TRANSLATION_Y, transBottomInitial, transBottomFinal)
 		);
 		set.addListener(new AnimatorListenerAdapter() {
 			@Override
 			public void onAnimationStart(Animator animation) {
 				super.onAnimationStart(animation);
 				if (show) {
-					mapHudButtonsOverlay.setVisibility(View.VISIBLE);
+					mapHudLayout.setVisibility(View.VISIBLE);
 				}
 			}
 
@@ -250,10 +218,10 @@ public void onAnimationStart(Animator animation) {
 			public void onAnimationEnd(Animator animation) {
 				super.onAnimationEnd(animation);
 				if (!show) {
-					mapHudButtonsOverlay.setVisibility(View.INVISIBLE);
+					mapHudLayout.setVisibility(View.INVISIBLE);
 					mapHudButtonsTop.setTranslationY(transTopInitial);
 					mapHudButtonsBottom.setTranslationY(transBottomInitial);
-					mapHudButtonsQuickActions.setAlpha(alphaInitial);
+					mapHudLayout.setAlpha(alphaInitial);
 				}
 				mapActivity.updateStatusBarColor();
 			}
@@ -263,7 +231,7 @@ public void onAnimationEnd(Animator animation) {
 
 	public boolean isMapControlsVisible() {
 		MapActivity mapActivity = requireMapActivity();
-		return mapActivity.findViewById(R.id.MapHudButtonsOverlay).getVisibility() == View.VISIBLE;
+		return mapActivity.findViewById(R.id.map_hud_layout).getVisibility() == View.VISIBLE;
 	}
 
 	public void switchMapControlsVisibility(boolean switchNavBarVisibility) {
@@ -305,10 +273,10 @@ public void refreshButtons() {
 
 	@Override
 	public void onDraw(Canvas canvas, RotatedTileBox tileBox, DrawSettings nightMode) {
-		updateControls(tileBox, nightMode);
+		updateControls(nightMode);
 	}
 
-	private void updateControls(@NonNull RotatedTileBox tileBox, DrawSettings drawSettings) {
+	private void updateControls(@Nullable DrawSettings drawSettings) {
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity == null) {
 			return;
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
index 5fbd3e2c511..26e44ec4341 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapQuickActionLayer.java
@@ -10,7 +10,6 @@
 import android.graphics.PointF;
 import android.view.LayoutInflater;
 import android.view.View;
-import android.view.ViewGroup;
 import android.widget.FrameLayout;
 import android.widget.ImageView;
 
@@ -40,6 +39,7 @@
 import net.osmand.plus.utils.NativeUtilities;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.OsmandMapTileView;
+import net.osmand.plus.views.controls.MapHudLayout;
 import net.osmand.plus.views.controls.maphudbuttons.QuickActionButton;
 import net.osmand.plus.views.layers.base.OsmandMapLayer;
 import net.osmand.plus.views.mapwidgets.configure.buttons.QuickActionButtonState;
@@ -63,6 +63,8 @@ public class MapQuickActionLayer extends OsmandMapLayer implements QuickActionUp
 
 	private List<QuickActionButton> actionButtons = new ArrayList<>();
 	private List<QuickActionButtonState> mapButtonStates = new ArrayList<>();
+
+	private MapHudLayout mapHudLayout;
 	private QuickActionButton selectedButton;
 	private QuickActionsWidget quickActionsWidget;
 
@@ -107,10 +109,13 @@ protected void updateResources() {
 	public void setMapActivity(@Nullable MapActivity mapActivity) {
 		super.setMapActivity(mapActivity);
 		if (mapActivity != null) {
-			updateButtons();
 			isLayerOn = mapButtonsHelper.hasEnabledButtons();
+			mapHudLayout = mapActivity.findViewById(R.id.map_hud_layout);
 			quickActionsWidget = mapActivity.findViewById(R.id.quick_action_widget);
+
+			updateButtons();
 		} else {
+			mapHudLayout = null;
 			quickActionsWidget = null;
 			actionButtons = new ArrayList<>();
 		}
@@ -121,20 +126,20 @@ private void updateButtons() {
 		if (activity != null) {
 			boolean nightMode = app.getDaynightHelper().isNightMode();
 			LayoutInflater inflater = UiUtilities.getInflater(activity, nightMode);
-			ViewGroup container = activity.findViewById(R.id.MapHudButtonsOverlay);
+
 			for (QuickActionButton button : actionButtons) {
-				container.removeView(button);
+				mapHudLayout.removeView(button);
 			}
 
 			List<QuickActionButton> buttons = new ArrayList<>();
 			List<QuickActionButtonState> buttonStates = mapButtonsHelper.getButtonsStates();
 			for (QuickActionButtonState state : buttonStates) {
-				QuickActionButton button = (QuickActionButton) inflater.inflate(R.layout.map_quick_actions_button, container, false);
+				QuickActionButton button = (QuickActionButton) inflater.inflate(R.layout.map_quick_actions_button, mapHudLayout, false);
 				button.setButtonState(state);
 				button.setMapActivity(activity);
 				button.setUseCustomPosition(true);
 
-				container.addView(button, new FrameLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT, BOTTOM | END));
+				mapHudLayout.addView(button, new FrameLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT, BOTTOM | END));
 				buttons.add(button);
 			}
 			actionButtons = buttons;
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/MarkersWidgetsHelper.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/MarkersWidgetsHelper.java
index 57b3b18234e..0c53c3a0e49 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/MarkersWidgetsHelper.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/MarkersWidgetsHelper.java
@@ -64,7 +64,7 @@ public int getMapMarkersBarWidgetHeight() {
 
 	public boolean isMapMarkersBarWidgetVisible() {
 		boolean visible = isBarWidgetsVisible();
-		return visible && mapActivity.findViewById(R.id.MapHudButtonsOverlay).getVisibility() == View.VISIBLE;
+		return visible && mapActivity.findViewById(R.id.map_hud_layout).getVisibility() == View.VISIBLE;
 	}
 
 	private boolean isBarWidgetsVisible() {
