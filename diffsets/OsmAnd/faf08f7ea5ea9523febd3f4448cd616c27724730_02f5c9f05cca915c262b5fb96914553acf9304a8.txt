diff --git a/OsmAnd/src/net/osmand/plus/resources/ResourceManager.java b/OsmAnd/src/net/osmand/plus/resources/ResourceManager.java
index 12639321d8e..321346f2713 100644
--- a/OsmAnd/src/net/osmand/plus/resources/ResourceManager.java
+++ b/OsmAnd/src/net/osmand/plus/resources/ResourceManager.java
@@ -115,8 +115,8 @@ public class ResourceManager {
 	private final List<ResourceListener> resourceListeners = new ArrayList<>();
 
 	public interface ResourceListener {
-
 		void onMapsIndexed();
+		void onMapClosed();
 	}
 
 	// Indexes
@@ -238,6 +238,8 @@ public void setUseForPublicTransport(boolean useForPublicTransport) {
 	protected final Map<String, String> indexFileNames = new ConcurrentHashMap<>();
 	protected final Map<String, File> indexFiles = new ConcurrentHashMap<>();
 	protected final Map<String, String> basemapFileNames = new ConcurrentHashMap<>();
+	private final Map<String, String> backupedFileNames = new ConcurrentHashMap<>();
+	private boolean isMapChanged = false;
 
 	protected final IncrementalChangesManager changesManager = new IncrementalChangesManager(this);
 
@@ -322,6 +324,14 @@ public boolean checkIfObjectDownloaded(String downloadName) {
 		return indexFileNames.containsKey(regionName) || indexFileNames.containsKey(roadsRegionName);
 	}
 
+	public boolean checkIfObjectBackuped(String downloadName) {
+		final String regionName = Algorithms.capitalizeFirstLetterAndLowercase(downloadName)
+				+ IndexConstants.BINARY_MAP_INDEX_EXT;
+		final String roadsRegionName = Algorithms.capitalizeFirstLetterAndLowercase(downloadName) + ".road"
+				+ IndexConstants.BINARY_MAP_INDEX_EXT;
+		return backupedFileNames.containsKey(regionName) || backupedFileNames.containsKey(roadsRegionName);
+	}
+
 	public List<MapTileLayerSize> getMapTileLayerSizes() {
 		return mapTileLayerSizes;
 	}
@@ -1023,6 +1033,8 @@ public List<String> indexingMaps(@Nullable IProgress progress, @NonNull List<Fil
 				log.error("Index file could not be written", e);
 			}
 		}
+		backupedFileNames.clear();
+		getBackupIndexes(backupedFileNames);
 		for (ResourceListener l : resourceListeners) {
 			l.onMapsIndexed();
 		}
@@ -1357,6 +1369,9 @@ public void closeFile(String fileName) {
 		if (resource != null) {
 			resource.close();
 		}
+		for (ResourceListener l : resourceListeners) {
+			l.onMapClosed();
+		}
 	}
 
 	public synchronized void close() {
diff --git a/OsmAnd/src/net/osmand/plus/search/QuickSearchHelper.java b/OsmAnd/src/net/osmand/plus/search/QuickSearchHelper.java
index d2733255a1b..b3fcb0622db 100644
--- a/OsmAnd/src/net/osmand/plus/search/QuickSearchHelper.java
+++ b/OsmAnd/src/net/osmand/plus/search/QuickSearchHelper.java
@@ -680,6 +680,10 @@ public void onMapsIndexed() {
 		mapsIndexed = true;
 	}
 
+	@Override
+	public void onMapClosed() {
+	}
+
 	public static void showPoiFilterOnMap(@NonNull final MapActivity mapActivity,
 										  @NonNull final PoiUIFilter filter,
 										  @Nullable final Runnable action) {
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/DownloadedRegionsLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/DownloadedRegionsLayer.java
index bada803b039..360b2d047a3 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/DownloadedRegionsLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/DownloadedRegionsLayer.java
@@ -15,7 +15,6 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
-import net.osmand.IndexConstants;
 import net.osmand.binary.BinaryMapDataObject;
 import net.osmand.binary.BinaryMapIndexReader.TagValuePair;
 import net.osmand.core.android.MapRendererView;
@@ -55,10 +54,10 @@
 import net.osmand.util.Algorithms;
 import net.osmand.util.MapUtils;
 
-import java.io.File;
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Collections;
+import java.util.HashMap;
 import java.util.Iterator;
 import java.util.LinkedHashMap;
 import java.util.LinkedList;
@@ -110,7 +109,7 @@ public class DownloadedRegionsLayer extends OsmandMapLayer implements IContextMe
 	private int polygonId = 1;
 	private boolean needRedrawOpenGL = false;
 	private boolean indexRegionBoundaries = false;
-	private boolean onMapIndexed = false;
+	private boolean onMapsChanged = false;
 
 	public static class DownloadMapObject {
 		private final BinaryMapDataObject dataObject;
@@ -249,7 +248,7 @@ public void onPrepareBufferImage(Canvas canvas, RotatedTileBox tileBox, DrawSett
 					List<BinaryMapDataObject> backupedObjects = new ArrayList<>();
 					for (BinaryMapDataObject o : currentObjects) {
 						boolean downloaded = rm.checkIfObjectDownloaded(osmandRegions.getDownloadName(o));
-						boolean backuped = checkIfObjectBackuped(osmandRegions.getDownloadName(o));
+						boolean backuped = rm.checkIfObjectBackuped(osmandRegions.getDownloadName(o));
 						if (downloaded) {
 							downloadedObjects.add(o);
 						} else if (backuped) {
@@ -393,15 +392,6 @@ private void drawBorders(Canvas canvas, RotatedTileBox tileBox, final List<Binar
 		canvas.drawPath(path, paint);
 	}
 
-	private boolean checkIfObjectBackuped(String downloadName) {
-		File fileDir = app.getAppPath(IndexConstants.BACKUP_INDEX_DIR);
-		final String regionName = Algorithms.capitalizeFirstLetterAndLowercase(downloadName)
-				+ IndexConstants.BINARY_MAP_INDEX_EXT;
-		final String roadsRegionName = Algorithms.capitalizeFirstLetterAndLowercase(downloadName) + ".road"
-				+ IndexConstants.BINARY_MAP_INDEX_EXT;
-		return new File(fileDir, regionName).exists() || new File(fileDir, roadsRegionName).exists();
-	}
-
 	private List<BinaryMapDataObject> queryData(@NonNull QuadRect latLonBounds, int zoom) {
 		if (zoom >= ZOOM_AFTER_BASEMAP) {
 			if (!checkIfMapEmpty(zoom)) {
@@ -684,9 +674,9 @@ private void drawMapPolygons(int zoom) {
 		if (mapRenderer == null) {
 			return;
 		}
-		if (onMapIndexed) {
+		if (onMapsChanged) {
 			clearPolygonsCollections();
-			onMapIndexed = false;
+			onMapsChanged = false;
 		}
 		if (polygonsCollection != null && selectedSize == selectedObjects.size()) {
 			return;
@@ -712,7 +702,7 @@ private void drawMapPolygons(int zoom) {
 				String n = wr.getRegionDownloadName();
 				if (rm.checkIfObjectDownloaded(n)) {
 					downloadedRegions.add(wr);
-				} else if (checkIfObjectBackuped(n)) {
+				} else if (rm.checkIfObjectBackuped(n)) {
 					backupedRegions.add(wr);
 				}
 			}
@@ -743,6 +733,7 @@ private void addToPolygonsCollection(List<WorldRegion> regionList, Paint paint)
 		if (polygonsCollection == null) {
 			polygonsCollection = new PolygonsCollection();
 		}
+		int baseOrder = getBaseOrder();
 		for (WorldRegion wr : regionList) {
 			List<LatLon> polygon = wr.getPolygon();
 			QVectorPointI points = new QVectorPointI();
@@ -803,6 +794,11 @@ public void onFinish(AppInitializer init) {
 
 	@Override
 	public void onMapsIndexed() {
-		onMapIndexed = true;
+		onMapsChanged = true;
+	}
+
+	@Override
+	public void onMapClosed() {
+		onMapsChanged = true;
 	}
 }
