diff --git a/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java b/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
index 4dc57751763..cd027600924 100644
--- a/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
+++ b/OsmAnd/src/net/osmand/plus/dialogs/FavoriteDialogs.java
@@ -45,61 +45,6 @@ public class FavoriteDialogs {
 
 	public static final String KEY_FAVORITE = "favorite";
 
-	public static Dialog createReplaceFavouriteDialog(Activity activity, Bundle args) {
-		OsmandApplication app = (OsmandApplication) activity.getApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
-		Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
-		FavouritesHelper helper = app.getFavoritesHelper();
-		List<FavouritePoint> points = new ArrayList<>(helper.getFavouritePoints());
-		FavouritesAdapter favouritesAdapter = new FavouritesAdapter(activity, points, false);
-		Dialog[] dlgHolder = new Dialog[1];
-		OnItemClickListener click = (parent, view, position, id) -> confirmReplace(activity, args, helper, favouritesAdapter, dlgHolder, position);
-		favouritesAdapter.sortByDefault(true);
-
-		if (points.size() == 0) {
-			Toast.makeText(themedContext, activity.getString(R.string.fav_points_not_exist), Toast.LENGTH_SHORT).show();
-			return null;
-		}
-		return showFavoritesDialog(themedContext, favouritesAdapter, click, null, dlgHolder, true);
-	}
-
-	private static void confirmReplace(Activity activity, Bundle args, FavouritesHelper helper,
-	                                   FavouritesAdapter favouritesAdapter, Dialog[] dlgHolder, int position) {
-		OsmandApplication app = (OsmandApplication) activity.getApplication();
-		boolean nightMode = app.getDaynightHelper().isNightModeForMapControls();
-		Context themedContext = UiUtilities.getThemedContext(activity, nightMode);
-		AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
-		builder.setTitle(R.string.update_existing);
-		FavouritePoint fp = favouritesAdapter.getItem(position);
-		builder.setMessage(activity.getString(R.string.replace_favorite_confirmation, fp.getName()));
-		builder.setNegativeButton(R.string.shared_string_no, null);
-		builder.setPositiveButton(R.string.shared_string_yes, new OnClickListener() {
-
-			@Override
-			public void onClick(DialogInterface dialog, int which) {
-				if (dlgHolder != null && dlgHolder.length > 0 && dlgHolder[0] != null) {
-					dlgHolder[0].dismiss();
-				}
-				FavouritePoint point = (FavouritePoint) args.getSerializable(KEY_FAVORITE);
-				if (point != null && helper.editFavourite(fp, point.getLatitude(), point.getLongitude())) {
-					helper.deleteFavourite(point);
-					if (activity instanceof MapActivity) {
-						MapActivity mapActivity = (MapActivity) activity;
-						Fragment fragment = mapActivity.getSupportFragmentManager()
-								.findFragmentByTag(FavoritePointEditor.TAG);
-						if (fragment instanceof FavoritePointEditorFragment) {
-							((FavoritePointEditorFragment) fragment).exitEditing();
-						}
-						mapActivity.getContextMenu()
-								.show(new LatLon(point.getLatitude(), point.getLongitude()), fp.getPointDescription(activity), fp);
-						mapActivity.refreshMap();
-					}
-				}
-			}
-		});
-		builder.show();
-	}
-
 	public static void prepareAddFavouriteDialog(Activity activity, Dialog dialog, Bundle args, double lat, double lon, PointDescription desc) {
 		Resources resources = activity.getResources();
 		String name = desc == null ? "" : desc.getName();
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/SelectFavouriteToReplaceBottomSheet.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/SelectFavouriteToReplaceBottomSheet.java
new file mode 100644
index 00000000000..f49c3db5a06
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/SelectFavouriteToReplaceBottomSheet.java
@@ -0,0 +1,72 @@
+package net.osmand.plus.mapcontextmenu.editors;
+
+import android.app.Activity;
+import android.content.Context;
+import android.os.Bundle;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.appcompat.app.AlertDialog;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
+
+import net.osmand.data.FavouritePoint;
+import net.osmand.data.LatLon;
+import net.osmand.plus.R;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.mapcontextmenu.MapContextMenu;
+import net.osmand.plus.mapcontextmenu.other.SelectFavouriteBottomSheet;
+import net.osmand.plus.myplaces.FavouritesHelper;
+import net.osmand.plus.utils.UiUtilities;
+
+import static net.osmand.plus.dialogs.FavoriteDialogs.KEY_FAVORITE;
+
+public class SelectFavouriteToReplaceBottomSheet extends SelectFavouriteBottomSheet {
+
+	@Override
+	protected void onFavouriteSelected(@NonNull FavouritePoint favourite) {
+		showConfirmationDialog(favourite);
+	}
+
+	private void showConfirmationDialog(@NonNull FavouritePoint fp) {
+		boolean nightMode = isNightMode(mApp);
+		Context themedContext = UiUtilities.getThemedContext(getContext(), nightMode);
+		AlertDialog.Builder builder = new AlertDialog.Builder(themedContext);
+		builder.setTitle(R.string.update_existing);
+		builder.setMessage(getString(R.string.replace_favorite_confirmation, fp.getName()));
+		builder.setNegativeButton(R.string.shared_string_no, null);
+		builder.setPositiveButton(R.string.shared_string_yes, (dialog, which) -> {
+			onApplyReplacement(fp);
+		});
+		builder.show();
+	}
+
+	private void onApplyReplacement(@NonNull FavouritePoint fp) {
+		FavouritePoint point = (FavouritePoint) getArguments().getSerializable(KEY_FAVORITE);
+		FavouritesHelper helper = mApp.getFavoritesHelper();
+		if (point != null && helper.editFavourite(fp, point.getLatitude(), point.getLongitude())) {
+			helper.deleteFavourite(point);
+			Activity activity = getActivity();
+			if (activity instanceof MapActivity) {
+				MapActivity mapActivity = (MapActivity) activity;
+				FragmentManager fm = mapActivity.getSupportFragmentManager();
+				Fragment fragment = fm.findFragmentByTag(FavoritePointEditor.TAG);
+				if (fragment instanceof FavoritePointEditorFragment) {
+					((FavoritePointEditorFragment) fragment).exitEditing();
+				}
+				dismiss();
+				MapContextMenu contextMenu = mapActivity.getContextMenu();
+				contextMenu.show(new LatLon(point.getLatitude(), point.getLongitude()), fp.getPointDescription(activity), fp);
+				mapActivity.refreshMap();
+			}
+		}
+	}
+
+	public static void showInstance(@NonNull Activity activity, @Nullable Bundle args) {
+		SelectFavouriteToReplaceBottomSheet fragment = new SelectFavouriteToReplaceBottomSheet();
+		fragment.setArguments(args);
+		showFragment((FragmentActivity) activity, fragment);
+	}
+
+}
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/FavouritesBottomSheetMenuFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/FavouritesBottomSheetMenuFragment.java
deleted file mode 100644
index ab9334673ff..00000000000
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/FavouritesBottomSheetMenuFragment.java
+++ /dev/null
@@ -1,346 +0,0 @@
-package net.osmand.plus.mapcontextmenu.other;
-
-import android.app.Activity;
-import android.graphics.drawable.Drawable;
-import android.os.Bundle;
-import android.view.ContextThemeWrapper;
-import android.view.View;
-
-import androidx.annotation.NonNull;
-import androidx.fragment.app.Fragment;
-import androidx.recyclerview.widget.LinearLayoutManager;
-import androidx.recyclerview.widget.RecyclerView;
-
-import net.osmand.data.SpecialPointType;
-import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.Location;
-import net.osmand.data.FavouritePoint;
-import net.osmand.data.LatLon;
-import net.osmand.plus.myplaces.FavouritesHelper;
-import net.osmand.plus.myplaces.FavoritesListener;
-import net.osmand.plus.OsmAndLocationProvider;
-import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.R;
-import net.osmand.plus.helpers.TargetPointsHelper;
-import net.osmand.plus.activities.MapActivity;
-import net.osmand.plus.base.MenuBottomSheetDialogFragment;
-import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
-import net.osmand.plus.base.bottomsheetmenu.BottomSheetItemTitleWithDescrAndButton;
-import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu;
-import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu.PointType;
-import net.osmand.util.MapUtils;
-
-import java.text.Collator;
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.Comparator;
-import java.util.List;
-
-public class FavouritesBottomSheetMenuFragment extends MenuBottomSheetDialogFragment
-		implements OsmAndLocationProvider.OsmAndCompassListener, OsmAndLocationProvider.OsmAndLocationListener {
-
-	public static final String POINT_TYPE_KEY = "point_type";
-	public static final String TAG = "FavouritesBottomSheetMenuFragment";
-	private static final String IS_SORTED = "sorted";
-	private static final String SORTED_BY_TYPE = "sortedByType";
-	private static final int SORT_TYPE_DIST = 1;
-	private static final int SORT_TYPE_NAME = 2;
-	private static final int SORT_TYPE_CATEGORY = 3;
-	private static int getNextType(int type) {
-		return type % SORT_TYPE_CATEGORY + 1;
-	}
-
-	private final List<FavouritePoint> favouritePoints = new ArrayList<>();
-	private FavouritesAdapter adapter;
-	private RecyclerView recyclerView;
-	private int sortByDist = SORT_TYPE_DIST;
-	private boolean isSorted;
-	private boolean locationUpdateStarted;
-	private boolean compassUpdateAllowed = true;
-	private PointType pointType;
-	private Location location;
-	private float lastHeading;
-
-	private FavoritesListener favoritesListener;
-
-	@Override
-	public void createMenuItems(Bundle savedInstanceState) {
-		Bundle args = getArguments();
-		if (args != null) {
-			pointType = PointType.valueOf(args.getString(POINT_TYPE_KEY));
-		}
-		if (savedInstanceState != null && savedInstanceState.getBoolean(IS_SORTED)) {
-			sortByDist = savedInstanceState.getInt(SORTED_BY_TYPE);
-		}
-		adapter = new FavouritesAdapter(getMyApplication(), favouritePoints);
-		FavouritesHelper helper = getMyApplication().getFavoritesHelper();
-		if (helper.isFavoritesLoaded()) {
-			loadFavorites();
-		} else {
-			helper.addListener(favoritesListener = new FavoritesListener() {
-				@Override
-				public void onFavoritesLoaded() {
-					loadFavorites();
-					adapter.notifyDataSetChanged();
-				}
-
-				@Override
-				public void onFavoriteDataUpdated(@NonNull FavouritePoint point) {
-				}
-
-				@Override
-				public void onFavoritePropertiesUpdated() {
-				}
-			});
-		}
-		recyclerView = new RecyclerView(getContext());
-		int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
-		recyclerView = (RecyclerView) View.inflate(new ContextThemeWrapper(getContext(), themeRes),
-				R.layout.recyclerview, null);
-		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
-		sortFavourites();
-		BottomSheetItemTitleWithDescrAndButton[] title = new BottomSheetItemTitleWithDescrAndButton[1];
-		title[0] = (BottomSheetItemTitleWithDescrAndButton) new BottomSheetItemTitleWithDescrAndButton.Builder()
-				.setButtonIcons(null, getIconForButton(getNextType(sortByDist)))
-				.setButtonTitle(getTextForButton(getNextType(sortByDist)))
-				.setOnButtonClickListener(new View.OnClickListener() {
-					@Override
-					public void onClick(View v) {
-						sortByDist = getNextType(sortByDist);
-						sortFavourites();
-						int next = getNextType(sortByDist);
-						title[0].setButtonIcons(null, getIconForButton(next));
-						title[0].setButtonText(getTextForButton(next));
-						title[0].setDescription(getTextForButton(sortByDist));
-					}
-				})
-				.setDescription(getTextForButton(sortByDist))
-				.setTitle(getString(R.string.favourites))
-				.setLayoutId(R.layout.bottom_sheet_item_title_with_descr_and_button)
-				.create();
-		items.add(title[0]);
-
-		adapter.setItemClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				int position = recyclerView.getChildAdapterPosition(v);
-				if (position == RecyclerView.NO_POSITION) {
-					return;
-				}
-				selectFavorite(favouritePoints.get(position));
-			}
-		});
-		recyclerView.setAdapter(adapter);
-		recyclerView.addOnScrollListener(new RecyclerView.OnScrollListener() {
-			@Override
-			public void onScrollStateChanged(RecyclerView recyclerView, int newState) {
-				super.onScrollStateChanged(recyclerView, newState);
-				compassUpdateAllowed = newState == RecyclerView.SCROLL_STATE_IDLE;
-			}
-		});
-		items.add(new BaseBottomSheetItem.Builder()
-				.setCustomView(recyclerView)
-				.create());
-	}
-
-	private void loadFavorites() {
-		favouritePoints.clear();
-		favouritePoints.addAll(getMyApplication().getFavoritesHelper().getVisibleFavouritePoints());
-		if (favouritePoints.isEmpty()) {
-			favouritePoints.addAll(getMyApplication().getFavoritesHelper().getFavouritePoints());
-		}
-	}
-
-	private Drawable getIconForButton(int type) {
-		return getIcon(type == SORT_TYPE_DIST ? R.drawable.ic_action_list_sort : R.drawable.ic_action_sort_by_name,
-				nightMode ? R.color.multi_selection_menu_close_btn_dark : R.color.multi_selection_menu_close_btn_light);
-	}
-
-	private String getTextForButton(int sortByDist) {
-		int r = R.string.sort_by_distance;
-		if(sortByDist == SORT_TYPE_CATEGORY) {
-			r = R.string.sort_by_category;
-		} else if(sortByDist == SORT_TYPE_NAME) {
-			r = R.string.sort_by_name;
-		}
-		return getString(r);
-	}
-
-	private void selectFavorite(FavouritePoint point) {
-		OsmandApplication app = getMyApplication();
-		TargetPointsHelper targetPointsHelper = app.getTargetPointsHelper();
-		FavouritesHelper favorites = app.getFavoritesHelper();
-		LatLon ll = new LatLon(point.getLatitude(), point.getLongitude());
-		switch (pointType) {
-			case START:
-				targetPointsHelper.setStartPoint(ll, true, point.getPointDescription(app));
-				break;
-			case TARGET:
-				if (getActivity() != null) {
-					targetPointsHelper.navigateToPoint(ll, true, -1, point.getPointDescription(app));
-					OsmAndLocationProvider.requestFineLocationPermissionIfNeeded(getActivity());
-				}
-				break;
-			case INTERMEDIATE:
-				targetPointsHelper.navigateToPoint(ll, true, targetPointsHelper.getIntermediatePoints().size(), point.getPointDescription(app));
-				break;
-			case HOME:
-				favorites.setSpecialPoint(ll, SpecialPointType.HOME, null);
-				break;
-			case WORK:
-				favorites.setSpecialPoint(ll, SpecialPointType.WORK, null);
-				break;
-		}
-		MapRouteInfoMenu routeMenu = getMapRouteInfoMenu();
-		if (routeMenu != null) {
-			setupMapRouteInfoMenuSpinners(routeMenu);
-			updateMapRouteInfoMenuFromIcon(routeMenu);
-		}
-		Fragment fragment = getTargetFragment();
-		if (fragment != null) {
-			fragment.onActivityResult(getTargetRequestCode(), 0, null);
-		}
-		dismiss();
-	}
-
-	private void setupMapRouteInfoMenuSpinners(MapRouteInfoMenu routeMenu) {
-		if (routeMenu != null) {
-			routeMenu.setupFields(pointType);
-		}
-	}
-
-	private void updateMapRouteInfoMenuFromIcon(MapRouteInfoMenu routeMenu) {
-		if (pointType == PointType.START) {
-			routeMenu.updateFromIcon();
-		}
-	}
-
-	private MapRouteInfoMenu getMapRouteInfoMenu() {
-		Activity activity = getActivity();
-		if (activity instanceof MapActivity) {
-			MapActivity map = ((MapActivity) activity);
-			return map.getMapRouteInfoMenu();
-		} else {
-			return null;
-		}
-	}
-
-	@Override
-	public void onResume() {
-		super.onResume();
-		startLocationUpdate();
-	}
-
-	@Override
-	public void onPause() {
-		super.onPause();
-		stopLocationUpdate();
-		setupMapRouteInfoMenuSpinners(getMapRouteInfoMenu());
-		if (favoritesListener != null) {
-			getMyApplication().getFavoritesHelper().removeListener(favoritesListener);
-			favoritesListener = null;
-		}
-	}
-
-	@Override
-	public void updateLocation(Location location) {
-		if (!MapUtils.areLatLonEqual(this.location, location)) {
-			this.location = location;
-			updateLocationUi();
-		}
-	}
-
-	@Override
-	public void updateCompassValue(float value) {
-		if (Math.abs(MapUtils.degreesDiff(lastHeading, value)) > 5) {
-			lastHeading = value;
-			updateLocationUi();
-		}
-	}
-
-	private void updateLocationUi() {
-		if (!compassUpdateAllowed) {
-			return;
-		}
-		MapActivity mapActivity = (MapActivity) getActivity();
-		if (mapActivity != null && adapter != null) {
-			mapActivity.getMyApplication().runInUIThread(new Runnable() {
-				@Override
-				public void run() {
-					adapter.notifyDataSetChanged();
-				}
-			});
-		}
-	}
-
-	private void startLocationUpdate() {
-		OsmandApplication app = getMyApplication();
-		if (app != null && !locationUpdateStarted) {
-			locationUpdateStarted = true;
-			app.getLocationProvider().removeCompassListener(app.getLocationProvider().getNavigationInfo());
-			app.getLocationProvider().addCompassListener(this);
-			app.getLocationProvider().addLocationListener(this);
-			updateLocationUi();
-		}
-	}
-
-	private void stopLocationUpdate() {
-		OsmandApplication app = getMyApplication();
-		if (app != null && locationUpdateStarted) {
-			locationUpdateStarted = false;
-			app.getLocationProvider().removeLocationListener(this);
-			app.getLocationProvider().removeCompassListener(this);
-			app.getLocationProvider().addCompassListener(app.getLocationProvider().getNavigationInfo());
-		}
-	}
-
-	@Override
-	public void onSaveInstanceState(@NonNull Bundle outState) {
-		super.onSaveInstanceState(outState);
-		outState.putBoolean(IS_SORTED, isSorted);
-		outState.putInt(SORTED_BY_TYPE, sortByDist);
-	}
-
-	@Override
-	protected boolean useScrollableItemsContainer() {
-		return false;
-	}
-
-	private void sortFavourites() {
-		Collator inst = Collator.getInstance();
-		Location stale = getMyApplication().getLocationProvider().getLastStaleKnownLocation();
-		LatLon latLon = stale != null ? new LatLon(stale.getLatitude(), stale.getLongitude()) :
-			getMyApplication().getMapViewTrackingUtilities().getMapLocation();
-
-		Collections.sort(favouritePoints, new Comparator<FavouritePoint>() {
-			@Override
-			public int compare(FavouritePoint lhs, FavouritePoint rhs) {
-				if (sortByDist == SORT_TYPE_DIST && latLon != null) {
-					double ld = MapUtils.getDistance(latLon, lhs.getLatitude(),
-							lhs.getLongitude());
-					double rd = MapUtils.getDistance(latLon, rhs.getLatitude(),
-							rhs.getLongitude());
-					return Double.compare(ld, rd);
-				}
-
-				if(sortByDist == SORT_TYPE_CATEGORY) {
-					int cat = inst.compare(lhs.getCategoryDisplayName(getMyApplication()), rhs.getCategoryDisplayName(getMyApplication()));
-					if(cat != 0) {
-						return cat;
-					}
-				}
-				int name = inst.compare(lhs.getDisplayName(getMyApplication()), rhs.getDisplayName(getMyApplication()));
-				return name;
-			}
-		});
-
-		isSorted = true;
-		adapter.notifyDataSetChanged();
-		recyclerView.getLayoutManager().scrollToPosition(0);
-	}
-
-	@Override
-	protected int getCustomHeight() {
-		return AndroidUtils.dpToPx(getContext(), 300);
-	}
-}
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteBottomSheet.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteBottomSheet.java
new file mode 100644
index 00000000000..c2ed0844eec
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteBottomSheet.java
@@ -0,0 +1,284 @@
+package net.osmand.plus.mapcontextmenu.other;
+
+import android.graphics.drawable.Drawable;
+import android.os.Bundle;
+import android.view.ContextThemeWrapper;
+import android.view.View;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.DialogFragment;
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import net.osmand.Location;
+import net.osmand.data.FavouritePoint;
+import net.osmand.data.LatLon;
+import net.osmand.plus.OsmAndLocationProvider.OsmAndCompassListener;
+import net.osmand.plus.OsmAndLocationProvider.OsmAndLocationListener;
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.R;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.base.MenuBottomSheetDialogFragment;
+import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
+import net.osmand.plus.base.bottomsheetmenu.BottomSheetItemTitleWithDescrAndButton;
+import net.osmand.plus.myplaces.DefaultFavoritesListener;
+import net.osmand.plus.myplaces.FavoritesListener;
+import net.osmand.plus.myplaces.FavouritesHelper;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.util.MapUtils;
+
+import java.text.Collator;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+public abstract class SelectFavouriteBottomSheet extends MenuBottomSheetDialogFragment
+		implements OsmAndLocationListener, OsmAndCompassListener {
+
+	public static final String TAG = SelectFavouriteBottomSheet.class.getSimpleName();
+
+	private static final String IS_SORTED = "sorted";
+	private static final String SORTED_BY_TYPE = "sorted_by_type";
+
+	private static final int SORT_TYPE_DIST = 1;
+	private static final int SORT_TYPE_NAME = 2;
+	private static final int SORT_TYPE_CATEGORY = 3;
+
+	protected OsmandApplication mApp;
+	protected FavouritesHelper mFavouritesHelper;
+	private final List<FavouritePoint> mPoints = new ArrayList<>();
+
+	private FavouritesAdapter mAdapter;
+
+	protected boolean mIsSorted;
+	protected float mLastHeading;
+	protected Location mLocation;
+	protected boolean mLocationUpdateStarted;
+	protected int mSortByDist = SORT_TYPE_DIST;
+	protected boolean mCompassUpdateAllowed = true;
+
+	private RecyclerView rvPoints;
+
+	private FavoritesListener mFavouritesListener;
+
+	@Override
+	public void createMenuItems(@Nullable Bundle savedInstanceState) {
+		mApp = getMyApplication();
+		if (savedInstanceState != null && savedInstanceState.getBoolean(IS_SORTED)) {
+			mSortByDist = savedInstanceState.getInt(SORTED_BY_TYPE);
+		}
+		mAdapter = new FavouritesAdapter(mApp, mPoints);
+		mFavouritesHelper = mApp.getFavoritesHelper();
+		if (mFavouritesHelper.isFavoritesLoaded()) {
+			loadFavorites();
+		} else {
+			mFavouritesHelper.addListener(getFavouritesListener());
+		}
+		rvPoints = new RecyclerView(getContext());
+		int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
+		rvPoints = (RecyclerView) View.inflate(new ContextThemeWrapper(getContext(), themeRes),
+				R.layout.recyclerview, null);
+		rvPoints.setLayoutManager(new LinearLayoutManager(getContext()));
+		sortFavourites();
+		BottomSheetItemTitleWithDescrAndButton[] title = new BottomSheetItemTitleWithDescrAndButton[1];
+		title[0] = (BottomSheetItemTitleWithDescrAndButton) new BottomSheetItemTitleWithDescrAndButton.Builder()
+				.setButtonIcons(null, getIconForButton(getNextType(mSortByDist)))
+				.setButtonTitle(getTextForButton(getNextType(mSortByDist)))
+				.setOnButtonClickListener(v -> {
+					mSortByDist = getNextType(mSortByDist);
+					sortFavourites();
+					int next = getNextType(mSortByDist);
+					title[0].setButtonIcons(null, getIconForButton(next));
+					title[0].setButtonText(getTextForButton(next));
+					title[0].setDescription(getTextForButton(mSortByDist));
+				})
+				.setDescription(getTextForButton(mSortByDist))
+				.setTitle(getString(R.string.favourites))
+				.setLayoutId(R.layout.bottom_sheet_item_title_with_descr_and_button)
+				.create();
+		items.add(title[0]);
+
+		mAdapter.setItemClickListener(v -> {
+			int position = rvPoints.getChildAdapterPosition(v);
+			if (position == RecyclerView.NO_POSITION) {
+				return;
+			}
+			onFavouriteSelected(mPoints.get(position));
+		});
+		rvPoints.setAdapter(mAdapter);
+		rvPoints.addOnScrollListener(new RecyclerView.OnScrollListener() {
+			@Override
+			public void onScrollStateChanged(RecyclerView recyclerView, int newState) {
+				super.onScrollStateChanged(recyclerView, newState);
+				mCompassUpdateAllowed = newState == RecyclerView.SCROLL_STATE_IDLE;
+			}
+		});
+		items.add(new BaseBottomSheetItem.Builder()
+				.setCustomView(rvPoints)
+				.create());
+	}
+
+	private FavoritesListener getFavouritesListener() {
+		if (mFavouritesListener == null) {
+			mFavouritesListener = new DefaultFavoritesListener() {
+				@Override
+				public void onFavoritesLoaded() {
+					loadFavorites();
+					mAdapter.notifyDataSetChanged();
+				}
+			};
+		}
+		return mFavouritesListener;
+	}
+
+	private void loadFavorites() {
+		mPoints.clear();
+		mPoints.addAll(getMyApplication().getFavoritesHelper().getVisibleFavouritePoints());
+		if (mPoints.isEmpty()) {
+			mPoints.addAll(getMyApplication().getFavoritesHelper().getFavouritePoints());
+		}
+	}
+
+	private void sortFavourites() {
+		Collator inst = Collator.getInstance();
+		Location stale = mApp.getLocationProvider().getLastStaleKnownLocation();
+		LatLon latLon = stale != null ? new LatLon(stale.getLatitude(), stale.getLongitude()) :
+				mApp.getMapViewTrackingUtilities().getMapLocation();
+
+		Collections.sort(mPoints, (lhs, rhs) -> {
+			if (mSortByDist == SORT_TYPE_DIST && latLon != null) {
+				double ld = MapUtils.getDistance(latLon, lhs.getLatitude(),
+						lhs.getLongitude());
+				double rd = MapUtils.getDistance(latLon, rhs.getLatitude(),
+						rhs.getLongitude());
+				return Double.compare(ld, rd);
+			} else if (mSortByDist == SORT_TYPE_CATEGORY) {
+				int cat = inst.compare(lhs.getCategoryDisplayName(getMyApplication()), rhs.getCategoryDisplayName(getMyApplication()));
+				if(cat != 0) {
+					return cat;
+				}
+			}
+			int name = inst.compare(lhs.getDisplayName(getMyApplication()), rhs.getDisplayName(getMyApplication()));
+			return name;
+		});
+
+		mIsSorted = true;
+		mAdapter.notifyDataSetChanged();
+		rvPoints.getLayoutManager().scrollToPosition(0);
+	}
+
+	private Drawable getIconForButton(int type) {
+		return getIcon(type == SORT_TYPE_DIST ? R.drawable.ic_action_list_sort : R.drawable.ic_action_sort_by_name,
+				nightMode ? R.color.multi_selection_menu_close_btn_dark : R.color.multi_selection_menu_close_btn_light);
+	}
+
+	private String getTextForButton(int sortByDist) {
+		int r = R.string.sort_by_distance;
+		if(sortByDist == SORT_TYPE_CATEGORY) {
+			r = R.string.sort_by_category;
+		} else if(sortByDist == SORT_TYPE_NAME) {
+			r = R.string.sort_by_name;
+		}
+		return getString(r);
+	}
+
+	@Override
+	public void onSaveInstanceState(@NonNull Bundle outState) {
+		super.onSaveInstanceState(outState);
+		outState.putBoolean(IS_SORTED, mIsSorted);
+		outState.putInt(SORTED_BY_TYPE, mSortByDist);
+	}
+
+	private void startLocationUpdate() {
+		OsmandApplication app = getMyApplication();
+		if (app != null && !mLocationUpdateStarted) {
+			mLocationUpdateStarted = true;
+			app.getLocationProvider().removeCompassListener(app.getLocationProvider().getNavigationInfo());
+			app.getLocationProvider().addCompassListener(this);
+			app.getLocationProvider().addLocationListener(this);
+			updateLocationUi();
+		}
+	}
+
+	private void stopLocationUpdate() {
+		OsmandApplication app = getMyApplication();
+		if (app != null && mLocationUpdateStarted) {
+			mLocationUpdateStarted = false;
+			app.getLocationProvider().removeLocationListener(this);
+			app.getLocationProvider().removeCompassListener(this);
+			app.getLocationProvider().addCompassListener(app.getLocationProvider().getNavigationInfo());
+		}
+	}
+
+	private void updateLocationUi() {
+		if (!mCompassUpdateAllowed) {
+			return;
+		}
+		MapActivity mapActivity = (MapActivity) getActivity();
+		if (mapActivity != null && mAdapter != null) {
+			mapActivity.getMyApplication().runInUIThread(() -> {
+				mAdapter.notifyDataSetChanged();
+			});
+		}
+	}
+
+	@Override
+	public void updateLocation(@NonNull Location location) {
+		if (!MapUtils.areLatLonEqual(mLocation, location)) {
+			mLocation = location;
+			updateLocationUi();
+		}
+	}
+
+	@Override
+	public void updateCompassValue(float value) {
+		if (Math.abs(MapUtils.degreesDiff(mLastHeading, value)) > 5) {
+			mLastHeading = value;
+			updateLocationUi();
+		}
+	}
+
+	@Override
+	public void onResume() {
+		super.onResume();
+		startLocationUpdate();
+	}
+
+	@Override
+	public void onPause() {
+		super.onPause();
+		stopLocationUpdate();
+		if (mFavouritesListener != null) {
+			mApp.getFavoritesHelper().removeListener(mFavouritesListener);
+			mFavouritesListener = null;
+		}
+	}
+
+	@Override
+	protected boolean useScrollableItemsContainer() {
+		return false;
+	}
+
+	@Override
+	protected int getCustomHeight() {
+		return AndroidUtils.dpToPx(getContext(), 300);
+	}
+
+	private static int getNextType(int type) {
+		return type % SORT_TYPE_CATEGORY + 1;
+	}
+
+	public static void showFragment(@NonNull FragmentActivity activity,
+	                                @NonNull DialogFragment fragment) {
+		FragmentManager fm = activity.getSupportFragmentManager();
+		if (AndroidUtils.isFragmentCanBeAdded(fm, TAG)) {
+			fragment.show(fm, SelectFavouriteBottomSheet.TAG);
+		}
+	}
+
+	protected abstract void onFavouriteSelected(@NonNull FavouritePoint favourite);
+
+}
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteToGoBottomSheet.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteToGoBottomSheet.java
new file mode 100644
index 00000000000..6bd2d0a5825
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/other/SelectFavouriteToGoBottomSheet.java
@@ -0,0 +1,113 @@
+package net.osmand.plus.mapcontextmenu.other;
+
+import android.app.Activity;
+import android.os.Bundle;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+import net.osmand.data.FavouritePoint;
+import net.osmand.data.LatLon;
+import net.osmand.data.SpecialPointType;
+import net.osmand.plus.OsmAndLocationProvider;
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.helpers.TargetPointsHelper;
+import net.osmand.plus.myplaces.FavouritesHelper;
+import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu;
+import net.osmand.plus.routepreparationmenu.MapRouteInfoMenu.PointType;
+
+import static net.osmand.plus.routepreparationmenu.AddPointBottomSheetDialog.ADD_FAVORITE_TO_ROUTE_REQUEST_CODE;
+
+public class SelectFavouriteToGoBottomSheet extends SelectFavouriteBottomSheet {
+
+	public static final String POINT_TYPE_KEY = "point_type";
+
+	protected PointType mPointType;
+
+	@Override
+	public void createMenuItems(@Nullable @org.jetbrains.annotations.Nullable Bundle savedInstanceState) {
+		super.createMenuItems(savedInstanceState);
+		Bundle args = getArguments();
+		if (args != null) {
+			mPointType = PointType.valueOf(args.getString(POINT_TYPE_KEY));
+		}
+	}
+
+	@Override
+	protected void onFavouriteSelected(@NonNull FavouritePoint point) {
+		OsmandApplication app = getMyApplication();
+		TargetPointsHelper targetPointsHelper = app.getTargetPointsHelper();
+		FavouritesHelper favorites = app.getFavoritesHelper();
+		LatLon ll = new LatLon(point.getLatitude(), point.getLongitude());
+		switch (mPointType) {
+			case START:
+				targetPointsHelper.setStartPoint(ll, true, point.getPointDescription(app));
+				break;
+			case TARGET:
+				if (getActivity() != null) {
+					targetPointsHelper.navigateToPoint(ll, true, -1, point.getPointDescription(app));
+					OsmAndLocationProvider.requestFineLocationPermissionIfNeeded(getActivity());
+				}
+				break;
+			case INTERMEDIATE:
+				targetPointsHelper.navigateToPoint(ll, true, targetPointsHelper.getIntermediatePoints().size(), point.getPointDescription(app));
+				break;
+			case HOME:
+				favorites.setSpecialPoint(ll, SpecialPointType.HOME, null);
+				break;
+			case WORK:
+				favorites.setSpecialPoint(ll, SpecialPointType.WORK, null);
+				break;
+		}
+		MapRouteInfoMenu routeMenu = getMapRouteInfoMenu();
+		if (routeMenu != null) {
+			setupMapRouteInfoMenuSpinners(routeMenu);
+			updateMapRouteInfoMenuFromIcon(routeMenu);
+		}
+		Fragment fragment = getTargetFragment();
+		if (fragment != null) {
+			fragment.onActivityResult(getTargetRequestCode(), 0, null);
+		}
+		dismiss();
+	}
+
+	private void setupMapRouteInfoMenuSpinners(MapRouteInfoMenu routeMenu) {
+		if (routeMenu != null) {
+			routeMenu.setupFields(mPointType);
+		}
+	}
+
+	private void updateMapRouteInfoMenuFromIcon(MapRouteInfoMenu routeMenu) {
+		if (mPointType == PointType.START) {
+			routeMenu.updateFromIcon();
+		}
+	}
+
+	private MapRouteInfoMenu getMapRouteInfoMenu() {
+		Activity activity = getActivity();
+		if (activity instanceof MapActivity) {
+			MapActivity map = ((MapActivity) activity);
+			return map.getMapRouteInfoMenu();
+		} else {
+			return null;
+		}
+	}
+
+	@Override
+	public void onPause() {
+		super.onPause();
+		setupMapRouteInfoMenuSpinners(getMapRouteInfoMenu());
+	}
+
+	public static void showInstance(@NonNull MapActivity activity, @NonNull Fragment target, @NonNull PointType pointType) {
+		SelectFavouriteToGoBottomSheet fragment = new SelectFavouriteToGoBottomSheet();
+		Bundle args = new Bundle();
+		args.putString(POINT_TYPE_KEY, pointType.name());
+		fragment.setArguments(args);
+		fragment.setTargetFragment(target, ADD_FAVORITE_TO_ROUTE_REQUEST_CODE);
+		showFragment(activity, fragment);
+	}
+
+}
