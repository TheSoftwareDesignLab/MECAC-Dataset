diff --git a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
index 02c0b058894..4becd323637 100644
--- a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
@@ -12,7 +12,6 @@
 import android.view.ViewGroup;
 import android.view.ViewTreeObserver;
 import android.view.ViewTreeObserver.OnGlobalLayoutListener;
-import android.view.ViewTreeObserver.OnScrollChangedListener;
 import android.view.Window;
 import android.view.WindowManager;
 import android.widget.LinearLayout;
@@ -28,14 +27,14 @@
 import androidx.core.content.ContextCompat;
 import androidx.fragment.app.FragmentActivity;
 
-import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
-import net.osmand.plus.utils.UiUtilities;
-import net.osmand.plus.utils.UiUtilities.DialogButtonType;
 import net.osmand.plus.base.bottomsheetmenu.BaseBottomSheetItem;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.utils.UiUtilities;
+import net.osmand.plus.utils.UiUtilities.DialogButtonType;
 
 import java.util.ArrayList;
 import java.util.List;
@@ -210,13 +209,9 @@ public void onGlobalLayout() {
 		});
 	}
 
+	@NonNull
 	protected OnGlobalLayoutListener getShadowLayoutListener() {
-		return new OnGlobalLayoutListener() {
-			@Override
-			public void onGlobalLayout() {
-				setShadowOnScrollableView();
-			}
-		};
+		return this::setShadowOnScrollableView;
 	}
 
 	protected void drawTopShadow(boolean showTopShadow) {
@@ -389,12 +384,9 @@ private void setupDismissButton() {
 		int buttonTextId = getDismissButtonTextId();
 		if (buttonTextId != DEFAULT_VALUE) {
 			UiUtilities.setupDialogButton(nightMode, dismissButton, getDismissButtonType(), buttonTextId);
-			dismissButton.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					onDismissButtonClickAction();
-					dismiss();
-				}
+			dismissButton.setOnClickListener(v -> {
+				onDismissButtonClickAction();
+				dismiss();
 			});
 		}
 		AndroidUiHelper.updateVisibility(dismissButton, buttonTextId != DEFAULT_VALUE);
@@ -406,12 +398,7 @@ protected void setupRightButton() {
 		int buttonTextId = getRightBottomButtonTextId();
 		if (buttonTextId != DEFAULT_VALUE) {
 			UiUtilities.setupDialogButton(nightMode, rightButton, getRightBottomButtonType(), buttonTextId);
-			rightButton.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					onRightBottomButtonClick();
-				}
-			});
+			rightButton.setOnClickListener(v -> onRightBottomButtonClick());
 		}
 		View divider = buttonsContainer.findViewById(R.id.buttons_divider);
 		divider.getLayoutParams().height = getFirstDividerHeight();
@@ -429,12 +416,7 @@ protected void setupThirdButton() {
 		int buttonTextId = getThirdBottomButtonTextId();
 		if (buttonTextId != DEFAULT_VALUE) {
 			UiUtilities.setupDialogButton(nightMode, thirdButton, getThirdBottomButtonType(), buttonTextId);
-			thirdButton.setOnClickListener(new View.OnClickListener() {
-				@Override
-				public void onClick(View v) {
-					onThirdBottomButtonClick();
-				}
-			});
+			thirdButton.setOnClickListener(v -> onThirdBottomButtonClick());
 		}
 		View divider = buttonsContainer.findViewById(R.id.buttons_divider_top);
 		divider.getLayoutParams().height = getSecondDividerHeight();
@@ -500,16 +482,12 @@ private void setupScrollShadow(View view) {
 		} else {
 			scrollView = itemsContainer;
 		}
-		scrollView.getViewTreeObserver().addOnScrollChangedListener(new OnScrollChangedListener() {
-
-			@Override
-			public void onScrollChanged() {
-				boolean scrollToBottomAvailable = scrollView.canScrollVertically(1);
-				if (scrollToBottomAvailable) {
-					showShadowButton();
-				} else {
-					hideShadowButton();
-				}
+		scrollView.getViewTreeObserver().addOnScrollChangedListener(() -> {
+			boolean scrollToBottomAvailable = scrollView.canScrollVertically(1);
+			if (scrollToBottomAvailable) {
+				showShadowButton();
+			} else {
+				hideShadowButton();
 			}
 		});
 	}
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksComparator.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksComparator.java
index 2056942ca76..7047a28880b 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksComparator.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksComparator.java
@@ -12,7 +12,9 @@
 import net.osmand.OsmAndCollator;
 import net.osmand.data.LatLon;
 import net.osmand.gpx.GPXTrackAnalysis;
+import net.osmand.plus.myplaces.tracks.VisibleTracksGroup;
 import net.osmand.plus.settings.enums.TracksSortMode;
+import net.osmand.plus.track.data.TrackFolder;
 import net.osmand.plus.track.helpers.GPXDatabase.GpxDataItem;
 import net.osmand.util.MapUtils;
 
@@ -46,12 +48,36 @@ public int compare(Object o1, Object o2) {
 		if (o2 instanceof Integer) {
 			return 1;
 		}
+		if (o1 instanceof VisibleTracksGroup) {
+			return -1;
+		}
+		if (o2 instanceof VisibleTracksGroup) {
+			return 1;
+		}
+		if (o1 instanceof TrackFolder) {
+			return o2 instanceof TrackFolder ? compareTrackFolders((TrackFolder) o1, (TrackFolder) o2) : -1;
+		}
+		if (o2 instanceof TrackFolder) {
+			return 1;
+		}
 		if (o1 instanceof TrackItem && o2 instanceof TrackItem) {
 			return compareTrackItems((TrackItem) o1, (TrackItem) o2);
 		}
 		return 0;
 	}
 
+	private int compareTrackFolders(@NonNull TrackFolder folder1, @NonNull TrackFolder folder2) {
+		switch (sortMode) {
+			case NAME_ASCENDING:
+				return compareTrackFolderNames(folder1, folder2);
+			case NAME_DESCENDING:
+				return -compareTrackFolderNames(folder1, folder2);
+			case LAST_MODIFIED:
+				return compareFolderFilesByLastModified(folder1, folder2);
+		}
+		return compareTrackFolderNames(folder1, folder2);
+	}
+
 	private int compareTrackItems(@NonNull TrackItem item1, @NonNull TrackItem item2) {
 		Integer currentTrack = checkCurrentTrack(item1, item2);
 		if (currentTrack != null) {
@@ -63,7 +89,7 @@ private int compareTrackItems(@NonNull TrackItem item1, @NonNull TrackItem item2
 		GPXTrackAnalysis analysis1 = dataItem1 != null ? dataItem1.getAnalysis() : null;
 		GPXTrackAnalysis analysis2 = dataItem2 != null ? dataItem2.getAnalysis() : null;
 
-		if (shouldCheckAnalysis()) {
+		if (shouldCheckAnalysis() || analysis1 == null || analysis2 == null) {
 			Integer analysis = checkItemsAnalysis(item1, item2, analysis1, analysis2);
 			if (analysis != null) {
 				return analysis;
@@ -169,10 +195,32 @@ private int compareItemFilesByLastModified(@NonNull TrackItem item1, @NonNull Tr
 		if (file1.lastModified() == file2.lastModified()) {
 			return compareTrackItemNames(item1, item2);
 		}
+		return compareFilesByLastModified(file1, file2);
+	}
+
+	private int compareFolderFilesByLastModified(@NonNull TrackFolder folder1, @NonNull TrackFolder folder2) {
+		File file1 = folder1.getDirFile();
+		File file2 = folder2.getDirFile();
+
+		if (file1.lastModified() == file2.lastModified()) {
+			return compareTrackFolderNames(folder1, folder2);
+		}
+		return compareFilesByLastModified(file1, file2);
+	}
+
+	private int compareFilesByLastModified(@NonNull File file1, @NonNull File file2) {
 		return -Long.compare(file1.lastModified(), file2.lastModified());
 	}
 
 	private int compareTrackItemNames(@NonNull TrackItem item1, @NonNull TrackItem item2) {
-		return collator.compare(item1.getName(), item2.getName());
+		return compareNames(item1.getName(), item2.getName());
+	}
+
+	private int compareTrackFolderNames(@NonNull TrackFolder folder1, @NonNull TrackFolder folder2) {
+		return compareNames(folder1.getDirName(), folder2.getDirName());
+	}
+
+	private int compareNames(@NonNull String item1, @NonNull String item2) {
+		return collator.compare(item1, item2);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
index 4aced736abf..fc7f3379de4 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
@@ -200,6 +200,7 @@ public void showFolderOptionsMenu(@NonNull View view, @NonNull TrackFolder track
 						AddNewTrackFolderBottomSheet.showInstance(manager, null, this, isUsedOnMap());
 					}
 				})
+				.showTopDivider(true)
 				.create());
 
 		items.add(new PopUpMenuItem.Builder(app)
@@ -396,6 +397,10 @@ public void onTrackFolderAdd(String folderName) {
 		if (!dir.exists()) {
 			dir.mkdirs();
 		}
+		Fragment fragment = getTargetFragment();
+		if (fragment instanceof OnTrackFolderAddListener) {
+			((OnTrackFolderAddListener) fragment).onTrackFolderAdd(folderName);
+		}
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/TrackFolderFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/TrackFolderFragment.java
index f819d90411f..4b14a83ea76 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/TrackFolderFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/TrackFolderFragment.java
@@ -30,6 +30,8 @@ public class TrackFolderFragment extends BaseTrackFolderFragment {
 
 	public static final String TAG = TrackFolderFragment.class.getSimpleName();
 
+	private TextView toolbarTitle;
+
 	@Override
 	protected int getLayoutId() {
 		return R.layout.track_folder_fragment;
@@ -60,6 +62,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 
 	private void setupToolbar(@NonNull View view) {
 		Toolbar toolbar = view.findViewById(R.id.toolbar);
+		toolbarTitle = view.findViewById(R.id.toolbar_title);
 		ViewCompat.setElevation(view.findViewById(R.id.appbar), 5.0f);
 
 		ImageView closeButton = toolbar.findViewById(R.id.close_button);
@@ -114,11 +117,7 @@ private void dismiss() {
 	@Override
 	protected void updateContent() {
 		super.updateContent();
-		View view = getView();
-		if (view != null) {
-			TextView title = view.findViewById(R.id.toolbar_title);
-			title.setText(selectedFolder.getName(app));
-		}
+		toolbarTitle.setText(selectedFolder.getName(app));
 	}
 
 	@Override
@@ -128,8 +127,8 @@ public void onResume() {
 	}
 
 	@Override
-	public void onPause() {
-		super.onPause();
+	public void onDestroy() {
+		super.onDestroy();
 		updateActionBar(true);
 	}
 
