diff --git a/OsmAnd/res/layout/follow_track_options.xml b/OsmAnd/res/layout/follow_track_options.xml
index 69f0c467c39..123a7699e96 100644
--- a/OsmAnd/res/layout/follow_track_options.xml
+++ b/OsmAnd/res/layout/follow_track_options.xml
@@ -18,7 +18,7 @@
 			android:id="@+id/route_menu_top_shadow_all"
 			android:layout_width="match_parent"
 			android:layout_height="wrap_content"
-			android:background="?attr/card_and_list_background_basic"
+			android:background="?attr/bg_color"
 			android:minHeight="@dimen/bottom_sheet_title_height"
 			android:orientation="vertical">
 
diff --git a/OsmAnd/res/layout/import_track_card.xml b/OsmAnd/res/layout/import_track_card.xml
index 3f3ccf7d646..24ead3b9a6a 100644
--- a/OsmAnd/res/layout/import_track_card.xml
+++ b/OsmAnd/res/layout/import_track_card.xml
@@ -4,7 +4,7 @@
 	android:id="@+id/import_track_card"
 	android:layout_width="match_parent"
 	android:layout_height="wrap_content"
-	android:background="?attr/card_and_list_background_basic"
+	android:background="?attr/bg_color"
 	android:orientation="vertical">
 
 	<net.osmand.plus.widgets.TextViewEx
diff --git a/OsmAnd/res/layout/plan_route_threshold_slider.xml b/OsmAnd/res/layout/plan_route_threshold_slider.xml
index ec5bca31040..54fd7609d80 100644
--- a/OsmAnd/res/layout/plan_route_threshold_slider.xml
+++ b/OsmAnd/res/layout/plan_route_threshold_slider.xml
@@ -3,6 +3,7 @@
 	xmlns:osmand="http://schemas.android.com/apk/res-auto"
 	xmlns:tools="http://schemas.android.com/tools"
 	android:orientation="vertical"
+	android:background="?attr/bg_color"
 	android:layout_width="match_parent"
 	android:layout_height="match_parent">
 
diff --git a/OsmAnd/res/layout/track_appearance.xml b/OsmAnd/res/layout/track_appearance.xml
index 0be92d2bb0d..ca9b03d589d 100644
--- a/OsmAnd/res/layout/track_appearance.xml
+++ b/OsmAnd/res/layout/track_appearance.xml
@@ -18,7 +18,7 @@
 			android:id="@+id/route_menu_top_shadow_all"
 			android:layout_width="match_parent"
 			android:layout_height="wrap_content"
-			android:background="?attr/card_and_list_background_basic"
+			android:background="?attr/bg_color"
 			android:minHeight="@dimen/bottom_sheet_title_height"
 			android:orientation="vertical"
 			android:paddingLeft="@dimen/content_padding"
diff --git a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
index e1436bb400a..06ea4dbef95 100644
--- a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
@@ -47,10 +47,12 @@
 import net.osmand.plus.mapcontextmenu.InterceptorLinearLayout;
 import net.osmand.plus.views.controls.HorizontalSwipeConfirm;
 import net.osmand.plus.views.controls.SingleTapConfirm;
+import net.osmand.plus.views.layers.MapControlsLayer;
 
 import static net.osmand.plus.mapcontextmenu.MapContextMenuFragment.CURRENT_Y_UNDEFINED;
 
-public abstract class ContextMenuFragment extends BaseOsmAndFragment {
+public abstract class ContextMenuFragment extends BaseOsmAndFragment
+		implements MapControlsLayer.MapControlsThemeInfoProvider {
 
 	public static class MenuState {
 		public static final int HEADER_ONLY = 1;
@@ -174,10 +176,19 @@ public ViewGroup getTopView() {
 		return topView;
 	}
 
+	@Override
+	public boolean isNightModeForMapControls() {
+		return nightMode;
+	}
+
 	public boolean isNightMode() {
 		return nightMode;
 	}
 
+	protected String getThemeInfoProviderTag() {
+		return null;
+	}
+
 	public void updateNightMode() {
 		OsmandApplication app = getMyApplication();
 		if (app != null) {
@@ -597,6 +608,10 @@ public void onResume() {
 			if (!wasDrawerDisabled) {
 				mapActivity.disableDrawer();
 			}
+			String tag = getThemeInfoProviderTag();
+			if (tag != null) {
+				mapActivity.getMapLayers().getMapControlsLayer().addThemeInfoProviderTag(tag);
+			}
 		}
 	}
 
@@ -611,8 +626,14 @@ public void onPause() {
 			}
 		}
 		MapActivity mapActivity = getMapActivity();
-		if (!wasDrawerDisabled && mapActivity != null) {
-			mapActivity.enableDrawer();
+		if (mapActivity != null) {
+			if (!wasDrawerDisabled) {
+				mapActivity.enableDrawer();
+			}
+			String tag = getThemeInfoProviderTag();
+			if (tag != null) {
+				mapActivity.getMapLayers().getMapControlsLayer().removeThemeInfoProviderTag(tag);
+			}
 		}
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
index ef5d5790c9d..7625e5de208 100644
--- a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
@@ -3,7 +3,9 @@
 import android.app.Activity;
 import android.app.Dialog;
 import android.content.Context;
+import android.graphics.drawable.ColorDrawable;
 import android.graphics.drawable.Drawable;
+import android.graphics.drawable.LayerDrawable;
 import android.os.Build;
 import android.os.Bundle;
 import android.view.ContextThemeWrapper;
@@ -207,12 +209,12 @@ public void onGlobalLayout() {
 				// 8dp is the shadow height
 				boolean showTopShadow = screenHeight - statusBarHeight - mainView.getHeight() >= AndroidUtils.dpToPx(activity, 8);
 				if (AndroidUiHelper.isOrientationPortrait(activity)) {
-					mainView.setBackgroundResource(showTopShadow ? getPortraitBgResId() : getBgColorId());
+					AndroidUtils.setBackground(mainView, showTopShadow ? getPortraitBg(activity) : getColoredBg(activity));
 					if (!showTopShadow) {
 						mainView.setPadding(0, 0, 0, 0);
 					}
 				} else {
-					mainView.setBackgroundResource(showTopShadow ? getLandscapeTopsidesBgResId() : getLandscapeSidesBgResId());
+					AndroidUtils.setBackground(mainView, showTopShadow ? getLandscapeTopsidesBg(activity) : getLandscapeSidesBg(activity));
 				}
 			}
 		});
@@ -304,19 +306,27 @@ protected int getBgColorId() {
 		return nightMode ? R.color.list_background_color_dark : R.color.list_background_color_light;
 	}
 
-	@DrawableRes
-	protected int getPortraitBgResId() {
-		return nightMode ? R.drawable.bg_bottom_menu_dark : R.drawable.bg_bottom_menu_light;
+	protected Drawable getColoredBg(@NonNull Context ctx) {
+		int bgColor = ContextCompat.getColor(ctx, getBgColorId());
+		return new ColorDrawable(bgColor);
 	}
 
-	@DrawableRes
-	protected int getLandscapeTopsidesBgResId() {
-		return nightMode ? R.drawable.bg_bottom_sheet_topsides_landscape_dark : R.drawable.bg_bottom_sheet_topsides_landscape_light;
+	protected Drawable getPortraitBg(@NonNull Context ctx) {
+		return createBackgroundDrawable(ctx, R.drawable.bg_contextmenu_shadow_top_light);
 	}
 
-	@DrawableRes
-	protected int getLandscapeSidesBgResId() {
-		return nightMode ? R.drawable.bg_bottom_sheet_sides_landscape_dark : R.drawable.bg_bottom_sheet_sides_landscape_light;
+	protected Drawable getLandscapeTopsidesBg(@NonNull Context ctx) {
+		return createBackgroundDrawable(ctx, R.drawable.bg_shadow_bottomsheet_topsides);
+	}
+
+	protected Drawable getLandscapeSidesBg(@NonNull Context ctx) {
+		return createBackgroundDrawable(ctx, R.drawable.bg_shadow_bottomsheet_sides);
+	}
+
+	private LayerDrawable createBackgroundDrawable(@NonNull Context ctx, @DrawableRes int shadowDrawableResId) {
+		Drawable shadowDrawable = ContextCompat.getDrawable(ctx, shadowDrawableResId);
+		Drawable[] layers = new Drawable[]{shadowDrawable, getColoredBg(ctx)};
+		return new LayerDrawable(layers);
 	}
 
 	protected boolean isNightMode(@NonNull OsmandApplication app) {
diff --git a/OsmAnd/src/net/osmand/plus/dialogs/AddWaypointBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/dialogs/AddWaypointBottomSheetDialogFragment.java
index 2b8f7a07f55..fe3f6d5580c 100644
--- a/OsmAnd/src/net/osmand/plus/dialogs/AddWaypointBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/dialogs/AddWaypointBottomSheetDialogFragment.java
@@ -140,26 +140,6 @@ protected Drawable getActiveIcon(@DrawableRes int id) {
 		return getIcon(id, nightMode ? R.color.ctx_menu_direction_color_dark : R.color.map_widget_blue);
 	}
 
-	@Override
-	protected int getBgColorId() {
-		return nightMode ? R.color.list_background_color_dark : R.color.list_background_color_light;
-	}
-
-	@Override
-	protected int getPortraitBgResId() {
-		return nightMode ? R.drawable.bg_additional_menu_dark : R.drawable.bg_bottom_menu_light;
-	}
-
-	@Override
-	protected int getLandscapeTopsidesBgResId() {
-		return nightMode ? R.drawable.bg_additional_menu_topsides_dark : R.drawable.bg_bottom_sheet_topsides_landscape_light;
-	}
-
-	@Override
-	protected int getLandscapeSidesBgResId() {
-		return nightMode ? R.drawable.bg_additional_menu_sides_dark : R.drawable.bg_bottom_sheet_sides_landscape_light;
-	}
-
 	private Drawable getBackgroundIcon(@DrawableRes int resId) {
 		return getIcon(resId, nightMode ? R.color.text_color_secondary_dark : R.color.text_color_secondary_light);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/GpxApproximationFragment.java b/OsmAnd/src/net/osmand/plus/measurementtool/GpxApproximationFragment.java
index 393e43b31be..87edaaf71ba 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/GpxApproximationFragment.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/GpxApproximationFragment.java
@@ -233,16 +233,16 @@ private void updateCardsLayout() {
 			} else {
 				topShadow.setVisibility(View.VISIBLE);
 				AndroidUtils.setBackground(mainView.getContext(), bottomContainer, isNightMode(),
-						R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
+						R.color.list_background_color_light, R.color.list_background_color_dark);
 				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(),
-						R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
+						R.color.list_background_color_light, R.color.list_background_color_dark);
 			}
 		}
 	}
 
 	private void updateButtons(View view) {
 		View buttonsContainer = view.findViewById(R.id.buttons_container);
-		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.route_info_bg));
+		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.bg_color));
 		applyButton.setOnClickListener(new View.OnClickListener() {
 			@Override
 			public void onClick(View v) {
@@ -415,6 +415,11 @@ public boolean isCancelled() {
 		}
 	}
 
+	@Override
+	protected String getThemeInfoProviderTag() {
+		return TAG;
+	}
+
 	public interface GpxApproximationFragmentListener {
 
 		void onGpxApproximationDone(GpxRouteApproximation gpxApproximation, ApplicationMode mode);
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java b/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
index e2e4d795316..081c5098b12 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
@@ -78,6 +78,7 @@
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.views.controls.ReorderItemTouchHelperCallback;
+import net.osmand.plus.views.layers.MapControlsLayer;
 import net.osmand.plus.views.mapwidgets.MapInfoWidgetsFactory.TopToolbarController;
 import net.osmand.plus.views.mapwidgets.MapInfoWidgetsFactory.TopToolbarControllerType;
 import net.osmand.plus.views.mapwidgets.MapInfoWidgetsFactory.TopToolbarView;
@@ -107,7 +108,7 @@
 
 public class MeasurementToolFragment extends BaseOsmAndFragment implements RouteBetweenPointsFragmentListener,
 		OptionsFragmentListener, GpxApproximationFragmentListener, SelectedPointFragmentListener,
-		SaveAsNewTrackFragmentListener {
+		SaveAsNewTrackFragmentListener, MapControlsLayer.MapControlsThemeInfoProvider {
 
 	public static final String TAG = MeasurementToolFragment.class.getSimpleName();
 	public static final String TAPS_DISABLED_KEY = "taps_disabled_key";
@@ -529,6 +530,7 @@ public void onResume() {
 		super.onResume();
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
+			mapActivity.getMapLayers().getMapControlsLayer().addThemeInfoProviderTag(TAG);
 			mapActivity.getMapLayers().getMapControlsLayer().showMapControlsIfHidden();
 			cachedMapPosition = mapActivity.getMapView().getMapPosition();
 			setDefaultMapPosition();
@@ -539,6 +541,10 @@ public void onResume() {
 	@Override
 	public void onPause() {
 		super.onPause();
+		MapActivity mapActivity = getMapActivity();
+		if (mapActivity != null) {
+			mapActivity.getMapLayers().getMapControlsLayer().removeThemeInfoProviderTag(TAG);
+		}
 		setMapPosition(cachedMapPosition);
 	}
 
@@ -2052,4 +2058,8 @@ private void exitApproximationMode() {
 			AndroidUiHelper.setVisibility(mapActivity, View.VISIBLE, R.id.map_ruler_container);
 		}
 	}
+
+	public boolean isNightModeForMapControls() {
+		return nightMode;
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/SaveAsNewTrackBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/measurementtool/SaveAsNewTrackBottomSheetDialogFragment.java
index 40877bf8dc0..07c447f3d1d 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/SaveAsNewTrackBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/SaveAsNewTrackBottomSheetDialogFragment.java
@@ -68,6 +68,8 @@ public void createMenuItems(Bundle savedInstanceState) {
 		if (app == null) {
 			return;
 		}
+
+		int highlightColorId = nightMode ? R.color.list_background_color_dark : R.color.activity_background_color_light;
 		if (savedInstanceState != null) {
 			showOnMap = savedInstanceState.getBoolean(SHOW_ON_MAP_KEY);
 			simplifiedTrack = savedInstanceState.getBoolean(SIMPLIFIED_TRACK_KEY);
@@ -85,7 +87,7 @@ public void createMenuItems(Bundle savedInstanceState) {
 		View editNameView = View.inflate(UiUtilities.getThemedContext(app, nightMode),
 				R.layout.track_name_edit_text, null);
 		nameTextBox = editNameView.findViewById(R.id.name_text_box);
-		nameTextBox.setBoxBackgroundColorResource(R.color.material_text_input_layout_bg);
+		nameTextBox.setBoxBackgroundColorResource(highlightColorId);
 		nameTextBox.setHint(app.getString(R.string.ltr_or_rtl_combine_via_colon,
 				app.getString(R.string.shared_string_file_name), "").trim());
 		ColorStateList colorStateList = ColorStateList.valueOf(ContextCompat
@@ -190,14 +192,16 @@ private Drawable getBackground(boolean checked) {
 			GradientDrawable background = (GradientDrawable) AppCompatResources.getDrawable(app,
 					R.drawable.bg_select_group_button_outline);
 			if (background != null) {
-				int backgroundColor = AndroidUtils.getColorFromAttr(UiUtilities.getThemedContext(app, nightMode),
-						R.attr.activity_background_color);
+				int highlightColor = ContextCompat.getColor(app,nightMode ?
+						R.color.list_background_color_dark : R.color.activity_background_color_light);
+				int strokedColor = AndroidUtils.getColorFromAttr(UiUtilities.getThemedContext(app, nightMode),
+						R.attr.stroked_buttons_and_links_outline);
 				background = (GradientDrawable) background.mutate();
 				if (checked) {
 					background.setStroke(0, Color.TRANSPARENT);
-					background.setColor(backgroundColor);
+					background.setColor(highlightColor);
 				} else {
-					background.setStroke(app.getResources().getDimensionPixelSize(R.dimen.map_button_stroke), backgroundColor);
+					background.setStroke(app.getResources().getDimensionPixelSize(R.dimen.map_button_stroke), strokedColor);
 				}
 			}
 			return background;
@@ -328,6 +332,11 @@ private boolean isFileExist(String name) {
 		return false;
 	}
 
+	@Override
+	protected int getBgColorId() {
+		return nightMode ? R.color.activity_background_color_dark : R.color.list_background_color_light;
+	}
+
 	public interface SaveAsNewTrackFragmentListener {
 
 		void onSaveAsNewTrack(String folderName, String fileName, boolean showOnMap, boolean simplifiedTrack);
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
index 4f9214438e1..4884fe616cf 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
@@ -62,6 +62,7 @@
 import net.osmand.plus.routing.RouteProvider.GPXRouteParamsBuilder;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.views.layers.MapControlsLayer;
 
 import org.apache.commons.logging.Log;
 
@@ -69,7 +70,8 @@
 import java.util.List;
 
 
-public class FollowTrackFragment extends ContextMenuScrollFragment implements CardListener, IRouteInformationListener {
+public class FollowTrackFragment extends ContextMenuScrollFragment implements CardListener,
+		IRouteInformationListener, MapControlsLayer.MapControlsThemeInfoProvider {
 
 	public static final String TAG = FollowTrackFragment.class.getName();
 
@@ -556,15 +558,15 @@ private void updateCardsLayout() {
 				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.drawable.travel_card_bg_light, R.drawable.travel_card_bg_dark);
 			} else {
 				topShadow.setVisibility(View.VISIBLE);
-				AndroidUtils.setBackground(mainView.getContext(), bottomContainer, isNightMode(), R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
-				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
+				AndroidUtils.setBackground(mainView.getContext(), bottomContainer, isNightMode(), R.color.list_background_color_light, R.color.list_background_color_dark);
+				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.color.list_background_color_light, R.color.list_background_color_dark);
 			}
 		}
 	}
 
 	private void setupButtons(View view) {
 		View buttonsContainer = view.findViewById(R.id.buttons_container);
-		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.route_info_bg));
+		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.bg_color));
 
 		View cancelButton = view.findViewById(R.id.dismiss_button);
 		cancelButton.setOnClickListener(new View.OnClickListener() {
@@ -639,4 +641,9 @@ public void routeWasCancelled() {
 	public void routeWasFinished() {
 
 	}
+
+	@Override
+	protected String getThemeInfoProviderTag() {
+		return TAG;
+	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/ImportTrackCard.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/ImportTrackCard.java
index 78633b080ef..e8ac9e448e5 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/ImportTrackCard.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/ImportTrackCard.java
@@ -29,7 +29,8 @@ public int getCardLayoutId() {
 
 	@Override
 	protected void updateContent() {
-		int color = ContextCompat.getColor(app, R.color.preference_category_title);
+		int color = ContextCompat.getColor(app, nightMode ?
+				R.color.active_color_primary_dark : R.color.active_color_primary_light);
 		Typeface typeface = FontCache.getRobotoMedium(app);
 		String importTrack = app.getString(R.string.plan_route_import_track);
 		SpannableString spannable = UiUtilities.createCustomFontSpannable(typeface, importTrack, importTrack, importTrack);
diff --git a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/VehicleParametersBottomSheet.java b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/VehicleParametersBottomSheet.java
index ada5b139214..5ac7aea8e83 100644
--- a/OsmAnd/src/net/osmand/plus/settings/bottomsheets/VehicleParametersBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/settings/bottomsheets/VehicleParametersBottomSheet.java
@@ -23,6 +23,7 @@
 import androidx.fragment.app.FragmentManager;
 import androidx.recyclerview.widget.RecyclerView;
 
+import net.osmand.AndroidUtils;
 import net.osmand.PlatformUtil;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -196,13 +197,12 @@ private void drawTopShadow(boolean showTopShadow) {
 					return;
 				}
 				if (AndroidUiHelper.isOrientationPortrait(activity)) {
-					mainView.setBackgroundResource(showTopShadow ? getPortraitBgResId() : getBgColorId());
+					AndroidUtils.setBackground(mainView, showTopShadow ? getPortraitBg(activity) : getColoredBg(activity));
 					if (!showTopShadow) {
 						mainView.setPadding(0, 0, 0, 0);
 					}
 				} else {
-					mainView.setBackgroundResource(showTopShadow
-							? getLandscapeTopsidesBgResId() : getLandscapeSidesBgResId());
+					AndroidUtils.setBackground(mainView, showTopShadow ? getLandscapeTopsidesBg(activity) : getLandscapeSidesBg(activity));
 				}
 			}
 		};
diff --git a/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java b/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
index 53d49bd2a79..4381dd61f66 100644
--- a/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/TrackAppearanceFragment.java
@@ -432,15 +432,15 @@ private void updateCardsLayout() {
 				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.drawable.travel_card_bg_light, R.drawable.travel_card_bg_dark);
 			} else {
 				topShadow.setVisibility(View.VISIBLE);
-				AndroidUtils.setBackground(mainView.getContext(), bottomContainer, isNightMode(), R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
-				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.color.card_and_list_background_light, R.color.card_and_list_background_dark);
+				AndroidUtils.setBackground(mainView.getContext(), bottomContainer, isNightMode(), R.color.list_background_color_light, R.color.list_background_color_dark);
+				AndroidUtils.setBackground(mainView.getContext(), cardsContainer, isNightMode(), R.color.list_background_color_light, R.color.list_background_color_dark);
 			}
 		}
 	}
 
 	private void setupButtons(View view) {
 		View buttonsContainer = view.findViewById(R.id.buttons_container);
-		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.route_info_bg));
+		buttonsContainer.setBackgroundColor(AndroidUtils.getColorFromAttr(view.getContext(), R.attr.bg_color));
 		View saveButton = view.findViewById(R.id.right_bottom_button);
 		saveButton.setOnClickListener(new View.OnClickListener() {
 			@Override
@@ -720,6 +720,11 @@ public static int getArrowsIconId(String widthAttr) {
 		}
 	}
 
+	@Override
+	protected String getThemeInfoProviderTag() {
+		return TAG;
+	}
+
 	public interface OnNeedScrollListener {
 		void onVerticalScrollNeeded(int y);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
index 7663a4845b7..21277e24263 100644
--- a/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/layers/MapControlsLayer.java
@@ -28,6 +28,8 @@
 import androidx.core.view.ViewCompat;
 import androidx.core.view.ViewPropertyAnimatorCompat;
 import androidx.core.view.ViewPropertyAnimatorListener;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
 
 import com.google.android.material.slider.Slider;
 
@@ -69,8 +71,10 @@
 import net.osmand.plus.views.corenative.NativeCoreContext;
 
 import java.util.ArrayList;
+import java.util.HashSet;
 import java.util.Iterator;
 import java.util.List;
+import java.util.Set;
 
 import gnu.trove.list.array.TIntArrayList;
 
@@ -133,6 +137,7 @@ public MapHudButton createHudButton(View iv, int resId, String id) {
 	private boolean forceShowCompass;
 	private LatLon requestedLatLon;
 	private long compassPressed;
+	private Set<String> themeInfoProviderTags = new HashSet<>();
 
 	public MapControlsLayer(MapActivity activity) {
 		this.mapActivity = activity;
@@ -836,7 +841,7 @@ public boolean isPotrait() {
 	}
 
 	private void updateControls(@NonNull RotatedTileBox tileBox, DrawSettings drawSettings) {
-		boolean isNight = drawSettings != null && drawSettings.isNightMode();
+		boolean isNight = isNightModeForMapControls(drawSettings);
 		boolean portrait = isPotrait();
 //		int shadw = isNight ? mapActivity.getResources().getColor(R.color.widgettext_shadow_night) :
 //				mapActivity.getResources().getColor(R.color.widgettext_shadow_day);
@@ -916,6 +921,25 @@ private void updateControls(@NonNull RotatedTileBox tileBox, DrawSettings drawSe
 		}
 	}
 
+	private boolean isNightModeForMapControls(DrawSettings drawSettings) {
+		MapControlsThemeInfoProvider themeInfoProvider = getThemeInfoProvider();
+		if (themeInfoProvider != null) {
+			return themeInfoProvider.isNightModeForMapControls();
+		}
+		return drawSettings != null && drawSettings.isNightMode();
+	}
+
+	private MapControlsThemeInfoProvider getThemeInfoProvider() {
+		FragmentManager fm = mapActivity.getSupportFragmentManager();
+		for (String tag : themeInfoProviderTags) {
+			Fragment f = fm.findFragmentByTag(tag);
+			if (f instanceof MapControlsThemeInfoProvider) {
+				return (MapControlsThemeInfoProvider) f;
+			}
+		}
+		return null;
+	}
+
 	public void updateCompass(boolean isNight) {
 		float mapRotate = mapActivity.getMapView().getRotate();
 		boolean showCompass = shouldShowCompass();
@@ -1419,4 +1443,16 @@ public void onRequestPermissionsResult(int requestCode, String[] permissions, in
 			}
 		}
 	}
+
+	public void addThemeInfoProviderTag(String tag) {
+		themeInfoProviderTags.add(tag);
+	}
+
+	public void removeThemeInfoProviderTag(String tag) {
+		themeInfoProviderTags.remove(tag);
+	}
+
+	public interface MapControlsThemeInfoProvider {
+		boolean isNightModeForMapControls();
+	}
 }
