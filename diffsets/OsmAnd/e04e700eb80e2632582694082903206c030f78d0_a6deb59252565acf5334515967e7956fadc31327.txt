diff --git a/OsmAnd/src/net/osmand/plus/views/DoubleTapScaleDetector.java b/OsmAnd/src/net/osmand/plus/views/DoubleTapScaleDetector.java
index c2cf82004cc..e2d815f9102 100644
--- a/OsmAnd/src/net/osmand/plus/views/DoubleTapScaleDetector.java
+++ b/OsmAnd/src/net/osmand/plus/views/DoubleTapScaleDetector.java
@@ -8,6 +8,8 @@
 import android.view.MotionEvent;
 import android.view.ViewConfiguration;
 
+import androidx.annotation.NonNull;
+
 import net.osmand.PlatformUtil;
 import net.osmand.data.RotatedTileBox;
 import net.osmand.plus.views.layers.base.OsmandMapLayer;
@@ -15,7 +17,9 @@
 import org.apache.commons.logging.Log;
 
 public class DoubleTapScaleDetector {
+
 	private static final Log LOG = PlatformUtil.getLog(DoubleTapScaleDetector.class);
+
 	private static final int DOUBLE_TAP_TIMEOUT = ViewConfiguration.getDoubleTapTimeout();
 	private static final int LONG_PRESS_TIMEOUT = ViewConfiguration.getLongPressTimeout();
 	public static final int SCALE_PER_SCREEN = 4;
@@ -37,7 +41,7 @@ public class DoubleTapScaleDetector {
 	private boolean mIsDoubleTapping;
 	private boolean mScrolling;
 
-	public DoubleTapScaleDetector(OsmandMapTileView view, DoubleTapZoomListener listener) {
+	public DoubleTapScaleDetector(@NonNull OsmandMapTileView view, @NonNull Context ctx, @NonNull DoubleTapZoomListener listener) {
 		this.view = view;
 		this.listener = listener;
 
@@ -46,7 +50,7 @@ public DoubleTapScaleDetector(OsmandMapTileView view, DoubleTapZoomListener list
 		displayHeightPx = tileBox.getPixHeight();
 		zoomCenter = new PointF(centerScreen.x, centerScreen.y);
 
-		ViewConfiguration configuration = ViewConfiguration.get(view.getUiContext());
+		ViewConfiguration configuration = ViewConfiguration.get(ctx);
 		int touchSlop = configuration.getScaledTouchSlop();
 		mTouchSlopSquare = touchSlop * touchSlop;
 		int doubleTapSlop = (int) (configuration.getScaledDoubleTapSlop() * 0.5);
@@ -69,7 +73,7 @@ public boolean onTouchEvent(MotionEvent event) {
 				handled = true;
 			} else if (secondDown != null) {
 				if (calculateSqaredDistance(secondDown, event) < mDoubleTapSlopSquare
-					&& event.getEventTime() - secondDown.getEventTime() < LONG_PRESS_TIMEOUT) {
+						&& event.getEventTime() - secondDown.getEventTime() < LONG_PRESS_TIMEOUT) {
 					listener.onDoubleTap(event);
 				}
 				handled = true;
@@ -137,7 +141,7 @@ private int convertPxToDp(int px) {
 	}
 
 	private boolean isConsideredDoubleTap(MotionEvent firstDown, MotionEvent firstUp,
-										  MotionEvent secondDown) {
+	                                      MotionEvent secondDown) {
 		if (firstDown == null || firstUp == null || secondDown == null) {
 			return false;
 		}
@@ -148,7 +152,7 @@ private boolean isConsideredDoubleTap(MotionEvent firstDown, MotionEvent firstUp
 	}
 
 	private int calculateSqaredDistance(MotionEvent first,
-										   MotionEvent second) {
+	                                    MotionEvent second) {
 		int deltaXDown = (int) first.getX() - (int) second.getX();
 		int deltaYDown = (int) first.getY() - (int) second.getY();
 		return deltaXDown * deltaXDown + deltaYDown * deltaYDown;
diff --git a/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java b/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
index 94be863585b..88eeb97d3ec 100644
--- a/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
+++ b/OsmAnd/src/net/osmand/plus/views/MapViewWithLayers.java
@@ -14,12 +14,14 @@
 import net.osmand.plus.R;
 import net.osmand.plus.auto.NavigationSession;
 import net.osmand.plus.inapp.InAppPurchaseHelper;
-import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.views.corenative.NativeCoreContext;
 
 public class MapViewWithLayers extends FrameLayout {
 
+	private final OsmandApplication app;
+	private final OsmandMapTileView mapView;
+
 	private AtlasMapRendererView atlasMapRendererView;
 
 	public MapViewWithLayers(@NonNull Context context) {
@@ -37,19 +39,21 @@ public MapViewWithLayers(@NonNull Context context, @Nullable AttributeSet attrs,
 	public MapViewWithLayers(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
 		super(context, attrs, defStyleAttr, defStyleRes);
 
-		boolean nightMode = getMyApplication().getDaynightHelper().isNightMode();
+		app = getMyApplication();
+		mapView = app.getOsmandMap().getMapView();
+		mapView.setupTouchDetectors(getContext());
+
+		boolean nightMode = app.getDaynightHelper().isNightMode();
 		inflate(UiUtilities.getThemedContext(context, nightMode), R.layout.map_view_with_layers, this);
 	}
 
 	public void setupOpenGLView(boolean init) {
-		OsmandApplication app = getMyApplication();
-		OsmandSettings settings = app.getSettings();
-		OsmandMapTileView mapView = app.getOsmandMap().getMapView();
 		NavigationSession carNavigationSession = app.getCarNavigationSession();
 		View androidAutoPlaceholder = findViewById(R.id.AndroidAutoPlaceholder);
 		boolean useAndroidAuto = carNavigationSession != null && carNavigationSession.hasStarted()
 				&& InAppPurchaseHelper.isAndroidAutoAvailable(app);
-		if (settings.USE_OPENGL_RENDER.get() && NativeCoreContext.isInit()) {
+
+		if (app.getSettings().USE_OPENGL_RENDER.get() && NativeCoreContext.isInit()) {
 			ViewStub stub = findViewById(R.id.atlasMapRendererViewStub);
 			if (atlasMapRendererView == null) {
 				atlasMapRendererView = (AtlasMapRendererView) stub.inflate();
@@ -102,6 +106,7 @@ public void onDestroy() {
 		if (atlasMapRendererView != null) {
 			atlasMapRendererView.handleOnDestroy();
 		}
+		mapView.clearTouchDetectors();
 	}
 
 	public void onSetMapElevation(float angle) {
diff --git a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
index 575ac932d05..c4f4dff5f41 100644
--- a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
+++ b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
@@ -267,14 +267,6 @@ public void init(@NonNull Context ctx, int w, int h) {
 		elevationAngle = settings.getLastKnownMapElevation();
 	}
 
-	@Nullable
-	public Context getUiContext() {
-		if (mapActivity != null) {
-			return mapActivity;
-		}
-		return view != null ? view.getContext() : null;
-	}
-
 	@Nullable
 	public MapActivity getMapActivity() {
 		return mapActivity;
@@ -282,22 +274,17 @@ public MapActivity getMapActivity() {
 
 	public void setMapActivity(@Nullable MapActivity mapActivity) {
 		this.mapActivity = mapActivity;
-		if (mapActivity != null) {
-			setupTouchDetectors(mapActivity);
-		} else {
-			clearTouchDetectors();
-		}
 	}
 
 	public void setupTouchDetectors(@NonNull Context ctx) {
 		gestureDetector = new GestureDetector(ctx, new MapTileViewOnGestureListener());
 		multiTouchSupport = new MultiTouchSupport(application, new MapTileViewMultiTouchZoomListener());
-		doubleTapScaleDetector = new DoubleTapScaleDetector(this, new MapTileViewMultiTouchZoomListener());
+		doubleTapScaleDetector = new DoubleTapScaleDetector(this, ctx, new MapTileViewMultiTouchZoomListener());
 		twoFingersTapDetector = new TwoFingerTapDetector() {
 			@Override
 			public void onTwoFingerTap() {
 				//afterTwoFingersTap = true;
-				if (!mapGestureAllowed(OsmandMapLayer.MapGestureType.TWO_POINTERS_ZOOM_OUT)) {
+				if (!mapGestureAllowed(MapGestureType.TWO_POINTERS_ZOOM_OUT)) {
 					return;
 				}
 				if (isZoomingAllowed(getZoom(), -1.1f)) {
