diff --git a/OsmAnd/res/layout-land/fragment_direction_indication_dialog.xml b/OsmAnd/res/layout-land/fragment_direction_indication_dialog.xml
index 580849ddbdc..296d9ceac01 100644
--- a/OsmAnd/res/layout-land/fragment_direction_indication_dialog.xml
+++ b/OsmAnd/res/layout-land/fragment_direction_indication_dialog.xml
@@ -154,149 +154,6 @@
 
                 </LinearLayout>
 
-                <LinearLayout
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:layout_marginTop="@dimen/content_padding"
-                    android:background="?attr/bg_card"
-                    android:orientation="vertical"
-                    android:paddingBottom="4dp">
-
-                    <LinearLayout
-                        android:id="@+id/distance_indication_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_title_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding"
-	                    android:paddingStart="@dimen/content_padding"
-	                    android:paddingEnd="@dimen/content_padding">
-
-                        <TextView
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_gravity="center_vertical"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/show_direction"
-                            android:textAppearance="@style/TextAppearance.ListItemTitle"/>
-
-                        <androidx.appcompat.widget.SwitchCompat
-                            android:id="@+id/distance_indication_switch"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_gravity="center_vertical|end"
-                            android:layout_marginLeft="@dimen/bottom_sheet_content_margin_small"
-                            android:layout_marginStart="@dimen/bottom_sheet_content_margin_small"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"
-                            android:focusableInTouchMode="false"/>
-                    </LinearLayout>
-
-                    <View
-                        android:layout_width="match_parent"
-                        android:layout_height="1dp"
-                        android:layout_marginLeft="@dimen/content_padding"
-                        android:layout_marginStart="@dimen/content_padding"
-                        android:background="?attr/dashboard_divider"/>
-
-                    <TextView
-                        android:layout_width="match_parent"
-                        android:layout_height="wrap_content"
-                        android:layout_marginLeft="@dimen/content_padding"
-                        android:layout_marginRight="@dimen/content_padding"
-                        android:paddingBottom="@dimen/content_padding_small"
-                        android:paddingTop="@dimen/content_padding_small"
-                        android:text="@string/distance_indication_descr"
-                        android:textColor="?android:textColorSecondary"
-                        android:textSize="@dimen/default_desc_text_size"
-	                    android:layout_marginStart="@dimen/content_padding"
-	                    android:layout_marginEnd="@dimen/content_padding" />
-
-                    <LinearLayout
-                        android:id="@+id/top_bar_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_list_item_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:gravity="center_vertical"
-                        android:paddingEnd="@dimen/content_padding_small"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding_small"
-                        android:paddingStart="@dimen/content_padding">
-
-                        <androidx.appcompat.widget.AppCompatImageView
-                            android:id="@+id/top_bar_icon"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_marginEnd="@dimen/bottom_sheet_icon_margin"
-                            android:layout_marginRight="@dimen/bottom_sheet_icon_margin"
-                            tools:background="@drawable/ic_action_device_top"
-                            tools:src="@drawable/ic_action_device_topbar"/>
-
-                        <net.osmand.plus.widgets.TextViewEx
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/shared_string_topbar"
-                            android:textColor="?android:textColorPrimary"
-                            android:textSize="@dimen/default_list_text_size"
-                            osmand:typeface="@string/font_roboto_regular"/>
-
-                        <RadioButton
-                            android:id="@+id/top_bar_radio_button"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"/>
-                    </LinearLayout>
-
-                    <LinearLayout
-                        android:id="@+id/widget_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_list_item_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:gravity="center_vertical"
-                        android:paddingEnd="@dimen/content_padding_small"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding_small"
-                        android:paddingStart="@dimen/content_padding">
-
-                        <androidx.appcompat.widget.AppCompatImageView
-                            android:id="@+id/widget_icon"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_marginEnd="@dimen/bottom_sheet_icon_margin"
-                            android:layout_marginRight="@dimen/bottom_sheet_icon_margin"
-                            tools:background="@drawable/ic_action_device_top"
-                            tools:src="@drawable/ic_action_device_widget"/>
-
-                        <net.osmand.plus.widgets.TextViewEx
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/shared_string_widgets"
-                            android:textColor="?android:textColorPrimary"
-                            android:textSize="@dimen/default_list_text_size"
-                            osmand:typeface="@string/font_roboto_regular"/>
-
-                        <RadioButton
-                            android:id="@+id/widget_radio_button"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"/>
-                    </LinearLayout>
-
-                </LinearLayout>
-
                 <LinearLayout
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
diff --git a/OsmAnd/res/layout/fragment_direction_indication_dialog.xml b/OsmAnd/res/layout/fragment_direction_indication_dialog.xml
index 9993c5f8ae3..9acbb98050b 100644
--- a/OsmAnd/res/layout/fragment_direction_indication_dialog.xml
+++ b/OsmAnd/res/layout/fragment_direction_indication_dialog.xml
@@ -144,150 +144,6 @@
 
                 <include layout="@layout/list_item_divider"/>
 
-                <LinearLayout
-                    android:layout_width="match_parent"
-                    android:layout_height="wrap_content"
-                    android:background="?attr/bg_color"
-                    android:orientation="vertical"
-                    android:paddingBottom="4dp">
-
-                    <LinearLayout
-                        android:id="@+id/distance_indication_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_title_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding"
-	                    android:paddingStart="@dimen/content_padding"
-	                    android:paddingEnd="@dimen/content_padding">
-
-                        <TextView
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_gravity="center_vertical"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/show_direction"
-                            android:textAppearance="@style/TextAppearance.ListItemTitle"/>
-
-                        <androidx.appcompat.widget.SwitchCompat
-                            android:id="@+id/distance_indication_switch"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_gravity="center_vertical|end"
-                            android:layout_marginLeft="@dimen/bottom_sheet_content_margin_small"
-                            android:layout_marginStart="@dimen/bottom_sheet_content_margin_small"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"
-                            android:focusableInTouchMode="false"/>
-                    </LinearLayout>
-
-                    <View
-                        android:layout_width="match_parent"
-                        android:layout_height="1dp"
-                        android:layout_marginLeft="@dimen/content_padding"
-                        android:layout_marginStart="@dimen/content_padding"
-                        android:background="?attr/dashboard_divider"/>
-
-                    <TextView
-                        android:layout_width="match_parent"
-                        android:layout_height="wrap_content"
-                        android:layout_marginLeft="@dimen/content_padding"
-                        android:layout_marginRight="@dimen/content_padding"
-                        android:paddingBottom="@dimen/content_padding_small"
-                        android:paddingTop="@dimen/content_padding_small"
-                        android:text="@string/distance_indication_descr"
-                        android:textColor="?android:textColorSecondary"
-                        android:textSize="@dimen/default_desc_text_size"
-	                    android:layout_marginEnd="@dimen/content_padding"
-	                    android:layout_marginStart="@dimen/content_padding" />
-
-                    <LinearLayout
-                        android:id="@+id/top_bar_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_list_item_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:gravity="center_vertical"
-                        android:paddingEnd="@dimen/content_padding_small"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding_small"
-                        android:paddingStart="@dimen/content_padding">
-
-                        <androidx.appcompat.widget.AppCompatImageView
-                            android:id="@+id/top_bar_icon"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_marginEnd="@dimen/bottom_sheet_icon_margin"
-                            android:layout_marginRight="@dimen/bottom_sheet_icon_margin"
-                            tools:background="@drawable/ic_action_device_top"
-                            tools:src="@drawable/ic_action_device_topbar"/>
-
-                        <net.osmand.plus.widgets.TextViewEx
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/shared_string_topbar"
-                            android:textColor="?android:textColorPrimary"
-                            android:textSize="@dimen/default_list_text_size"
-                            osmand:typeface="@string/font_roboto_regular"/>
-
-                        <RadioButton
-                            android:id="@+id/top_bar_radio_button"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"/>
-                    </LinearLayout>
-
-                    <LinearLayout
-                        android:id="@+id/widget_row"
-                        android:layout_width="match_parent"
-                        android:layout_height="@dimen/bottom_sheet_list_item_height"
-                        android:background="?attr/selectableItemBackground"
-                        android:gravity="center_vertical"
-                        android:paddingEnd="@dimen/content_padding_small"
-                        android:paddingLeft="@dimen/content_padding"
-                        android:paddingRight="@dimen/content_padding_small"
-                        android:paddingStart="@dimen/content_padding">
-
-                        <androidx.appcompat.widget.AppCompatImageView
-                            android:id="@+id/widget_icon"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:layout_marginEnd="@dimen/bottom_sheet_icon_margin"
-                            android:layout_marginRight="@dimen/bottom_sheet_icon_margin"
-                            tools:background="@drawable/ic_action_device_top"
-                            tools:src="@drawable/ic_action_device_widget"/>
-
-                        <net.osmand.plus.widgets.TextViewEx
-                            android:layout_width="0dp"
-                            android:layout_height="wrap_content"
-                            android:layout_weight="1"
-                            android:ellipsize="end"
-                            android:maxLines="1"
-                            android:text="@string/shared_string_widgets"
-                            android:textColor="?android:textColorPrimary"
-                            android:textSize="@dimen/default_list_text_size"
-                            osmand:typeface="@string/font_roboto_regular"/>
-
-                        <RadioButton
-                            android:id="@+id/widget_radio_button"
-                            android:layout_width="wrap_content"
-                            android:layout_height="wrap_content"
-                            android:background="@null"
-                            android:clickable="false"
-                            android:focusable="false"/>
-                    </LinearLayout>
-
-                </LinearLayout>
-
-                <include layout="@layout/list_item_divider"/>
-
                 <LinearLayout
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/MapMarkerMenuController.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/MapMarkerMenuController.java
index 92a61d0860c..1f11c16c3cc 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/MapMarkerMenuController.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/MapMarkerMenuController.java
@@ -5,22 +5,23 @@
 import android.graphics.drawable.ShapeDrawable;
 import android.graphics.drawable.shapes.OvalShape;
 
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-import androidx.core.content.ContextCompat;
-
 import net.osmand.data.PointDescription;
-import net.osmand.plus.utils.ColorUtilities;
-import net.osmand.plus.mapmarkers.MapMarkersHelper;
-import net.osmand.plus.mapmarkers.MapMarker;
-import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.helpers.MapMarkerDialogHelper;
 import net.osmand.plus.mapcontextmenu.MenuBuilder;
 import net.osmand.plus.mapcontextmenu.MenuController;
+import net.osmand.plus.mapmarkers.MapMarker;
+import net.osmand.plus.mapmarkers.MapMarkersHelper;
+import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.util.Algorithms;
 
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.core.content.ContextCompat;
+
 public class MapMarkerMenuController extends MenuController {
 
 	private MapMarker mapMarker;
@@ -56,13 +57,12 @@ public void buttonPressed() {
 				public void buttonPressed() {
 					MapActivity activity = getMapActivity();
 					if (activity != null) {
-						OsmandPreference<Boolean> indication
-								= activity.getMyApplication().getSettings().MARKERS_DISTANCE_INDICATION_ENABLED;
+						OsmandApplication app = activity.getMyApplication();
+						OsmandPreference<Boolean> indication = app.getSettings().SHOW_MAP_MARKERS_BAR_WIDGET;
 						if (!indication.get()) {
 							indication.set(true);
-							activity.getMapLayers().getMapWidgetRegistry().updateMapMarkersMode(activity);
 						}
-						MapMarkersHelper markersHelper = activity.getMyApplication().getMapMarkersHelper();
+						MapMarkersHelper markersHelper = app.getMapMarkersHelper();
 						markersHelper.moveMarkerToTop(getMapMarker());
 						activity.getContextMenu().close();
 					}
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
index 629bdfcbd2c..19dfdf1a67e 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
@@ -5,7 +5,6 @@
 import android.graphics.Paint;
 import android.graphics.drawable.Drawable;
 import android.graphics.drawable.LayerDrawable;
-import android.os.Build;
 import android.os.Bundle;
 import android.text.SpannableString;
 import android.text.style.ForegroundColorSpan;
@@ -17,69 +16,59 @@
 import android.widget.ArrayAdapter;
 import android.widget.CompoundButton;
 import android.widget.ImageView;
-import android.widget.RadioButton;
 import android.widget.TextView;
 
-import androidx.annotation.Nullable;
-import androidx.appcompat.widget.ListPopupWindow;
-import androidx.appcompat.widget.Toolbar;
-
 import com.github.ksoichiro.android.observablescrollview.ObservableScrollView;
 import com.github.ksoichiro.android.observablescrollview.ObservableScrollViewCallbacks;
 import com.github.ksoichiro.android.observablescrollview.ScrollState;
 
-import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.R;
-import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.base.BaseOsmAndDialogFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
-import net.osmand.plus.settings.backend.preferences.OsmandPreference;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.utils.UiUtilities;
 
 import java.util.LinkedList;
 
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.appcompat.widget.ListPopupWindow;
+import androidx.appcompat.widget.Toolbar;
+
 import static net.osmand.plus.utils.UiUtilities.CompoundButtonType.PROFILE_DEPENDENT;
 
 public class DirectionIndicationDialogFragment extends BaseOsmAndDialogFragment {
 
-	public final static String TAG = "DirectionIndicationDialogFragment";
+	public final static String TAG = DirectionIndicationDialogFragment.class.getSimpleName();
 
-	private DirectionIndicationFragmentListener listener;
 	private View mainView;
 
 	private int helpImgHeight;
 	private boolean shadowVisible;
-	private boolean usedOnMap = false;
-
-	public void setListener(DirectionIndicationFragmentListener listener) {
-		this.listener = listener;
-	}
 
 	@Nullable
 	@Override
-	public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
+	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		final OsmandSettings settings = getSettings();
-		boolean nightMode = isNightMode(usedOnMap);
+		boolean nightMode = isNightMode(false);
 		
 		helpImgHeight = getResources().getDimensionPixelSize(R.dimen.action_bar_image_height);
 
-		mainView = UiUtilities.getInflater(getContext(), !settings.isLightContent()).inflate(R.layout.fragment_direction_indication_dialog, container);
+		mainView = UiUtilities.getInflater(getContext(), nightMode)
+				.inflate(R.layout.fragment_direction_indication_dialog, container);
 
-		Toolbar toolbar = (Toolbar) mainView.findViewById(R.id.toolbar);
+		Toolbar toolbar = mainView.findViewById(R.id.toolbar);
 		int navigationIconResId = AndroidUtils.getNavigationIconResId(getContext());
 		toolbar.setNavigationIcon(getIconsCache().getIcon(navigationIconResId));
 		toolbar.setNavigationContentDescription(R.string.access_shared_string_navigate_up);
-		toolbar.setNavigationOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				dismiss();
-			}
-		});
+		toolbar.setNavigationOnClickListener(view -> dismiss());
 
-		TextView appModeTv = (TextView) mainView.findViewById(R.id.app_mode_text_view);
+		TextView appModeTv = mainView.findViewById(R.id.app_mode_text_view);
 		ApplicationMode appMode = settings.APPLICATION_MODE.get();
 		appModeTv.setText(appMode.toHumanString());
 		appModeTv.setCompoundDrawablesWithIntrinsicBounds(null, null, getIconsCache().getIcon(
@@ -114,7 +103,7 @@ public void onUpOrCancelMotionEvent(ScrollState scrollState) {
 
 		updateHelpImage();
 
-		final TextView menuTv = (TextView) mainView.findViewById(R.id.active_markers_text_view);
+		final TextView menuTv = mainView.findViewById(R.id.active_markers_text_view);
 		menuTv.setText(settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get() == 1 ? R.string.shared_string_one : R.string.shared_string_two);
 		menuTv.setCompoundDrawablesWithIntrinsicBounds(null, null, getContentIcon(R.drawable.ic_action_arrow_drop_down), null);
 		menuTv.setOnClickListener(new View.OnClickListener() {
@@ -146,73 +135,30 @@ public void onItemClick(AdapterView<?> parent, View view, int position, long id)
 			}
 		});
 
-		final CompoundButton distanceIndicationToggle = (CompoundButton) mainView.findViewById(R.id.distance_indication_switch);
-		distanceIndicationToggle.setChecked(settings.MARKERS_DISTANCE_INDICATION_ENABLED.get());
-		mainView.findViewById(R.id.distance_indication_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				updateChecked(settings.MARKERS_DISTANCE_INDICATION_ENABLED, distanceIndicationToggle);
-				updateSelection(true);
-			}
-		});
-		UiUtilities.setupCompoundButton(distanceIndicationToggle, nightMode, PROFILE_DEPENDENT);
-
-		mainView.findViewById(R.id.top_bar_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				settings.MAP_MARKERS_MODE.set(MapMarkersMode.TOOLBAR);
-				updateSelection(true);
-			}
-		});
-
-		mainView.findViewById(R.id.widget_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				settings.MAP_MARKERS_MODE.set(MapMarkersMode.WIDGETS);
-				updateSelection(true);
-			}
-		});
-
-		updateSelection(false);
+		updateHelpImage();
 
-		final CompoundButton showArrowsToggle = (CompoundButton) mainView.findViewById(R.id.show_arrows_switch);
+		final CompoundButton showArrowsToggle = mainView.findViewById(R.id.show_arrows_switch);
 		showArrowsToggle.setChecked(settings.SHOW_ARROWS_TO_FIRST_MARKERS.get());
-		mainView.findViewById(R.id.show_arrows_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				updateChecked(settings.SHOW_ARROWS_TO_FIRST_MARKERS, showArrowsToggle);
-			}
-		});
+		mainView.findViewById(R.id.show_arrows_row).setOnClickListener(view ->
+				updateChecked(settings.SHOW_ARROWS_TO_FIRST_MARKERS, showArrowsToggle));
 		UiUtilities.setupCompoundButton(showArrowsToggle, nightMode, PROFILE_DEPENDENT);
 
-		final CompoundButton showLinesToggle = (CompoundButton) mainView.findViewById(R.id.show_guide_line_switch);
+		final CompoundButton showLinesToggle = mainView.findViewById(R.id.show_guide_line_switch);
 		showLinesToggle.setChecked(settings.SHOW_LINES_TO_FIRST_MARKERS.get());
-		mainView.findViewById(R.id.show_guide_line_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				updateChecked(settings.SHOW_LINES_TO_FIRST_MARKERS, showLinesToggle);
-			}
-		});
+		mainView.findViewById(R.id.show_guide_line_row).setOnClickListener(view ->
+				updateChecked(settings.SHOW_LINES_TO_FIRST_MARKERS, showLinesToggle));
 		UiUtilities.setupCompoundButton(showLinesToggle, nightMode, PROFILE_DEPENDENT);
 
-		final CompoundButton oneTapActiveToggle = (CompoundButton) mainView.findViewById(R.id.one_tap_active_switch);
+		final CompoundButton oneTapActiveToggle = mainView.findViewById(R.id.one_tap_active_switch);
 		oneTapActiveToggle.setChecked(settings.SELECT_MARKER_ON_SINGLE_TAP.get());
-		mainView.findViewById(R.id.one_tap_active_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View view) {
-				updateChecked(settings.SELECT_MARKER_ON_SINGLE_TAP, oneTapActiveToggle);
-			}
-		});
+		mainView.findViewById(R.id.one_tap_active_row).setOnClickListener(view ->
+				updateChecked(settings.SELECT_MARKER_ON_SINGLE_TAP, oneTapActiveToggle));
 		UiUtilities.setupCompoundButton(oneTapActiveToggle, nightMode, PROFILE_DEPENDENT);
 
-		final CompoundButton keepPassedToggle = (CompoundButton) mainView.findViewById(R.id.keep_passed_switch);
+		final CompoundButton keepPassedToggle = mainView.findViewById(R.id.keep_passed_switch);
 		keepPassedToggle.setChecked(settings.KEEP_PASSED_MARKERS_ON_MAP.get());
-		mainView.findViewById(R.id.keep_passed_row).setOnClickListener(new View.OnClickListener() {
-			@Override
-			public void onClick(View v) {
-				updateChecked(settings.KEEP_PASSED_MARKERS_ON_MAP, keepPassedToggle);
-			}
-		});
+		mainView.findViewById(R.id.keep_passed_row).setOnClickListener(v ->
+				updateChecked(settings.KEEP_PASSED_MARKERS_ON_MAP, keepPassedToggle));
 		UiUtilities.setupCompoundButton(keepPassedToggle, nightMode, PROFILE_DEPENDENT);
 
 		return mainView;
@@ -225,10 +171,7 @@ protected Drawable getContentIcon(int id) {
 
 	private MapActivity getMapActivity() {
 		Activity activity = getActivity();
-		if (activity != null && activity instanceof MapActivity) {
-			return (MapActivity) activity;
-		}
-		return null;
+		return activity instanceof MapActivity ? ((MapActivity) activity) : null;
 	}
 
 	private CharSequence[] getMenuTitles() {
@@ -246,41 +189,30 @@ private SpannableString getActiveString(int id) {
 	}
 
 	private void updateHelpImage() {
-		if (Build.VERSION.SDK_INT >= 18) {
-			OsmandSettings settings = getSettings();
-			int count = settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get();
-			LinkedList<Drawable> imgList = new LinkedList<>();
-			imgList.add(getDeviceImg());
-			if (settings.SHOW_LINES_TO_FIRST_MARKERS.get()) {
-				imgList.add(getGuideLineOneImg());
-				if (count == 2) {
-					imgList.add(getGuideLineTwoImg());
-				}
+		OsmandSettings settings = getSettings();
+		int count = settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get();
+		LinkedList<Drawable> imgList = new LinkedList<>();
+		imgList.add(getDeviceImg());
+		if (settings.SHOW_LINES_TO_FIRST_MARKERS.get()) {
+			imgList.add(getGuideLineOneImg());
+			if (count == 2) {
+				imgList.add(getGuideLineTwoImg());
 			}
-			if (settings.SHOW_ARROWS_TO_FIRST_MARKERS.get()) {
-				imgList.add(getArrowOneImg());
-				if (count == 2) {
-					imgList.add(getArrowTwoImg());
-				}
+		}
+		if (settings.SHOW_ARROWS_TO_FIRST_MARKERS.get()) {
+			imgList.add(getArrowOneImg());
+			if (count == 2) {
+				imgList.add(getArrowTwoImg());
 			}
-			if (settings.MARKERS_DISTANCE_INDICATION_ENABLED.get()) {
-				if (settings.MAP_MARKERS_MODE.get().isWidgets()) {
-					imgList.add(getWidget1Img());
-					if (count == 2) {
-						imgList.add(getWidget2Img());
-					}
-				} else {
-					imgList.add(getTopBar1Img());
-					if (count == 2) {
-						imgList.add(getTopBar2Img());
-					}
-				}
+		}
+		if (settings.SHOW_MAP_MARKERS_BAR_WIDGET.get()) {
+			imgList.add(getTopBar1Img());
+			if (count == 2) {
+				imgList.add(getTopBar2Img());
 			}
-			((ImageView) mainView.findViewById(R.id.action_bar_image))
-					.setImageDrawable(new LayerDrawable(imgList.toArray(new Drawable[0])));
-		} else {
-			mainView.findViewById(R.id.action_bar_image_container).setVisibility(View.GONE);
 		}
+		((ImageView) mainView.findViewById(R.id.action_bar_image))
+				.setImageDrawable(new LayerDrawable(imgList.toArray(new Drawable[0])));
 	}
 
 	private Drawable getTopBar2Img() {
@@ -293,16 +225,6 @@ private Drawable getTopBar1Img() {
 				? R.drawable.img_help_markers_direction_topbar_1_day : R.drawable.img_help_markers_direction_topbar_1_night);
 	}
 
-	private Drawable getWidget2Img() {
-		return getIconsCache().getIcon(getSettings().isLightContent()
-				? R.drawable.img_help_markers_direction_widget_2_day : R.drawable.img_help_markers_direction_widget_2_night);
-	}
-
-	private Drawable getWidget1Img() {
-		return getIconsCache().getIcon(getSettings().isLightContent()
-				? R.drawable.img_help_markers_direction_widget_1_day : R.drawable.img_help_markers_direction_widget_1_night);
-	}
-
 	private Drawable getArrowOneImg() {
 		return getIconsCache().getIcon(getSettings().isLightContent()
 				? R.drawable.img_help_markers_direction_arrow_one_day : R.drawable.img_help_markers_direction_arrow_one_night);
@@ -328,20 +250,11 @@ private Drawable getDeviceImg() {
 				? R.drawable.img_help_markers_direction_device_day : R.drawable.img_help_markers_direction_device_night);
 	}
 
-	private Drawable getIconBackground(boolean active) {
-		return active ? getIcon(R.drawable.ic_action_device_top, R.color.active_color_primary_light)
-				: getContentIcon(R.drawable.ic_action_device_top);
-	}
-
-	private Drawable getIconTop(int id, boolean active) {
-		return active ? getIcon(id, R.color.active_color_primary_dark) : getContentIcon(id);
-	}
-
 	private void updateDisplayedMarkersCount(int count) {
 		((TextView) mainView.findViewById(R.id.active_markers_text_view))
 				.setText(count == 1 ? R.string.shared_string_one : R.string.shared_string_two);
 		getSettings().DISPLAYED_MARKERS_WIDGETS_COUNT.set(count);
-		updateSelection(true);
+		updateHelpImage();
 	}
 
 	private void updateChecked(OsmandPreference<Boolean> setting, CompoundButton button) {
@@ -357,44 +270,4 @@ private void refreshMap() {
 			getMapActivity().refreshMap();
 		}
 	}
-
-	private void notifyListener() {
-		if (listener != null) {
-			listener.onMapMarkersModeChanged(getSettings().MARKERS_DISTANCE_INDICATION_ENABLED.get());
-		}
-	}
-
-	private void updateSelection(boolean notifyListener) {
-		OsmandSettings settings = getSettings();
-		MapMarkersMode mode = settings.MAP_MARKERS_MODE.get();
-		boolean distIndEnabled = settings.MARKERS_DISTANCE_INDICATION_ENABLED.get();
-		int count = settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get();
-		int topBarIconId = count == 1 ? R.drawable.ic_action_device_topbar : R.drawable.ic_action_device_topbar_two;
-		int widgetIconId = count == 1 ? R.drawable.ic_action_device_widget : R.drawable.ic_action_device_widget_two;
-		updateIcon(R.id.top_bar_icon, topBarIconId, mode.isToolbar() && distIndEnabled);
-		updateIcon(R.id.widget_icon, widgetIconId, mode.isWidgets() && distIndEnabled);
-		updateMarkerModeRow(R.id.top_bar_row, R.id.top_bar_radio_button, mode.isToolbar(), distIndEnabled);
-		updateMarkerModeRow(R.id.widget_row, R.id.widget_radio_button, mode.isWidgets(), distIndEnabled);
-		if (notifyListener) {
-			notifyListener();
-		}
-		updateHelpImage();
-	}
-
-	private void updateIcon(int imageViewId, int drawableId, boolean active) {
-		ImageView iv = (ImageView) mainView.findViewById(imageViewId);
-		iv.setBackgroundDrawable(getIconBackground(active));
-		iv.setImageDrawable(getIconTop(drawableId, active));
-	}
-
-	private void updateMarkerModeRow(int rowId, int radioButtonId, boolean checked, boolean active) {
-		RadioButton rb = (RadioButton) mainView.findViewById(radioButtonId);
-		rb.setChecked(checked);
-		UiUtilities.setupCompoundButton(rb, isNightMode(usedOnMap), PROFILE_DEPENDENT);
-		mainView.findViewById(rowId).setEnabled(active);
-	}
-
-	public interface DirectionIndicationFragmentListener {
-		void onMapMarkersModeChanged(boolean showDirectionEnabled);
-	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
index 9933147c8fc..5ea4e48a7fe 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/MapMarkersDialogFragment.java
@@ -13,21 +13,20 @@
 import com.google.android.material.bottomnavigation.BottomNavigationView;
 import com.google.android.material.snackbar.Snackbar;
 
-import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.Location;
 import net.osmand.data.LatLon;
-import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.LockableViewPager;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
-import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.activities.MapActivity;
-import net.osmand.plus.mapmarkers.DirectionIndicationDialogFragment.DirectionIndicationFragmentListener;
 import net.osmand.plus.mapmarkers.OptionsBottomSheetDialogFragment.MarkerOptionsFragmentListener;
 import net.osmand.plus.mapmarkers.OrderByBottomSheetDialogFragment.OrderByFragmentListener;
 import net.osmand.plus.mapmarkers.SaveAsTrackBottomSheetDialogFragment.MarkerSaveAsTrackFragmentListener;
 import net.osmand.plus.mapmarkers.SyncGroupTask.OnGroupSyncedListener;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.utils.UiUtilities;
 
 import java.io.File;
 import java.util.ArrayList;
@@ -124,10 +123,6 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		if (optionsFragment != null) {
 			((OptionsBottomSheetDialogFragment) optionsFragment).setListener(createOptionsFragmentListener());
 		}
-		Fragment directionIndicationFragment = fragmentManager.findFragmentByTag(DirectionIndicationDialogFragment.TAG);
-		if (directionIndicationFragment != null) {
-			((DirectionIndicationDialogFragment) directionIndicationFragment).setListener(createShowDirectionFragmentListener());
-		}
 		final Fragment orderByFragment = fragmentManager.findFragmentByTag(OrderByBottomSheetDialogFragment.TAG);
 		if (orderByFragment != null) {
 			((OrderByBottomSheetDialogFragment) orderByFragment).setListener(createOrderByFragmentListener());
@@ -364,7 +359,6 @@ public void sortByOnClick() {
 			public void showDirectionOnClick() {
 				if (mapActivity != null) {
 					DirectionIndicationDialogFragment fragment = new DirectionIndicationDialogFragment();
-					fragment.setListener(createShowDirectionFragmentListener());
 					fragment.show(getChildFragmentManager(), DirectionIndicationDialogFragment.TAG);
 				}
 			}
@@ -436,20 +430,6 @@ public void dismiss() {
 		};
 	}
 
-	private DirectionIndicationFragmentListener createShowDirectionFragmentListener() {
-		return new DirectionIndicationFragmentListener() {
-
-			final MapActivity mapActivity = getMapActivity();
-
-			@Override
-			public void onMapMarkersModeChanged(boolean showDirectionEnabled) {
-				mapActivity.getMapLayers().getMapWidgetRegistry().updateMapMarkersMode(mapActivity);
-				activeFragment.setShowDirectionEnabled(showDirectionEnabled);
-				updateAdapters();
-			}
-		};
-	}
-
 	private MarkerSaveAsTrackFragmentListener createSaveAsTrackFragmentListener() {
 		return new MarkerSaveAsTrackFragmentListener() {
 
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
index 3cb2fcca52e..171e3d87cad 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/OptionsBottomSheetDialogFragment.java
@@ -62,22 +62,13 @@ public void onClick(View v) {
 		}
 
 		((ImageView) mainView.findViewById(R.id.sort_by_icon)).setImageDrawable(getContentIcon(R.drawable.ic_sort_waypoint_dark));
-		MapMarkersMode mode = getMyApplication().getSettings().MAP_MARKERS_MODE.get();
 		int displayedCount = getMyApplication().getSettings().DISPLAYED_MARKERS_WIDGETS_COUNT.get();
-		ImageView showDirectionIcon = (ImageView) mainView.findViewById(R.id.show_direction_icon);
-		int imageResId = 0;
-		switch (mode) {
-			case TOOLBAR:
-				imageResId = displayedCount == 1 ? R.drawable.ic_action_device_topbar : R.drawable.ic_action_device_topbar_two;
-				break;
-			case WIDGETS:
-				imageResId = displayedCount == 1 ? R.drawable.ic_action_device_widget : R.drawable.ic_action_device_widget_two;
-				break;
-		}
-		showDirectionIcon.setBackgroundDrawable(getContentIcon(R.drawable.ic_action_device_top));
-		if (imageResId != 0) {
-			showDirectionIcon.setImageDrawable(getIcon(imageResId, R.color.active_color_primary_light));
-		}
+		ImageView showDirectionIcon = mainView.findViewById(R.id.show_direction_icon);
+		int imageResId = displayedCount == 1
+				? R.drawable.ic_action_device_topbar
+				: R.drawable.ic_action_device_topbar_two;
+		showDirectionIcon.setBackground(getContentIcon(R.drawable.ic_action_device_top));
+		showDirectionIcon.setImageDrawable(getIcon(imageResId, R.color.active_color_primary_light));
 		((ImageView) mainView.findViewById(R.id.coordinate_input_icon)).setImageDrawable(getContentIcon(R.drawable.ic_action_coordinates_longitude));
 		((ImageView) mainView.findViewById(R.id.build_route_icon)).setImageDrawable(getContentIcon(R.drawable.ic_action_gdirections_dark));
 		((ImageView) mainView.findViewById(R.id.save_as_new_track_icon)).setImageDrawable(getContentIcon(R.drawable.ic_action_polygom_dark));
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
index d0512641174..6df87f1b64f 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersActiveAdapter.java
@@ -47,7 +47,7 @@ public MapMarkersActiveAdapter(MapActivity mapActivity) {
 		updateLocationViewCache = uiUtilities.getUpdateLocationViewCache();
 		markers = mapActivity.getMyApplication().getMapMarkersHelper().getMapMarkers();
 		night = !mapActivity.getMyApplication().getSettings().isLightContent();
-		showDirectionEnabled = mapActivity.getMyApplication().getSettings().MARKERS_DISTANCE_INDICATION_ENABLED.get();
+		showDirectionEnabled = mapActivity.getMyApplication().getSettings().SHOW_MAP_MARKERS_BAR_WIDGET.get();
 	}
 
 	public void setShowDirectionEnabled(boolean showDirectionEnabled) {
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
index e993406b9ff..4c9d1209074 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/adapters/MapMarkersGroupsAdapter.java
@@ -84,7 +84,7 @@ public MapMarkersGroupsAdapter(MapActivity mapActivity) {
 	}
 
 	private void updateShowDirectionMarkers() {
-		showDirectionEnabled = app.getSettings().MARKERS_DISTANCE_INDICATION_ENABLED.get();
+		showDirectionEnabled = app.getSettings().SHOW_MAP_MARKERS_BAR_WIDGET.get();
 		List<MapMarker> mapMarkers = app.getMapMarkersHelper().getMapMarkers();
 		int markersCount = mapMarkers.size();
 		showDirectionMarkers = new ArrayList<>(mapMarkers.subList(0, getToIndex(markersCount)));
diff --git a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
index f04c595af1e..f48291aff19 100644
--- a/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
+++ b/OsmAnd/src/net/osmand/plus/settings/backend/OsmandSettings.java
@@ -1746,21 +1746,10 @@ protected boolean setValue(Object prefs, Integer stream) {
 	public final ListStringPreference BOTTOM_WIDGET_PANEL_ORDER = (ListStringPreference) new ListStringPreference(this,
 			"bottom_widget_panel_order", TextUtils.join(",", WidgetsPanel.BOTTOM.getOriginalOrder()), ",").makeProfile();
 
-	public final OsmandPreference<Boolean> MARKERS_DISTANCE_INDICATION_ENABLED = new BooleanPreference(this, "markers_distance_indication_enabled", true).makeProfile();
+	public final OsmandPreference<Boolean> SHOW_MAP_MARKERS_BAR_WIDGET = new BooleanPreference(this, "markers_distance_indication_enabled", true).makeProfile();
 
 	public final OsmandPreference<Integer> DISPLAYED_MARKERS_WIDGETS_COUNT = new IntPreference(this, "displayed_markers_widgets_count", 1).makeProfile();
 
-	public final CommonPreference<MapMarkersMode> MAP_MARKERS_MODE =
-			new EnumStringPreference<>(this, "map_markers_mode", MapMarkersMode.TOOLBAR, MapMarkersMode.values());
-
-	{
-		MAP_MARKERS_MODE.makeProfile().cache();
-		MAP_MARKERS_MODE.setModeDefaultValue(ApplicationMode.DEFAULT, MapMarkersMode.TOOLBAR);
-		MAP_MARKERS_MODE.setModeDefaultValue(ApplicationMode.CAR, MapMarkersMode.TOOLBAR);
-		MAP_MARKERS_MODE.setModeDefaultValue(ApplicationMode.BICYCLE, MapMarkersMode.TOOLBAR);
-		MAP_MARKERS_MODE.setModeDefaultValue(ApplicationMode.PEDESTRIAN, MapMarkersMode.TOOLBAR);
-	}
-
 	public final OsmandPreference<Boolean> SHOW_MAP_MARKERS = new BooleanPreference(this, "show_map_markers", true).makeProfile();
 
 	public final OsmandPreference<Boolean> SHOW_COORDINATES_WIDGET = new BooleanPreference(this, "show_coordinates_widget", false).makeProfile().cache();
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/MapWidgetRegistry.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/MapWidgetRegistry.java
index 2f2930102f8..14e5af5d299 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/MapWidgetRegistry.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/MapWidgetRegistry.java
@@ -367,7 +367,6 @@ public void resetToDefault() {
 	private void resetDefaultAppearance(ApplicationMode mode) {
 		settings.TRANSPARENT_MAP_THEME.resetModeToDefault(mode);
 		settings.SHOW_STREET_NAME.resetModeToDefault(mode);
-		settings.MAP_MARKERS_MODE.resetModeToDefault(mode);
 	}
 
 	public void reorderWidgets() {
@@ -382,20 +381,6 @@ public void reorderWidgets() {
 		}
 	}
 
-	public void updateMapMarkersMode(MapActivity mapActivity) {
-		for (MapWidgetInfo info : getRightWidgets()) {
-			if (WIDGET_MARKER_1.equals(info.key)) {
-				setVisibility(info, settings.MAP_MARKERS_MODE.get().isWidgets()
-						&& settings.MARKERS_DISTANCE_INDICATION_ENABLED.get(), false);
-			} else if (WIDGET_MARKER_2.equals(info.key)) {
-				setVisibility(info, settings.MAP_MARKERS_MODE.get().isWidgets()
-						&& settings.MARKERS_DISTANCE_INDICATION_ENABLED.get()
-						&& settings.DISPLAYED_MARKERS_WIDGETS_COUNT.get() == 2, false);
-			}
-		}
-		mapActivity.refreshMap();
-	}
-
 	@NonNull
 	public Set<MapWidgetInfo> getLeftWidgets() {
 		return getWidgetsForPanel(WidgetsPanel.LEFT);
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/WidgetsVisibilityHelper.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/WidgetsVisibilityHelper.java
index a43b1d6d65b..52489b1e98e 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/WidgetsVisibilityHelper.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/WidgetsVisibilityHelper.java
@@ -73,8 +73,7 @@ public boolean shouldShowTopCoordinatesWidget() {
 
 	public boolean shouldHideMapMarkersWidget() {
 		View streetName = mapActivity.findViewById(R.id.street_name_widget);
-		return !settings.MARKERS_DISTANCE_INDICATION_ENABLED.get()
-				|| !settings.MAP_MARKERS_MODE.get().isToolbar()
+		return !settings.SHOW_MAP_MARKERS_BAR_WIDGET.get()
 				|| streetName != null && streetName.getVisibility() == View.VISIBLE
 				|| routingHelper.isFollowingMode()
 				|| routingHelper.isRoutePlanningMode()
