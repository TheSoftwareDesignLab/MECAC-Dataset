diff --git a/OsmAnd-api/src/net/osmand/aidlapi/IOsmAndAidlInterface.aidl b/OsmAnd-api/src/net/osmand/aidlapi/IOsmAndAidlInterface.aidl
index 2a350af5ad9..4cbf907f0f7 100644
--- a/OsmAnd-api/src/net/osmand/aidlapi/IOsmAndAidlInterface.aidl
+++ b/OsmAnd-api/src/net/osmand/aidlapi/IOsmAndAidlInterface.aidl
@@ -455,7 +455,7 @@ interface IOsmAndAidlInterface {
      * @param gpxUri (Uri) - URI created by FileProvider.
      * @param force (boolean) - ask to stop current navigation if any. False - ask. True - don't ask.
      */
-    boolean navigateGpx(in NavigateGpxParams params);
+    boolean navigateGpx(inout NavigateGpxParams params);
 
     /**
      * Remove GPX file.
diff --git a/OsmAnd-api/src/net/osmand/aidlapi/navigation/NavigateGpxParams.java b/OsmAnd-api/src/net/osmand/aidlapi/navigation/NavigateGpxParams.java
index 8d97b87d846..65594a323bc 100644
--- a/OsmAnd-api/src/net/osmand/aidlapi/navigation/NavigateGpxParams.java
+++ b/OsmAnd-api/src/net/osmand/aidlapi/navigation/NavigateGpxParams.java
@@ -17,6 +17,8 @@ public class NavigateGpxParams extends AidlParams {
 	private String snapToRoadMode;
 	private int snapToRoadThreshold;
 
+	private String fileName;
+
 	public NavigateGpxParams(String data, boolean force, boolean needLocationPermission) {
 		this.data = data;
 		this.force = force;
@@ -93,6 +95,14 @@ public boolean isNeedLocationPermission() {
 		return needLocationPermission;
 	}
 
+	public String getFileName() {
+		return fileName;
+	}
+
+	public void setFileName(String fileName) {
+		this.fileName = fileName;
+	}
+
 	@Override
 	public void writeToBundle(Bundle bundle) {
 		bundle.putString("data", data);
@@ -103,6 +113,7 @@ public void writeToBundle(Bundle bundle) {
 		bundle.putBoolean("snapToRoad", snapToRoad);
 		bundle.putString("snapToRoadMode", snapToRoadMode);
 		bundle.putInt("snapToRoadThreshold", snapToRoadThreshold);
+		bundle.putString("fileName", fileName);
 	}
 
 	@Override
@@ -115,5 +126,6 @@ protected void readFromBundle(Bundle bundle) {
 		snapToRoad = bundle.getBoolean("snapToRoad");
 		snapToRoadMode = bundle.getString("snapToRoadMode");
 		snapToRoadThreshold = bundle.getInt("snapToRoadThreshold");
+		fileName = bundle.getString("fileName", null);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
index 02cbcd423c0..0d2d7c21b74 100644
--- a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
+++ b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
@@ -16,6 +16,7 @@
 import static net.osmand.aidlapi.OsmandAidlConstants.COPY_FILE_WRITE_LOCK_ERROR;
 import static net.osmand.aidlapi.OsmandAidlConstants.OK_RESPONSE;
 import static net.osmand.IndexConstants.GPX_FILE_EXT;
+import static net.osmand.plus.helpers.NavigateGpxHelper.saveAndNavigateGpx;
 import static net.osmand.plus.myplaces.favorites.FavouritesFileHelper.LEGACY_FAV_FILE_PREFIX;
 import static net.osmand.plus.settings.backend.backup.SettingsHelper.REPLACE_KEY;
 import static net.osmand.plus.settings.backend.backup.SettingsHelper.SILENT_IMPORT_KEY;
@@ -31,7 +32,6 @@
 import android.graphics.Bitmap;
 import android.net.Uri;
 import android.os.AsyncTask;
-import android.os.Build;
 import android.os.Bundle;
 import android.os.ParcelFileDescriptor;
 import android.view.KeyEvent;
@@ -43,6 +43,7 @@
 import com.google.gson.reflect.TypeToken;
 
 import net.osmand.CallbackWithObject;
+import net.osmand.aidlapi.navigation.NavigateGpxParams;
 import net.osmand.gpx.GPXUtilities;
 import net.osmand.gpx.GPXFile;
 import net.osmand.gpx.GPXTrackAnalysis;
@@ -200,14 +201,8 @@ public class OsmandAidlApi {
 	private static final String AIDL_DEST_LAT = "aidl_dest_lat";
 	private static final String AIDL_DEST_LON = "aidl_dest_lon";
 	private static final String AIDL_PROFILE = "aidl_profile";
-	private static final String AIDL_DATA = "aidl_data";
-	private static final String AIDL_URI = "aidl_uri";
 	private static final String AIDL_FORCE = "aidl_force";
 	private static final String AIDL_LOCATION_PERMISSION = "aidl_location_permission";
-	private static final String AIDL_PASS_WHOLE_ROUTE = "aidl_pass_whole_route";
-	private static final String AIDL_SNAP_TO_ROAD = "aidl_snap_to_road";
-	private static final String AIDL_SNAP_TO_ROAD_MODE = "aidl_snap_to_road_mode";
-	private static final String AIDL_SNAP_TO_ROAD_THRESHOLD = "aidl_snap_to_road_threshold";
 	private static final String AIDL_SEARCH_QUERY = "aidl_search_query";
 	private static final String AIDL_SEARCH_LAT = "aidl_search_lat";
 	private static final String AIDL_SEARCH_LON = "aidl_search_lon";
@@ -221,7 +216,6 @@ public class OsmandAidlApi {
 	private static final String AIDL_STOP_RECORDING = "aidl_stop_recording";
 
 	private static final String AIDL_NAVIGATE = "aidl_navigate";
-	private static final String AIDL_NAVIGATE_GPX = "aidl_navigate_gpx";
 	private static final String AIDL_NAVIGATE_SEARCH = "aidl_navigate_search";
 	private static final String AIDL_PAUSE_NAVIGATION = "pause_navigation";
 	private static final String AIDL_RESUME_NAVIGATION = "resume_navigation";
@@ -281,7 +275,6 @@ public void onCreateMapActivity(@NonNull MapActivity mapActivity) {
 		registerStartAudioRecordingReceiver(mapActivity);
 		registerStopRecordingReceiver(mapActivity);
 		registerNavigateReceiver(mapActivity);
-		registerNavigateGpxReceiver(mapActivity);
 		registerNavigateSearchReceiver(mapActivity);
 		registerPauseNavigationReceiver(mapActivity);
 		registerResumeNavigationReceiver(mapActivity);
@@ -749,53 +742,6 @@ public void onReceive(Context context, Intent intent) {
 		registerReceiver(navigateSearchReceiver, mapActivity, AIDL_NAVIGATE_SEARCH);
 	}
 
-	private void registerNavigateGpxReceiver(@NonNull MapActivity mapActivity) {
-		WeakReference<MapActivity> mapActivityRef = new WeakReference<>(mapActivity);
-		BroadcastReceiver navigateGpxReceiver = new BroadcastReceiver() {
-			@Override
-			public void onReceive(Context context, Intent intent) {
-				MapActivity mapActivity = mapActivityRef.get();
-				if (mapActivity != null) {
-					GPXFile gpx = loadGpxFileFromIntent(mapActivity, intent);
-					if (gpx != null) {
-						GpxNavigationParams params = new GpxNavigationParams();
-						params.setForce(intent.getBooleanExtra(AIDL_FORCE, false));
-						params.setCheckLocationPermission(intent.getBooleanExtra(AIDL_LOCATION_PERMISSION, false));
-						params.setPassWholeRoute(intent.getBooleanExtra(AIDL_PASS_WHOLE_ROUTE, false));
-						params.setSnapToRoad(intent.getBooleanExtra(AIDL_SNAP_TO_ROAD, false));
-						params.setSnapToRoadMode(intent.getStringExtra(AIDL_SNAP_TO_ROAD_MODE));
-						params.setSnapToRoadThreshold(intent.getIntExtra(AIDL_SNAP_TO_ROAD_THRESHOLD, 50));
-						NavigateGpxHelper.saveAndNavigateGpx(mapActivity, gpx, params);
-					}
-				}
-			}
-
-			private GPXFile loadGpxFileFromIntent(@NonNull MapActivity mapActivity, @NonNull Intent intent) {
-				GPXFile gpx = null;
-				String gpxStr = intent.getStringExtra(AIDL_DATA);
-				if (!Algorithms.isEmpty(gpxStr)) {
-					gpx = GPXUtilities.loadGPXFile(new ByteArrayInputStream(gpxStr.getBytes()));
-				} else if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
-					Uri gpxUri = intent.getParcelableExtra(AIDL_URI);
-					if (gpxUri != null) {
-						ParcelFileDescriptor gpxParcelDescriptor = null;
-						try {
-							gpxParcelDescriptor = mapActivity.getContentResolver().openFileDescriptor(gpxUri, "r");
-						} catch (FileNotFoundException e) {
-							e.printStackTrace();
-						}
-						if (gpxParcelDescriptor != null) {
-							FileDescriptor fileDescriptor = gpxParcelDescriptor.getFileDescriptor();
-							gpx = GPXUtilities.loadGPXFile(new FileInputStream(fileDescriptor));
-						}
-					}
-				}
-				return gpx;
-			}
-		};
-		registerReceiver(navigateGpxReceiver, mapActivity, AIDL_NAVIGATE_GPX);
-	}
-
 	private void registerPauseNavigationReceiver(@NonNull MapActivity mapActivity) {
 		WeakReference<MapActivity> mapActivityRef = new WeakReference<>(mapActivity);
 		BroadcastReceiver pauseNavigationReceiver = new BroadcastReceiver() {
@@ -1855,31 +1801,17 @@ boolean unmuteNavigation() {
 	}
 
 	boolean navigateGpx(String data, Uri uri, boolean force, boolean requestLocationPermission) {
-		Intent intent = new Intent();
-		intent.setAction(AIDL_NAVIGATE_GPX);
-		intent.putExtra(AIDL_DATA, data);
-		intent.putExtra(AIDL_URI, uri);
-		intent.putExtra(AIDL_FORCE, force);
-		intent.putExtra(AIDL_LOCATION_PERMISSION, requestLocationPermission);
-		app.sendBroadcast(intent);
-		return true;
+		if (mapActivity != null) {
+			return saveAndNavigateGpx(mapActivity, data, uri, force, requestLocationPermission);
+		}
+		return false;
 	}
 
-	boolean navigateGpxV2(String data, Uri uri, boolean force, boolean requestLocationPermission,
-	                      boolean passWholeRoute, boolean snapToRoad, String snapToRoadMode,
-	                      int snapToRoadThreshold) {
-		Intent intent = new Intent();
-		intent.setAction(AIDL_NAVIGATE_GPX);
-		intent.putExtra(AIDL_DATA, data);
-		intent.putExtra(AIDL_URI, uri);
-		intent.putExtra(AIDL_FORCE, force);
-		intent.putExtra(AIDL_LOCATION_PERMISSION, requestLocationPermission);
-		intent.putExtra(AIDL_PASS_WHOLE_ROUTE, passWholeRoute);
-		intent.putExtra(AIDL_SNAP_TO_ROAD, snapToRoad);
-		intent.putExtra(AIDL_SNAP_TO_ROAD_MODE, snapToRoadMode);
-		intent.putExtra(AIDL_SNAP_TO_ROAD_THRESHOLD, snapToRoadThreshold);
-		app.sendBroadcast(intent);
-		return true;
+	boolean navigateGpxV2(NavigateGpxParams params) {
+		if (mapActivity != null) {
+			return saveAndNavigateGpx(mapActivity, params);
+		}
+		return false;
 	}
 
 	boolean setLockState(boolean lock) {
diff --git a/OsmAnd/src/net/osmand/aidl/OsmandAidlServiceV2.java b/OsmAnd/src/net/osmand/aidl/OsmandAidlServiceV2.java
index d1c1e23fada..933b90afc91 100644
--- a/OsmAnd/src/net/osmand/aidl/OsmandAidlServiceV2.java
+++ b/OsmAnd/src/net/osmand/aidl/OsmandAidlServiceV2.java
@@ -714,9 +714,7 @@ public boolean navigate(NavigateParams params) {
 		public boolean navigateGpx(NavigateGpxParams params) {
 			try {
 				OsmandAidlApi api = getApi("navigateGpx");
-				return params != null && api != null && api.navigateGpxV2(params.getData(), params.getUri(),
-						params.isForce(), params.isNeedLocationPermission(), params.isPassWholeRoute(),
-						params.isSnapToRoad(), params.getSnapToRoadMode(), params.getSnapToRoadThreshold());
+				return params != null && api != null && api.navigateGpxV2(params);
 			} catch (Exception e) {
 				handleException(e);
 				return false;
diff --git a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
index a8fc8e2eaec..6db4e0a2b6c 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
@@ -36,17 +36,13 @@
 import net.osmand.data.FavouritePoint;
 import net.osmand.data.LatLon;
 import net.osmand.data.PointDescription;
-import net.osmand.plus.OsmAndLocationProvider;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.activities.MapActivity.ShowQuickSearchMode;
-import net.osmand.plus.base.MapViewTrackingUtilities;
 import net.osmand.plus.mapcontextmenu.MapContextMenu;
 import net.osmand.plus.mapmarkers.MapMarker;
 import net.osmand.plus.mapmarkers.MapMarkersHelper;
-import net.osmand.plus.measurementtool.GpxApproximationHelper;
-import net.osmand.plus.measurementtool.GpxApproximationParams;
 import net.osmand.plus.myplaces.favorites.FavouritesHelper;
 import net.osmand.plus.plugins.CustomOsmandPlugin;
 import net.osmand.plus.plugins.PluginsHelper;
@@ -60,12 +56,6 @@
 import net.osmand.plus.routing.RoutingHelperUtils;
 import net.osmand.plus.search.listitems.QuickSearchListItem;
 import net.osmand.plus.settings.backend.ApplicationMode;
-import net.osmand.plus.settings.backend.OsmandSettings;
-import net.osmand.plus.track.GpxSelectionParams;
-import net.osmand.plus.track.helpers.save.SaveGpxListener;
-import net.osmand.plus.track.helpers.GpxSelectionHelper;
-import net.osmand.plus.track.helpers.save.SaveGpxHelper;
-import net.osmand.plus.track.helpers.SelectedGpxFile;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.router.TurnType;
 import net.osmand.search.SearchUICore;
diff --git a/OsmAnd/src/net/osmand/plus/helpers/GpxNavigationParams.java b/OsmAnd/src/net/osmand/plus/helpers/GpxNavigationParams.java
index 43b28177bdd..2c998479cf6 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/GpxNavigationParams.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/GpxNavigationParams.java
@@ -7,53 +7,59 @@ public class GpxNavigationParams {
 	private boolean passWholeRoute;
 	private boolean snapToRoad;
 	private String snapToRoadMode;
-	private int snapToRoadThreshold;
+	private int snapToRoadThreshold = 50;
 
 	public boolean isForce() {
 		return force;
 	}
 
-	public void setForce(boolean force) {
+	public GpxNavigationParams setForce(boolean force) {
 		this.force = force;
+		return this;
 	}
 
 	public boolean isCheckLocationPermission() {
 		return checkLocationPermission;
 	}
 
-	public void setCheckLocationPermission(boolean checkLocationPermission) {
+	public GpxNavigationParams setCheckLocationPermission(boolean checkLocationPermission) {
 		this.checkLocationPermission = checkLocationPermission;
+		return this;
 	}
 
 	public boolean isPassWholeRoute() {
 		return passWholeRoute;
 	}
 
-	public void setPassWholeRoute(boolean passWholeRoute) {
+	public GpxNavigationParams setPassWholeRoute(boolean passWholeRoute) {
 		this.passWholeRoute = passWholeRoute;
+		return this;
 	}
 
 	public boolean isSnapToRoad() {
 		return snapToRoad;
 	}
 
-	public void setSnapToRoad(boolean snapToRoad) {
+	public GpxNavigationParams setSnapToRoad(boolean snapToRoad) {
 		this.snapToRoad = snapToRoad;
+		return this;
 	}
 
 	public String getSnapToRoadMode() {
 		return snapToRoadMode;
 	}
 
-	public void setSnapToRoadMode(String snapToRoadMode) {
+	public GpxNavigationParams setSnapToRoadMode(String snapToRoadMode) {
 		this.snapToRoadMode = snapToRoadMode;
+		return this;
 	}
 
 	public int getSnapToRoadThreshold() {
 		return snapToRoadThreshold;
 	}
 
-	public void setSnapToRoadThreshold(int snapToRoadThreshold) {
+	public GpxNavigationParams setSnapToRoadThreshold(int snapToRoadThreshold) {
 		this.snapToRoadThreshold = snapToRoadThreshold;
+		return this;
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java b/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java
index d3770822aac..603e14b9911 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java
@@ -1,12 +1,20 @@
 package net.osmand.plus.helpers;
 
+import android.content.ContentResolver;
+import android.content.Context;
+import android.net.Uri;
+import android.os.Build;
+import android.os.ParcelFileDescriptor;
+
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
 import net.osmand.IndexConstants;
+import net.osmand.aidlapi.navigation.NavigateGpxParams;
 import net.osmand.data.LatLon;
 import net.osmand.data.PointDescription;
 import net.osmand.gpx.GPXFile;
+import net.osmand.gpx.GPXUtilities;
 import net.osmand.plus.OsmAndLocationProvider;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.activities.MapActivity;
@@ -20,44 +28,44 @@
 import net.osmand.plus.track.helpers.GpxSelectionHelper;
 import net.osmand.plus.track.helpers.SelectedGpxFile;
 import net.osmand.plus.track.helpers.save.SaveGpxHelper;
-import net.osmand.plus.track.helpers.save.SaveGpxListener;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.util.Algorithms;
 
+import java.io.ByteArrayInputStream;
 import java.io.File;
+import java.io.FileDescriptor;
+import java.io.FileInputStream;
+import java.io.FileNotFoundException;
 import java.lang.ref.WeakReference;
 
 public class NavigateGpxHelper {
 
-	public static void saveAndNavigateGpx(MapActivity mapActivity, GPXFile gpxFile,
-	                                      GpxNavigationParams params) {
-		WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
-		saveGpx(mapActivity, gpxFile, errorMessage -> {
-			MapActivity activity = activityRef.get();
-			if (errorMessage == null && AndroidUtils.isActivityNotDestroyed(activity)) {
-				navigateGpx_ShowOnMap(activity, gpxFile, params);
-			}
-		});
+	private static final String DEFAULT_FILE_NAME = "route";
+
+	private final OsmandApplication app;
+	private final WeakReference<MapActivity> mapActivityRef;
+	private final GPXFile gpxFile;
+	private final GpxNavigationParams navigationParams;
+
+
+	public NavigateGpxHelper(@NonNull MapActivity mapActivity, @NonNull GPXFile gpxFile,
+	                         @NonNull GpxNavigationParams navigationParams) {
+		this.mapActivityRef = new WeakReference<>(mapActivity);
+		this.app = mapActivity.getMyApplication();
+		this.gpxFile = gpxFile;
+		this.navigationParams = navigationParams;
 	}
 
-	private static void saveGpx(MapActivity mapActivity, GPXFile gpxFile, SaveGpxListener listener) {
-		if (Algorithms.isEmpty(gpxFile.path)) {
-			OsmandApplication app = mapActivity.getMyApplication();
-			String destFileName = "route" + IndexConstants.GPX_FILE_EXT;
-			File destDir = app.getAppPath(IndexConstants.GPX_IMPORT_DIR);
-			File destFile = app.getAppPath(IndexConstants.GPX_IMPORT_DIR + destFileName);
-			while (destFile.exists()) {
-				destFileName = AndroidUtils.createNewFileName(destFileName);
-				destFile = new File(destDir, destFileName);
+	private void step1_saveGpx() {
+		updateFileNameIfNeeded(app, gpxFile, DEFAULT_FILE_NAME);
+		SaveGpxHelper.saveGpx(new File(gpxFile.path), gpxFile, errorMessage -> {
+			if (errorMessage == null) {
+				step2_showGpxOnMap();
 			}
-			gpxFile.path = destFile.getAbsolutePath();
-		}
-		SaveGpxHelper.saveGpx(new File(gpxFile.path), gpxFile, listener);
+		});
 	}
 
-	public static void navigateGpx_ShowOnMap(@NonNull MapActivity activity, @NonNull GPXFile gpxFile,
-	                                         @NonNull GpxNavigationParams navigationParams) {
-		OsmandApplication app = activity.getMyApplication();
+	public void step2_showGpxOnMap() {
 		GpxSelectionHelper helper = app.getSelectedGpxHelper();
 		SelectedGpxFile selectedGpx = helper.getSelectedFileByPath(gpxFile.path);
 		if (selectedGpx != null) {
@@ -68,67 +76,104 @@ public static void navigateGpx_ShowOnMap(@NonNull MapActivity activity, @NonNull
 					.addToHistory().saveSelection();
 			helper.selectGpxFile(gpxFile, selectionParams);
 		}
-		navigateGpx_ApproximateIfNeeded(activity, gpxFile, navigationParams);
+		step3_approximateGpxIfNeeded();
 	}
 
-	public static void navigateGpx_ApproximateIfNeeded(@NonNull MapActivity mapActivity,
-	                                                   @NonNull GPXFile gpxFile,
-	                                                   @NonNull GpxNavigationParams params) {
-		if (params.isSnapToRoad()) {
-			OsmandApplication app = mapActivity.getMyApplication();
+	public void step3_approximateGpxIfNeeded() {
+		if (navigationParams.isSnapToRoad()) {
 			GpxApproximationParams approxParams = new GpxApproximationParams();
-			approxParams.setAppMode(ApplicationMode.valueOfStringKey(params.getSnapToRoadMode(), null));
-			approxParams.setDistanceThreshold(params.getSnapToRoadThreshold());
-			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
+			approxParams.setAppMode(ApplicationMode.valueOfStringKey(navigationParams.getSnapToRoadMode(), null));
+			approxParams.setDistanceThreshold(navigationParams.getSnapToRoadThreshold());
 			GpxApproximationHelper.approximateGpxSilently(app, gpxFile, approxParams, approxGpx -> {
-				MapActivity activity = activityRef.get();
-				if (AndroidUtils.isActivityNotDestroyed(activity)) {
-					navigateGpx_FinalCheck(activity, approxGpx, params);
-				}
+				step4_startNavigation(approxGpx);
 				return true;
 			});
 		} else {
-			navigateGpx_FinalCheck(mapActivity, gpxFile, params);
+			step4_startNavigation(gpxFile);
 		}
 	}
 
-	public static void navigateGpx_FinalCheck(@NonNull MapActivity mapActivity, @NonNull GPXFile gpxFile,
-	                                          @NonNull GpxNavigationParams params) {
-		OsmandApplication app = mapActivity.getMyApplication();
-		boolean force = params.isForce();
-		boolean checkLocationPermission = params.isCheckLocationPermission();
-		boolean passWholeRoute = params.isPassWholeRoute();
-		RoutingHelper routingHelper = app.getRoutingHelper();
-		if (routingHelper.isFollowingMode() && !force) {
-			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
-			mapActivity.getMapActions().stopNavigationActionConfirm(dialog -> {
-				MapActivity activity = activityRef.get();
-				if (activity != null && !routingHelper.isFollowingMode()) {
-					startNavigation(activity, gpxFile, checkLocationPermission, passWholeRoute);
-				}
-			});
-		} else {
-			startNavigation(mapActivity, gpxFile, checkLocationPermission, passWholeRoute);
+	public void step4_startNavigation(@NonNull GPXFile gpxFile) {
+		MapActivity mapActivity = mapActivityRef.get();
+		if (AndroidUtils.isActivityNotDestroyed(mapActivity)) {
+			OsmandApplication app = mapActivity.getMyApplication();
+			RoutingHelper routingHelper = app.getRoutingHelper();
+
+			boolean passWholeRoute = navigationParams.isPassWholeRoute();
+			boolean checkLocationPermission = navigationParams.isCheckLocationPermission();
+			if (routingHelper.isFollowingMode() && !navigationParams.isForce()) {
+				WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
+				mapActivity.getMapActions().stopNavigationActionConfirm(dialog -> {
+					MapActivity activity = activityRef.get();
+					if (activity != null && !routingHelper.isFollowingMode()) {
+						startNavigation(activity, gpxFile, checkLocationPermission, passWholeRoute);
+					}
+				});
+			} else {
+				startNavigation(mapActivity, gpxFile, checkLocationPermission, passWholeRoute);
+			}
+		}
+	}
+
+	public static boolean saveAndNavigateGpx(@NonNull MapActivity mapActivity,
+	                                         @Nullable String data, @Nullable Uri uri,
+	                                         boolean force, boolean requestLocationPermission) {
+		GPXFile gpxFile = loadGpxFile(mapActivity, data, uri);
+		if (gpxFile != null) {
+			saveAndNavigateGpx(mapActivity, gpxFile, new GpxNavigationParams()
+					.setCheckLocationPermission(requestLocationPermission)
+					.setForce(force));
+			return true;
 		}
+		return false;
 	}
 
-	public static void startNavigation(MapActivity mapActivity, @NonNull GPXFile gpx, boolean checkLocationPermission, boolean passWholeRoute) {
+	public static boolean saveAndNavigateGpx(@NonNull MapActivity mapActivity,
+	                                         @NonNull NavigateGpxParams params) {
+		GPXFile gpxFile = loadGpxFile(mapActivity, params.getData(), params.getUri());
+		if (gpxFile != null) {
+			OsmandApplication app = mapActivity.getMyApplication();
+			String updatedFileName = updateFileNameIfNeeded(app, gpxFile, params.getFileName());
+			if (!Algorithms.isEmpty(updatedFileName)) {
+				params.setFileName(updatedFileName);
+			}
+
+			GpxNavigationParams navigationParams = new GpxNavigationParams()
+					.setCheckLocationPermission(params.isNeedLocationPermission())
+					.setPassWholeRoute(params.isPassWholeRoute())
+					.setForce(params.isForce())
+					.setSnapToRoad(params.isSnapToRoad())
+					.setSnapToRoadMode(params.getSnapToRoadMode())
+					.setSnapToRoadThreshold(params.getSnapToRoadThreshold());
+
+			saveAndNavigateGpx(mapActivity, gpxFile, navigationParams);
+			return true;
+		}
+		return false;
+	}
+
+	public static void saveAndNavigateGpx(@NonNull MapActivity mapActivity, @NonNull GPXFile gpxFile,
+	                                      @NonNull GpxNavigationParams params) {
+		new NavigateGpxHelper(mapActivity, gpxFile, params).step1_saveGpx();
+	}
+
+	public static void startNavigation(@NonNull MapActivity mapActivity, @NonNull GPXFile gpx,
+	                                   boolean checkLocationPermission, boolean passWholeRoute) {
 		startNavigation(mapActivity, gpx, null, null, null, null, null, checkLocationPermission, passWholeRoute);
 	}
 
-	public static void startNavigation(MapActivity mapActivity,
+	public static void startNavigation(@NonNull MapActivity mapActivity,
 	                                   @Nullable LatLon from, @Nullable PointDescription fromDesc,
 	                                   @Nullable LatLon to, @Nullable PointDescription toDesc,
 	                                   @NonNull ApplicationMode mode, boolean checkLocationPermission) {
 		startNavigation(mapActivity, null, from, fromDesc, to, toDesc, mode, checkLocationPermission, false);
 	}
 
-	private static void startNavigation(MapActivity mapActivity, GPXFile gpx,
-	                                    LatLon from, PointDescription fromDesc,
-	                                    LatLon to, PointDescription toDesc,
-	                                    ApplicationMode mode,
-	                                    boolean checkLocationPermission,
-	                                    boolean passWholeRoute) {
+	private static void startNavigation(@NonNull MapActivity mapActivity, @Nullable GPXFile gpx,
+	                                    @Nullable LatLon from, @Nullable PointDescription fromDesc,
+	                                    @Nullable LatLon to, @Nullable PointDescription toDesc,
+	                                    @Nullable ApplicationMode mode,
+	                                    boolean checkLocationPermission, boolean passWholeRoute) {
 		OsmandApplication app = mapActivity.getMyApplication();
 		OsmandSettings settings = app.getSettings();
 		RoutingHelper routingHelper = app.getRoutingHelper();
@@ -160,4 +205,45 @@ private static void startNavigation(MapActivity mapActivity, GPXFile gpx,
 		}
 	}
 
+	private static String updateFileNameIfNeeded(@NonNull OsmandApplication app,
+	                                             @NonNull GPXFile gpxFile,
+	                                             @Nullable String preferredFileName) {
+		if (Algorithms.isEmpty(gpxFile.path)) {
+			String fileName = !Algorithms.isEmpty(preferredFileName) ? preferredFileName : DEFAULT_FILE_NAME;
+			String fileNameWithExt = fileName + IndexConstants.GPX_FILE_EXT;
+
+			File destDir = app.getAppPath(IndexConstants.GPX_IMPORT_DIR);
+			File destFile = app.getAppPath(IndexConstants.GPX_IMPORT_DIR + fileNameWithExt);
+			while (destFile.exists()) {
+				fileNameWithExt = AndroidUtils.createNewFileName(fileNameWithExt);
+				destFile = new File(destDir, fileNameWithExt);
+			}
+			gpxFile.path = destFile.getAbsolutePath();
+			return fileName;
+		}
+		return null;
+	}
+
+	private static GPXFile loadGpxFile(@NonNull Context context, String data, Uri uri) {
+		GPXFile gpx = null;
+		if (!Algorithms.isEmpty(data)) {
+			gpx = GPXUtilities.loadGPXFile(new ByteArrayInputStream(data.getBytes()));
+		} else if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
+			if (uri != null) {
+				ParcelFileDescriptor gpxParcelDescriptor = null;
+				try {
+					ContentResolver contentResolver = context.getContentResolver();
+					gpxParcelDescriptor = contentResolver.openFileDescriptor(uri, "r");
+				} catch (FileNotFoundException e) {
+					e.printStackTrace();
+				}
+				if (gpxParcelDescriptor != null) {
+					FileDescriptor fileDescriptor = gpxParcelDescriptor.getFileDescriptor();
+					gpx = GPXUtilities.loadGPXFile(new FileInputStream(fileDescriptor));
+				}
+			}
+		}
+		return gpx;
+	}
+
 }
