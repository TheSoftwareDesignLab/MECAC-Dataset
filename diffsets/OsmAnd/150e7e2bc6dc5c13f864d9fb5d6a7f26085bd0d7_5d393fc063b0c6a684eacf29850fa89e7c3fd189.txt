diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidget.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidget.java
new file mode 100644
index 00000000000..0b1cc9ca0e8
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidget.java
@@ -0,0 +1,110 @@
+package net.osmand.plus.plugins.monitoring.widgets;
+
+import android.view.View;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.annotation.StringRes;
+
+import net.osmand.plus.R;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.plugins.monitoring.SavingTrackHelper;
+import net.osmand.plus.plugins.monitoring.widgets.TripRecordingMaxSpeedWidgetState.MaxSpeedMode;
+import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.views.layers.base.OsmandMapLayer.DrawSettings;
+import net.osmand.plus.views.mapwidgets.WidgetType;
+import net.osmand.plus.views.mapwidgets.WidgetsPanel;
+import net.osmand.plus.views.mapwidgets.widgets.SimpleWidget;
+import net.osmand.shared.gpx.ElevationDiffsCalculator;
+import net.osmand.shared.gpx.GpxTrackAnalysis;
+
+public class TripRecordingMaxSpeedWidget extends SimpleWidget {
+	private final TripRecordingMaxSpeedWidgetState widgetState;
+
+
+	protected final SavingTrackHelper savingTrackHelper;
+	protected int currentTrackIndex;
+
+	protected double cachedMaxSpeed = -1;
+	private int lastMaxSpeed;
+	private boolean forceUpdate;
+
+
+	public TripRecordingMaxSpeedWidget(@NonNull MapActivity mapActivity, @NonNull TripRecordingMaxSpeedWidgetState widgetState, @NonNull WidgetType widgetType,
+	                                @Nullable String customId, @Nullable WidgetsPanel widgetsPanel) {
+		super(mapActivity, widgetType, customId, widgetsPanel);
+		this.widgetState = widgetState;
+		savingTrackHelper = app.getSavingTrackHelper();
+		updateWidgetView();
+		updateInfo(null);
+	}
+
+	@Override
+	protected View.OnClickListener getOnClickListener() {
+		return v -> {
+			forceUpdate = true;
+			widgetState.changeToNextState();
+			updateInfo(null);
+			mapActivity.refreshMap();
+			updateWidgetName();
+			updateIcon();
+		};
+	}
+
+	@Override
+	protected void updateSimpleWidgetInfo(@Nullable DrawSettings drawSettings) {
+		int currentTrackIndex = savingTrackHelper.getCurrentTrackIndex();
+		double maxSpeed = getMaxSpeed(this.currentTrackIndex != currentTrackIndex);
+		this.currentTrackIndex = currentTrackIndex;
+		if (forceUpdate || isUpdateNeeded() || cachedMaxSpeed != maxSpeed) {
+			cachedMaxSpeed = maxSpeed;
+			forceUpdate = false;
+			setText(String.valueOf(maxSpeed), "%");
+		}
+	}
+
+	protected double getMaxSpeed(boolean reset) {
+		if (reset) {
+			lastMaxSpeed = 0;
+		}
+		MaxSpeedMode mode = widgetState.getMaxSpeedModePreference().get();
+		if(mode == MaxSpeedMode.TOTAL){
+			lastMaxSpeed = (int) getAnalysis().getMaxSpeed();
+		} else{
+			/*ElevationDiffsCalculator.SlopeInfo slopeInfo = mode == MaxSpeedMode.LAST_UPHILL ? getAnalysis().getLastUphill() : getAnalysis().getLastDownhill();
+			if (slopeInfo != null) {
+				lastMaxSpeed = (int) (slopeInfo.() / slopeInfo.getDistance() * 100);
+			}*/
+		}
+		return lastMaxSpeed;
+	}
+
+	@Override
+	public int getIconId(boolean nightMode) {
+		return widgetState.getMaxSpeedModePreference().get().getIcon(nightMode);
+	}
+
+	@Nullable
+	@Override
+	protected String getAdditionalWidgetName() {
+		if (widgetState != null) {
+			return getString(widgetState.getMaxSpeedModePreference().get().titleId);
+		}
+		return null;
+	}
+
+	@StringRes
+	protected int getAdditionalWidgetNameDivider() {
+		return R.string.ltr_or_rtl_combine_via_colon;
+	}
+
+	@NonNull
+	protected GpxTrackAnalysis getAnalysis() {
+		return savingTrackHelper.getCurrentTrack().getTrackAnalysis(app);
+	}
+
+	@Nullable
+	public OsmandPreference<MaxSpeedMode> getMaxSpeedModeOsmandPreference() {
+		return widgetState != null ? widgetState.getMaxSpeedModePreference() : null;
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetInfoFragment.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetInfoFragment.java
new file mode 100644
index 00000000000..04431854dac
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetInfoFragment.java
@@ -0,0 +1,97 @@
+package net.osmand.plus.plugins.monitoring.widgets;
+
+import android.os.Bundle;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import net.osmand.plus.R;
+import net.osmand.plus.plugins.monitoring.widgets.TripRecordingMaxSpeedWidgetState.MaxSpeedMode;
+import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.views.mapwidgets.configure.settings.BaseSimpleWidgetInfoFragment;
+import net.osmand.plus.widgets.alert.AlertDialogData;
+import net.osmand.plus.widgets.alert.CustomAlert;
+
+public class TripRecordingMaxSpeedWidgetInfoFragment extends BaseSimpleWidgetInfoFragment {
+
+	private static final String MAX_SPEED_MODE = "max_speed_mode";
+
+	@Nullable
+	private OsmandPreference<MaxSpeedMode> modeOsmandPreference;
+	private ImageView iconMode;
+	private TextView titleMode;
+	private TextView descriptionMode;
+
+	private int selectedMode;
+
+	@Override
+	protected void initParams(@NonNull Bundle bundle) {
+		super.initParams(bundle);
+		if (widgetInfo != null) {
+			TripRecordingMaxSpeedWidget widget = (TripRecordingMaxSpeedWidget) widgetInfo.widget;
+			modeOsmandPreference = widget.getMaxSpeedModeOsmandPreference();
+		}
+		selectedMode = bundle.getInt(MAX_SPEED_MODE, modeOsmandPreference != null ?
+				modeOsmandPreference.getModeValue(appMode).ordinal() : MaxSpeedMode.TOTAL.ordinal());
+	}
+
+	@Override
+	protected void setupMainContent(@NonNull ViewGroup container) {
+		if (modeOsmandPreference != null) {
+			View modeButton = inflate(R.layout.bottom_sheet_item_with_descr_72dp, container);
+			iconMode = container.findViewById(R.id.icon);
+			titleMode = container.findViewById(R.id.title);
+			titleMode.setText(R.string.shared_string_mode);
+			descriptionMode = container.findViewById(R.id.description);
+			iconMode.setImageDrawable(app.getUIUtilities().getIcon(modeOsmandPreference.get().getIcon(nightMode)));
+			modeButton.setOnClickListener(v -> showModeDialog());
+			modeButton.setBackground(getPressedStateDrawable());
+		}
+	}
+
+	private void showModeDialog() {
+		CharSequence[] items = new CharSequence[MaxSpeedMode.values().length];
+		for (int i = 0; i < MaxSpeedMode.values().length; i++) {
+			items[i] = getString(MaxSpeedMode.values()[i].getTitleId());
+		}
+
+		AlertDialogData dialogData = new AlertDialogData(titleMode.getContext(), nightMode)
+				.setTitle(R.string.shared_string_mode)
+				.setControlsColor(ColorUtilities.getActiveColor(app, nightMode));
+
+		CustomAlert.showSingleSelection(dialogData, items, selectedMode, v -> {
+			selectedMode = (int) v.getTag();
+			updateModeSetting();
+		});
+	}
+
+	private void updateModeSetting() {
+		descriptionMode.setText(getString(MaxSpeedMode.values()[selectedMode].getTitleId()));
+		iconMode.setImageDrawable(app.getUIUtilities().getIcon(MaxSpeedMode.values()[selectedMode].getIcon(nightMode)));
+	}
+
+	@Override
+	protected void applySettings() {
+		super.applySettings();
+		if (modeOsmandPreference != null) {
+			modeOsmandPreference.setModeValue(appMode, MaxSpeedMode.values()[selectedMode]);
+		}
+	}
+
+	@Override
+	public void onSaveInstanceState(@NonNull Bundle outState) {
+		super.onSaveInstanceState(outState);
+		outState.putInt(MAX_SPEED_MODE, selectedMode);
+	}
+
+	@Override
+	public void onResume() {
+		super.onResume();
+		updateModeSetting();
+	}
+}
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetState.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetState.java
new file mode 100644
index 00000000000..cec5613c09a
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/widgets/TripRecordingMaxSpeedWidgetState.java
@@ -0,0 +1,109 @@
+package net.osmand.plus.plugins.monitoring.widgets;
+
+import static net.osmand.plus.plugins.monitoring.widgets.TripRecordingMaxSpeedWidgetState.MaxSpeedMode.TOTAL;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.annotation.StringRes;
+
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.R;
+import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.backend.preferences.OsmandPreference;
+import net.osmand.plus.views.mapwidgets.WidgetType;
+import net.osmand.plus.views.mapwidgets.widgetstates.WidgetState;
+import net.osmand.util.Algorithms;
+
+public class TripRecordingMaxSpeedWidgetState extends WidgetState {
+
+	public static final String MAX_SPEED_WIDGET_MODE = "max_speed_widget_mode";
+
+	private final WidgetType widgetType;
+	private final OsmandPreference<MaxSpeedMode> maxSpeedModePreference;
+
+
+	public TripRecordingMaxSpeedWidgetState(@NonNull OsmandApplication app, @Nullable String customId, WidgetType widgetType) {
+		super(app);
+		this.widgetType = widgetType;
+		this.maxSpeedModePreference = registerMaxSpeedModePreference(customId);
+	}
+
+	@NonNull
+	public WidgetType getWidgetType() {
+		return widgetType;
+	}
+
+	public OsmandPreference<MaxSpeedMode> getMaxSpeedModePreference() {
+		return maxSpeedModePreference;
+	}
+
+	@NonNull
+	@Override
+	public String getTitle() {
+		return app.getString(widgetType.titleId);
+	}
+
+	@Override
+	public int getSettingsIconId(boolean nightMode) {
+		return widgetType.getIconId(nightMode);
+	}
+
+	@Override
+	public void changeToNextState() {
+		MaxSpeedMode currentMode = maxSpeedModePreference.get();
+		maxSpeedModePreference.set(currentMode.next());
+	}
+
+	@Override
+	public void copyPrefs(@NonNull ApplicationMode appMode, @Nullable String customId) {
+		copyPrefsFromMode(appMode, appMode, customId);
+	}
+
+	@Override
+	public void copyPrefsFromMode(@NonNull ApplicationMode sourceAppMode, @NonNull ApplicationMode appMode, @Nullable String customId) {
+		registerMaxSpeedModePreference(customId).setModeValue(appMode, maxSpeedModePreference.getModeValue(sourceAppMode));
+	}
+
+	@NonNull
+	private OsmandPreference<MaxSpeedMode> registerMaxSpeedModePreference(@Nullable String customId) {
+		String prefId = MAX_SPEED_WIDGET_MODE;
+		if (!Algorithms.isEmpty(customId)) {
+			prefId += customId;
+		}
+		return settings.registerEnumStringPreference(prefId, TOTAL,
+				MaxSpeedMode.values(), MaxSpeedMode.class).makeProfile();
+	}
+
+	public enum MaxSpeedMode {
+
+		TOTAL(R.string.shared_string_total, R.drawable.widget_track_recording_max_speed_day, R.drawable.widget_track_recording_max_speed_night),
+		LAST_DOWNHILL(R.string.shared_string_last_downhill, R.drawable.widget_track_recording_max_speed_last_downhill_day, R.drawable.widget_track_recording_max_speed_last_downhill_night),
+		LAST_UPHILL(R.string.shared_string_last_uphill, R.drawable.widget_track_recording_max_speed_last_uphill_day, R.drawable.widget_track_recording_max_speed_last_uphill_night);
+
+		@StringRes
+		final int titleId;
+		private final int dayIcon;
+		private final int nightIcon;
+
+		MaxSpeedMode(int titleId, int dayIcon, int nightIcon) {
+			this.titleId = titleId;
+			this.dayIcon = dayIcon;
+			this.nightIcon = nightIcon;
+		}
+
+		@StringRes
+		public int getTitleId() {
+			return titleId;
+		}
+
+		public int getIcon(boolean nightMode) {
+			return nightMode ? dayIcon : nightIcon;
+		}
+
+		@NonNull
+		public MaxSpeedMode next() {
+			int nextItemIndex = (ordinal() + 1) % values().length;
+			return values()[nextItemIndex];
+		}
+	}
+}
