diff --git a/OsmAnd/src/net/osmand/plus/OsmAndLocationSimulation.java b/OsmAnd/src/net/osmand/plus/OsmAndLocationSimulation.java
index 982c1137afa..79798d34c11 100644
--- a/OsmAnd/src/net/osmand/plus/OsmAndLocationSimulation.java
+++ b/OsmAnd/src/net/osmand/plus/OsmAndLocationSimulation.java
@@ -122,7 +122,7 @@ public void startStopRouteAnimation(@Nullable Activity activity, boolean useGpx,
 				UiUtilities.setupSlider(speedup, nightMode, selectedModeColor, true);
 				builder.setView(view);
 				builder.setPositiveButton(R.string.shared_string_ok, (dialog, which) -> {
-					boolean nightMode1 = activity instanceof MapActivity ? app.getDaynightHelper().isNightModeForMapControls() : !app.getSettings().isLightContent();
+					boolean nightMode1 = app.getDaynightHelper().isNightMode(activity instanceof MapActivity);
 					GpxUiHelper.selectGPXFile(activity, false, false, result -> {
 						startAnimationThread(app, result[0], 0, true, speedup.getValue() + 1);
 						if (runnable != null) {
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index d323e9ba844..716c2625b92 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -19,6 +19,7 @@
 import android.content.Intent;
 import android.content.IntentFilter;
 import android.content.pm.PackageManager;
+import android.content.res.Configuration;
 import android.net.Uri;
 import android.os.Build;
 import android.os.Bundle;
@@ -2115,6 +2116,19 @@ public void restart() {
 		}
 	}
 
+	@Override
+	public void onConfigurationChanged(@NonNull Configuration newConfig) {
+		super.onConfigurationChanged(newConfig);
+		List<Fragment> fragments = getSupportFragmentManager().getFragments();
+		for (Fragment fragment : fragments) {
+			getSupportFragmentManager()
+					.beginTransaction()
+					.detach(fragment)
+					.attach(fragment)
+					.commit();
+		}
+	}
+
 	@Override
 	public void onInAppPurchaseGetItems() {
 		DiscountHelper.checkAndDisplay(this);
diff --git a/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java b/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
index 9b5e42e840f..ec3ebdbdb89 100644
--- a/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
+++ b/OsmAnd/src/net/osmand/plus/activities/actions/AppModeDialog.java
@@ -214,11 +214,7 @@ public static View createToggle(LayoutInflater layoutInflater, OsmandApplication
 		return tb;
 	}
 
-	private static boolean isNightMode(OsmandApplication ctx, boolean useMapTheme) {
-		if (useMapTheme) {
-			return ctx.getDaynightHelper().isNightModeForMapControls();
-		} else {
-			return !ctx.getSettings().isLightContent();
-		}
+	private static boolean isNightMode(OsmandApplication app, boolean usedOnMap) {
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java b/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
index 0ad78336ce2..c010489508e 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
@@ -90,7 +90,6 @@ public class AuthorizeFragment extends BaseOsmAndFragment implements OnRegisterU
 	private boolean signIn;
 
 	private long lastTimeCodeSent;
-	private boolean nightMode;
 
 	@Override
 	public int getStatusBarColorId() {
@@ -115,7 +114,6 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		app = requireMyApplication();
 		settings = app.getSettings();
 		backupHelper = app.getBackupHelper();
-		nightMode = isNightMode(false);
 
 		if (savedInstanceState != null) {
 			if (savedInstanceState.containsKey(LOGIN_DIALOG_TYPE_KEY)) {
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/BackupAuthorizationFragment.java b/OsmAnd/src/net/osmand/plus/backup/ui/BackupAuthorizationFragment.java
index 6d6fe603ba4..ffad65d4d44 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/BackupAuthorizationFragment.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/BackupAuthorizationFragment.java
@@ -40,8 +40,6 @@ public class BackupAuthorizationFragment extends BaseOsmAndFragment implements I
 	private View signUpButton;
 	private View signInButton;
 
-	private boolean nightMode;
-
 	@ColorRes
 	public int getStatusBarColorId() {
 		AndroidUiHelper.setStatusBarContentColor(getView(), nightMode);
@@ -52,7 +50,6 @@ public int getStatusBarColorId() {
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = requireMyApplication();
-		nightMode = isNightMode(false);
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/ChangesFragment.java b/OsmAnd/src/net/osmand/plus/backup/ui/ChangesFragment.java
index 9a8789d1674..916a1bb130d 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/ChangesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/ChangesFragment.java
@@ -64,7 +64,6 @@ public class ChangesFragment extends BaseOsmAndFragment implements OnPrepareBack
 	private View buttonsShadow;
 
 	private RecentChangesType tabType;
-	private boolean nightMode;
 
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
@@ -72,7 +71,6 @@ public void onCreate(Bundle savedInstanceState) {
 		app = requireMyApplication();
 		backupHelper = app.getBackupHelper();
 		settingsHelper = app.getNetworkSettingsHelper();
-		nightMode = isNightMode(false);
 		if (savedInstanceState != null) {
 			tabType = RecentChangesType.valueOf(savedInstanceState.getString(SELECTED_TAB_TYPE_KEY, RECENT_CHANGES_LOCAL.name()));
 		}
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/ChangesTabFragment.java b/OsmAnd/src/net/osmand/plus/backup/ui/ChangesTabFragment.java
index 9cf5e9fb0db..00a7f6f7b50 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/ChangesTabFragment.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/ChangesTabFragment.java
@@ -49,8 +49,6 @@ public abstract class ChangesTabFragment extends BaseOsmAndFragment implements O
 	protected ChangesAdapter adapter;
 	protected RecentChangesType tabType = getChangesTabType();
 
-	protected boolean nightMode;
-
 	@NonNull
 	public abstract RecentChangesType getChangesTabType();
 
@@ -63,7 +61,6 @@ public void onCreate(Bundle savedInstanceState) {
 		app = requireMyApplication();
 		backupHelper = app.getBackupHelper();
 		settingsHelper = app.getNetworkSettingsHelper();
-		nightMode = isNightMode(false);
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
index 64ac4c48254..1d2c2824246 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseBottomSheetDialogFragment.java
@@ -47,9 +47,6 @@ public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !settings.isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
index 082430d602e..365c52bf4ae 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
@@ -19,6 +19,7 @@ public abstract class BaseOsmAndDialogFragment extends DialogFragment {
 	protected OsmandApplication app;
 	protected OsmandSettings settings;
 	protected UiUtilities iconsCache;
+	protected boolean nightMode;
 
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
@@ -27,11 +28,16 @@ public void onCreate(Bundle savedInstanceState) {
 		settings = app.getSettings();
 		iconsCache = app.getUIUtilities();
 
-		int themeId = isNightMode(false) ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
+		nightMode = isNightMode(useMapNightMode());
+		int themeId = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 		getActivity().getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
 	}
 
+	protected boolean useMapNightMode() {
+		return false;
+	}
+
 	protected Drawable getPaintedContentIcon(@DrawableRes int id, @ColorInt int color) {
 		return iconsCache.getPaintedIcon(id, color);
 	}
@@ -49,9 +55,6 @@ protected Drawable getContentIcon(@DrawableRes int id) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !settings.isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
index 7ba57acedcb..fb2aa5f8237 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
@@ -2,6 +2,7 @@
 
 import android.app.Activity;
 import android.graphics.drawable.Drawable;
+import android.os.Bundle;
 import android.view.View;
 import android.view.animation.Animation;
 import android.widget.ImageView;
@@ -32,6 +33,17 @@ public class BaseOsmAndFragment extends Fragment implements TransitionAnimator {
 
 	private int statusBarColor = -1;
 	private boolean transitionAnimationAllowed = true;
+	protected boolean nightMode;
+
+	@Override
+	public void onCreate(@Nullable Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		nightMode = isNightMode(useMapNightMode());
+	}
+
+	protected boolean useMapNightMode() {
+		return false;
+	}
 
 	@Override
 	public void onResume() {
@@ -208,10 +220,6 @@ protected int getDimensionPixelSize(@DimenRes int resId) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		OsmandApplication app = requireMyApplication();
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !app.getSettings().isLightContent();
+		return requireMyApplication().getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
index 2f0066cdc40..7f46e091ff2 100644
--- a/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BottomSheetBehaviourDialogFragment.java
@@ -252,9 +252,6 @@ private int getButtonsContainerBg() {
 	}
 
 	protected boolean isNightMode(@NonNull OsmandApplication app) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
index 8ac37e6195c..09800a430e3 100644
--- a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
@@ -193,10 +193,7 @@ protected String getThemeInfoProviderTag() {
 	}
 
 	public void updateNightMode() {
-		OsmandApplication app = getMyApplication();
-		if (app != null) {
-			nightMode = app.getDaynightHelper().isNightModeForMapControls();
-		}
+		nightMode = requireMyApplication().getDaynightHelper().isNightModeForMapControls();
 	}
 
 	public String getPreferredMapLang() {
diff --git a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
index 171063ba5d2..17956114837 100644
--- a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
@@ -475,10 +475,7 @@ protected LayerDrawable createBackgroundDrawable(@NonNull Context ctx, @Drawable
 	}
 
 	protected boolean isNightMode(@NonNull OsmandApplication app) {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 
 	private void showShadowButton() {
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/BasePurchaseDialogFragment.java b/OsmAnd/src/net/osmand/plus/chooseplan/BasePurchaseDialogFragment.java
index 086bc8edb33..66ca15039f0 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/BasePurchaseDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/BasePurchaseDialogFragment.java
@@ -46,9 +46,6 @@ public abstract class BasePurchaseDialogFragment extends BaseOsmAndDialogFragmen
 	protected NestedScrollView scrollView;
 	protected LayoutInflater themedInflater;
 
-	protected boolean nightMode;
-	protected boolean usedOnMap;
-
 	private int lastScrollY;
 	private int lastKnownToolbarOffset;
 
@@ -84,11 +81,14 @@ protected int getStatusBarColorId() {
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		purchaseHelper = app.getInAppPurchaseHelper();
-		usedOnMap = getMapActivity() != null;
-		nightMode = isNightMode(usedOnMap);
 		themedInflater = UiUtilities.getInflater(getActivity(), nightMode);
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return getMapActivity() != null;
+	}
+
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(Bundle savedInstanceState) {
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java b/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
index 41c59267062..7de7b798470 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
@@ -171,7 +171,7 @@ private void createTroubleshootingCard() {
 		FragmentActivity activity = getActivity();
 		if (activity != null) {
 			FrameLayout container = mainView.findViewById(R.id.troubleshooting_card);
-			TroubleshootingCard card = new TroubleshootingCard(activity, purchaseHelper, usedOnMap);
+			TroubleshootingCard card = new TroubleshootingCard(activity, purchaseHelper, useMapNightMode());
 			card.setListener(this);
 			container.addView(card.build(activity));
 		}
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/OsmAndProPlanFragment.java b/OsmAnd/src/net/osmand/plus/chooseplan/OsmAndProPlanFragment.java
index 489a1f63882..47311820104 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/OsmAndProPlanFragment.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/OsmAndProPlanFragment.java
@@ -56,14 +56,14 @@ protected String getTagline() {
 
 	@Override
 	protected int getHeaderIconId() {
-		return isNightMode(usedOnMap) ?
+		return nightMode ?
 				R.drawable.ic_action_osmand_pro_logo_colored_night :
 				R.drawable.ic_action_osmand_pro_logo_colored;
 	}
 
 	public static List<PriceButton<?>> collectPriceButtons(OsmandApplication app,
 														   InAppPurchaseHelper purchaseHelper,
-														   boolean nightMode) {
+	                                                       boolean nightMode) {
 		List<InAppSubscription> subscriptions = getVisibleSubscriptions(app, purchaseHelper);
 		List<SubscriptionButton> subscriptionButtons =
 				PurchasingUtils.collectSubscriptionButtons(app, purchaseHelper, subscriptions, nightMode);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/SearchTrackItemsFragment.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/SearchTrackItemsFragment.java
index a9e4a0dea5f..d2af004f5a0 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/SearchTrackItemsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/SearchTrackItemsFragment.java
@@ -52,7 +52,6 @@ public class SearchTrackItemsFragment extends BaseOsmAndDialogFragment implement
 	private Float heading;
 	private boolean locationUpdateStarted;
 	private boolean compassUpdateAllowed = true;
-	private boolean nightMode;
 
 	private View applyButton;
 	private View buttonsContainer;
@@ -64,9 +63,8 @@ public class SearchTrackItemsFragment extends BaseOsmAndDialogFragment implement
 	private SelectedTracksHelper selectedTracksHelper;
 
 	@Override
-	public void onCreate(@Nullable Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(true);
+	protected boolean useMapNightMode() {
+		return true;
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/TrackItemsFragment.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/TrackItemsFragment.java
index f207096e90c..40517feff0d 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/TrackItemsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/TrackItemsFragment.java
@@ -36,7 +36,6 @@ public class TrackItemsFragment extends BaseOsmAndFragment implements OsmAndComp
 	private Float heading;
 	private boolean locationUpdateStarted;
 	private boolean compassUpdateAllowed = true;
-	private boolean nightMode;
 
 	public TrackTab getTrackTab() {
 		return trackTab;
@@ -50,7 +49,11 @@ public void setTrackTab(@NonNull TrackTab trackTab) {
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = requireMyApplication();
-		nightMode = isNightMode(true);
+	}
+
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
 	}
 
 	@Nullable
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksAppearanceFragment.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksAppearanceFragment.java
index 28b339b59a3..37229b8e5e4 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksAppearanceFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksAppearanceFragment.java
@@ -79,8 +79,6 @@ public class TracksAppearanceFragment extends BaseOsmAndDialogFragment implement
 	private PromoBannerCard promoCard;
 	private View applyButton;
 
-	private boolean nightMode;
-
 	@ColorRes
 	public int getStatusBarColorId() {
 		AndroidUiHelper.setStatusBarContentColor(getView(), nightMode);
@@ -93,7 +91,6 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		gpxDbHelper = app.getGpxDbHelper();
 		gpxSelectionHelper = app.getSelectedGpxHelper();
 		selectedTracksHelper = getSelectedTracksHelper();
-		nightMode = isNightMode(true);
 
 		if (savedInstanceState != null) {
 			trackDrawInfo = new TrackDrawInfo(savedInstanceState);
@@ -102,6 +99,11 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		}
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
index 5f106403a17..ab0947fdcb9 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
@@ -87,7 +87,6 @@ public class TracksFragment extends BaseOsmAndDialogFragment implements LoadTrac
 	private View applyButton;
 	private View selectionButton;
 
-	private boolean nightMode;
 	private int tabSize;
 
 	@NonNull
@@ -106,7 +105,11 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		importHelper = new ImportHelper(requireActivity());
 		selectedTracksHelper = new SelectedTracksHelper(app);
-		nightMode = isNightMode(true);
+	}
+
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
index 22ced1a472c..b753a8960b0 100644
--- a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
+++ b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
@@ -534,7 +534,7 @@ public void setDashboardVisibility(boolean visible, DashboardType type, boolean
 			return;
 		}
 		mapActivity.getRoutingHelper().removeListener(this);
-		nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		nightMode = getMyApplication().getDaynightHelper().isNightModeForMapControls();
 		this.visible = visible;
 		updateVisibilityStack(type, visible);
 		ApplicationMode currentAppMode = getMyApplication().getSettings().APPLICATION_MODE.get();
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/DownloadResourceGroupFragment.java b/OsmAnd/src/net/osmand/plus/download/ui/DownloadResourceGroupFragment.java
index 3cecd6c2f2c..2dd42ba389e 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/DownloadResourceGroupFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/DownloadResourceGroupFragment.java
@@ -82,14 +82,12 @@ public class DownloadResourceGroupFragment extends BaseOsmAndDialogFragment impl
 	private View subscribeEmailView;
 	private View freeMapsView;
 	private View descriptionView;
-	private boolean nightMode;
 
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		downloadThread = app.getDownloadThread();
 		purchaseHelper = getDownloadActivity().getPurchaseHelper();
-		nightMode = isNightMode(false);
 		int themeId = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		setStyle(STYLE_NO_FRAME, themeId);
 		setHasOptionsMenu(true);
diff --git a/OsmAnd/src/net/osmand/plus/download/ui/LocalIndexesFragment.java b/OsmAnd/src/net/osmand/plus/download/ui/LocalIndexesFragment.java
index 746129eaf83..4ea37bce2f1 100644
--- a/OsmAnd/src/net/osmand/plus/download/ui/LocalIndexesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/ui/LocalIndexesFragment.java
@@ -456,7 +456,7 @@ private void openSelectionMode(int actionResId, int actionIconId,
 		}
 
 		OsmandApplication app = requireMyApplication();
-		int colorResId = ColorUtilities.getActiveButtonsAndLinksTextColorId(isNightMode(false));
+		int colorResId = ColorUtilities.getActiveButtonsAndLinksTextColorId(nightMode);
 		String value = getString(actionResId);
 		if (value.endsWith("...")) {
 			value = value.substring(0, value.length() - 3);
diff --git a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
index 624ca63f2d7..73c9ff4b97c 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
@@ -110,6 +110,14 @@ private StateChangedListener<DayNightMode> getPreferenceStateListener() {
 		return preferenceStateListener;
 	}
 
+	public boolean isNightMode(boolean usedOnMap) {
+		if (usedOnMap) {
+			return isNightModeForMapControls();
+		} else {
+			return !app.getSettings().isLightContent();
+		}
+	}
+
 	public boolean isNightModeForMapControls() {
 		return isNightModeForMapControlsForProfile(settings.APPLICATION_MODE.get());
 	}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java b/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
index 774c6a103cc..820d4d77754 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
@@ -101,12 +101,9 @@ public class ImportTracksFragment extends BaseOsmAndDialogFragment implements On
 	private TextView progressTitle;
 	private RecyclerView recyclerView;
 
-	private boolean nightMode;
-
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(true);
 
 		if (savedInstanceState == null) {
 			collectTracks();
@@ -122,6 +119,11 @@ public void handleOnBackPressed() {
 		});
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(Bundle savedInstanceState) {
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ui/SelectPointsFragment.java b/OsmAnd/src/net/osmand/plus/importfiles/ui/SelectPointsFragment.java
index b959ceed090..0f9208636cb 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/ui/SelectPointsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ui/SelectPointsFragment.java
@@ -69,12 +69,10 @@ public class SelectPointsFragment extends BaseOsmAndDialogFragment implements On
 	private Float heading;
 	private Location location;
 	private boolean locationUpdateStarted;
-	private boolean nightMode;
 
 	@Override
-	public void onCreate(@Nullable Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(true);
+	protected boolean useMapNightMode() {
+		return true;
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/liveupdates/LiveUpdatesFragment.java b/OsmAnd/src/net/osmand/plus/liveupdates/LiveUpdatesFragment.java
index 5a67f9d27a2..39f0d86008d 100644
--- a/OsmAnd/src/net/osmand/plus/liveupdates/LiveUpdatesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/liveupdates/LiveUpdatesFragment.java
@@ -97,8 +97,6 @@ public class LiveUpdatesFragment extends BaseOsmAndDialogFragment implements OnL
 	public static final String TAG = LiveUpdatesFragment.class.getSimpleName();
 	private static final Log LOG = PlatformUtil.getLog(LiveUpdatesFragment.class);
 
-	private boolean nightMode;
-
 	private View toolbarSwitchContainer;
 	private ExpandableListView listView;
 	private TextViewEx descriptionTime;
@@ -134,7 +132,6 @@ public static void showUpdateDialog(Activity activity, FragmentManager fragmentM
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
 		setHasOptionsMenu(true);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/MapMarkerEditorFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/MapMarkerEditorFragment.java
index 06acb8eda81..9b8f73edfee 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/MapMarkerEditorFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/MapMarkerEditorFragment.java
@@ -33,7 +33,6 @@ public class MapMarkerEditorFragment extends BaseOsmAndFragment {
 
 	@Nullable
 	private MapMarkerEditor editor;
-	private boolean nightMode;
 	private boolean cancelled;
 
 	private EditText nameEdit;
@@ -42,7 +41,6 @@ public class MapMarkerEditorFragment extends BaseOsmAndFragment {
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		editor = ((MapActivity) requireActivity()).getContextMenu().getMapMarkerEditor();
-		nightMode = isNightMode(true);
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
index 832e6639891..fb4556b92ee 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/DirectionIndicationDialogFragment.java
@@ -53,8 +53,6 @@ public class DirectionIndicationDialogFragment extends BaseOsmAndDialogFragment
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		boolean nightMode = isNightMode(false);
-		
 		helpImgHeight = getResources().getDimensionPixelSize(R.dimen.action_bar_image_height);
 
 		mainView = UiUtilities.getInflater(getContext(), nightMode)
diff --git a/OsmAnd/src/net/osmand/plus/mapsource/EditMapSourceDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapsource/EditMapSourceDialogFragment.java
index 3a8d83d6e08..290672e5542 100644
--- a/OsmAnd/src/net/osmand/plus/mapsource/EditMapSourceDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapsource/EditMapSourceDialogFragment.java
@@ -97,7 +97,6 @@ public class EditMapSourceDialogFragment extends BaseOsmAndDialogFragment
 	private int expireTimeMinutes = EXPIRE_TIME_NEVER;
 	private boolean elliptic;
 	private boolean sqliteDB;
-	private boolean nightMode;
 	private boolean fromTemplate;
 	private boolean wasChanged;
 
@@ -124,12 +123,6 @@ public static void showInstance(@NonNull FragmentManager fragmentManager,
 		}
 	}
 
-	@Override
-	public void onCreate(Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
-	}
-
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		if (savedInstanceState != null) {
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java b/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
index 2aeede181e6..d2d2a0ce9cf 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/graph/BaseChartAdapter.java
@@ -87,9 +87,7 @@ public void setLayoutChangeListener(@Nullable LayoutChangeListener layoutChangeL
 	}
 
 	protected boolean isNightMode() {
-		return usedOnMap ?
-				app.getDaynightHelper().isNightModeForMapControls() :
-				!app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 
 	public interface ExternalValueSelectedListener {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/EditDeviceNameDialog.java b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/EditDeviceNameDialog.java
index 36e259b49da..a04d22f75b6 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/EditDeviceNameDialog.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/externalsensors/dialogs/EditDeviceNameDialog.java
@@ -42,7 +42,6 @@ public class EditDeviceNameDialog extends BaseOsmAndDialogFragment {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		boolean nightMode = isNightMode(true);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.dialog_edit_device_name, container, false);
 
@@ -71,18 +70,23 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		return view;
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
 		Activity ctx = requireActivity();
-		int themeId = isNightMode(true) ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
+		int themeId = nightMode ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
 		Dialog dialog = new Dialog(ctx, themeId);
 		Window window = dialog.getWindow();
 		if (window != null) {
 			if (!settings.DO_NOT_USE_ANIMATIONS.get()) {
 				window.getAttributes().windowAnimations = R.style.Animations_Alpha;
 			}
-			int statusBarColor = ColorUtilities.getActivityBgColor(ctx, isNightMode(true));
+			int statusBarColor = ColorUtilities.getActivityBgColor(ctx, nightMode);
 			window.setStatusBarColor(statusBarColor);
 		}
 		return dialog;
@@ -107,10 +111,10 @@ private void setupSaveButton(View view) {
 		});
 
 		Context ctx = btnSaveContainer.getContext();
-		AndroidUtils.setBackground(ctx, btnSaveContainer, isNightMode(true), R.drawable.ripple_light, R.drawable.ripple_dark);
+		AndroidUtils.setBackground(ctx, btnSaveContainer, nightMode, R.drawable.ripple_light, R.drawable.ripple_dark);
 
 		View btnSave = view.findViewById(R.id.btn_save);
-		int drawableRes = isNightMode(true) ? R.drawable.btn_solid_border_dark : R.drawable.btn_solid_border_light;
+		int drawableRes = nightMode ? R.drawable.btn_solid_border_dark : R.drawable.btn_solid_border_light;
 		AndroidUtils.setBackground(btnSave, getIcon(drawableRes));
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/EditPoiDialogFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/EditPoiDialogFragment.java
index 9420492bab7..03e908554bd 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/EditPoiDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/EditPoiDialogFragment.java
@@ -152,7 +152,6 @@ public void onCreate(Bundle savedInstanceState) {
 
 	@Override
 	public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-		boolean nightMode = isNightMode(false);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		view = themedInflater.inflate(R.layout.fragment_edit_poi, container, false);
 
@@ -245,7 +244,7 @@ public void onGlobalLayout() {
 			}
 		});
 
-		int activeColor = ColorUtilities.getActiveColor(getContext(), isNightMode(false));
+		int activeColor = ColorUtilities.getActiveColor(getContext(), nightMode);
 		onlineDocumentationButton.setImageDrawable(getPaintedContentIcon(R.drawable.ic_action_help, activeColor));
 		ImageButton poiTypeButton = view.findViewById(R.id.poiTypeButton);
 		poiTypeButton.setOnClickListener(new View.OnClickListener() {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
index 8c13e9c39f1..6bdf73ee7b1 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/dialogs/SaveExtraValidationDialogFragment.java
@@ -40,7 +40,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {
 
 	private boolean isNightMode() {
 		OsmandApplication app = ((OsmandApplication) requireActivity().getApplication());
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(false);
 	}
 
 	private String getMessageToShow() {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/AdvancedEditPoiFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/AdvancedEditPoiFragment.java
index 257d1024953..f967ff15045 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/AdvancedEditPoiFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/AdvancedEditPoiFragment.java
@@ -75,7 +75,6 @@ public class AdvancedEditPoiFragment extends BaseOsmAndFragment implements OnFra
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
 		OsmandApplication app = requireMyApplication();
-		boolean nightMode = isNightMode(false);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.fragment_edit_poi_advanced, container, false);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/BasicEditPoiFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/BasicEditPoiFragment.java
index f49fe378754..eb126608416 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/BasicEditPoiFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/BasicEditPoiFragment.java
@@ -72,7 +72,6 @@ public class BasicEditPoiFragment extends BaseOsmAndFragment implements OnFragme
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		app = requireMyApplication();
 
-		boolean nightMode = isNightMode(false);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.fragment_edit_poi_normal, container, false);
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/MappersPromoFragment.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/MappersPromoFragment.java
index 1d911ad8b40..c9f074b4c87 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/MappersPromoFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/fragments/MappersPromoFragment.java
@@ -21,16 +21,16 @@
 import androidx.fragment.app.FragmentActivity;
 import androidx.fragment.app.FragmentManager;
 
-import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.R;
-import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.chooseplan.BasePurchaseDialogFragment;
 import net.osmand.plus.chooseplan.OsmAndFeature;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.plugins.osmedit.oauth.OsmOAuthHelper;
 import net.osmand.plus.plugins.osmedit.oauth.OsmOAuthHelper.OsmAuthorizationListener;
 import net.osmand.plus.settings.bottomsheets.OsmLoginDataBottomSheet;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.utils.ColorUtilities;
+import net.osmand.plus.utils.UiUtilities;
 
 import java.util.ArrayList;
 import java.util.List;
@@ -153,7 +153,7 @@ private void setupUseLoginAndPasswordButton() {
 		button.setOnClickListener(v -> {
 			FragmentManager fragmentManager = getFragmentManager();
 			if (fragmentManager != null) {
-				OsmLoginDataBottomSheet.showInstance(fragmentManager, OSM_LOGIN_DATA, getTargetFragment(), usedOnMap, null);
+				OsmLoginDataBottomSheet.showInstance(fragmentManager, OSM_LOGIN_DATA, getTargetFragment(), useMapNightMode(), null);
 			}
 		});
 	}
diff --git a/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java b/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
index d227e6f447e..d35068617bd 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/osmedit/menu/OsmNotesMenu.java
@@ -136,11 +136,8 @@ private static String[] getZoomStrings(Context context) {
 		return res;
 	}
 
-	public static boolean isNightMode(OsmandApplication app) {
-		if (app == null) {
-			return false;
-		}
-		return app.getDaynightHelper().isNightModeForMapControls();
+	public static boolean isNightMode(@NonNull OsmandApplication app) {
+		return app.getDaynightHelper().isNightMode(true);
 	}
 
 	public static int getThemeRes(OsmandApplication app) {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
index 63467ce0dd2..2243720fe65 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
@@ -120,7 +120,6 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		app = requireMyApplication();
 		settings = requireSettings();
 		downloadTilesHelper = app.getDownloadTilesHelper();
-		nightMode = isNightMode(true);
 		mapView = requireMapActivity().getMapView();
 		tilesPreviewDrawer = new TilesPreviewDrawer(app);
 		tileSource = settings.getLayerTileSource(layerToDownload.getMapLayerSettings(app), false);
@@ -142,6 +141,11 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		}
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
 		MapActivity mapActivity = requireMapActivity();
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
index 4850647655e..4f538670a0f 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/OsmandRasterMapsPlugin.java
@@ -658,7 +658,7 @@ private static boolean isNightMode(Context context) {
 			return false;
 		}
 		OsmandApplication app = (OsmandApplication) context.getApplicationContext();
-		return context instanceof MapActivity ? app.getDaynightHelper().isNightModeForMapControls() : !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(context instanceof MapActivity);
 	}
 
 	private static int getThemeRes(Context context) {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesDownloadProgressFragment.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesDownloadProgressFragment.java
index 23d8aa8c02b..0a1483c11ff 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesDownloadProgressFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/TilesDownloadProgressFragment.java
@@ -81,16 +81,12 @@ public class TilesDownloadProgressFragment extends BaseOsmAndFragment implements
 	private float approxSizeMb;
 	private float downloadedSizeMb;
 
-	private boolean nightMode;
-
-
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		app = requireMyApplication();
 		settings = app.getSettings();
 		downloadTilesHelper = app.getDownloadTilesHelper();
-		nightMode = isNightMode(true);
 
 		Bundle args = getArguments();
 		if (args != null) {
@@ -108,6 +104,11 @@ public void handleOnBackPressed() {
 		});
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	private void restoreState(@NonNull Bundle savedState) {
 		progress = savedState.getInt(KEY_PROGRESS);
 		downloadedSizeMb = savedState.getFloat(KEY_DOWNLOADED_SIZE_MB);
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
index f312e1698a4..146d0a7b165 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/ContourLinesMenu.java
@@ -338,13 +338,6 @@ private static ProgressListener getSrtmItemProgressListener(SrtmDownloadItem srt
 		};
 	}
 
-	public static boolean isNightMode(OsmandApplication app) {
-		if (app == null) {
-			return false;
-		}
-		return app.getDaynightHelper().isNightModeForMapControls();
-	}
-
 	public static void closeDashboard(MapActivity mapActivity) {
 		mapActivity.getDashboard().hideDashboard(false);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
index e6bb3d0a0df..2eb68b4395c 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/SRTMPlugin.java
@@ -554,7 +554,7 @@ private static boolean isNightMode(Activity activity, OsmandApplication app) {
 		if (activity == null || app == null) {
 			return false;
 		}
-		return activity instanceof MapActivity ? app.getDaynightHelper().isNightModeForMapControls() : !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(activity instanceof MapActivity);
 	}
 
 	private static int getThemeRes(Activity activity, OsmandApplication app) {
diff --git a/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java b/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
index 51cd33974ea..abfa688dca7 100644
--- a/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
+++ b/OsmAnd/src/net/osmand/plus/poi/RearrangePoiFiltersFragment.java
@@ -119,7 +119,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 
 		ItemTouchHelper touchHelper = new ItemTouchHelper(new ReorderItemTouchHelperCallback(adapter));
 		touchHelper.attachToRecyclerView(recyclerView);
-		
+
 		orderModified = app.getSettings().POI_FILTERS_ORDER.get() != null;
 		activationModified = app.getSettings().INACTIVE_POI_FILTERS.get() != null;
 
@@ -172,7 +172,7 @@ public void onDeleteClicked(int position) {
 					items.remove(item);
 					adapter.notifyDataSetChanged();
 					Snackbar snackbar = Snackbar.make(requireView(),
-							getString(R.string.item_deleted, poiInfo.name), Snackbar.LENGTH_LONG)
+									getString(R.string.item_deleted, poiInfo.name), Snackbar.LENGTH_LONG)
 							.setAction(R.string.shared_string_undo, new View.OnClickListener() {
 								@Override
 								public void onClick(View view) {
@@ -401,7 +401,7 @@ public void onClick(View v) {
 				initFiltersOrders(app, true);
 			}
 		})));
-		items.add(new ListItem(DESCRIPTION, 
+		items.add(new ListItem(DESCRIPTION,
 //				app.getString(R.string.add_new_custom_category_button_promo) + '\n' + 
 				app.getString(R.string.reset_to_default_category_button_promo)));
 
@@ -500,11 +500,8 @@ protected OsmandApplication requireMyApplication() {
 		return (OsmandApplication) activity.getApplication();
 	}
 
-	public static boolean isNightMode(OsmandApplication app, boolean usedOnMap) {
-		if (app != null) {
-			return usedOnMap ? app.getDaynightHelper().isNightModeForMapControls() : !app.getSettings().isLightContent();
-		}
-		return false;
+	public static boolean isNightMode(@NonNull OsmandApplication app, boolean usedOnMap) {
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/quickaction/SelectTrackFileDialogFragment.java b/OsmAnd/src/net/osmand/plus/quickaction/SelectTrackFileDialogFragment.java
index 113ca7f55e3..84689d689bd 100644
--- a/OsmAnd/src/net/osmand/plus/quickaction/SelectTrackFileDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/quickaction/SelectTrackFileDialogFragment.java
@@ -40,7 +40,7 @@ public class SelectTrackFileDialogFragment extends BaseOsmAndDialogFragment {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), isNightMode());
+		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.select_track_file_dialog_fragment, container, false);
 		setupToolbar(view);
 		setupRecyclerView(view);
@@ -49,7 +49,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 
 	private void setupToolbar(@NonNull View root) {
 		Toolbar toolbar = root.findViewById(R.id.toolbar);
-		int closeIconColor = ColorUtilities.getActiveButtonsAndLinksTextColorId(isNightMode());
+		int closeIconColor = ColorUtilities.getActiveButtonsAndLinksTextColorId(nightMode);
 		Drawable closeIcon = getIcon(R.drawable.ic_action_close, closeIconColor);
 		toolbar.setNavigationIcon(closeIcon);
 		toolbar.setNavigationOnClickListener(v -> dismiss());
@@ -97,8 +97,9 @@ private void processResult(File gpxRootDir, List<GPXInfo> gpxInfoList, boolean s
 		}
 	}
 
-	private boolean isNightMode() {
-		return isNightMode(true);
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
 	}
 
 	public static void showInstance(@NonNull FragmentManager fragmentManager,
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
index 4864d6f1aa3..68c6e3805e7 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
@@ -156,9 +156,9 @@ public void selectVoiceGuidance(MapActivity mapActivity, CallbackWithObject<Stri
 		entries[k] = mapActivity.getResources().getString(R.string.install_more);
 		contextMenuAdapter.addItem(new ContextMenuItem(null).setTitle(entries[k]));
 
-		boolean nightMode = isNightMode(app);
+		boolean nightMode = isNightMode();
 		Context themedContext = UiUtilities.getThemedContext(mapActivity, nightMode);
-		int themeRes = getThemeRes(app);
+		int themeRes = getThemeRes();
 		ApplicationMode selectedAppMode = app.getRoutingHelper().getAppMode();
 		int selectedModeColor = selectedAppMode.getProfileColor(nightMode);
 		DialogListItemAdapter dialogAdapter = DialogListItemAdapter.createSingleChoiceAdapter(
@@ -349,7 +349,7 @@ public void showLocalRoutingParameterGroupDialog(LocalRoutingParameterGroup grou
 			selectedIndex = 0;
 		}
 
-		boolean nightMode = isNightMode(app);
+		boolean nightMode = isNightMode();
 		Context themedContext = UiUtilities.getThemedContext(mapActivity, nightMode);
 		ApplicationMode selectedAppMode = app.getRoutingHelper().getAppMode();
 		int selectedModeColor = selectedAppMode.getProfileColor(nightMode);
@@ -645,15 +645,12 @@ public GeneralRouter.RoutingParameter getRoutingPrefsForAppModeById(ApplicationM
 		return parameter;
 	}
 	
-	public boolean isNightMode(OsmandApplication app) {
-		if (app == null) {
-			return false;
-		}
+	public boolean isNightMode() {
 		return app.getDaynightHelper().isNightModeForMapControls();
 	}
 	
-	public int getThemeRes(OsmandApplication app) {
-		return isNightMode(app) ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
+	public int getThemeRes() {
+		return isNightMode() ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 	}
 
 	public static class LocalRoutingParameter {
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
index d4d1371d841..171c45374a2 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/WaypointsFragment.java
@@ -397,7 +397,7 @@ public void applyDayNightMode() {
 			return;
 		}
 		boolean landscapeLayout = !portrait;
-		boolean nightMode = mapActivity.getMyApplication().getDaynightHelper().isNightModeForMapControls();
+		boolean nightMode = getMyApplication().getDaynightHelper().isNightModeForMapControls();
 		int colorActive = ContextCompat.getColor(mapActivity, ColorUtilities.getActiveColorId(nightMode));
 		if (!landscapeLayout) {
 			AndroidUtils.setBackground(mapActivity, mainView, nightMode, R.drawable.route_info_menu_bg_light, R.drawable.route_info_menu_bg_dark);
diff --git a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
index 97576626a80..723d4ea2bae 100644
--- a/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
+++ b/OsmAnd/src/net/osmand/plus/routing/cards/RouteLineColorCard.java
@@ -96,8 +96,8 @@ public RouteLineColorCard(@NonNull MapActivity mapActivity,
 			nightMapTheme = savedInstanceState.getBoolean(IS_NIGHT_MAP_THEME);
 		}
 		if (nightMapTheme == null) {
-			DayNightHelper themeHelper = app.getDaynightHelper();
-			nightMapTheme = themeHelper.isNightModeForMapControls();
+			DayNightHelper dayNightHelper = app.getDaynightHelper();
+			nightMapTheme = dayNightHelper.isNightModeForMapControls();
 		}
 		isNightMapTheme = nightMapTheme;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/search/QuickSearchSubCategoriesFragment.java b/OsmAnd/src/net/osmand/plus/search/QuickSearchSubCategoriesFragment.java
index b9eac4f9dfd..aef02c10c70 100644
--- a/OsmAnd/src/net/osmand/plus/search/QuickSearchSubCategoriesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/QuickSearchSubCategoriesFragment.java
@@ -56,7 +56,6 @@ public class QuickSearchSubCategoriesFragment extends BaseOsmAndDialogFragment {
 	private View footerShadow;
 	private FrameLayout addButton;
 	private boolean selectAll;
-	private boolean nightMode;
 
 	public static void showInstance(@NonNull FragmentManager fm,
 									@Nullable Fragment targetFragment,
@@ -74,7 +73,6 @@ public static void showInstance(@NonNull FragmentManager fm,
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
 		if (savedInstanceState != null) {
 			poiCategory = app.getPoiTypes().getPoiCategoryByName(savedInstanceState.getString(CATEGORY_NAME_KEY));
 			selectAll = savedInstanceState.getBoolean(ALL_SELECTED_KEY);
diff --git a/OsmAnd/src/net/osmand/plus/settings/datastorage/StorageMigrationFragment.java b/OsmAnd/src/net/osmand/plus/settings/datastorage/StorageMigrationFragment.java
index 6b97a2d9ae4..c2515d970c1 100644
--- a/OsmAnd/src/net/osmand/plus/settings/datastorage/StorageMigrationFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/datastorage/StorageMigrationFragment.java
@@ -81,7 +81,6 @@ public class StorageMigrationFragment extends BaseOsmAndDialogFragment implement
 	private int generalProgress;
 	private boolean copyFinished;
 
-	private boolean nightMode;
 	private boolean usedOnMap;
 
 	private AlertDialog closeDialog = null;
@@ -112,6 +111,11 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 		nightMode = isNightMode(usedOnMap);
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return usedOnMap;
+	}
+
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/HistoryItemsFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/HistoryItemsFragment.java
index 4e35df64420..22e36ab4c6c 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/HistoryItemsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/HistoryItemsFragment.java
@@ -63,12 +63,10 @@ public abstract class HistoryItemsFragment extends BaseOsmAndDialogFragment impl
 	private Location location;
 	private boolean locationUpdateStarted;
 	private boolean compassUpdateAllowed = true;
-	protected boolean nightMode;
 
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
 		updateHistoryItems();
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/settings/purchase/PurchaseItemFragment.java b/OsmAnd/src/net/osmand/plus/settings/purchase/PurchaseItemFragment.java
index 5fb592f5edd..676cbe80b40 100644
--- a/OsmAnd/src/net/osmand/plus/settings/purchase/PurchaseItemFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/purchase/PurchaseItemFragment.java
@@ -55,12 +55,9 @@ public class PurchaseItemFragment extends BaseOsmAndDialogFragment implements In
 	private boolean isToolbarInitialized;
 	private LayoutInflater themedInflater;
 
-	private boolean nightMode;
-
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
 		Bundle args = getArguments();
 		if (args != null) {
 			purchaseSku = args.getString(PURCHASE_SKU_ARG);
diff --git a/OsmAnd/src/net/osmand/plus/settings/purchase/PurchasesFragment.java b/OsmAnd/src/net/osmand/plus/settings/purchase/PurchasesFragment.java
index d8bc75228be..9769af25394 100644
--- a/OsmAnd/src/net/osmand/plus/settings/purchase/PurchasesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/purchase/PurchasesFragment.java
@@ -49,14 +49,6 @@ public class PurchasesFragment extends BaseOsmAndDialogFragment implements InApp
 	private ViewGroup cardsContainer;
 	private LayoutInflater themedInflater;
 
-	private boolean nightMode;
-
-	@Override
-	public void onCreate(@Nullable Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
-	}
-
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		themedInflater = UiUtilities.getInflater(getContext(), nightMode);
diff --git a/OsmAnd/src/net/osmand/plus/track/fragments/EditDescriptionFragment.java b/OsmAnd/src/net/osmand/plus/track/fragments/EditDescriptionFragment.java
index b18b7da64f2..3df1c8a4d4e 100644
--- a/OsmAnd/src/net/osmand/plus/track/fragments/EditDescriptionFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/fragments/EditDescriptionFragment.java
@@ -36,7 +36,6 @@ public class EditDescriptionFragment extends BaseOsmAndDialogFragment {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		boolean nightMode = isNightMode(true);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.dialog_edit_gpx_description, container, false);
 
@@ -64,18 +63,23 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		return view;
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
 		Activity ctx = requireActivity();
-		int themeId = isNightMode(true) ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
+		int themeId = nightMode ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
 		Dialog dialog = new Dialog(ctx, themeId);
 		Window window = dialog.getWindow();
 		if (window != null) {
 			if (!settings.DO_NOT_USE_ANIMATIONS.get()) {
 				window.getAttributes().windowAnimations = R.style.Animations_Alpha;
 			}
-			int statusBarColor = ColorUtilities.getActivityBgColor(ctx, isNightMode(true));
+			int statusBarColor = ColorUtilities.getActivityBgColor(ctx, nightMode);
 			window.setStatusBarColor(statusBarColor);
 		}
 		return dialog;
@@ -99,10 +103,10 @@ private void setupSaveButton(View view) {
 		});
 
 		Context ctx = btnSaveContainer.getContext();
-		AndroidUtils.setBackground(ctx, btnSaveContainer, isNightMode(true), R.drawable.ripple_light, R.drawable.ripple_dark);
+		AndroidUtils.setBackground(ctx, btnSaveContainer, nightMode, R.drawable.ripple_light, R.drawable.ripple_dark);
 
 		View btnSave = view.findViewById(R.id.btn_save);
-		int drawableRes = isNightMode(true) ? R.drawable.btn_solid_border_dark : R.drawable.btn_solid_border_light;
+		int drawableRes = nightMode ? R.drawable.btn_solid_border_dark : R.drawable.btn_solid_border_light;
 		AndroidUtils.setBackground(btnSave, getIcon(drawableRes));
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java b/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
index 9d045c8241d..252e37e005f 100644
--- a/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
@@ -68,7 +68,6 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 	@Nullable
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-		boolean nightMode = isNightMode(true);
 		LayoutInflater themedInflater = UiUtilities.getInflater(requireContext(), nightMode);
 		View view = themedInflater.inflate(R.layout.dialog_read_description, container, false);
 		setupToolbar(view);
@@ -77,6 +76,11 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		return view;
 	}
 
+	@Override
+	protected boolean useMapNightMode() {
+		return true;
+	}
+
 	@Override
 	public void onResume() {
 		super.onResume();
@@ -87,14 +91,14 @@ public void onResume() {
 	@Override
 	public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) {
 		Activity ctx = requireActivity();
-		int themeId = isNightMode(true) ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
+		int themeId = nightMode ? R.style.OsmandDarkTheme_DarkActionbar : R.style.OsmandLightTheme_DarkActionbar_LightStatusBar;
 		Dialog dialog = new Dialog(ctx, themeId);
 		Window window = dialog.getWindow();
 		if (window != null) {
 			if (!settings.DO_NOT_USE_ANIMATIONS.get()) {
 				window.getAttributes().windowAnimations = R.style.Animations_Alpha;
 			}
-			int statusBarColor = isNightMode(true) ? R.color.status_bar_color_dark : R.color.status_bar_color_light;
+			int statusBarColor = nightMode ? R.color.status_bar_color_dark : R.color.status_bar_color_light;
 			window.setStatusBarColor(ContextCompat.getColor(ctx, statusBarColor));
 		}
 		return dialog;
@@ -193,7 +197,7 @@ private void updateContentView() {
 	private void loadWebViewData() {
 		String content = mContent;
 		if (content != null) {
-			content = setupContentStyle(content, isNightMode(true));
+			content = setupContentStyle(content, nightMode);
 			String encoded = Base64.encodeToString(content.getBytes(), Base64.NO_PADDING);
 			mWebView.loadData(encoded, "text/html", "base64");
 		}
@@ -229,7 +233,7 @@ public void setupDependentViews(@NonNull View view) {
 		View editBtn = view.findViewById(R.id.btn_edit);
 
 		Context ctx = editBtn.getContext();
-		AndroidUtils.setBackground(ctx, editBtn, isNightMode(true), R.drawable.ripple_light, R.drawable.ripple_dark);
+		AndroidUtils.setBackground(ctx, editBtn, nightMode, R.drawable.ripple_light, R.drawable.ripple_dark);
 
 		editBtn.setOnClickListener(v -> {
 			FragmentActivity activity = getActivity();
@@ -239,7 +243,7 @@ public void setupDependentViews(@NonNull View view) {
 		});
 		AndroidUiHelper.setVisibility(View.VISIBLE,
 				editBtn, view.findViewById(R.id.divider), view.findViewById(R.id.bottom_empty_space));
-		int backgroundColor = ColorUtilities.getActivityBgColorId(isNightMode(false));
+		int backgroundColor = ColorUtilities.getActivityBgColorId(nightMode);
 		view.findViewById(R.id.root).setBackgroundResource(backgroundColor);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/DistanceByTapFragment.java b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/DistanceByTapFragment.java
index 66dd82ae990..405d8231771 100644
--- a/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/DistanceByTapFragment.java
+++ b/OsmAnd/src/net/osmand/plus/views/mapwidgets/configure/DistanceByTapFragment.java
@@ -52,7 +52,6 @@ public class DistanceByTapFragment extends BaseOsmAndFragment {
 
 	private OsmandApplication app;
 	private OsmandSettings settings;
-	private boolean nightMode;
 
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
@@ -60,7 +59,6 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 
 		app = getMyApplication();
 		settings = getSettings();
-		nightMode = isNightMode(false);
 		selectedAppMode = settings.getApplicationMode();
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java b/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
index 09e8187383f..283fe02581a 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/ArticleWebViewClient.java
@@ -100,9 +100,6 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {
 	}
 
 	protected boolean isNightMode() {
-		if (usedOnMap) {
-			return app.getDaynightHelper().isNightModeForMapControls();
-		}
-		return !app.getSettings().isLightContent();
+		return app.getDaynightHelper().isNightMode(usedOnMap);
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/WikiBaseDialogFragment.java b/OsmAnd/src/net/osmand/plus/wikivoyage/WikiBaseDialogFragment.java
index 3362596ed04..4a25ec18be1 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/WikiBaseDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/WikiBaseDialogFragment.java
@@ -27,14 +27,6 @@
 
 public class WikiBaseDialogFragment extends BaseOsmAndDialogFragment {
 
-	protected boolean nightMode;
-
-	@Override
-	public void onCreate(Bundle savedInstanceState) {
-		super.onCreate(savedInstanceState);
-		nightMode = isNightMode(false);
-	}
-
 	@NonNull
 	@Override
 	public Dialog onCreateDialog(Bundle savedInstanceState) {
