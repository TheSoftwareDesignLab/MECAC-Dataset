diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
index a8810f85919..1e15b976be7 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/MapRouteInfoMenu.java
@@ -693,21 +693,23 @@ private void updateCards() {
 				bottomShadowVisible = routes.size() == 0;
 			} else {
 				RouteMenuAppModes mode = app.getRoutingOptionsHelper().getRouteMenuAppMode(routingHelper.getAppMode());
-				boolean avoidPTTypesCustomized = false;
-				for (LocalRoutingParameter parameter : mode.parameters) {
-					if (parameter instanceof AvoidPTTypesRoutingParameter) {
-						avoidPTTypesCustomized = true;
-						break;
+				if (mode != null) {
+					boolean avoidPTTypesCustomized = false;
+					for (LocalRoutingParameter parameter : mode.parameters) {
+						if (parameter instanceof AvoidPTTypesRoutingParameter) {
+							avoidPTTypesCustomized = true;
+							break;
+						}
+					}
+					if (avoidPTTypesCustomized) {
+						PublicTransportNotFoundSettingsWarningCard warningCard = new PublicTransportNotFoundSettingsWarningCard(mapActivity);
+						warningCard.setListener(this);
+						menuCards.add(warningCard);
+					} else {
+						PublicTransportNotFoundWarningCard warningCard = new PublicTransportNotFoundWarningCard(mapActivity);
+						warningCard.setListener(this);
+						menuCards.add(warningCard);
 					}
-				}
-				if (avoidPTTypesCustomized) {
-					PublicTransportNotFoundSettingsWarningCard warningCard = new PublicTransportNotFoundSettingsWarningCard(mapActivity);
-					warningCard.setListener(this);
-					menuCards.add(warningCard);
-				} else {
-					PublicTransportNotFoundWarningCard warningCard = new PublicTransportNotFoundWarningCard(mapActivity);
-					warningCard.setListener(this);
-					menuCards.add(warningCard);
 				}
 			}
 		} else if (routeCalculationInProgress) {
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
index fbf2c375ec2..c9cf6ae96d2 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/RoutingOptionsHelper.java
@@ -29,6 +29,7 @@
 
 import androidx.annotation.DrawableRes;
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import androidx.appcompat.app.AlertDialog;
 import androidx.appcompat.widget.AppCompatCheckedTextView;
 
@@ -106,9 +107,14 @@ public void addNewRouteMenuParameter(ApplicationMode applicationMode, LocalRouti
 		}
 	}
 
+	@Nullable
 	public RouteMenuAppModes getRouteMenuAppMode(ApplicationMode appMode) {
-		if (!modes.containsKey(appMode)) {
-			addRouteMenuAppModes(appMode, getRoutingParametersForProfileType(appMode));
+		if (!isFollowGpxTrack()) {
+			if (!modes.containsKey(appMode)) {
+				addRouteMenuAppModes(appMode, getRoutingParametersForProfileType(appMode));
+			}
+		} else {
+			modes.clear();
 		}
 		return modes.get(appMode);
 	}
@@ -445,9 +451,8 @@ public LocalRoutingParameter getItem(ApplicationMode am, String parameter) {
 	}
 
 	public LocalRoutingParameter getRoutingParameterInnerById(ApplicationMode am, String parameterId) {
-		GPXRouteParamsBuilder rparams = app.getRoutingHelper().getCurrentGPXRoute();
 		GeneralRouter rm = app.getRouter(am);
-		if (rm == null || (rparams != null && !rparams.isCalculateOsmAndRoute()) && !rparams.getFile().hasRtePt()) {
+		if (rm == null || (isFollowGpxTrack())) {
 			return null;
 		}
 
@@ -526,10 +531,9 @@ public List<LocalRoutingParameter> getRoutingParametersInner(ApplicationMode am)
 			return getOsmandRouterParameters(am);
 		}
 
-		GPXRouteParamsBuilder rparams = app.getRoutingHelper().getCurrentGPXRoute();
 		List<LocalRoutingParameter> list = new ArrayList<LocalRoutingParameter>(getGpxRouterParameters(am));
 		GeneralRouter rm = app.getRouter(am);
-		if (rm == null || (rparams != null && !rparams.isCalculateOsmAndRoute()) && !rparams.getFile().hasRtePt()) {
+		if (rm == null || isFollowGpxTrack()) {
 			return list;
 		}
 		Map<String, GeneralRouter.RoutingParameter> parameters = RoutingHelperUtils.getParametersForDerivedProfile(am, rm);
@@ -557,6 +561,11 @@ public List<LocalRoutingParameter> getRoutingParametersInner(ApplicationMode am)
 		return list;
 	}
 
+	private boolean isFollowGpxTrack() {
+		GPXRouteParamsBuilder rparams = app.getRoutingHelper().getCurrentGPXRoute();
+		return rparams != null && !rparams.isCalculateOsmAndRoute() && !rparams.getFile().hasRtePt();
+	}
+
 	private static void updateRoutingParameterIcons(LocalRoutingParameter rp) {
 		if (rp instanceof LocalRoutingParameterGroup) {
 			LocalRoutingParameterGroup group = (LocalRoutingParameterGroup) rp;
diff --git a/OsmAnd/src/net/osmand/plus/views/MapActions.java b/OsmAnd/src/net/osmand/plus/views/MapActions.java
index 80af06ddcf4..1944e72ff65 100644
--- a/OsmAnd/src/net/osmand/plus/views/MapActions.java
+++ b/OsmAnd/src/net/osmand/plus/views/MapActions.java
@@ -3,6 +3,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
+import net.osmand.GPXUtilities;
 import net.osmand.GPXUtilities.GPXFile;
 import net.osmand.Location;
 import net.osmand.data.LatLon;
@@ -86,6 +87,13 @@ public void enterRoutePlanningModeGivenGpx(GPXFile gpxFile, ApplicationMode appM
 		settings.USE_INTERMEDIATE_POINTS_NAVIGATION.set(useIntermediatePointsByDefault);
 		TargetPointsHelper targets = app.getTargetPointsHelper();
 
+		if (gpxFile != null && gpxFile.hasRtePt() && appMode == null) {
+			GPXUtilities.WptPt routePoint = gpxFile.getRoutePoints().get(0);
+			ApplicationMode routePointAppMode = ApplicationMode.valueOfStringKey(routePoint.getProfileType(), ApplicationMode.DEFAULT);
+			if (routePointAppMode != ApplicationMode.DEFAULT) {
+				appMode = routePointAppMode;
+			}
+		}
 		ApplicationMode mode = appMode != null ? appMode : getRouteMode();
 		app.getSettings().setApplicationMode(mode, false);
 		app.getRoutingHelper().setAppMode(mode);
