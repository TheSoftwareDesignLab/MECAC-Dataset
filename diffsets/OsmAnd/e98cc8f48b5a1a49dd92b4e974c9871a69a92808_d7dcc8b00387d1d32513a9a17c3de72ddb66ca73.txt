diff --git a/OsmAnd-shared/src/commonMain/kotlin/net/osmand/shared/grid/ButtonPositionSize.kt b/OsmAnd-shared/src/commonMain/kotlin/net/osmand/shared/grid/ButtonPositionSize.kt
index 96ea1455dc7..103e281ef33 100644
--- a/OsmAnd-shared/src/commonMain/kotlin/net/osmand/shared/grid/ButtonPositionSize.kt
+++ b/OsmAnd-shared/src/commonMain/kotlin/net/osmand/shared/grid/ButtonPositionSize.kt
@@ -230,6 +230,8 @@ class ButtonPositionSize {
 		private const val MAX_STUCK_ATTEMPTS = 20
 
 		var DEBUG_PRINT: Boolean = false; // false
+		var ALTERNATIVE_ALGORITHM: Boolean = false;
+
 		const val CELL_SIZE_DP = 8
 		const val DEF_MARGIN_DP = 4
 
@@ -256,54 +258,91 @@ class ButtonPositionSize {
 			totalWidth: Int,
 			totalHeight: Int
 		): Boolean {
+			buttons.forEach { it.updateBounds(totalWidth, totalHeight) }
 			if (DEBUG_PRINT) {
-				LOG.info("---- Layout w=" + totalWidth + " h=" + totalHeight + " spc=" + space);
+				LOG.info("---- Layout w=$totalWidth h=$totalHeight spc=$space");
 				buttons.forEach {
-					it.updateBounds(totalWidth, totalHeight)
-					LOG.info("Before Button " + it + " " + it.bounds);
+					LOG.info("Before Button $it ${it.bounds}");
 				}
 			}
 			var iter = 0
 
 			var fixedPos = buttons.size - 1
-			while (fixedPos >= 0) {
-				if (iter++ > MAX_ITERATIONS) {
-					LOG.error("Relayout is broken.")
-					return false
-				}
-
-				var overlap = false
-				val button = buttons[fixedPos] // Use index access
-
-				// Use 'until' for a range that doesn't include the end value
-				for (i in (fixedPos + 1) until buttons.size) {
-					val check = buttons[i]
-					if (button.overlap(check)) {
-						overlap = true
-						if (DEBUG_PRINT) {
-							LOG.info("Move " + check + " because " + button);
+			// we start checking button I and check if it overlaps I+1 (move it), I+2, ...
+			// then we check button I-1 and move I, I+1, (if they overlap)
+			// So on step I all buttons [I+1, ... N] are nicely arranged without overlap
+
+			// we don't do it in forward iteration (I step all [1, .. I-1] are arranged) -
+			// WHY ? See ALTERNATIVE... Because if layout is broken, then it will do something valuable at least?
+			if (ALTERNATIVE_ALGORITHM) {
+				var i = 1;
+				while (i < buttons.size) {
+					if (iter++ > MAX_ITERATIONS) {
+						LOG.error("Relayout is broken.")
+						return false
+					}
+					var overlap = false
+					val button = buttons[i]
+					for (j in 0 until i) {
+						val check = buttons[j]
+						if (button.overlap(check)) {
+							val moved = moveButton(space, button, check)
+							if (!moved) {
+								// skip unmoveable situations
+								continue;
+							}
+							overlap = true
+							button.updateBounds(totalWidth, totalHeight)
+							if (DEBUG_PRINT) {
+								LOG.info("Move $button because $check new bounds ${button.bounds}");
+							}
 						}
-						check.updateBounds(totalWidth, totalHeight)
-						moveButton(space, check, button)
-						fixedPos = i
-						break
+					}
+					if (!overlap) {
+						i++
 					}
 				}
+			} else {
+				while (fixedPos >= 0) {
+					if (iter++ > MAX_ITERATIONS) {
+						LOG.error("Relayout is broken.")
+						return false
+					}
+					var overlap = false
+					val button = buttons[fixedPos]
+					for (i in (fixedPos + 1) until buttons.size) {
+						val check = buttons[i]
+						if (button.overlap(check)) {
+							val moved = moveButton(space, check, button)
+							if (!moved) {
+								// skip unmoveable situations
+								continue;
+							}
+							overlap = true
+							check.updateBounds(totalWidth, totalHeight)
+							if (DEBUG_PRINT) {
+								LOG.info("Move $check because $button new bounds ${check.bounds}");
+							}
+							fixedPos = i
+							break
+						}
+					}
 
-				if (!overlap) {
-					fixedPos--
+					if (!overlap) {
+						fixedPos--
+					}
 				}
 			}
 			if (DEBUG_PRINT) {
 				buttons.forEach {
-					LOG.info("After Button " + it + " " + it.bounds);
+					LOG.info("After Button $it ${it.bounds}");
 				}
-				LOG.info("++++ Layout w=" + totalWidth + " h=" + totalHeight + " spc=" + space);
+				LOG.info("++++ Layout w=$totalWidth h=$totalHeight spc=$space");
 			}
 			return true
 		}
 
-		private fun moveButton(space: Int, toMove: ButtonPositionSize, overlap: ButtonPositionSize) {
+		private fun moveButton(space: Int, toMove: ButtonPositionSize, overlap: ButtonPositionSize): Boolean {
 			var xMove = false
 			var yMove = false
 
@@ -313,8 +352,6 @@ class ButtonPositionSize {
 				} else if (overlap.posV == POS_FULL_HEIGHT) {
 					xMove = true
 				} else {
-					// This logic is simpler than the original
-					// if (toMove.xMove) { xMove = toMove.xMove } is just xMove = toMove.xMove
 					xMove = toMove.xMove
 					yMove = toMove.yMove
 				}
@@ -330,6 +367,7 @@ class ButtonPositionSize {
 			if (yMove) {
 				toMove.marginY = space + overlap.marginY + overlap.height
 			}
+			return xMove || yMove;
 		}
 	}
 }
diff --git a/OsmAnd-shared/src/commonTest/kotlin/net/osmand/shared/grid/ButtonPositionSizeTest.kt b/OsmAnd-shared/src/commonTest/kotlin/net/osmand/shared/grid/ButtonPositionSizeTest.kt
index 6bec373b2f4..322b3bedc0f 100644
--- a/OsmAnd-shared/src/commonTest/kotlin/net/osmand/shared/grid/ButtonPositionSizeTest.kt
+++ b/OsmAnd-shared/src/commonTest/kotlin/net/osmand/shared/grid/ButtonPositionSizeTest.kt
@@ -8,14 +8,19 @@ class ButtonPositionSizeTest {
 	@Test
 	fun testLayout1() {
 		ButtonPositionSize.DEBUG_PRINT = true;
+//		ButtonPositionSize.ALTERNATIVE_ALGORITHM = true;
 		val buttons = listOf(
 			ButtonPositionSize("map.view.zoom_out", 7, false, false),
 			ButtonPositionSize("map.view.zoom_id", 7, false, false).setMoveVertical(),
-			ButtonPositionSize("map.view.back_to_loc", 7, false, false).setMoveHorizontal()
+			ButtonPositionSize("map.view.zoom_id2", 7, false, false).setMoveVertical(),
+			ButtonPositionSize("map.view.back_to_loc", 7, false, false).setMoveHorizontal(),
+			ButtonPositionSize("map.view.zoom_id3", 7, false, false).setMoveVertical(),
 		)
 		ButtonPositionSize.computeNonOverlap(1, buttons, 40, 40);
 		assertTrue { check(buttons, "map.view.zoom_out", 33.0, 33.0) }
 		assertTrue { check(buttons, "map.view.zoom_id", 33.0, 25.0) }
+		assertTrue { check(buttons, "map.view.zoom_id2", 33.0, 17.0) }
+		assertTrue { check(buttons, "map.view.zoom_id3", 33.0, 9.0) }
 		assertTrue { check(buttons, "map.view.back_to_loc", 25.0, 33.0) }
 
 	}
@@ -23,6 +28,7 @@ class ButtonPositionSizeTest {
 	@Test
 	fun testLayout2() {
 		ButtonPositionSize.DEBUG_PRINT = true;
+//		ButtonPositionSize.ALTERNATIVE_ALGORITHM = true;
 		val buttons = listOf(
 			ButtonPositionSize("map_right_widgets_panel", 12, false, true).
 				setSize(12, 4),
