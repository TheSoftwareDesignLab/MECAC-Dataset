diff --git a/OsmAnd/src/net/osmand/plus/AppInitializer.java b/OsmAnd/src/net/osmand/plus/AppInitializer.java
index c808e82b0d3..9ed98fc94eb 100644
--- a/OsmAnd/src/net/osmand/plus/AppInitializer.java
+++ b/OsmAnd/src/net/osmand/plus/AppInitializer.java
@@ -48,6 +48,7 @@
 import net.osmand.plus.helpers.LockHelper;
 import net.osmand.plus.helpers.TargetPointsHelper;
 import net.osmand.plus.helpers.WaypointHelper;
+import net.osmand.plus.importfiles.ImportHelper;
 import net.osmand.plus.inapp.InAppPurchaseHelperImpl;
 import net.osmand.plus.keyevent.InputDeviceHelper;
 import net.osmand.plus.keyevent.KeyEventHelper;
@@ -316,6 +317,7 @@ public void onCreateApplication() {
 		getLazyRoutingConfig();
 		app.applyTheme(app);
 		startupInit(app.reconnectToBRouter(), IBRouterService.class);
+		app.importHelper = startupInit(new ImportHelper(app), ImportHelper.class);
 		app.backupHelper = startupInit(new BackupHelper(app), BackupHelper.class);
 		app.inAppPurchaseHelper = startupInit(new InAppPurchaseHelperImpl(app), InAppPurchaseHelperImpl.class);
 		app.poiTypes = startupInit(MapPoiTypes.getDefaultNoInit(), MapPoiTypes.class);
diff --git a/OsmAnd/src/net/osmand/plus/OsmandApplication.java b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
index 0706bda31c9..cfc6ba1e508 100644
--- a/OsmAnd/src/net/osmand/plus/OsmandApplication.java
+++ b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
@@ -62,6 +62,7 @@
 import net.osmand.plus.helpers.LockHelper;
 import net.osmand.plus.helpers.TargetPointsHelper;
 import net.osmand.plus.helpers.WaypointHelper;
+import net.osmand.plus.importfiles.ImportHelper;
 import net.osmand.plus.inapp.InAppPurchaseHelper;
 import net.osmand.plus.keyevent.InputDeviceHelper;
 import net.osmand.plus.keyevent.KeyEventHelper;
@@ -195,6 +196,7 @@ public class OsmandApplication extends MultiDexApplication {
 	MeasurementEditingContext measurementEditingContext;
 	OnlineRoutingHelper onlineRoutingHelper;
 	BackupHelper backupHelper;
+	ImportHelper importHelper;
 	TravelRendererHelper travelRendererHelper;
 	LauncherShortcutsHelper launcherShortcutsHelper;
 	GpsFilterHelper gpsFilterHelper;
@@ -516,6 +518,10 @@ public BackupHelper getBackupHelper() {
 		return backupHelper;
 	}
 
+	public ImportHelper getImportHelper() {
+		return importHelper;
+	}
+
 	public TransportRoutingHelper getTransportRoutingHelper() {
 		return transportRoutingHelper;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index 5be54667d42..f74f6e2fa42 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -294,7 +294,8 @@ public void onCreate(Bundle savedInstanceState) {
 			}
 		}
 		PluginsHelper.onMapActivityCreate(this);
-		importHelper = new ImportHelper(this);
+		importHelper = app.getImportHelper();
+		importHelper.setUiActivity(this);
 		if (System.currentTimeMillis() - tm > 50) {
 			LOG.error("OnCreate for MapActivity took " + (System.currentTimeMillis() - tm) + " ms");
 		}
@@ -927,9 +928,10 @@ protected void onDestroy() {
 		trackDetailsMenu.setMapActivity(null);
 		unregisterReceiver(screenOffReceiver);
 		app.getAidlApi().onDestroyMapActivity(this);
+		app.getImportHelper().resetUIActivity(this);
 		restoreNavigationHelper.quitRouteRestoreDialog();
 		PluginsHelper.onMapActivityDestroy(this);
-		getMyApplication().unsubscribeInitListener(initListener);
+		app.unsubscribeInitListener(initListener);
 		NavigationSession carNavigationSession = app.getCarNavigationSession();
 		if (carNavigationSession == null || !carNavigationSession.hasStarted()) {
 			getMapViewTrackingUtilities().setMapView(null);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
index 5f2e6f11c9b..123dbf63241 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/tracks/TracksFragment.java
@@ -2,7 +2,7 @@
 
 import static net.osmand.IndexConstants.GPX_INDEX_DIR;
 import static net.osmand.plus.importfiles.ImportHelper.IMPORT_FILE_REQUEST;
-import static net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
+import static net.osmand.plus.importfiles.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
 import static net.osmand.plus.track.fragments.TrackMenuFragment.TrackMenuTab.OVERVIEW;
 import static net.osmand.plus.utils.FileUtils.RenameCallback;
 
@@ -46,8 +46,8 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.helpers.IntentHelper;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
-import net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport;
+import net.osmand.plus.importfiles.GpxImportListener;
+import net.osmand.plus.importfiles.OnSuccessfulGpxImport;
 import net.osmand.plus.importfiles.MultipleTracksImportListener;
 import net.osmand.plus.myplaces.tracks.ItemsSelectionHelper;
 import net.osmand.plus.myplaces.tracks.ItemsSelectionHelper.SelectionHelperProvider;
@@ -134,7 +134,7 @@ public int getStatusBarColorId() {
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		importHelper = new ImportHelper(requireActivity());
+		importHelper = app.getImportHelper();
 		selectedTracksHelper = new SelectedTracksHelper(app);
 		gpxSelectionHelper = app.getSelectedGpxHelper();
 		itemsSelectionHelper = selectedTracksHelper.getItemsSelectionHelper();
diff --git a/OsmAnd/src/net/osmand/plus/download/DownloadActivity.java b/OsmAnd/src/net/osmand/plus/download/DownloadActivity.java
index b5c8bbd57e5..a9bc9d03e47 100644
--- a/OsmAnd/src/net/osmand/plus/download/DownloadActivity.java
+++ b/OsmAnd/src/net/osmand/plus/download/DownloadActivity.java
@@ -218,7 +218,7 @@ public AccessibilityAssistant getAccessibilityAssistant() {
 
 	@Override
 	public void onAttachFragment(@NonNull Fragment fragment) {
-		fragSet.add(new WeakReference<Fragment>(fragment));
+		fragSet.add(new WeakReference<>(fragment));
 	}
 
 	@Override
@@ -226,10 +226,10 @@ protected void onResume() {
 		super.onResume();
 		initAppStatusVariables();
 		downloadThread.setUiActivity(this);
+		getMyApplication().getImportHelper().setUiActivity(this);
 		downloadInProgress();
 	}
 
-
 	@Override
 	public boolean onOptionsItemSelected(MenuItem item) {
 		int itemId = item.getItemId();
@@ -248,6 +248,12 @@ public void onPause() {
 		downloadThread.resetUiActivity(this);
 	}
 
+	@Override
+	protected void onDestroy() {
+		super.onDestroy();
+		getMyApplication().getImportHelper().resetUIActivity(this);
+	}
+
 	@Override
 	@UiThread
 	public void downloadHasFinished() {
diff --git a/OsmAnd/src/net/osmand/plus/download/local/LocalCategory.java b/OsmAnd/src/net/osmand/plus/download/local/LocalCategory.java
index da5f9a6ac50..69911e0fdd4 100644
--- a/OsmAnd/src/net/osmand/plus/download/local/LocalCategory.java
+++ b/OsmAnd/src/net/osmand/plus/download/local/LocalCategory.java
@@ -39,7 +39,7 @@ public void addLocalItem(@NonNull LocalItem item) {
 			group = new LocalGroup(itemType);
 			groups.put(itemType, group);
 		}
-		group.getItems().add(item);
+		group.addItem(item);
 	}
 
 	public long getSize() {
diff --git a/OsmAnd/src/net/osmand/plus/download/local/LocalGroup.java b/OsmAnd/src/net/osmand/plus/download/local/LocalGroup.java
index 169a67c6fdd..90002a83501 100644
--- a/OsmAnd/src/net/osmand/plus/download/local/LocalGroup.java
+++ b/OsmAnd/src/net/osmand/plus/download/local/LocalGroup.java
@@ -31,6 +31,14 @@ public String getName(@NonNull Context context) {
 		return type.toHumanString(context);
 	}
 
+	public void addItem(@NonNull LocalItem localItem) {
+		items.add(localItem);
+	}
+
+	public void removeItem(@NonNull LocalItem localItem) {
+		items.remove(localItem);
+	}
+
 	public long getSize() {
 		long size = 0;
 		for (LocalItem item : items) {
diff --git a/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalCategoriesFragment.java b/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalCategoriesFragment.java
index bbc7deb3310..702678f5768 100644
--- a/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalCategoriesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalCategoriesFragment.java
@@ -30,6 +30,7 @@
 import net.osmand.plus.download.local.LocalItemsLoaderTask.LoadItemsListener;
 import net.osmand.plus.download.local.dialogs.CategoriesAdapter.LocalTypeListener;
 import net.osmand.plus.download.local.dialogs.MemoryInfo.MemoryItem;
+import net.osmand.plus.importfiles.ImportTaskCallback;
 import net.osmand.plus.utils.ColorUtilities;
 
 import java.util.ArrayList;
@@ -38,7 +39,7 @@
 import java.util.Map;
 
 
-public class LocalCategoriesFragment extends LocalBaseFragment implements DownloadEvents, LocalTypeListener, LoadItemsListener {
+public class LocalCategoriesFragment extends LocalBaseFragment implements DownloadEvents, LocalTypeListener, LoadItemsListener, ImportTaskCallback {
 
 	private MemoryInfo memoryInfo;
 	private Map<CategoryType, LocalCategory> categories;
@@ -127,7 +128,7 @@ public void onCreateOptionsMenu(@NonNull Menu menu, @NonNull MenuInflater inflat
 	@Override
 	public void onResume() {
 		super.onResume();
-
+		app.getImportHelper().addImportTaskCallback(this);
 		if (categories == null && (asyncLoader == null || asyncLoader.getStatus() == Status.FINISHED)) {
 			reloadData();
 		}
@@ -136,12 +137,17 @@ public void onResume() {
 	@Override
 	public void onDestroy() {
 		super.onDestroy();
-
+		app.getImportHelper().removeImportTaskCallback(this);
 		if (asyncLoader != null && asyncLoader.getStatus() == Status.RUNNING) {
 			asyncLoader.cancel(false);
 		}
 	}
 
+	@Override
+	public void onImportSuccessfullyFinished() {
+		reloadData();
+	}
+
 	private void reloadData() {
 		LocalItemsLoaderTask task = asyncLoader;
 		if (task == null || task.getStatus() == AsyncTask.Status.FINISHED || task.isCancelled()) {
diff --git a/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalItemsFragment.java b/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalItemsFragment.java
index 0ff6b082e88..996086971d4 100644
--- a/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalItemsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/download/local/dialogs/LocalItemsFragment.java
@@ -125,7 +125,7 @@ public void onCreate(Bundle savedInstanceState) {
 		}
 
 		DownloadActivity activity = requireDownloadActivity();
-		importHelper = new ImportHelper(activity);
+		importHelper = app.getImportHelper();
 		groupMenuProvider = new GroupMenuProvider(activity, this);
 		itemMenuProvider = new ItemMenuProvider(activity, this);
 		itemMenuProvider.setColorId(ColorUtilities.getDefaultIconColorId(nightMode));
@@ -350,7 +350,7 @@ public void onOperationProgress(@NonNull OperationType type, @NonNull LocalItem.
 		LocalGroup group = getGroup();
 		if (type == DELETE_OPERATION && group != null) {
 			for (LocalItem item : values) {
-				group.getItems().remove(item);
+				group.removeItem(item);
 			}
 		}
 		if (isAdded()) {
diff --git a/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java b/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
index 0a64c7cca2f..a1caed1c8c3 100644
--- a/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
+++ b/OsmAnd/src/net/osmand/plus/firstusage/FirstUsageWizardFragment.java
@@ -1,6 +1,6 @@
 package net.osmand.plus.firstusage;
 
-import static net.osmand.plus.importfiles.ImportHelper.ImportType.SETTINGS;
+import static net.osmand.plus.importfiles.ImportType.SETTINGS;
 
 import android.Manifest;
 import android.annotation.SuppressLint;
@@ -789,7 +789,7 @@ public void restoreFromCloud() {
 	public void restoreFromFile() {
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
-			mapActivity.getImportHelper().chooseFileToImport(SETTINGS, null);
+			mapActivity.getImportHelper().chooseFileToImport(SETTINGS);
 		}
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/GpxImportListener.java b/OsmAnd/src/net/osmand/plus/importfiles/GpxImportListener.java
new file mode 100644
index 00000000000..5b2af06514e
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/importfiles/GpxImportListener.java
@@ -0,0 +1,14 @@
+package net.osmand.plus.importfiles;
+
+import net.osmand.gpx.GPXFile;
+
+public interface GpxImportListener {
+
+	default void onImportStarted() {}
+
+	default void onImportFinished() {}
+
+	default void onImportComplete(boolean success) {}
+
+	default void onSaveComplete(boolean success, GPXFile gpxFile) {}
+}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java b/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
index e7cbdf22b1d..2aa456558f6 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ImportHelper.java
@@ -6,14 +6,13 @@
 import static net.osmand.IndexConstants.GPX_IMPORT_DIR;
 import static net.osmand.IndexConstants.GPX_INDEX_DIR;
 import static net.osmand.IndexConstants.OSMAND_SETTINGS_FILE_EXT;
-import static net.osmand.IndexConstants.RENDERER_INDEX_EXT;
 import static net.osmand.IndexConstants.ROUTING_FILE_EXT;
 import static net.osmand.IndexConstants.SQLITE_CHART_FILE_EXT;
 import static net.osmand.IndexConstants.SQLITE_EXT;
 import static net.osmand.IndexConstants.WPT_CHART_FILE_EXT;
 import static net.osmand.IndexConstants.ZIP_EXT;
-import static net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
-import static net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport.OPEN_PLAN_ROUTE_FRAGMENT;
+import static net.osmand.plus.importfiles.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
+import static net.osmand.plus.importfiles.OnSuccessfulGpxImport.OPEN_PLAN_ROUTE_FRAGMENT;
 import static net.osmand.plus.myplaces.MyPlacesActivity.GPX_TAB;
 import static net.osmand.plus.myplaces.MyPlacesActivity.TAB_ID;
 import static net.osmand.plus.settings.backend.backup.SettingsHelper.REPLACE_KEY;
@@ -71,7 +70,6 @@
 import net.osmand.plus.measurementtool.MeasurementToolFragment;
 import net.osmand.plus.settings.backend.ExportSettingsType;
 import net.osmand.plus.settings.backend.backup.SettingsHelper;
-import net.osmand.plus.settings.backend.backup.items.SettingsItem;
 import net.osmand.plus.track.data.GPXInfo;
 import net.osmand.plus.track.fragments.TrackMenuFragment;
 import net.osmand.plus.track.helpers.GpxUiHelper;
@@ -88,7 +86,9 @@
 import java.io.InputStream;
 import java.io.OutputStream;
 import java.util.ArrayList;
+import java.util.HashSet;
 import java.util.List;
+import java.util.Set;
 import java.util.zip.ZipEntry;
 import java.util.zip.ZipInputStream;
 
@@ -97,7 +97,7 @@
  */
 public class ImportHelper {
 
-	public static final Log log = PlatformUtil.getLog(ImportHelper.class);
+	public static final Log LOG = PlatformUtil.getLog(ImportHelper.class);
 
 	public static final String KML_SUFFIX = ".kml";
 	public static final String KMZ_SUFFIX = ".kmz";
@@ -105,61 +105,41 @@ public class ImportHelper {
 	public static final int IMPORT_FILE_REQUEST = 1006;
 
 	private final OsmandApplication app;
-	private final FragmentActivity activity;
+	private FragmentActivity uiActivity;
 
+	private final Set<ImportTaskCallback> importTaskCallbacks = new HashSet<>();
 	private GpxImportListener gpxImportListener;
 
-	public enum ImportType {
-		SETTINGS(OSMAND_SETTINGS_FILE_EXT),
-		ROUTING(ROUTING_FILE_EXT),
-		RENDERING(RENDERER_INDEX_EXT),
-		GPX(GPX_FILE_EXT),
-		KML(KML_SUFFIX),
-		KMZ(KMZ_SUFFIX);
-
-		private final String extension;
-
-		ImportType(String extension) {
-			this.extension = extension;
-		}
-
-		public String getExtension() {
-			return extension;
-		}
+	public ImportHelper(@NonNull OsmandApplication app) {
+		this.app = app;
 	}
 
-	public enum OnSuccessfulGpxImport {
-		OPEN_GPX_CONTEXT_MENU,
-		OPEN_PLAN_ROUTE_FRAGMENT
+	public void setUiActivity(@NonNull FragmentActivity uiActivity) {
+		this.uiActivity = uiActivity;
 	}
 
-	public interface GpxImportListener {
-
-		default void onImportStarted() {
-		}
-
-		default void onImportFinished() {
-		}
-
-		default void onImportComplete(boolean success) {
+	public void resetUIActivity(@NonNull FragmentActivity uiActivity) {
+		if (this.uiActivity == uiActivity) {
+			this.uiActivity = null;
 		}
+	}
 
-		default void onSaveComplete(boolean success, GPXFile gpxFile) {
-		}
+	public void setGpxImportListener(@Nullable GpxImportListener gpxImportListener) {
+		this.gpxImportListener = gpxImportListener;
 	}
 
-	public ImportHelper(@NonNull FragmentActivity activity) {
-		this.activity = activity;
-		app = (OsmandApplication) activity.getApplicationContext();
+	public void addImportTaskCallback(@NonNull ImportTaskCallback callback) {
+		importTaskCallbacks.add(callback);
 	}
 
-	@Nullable
-	public GpxImportListener getGpxImportListener() {
-		return gpxImportListener;
+	public void removeImportTaskCallback(@NonNull ImportTaskCallback callback) {
+		importTaskCallbacks.remove(callback);
 	}
 
-	public void setGpxImportListener(@Nullable GpxImportListener gpxImportListener) {
-		this.gpxImportListener = gpxImportListener;
+	public void notifyOnImportFinished() {
+		for (ImportTaskCallback callback : importTaskCallbacks) {
+			callback.onImportSuccessfullyFinished();
+		}
 	}
 
 	public void handleContentImport(Uri contentUri, Bundle extras, boolean useImportDir) {
@@ -178,8 +158,8 @@ public void handleGpxImport(GPXFile result, String name, long fileSize, boolean
 	public boolean handleGpxImport(@NonNull Uri uri, @Nullable OnSuccessfulGpxImport onGpxImport, boolean useImportDir) {
 		String name = getNameFromContentUri(app, uri);
 		String fileName = getGpxFileName(name);
-		boolean isOsmandSubDir = Algorithms.isSubDirectory(app.getAppPath(GPX_INDEX_DIR), new File(uri.getPath()));
-		if (!isOsmandSubDir && fileName != null) {
+		boolean isOsmAndSubDir = Algorithms.isSubDirectory(app.getAppPath(GPX_INDEX_DIR), new File(uri.getPath()));
+		if (!isOsmAndSubDir && fileName != null) {
 			handleGpxImport(uri, fileName, onGpxImport, useImportDir, true, false);
 		}
 		return false;
@@ -223,7 +203,7 @@ public void handleGpxFilesImport(@NonNull List<Uri> filesUri, @NonNull File dest
 					handleResult(pair.first, fileName, onGpxImport, pair.second, true, destinationDir, showSnackbar, singleImport);
 					return true;
 				};
-				GpxImportTask gpxImportTask = new GpxImportTask(activity, uri, fileName, callback);
+				GpxImportTask gpxImportTask = new GpxImportTask(uiActivity, uri, fileName, callback);
 				gpxImportTask.setShouldShowProgress(false);
 				executeImportTask(gpxImportTask);
 			} else if (gpxImportListener != null) {
@@ -249,8 +229,8 @@ public void handleImport(@NonNull Intent intent) {
 
 	public void handleFileImport(Uri intentUri, String fileName, Bundle extras, boolean useImportDir) {
 		boolean isFileIntent = "file".equals(intentUri.getScheme());
-		boolean isOsmandSubdir = Algorithms.isSubDirectory(app.getAppPath(GPX_INDEX_DIR), new File(intentUri.getPath()));
-		boolean saveFile = !isFileIntent || !isOsmandSubdir;
+		boolean isOsmAndSubDir = Algorithms.isSubDirectory(app.getAppPath(GPX_INDEX_DIR), new File(intentUri.getPath()));
+		boolean saveFile = !isFileIntent || !isOsmAndSubDir;
 
 		if (fileName == null) {
 			handleUriImport(intentUri, saveFile, useImportDir);
@@ -261,9 +241,9 @@ public void handleFileImport(Uri intentUri, String fileName, Bundle extras, bool
 		} else if (fileName.endsWith(SQLITE_EXT)) {
 			handleSqliteTileImport(intentUri, fileName);
 		} else if (fileName.endsWith(OSMAND_SETTINGS_FILE_EXT) || fileName.endsWith(OSMAND_SETTINGS_FILE_EXT + ZIP_EXT)) {
-			handleOsmAndSettingsImport(intentUri, fileName, extras, null);
+			handleOsmAndSettingsImport(intentUri, fileName, extras);
 		} else if (fileName.endsWith(ROUTING_FILE_EXT)) {
-			handleXmlFileImport(intentUri, fileName, null);
+			handleXmlFileImport(intentUri, fileName);
 		} else if (fileName.endsWith(WPT_CHART_FILE_EXT)) {
 			handleGpxOrFavouritesImport(intentUri, fileName.replace(WPT_CHART_FILE_EXT, GPX_FILE_EXT), saveFile, useImportDir, false, true, false);
 		} else if (fileName.endsWith(SQLITE_CHART_FILE_EXT)) {
@@ -274,7 +254,7 @@ public void handleFileImport(Uri intentUri, String fileName, Bundle extras, bool
 	}
 
 	@Nullable
-	public static String getNameFromContentUri(OsmandApplication app, Uri contentUri) {
+	public static String getNameFromContentUri(@NonNull OsmandApplication app, @NonNull Uri contentUri) {
 		try {
 			String name;
 			Cursor returnCursor = app.getContentResolver().query(contentUri, new String[] {OpenableColumns.DISPLAY_NAME}, null, null, null);
@@ -293,7 +273,7 @@ public static String getNameFromContentUri(OsmandApplication app, Uri contentUri
 			}
 			return name;
 		} catch (RuntimeException e) {
-			log.error(e.getMessage(), e);
+			LOG.error(e.getMessage(), e);
 			return null;
 		}
 	}
@@ -304,7 +284,7 @@ public void handleGpxImport(@NonNull Uri uri, @NonNull String fileName, @Nullabl
 			handleResult(pair.first, fileName, onGpxImport, pair.second, save, getGpxDestinationDir(app, useImportDir), showSnackbar, true);
 			return true;
 		};
-		executeImportTask(new GpxImportTask(activity, uri, fileName, callback));
+		executeImportTask(new GpxImportTask(uiActivity, uri, fileName, callback));
 	}
 
 	public void handleGpxOrFavouritesImport(Uri uri, String fileName, boolean save, boolean useImportDir,
@@ -315,26 +295,26 @@ public void handleGpxOrFavouritesImport(Uri uri, String fileName, boolean save,
 					forceImportFavourites, forceImportGpx, showSnackbar);
 			return true;
 		};
-		executeImportTask(new GpxImportTask(activity, uri, fileName, callback));
+		executeImportTask(new GpxImportTask(uiActivity, uri, fileName, callback));
 	}
 
 	private void importFavoritesImpl(GPXFile gpxFile, String fileName, boolean forceImportFavourites) {
-		executeImportTask(new FavoritesImportTask(activity, gpxFile, fileName, forceImportFavourites));
+		executeImportTask(new FavoritesImportTask(uiActivity, gpxFile, fileName, forceImportFavourites));
 	}
 
 	public void handleObfImport(Uri obfFile, String name) {
-		executeImportTask(new ObfImportTask(activity, obfFile, name));
+		executeImportTask(new ObfImportTask(uiActivity, obfFile, name));
 	}
 
 	public void handleSqliteTileImport(Uri uri, String name) {
-		executeImportTask(new SqliteTileImportTask(activity, uri, name));
+		executeImportTask(new SqliteTileImportTask(uiActivity, uri, name));
 	}
 
 	protected void handleGeoTiffImport(Uri uri, String name) {
-		executeImportTask(new GeoTiffImportTask(activity, uri, name));
+		executeImportTask(new GeoTiffImportTask(uiActivity, uri, name));
 	}
 
-	private void handleOsmAndSettingsImport(Uri intentUri, String fileName, Bundle extras, CallbackWithObject<List<SettingsItem>> callback) {
+	private void handleOsmAndSettingsImport(Uri intentUri, String fileName, Bundle extras) {
 		fileName = fileName.replace(ZIP_EXT, "");
 		if (extras != null
 				&& extras.containsKey(SettingsHelper.SETTINGS_VERSION_KEY)
@@ -351,35 +331,39 @@ private void handleOsmAndSettingsImport(Uri intentUri, String fileName, Bundle e
 					settingsTypes.add(ExportSettingsType.valueOf(key));
 				}
 			}
-			handleOsmAndSettingsImport(intentUri, fileName, settingsTypes, replace, silentImport, latestChanges, version, callback);
+			handleOsmAndSettingsImport(intentUri, fileName, settingsTypes, replace, silentImport, latestChanges, version);
 		} else {
-			handleOsmAndSettingsImport(intentUri, fileName, null, false, false, null, -1,
-					callback);
+			handleOsmAndSettingsImport(intentUri, fileName, null, false, false, null, -1);
 		}
 	}
 
 	public void handleOsmAndSettingsImport(Uri uri, String name, List<ExportSettingsType> settingsTypes,
-	                                       boolean replace, boolean silentImport, String latestChanges, int version,
-	                                       CallbackWithObject<List<SettingsItem>> callback) {
-		executeImportTask(new SettingsImportTask(activity, uri, name, settingsTypes, replace, silentImport,
-				latestChanges, version, callback));
+	                                       boolean replace, boolean silentImport, String latestChanges, int version) {
+		executeImportTask(new SettingsImportTask(uiActivity, uri, name, settingsTypes, replace, silentImport, latestChanges, version));
 	}
 
-	public void handleXmlFileImport(@NonNull Uri intentUri, @NonNull String fileName, @Nullable CallbackWithObject routingCallback) {
+	public void handleXmlFileImport(@NonNull Uri intentUri, @NonNull String fileName) {
 		if (fileExists(intentUri, fileName)) {
-			SaveExistingFileListener listener = overwrite -> executeImportTask(new XmlImportTask(activity, intentUri, fileName, routingCallback, overwrite));
-			app.runInUIThread(() -> FileExistBottomSheet.showInstance(activity.getSupportFragmentManager(), fileName, listener));
+			app.runInUIThread(() -> {
+				FileExistBottomSheet.showInstance(uiActivity.getSupportFragmentManager(), fileName, overwrite -> {
+					handleXmlFileImportImpl(intentUri, fileName, overwrite);
+				});
+			});
 		} else {
-			executeImportTask(new XmlImportTask(activity, intentUri, fileName, routingCallback, true));
+			handleXmlFileImportImpl(intentUri, fileName, true);
 		}
 	}
 
+	private void handleXmlFileImportImpl(@NonNull Uri intentUri, @NonNull String fileName, boolean overwrite) {
+		executeImportTask(new XmlImportTask(uiActivity, intentUri, fileName, overwrite));
+	}
+
 	private void handleUriImport(@NonNull Uri uri, boolean save, boolean useImportDir) {
-		executeImportTask(new UriImportTask(this, activity, uri, save, useImportDir));
+		executeImportTask(new UriImportTask(this, uiActivity, uri, save, useImportDir));
 	}
 
 	public void handleZipImport(@NonNull Uri uri, boolean save, boolean useImportDir) {
-		executeImportTask(new ZipImportTask(this, activity, uri, save, useImportDir));
+		executeImportTask(new ZipImportTask(this, uiActivity, uri, save, useImportDir));
 	}
 
 	private boolean fileExists(@NonNull Uri intentUri, @NonNull String fileName) {
@@ -431,12 +415,12 @@ public static String copyFile(@NonNull OsmandApplication app, @NonNull File dest
 		return error;
 	}
 
-	public void chooseFileToImport(@NonNull ImportType importType, @Nullable CallbackWithObject<?> callback) {
+	public void chooseFileToImport(@NonNull ImportType importType) {
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
 			try {
 				Intent intent = getImportFileIntent();
-				ActivityResultListener listener = getImportFileResultListener(importType, callback);
+				ActivityResultListener listener = getImportFileResultListener(importType);
 				mapActivity.startActivityForResult(intent, IMPORT_FILE_REQUEST);
 				mapActivity.registerActivityResultListener(listener);
 			} catch (ActivityNotFoundException e) {
@@ -445,7 +429,7 @@ public void chooseFileToImport(@NonNull ImportType importType, @Nullable Callbac
 		}
 	}
 
-	private ActivityResultListener getImportFileResultListener(@NonNull ImportType importType, @Nullable CallbackWithObject callback) {
+	private ActivityResultListener getImportFileResultListener(@NonNull ImportType importType) {
 		return new ActivityResultListener(IMPORT_FILE_REQUEST, (resultCode, resultData) -> {
 			if (resultCode == RESULT_OK) {
 				Uri data = resultData.getData();
@@ -464,9 +448,9 @@ private ActivityResultListener getImportFileResultListener(@NonNull ImportType i
 				}
 				if (fileName != null && fileName.endsWith(importType.getExtension())) {
 					if (importType.equals(ImportType.SETTINGS)) {
-						handleOsmAndSettingsImport(data, fileName, resultData.getExtras(), callback);
+						handleOsmAndSettingsImport(data, fileName, resultData.getExtras());
 					} else if (importType.equals(ImportType.ROUTING)) {
-						handleXmlFileImport(data, fileName, callback);
+						handleXmlFileImport(data, fileName);
 					}
 				} else {
 					app.showToastMessage(app.getString(R.string.not_support_file_type_with_ext,
@@ -507,7 +491,7 @@ private void handleResult(GPXFile result, String name, OnSuccessfulGpxImport onG
 			if (save) {
 				int tracksCount = result.getTracksCount();
 				if (singleImport && (tracksCount > 1 && tracksCount < 50)) {
-					FragmentManager manager = activity.getSupportFragmentManager();
+					FragmentManager manager = uiActivity.getSupportFragmentManager();
 					ImportTracksFragment.showInstance(manager, result, name,
 							destinationDir.getAbsolutePath(), gpxImportListener, fileSize);
 				} else {
@@ -523,8 +507,8 @@ private void handleResult(GPXFile result, String name, OnSuccessfulGpxImport onG
 	}
 
 	private void showPermissionsAlert() {
-		if (AndroidUtils.isActivityNotDestroyed(activity)) {
-			new AlertDialog.Builder(activity)
+		if (AndroidUtils.isActivityNotDestroyed(uiActivity)) {
+			new AlertDialog.Builder(uiActivity)
 					.setTitle(R.string.shared_string_import2osmand)
 					.setMessage(R.string.import_gpx_failed_descr)
 					.setNeutralButton(R.string.shared_string_permissions, (dialog, which) -> {
@@ -553,7 +537,7 @@ private void importAsOneTrack(@NonNull GPXFile gpxFile, @NonNull String name, @N
 
 		if (existingFilePath != null) {
 			SaveExistingFileListener saveFileListener = overwrite -> executeImportTask(new SaveGpxAsyncTask(app, gpxFile, destinationDir, name, listener, overwrite));
-			app.runInUIThread(() -> FileExistBottomSheet.showInstance(activity.getSupportFragmentManager(), name, saveFileListener));
+			app.runInUIThread(() -> FileExistBottomSheet.showInstance(uiActivity.getSupportFragmentManager(), name, saveFileListener));
 		} else {
 			executeImportTask(new SaveGpxAsyncTask(app, gpxFile, destinationDir, name, listener, false));
 		}
@@ -583,7 +567,7 @@ public void onGpxSavingFinished(@NonNull List<String> warnings) {
 				boolean success = Algorithms.isEmpty(warnings);
 				if (success) {
 					if (showSnackbar) {
-						Snackbar snackbar = Snackbar.make(activity.findViewById(android.R.id.content),
+						Snackbar snackbar = Snackbar.make(uiActivity.findViewById(android.R.id.content),
 										app.getString(R.string.is_imported, importedFileName),
 										BaseTransientBottomBar.LENGTH_LONG)
 								.setAction(R.string.shared_string_open, view -> openTrack(gpxFile, onGpxImport));
@@ -600,15 +584,15 @@ public void onGpxSavingFinished(@NonNull List<String> warnings) {
 					gpxImportListener.onSaveComplete(success, gpxFile);
 				}
 			}
-		};
-	}
 
-	private void openTrack(@NonNull GPXFile gpxFile, @Nullable OnSuccessfulGpxImport onGpxImport) {
-		SelectedGpxFile selectedGpxFile = app.getSelectedGpxHelper().getSelectedFileByPath(gpxFile.path);
-		if (selectedGpxFile != null) {
-			selectedGpxFile.setGpxFile(gpxFile, app);
-		}
-		showNeededScreen(onGpxImport, gpxFile);
+			private void openTrack(@NonNull GPXFile gpxFile, @Nullable OnSuccessfulGpxImport onGpxImport) {
+				SelectedGpxFile selectedGpxFile = app.getSelectedGpxHelper().getSelectedFileByPath(gpxFile.path);
+				if (selectedGpxFile != null) {
+					selectedGpxFile.setGpxFile(gpxFile, app);
+				}
+				showNeededScreen(onGpxImport, gpxFile);
+			}
+		};
 	}
 
 	@Nullable
@@ -639,8 +623,8 @@ public static String getExistingFilePath(@NonNull OsmandApplication app, @NonNul
 	}
 
 	private MapActivity getMapActivity() {
-		if (activity instanceof MapActivity) {
-			return (MapActivity) activity;
+		if (uiActivity instanceof MapActivity) {
+			return (MapActivity) uiActivity;
 		} else {
 			return null;
 		}
@@ -656,7 +640,7 @@ protected void showNeededScreen(@Nullable OnSuccessfulGpxImport onGpxImport, @No
 
 	private void showGpxContextMenu(String gpxFilePath) {
 		if (!Algorithms.isEmpty(gpxFilePath)) {
-			TrackMenuFragment.openTrack(activity, new File(gpxFilePath), null);
+			TrackMenuFragment.openTrack(uiActivity, new File(gpxFilePath), null);
 		}
 	}
 
@@ -665,7 +649,7 @@ private void showPlanRouteFragment(@NonNull GPXFile gpxFile) {
 		MeasurementEditingContext editingContext = new MeasurementEditingContext(app);
 		editingContext.setGpxData(gpxData);
 
-		FragmentManager fragmentManager = activity.getSupportFragmentManager();
+		FragmentManager fragmentManager = uiActivity.getSupportFragmentManager();
 		int mode = MeasurementToolFragment.PLAN_ROUTE_MODE;
 		MeasurementToolFragment.showInstance(fragmentManager, editingContext, mode, false);
 	}
@@ -675,7 +659,7 @@ protected void importGpxOrFavourites(GPXFile gpxFile, String fileName, long file
 	                                     boolean forceImportGpx, boolean showSnackbar) {
 		if (gpxFile == null || gpxFile.isPointsEmpty()) {
 			if (forceImportFavourites) {
-				if (AndroidUtils.isActivityNotDestroyed(activity)) {
+				if (AndroidUtils.isActivityNotDestroyed(uiActivity)) {
 					OnClickListener importAsTrackListener = (dialog, which) -> {
 						switch (which) {
 							case DialogInterface.BUTTON_POSITIVE:
@@ -687,9 +671,9 @@ protected void importGpxOrFavourites(GPXFile gpxFile, String fileName, long file
 								break;
 						}
 					};
-					new AlertDialog.Builder(activity)
+					new AlertDialog.Builder(uiActivity)
 							.setTitle(R.string.import_track)
-							.setMessage(activity.getString(R.string.import_track_desc, fileName))
+							.setMessage(uiActivity.getString(R.string.import_track_desc, fileName))
 							.setPositiveButton(R.string.shared_string_import, importAsTrackListener)
 							.setNegativeButton(R.string.shared_string_cancel, importAsTrackListener)
 							.show();
@@ -706,17 +690,17 @@ protected void importGpxOrFavourites(GPXFile gpxFile, String fileName, long file
 			if (forceImportGpx || !Algorithms.isEmpty(gpxFile.tracks)) {
 				handleResult(gpxFile, fileName, fileSize, save, useImportDir, showSnackbar);
 			} else {
-				ImportGpxBottomSheetDialogFragment.showInstance(activity.getSupportFragmentManager(),
+				ImportGpxBottomSheetDialogFragment.showInstance(uiActivity.getSupportFragmentManager(),
 						this, gpxFile, fileName, fileSize, save, useImportDir, showSnackbar);
 			}
 		}
 	}
 
 	private void openFavorites() {
-		Intent newIntent = new Intent(activity, app.getAppCustomization().getMyPlacesActivity());
+		Intent newIntent = new Intent(uiActivity, app.getAppCustomization().getMyPlacesActivity());
 		newIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
 		newIntent.putExtra(TAB_ID, GPX_TAB);
-		activity.startActivity(newIntent);
+		uiActivity.startActivity(newIntent);
 	}
 
 	@SuppressWarnings("unchecked")
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ImportTaskCallback.java b/OsmAnd/src/net/osmand/plus/importfiles/ImportTaskCallback.java
new file mode 100644
index 00000000000..1903949cbdf
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ImportTaskCallback.java
@@ -0,0 +1,7 @@
+package net.osmand.plus.importfiles;
+
+public interface ImportTaskCallback {
+
+	void onImportSuccessfullyFinished();
+
+}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ImportType.java b/OsmAnd/src/net/osmand/plus/importfiles/ImportType.java
new file mode 100644
index 00000000000..eadf1efd163
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ImportType.java
@@ -0,0 +1,27 @@
+package net.osmand.plus.importfiles;
+
+import static net.osmand.IndexConstants.GPX_FILE_EXT;
+import static net.osmand.IndexConstants.OSMAND_SETTINGS_FILE_EXT;
+import static net.osmand.IndexConstants.RENDERER_INDEX_EXT;
+import static net.osmand.IndexConstants.ROUTING_FILE_EXT;
+
+public enum ImportType {
+
+	SETTINGS(OSMAND_SETTINGS_FILE_EXT),
+	ROUTING(ROUTING_FILE_EXT),
+	RENDERING(RENDERER_INDEX_EXT),
+	GPX(GPX_FILE_EXT),
+	KML(ImportHelper.KML_SUFFIX),
+	KMZ(ImportHelper.KMZ_SUFFIX);
+
+	private final String extension;
+
+	ImportType(String extension) {
+		this.extension = extension;
+	}
+
+	public String getExtension() {
+		return extension;
+	}
+
+}
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/MultipleTracksImportListener.java b/OsmAnd/src/net/osmand/plus/importfiles/MultipleTracksImportListener.java
index 50e921c3640..cc87fac7eca 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/MultipleTracksImportListener.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/MultipleTracksImportListener.java
@@ -1,7 +1,6 @@
 package net.osmand.plus.importfiles;
 
 import net.osmand.gpx.GPXFile;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
 
 public abstract class MultipleTracksImportListener implements GpxImportListener {
 
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/OnSuccessfulGpxImport.java b/OsmAnd/src/net/osmand/plus/importfiles/OnSuccessfulGpxImport.java
new file mode 100644
index 00000000000..fc77c7059c5
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/importfiles/OnSuccessfulGpxImport.java
@@ -0,0 +1,6 @@
+package net.osmand.plus.importfiles;
+
+public enum OnSuccessfulGpxImport {
+	OPEN_GPX_CONTEXT_MENU,
+	OPEN_PLAN_ROUTE_FRAGMENT
+}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/BaseImportAsyncTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/BaseImportAsyncTask.java
new file mode 100644
index 00000000000..a2e094c73ab
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/BaseImportAsyncTask.java
@@ -0,0 +1,22 @@
+package net.osmand.plus.importfiles.tasks;
+
+import androidx.annotation.NonNull;
+import androidx.fragment.app.FragmentActivity;
+
+import net.osmand.plus.base.BaseLoadAsyncTask;
+import net.osmand.plus.importfiles.ImportHelper;
+
+public abstract class BaseImportAsyncTask<Params, Progress, Result> extends BaseLoadAsyncTask<Params, Progress, Result> {
+
+	private final ImportHelper importHelper;
+
+	public BaseImportAsyncTask(@NonNull FragmentActivity activity) {
+		super(activity);
+		importHelper = app.getImportHelper();
+	}
+
+	protected void notifyOnImportFinished() {
+		importHelper.notifyOnImportFinished();
+	}
+
+}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/FavoritesImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/FavoritesImportTask.java
index f62551676a0..0331d43c58f 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/FavoritesImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/FavoritesImportTask.java
@@ -15,7 +15,6 @@
 import net.osmand.gpx.GPXUtilities.WptPt;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.myplaces.favorites.FavouritesHelper;
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.plugins.parking.ParkingPositionPlugin;
@@ -25,7 +24,7 @@
 import java.util.List;
 import java.util.Map;
 
-public class FavoritesImportTask extends BaseLoadAsyncTask<Void, Void, GPXFile> {
+public class FavoritesImportTask extends BaseImportAsyncTask<Void, Void, GPXFile> {
 
 	private final GPXFile gpxFile;
 	private final String fileName;
@@ -94,6 +93,7 @@ private void checkDuplicateNames(@NonNull List<FavouritePoint> favourites) {
 	@Override
 	protected void onPostExecute(GPXFile result) {
 		hideProgress();
+		notifyOnImportFinished();
 		FragmentActivity activity = activityRef.get();
 		if (activity != null) {
 			app.showToastMessage(R.string.fav_imported_sucessfully);
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/GeoTiffImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/GeoTiffImportTask.java
index 6f139707d5f..0c6e6f27f34 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/GeoTiffImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/GeoTiffImportTask.java
@@ -9,12 +9,11 @@
 import androidx.fragment.app.FragmentActivity;
 
 import net.osmand.plus.R;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.importfiles.ImportHelper;
 
 import java.io.File;
 
-public class GeoTiffImportTask extends BaseLoadAsyncTask<Void, Void, String> {
+public class GeoTiffImportTask extends BaseImportAsyncTask<Void, Void, String> {
 
 	private final Uri uri;
 	private final String targetFileName;
@@ -38,6 +37,7 @@ protected String doInBackground(Void... voids) {
 	protected void onPostExecute(String error) {
 		hideProgress();
 		if (error == null) {
+			notifyOnImportFinished();
 			Toast.makeText(app, app.getString(R.string.map_imported_successfully), Toast.LENGTH_SHORT).show();
 		} else {
 			Toast.makeText(app, app.getString(R.string.map_import_error) + ": " + error, Toast.LENGTH_SHORT).show();
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/GpxImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/GpxImportTask.java
index 579ab2bf6eb..d176ef5aea0 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/GpxImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/GpxImportTask.java
@@ -15,7 +15,6 @@
 import net.osmand.CallbackWithObject;
 import net.osmand.gpx.GPXFile;
 import net.osmand.gpx.GPXUtilities;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.helpers.Kml2Gpx;
 import net.osmand.plus.importfiles.ImportHelper;
 import net.osmand.util.Algorithms;
@@ -27,7 +26,7 @@
 import java.util.zip.ZipEntry;
 import java.util.zip.ZipInputStream;
 
-public class GpxImportTask extends BaseLoadAsyncTask<Void, Void, GPXFile> {
+public class GpxImportTask extends BaseImportAsyncTask<Void, Void, GPXFile> {
 
 	private final Uri uri;
 	private final String fileName;
@@ -64,7 +63,7 @@ protected GPXFile doInBackground(Void... nothing) {
 				}
 			}
 		} catch (IOException | SecurityException | IllegalStateException e) {
-			ImportHelper.log.error(e.getMessage(), e);
+			ImportHelper.LOG.error(e.getMessage(), e);
 		} finally {
 			Algorithms.closeStream(is);
 			Algorithms.closeStream(zis);
@@ -115,7 +114,7 @@ private InputStream convertKmlToGpxStream(@NonNull InputStream is) {
 			try {
 				return new ByteArrayInputStream(result.getBytes("UTF-8"));
 			} catch (UnsupportedEncodingException e) {
-				ImportHelper.log.error(e.getMessage(), e);
+				ImportHelper.LOG.error(e.getMessage(), e);
 			}
 		}
 		return null;
@@ -124,6 +123,7 @@ private InputStream convertKmlToGpxStream(@NonNull InputStream is) {
 	@Override
 	protected void onPostExecute(GPXFile gpxFile) {
 		hideProgress();
-		callback.processResult(new Pair<GPXFile, Long>(gpxFile, fileSize));
+		notifyOnImportFinished();
+		callback.processResult(new Pair<>(gpxFile, fileSize));
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/ObfImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/ObfImportTask.java
index cc134607483..1d5763def3f 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/ObfImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/ObfImportTask.java
@@ -8,13 +8,12 @@
 import net.osmand.IProgress;
 import net.osmand.IndexConstants;
 import net.osmand.plus.R;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.importfiles.ImportHelper;
 
 import java.io.File;
 import java.util.ArrayList;
 
-public class ObfImportTask extends BaseLoadAsyncTask<Void, Void, String> {
+public class ObfImportTask extends BaseImportAsyncTask<Void, Void, String> {
 
 	private final Uri uri;
 	private final String name;
@@ -32,7 +31,7 @@ protected String doInBackground(Void... voids) {
 		File dest = getObfDestFile(fileName);
 		String error = ImportHelper.copyFile(app, dest, uri, false, unzip);
 		if (error == null) {
-			app.getResourceManager().reloadIndexes(IProgress.EMPTY_PROGRESS, new ArrayList<String>());
+			app.getResourceManager().reloadIndexes(IProgress.EMPTY_PROGRESS, new ArrayList<>());
 			app.getDownloadThread().updateLoadedFiles();
 			return app.getString(R.string.map_imported_successfully);
 		}
@@ -42,6 +41,7 @@ protected String doInBackground(Void... voids) {
 	@Override
 	protected void onPostExecute(String message) {
 		hideProgress();
+		notifyOnImportFinished();
 		app.showShortToastMessage(message);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/SettingsImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/SettingsImportTask.java
index e34b690fbad..896366bf405 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/SettingsImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/SettingsImportTask.java
@@ -12,7 +12,6 @@
 
 import net.osmand.plus.importfiles.ImportHelper;
 import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.CallbackWithObject;
 import net.osmand.plus.utils.FileUtils;
 import net.osmand.IndexConstants;
 import net.osmand.plus.AppInitializer;
@@ -21,11 +20,9 @@
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.plugins.audionotes.AudioVideoNotesPlugin;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.settings.backend.ExportSettingsType;
 import net.osmand.plus.settings.backend.backup.FileSettingsHelper;
 import net.osmand.plus.settings.backend.backup.SettingsHelper.CheckDuplicatesListener;
-import net.osmand.plus.settings.backend.backup.SettingsHelper.CollectListener;
 import net.osmand.plus.settings.backend.backup.SettingsHelper.ImportListener;
 import net.osmand.plus.settings.backend.backup.items.PluginSettingsItem;
 import net.osmand.plus.settings.backend.backup.items.SettingsItem;
@@ -38,7 +35,7 @@
 import java.util.List;
 import java.util.Map;
 
-public class SettingsImportTask extends BaseLoadAsyncTask<Void, Void, String> {
+public class SettingsImportTask extends BaseImportAsyncTask<Void, Void, String> {
 
 	private final Uri uri;
 	private final String name;
@@ -47,12 +44,10 @@ public class SettingsImportTask extends BaseLoadAsyncTask<Void, Void, String> {
 	private final boolean silentImport;
 	private final String latestChanges;
 	private final int version;
-	private final CallbackWithObject<List<SettingsItem>> callback;
 
 	public SettingsImportTask(@NonNull FragmentActivity activity, @NonNull Uri uri,
 							  @NonNull String name, List<ExportSettingsType> settingsTypes,
-							  boolean replace, boolean silentImport, String latestChanges, int version,
-							  CallbackWithObject<List<SettingsItem>> callback) {
+							  boolean replace, boolean silentImport, String latestChanges, int version) {
 		super(activity);
 		this.uri = uri;
 		this.name = name;
@@ -61,7 +56,6 @@ public SettingsImportTask(@NonNull FragmentActivity activity, @NonNull Uri uri,
 		this.silentImport = silentImport;
 		this.latestChanges = latestChanges;
 		this.version = version;
-		this.callback = callback;
 	}
 
 	@Override
@@ -77,39 +71,37 @@ protected void onPostExecute(String error) {
 		File file = new File(tempDir, name);
 		if (error == null && file.exists()) {
 			FileSettingsHelper settingsHelper = app.getFileSettingsHelper();
-			settingsHelper.collectSettings(file, latestChanges, version, new CollectListener() {
-				@Override
-				public void onCollectFinished(boolean succeed, boolean empty, @NonNull List<SettingsItem> items) {
-					hideProgress();
-					if (succeed) {
-						List<SettingsItem> pluginIndependentItems = new ArrayList<>();
-						List<PluginSettingsItem> pluginSettingsItems = new ArrayList<>();
-						for (SettingsItem item : items) {
-							if (item instanceof PluginSettingsItem) {
-								pluginSettingsItems.add((PluginSettingsItem) item);
-							} else if (Algorithms.isEmpty(item.getPluginId())) {
-								pluginIndependentItems.add(item);
-							}
-						}
-						for (PluginSettingsItem pluginItem : pluginSettingsItems) {
-							handlePluginImport(pluginItem, file);
+			settingsHelper.collectSettings(file, latestChanges, version, (succeed, empty, items) -> {
+				hideProgress();
+				if (succeed) {
+					List<SettingsItem> pluginIndependentItems = new ArrayList<>();
+					List<PluginSettingsItem> pluginSettingsItems = new ArrayList<>();
+					for (SettingsItem item : items) {
+						if (item instanceof PluginSettingsItem) {
+							pluginSettingsItems.add((PluginSettingsItem) item);
+						} else if (Algorithms.isEmpty(item.getPluginId())) {
+							pluginIndependentItems.add(item);
 						}
-						if (!pluginIndependentItems.isEmpty()) {
-							if (settingsTypes == null) {
-								FragmentActivity activity = activityRef.get();
-								if (!silentImport && activity != null) {
-									FragmentManager fragmentManager = activity.getSupportFragmentManager();
-									FileImportSettingsFragment.showInstance(fragmentManager, pluginIndependentItems, file);
-								}
-							} else {
-								Map<ExportSettingsType, List<?>> allSettingsMap = getSettingsToOperate(pluginIndependentItems, false, false);
-								List<SettingsItem> settingsList = settingsHelper.getFilteredSettingsItems(allSettingsMap, settingsTypes, pluginIndependentItems, false);
-								settingsHelper.checkDuplicates(file, settingsList, settingsList, getDuplicatesListener(file, replace));
+					}
+					for (PluginSettingsItem pluginItem : pluginSettingsItems) {
+						handlePluginImport(pluginItem, file);
+					}
+					if (!pluginIndependentItems.isEmpty()) {
+						if (settingsTypes == null) {
+							FragmentActivity activity = activityRef.get();
+							if (!silentImport && activity != null) {
+								FragmentManager fragmentManager = activity.getSupportFragmentManager();
+								FileImportSettingsFragment.showInstance(fragmentManager, pluginIndependentItems, file);
 							}
+						} else {
+							Map<ExportSettingsType, List<?>> allSettingsMap = getSettingsToOperate(pluginIndependentItems, false, false);
+							List<SettingsItem> settingsList = settingsHelper.getFilteredSettingsItems(allSettingsMap, settingsTypes, pluginIndependentItems, false);
+							settingsHelper.checkDuplicates(file, settingsList, settingsList, getDuplicatesListener(file, replace));
 						}
-					} else if (empty) {
-						app.showShortToastMessage(app.getString(R.string.file_import_error, name, app.getString(R.string.shared_string_unexpected_error)));
 					}
+					notifyOnImportFinished();
+				} else if (empty) {
+					app.showShortToastMessage(app.getString(R.string.file_import_error, name, app.getString(R.string.shared_string_unexpected_error)));
 				}
 			});
 		} else {
@@ -119,16 +111,13 @@ public void onCollectFinished(boolean succeed, boolean empty, @NonNull List<Sett
 	}
 
 	private CheckDuplicatesListener getDuplicatesListener(File file, boolean replace) {
-		return new CheckDuplicatesListener() {
-			@Override
-			public void onDuplicatesChecked(@NonNull List<Object> duplicates, List<SettingsItem> items) {
-				if (replace) {
-					for (SettingsItem item : items) {
-						item.setShouldReplace(true);
-					}
+		return (duplicates, items) -> {
+			if (replace) {
+				for (SettingsItem item : items) {
+					item.setShouldReplace(true);
 				}
-				app.getFileSettingsHelper().importSettings(file, items, "", 1, getImportListener(file));
 			}
+			app.getFileSettingsHelper().importSettings(file, items, "", 1, getImportListener(file));
 		};
 	}
 
@@ -208,14 +197,11 @@ public void onImportFinished(boolean succeed, boolean needRestart, @NonNull List
 		};
 		List<SettingsItem> pluginItems = new ArrayList<>(pluginItem.getPluginDependentItems());
 		pluginItems.add(0, pluginItem);
-		app.getFileSettingsHelper().checkDuplicates(file, pluginItems, pluginItems, new CheckDuplicatesListener() {
-			@Override
-			public void onDuplicatesChecked(@NonNull List<Object> duplicates, List<SettingsItem> items) {
-				for (SettingsItem item : items) {
-					item.setShouldReplace(true);
-				}
-				app.getFileSettingsHelper().importSettings(file, items, "", 1, importListener);
+		app.getFileSettingsHelper().checkDuplicates(file, pluginItems, pluginItems, (duplicates, items) -> {
+			for (SettingsItem item : items) {
+				item.setShouldReplace(true);
 			}
+			app.getFileSettingsHelper().importSettings(file, items, "", 1, importListener);
 		});
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/SqliteTileImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/SqliteTileImportTask.java
index f0fee4a1df8..22ef77173ba 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/SqliteTileImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/SqliteTileImportTask.java
@@ -12,10 +12,9 @@
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.plugins.rastermaps.OsmandRasterMapsPlugin;
 
-public class SqliteTileImportTask extends BaseLoadAsyncTask<Void, Void, String> {
+public class SqliteTileImportTask extends BaseImportAsyncTask<Void, Void, String> {
 
 	private final Uri uri;
 	private final String name;
@@ -42,6 +41,7 @@ protected void onPostExecute(String error) {
 				MapActivity mapActivity = (MapActivity) activity;
 				mapActivity.getMapLayers().selectMapLayer(mapActivity, true, app.getSettings().MAP_TILE_SOURCES, null);
 			}
+			notifyOnImportFinished();
 			Toast.makeText(app, app.getString(R.string.map_imported_successfully), Toast.LENGTH_SHORT).show();
 		} else {
 			Toast.makeText(app, app.getString(R.string.map_import_error) + ": " + error, Toast.LENGTH_SHORT).show();
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/UriImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/UriImportTask.java
index 55dadcdb3d7..dc817e51dd4 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/UriImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/UriImportTask.java
@@ -22,7 +22,7 @@
 import net.osmand.plus.R;
 import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.ImportType;
+import net.osmand.plus.importfiles.ImportType;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.FileUtils;
 import net.osmand.util.Algorithms;
@@ -73,7 +73,7 @@ protected String doInBackground(Void... nothing) {
 				}
 			}
 		} catch (SecurityException | NullPointerException | IOException e) {
-			ImportHelper.log.error(e);
+			ImportHelper.LOG.error(e);
 			error = e.getMessage();
 		} finally {
 			Algorithms.closeStream(is);
@@ -97,7 +97,7 @@ protected void onPostExecute(String error) {
 				ImportType importType = XmlImportTask.checkImportType(app, tempUri);
 				if (importType == ImportType.RENDERING || importType == ImportType.ROUTING) {
 					String name = importType == ImportType.RENDERING ? "renderer" + RENDERER_INDEX_EXT : "router" + ROUTING_FILE_EXT;
-					importHelper.handleXmlFileImport(tempUri, name, null);
+					importHelper.handleXmlFileImport(tempUri, name);
 				} else if (importType == ImportType.GPX || importType == ImportType.KML) {
 					importHelper.handleGpxOrFavouritesImport(tempUri, tempFileName, save, useImportDir, false, false, false);
 				}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
index d4f608a6374..563f3ffd2c7 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/XmlImportTask.java
@@ -6,19 +6,16 @@
 import android.net.Uri;
 
 import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
 import androidx.fragment.app.FragmentActivity;
 
 import com.google.android.material.snackbar.Snackbar;
 
-import net.osmand.CallbackWithObject;
 import net.osmand.IndexConstants;
 import net.osmand.PlatformUtil;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
-import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.ImportType;
+import net.osmand.plus.importfiles.ImportType;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.router.RoutingConfiguration.Builder;
@@ -32,20 +29,18 @@
 import java.io.IOException;
 import java.io.InputStream;
 
-public class XmlImportTask extends BaseLoadAsyncTask<Void, Void, String> {
+public class XmlImportTask extends BaseImportAsyncTask<Void, Void, String> {
 
 	private final Uri uri;
 	private String destFileName;
 	private ImportType importType;
-	private final CallbackWithObject routingCallback;
 	private final boolean overwrite;
 
 	public XmlImportTask(@NonNull FragmentActivity activity, @NonNull Uri uri,
-	                     @NonNull String fileName, @Nullable CallbackWithObject routingCallback, boolean overwrite) {
+	                     @NonNull String fileName, boolean overwrite) {
 		super(activity);
 		this.uri = uri;
 		this.destFileName = fileName;
-		this.routingCallback = routingCallback;
 		this.overwrite = overwrite;
 	}
 
@@ -68,17 +63,14 @@ protected void onPostExecute(String error) {
 		if (error == null && file.exists()) {
 			if (importType == ImportType.RENDERING) {
 				app.getRendererRegistry().updateExternalRenderers();
-				showSuccessSnackbar(destFileName);
+				onImportFinished(destFileName);
 				hideProgress();
 			} else if (importType == ImportType.ROUTING) {
 				loadRoutingFiles(app, () -> {
 					hideProgress();
 					Builder builder = app.getCustomRoutingConfig(destFileName);
 					if (builder != null) {
-						if (routingCallback != null) {
-							routingCallback.processResult(builder);
-						}
-						showSuccessSnackbar(destFileName);
+						onImportFinished(destFileName);
 					} else {
 						app.showToastMessage(app.getString(R.string.file_does_not_contain_routing_rules, destFileName));
 					}
@@ -90,6 +82,11 @@ protected void onPostExecute(String error) {
 		}
 	}
 
+	private void onImportFinished(@NonNull String fileName) {
+		showSuccessSnackbar(fileName);
+		notifyOnImportFinished();
+	}
+
 	private void showSuccessSnackbar(@NonNull String filename) {
 		FragmentActivity activity = activityRef.get();
 		if (AndroidUtils.isActivityNotDestroyed(activity)) {
@@ -156,11 +153,11 @@ public static ImportType checkImportType(OsmandApplication app, Uri uri) {
 				Algorithms.closeStream(is);
 			}
 		} catch (FileNotFoundException | XmlPullParserException e) {
-			ImportHelper.log.error(e);
+			ImportHelper.LOG.error(e);
 		} catch (IOException e) {
-			ImportHelper.log.error(e);
+			ImportHelper.LOG.error(e);
 		} catch (SecurityException e) {
-			ImportHelper.log.error(e.getMessage(), e);
+			ImportHelper.LOG.error(e.getMessage(), e);
 		} finally {
 			Algorithms.closeStream(is);
 		}
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/tasks/ZipImportTask.java b/OsmAnd/src/net/osmand/plus/importfiles/tasks/ZipImportTask.java
index 67defba33b2..497354f1771 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/tasks/ZipImportTask.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/tasks/ZipImportTask.java
@@ -6,7 +6,7 @@
 import static net.osmand.IndexConstants.OSMAND_SETTINGS_FILE_EXT;
 import static net.osmand.IndexConstants.TEMP_DIR;
 import static net.osmand.plus.importfiles.ImportHelper.KML_SUFFIX;
-import static net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
+import static net.osmand.plus.importfiles.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
 import static net.osmand.plus.utils.FileUtils.createUniqueFileName;
 
 import android.net.Uri;
@@ -16,7 +16,7 @@
 
 import net.osmand.plus.base.BaseLoadAsyncTask;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.ImportType;
+import net.osmand.plus.importfiles.ImportType;
 import net.osmand.util.Algorithms;
 
 import java.io.InputStream;
@@ -61,7 +61,7 @@ protected ImportType doInBackground(Void... voids) {
 				}
 			}
 		} catch (Exception e) {
-			ImportHelper.log.error(e.getMessage(), e);
+			ImportHelper.LOG.error(e.getMessage(), e);
 		} finally {
 			Algorithms.closeStream(is);
 			Algorithms.closeStream(zis);
@@ -88,7 +88,7 @@ protected void onPostExecute(ImportType importType) {
 		} else if (importType == ImportType.SETTINGS) {
 			String name = createUniqueFileName(app, "settings", TEMP_DIR, OSMAND_SETTINGS_FILE_EXT);
 			importHelper.handleOsmAndSettingsImport(uri, name + OSMAND_SETTINGS_FILE_EXT,
-					null, false, false, null, -1, null);
+					null, false, false, null, -1);
 		}
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java b/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
index b97727b327c..3f6e6c38c65 100644
--- a/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
+++ b/OsmAnd/src/net/osmand/plus/importfiles/ui/ImportTracksFragment.java
@@ -41,7 +41,7 @@
 import net.osmand.plus.configmap.tracks.TracksFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
+import net.osmand.plus.importfiles.GpxImportListener;
 import net.osmand.plus.importfiles.SaveImportedGpxListener;
 import net.osmand.plus.importfiles.tasks.CollectTracksTask;
 import net.osmand.plus.importfiles.tasks.CollectTracksTask.CollectTracksListener;
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/StartPlanRouteBottomSheet.java b/OsmAnd/src/net/osmand/plus/measurementtool/StartPlanRouteBottomSheet.java
index a64d9bb7a07..64c2f9ebcd2 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/StartPlanRouteBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/StartPlanRouteBottomSheet.java
@@ -26,7 +26,8 @@
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.DividerItem;
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.TitleItem;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
+import net.osmand.plus.importfiles.GpxImportListener;
+import net.osmand.plus.importfiles.OnSuccessfulGpxImport;
 import net.osmand.plus.measurementtool.SelectFileBottomSheet.SelectFileListener;
 import net.osmand.plus.track.GpxTrackAdapter;
 import net.osmand.plus.track.data.GPXInfo;
@@ -51,7 +52,11 @@ public class StartPlanRouteBottomSheet extends BottomSheetBehaviourDialogFragmen
 
 	@Override
 	public void createMenuItems(Bundle savedInstanceState) {
-		importHelper = new ImportHelper(requireActivity());
+		OsmandApplication app = getMyApplication();
+		if (app == null) {
+			return;
+		}
+		importHelper = app.getImportHelper();
 		int themeRes = nightMode ? R.style.OsmandDarkTheme : R.style.OsmandLightTheme;
 		mainView = View.inflate(new ContextThemeWrapper(getContext(), themeRes),
 				R.layout.bottom_sheet_plan_route_start, null);
@@ -99,10 +104,6 @@ public void createMenuItems(Bundle savedInstanceState) {
 
 		RecyclerView recyclerView = mainView.findViewById(R.id.gpx_track_list);
 		recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
-		OsmandApplication app = getMyApplication();
-		if (app == null) {
-			return;
-		}
 
 		File gpxDir = app.getAppPath(IndexConstants.GPX_INDEX_DIR);
 		List<GPXInfo> gpxList = getSortedGPXFilesInfo(gpxDir, null, false);
@@ -149,7 +150,7 @@ public void onImportComplete(boolean success) {
 						importHelper.setGpxImportListener(null);
 					}
 				});
-				importHelper.handleGpxImport(uri, ImportHelper.OnSuccessfulGpxImport.OPEN_PLAN_ROUTE_FRAGMENT, false);
+				importHelper.handleGpxImport(uri, OnSuccessfulGpxImport.OPEN_PLAN_ROUTE_FRAGMENT, false);
 			}
 		} else {
 			super.onActivityResult(requestCode, resultCode, data);
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java b/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
index 9d398413982..496c6db7d38 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
@@ -40,6 +40,7 @@ public class MyPlacesActivity extends TabActivity {
 	public static final int GPX_TAB = R.string.shared_string_tracks;
 	public static final int FAV_TAB = R.string.shared_string_my_favorites;
 
+	private OsmandApplication app;
 	private OsmandSettings settings;
 
 	private ViewPager viewPager;
@@ -50,7 +51,7 @@ public class MyPlacesActivity extends TabActivity {
 
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
-		OsmandApplication app = getMyApplication();
+		app = getMyApplication();
 		settings = app.getSettings();
 		app.applyTheme(this);
 		super.onCreate(savedInstanceState);
@@ -140,6 +141,7 @@ protected void onResume() {
 		if (tabItems.size() != tabSize) {
 			setTabs(tabItems);
 		}
+		app.getImportHelper().setUiActivity(this);
 		viewPager.addOnPageChangeListener(new SimpleOnPageChangeListener() {
 			@Override
 			public void onPageSelected(int position) {
@@ -154,6 +156,12 @@ protected void onPause() {
 		viewPager.clearOnPageChangeListeners();
 	}
 
+	@Override
+	protected void onDestroy() {
+		super.onDestroy();
+		app.getImportHelper().resetUIActivity(this);
+	}
+
 	@Override
 	public boolean onOptionsItemSelected(MenuItem item) {
 		int itemId = item.getItemId();
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
index 8772be6b6cf..21776105ceb 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/favorites/dialogs/FavoritesTreeFragment.java
@@ -120,7 +120,7 @@ public class FavoritesTreeFragment extends OsmandExpandableListFragment implemen
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
 		favouritesAdapter = new FavouritesAdapter();
-		importHelper = new ImportHelper(requireActivity());
+		importHelper = app.getImportHelper();
 
 		helper = app.getFavoritesHelper();
 		if (helper.isFavoritesLoaded()) {
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/TrackFoldersHelper.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/TrackFoldersHelper.java
index 824729de715..41f8ea2cab8 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/TrackFoldersHelper.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/TrackFoldersHelper.java
@@ -2,7 +2,7 @@
 
 import static net.osmand.IndexConstants.GPX_INDEX_DIR;
 import static net.osmand.plus.importfiles.ImportHelper.IMPORT_FILE_REQUEST;
-import static net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
+import static net.osmand.plus.importfiles.OnSuccessfulGpxImport.OPEN_GPX_CONTEXT_MENU;
 import static net.osmand.plus.settings.fragments.ExportSettingsFragment.SELECTED_TYPES;
 
 import android.content.Intent;
@@ -31,7 +31,7 @@
 import net.osmand.plus.configmap.tracks.TracksAppearanceFragment;
 import net.osmand.plus.helpers.IntentHelper;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
+import net.osmand.plus.importfiles.GpxImportListener;
 import net.osmand.plus.importfiles.MultipleTracksImportListener;
 import net.osmand.plus.importfiles.ui.FileExistBottomSheet;
 import net.osmand.plus.importfiles.ui.FileExistBottomSheet.SaveExistingFileListener;
@@ -90,8 +90,8 @@ public class TrackFoldersHelper implements OnTrackFileMoveListener {
 
 	public TrackFoldersHelper(@NonNull MyPlacesActivity activity) {
 		this.activity = activity;
-		this.importHelper = new ImportHelper(activity);
 		this.app = activity.getMyApplication();
+		this.importHelper = app.getImportHelper();
 		this.uiUtilities = app.getUIUtilities();
 		this.gpxSelectionHelper = app.getSelectedGpxHelper();
 	}
@@ -432,6 +432,7 @@ public void onImportStarted() {
 					@Override
 					public void onImportFinished() {
 						importing = false;
+						importHelper.setGpxImportListener(null);
 						if (gpxImportListener != null) {
 							gpxImportListener.onImportFinished();
 						}
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
index 5c3a6f4e03b..398feac225d 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/tracks/dialogs/BaseTrackFolderFragment.java
@@ -40,7 +40,7 @@
 import net.osmand.plus.configmap.tracks.viewholders.TrackViewHolder.TrackSelectionListener;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
+import net.osmand.plus.importfiles.GpxImportListener;
 import net.osmand.plus.myplaces.MyPlacesActivity;
 import net.osmand.plus.myplaces.favorites.dialogs.FragmentStateHolder;
 import net.osmand.plus.myplaces.tracks.ItemsSelectionHelper.SelectionHelperProvider;
diff --git a/OsmAnd/src/net/osmand/plus/profiles/SelectNavProfileBottomSheet.java b/OsmAnd/src/net/osmand/plus/profiles/SelectNavProfileBottomSheet.java
index a3ec186f8b0..9232816e09e 100644
--- a/OsmAnd/src/net/osmand/plus/profiles/SelectNavProfileBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/profiles/SelectNavProfileBottomSheet.java
@@ -1,6 +1,6 @@
 package net.osmand.plus.profiles;
 
-import static net.osmand.plus.importfiles.ImportHelper.ImportType.ROUTING;
+import static net.osmand.plus.importfiles.ImportType.ROUTING;
 import static net.osmand.plus.onlinerouting.engine.OnlineRoutingEngine.NONE_VEHICLE;
 
 import android.content.Context;
@@ -20,7 +20,6 @@
 import androidx.fragment.app.FragmentActivity;
 import androidx.fragment.app.FragmentManager;
 
-import net.osmand.CallbackWithObject;
 import net.osmand.IndexConstants;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
@@ -28,6 +27,7 @@
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.LongDescriptionItem;
 import net.osmand.plus.base.bottomsheetmenu.simpleitems.TitleItem;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.importfiles.ImportTaskCallback;
 import net.osmand.plus.onlinerouting.EngineParameter;
 import net.osmand.plus.onlinerouting.OnlineRoutingHelper;
 import net.osmand.plus.onlinerouting.engine.EngineType;
@@ -48,14 +48,13 @@
 import net.osmand.plus.widgets.popup.PopUpMenuItem;
 import net.osmand.plus.widgets.popup.PopUpMenuWidthMode;
 import net.osmand.plus.widgets.tools.ClickableSpanTouchListener;
-import net.osmand.router.RoutingConfiguration.Builder;
 import net.osmand.util.Algorithms;
 
 import java.io.File;
 import java.util.ArrayList;
 import java.util.List;
 
-public class SelectNavProfileBottomSheet extends SelectProfileBottomSheet {
+public class SelectNavProfileBottomSheet extends SelectProfileBottomSheet implements ImportTaskCallback {
 
 	private static final String DOWNLOADED_PREDEFINED_JSON = "downloaded_predefined_json";
 	private static final String DIALOG_TYPE = "dialog_type";
@@ -134,6 +133,24 @@ public void readFromBundle(Bundle savedState) {
 		}
 	}
 
+	@Override
+	public void onResume() {
+		super.onResume();
+		MapActivity mapActivity = getMapActivity();
+		if (mapActivity != null) {
+			mapActivity.getImportHelper().addImportTaskCallback(this);
+		}
+	}
+
+	@Override
+	public void onPause() {
+		super.onPause();
+		MapActivity mapActivity = getMapActivity();
+		if (mapActivity != null) {
+			mapActivity.getImportHelper().removeImportTaskCallback(this);
+		}
+	}
+
 	@Override
 	public void onSaveInstanceState(@NonNull Bundle outState) {
 		super.onSaveInstanceState(outState);
@@ -216,17 +233,19 @@ private void createOfflineFooter() {
 			if (mapActivity == null) {
 				return;
 			}
-			mapActivity.getImportHelper().chooseFileToImport(ROUTING, (CallbackWithObject<Builder>) builder -> {
-				Fragment targetFragment = getTargetFragment();
-				if (targetFragment instanceof NavigationFragment) {
-					((NavigationFragment) targetFragment).updateRoutingProfiles();
-				}
-				updateMenuItems();
-				return false;
-			});
+			mapActivity.getImportHelper().chooseFileToImport(ROUTING);
 		});
 	}
 
+	@Override
+	public void onImportSuccessfullyFinished() {
+		Fragment targetFragment = getTargetFragment();
+		if (targetFragment instanceof NavigationFragment) {
+			((NavigationFragment) targetFragment).updateRoutingProfiles();
+		}
+		updateMenuItems();
+	}
+
 	private void createOnlineFooter() {
 		items.add(new LongDescriptionItem(app.getString(R.string.osmand_online_routing_promo)));
 		addButtonItem(R.string.add_online_routing_engine, R.drawable.ic_action_plus, v -> {
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
index 1a8b9d65e65..3fb06f2f15c 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/FollowTrackFragment.java
@@ -26,8 +26,8 @@
 import net.osmand.plus.base.ContextMenuScrollFragment;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
-import net.osmand.plus.importfiles.ImportHelper.OnSuccessfulGpxImport;
+import net.osmand.plus.importfiles.GpxImportListener;
+import net.osmand.plus.importfiles.OnSuccessfulGpxImport;
 import net.osmand.plus.measurementtool.MeasurementToolFragment;
 import net.osmand.plus.routepreparationmenu.cards.AttachTrackToRoadsCard;
 import net.osmand.plus.routepreparationmenu.cards.BaseCard;
@@ -121,8 +121,7 @@ public int getSupportedMenuStatesPortrait() {
 	@Override
 	public void onCreate(Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
-		MapActivity mapActivity = requireMapActivity();
-		importHelper = new ImportHelper(mapActivity);
+		importHelper = app.getImportHelper();
 
 		GPXRouteParamsBuilder routeParamsBuilder = app.getRoutingHelper().getCurrentGPXRoute();
 		if (routeParamsBuilder != null) {
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/MainSettingsFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/MainSettingsFragment.java
index 047dacfe671..83b466cee93 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/MainSettingsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/MainSettingsFragment.java
@@ -1,7 +1,7 @@
 package net.osmand.plus.settings.fragments;
 
 import static net.osmand.plus.backup.ui.BackupUiUtils.getLastBackupTimeDescription;
-import static net.osmand.plus.importfiles.ImportHelper.ImportType.SETTINGS;
+import static net.osmand.plus.importfiles.ImportType.SETTINGS;
 import static net.osmand.plus.profiles.SelectProfileBottomSheet.PROFILES_LIST_UPDATED_ARG;
 import static net.osmand.plus.profiles.SelectProfileBottomSheet.PROFILE_KEY_ARG;
 
@@ -153,7 +153,7 @@ public boolean onPreferenceClick(Preference preference) {
 		} else if (IMPORT_FROM_FILE.equals(prefId)) {
 			MapActivity mapActivity = getMapActivity();
 			if (mapActivity != null) {
-				mapActivity.getImportHelper().chooseFileToImport(SETTINGS, null);
+				mapActivity.getImportHelper().chooseFileToImport(SETTINGS);
 				return true;
 			}
 		}
diff --git a/OsmAnd/src/net/osmand/plus/track/helpers/GpxUiHelper.java b/OsmAnd/src/net/osmand/plus/track/helpers/GpxUiHelper.java
index 12feac7a021..2aa83581e8c 100644
--- a/OsmAnd/src/net/osmand/plus/track/helpers/GpxUiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/track/helpers/GpxUiHelper.java
@@ -62,7 +62,7 @@
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.helpers.SelectGpxTrackBottomSheet;
 import net.osmand.plus.importfiles.ImportHelper;
-import net.osmand.plus.importfiles.ImportHelper.GpxImportListener;
+import net.osmand.plus.importfiles.GpxImportListener;
 import net.osmand.plus.mapcontextmenu.controllers.SelectedGpxMenuController.SelectedGpxPoint;
 import net.osmand.plus.mapcontextmenu.other.TrackDetailsMenu.ChartPointLayer;
 import net.osmand.plus.plugins.PluginsFragment;
@@ -670,6 +670,7 @@ public void onSaveComplete(boolean success, GPXFile gpxFile) {
 							app.getSelectedGpxHelper().selectGpxFile(gpxFile, params);
 							updateGpxDialogAfterImport(activity, listAdapter, contextMenuAdapter, allGpxFiles, gpxFile.path);
 						}
+						importHelper.setGpxImportListener(null);
 					}
 				});
 
