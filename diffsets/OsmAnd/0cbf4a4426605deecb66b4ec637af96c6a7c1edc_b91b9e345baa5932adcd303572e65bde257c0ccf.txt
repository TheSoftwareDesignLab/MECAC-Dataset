diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingBottomSheet.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingBottomSheet.java
index f66ed3d5f8c..b6e294e9270 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingBottomSheet.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingBottomSheet.java
@@ -84,7 +84,6 @@ public class TripRecordingBottomSheet extends SideMenuBottomSheetDialogFragment
 	private static final Log LOG = PlatformUtil.getLog(TripRecordingBottomSheet.class);
 	public static final String UPDATE_TRACK_ICON = "update_track_icon";
 	public static final String UPDATE_DYNAMIC_ITEMS = "update_dynamic_items";
-	private static final int GPS_UPDATE_INTERVAL = 1000;
 	public static final GPXTabItemType[] INIT_TAB_ITEMS =
 			new GPXTabItemType[] {GPX_TAB_ITEM_GENERAL, GPX_TAB_ITEM_ALTITUDE, GPX_TAB_ITEM_SPEED};
 
@@ -103,9 +102,8 @@ public class TripRecordingBottomSheet extends SideMenuBottomSheetDialogFragment
 
 	private GpxBlockStatisticsBuilder blockStatisticsBuilder;
 	private SelectedGpxFile selectedGpxFile;
-	private final Handler handler = new Handler();
-	private Runnable updatingGPS;
-	private Runnable updatingGraph;
+
+	private TripRecordingUpdatesHandler handler;
 
 	private GPXFile getGPXFile() {
 		return selectedGpxFile.getGpxFile();
@@ -131,12 +129,21 @@ public static void showInstance(@NonNull FragmentManager fragmentManager) {
 	}
 
 	@Override
-	public void createMenuItems(Bundle savedInstanceState) {
+	public void onCreate(Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
 		app = requiredMyApplication();
 		settings = app.getSettings();
 		helper = app.getSavingTrackHelper();
 		plugin = OsmandPlugin.getPlugin(OsmandMonitoringPlugin.class);
 		selectedGpxFile = helper.getCurrentTrack();
+		handler = new TripRecordingUpdatesHandler(app, this::updateStatus, () -> {
+			graphsAdapter.updateGraph(graphTabPosition);
+			AndroidUiHelper.updateVisibility(segmentsTabs, graphsAdapter.isTabsVisible());
+		});
+	}
+
+	@Override
+	public void createMenuItems(Bundle savedInstanceState) {
 		LayoutInflater inflater = UiUtilities.getInflater(getContext(), nightMode);
 
 		View itemView = inflater.inflate(R.layout.trip_recording_fragment, null, false);
@@ -196,10 +203,10 @@ private void setupResumePauseButton(View container) {
 			boolean isRecordingTrack = isRecordingTrack();
 			if (isRecordingTrack) {
 				blockStatisticsBuilder.stopUpdatingStatBlocks();
-				stopUpdatingGraph();
+				handler.stopChartUpdates();
 			} else {
 				blockStatisticsBuilder.runUpdatingStatBlocksIfNeeded();
-				runUpdatingGraph();
+				handler.startChartUpdatesIfNotRunning();
 			}
 			if (isRecordingTrack) {
 				settings.SAVE_GLOBAL_TRACK_TO_GPX.set(false);
@@ -244,8 +251,8 @@ private void setupOptionsButton(View container) {
 	public void onResume() {
 		super.onResume();
 		blockStatisticsBuilder.runUpdatingStatBlocksIfNeeded();
-		runUpdatingGPS();
-		runUpdatingGraph();
+		handler.startGpsUpdatesIfNotRunning();
+		handler.startChartUpdatesIfNotRunning();
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
 			mapActivity.getMapLayers().getGpxLayer().setTrackChartPoints(trackChartPoints);
@@ -256,8 +263,8 @@ public void onResume() {
 	public void onPause() {
 		super.onPause();
 		blockStatisticsBuilder.stopUpdatingStatBlocks();
-		stopUpdatingGPS();
-		stopUpdatingGraph();
+		handler.stopGpsUpdates();
+		handler.stopChartUpdates();
 		MapActivity mapActivity = getMapActivity();
 		if (mapActivity != null) {
 			mapActivity.getMapLayers().getGpxLayer().setTrackChartPoints(null);
@@ -287,50 +294,9 @@ public void hide() {
 		}
 	}
 
-	private void stopUpdatingGPS() {
-		handler.removeCallbacks(updatingGPS);
-	}
-
-	private void runUpdatingGPS() {
-		if (updatingGPS == null) {
-			updatingGPS = new Runnable() {
-				@Override
-				public void run() {
-					int interval = app.getSettings().SAVE_GLOBAL_TRACK_INTERVAL.get();
-					updateStatus();
-					handler.postDelayed(this, Math.max(GPS_UPDATE_INTERVAL, interval));
-				}
-			};
-		}
-		if (!handler.hasCallbacks(updatingGPS)) {
-			handler.post(updatingGPS);
-		}
-	}
-
-	private void stopUpdatingGraph() {
-		handler.removeCallbacks(updatingGraph);
-	}
-
-	private void runUpdatingGraph() {
-		if (updatingGraph == null) {
-			updatingGraph = new Runnable() {
-				@Override
-				public void run() {
-					int interval = app.getSettings().SAVE_GLOBAL_TRACK_INTERVAL.get();
-					graphsAdapter.updateGraph(graphTabPosition);
-					AndroidUiHelper.updateVisibility(segmentsTabs, graphsAdapter.isTabsVisible());
-					handler.postDelayed(this, Math.max(GPS_UPDATE_INTERVAL, interval));
-				}
-			};
-		}
-		if (!handler.hasCallbacks(updatingGraph)) {
-			handler.post(updatingGraph);
-		}
-	}
-
 	private void restartUpdatingGraph() {
-		stopUpdatingGraph();
-		runUpdatingGraph();
+		handler.stopChartUpdates();
+		handler.startChartUpdatesIfNotRunning();
 	}
 
 	private void createSegmentsTabs(ViewGroup viewGroup) {
diff --git a/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingUpdatesHandler.java b/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingUpdatesHandler.java
new file mode 100644
index 00000000000..33cbd997912
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/plugins/monitoring/TripRecordingUpdatesHandler.java
@@ -0,0 +1,63 @@
+package net.osmand.plus.plugins.monitoring;
+
+import android.os.Handler;
+import android.os.Message;
+
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.settings.backend.OsmandSettings;
+
+import androidx.annotation.NonNull;
+
+@SuppressWarnings("deprecation")
+public class TripRecordingUpdatesHandler extends Handler {
+
+	private static final int UPDATE_GPS_MESSAGE_ID = 0;
+	private static final int UPDATE_CHART_MESSAGE_ID = 1;
+
+	private static final int MIN_UPDATE_INTERVAL = 1000;
+
+	private final OsmandSettings settings;
+	private final Runnable gpsUpdateTask;
+	private final Runnable chartUpdateTask;
+
+	public TripRecordingUpdatesHandler(@NonNull OsmandApplication app,
+	                                   @NonNull Runnable gpsUpdateTask,
+	                                   @NonNull Runnable chartUpdateTask) {
+		this.settings = app.getSettings();
+		this.gpsUpdateTask = gpsUpdateTask;
+		this.chartUpdateTask = chartUpdateTask;
+	}
+
+	public void startGpsUpdatesIfNotRunning() {
+		if (!hasMessages(UPDATE_GPS_MESSAGE_ID)) {
+			sendEmptyMessage(UPDATE_GPS_MESSAGE_ID);
+		}
+	}
+
+	public void startChartUpdatesIfNotRunning() {
+		if (!hasMessages(UPDATE_CHART_MESSAGE_ID)) {
+			sendEmptyMessage(UPDATE_CHART_MESSAGE_ID);
+		}
+	}
+
+	public void stopGpsUpdates() {
+		removeMessages(UPDATE_GPS_MESSAGE_ID);
+	}
+
+	public void stopChartUpdates() {
+		removeMessages(UPDATE_CHART_MESSAGE_ID);
+	}
+
+	@Override
+	public void handleMessage(@NonNull Message message) {
+		int messageId = message.what;
+		int updateInterval = Math.max(MIN_UPDATE_INTERVAL, settings.SAVE_GLOBAL_TRACK_INTERVAL.get());
+		if (messageId == UPDATE_GPS_MESSAGE_ID) {
+			gpsUpdateTask.run();
+			sendEmptyMessageDelayed(UPDATE_GPS_MESSAGE_ID, updateInterval);
+		} else if (messageId == UPDATE_CHART_MESSAGE_ID) {
+			chartUpdateTask.run();
+			sendEmptyMessageDelayed(UPDATE_CHART_MESSAGE_ID, updateInterval);
+		}
+	}
+}
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
index 1686dfdf081..4ce085707b1 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/rastermaps/DownloadTilesFragment.java
@@ -5,10 +5,9 @@
 import android.content.Context;
 import android.graphics.Bitmap;
 import android.net.Uri;
-import android.os.Build.VERSION;
-import android.os.Build.VERSION_CODES;
 import android.os.Bundle;
 import android.os.Handler;
+import android.os.Message;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
@@ -54,8 +53,6 @@ public class DownloadTilesFragment extends BaseOsmAndFragment implements IMapLoc
 
 	public static final Uri HELP_URI = Uri.parse("https://docs.osmand.net/en/main@latest/osmand/map/raster-maps#download--update-tiles");
 
-	private static final long UPDATE_TILES_PREVIEW_INTERVAL = 500;
-
 	private static final String KEY_SELECTED_MIN_ZOOM = "selected_min_zoom";
 	private static final String KEY_SELECTED_MAX_ZOOM = "selected_max_zoom";
 
@@ -63,8 +60,7 @@ public class DownloadTilesFragment extends BaseOsmAndFragment implements IMapLoc
 	private OsmandSettings settings;
 	private boolean nightMode;
 
-	private final Handler handler = new Handler();
-	private Runnable updateTilesTask;
+	private UpdateTilesHandler handler;
 
 	private OsmandMapTileView mapView;
 	private TilesPreviewDrawer tilesPreviewDrawer;
@@ -95,12 +91,18 @@ public class DownloadTilesFragment extends BaseOsmAndFragment implements IMapLoc
 	@Override
 	public void onCreate(@Nullable Bundle savedInstanceState) {
 		super.onCreate(savedInstanceState);
+
 		app = requireMyApplication();
 		settings = requireSettings();
 		nightMode = isNightMode(true);
 		mapView = requireMapActivity().getMapView();
 		tilesPreviewDrawer = new TilesPreviewDrawer(app);
 		tileSource = settings.getMapTileSource(false);
+		handler = new UpdateTilesHandler(() -> {
+			setupTilesDownloadInfo();
+			updateTilesPreview();
+		});
+
 		if (savedInstanceState != null) {
 			selectedMinZoom = savedInstanceState.getInt(KEY_SELECTED_MIN_ZOOM);
 			selectedMaxZoom = savedInstanceState.getInt(KEY_SELECTED_MAX_ZOOM);
@@ -317,20 +319,7 @@ public void onResume() {
 			}
 		}
 		mapView.addMapLocationListener(this);
-		runUpdatingTiles();
-	}
-
-	public void runUpdatingTiles() {
-		if (updateTilesTask == null) {
-			updateTilesTask = () -> {
-				setupTilesDownloadInfo();
-				updateTilesPreview();
-				handler.postDelayed(updateTilesTask, UPDATE_TILES_PREVIEW_INTERVAL);
-			};
-		}
-		if (VERSION.SDK_INT >= VERSION_CODES.Q && !handler.hasCallbacks(updateTilesTask)) {
-			handler.post(updateTilesTask);
-		}
+		handler.startUpdatesIfNotRunning();
 	}
 
 	@Override
@@ -341,7 +330,7 @@ public void onPause() {
 			mapActivity.enableDrawer();
 		}
 		mapView.removeMapLocationListener(this);
-		handler.removeCallbacks(updateTilesTask);
+		handler.stopUpdates();
 	}
 
 	@Override
@@ -446,4 +435,35 @@ public static void showInstance(@NonNull FragmentManager fragmentManager) {
 					.commitAllowingStateLoss();
 		}
 	}
+
+	@SuppressWarnings("deprecation")
+	private static class UpdateTilesHandler extends Handler {
+
+		private static final int UPDATE_TILES_MESSAGE_ID = 0;
+		private static final long UPDATE_TILES_PREVIEW_INTERVAL = 500;
+
+		private final Runnable updateTilesTask;
+
+		public UpdateTilesHandler(@NonNull Runnable updateTilesTask) {
+			this.updateTilesTask = updateTilesTask;
+		}
+
+		public void startUpdatesIfNotRunning() {
+			if (!hasMessages(UPDATE_TILES_MESSAGE_ID)) {
+				sendEmptyMessage(UPDATE_TILES_MESSAGE_ID);
+			}
+		}
+
+		public void stopUpdates() {
+			removeMessages(UPDATE_TILES_MESSAGE_ID);
+		}
+
+		@Override
+		public void handleMessage(@NonNull Message message) {
+			if (message.what == UPDATE_TILES_MESSAGE_ID) {
+				updateTilesTask.run();
+				sendEmptyMessageDelayed(UPDATE_TILES_MESSAGE_ID, UPDATE_TILES_PREVIEW_INTERVAL);
+			}
+		}
+	}
 }
\ No newline at end of file
