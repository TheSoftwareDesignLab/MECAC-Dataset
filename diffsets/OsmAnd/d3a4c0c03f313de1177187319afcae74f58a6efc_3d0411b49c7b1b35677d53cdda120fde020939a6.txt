diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
index de53c97b863..a7c7cdd0797 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
@@ -12,6 +12,7 @@
 
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
+import net.osmand.plus.helpers.RequestMapThemeParams;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.UiUtilities;
 
@@ -65,6 +66,7 @@ protected Drawable getContentIcon(@DrawableRes int id) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		RequestMapThemeParams params = new RequestMapThemeParams().markIgnoreExternalProvider();
+		return app.getDaynightHelper().isNightMode(usedOnMap, params);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
index 8336cacc9e0..83fbee0b021 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
@@ -22,6 +22,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.activities.MapActivity;
 import net.osmand.plus.activities.OsmandActionBarActivity;
+import net.osmand.plus.helpers.RequestMapThemeParams;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -189,6 +190,7 @@ protected int getDimensionPixelSize(@DimenRes int resId) {
 	}
 
 	protected boolean isNightMode(boolean usedOnMap) {
-		return app.getDaynightHelper().isNightMode(usedOnMap);
+		RequestMapThemeParams params = new RequestMapThemeParams().markIgnoreExternalProvider();
+		return app.getDaynightHelper().isNightMode(usedOnMap, params);
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
index b4ca62996b7..ac27e52d7bc 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
@@ -55,7 +55,7 @@ public class DayNightHelper implements SensorEventListener {
 	private final OsmandSettings settings;
 	private final OsmAndLocationProvider locationProvider;
 
-	private MapThemeProvider mapThemeProvider;
+	private MapThemeProvider externalMapThemeProvider;
 	private OsmAndLocationListener locationListener;
 	private SensorEventListener sensorEventListener;
 	private StateChangedListener<Boolean> sensorStateListener;
@@ -79,8 +79,8 @@ private void resetLastTime() {
 		lastTime = 0;
 	}
 
-	public void setMapThemeProvider(@Nullable MapThemeProvider mapThemeProvider) {
-		this.mapThemeProvider = mapThemeProvider;
+	public void setExternalMapThemeProvider(@Nullable MapThemeProvider externalMapThemeProvider) {
+		this.externalMapThemeProvider = externalMapThemeProvider;
 	}
 
 	@NonNull
@@ -111,33 +111,43 @@ private StateChangedListener<DayNightMode> getPreferenceStateListener() {
 	}
 
 	public boolean isNightMode(boolean usedOnMap) {
+		return isNightMode(usedOnMap, new RequestMapThemeParams());
+	}
+
+	public boolean isNightMode(boolean usedOnMap, @NonNull RequestMapThemeParams params) {
 		if (usedOnMap) {
-			return isNightModeForMapControls();
+			return isNightModeForMapControls(params);
 		} else {
-			return !app.getSettings().isLightContent();
+			return !settings.isLightContent();
 		}
 	}
 
 	public boolean isNightModeForMapControls() {
-		return isNightModeForMapControlsForProfile(settings.APPLICATION_MODE.get());
+		return isNightModeForMapControls(new RequestMapThemeParams());
 	}
 
 	public boolean isNightModeForMapControlsForProfile(ApplicationMode mode) {
+		return isNightModeForMapControls(new RequestMapThemeParams().setAppMode(mode));
+	}
+
+	public boolean isNightModeForMapControls(@NonNull RequestMapThemeParams params) {
+		ApplicationMode mode = params.requireAppMode(settings.APPLICATION_MODE.get());
 		if (settings.isLightContentForMode(mode)) {
-			return isNightModeForProfile(mode);
+			return isNightModeForProfile(params);
 		} else {
 			return true;
 		}
 	}
 
 	public boolean isNightMode() {
-		return isNightModeForProfile(settings.APPLICATION_MODE.get());
+		return isNightModeForProfile(new RequestMapThemeParams());
 	}
 
-	public boolean isNightModeForProfile(ApplicationMode mode) {
+	private boolean isNightModeForProfile(@NonNull RequestMapThemeParams params) {
+		ApplicationMode mode = params.requireAppMode(settings.APPLICATION_MODE.get());
 		DayNightMode dayNightMode = settings.DAYNIGHT_MODE.getModeValue(mode);
-		if (mapThemeProvider != null) {
-			DayNightMode providedTheme = mapThemeProvider.getMapTheme();
+		if (externalMapThemeProvider != null && !params.shouldIgnoreExternalProvider()) {
+			DayNightMode providedTheme = externalMapThemeProvider.getMapTheme();
 			dayNightMode = providedTheme != null ? providedTheme : dayNightMode;
 		}
 		NavigationSession carNavigationSession = app.getCarNavigationSession();
diff --git a/OsmAnd/src/net/osmand/plus/helpers/RequestMapThemeParams.java b/OsmAnd/src/net/osmand/plus/helpers/RequestMapThemeParams.java
new file mode 100644
index 00000000000..1d2b0ba2dd1
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/helpers/RequestMapThemeParams.java
@@ -0,0 +1,32 @@
+package net.osmand.plus.helpers;
+
+import androidx.annotation.NonNull;
+
+import net.osmand.plus.settings.backend.ApplicationMode;
+
+public class RequestMapThemeParams {
+
+	private ApplicationMode appMode;
+	private boolean ignoreExternalProvider = false;
+
+	@NonNull
+	public RequestMapThemeParams setAppMode(ApplicationMode appMode) {
+		this.appMode = appMode;
+		return this;
+	}
+
+	@NonNull
+	public RequestMapThemeParams markIgnoreExternalProvider() {
+		this.ignoreExternalProvider = true;
+		return this;
+	}
+
+	@NonNull
+	public ApplicationMode requireAppMode(@NonNull ApplicationMode defaultValue) {
+		return appMode != null ? appMode : defaultValue;
+	}
+
+	public boolean shouldIgnoreExternalProvider() {
+		return ignoreExternalProvider;
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
index 486235d25dd..72a6a1dfc99 100644
--- a/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
+++ b/OsmAnd/src/net/osmand/plus/routepreparationmenu/cards/BaseCard.java
@@ -19,6 +19,7 @@
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.helpers.RequestMapThemeParams;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -61,7 +62,8 @@ public BaseCard(@NonNull FragmentActivity activity, boolean usedOnMap) {
 		this.app = (OsmandApplication) activity.getApplicationContext();
 		this.settings = app.getSettings();
 		this.usedOnMap = usedOnMap;
-		nightMode = usedOnMap ? app.getDaynightHelper().isNightModeForMapControls() : !settings.isLightContent();
+		RequestMapThemeParams requestMapThemeParams = new RequestMapThemeParams().markIgnoreExternalProvider();
+		nightMode = app.getDaynightHelper().isNightMode(usedOnMap, requestMapThemeParams);
 	}
 
 	public abstract int getCardLayoutId();
diff --git a/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java b/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
index f02e82fc090..c4b862524a3 100644
--- a/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
+++ b/OsmAnd/src/net/osmand/plus/settings/controllers/RouteLineColorController.java
@@ -216,7 +216,7 @@ public void onPause() {
 
 	private void setMapThemeProvider(@Nullable MapThemeProvider provider) {
 		DayNightHelper helper = app.getDaynightHelper();
-		helper.setMapThemeProvider(provider);
+		helper.setExternalMapThemeProvider(provider);
 	}
 
 	@ColorInt
