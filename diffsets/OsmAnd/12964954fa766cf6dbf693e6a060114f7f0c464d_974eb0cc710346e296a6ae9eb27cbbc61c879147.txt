diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java b/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
index 3e22e3190a6..1a7d1b24ba1 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/ChoosePlanFragment.java
@@ -17,6 +17,7 @@
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
 import androidx.fragment.app.FragmentActivity;
 import androidx.fragment.app.FragmentManager;
 
@@ -249,7 +250,14 @@ private void updateContinueButtons() {
 			FragmentActivity activity = getActivity();
 			if (activity != null) {
 				if (mapsPlusPurchased) {
-					PurchasesFragment.showInstance(activity.getSupportFragmentManager());
+					FragmentManager fragmentManager = activity.getSupportFragmentManager();
+					Fragment purchasesFragment = fragmentManager.findFragmentByTag(PurchasesFragment.TAG);
+					boolean returnToPurchasesFragment = purchasesFragment != null;
+					if (returnToPurchasesFragment) {
+						dismiss();
+					} else {
+						PurchasesFragment.showInstance(fragmentManager);
+					}
 				} else {
 					MapsPlusPlanFragment.showInstance(activity);
 				}
@@ -307,11 +315,11 @@ public static void showDefaultInstance(@NonNull FragmentActivity activity) {
 	}
 
 	public static void showInstance(@NonNull FragmentActivity activity, @NonNull OsmAndFeature selectedFeature) {
-		FragmentManager fm = activity.getSupportFragmentManager();
-		if (!fm.isStateSaved() && fm.findFragmentByTag(TAG) == null) {
+		FragmentManager fragmentManager = activity.getSupportFragmentManager();
+		if (AndroidUtils.isFragmentCanBeAdded(fragmentManager, TAG)) {
 			ChoosePlanFragment fragment = new ChoosePlanFragment();
 			fragment.selectedFeature = selectedFeature;
-			fragment.show(activity.getSupportFragmentManager(), TAG);
+			fragment.show(fragmentManager, TAG);
 		}
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/ExploreOsmAndPlansCard.java b/OsmAnd/src/net/osmand/plus/chooseplan/ExploreOsmAndPlansCard.java
index 718703beca0..e15a05fb2e9 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/ExploreOsmAndPlansCard.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/ExploreOsmAndPlansCard.java
@@ -2,20 +2,24 @@
 
 import android.view.View;
 
-import androidx.annotation.NonNull;
-import androidx.fragment.app.FragmentActivity;
-
 import net.osmand.plus.R;
 import net.osmand.plus.routepreparationmenu.cards.BaseCard;
 import net.osmand.plus.utils.UiUtilities;
 import net.osmand.plus.utils.UiUtilities.DialogButtonType;
 
-import org.jetbrains.annotations.NotNull;
+import androidx.annotation.NonNull;
+import androidx.fragment.app.DialogFragment;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
 
 public class ExploreOsmAndPlansCard extends BaseCard {
 
-	public ExploreOsmAndPlansCard(@NonNull @NotNull FragmentActivity activity) {
+	private final DialogFragment target;
+
+	public ExploreOsmAndPlansCard(@NonNull FragmentActivity activity, @NonNull DialogFragment target) {
 		super(activity, false);
+		this.target = target;
 	}
 
 	@Override
@@ -28,10 +32,14 @@ protected void updateContent() {
 		View btnLearnMore = view.findViewById(R.id.button_learn_more);
 		UiUtilities.setupDialogButton(nightMode, btnLearnMore, DialogButtonType.SECONDARY_ACTIVE, R.string.shared_string_learn_more);
 		btnLearnMore.setOnClickListener(v -> {
-			if (activity != null) {
+			FragmentManager fragmentManager = activity.getSupportFragmentManager();
+			Fragment choosePlanFragment = fragmentManager.findFragmentByTag(ChoosePlanFragment.TAG);
+			boolean returnToChoosePlanFragment = choosePlanFragment != null;
+			if (returnToChoosePlanFragment) {
+				target.dismiss();
+			} else {
 				ChoosePlanFragment.showDefaultInstance(activity);
 			}
 		});
 	}
-
-}
+}
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/chooseplan/NoPurchasesCard.java b/OsmAnd/src/net/osmand/plus/chooseplan/NoPurchasesCard.java
index b36ad6b3372..5e69ad63a1f 100644
--- a/OsmAnd/src/net/osmand/plus/chooseplan/NoPurchasesCard.java
+++ b/OsmAnd/src/net/osmand/plus/chooseplan/NoPurchasesCard.java
@@ -4,6 +4,8 @@
 import android.widget.TextView;
 
 import androidx.annotation.NonNull;
+import androidx.fragment.app.DialogFragment;
+import androidx.fragment.app.Fragment;
 import androidx.fragment.app.FragmentActivity;
 
 import net.osmand.plus.R;
@@ -11,8 +13,11 @@
 
 public class NoPurchasesCard extends BaseCard {
 
-	public NoPurchasesCard(@NonNull FragmentActivity activity) {
+	private final DialogFragment target;
+
+	public NoPurchasesCard(@NonNull FragmentActivity activity, @NonNull DialogFragment target) {
 		super(activity, false);
+		this.target = target;
 	}
 
 	@Override
@@ -29,6 +34,6 @@ protected void updateContent() {
 
 		LinearLayout cardsContainer = view.findViewById(R.id.cards_container);
 		cardsContainer.removeAllViews();
-		cardsContainer.addView(new ExploreOsmAndPlansCard(activity).build(activity));
+		cardsContainer.addView(new ExploreOsmAndPlansCard(activity, target).build(activity));
 	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/PurchasesFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/PurchasesFragment.java
index 0d5bd51bf00..44fa1f78b6b 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/PurchasesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/PurchasesFragment.java
@@ -95,10 +95,10 @@ private void updateCards() {
 		}
 
 		if (!Version.isPaidVersion(app) || Algorithms.isEmpty(mainPurchases)) {
-			cardsContainer.addView(new NoPurchasesCard(activity).build(activity));
+			cardsContainer.addView(new NoPurchasesCard(activity, this).build(activity));
 		} else {
 			themedInflater.inflate(R.layout.list_item_divider, cardsContainer);
-			cardsContainer.addView(new ExploreOsmAndPlansCard(activity).build(activity));
+			cardsContainer.addView(new ExploreOsmAndPlansCard(activity, this).build(activity));
 		}
 		cardsContainer.addView(new TroubleshootingCard(activity, purchaseHelper, false).build(activity));
 	}
