diff --git a/OsmAnd/res/layout/custom_icon_radio_buttons_full_width.xml b/OsmAnd/res/layout/custom_icon_radio_buttons_full_width.xml
new file mode 100644
index 00000000000..1435105e0c2
--- /dev/null
+++ b/OsmAnd/res/layout/custom_icon_radio_buttons_full_width.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	xmlns:tools="http://schemas.android.com/tools"
+	android:id="@+id/custom_radio_buttons"
+	android:layout_width="match_parent"
+	android:layout_height="wrap_content"
+	tools:background="?attr/btn_bg_border_inactive"
+	android:baselineAligned="false"
+	android:minHeight="@dimen/dialog_button_height"
+	android:orientation="horizontal">
+
+	<include
+		layout="@layout/custom_radio_btn_icon_item"
+		android:layout_width="0dp"
+		android:layout_height="match_parent"
+		android:layout_weight="1" />
+
+	<include
+		layout="@layout/custom_radio_btn_icon_item"
+		android:layout_width="0dp"
+		android:layout_height="match_parent"
+		android:layout_weight="1" />
+
+</LinearLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/fragment_map_mode.xml b/OsmAnd/res/layout/fragment_map_mode.xml
new file mode 100644
index 00000000000..6445f037326
--- /dev/null
+++ b/OsmAnd/res/layout/fragment_map_mode.xml
@@ -0,0 +1,71 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+	xmlns:tools="http://schemas.android.com/tools"
+	android:layout_width="match_parent"
+	android:layout_height="match_parent"
+	android:orientation="vertical">
+
+	<LinearLayout
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:paddingHorizontal="@dimen/content_padding"
+		android:layout_marginBottom="@dimen/content_padding"
+		android:orientation="horizontal">
+
+		<net.osmand.plus.widgets.TextViewEx
+			style="@style/TitleStyle.Medium"
+			android:layout_width="0dp"
+			android:layout_height="wrap_content"
+			android:layout_gravity="center_vertical"
+			android:layout_marginEnd="@dimen/content_padding"
+			android:layout_weight="1"
+			android:ellipsize="end"
+			android:textColor="?android:textColorPrimary"
+			android:text="@string/map_mode" />
+
+		<net.osmand.plus.widgets.TextViewEx
+			android:id="@+id/summary"
+			style="@style/TitleStyle"
+			android:layout_width="wrap_content"
+			android:layout_height="wrap_content"
+			android:layout_gravity="center_vertical"
+			android:ellipsize="end"
+			android:textColor="?android:textColorSecondary"
+			tools:text="@string/daynight_mode_auto" />
+
+	</LinearLayout>
+
+	<FrameLayout
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:layout_marginHorizontal="@dimen/content_padding">
+
+		<include layout="@layout/custom_icon_radio_buttons_full_width" />
+
+	</FrameLayout>
+
+	<net.osmand.plus.widgets.TextViewEx
+		android:id="@+id/description"
+		style="@style/TitleStyle"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:layout_marginHorizontal="@dimen/content_padding"
+		android:layout_marginTop="@dimen/content_padding_small"
+		android:textColor="?android:textColorSecondary"
+		tools:text="@string/daynight_mode_sunrise_sunset_summary" />
+
+	<net.osmand.plus.widgets.TextViewEx
+		android:id="@+id/secondary_description"
+		style="@style/TitleStyle"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:layout_marginHorizontal="@dimen/content_padding"
+		android:layout_marginTop="@dimen/context_menu_subtitle_margin"
+		android:textColor="?android:textColorSecondary"
+		tools:text="Sunrise – 05:22, sunset – 20:28" />
+	
+	<View
+		android:layout_width="match_parent"
+		android:layout_height="@dimen/content_padding_small" />
+
+</LinearLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/values/strings.xml b/OsmAnd/res/values/strings.xml
index d9140f711c5..f4e442aaf73 100644
--- a/OsmAnd/res/values/strings.xml
+++ b/OsmAnd/res/values/strings.xml
@@ -11,6 +11,12 @@
 	Thx - Hardy
 -->
 
+    <string name="daynight_mode_app_theme_summary">The map\'s display aligns with the app\'s overall theme—day mode for a light theme and night mode for a dark theme</string>
+    <string name="daynight_mode_sensor_summary">Uses the device\'s light sensor to toggle between light and dark themes according to ambient light levels.</string>
+    <string name="daynight_mode_sunrise_sunset_summary">Automatically switches between day and night themes based on local sunrise and sunset times.</string>
+    <string name="daynight_mode_night_summary">Always displays the map in a dark theme, suited for nighttime or low-light conditions.</string>
+    <string name="daynight_mode_day_summary">Always displays the map in a light theme, ideal for daytime visibility.</string>
+    <string name="daynight_mode_app_theme">App theme</string>
     <string name="missing_maps_ignore">Use existing maps</string>
     <string name="backup_error_failed_to_transfer_file">Failed to transfer cloud file(s).</string>
     <string name="contact_support_retry">Try again or contact support</string>
diff --git a/OsmAnd/src/net/osmand/plus/base/dialog/BaseDialogController.java b/OsmAnd/src/net/osmand/plus/base/dialog/BaseDialogController.java
index 7c72987251e..ef9642fe900 100644
--- a/OsmAnd/src/net/osmand/plus/base/dialog/BaseDialogController.java
+++ b/OsmAnd/src/net/osmand/plus/base/dialog/BaseDialogController.java
@@ -64,11 +64,6 @@ public int getDimension(@DimenRes int id) {
 		return app.getResources().getDimensionPixelSize(id);
 	}
 
-	@NonNull
-	public String getString(@StringRes int stringId) {
-		return app.getString(stringId);
-	}
-
 	@NonNull
 	public String getString(@StringRes int stringId, Object... formatArgs) {
 		return app.getString(stringId, formatArgs);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapDialogs.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapDialogs.java
index 0d309af564c..c457ff7ec51 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapDialogs.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapDialogs.java
@@ -19,7 +19,6 @@
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.backend.preferences.CommonPreference;
 import net.osmand.plus.settings.backend.preferences.OsmandPreference;
-import net.osmand.plus.settings.enums.DayNightMode;
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.UiUtilities;
@@ -42,40 +41,6 @@
 
 public class ConfigureMapDialogs {
 
-	protected static void showMapModeDialog(
-			@NonNull MapActivity activity, boolean nightMode
-	) {
-		OsmandApplication app = activity.getMyApplication();
-		OsmandSettings settings = app.getSettings();
-
-		OsmandMapTileView view = activity.getMapView();
-		int selectedIndex = settings.DAYNIGHT_MODE.get().ordinal();
-		String[] items = new String[DayNightMode.values().length];
-		for (int i = 0; i < items.length; i++) {
-			items[i] = DayNightMode.values()[i].toHumanString(app);
-		}
-
-		AlertDialogData dialogData = new AlertDialogData(activity, nightMode)
-				.setTitle(R.string.daynight)
-				.setControlsColor(ColorUtilities.getAppModeColor(app, nightMode))
-				.setNegativeButton(R.string.shared_string_dismiss, null);
-
-		CustomAlert.showSingleSelection(dialogData, items, selectedIndex, v -> {
-			int which = (int) v.getTag();
-			settings.DAYNIGHT_MODE.set(DayNightMode.values()[which]);
-			if (view.hasMapRenderer()) {
-				MapRendererContext mapRendererContext = NativeCoreContext.getMapRendererContext();
-				if (mapRendererContext != null) {
-					boolean updatedNightMode = app.getDaynightHelper().isNightMode();
-					mapRendererContext.setNightMode(updatedNightMode);
-				}
-			} else {
-				activity.refreshMapComplete();
-			}
-			activity.getDashboard().refreshContent(false);
-		});
-	}
-
 	public static void showMapMagnifierDialog(@NonNull OsmandMapTileView view) {
 		OsmandPreference<Float> density = view.getSettings().MAP_DENSITY;
 		int p = (int) (density.get() * 100);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
index 58fcc02aba6..f1c9780b4ac 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapMenu.java
@@ -552,12 +552,12 @@ private void createRenderingAttributeItems(List<RenderingRuleProperty> customRul
 				}));
 
 		String description = "";
+		DayNightMode dayNightMode = settings.DAYNIGHT_MODE.get();
 		SunriseSunset sunriseSunset = app.getDaynightHelper().getSunriseSunset();
-		if (sunriseSunset != null && sunriseSunset.getSunrise() != null && sunriseSunset.getSunset() != null) {
+		if (!dayNightMode.isAppTheme() && sunriseSunset != null && sunriseSunset.getSunrise() != null && sunriseSunset.getSunset() != null) {
 			DateFormat dateFormat = DateFormat.getTimeInstance(DateFormat.SHORT);
 			String sunriseTime = dateFormat.format(sunriseSunset.getSunrise());
 			String sunsetTime = dateFormat.format(sunriseSunset.getSunset());
-			DayNightMode dayNightMode = settings.DAYNIGHT_MODE.get();
 			if (dayNightMode.isDay() || dayNightMode.isNight()) {
 				if (sunriseSunset.isDaytime()) {
 					description = String.format(app.getString(R.string.sunset_at), sunsetTime);
@@ -577,9 +577,9 @@ private void createRenderingAttributeItems(List<RenderingRuleProperty> customRul
 				.setIcon(ConfigureMapUtils.getDayNightIcon(activity))
 				.setListener((uiAdapter, view, item, isChecked) -> {
 					if (AndroidUtils.isActivityNotDestroyed(activity)) {
-						ConfigureMapDialogs.showMapModeDialog(activity, nightMode);
+						MapModeController.showDialog(activity);
 					}
-					return false;
+					return true;
 				})
 				.setItemDeleteAction(settings.DAYNIGHT_MODE));
 
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapOptionFragment.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapOptionFragment.java
index 2c211801949..dd916037950 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapOptionFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapOptionFragment.java
@@ -73,7 +73,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		applyButton = view.findViewById(R.id.apply_button);
 		applyButton.setOnClickListener(viewOnCLick -> {
 			applyChanges();
-			activity.onBackPressed();
+			dismiss();
 		});
 
 		setupToolBar(view);
@@ -150,12 +150,7 @@ protected void setupToolBar(@NonNull View view) {
 
 		ImageView backButton = appbar.findViewById(R.id.back_button);
 		backButton.setImageDrawable(getContentIcon(R.drawable.ic_action_close));
-		backButton.setOnClickListener(v -> {
-			FragmentActivity activity = getActivity();
-			if (activity != null) {
-				activity.onBackPressed();
-			}
-		});
+		backButton.setOnClickListener(v -> dismiss());
 
 		ImageButton resetButton = appbar.findViewById(R.id.reset_button);
 		resetButton.setImageDrawable(getIcon(R.drawable.ic_action_reset, ColorUtilities.getDefaultIconColorId(nightMode)));
@@ -210,6 +205,13 @@ public void onPause() {
 		updateWidgetsVisibility(activity, View.VISIBLE);
 	}
 
+	protected void dismiss() {
+		FragmentActivity activity = getActivity();
+		if (activity != null) {
+			activity.onBackPressed();
+		}
+	}
+
 	private void updateWidgetsVisibility(@NonNull MapActivity activity, int visibility) {
 		AndroidUiHelper.setVisibility(activity, visibility, R.id.map_left_widgets_panel,
 				R.id.map_right_widgets_panel, R.id.map_center_info);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapUtils.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapUtils.java
index b9255691291..d2c5a0c58c1 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapUtils.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapUtils.java
@@ -136,7 +136,7 @@ protected static String getDayNightDescr(MapActivity activity) {
 
 	@DrawableRes
 	protected static int getDayNightIcon(MapActivity activity) {
-		return activity.getMyApplication().getSettings().DAYNIGHT_MODE.get().getIconRes();
+		return activity.getMyApplication().getSettings().DAYNIGHT_MODE.get().getDefaultIcon();
 	}
 
 	protected static String getScale(MapActivity activity) {
diff --git a/OsmAnd/src/net/osmand/plus/configmap/MapModeController.java b/OsmAnd/src/net/osmand/plus/configmap/MapModeController.java
new file mode 100644
index 00000000000..39c64d28a59
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/configmap/MapModeController.java
@@ -0,0 +1,133 @@
+package net.osmand.plus.configmap;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
+
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.R;
+import net.osmand.plus.base.dialog.BaseDialogController;
+import net.osmand.plus.base.dialog.DialogManager;
+import net.osmand.plus.base.dialog.interfaces.dialog.IDialog;
+import net.osmand.plus.helpers.DayNightHelper;
+import net.osmand.plus.helpers.DayNightHelper.MapThemeProvider;
+import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.backend.preferences.CommonPreference;
+import net.osmand.plus.settings.enums.DayNightMode;
+import net.osmand.util.Algorithms;
+import net.osmand.util.SunriseSunset;
+
+import java.text.DateFormat;
+
+public class MapModeController extends BaseDialogController implements MapThemeProvider {
+
+	public static final String PROCESS_ID = "select_map_mode";
+
+	private final CommonPreference<DayNightMode> preference;
+	private DayNightMode selectedTheme;
+
+	public MapModeController(@NonNull OsmandApplication app) {
+		super(app);
+		OsmandSettings settings = app.getSettings();
+		preference = settings.DAYNIGHT_MODE;
+		selectedTheme = preference.get();
+	}
+
+	public void registerDialog(@NonNull IDialog dialog) {
+		dialogManager.register(PROCESS_ID, dialog);
+	}
+
+	public void finishProcessIfNeeded(@Nullable FragmentActivity activity) {
+		if (activity != null && !activity.isChangingConfigurations()) {
+			dialogManager.unregister(PROCESS_ID);
+		}
+	}
+
+	@NonNull
+	public String getHeaderSummary() {
+		return selectedTheme.toHumanString(app);
+	}
+
+	@NonNull
+	public String getDescription() {
+		return getString(selectedTheme.getSummaryRes());
+	}
+
+	@Nullable
+	public String getSecondaryDescription() {
+		if (selectedTheme == DayNightMode.AUTO) {
+			SunriseSunset sunriseSunset = app.getDaynightHelper().getSunriseSunset();
+			if (sunriseSunset != null && sunriseSunset.getSunrise() != null && sunriseSunset.getSunset() != null) {
+				DateFormat dateFormat = DateFormat.getTimeInstance(DateFormat.SHORT);
+				String sunriseTime = dateFormat.format(sunriseSunset.getSunrise());
+				String sunsetTime = dateFormat.format(sunriseSunset.getSunset());
+				String sunriseTitle = getString(R.string.shared_string_sunrise);
+				String sunsetTitle = getString(R.string.shared_string_sunset);
+				sunriseTime = getString(R.string.ltr_or_rtl_combine_via_dash, sunriseTitle, sunriseTime);
+				sunsetTime = getString(R.string.ltr_or_rtl_combine_via_dash, sunsetTitle, sunsetTime);
+				String description = getString(R.string.ltr_or_rtl_combine_via_comma, sunriseTime, sunsetTime);
+				return Algorithms.capitalizeFirstLetterAndLowercase(description);
+			}
+		}
+		return null;
+	}
+
+	public void onResetToDefault() {
+		selectedTheme = preference.getDefaultValue();
+	}
+
+	public void onApplyChanges() {
+		preference.set(selectedTheme);
+	}
+
+	@NonNull
+	@Override
+	public String getProcessId() {
+		return PROCESS_ID;
+	}
+
+	public void onResume() {
+		setMapThemeProvider(this);
+	}
+
+	public void onPause() {
+		setMapThemeProvider(null);
+	}
+
+	private void setMapThemeProvider(@Nullable MapThemeProvider provider) {
+		DayNightHelper helper = app.getDaynightHelper();
+		helper.setExternalMapThemeProvider(provider);
+	}
+
+	public boolean askSelectMapTheme(@NonNull DayNightMode theme) {
+		if (theme != selectedTheme) {
+			selectedTheme = theme;
+			return true;
+		}
+		return false;
+	}
+
+	@Override
+	@NonNull
+	public DayNightMode getMapTheme() {
+		return selectedTheme;
+	}
+
+	@Nullable
+	public static MapModeController getExistedInstance(@NonNull OsmandApplication app) {
+		DialogManager dialogManager = app.getDialogManager();
+		return (MapModeController) dialogManager.findController(PROCESS_ID);
+	}
+
+	public static void showDialog(@NonNull FragmentActivity activity) {
+		OsmandApplication app = (OsmandApplication) activity.getApplicationContext();
+		MapModeController controller = new MapModeController(app);
+
+		DialogManager dialogManager = app.getDialogManager();
+		dialogManager.register(PROCESS_ID, controller);
+
+		FragmentManager manager = activity.getSupportFragmentManager();
+		MapModeFragment.showInstance(manager);
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/configmap/MapModeFragment.java b/OsmAnd/src/net/osmand/plus/configmap/MapModeFragment.java
new file mode 100644
index 00000000000..71f540bff1a
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/configmap/MapModeFragment.java
@@ -0,0 +1,173 @@
+package net.osmand.plus.configmap;
+
+import static net.osmand.plus.dashboard.DashboardOnMap.DashboardType.CONFIGURE_MAP;
+
+import android.os.Bundle;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.LinearLayout;
+import android.widget.TextView;
+
+import androidx.activity.OnBackPressedCallback;
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.FragmentManager;
+
+import net.osmand.plus.R;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.base.dialog.interfaces.dialog.IDialog;
+import net.osmand.plus.helpers.AndroidUiHelper;
+import net.osmand.plus.settings.enums.DayNightMode;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.plus.widgets.multistatetoggle.IconToggleButton;
+import net.osmand.plus.widgets.multistatetoggle.IconToggleButton.IconRadioItem;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public class MapModeFragment extends ConfigureMapOptionFragment implements IDialog {
+
+	private MapModeController controller;
+	private IconToggleButton toggleButton;
+
+	@Override
+	public void onCreate(@Nullable Bundle savedInstanceState) {
+		super.onCreate(savedInstanceState);
+		controller = MapModeController.getExistedInstance(app);
+		if (controller != null) {
+			controller.registerDialog(this);
+		} else {
+			dismiss();
+		}
+		MapActivity activity = requireMapActivity();
+		activity.getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {
+			@Override
+			public void handleOnBackPressed() {
+				activity.getSupportFragmentManager().popBackStack();
+				activity.getDashboard().setDashboardVisibility(true, CONFIGURE_MAP, false);
+			}
+		});
+	}
+
+	@Nullable
+	@Override
+	protected String getToolbarTitle() {
+		return getString(R.string.map_mode);
+	}
+
+	@Override
+	protected void setupMainContent(@NonNull ViewGroup container) {
+		View view = inflate(R.layout.fragment_map_mode, container);
+		setupToggleButton(view);
+		updateContent(view);
+		container.addView(view);
+	}
+
+	private void setupToggleButton(@NonNull View view) {
+		List<IconRadioItem> items = new ArrayList<>();
+		for (DayNightMode mode : DayNightMode.values()) {
+			items.add(createRadioItem(mode));
+		}
+		LinearLayout container = view.findViewById(R.id.custom_radio_buttons);
+		toggleButton = new IconToggleButton(app, container, nightMode);
+		toggleButton.setItems(items);
+		toggleButton.setSelectedItemByTag(controller.getMapTheme());
+	}
+
+	@NonNull
+	private IconRadioItem createRadioItem(@NonNull DayNightMode mode) {
+		IconRadioItem radioItem = new IconRadioItem(mode.getDefaultIcon());
+		radioItem.setSelectedIconId(mode.getSelectedIcon())
+				.setTag(mode)
+				.setOnClickListener((item, v) -> {
+					if (controller.askSelectMapTheme((DayNightMode) item.requireTag())) {
+						updateAfterThemeSelected();
+					}
+					return false;
+				});
+		return radioItem;
+	}
+
+	private void updateAfterThemeSelected() {
+		toggleButton.setSelectedItemByTag(controller.getMapTheme());
+		askUpdateContent();
+		updateApplyButton(true);
+		refreshMap();
+	}
+
+	private void askUpdateContent() {
+		View view = getView();
+		if (view != null) {
+			updateContent(view);
+		}
+	}
+
+	private void updateContent(@NonNull View view) {
+		updateHeaderSummary(view);
+		updateDescription(view);
+	}
+
+	private void updateHeaderSummary(@NonNull View view) {
+		TextView tvSummary = view.findViewById(R.id.summary);
+		tvSummary.setText(controller.getHeaderSummary());
+	}
+
+	private void updateDescription(@NonNull View view) {
+		TextView tvDescription = view.findViewById(R.id.description);
+		tvDescription.setText(controller.getDescription());
+
+		TextView tvSecondaryDescription = view.findViewById(R.id.secondary_description);
+		String secondaryDescription = controller.getSecondaryDescription();
+		boolean hasSecondaryDescription = secondaryDescription != null;
+		if (hasSecondaryDescription) {
+			tvSecondaryDescription.setText(secondaryDescription);
+		}
+		AndroidUiHelper.updateVisibility(tvSecondaryDescription, hasSecondaryDescription);
+	}
+
+	@Override
+	protected void resetToDefault() {
+		controller.onResetToDefault();
+		updateAfterThemeSelected();
+	}
+
+	@Override
+	protected void applyChanges() {
+		controller.onApplyChanges();
+	}
+
+	@Override
+	protected void refreshMap() {
+		MapActivity mapActivity = getMapActivity();
+		if (mapActivity != null) {
+			mapActivity.refreshMapComplete();
+		}
+	}
+
+	@Override
+	public void onResume() {
+		super.onResume();
+		controller.onResume();
+	}
+
+	@Override
+	public void onPause() {
+		super.onPause();
+		controller.onPause();
+	}
+
+	@Override
+	public void onDestroy() {
+		super.onDestroy();
+		controller.finishProcessIfNeeded(getActivity());
+	}
+
+	public static void showInstance(@NonNull FragmentManager manager) {
+		if (AndroidUtils.isFragmentCanBeAdded(manager, TAG)) {
+			manager.beginTransaction()
+					.replace(R.id.fragmentContainer, new MapModeFragment(), TAG)
+					.addToBackStack(null)
+					.commitAllowingStateLoss();
+		}
+	}
+}
diff --git a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
index 4738167da8f..6af51c3ea11 100644
--- a/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
+++ b/OsmAnd/src/net/osmand/plus/dashboard/DashboardOnMap.java
@@ -35,6 +35,8 @@
 import android.view.View;
 import android.view.View.OnClickListener;
 import android.view.ViewAnimationUtils;
+import android.view.ViewGroup;
+import android.view.ViewGroup.MarginLayoutParams;
 import android.view.ViewTreeObserver;
 import android.view.inputmethod.InputMethodManager;
 import android.widget.AbsListView;
@@ -1204,13 +1206,13 @@ private void updateTopButton(int scrollY) {
 			double scale = mapActivity.getResources().getDisplayMetrics().density;
 			int originalPosition = mFlexibleSpaceImageHeight - (int) (64 * scale);
 			int minTop = mFlexibleBlurSpaceHeight + (int) (5 * scale);
-			FrameLayout.LayoutParams lp = (FrameLayout.LayoutParams) compassButton.getLayoutParams();
+			MarginLayoutParams lp = (MarginLayoutParams) compassButton.getLayoutParams();
 			if (minTop > originalPosition - scrollY) {
 				hideActionButton();
 			} else {
 				compassButton.setVisibility(View.VISIBLE);
 				lp.topMargin = originalPosition - scrollY;
-				((FrameLayout) compassButton.getParent()).updateViewLayout(compassButton, lp);
+				((ViewGroup) compassButton.getParent()).updateViewLayout(compassButton, lp);
 			}
 		}
 	}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
index ac27e52d7bc..6e49e1e0544 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/DayNightHelper.java
@@ -180,6 +180,8 @@ private boolean isNightModeForProfile(@NonNull RequestMapThemeParams params) {
 			return lastNightMode;
 		} else if (dayNightMode.isSensor()) {
 			return lastNightMode;
+		} else if (dayNightMode.isAppTheme()) {
+			return !settings.isLightContentForMode(mode);
 		}
 		return false;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
index 2021c11bdef..e2918eee424 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentController.java
@@ -118,9 +118,11 @@ public void registerDialog(@NonNull IDialog dialog) {
 		dialogManager.register(PROCESS_ID, dialog);
 	}
 
-	public void askUnregisterFromDialogManager() {
-		dialogManager.unregister(PROCESS_ID);
-		dialogManager.unregister(AddQuickActionController.PROCESS_ID);
+	public void finishProcessIfNeeded(@Nullable FragmentActivity activity) {
+		if (activity != null && !activity.isChangingConfigurations()) {
+			dialogManager.unregister(PROCESS_ID);
+			dialogManager.unregister(AddQuickActionController.PROCESS_ID);
+		}
 	}
 
 	public void showOverflowMenu(@NonNull FragmentActivity activity, @Nullable View actionView) {
diff --git a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentFragment.java b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentFragment.java
index fac0274561f..a030c046400 100644
--- a/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentFragment.java
+++ b/OsmAnd/src/net/osmand/plus/keyevent/fragments/editassignment/EditKeyAssignmentFragment.java
@@ -190,10 +190,7 @@ public void onPause() {
 	@Override
 	public void onDestroy() {
 		super.onDestroy();
-		FragmentActivity activity = getActivity();
-		if (activity != null && !activity.isChangingConfigurations()) {
-			controller.askUnregisterFromDialogManager();
-		}
+		controller.finishProcessIfNeeded(getActivity());
 	}
 
 	private void dismiss() {
diff --git a/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java b/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
index c6d40a51a2f..9f2ad060ee9 100644
--- a/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
+++ b/OsmAnd/src/net/osmand/plus/measurementtool/MeasurementToolFragment.java
@@ -360,7 +360,7 @@ public void refresh() {
 			topMapControls = mapActivity.findViewById(R.id.top_controls_container);
 
 			infoTypeBtn = new IconToggleButton(app, infoButtonsContainer, nightMode);
-			pointsBtn = new IconRadioItem(R.drawable.ic_action_plan_route_point_colored, true);
+			pointsBtn = new IconRadioItem(R.drawable.ic_action_plan_route_point_colored).setUseDefaultColor();
 			graphBtn = new IconRadioItem(R.drawable.ic_action_analyze_intervals);
 
 			ScrollUtils.addOnGlobalLayoutListener(mainView, this::updateInfoViewAppearance);
diff --git a/OsmAnd/src/net/osmand/plus/settings/enums/DayNightMode.java b/OsmAnd/src/net/osmand/plus/settings/enums/DayNightMode.java
index d414d67c096..fb3fe16b272 100644
--- a/OsmAnd/src/net/osmand/plus/settings/enums/DayNightMode.java
+++ b/OsmAnd/src/net/osmand/plus/settings/enums/DayNightMode.java
@@ -10,27 +10,48 @@
 import net.osmand.plus.R;
 
 public enum DayNightMode {
-	AUTO(R.string.daynight_mode_auto, R.drawable.ic_action_map_sunset),
-	DAY(R.string.daynight_mode_day, R.drawable.ic_action_map_day),
-	NIGHT(R.string.daynight_mode_night, R.drawable.ic_action_map_night),
-	SENSOR(R.string.daynight_mode_sensor, R.drawable.ic_action_map_light_sensor);
+	DAY(R.string.daynight_mode_day, R.string.daynight_mode_day_summary,
+			R.drawable.ic_action_map_day, R.drawable.ic_action_map_day_filled),
+	NIGHT(R.string.daynight_mode_night, R.string.daynight_mode_night_summary,
+			R.drawable.ic_action_map_night, R.drawable.ic_action_map_night_filled),
+	AUTO(R.string.daynight_mode_auto, R.string.daynight_mode_sunrise_sunset_summary,
+			R.drawable.ic_action_map_sunset, R.drawable.ic_action_map_sunset_filled),
+	SENSOR(R.string.daynight_mode_sensor, R.string.daynight_mode_sensor_summary,
+			R.drawable.ic_action_map_light_sensor, R.drawable.ic_action_map_light_sensor_filled),
+	APP_THEME(R.string.daynight_mode_app_theme, R.string.daynight_mode_app_theme_summary,
+			R.drawable.ic_action_map_mode_app_theme, R.drawable.ic_action_map_mode_app_theme_filled);
 
 	private final int key;
 	@DrawableRes
-	private final int drawableRes;
+	private final int defaultIcon;
+	private final int selectedIcon;
+	private final int summaryRes;
 
-	DayNightMode(@StringRes int key, @DrawableRes int drawableRes) {
+	DayNightMode(@StringRes int key, @StringRes int summaryRes,
+	             @DrawableRes int defaultIcon, @DrawableRes int selectedIcon) {
 		this.key = key;
-		this.drawableRes = drawableRes;
+		this.summaryRes = summaryRes;
+		this.defaultIcon = defaultIcon;
+		this.selectedIcon = selectedIcon;
 	}
 
 	public String toHumanString(Context ctx) {
 		return ctx.getString(key);
 	}
 
+	@StringRes
+	public int getSummaryRes() {
+		return summaryRes;
+	}
+
 	@DrawableRes
-	public int getIconRes() {
-		return drawableRes;
+	public int getDefaultIcon() {
+		return defaultIcon;
+	}
+
+	@DrawableRes
+	public int getSelectedIcon() {
+		return selectedIcon;
 	}
 
 	public boolean isSensor() {
@@ -49,6 +70,10 @@ public boolean isNight() {
 		return this == NIGHT;
 	}
 
+	public boolean isAppTheme() {
+		return this == APP_THEME;
+	}
+
 	public static DayNightMode[] possibleValues(Context context) {
 		SensorManager mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);
 		Sensor mLight = mSensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);
@@ -56,7 +81,7 @@ public static DayNightMode[] possibleValues(Context context) {
 		if (isLightSensorEnabled) {
 			return values();
 		} else {
-			return new DayNightMode[]{AUTO, DAY, NIGHT};
+			return new DayNightMode[]{DAY, NIGHT, AUTO, APP_THEME};
 		}
 	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/IconToggleButton.java b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/IconToggleButton.java
index 934a6d94670..811c480b9cb 100644
--- a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/IconToggleButton.java
+++ b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/IconToggleButton.java
@@ -7,6 +7,7 @@
 import android.widget.LinearLayout;
 
 import androidx.annotation.ColorInt;
+import androidx.annotation.DrawableRes;
 import androidx.annotation.NonNull;
 
 import net.osmand.plus.OsmandApplication;
@@ -31,17 +32,16 @@ protected void initItemView(@NonNull ViewGroup view,
 	                            @NonNull IconRadioItem item) {
 		if (item.isUseDefaultColor()) {
 			ImageView ivIcon = view.findViewById(R.id.icon);
-			ivIcon.setImageDrawable(uiUtilities.getIcon(item.getIconId()));
+			ivIcon.setImageDrawable(uiUtilities.getIcon(item.getIconId(false)));
 		}
 	}
 
 	@Override
-	protected void updateItemView(@NonNull ViewGroup view,
-	                              @NonNull IconRadioItem item,
-	                              @ColorInt int color) {
+	protected void updateItemView(@NonNull ViewGroup view, @NonNull IconRadioItem item,
+								  boolean selected, @ColorInt int color) {
 		if (!item.isUseDefaultColor()) {
 			ImageView ivIcon = view.findViewById(R.id.icon);
-			Drawable icon = uiUtilities.getPaintedIcon(item.getIconId(), color);
+			Drawable icon = uiUtilities.getPaintedIcon(item.getIconId(selected), color);
 			ivIcon.setImageDrawable(icon);
 		}
 	}
@@ -53,20 +53,31 @@ protected View getBorderBackgroundView(@NonNull ViewGroup button) {
 
 	public static class IconRadioItem extends RadioItem {
 
+		static final int INVALID_ID = -1;
+
 		private final int iconId;
-		private final boolean useDefaultColor;
+		private int selectedIconId = INVALID_ID;
+		private boolean useDefaultColor;
 
 		public IconRadioItem(int iconId) {
-			this(iconId, false);
+			this.iconId = iconId;
 		}
 
-		public IconRadioItem(int iconId, boolean useDefaultColor) {
-			this.iconId = iconId;
-			this.useDefaultColor = useDefaultColor;
+		@NonNull
+		public IconRadioItem setSelectedIconId(@DrawableRes int selectedIconId) {
+			this.selectedIconId = selectedIconId;
+			return this;
+		}
+
+		@NonNull
+		public IconRadioItem setUseDefaultColor() {
+			this.useDefaultColor = true;
+			return this;
 		}
 
-		public int getIconId() {
-			return iconId;
+		@DrawableRes
+		public int getIconId(boolean selected) {
+			return selected && selectedIconId != INVALID_ID ? selectedIconId : iconId;
 		}
 
 		public boolean isUseDefaultColor() {
diff --git a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/MultiStateToggleButton.java b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/MultiStateToggleButton.java
index 928a8a973cf..0bf37d6ec6d 100644
--- a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/MultiStateToggleButton.java
+++ b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/MultiStateToggleButton.java
@@ -166,13 +166,13 @@ public void updateView() {
 				background.setColor(ColorUtilities.getColorWithAlpha(selectedBgColor, BACKGROUND_ALPHA));
 				background.setStroke(AndroidUtils.dpToPx(app, 1.5f), ColorUtilities.getColorWithAlpha(selectedBgColor, BACKGROUND_STROKE_ALPHA));
 				borderBackgroundView.setBackground(background);
-				updateItemView(button, item, textColor);
+				updateItemView(button, item, true, textColor);
 			} else {
 				LayerDrawable layerDrawable = new LayerDrawable(new GradientDrawable[]{background});
 				setupLayerInset(i, selectedItemIndex, radius, layerDrawable);
 				background.setStroke(AndroidUtils.dpToPx(app, 1.5f), ColorUtilities.getStrokedButtonsOutlineColor(app, nightMode));
 				borderBackgroundView.setBackground(layerDrawable);
-				updateItemView(button, item, itemColor);
+				updateItemView(button, item, false, itemColor);
 			}
 			Drawable selectedDrawable = UiUtilities.getColoredSelectableDrawable(app, selectedBgColor, BACKGROUND_ALPHA);
 			borderBackgroundView.setForeground(selectedDrawable);
@@ -199,7 +199,7 @@ protected View getBorderBackgroundView(@NonNull ViewGroup button){
 	protected abstract void initItemView(@NonNull ViewGroup view, @NonNull _Radio item);
 
 	protected abstract void updateItemView(@NonNull ViewGroup view, @NonNull _Radio item,
-	                                       @ColorInt int color);
+	                                       boolean selected, @ColorInt int color);
 
 	private boolean isLastItem(int index) {
 		return index == items.size() - 1;
diff --git a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/RadioItem.java b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/RadioItem.java
index 535757569e0..f7c8165315c 100644
--- a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/RadioItem.java
+++ b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/RadioItem.java
@@ -3,6 +3,7 @@
 import android.view.View;
 
 import androidx.annotation.ColorInt;
+import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
 public class RadioItem {
@@ -21,8 +22,10 @@ public void setEnabled(boolean enabled) {
 		this.enabled = enabled;
 	}
 
-	public void setOnClickListener(OnRadioItemClickListener listener) {
+	@NonNull
+	public RadioItem setOnClickListener(OnRadioItemClickListener listener) {
 		this.listener = listener;
+		return this;
 	}
 
 	@Nullable
@@ -30,8 +33,15 @@ public Object getTag() {
 		return tag;
 	}
 
-	public void setTag(@Nullable Object tag) {
+	@NonNull
+	public Object requireTag() {
+		return tag;
+	}
+
+	@NonNull
+	public RadioItem setTag(@Nullable Object tag) {
 		this.tag = tag;
+		return this;
 	}
 
 	public OnRadioItemClickListener getListener() {
@@ -44,8 +54,10 @@ public Integer getCustomColor() {
 		return customColor;
 	}
 
-	public void setCustomColor(@ColorInt @Nullable Integer customColor) {
+	@NonNull
+	public RadioItem setCustomColor(@ColorInt @Nullable Integer customColor) {
 		this.customColor = customColor;
+		return this;
 	}
 
 	public interface OnRadioItemClickListener {
diff --git a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/TextToggleButton.java b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/TextToggleButton.java
index 3da8fc1c1b3..6c3af3bc51d 100644
--- a/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/TextToggleButton.java
+++ b/OsmAnd/src/net/osmand/plus/widgets/multistatetoggle/TextToggleButton.java
@@ -80,9 +80,8 @@ private void updateHeight(@NonNull View view, int height) {
 	}
 
 	@Override
-	protected void updateItemView(@NonNull ViewGroup view,
-	                              @NonNull TextRadioItem item,
-	                              @ColorInt int color) {
+	protected void updateItemView(@NonNull ViewGroup view, @NonNull TextRadioItem item,
+								  boolean selected, @ColorInt int color) {
 		TextView tvTitle = view.findViewById(R.id.title);
 		tvTitle.setTextColor(color);
 	}
