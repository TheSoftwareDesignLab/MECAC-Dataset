diff --git a/OsmAnd/build-common.gradle b/OsmAnd/build-common.gradle
index 22ec894cfa3..0ce3bdba898 100644
--- a/OsmAnd/build-common.gradle
+++ b/OsmAnd/build-common.gradle
@@ -376,8 +376,7 @@ dependencies {
 	implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
 	implementation "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"
 	implementation("androidx.sqlite:sqlite-framework:2.3.1")
-	implementation "androidx.activity:activity:1.9.0"
-	implementation "androidx.core:core:1.16.0"
+
 	implementation 'androidx.multidex:multidex:2.0.1'
 	implementation 'androidx.gridlayout:gridlayout:1.0.0'
 	implementation 'androidx.cardview:cardview:1.0.0'
@@ -386,6 +385,8 @@ dependencies {
 	implementation 'androidx.browser:browser:1.0.0'
 	implementation 'androidx.preference:preference:1.1.0'
 	implementation 'androidx.lifecycle:lifecycle-process:2.6.0'
+	implementation "androidx.activity:activity:1.10.1"
+//	implementation "androidx.core:core:1.16.0"
 	implementation fileTree(include: ['gnu-trove-osmand.jar', 'icu4j-49_1_patched.jar'], dir: 'libs')
 
 	implementation group: 'commons-logging', name: 'commons-logging', version: '1.2'
diff --git a/OsmAnd/res/layout/logcat_activity.xml b/OsmAnd/res/layout/logcat_activity.xml
index d83ba8beccb..633ed1b60bd 100644
--- a/OsmAnd/res/layout/logcat_activity.xml
+++ b/OsmAnd/res/layout/logcat_activity.xml
@@ -5,13 +5,6 @@
 	android:layout_height="match_parent"
 	android:orientation="vertical">
 
-	<androidx.recyclerview.widget.RecyclerView
-		android:id="@+id/recycler_view"
-		android:layout_width="match_parent"
-		android:layout_height="wrap_content"
-		android:background="?attr/bg_color"
-		android:clipToPadding="false"
-		android:orientation="vertical"
-		android:scrollbars="vertical" />
+	<include layout="@layout/recyclerview" />
 
 </LinearLayout>
\ No newline at end of file
diff --git a/OsmAnd/res/layout/navigation_bar_scrim.xml b/OsmAnd/res/layout/navigation_bar_scrim.xml
new file mode 100644
index 00000000000..823e768ee11
--- /dev/null
+++ b/OsmAnd/res/layout/navigation_bar_scrim.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="utf-8"?>
+<View xmlns:android="http://schemas.android.com/apk/res/android"
+	android:id="@+id/navigation_bar_scrim"
+	android:layout_width="match_parent"
+	android:layout_height="0dp"
+	android:layout_gravity="bottom" />
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index 6b1a6aec694..9eb5e3e083b 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -6,6 +6,7 @@
 import static net.osmand.plus.firstusage.FirstUsageWizardFragment.FIRST_USAGE;
 import static net.osmand.plus.measurementtool.MeasurementToolFragment.PLAN_ROUTE_MODE;
 import static net.osmand.plus.search.ShowQuickSearchMode.CURRENT;
+import static net.osmand.plus.settings.enums.ThemeUsageContext.OVER_MAP;
 import static net.osmand.plus.views.AnimateDraggingMapThread.TARGET_NO_ROTATION;
 
 import android.Manifest;
@@ -480,7 +481,7 @@ public void setupRouteCalculationProgressBar(@NonNull ProgressBar pb) {
 	public void setupProgressBar(@NonNull ProgressBar pb, boolean indeterminate) {
 		DayNightHelper dayNightHelper = getMyApplication().getDaynightHelper();
 
-		boolean nightMode = dayNightHelper.isNightMode(ThemeUsageContext.OVER_MAP);
+		boolean nightMode = dayNightHelper.isNightMode(OVER_MAP);
 		boolean useRouteLineColor = nightMode == dayNightHelper.isNightMode(ThemeUsageContext.MAP);
 
 		int bgColorId = nightMode ? R.color.map_progress_bar_bg_dark : R.color.map_progress_bar_bg_light;
@@ -807,6 +808,12 @@ public void updateStatusBarColor() {
 		UiUtilities.updateStatusBarColor(this);
 	}
 
+	@Override
+	protected int getNavigationBarColorId() {
+		boolean nightMode = app.getDaynightHelper().isNightMode(OVER_MAP);
+		return ColorUtilities.getNavBarBackgroundColorId(nightMode);
+	}
+
 	public boolean isInAppPurchaseAllowed() {
 		return true;
 	}
@@ -1149,11 +1156,6 @@ public void updateApplicationModeSettings(boolean forceUpdatePoiFilters) {
 		dashboardOnMap.onAppModeChanged();
 	}
 
-	public void updateNavigationBarColor() {
-		boolean nightMode = app.getDaynightHelper().isNightMode(ThemeUsageContext.OVER_MAP);
-		getWindow().setNavigationBarColor(ColorUtilities.getNavBarBackgroundColor(app, nightMode));
-	}
-
 	public void updateMapSettings(boolean updateMapRenderer) {
 		getMapView().updateMapSettings(updateMapRenderer, changed -> {
 			if (changed) {
diff --git a/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java b/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
index a2b779132bb..f3688865bc6 100644
--- a/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/OsmandActionBarActivity.java
@@ -1,11 +1,15 @@
 package net.osmand.plus.activities;
 
 import static net.osmand.plus.settings.enums.ThemeUsageContext.APP;
+import static net.osmand.plus.utils.InsetsUtils.InsetSide.BOTTOM;
+import static net.osmand.plus.utils.InsetsUtils.InsetSide.TOP;
 
 import android.annotation.SuppressLint;
 import android.content.Intent;
+import android.os.Bundle;
 import android.view.View;
 
+import androidx.activity.EdgeToEdge;
 import androidx.annotation.ColorRes;
 import androidx.appcompat.app.ActionBar;
 
@@ -15,7 +19,6 @@
 import net.osmand.plus.utils.AndroidUtils;
 import net.osmand.plus.utils.ColorUtilities;
 import net.osmand.plus.utils.InsetsUtils;
-import net.osmand.plus.utils.InsetsUtils.InsetSide;
 
 import java.util.ArrayList;
 import java.util.EnumSet;
@@ -24,7 +27,6 @@
 @SuppressLint("Registered")
 public class OsmandActionBarActivity extends OsmandInAppPurchaseActivity {
 
-	protected boolean haveHomeButton = true;
 	private final List<ActivityResultListener> resultListeners = new ArrayList<>();
 
 	@ColorRes
@@ -34,6 +36,19 @@ protected int getStatusBarColorId() {
 		return ColorUtilities.getStatusBarColorId(nightMode);
 	}
 
+	@ColorRes
+	protected int getNavigationBarColorId() {
+		return -1;
+	}
+
+	@Override
+	protected void onCreate(Bundle savedInstanceState) {
+		if (InsetsUtils.isEdgeToEdgeSupported()) {
+			EdgeToEdge.enable(this);
+		}
+		super.onCreate(savedInstanceState);
+	}
+
 	@Override
 	protected void onActivityResult(int requestCode, int resultCode, Intent data) {
 		for (ActivityResultListener listener : resultListeners) {
@@ -59,25 +74,16 @@ public void removeActivityResultListener(ActivityResultListener listener) {
 	public void onContentChanged() {
 		super.onContentChanged();
 
-		if (haveHomeButton) {
-			setupHomeButton();
-		}
+		setupHomeButton();
+		updateStatusBarColor();
 
 		View root = findViewById(R.id.root);
 		if (root != null) {
-			InsetsUtils.setWindowInsetsListener(root, EnumSet.of(
-					InsetSide.TOP,
-					InsetSide.BOTTOM
-			));
+			InsetsUtils.setWindowInsetsListener(root, EnumSet.of(TOP, BOTTOM));
 		}
-		updateStatusBarColor();
 	}
 
-	public void updateStatusBarColor() {
-		AndroidUiHelper.setStatusBarColor(this, getColor(getStatusBarColorId()));
-	}
-
-	private void setupHomeButton() {
+	protected void setupHomeButton() {
 		ActionBar actionBar = getSupportActionBar();
 		if (actionBar != null) {
 			OsmandApplication app = getMyApplication();
@@ -90,4 +96,18 @@ private void setupHomeButton() {
 			actionBar.setHomeAsUpIndicator(app.getUIUtilities().getIcon(iconId, colorId));
 		}
 	}
+
+	public void updateStatusBarColor() {
+		int colorId = getStatusBarColorId();
+		if (colorId != -1) {
+			AndroidUiHelper.setStatusBarColor(this, getColor(colorId));
+		}
+	}
+
+	public void updateNavigationBarColor() {
+		int colorId = getNavigationBarColorId();
+		if (colorId != -1) {
+			AndroidUiHelper.setNavigationBarColor(this, getColor(colorId));
+		}
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/activities/OsmandInAppPurchaseActivity.java b/OsmAnd/src/net/osmand/plus/activities/OsmandInAppPurchaseActivity.java
index 0ca727d516e..7fb37315c1d 100644
--- a/OsmAnd/src/net/osmand/plus/activities/OsmandInAppPurchaseActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/OsmandInAppPurchaseActivity.java
@@ -5,11 +5,8 @@
 import android.app.Activity;
 import android.content.Intent;
 import android.net.Uri;
-import android.os.Build;
-import android.os.Bundle;
 import android.view.View;
 
-import androidx.activity.EdgeToEdge;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.appcompat.app.AppCompatActivity;
@@ -26,7 +23,6 @@
 import net.osmand.plus.inapp.InAppPurchases.InAppPurchase;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.InsetsUtils;
 import net.osmand.plus.utils.TalkbackUtils;
 import net.osmand.plus.utils.TalkbackUtils.TalkbackHandler;
 
@@ -51,14 +47,6 @@ protected void onResume() {
 		getSupportFragmentManager().registerFragmentLifecycleCallbacks(lifecycleCallbacks, false);
 	}
 
-	@Override
-	protected void onCreate(Bundle savedInstanceState){
-		if (InsetsUtils.isEdgeToEdgeSupported()) {
-			EdgeToEdge.enable(this);
-		}
-		super.onCreate(savedInstanceState);
-	}
-
 	@Override
 	protected void onPause() {
 		super.onPause();
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
index 649444c90dd..6fd683767b1 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndDialogFragment.java
@@ -29,6 +29,7 @@
 import java.util.ArrayList;
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class BaseOsmAndDialogFragment extends DialogFragment implements IOsmAndFragment, ISupportInsets {
 
@@ -62,15 +63,14 @@ protected void updateNightMode() {
 	@Override
 	public void onStart() {
 		super.onStart();
-		Dialog dialog = getDialog();
 
+		Dialog dialog = getDialog();
 		if (dialog != null && dialog.getWindow() != null && Build.VERSION.SDK_INT > 29) {
 			if (Build.VERSION.SDK_INT >= 36) {
 				//WindowCompat.enableEdgeToEdge(window);
 			} else {
 				WindowCompat.setDecorFitsSystemWindows(dialog.getWindow(), false);
 			}
-
 		}
 	}
 
@@ -82,7 +82,7 @@ public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceStat
 
 	@Nullable
 	@Override
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return EnumSet.of(InsetSide.TOP);
 	}
 
@@ -107,7 +107,7 @@ public List<Integer> getBottomContainersIds() {
 		return null;
 	}
 
-	public void onApplyInsets(@NonNull WindowInsetsCompat insets){
+	public void onApplyInsets(@NonNull WindowInsetsCompat insets) {
 
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
index 9aee93b19fb..ff6cc049dc0 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndFragment.java
@@ -1,6 +1,5 @@
 package net.osmand.plus.base;
 
-import android.app.Activity;
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
@@ -24,6 +23,7 @@
 import java.util.ArrayList;
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 /**
  * Base fragment class for all UI components in OsmAnd that directly extend Android's Fragment.
@@ -81,7 +81,7 @@ public List<Integer> getFabIds() {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides(){
 		return EnumSet.of(InsetSide.TOP);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndListFragment.java b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndListFragment.java
index caa60c6b74e..dd04d5fb14e 100644
--- a/OsmAnd/src/net/osmand/plus/base/BaseOsmAndListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/BaseOsmAndListFragment.java
@@ -22,8 +22,8 @@
 import net.osmand.plus.utils.UiUtilities;
 
 import java.util.ArrayList;
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 /**
  * Base fragment class for list-based screens in the OsmAnd application
@@ -67,7 +67,7 @@ public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceStat
 
 	@Nullable
 	@Override
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
index 3aca51f94e5..e525b9f5b55 100644
--- a/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/ContextMenuFragment.java
@@ -50,6 +50,7 @@
 import java.util.ArrayList;
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public abstract class ContextMenuFragment extends BaseFullScreenFragment implements MapControlsThemeProvider {
 
@@ -473,7 +474,7 @@ public List<Integer> getScrollableViewIds() {
 
 	@Nullable
 	@Override
-	public EnumSet<InsetSide> getRootInsetSides() {
+	public Set<InsetSide> getRootInsetSides() {
 		return EnumSet.of(InsetSide.TOP, InsetSide.BOTTOM);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/base/ISupportInsets.java b/OsmAnd/src/net/osmand/plus/base/ISupportInsets.java
index 888a8869f27..405446a9f8a 100644
--- a/OsmAnd/src/net/osmand/plus/base/ISupportInsets.java
+++ b/OsmAnd/src/net/osmand/plus/base/ISupportInsets.java
@@ -8,13 +8,13 @@
 
 import net.osmand.plus.utils.InsetsUtils.InsetSide;
 
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public interface ISupportInsets {
 
 	@Nullable
-	EnumSet<InsetSide> getRootInsetSides();
+	Set<InsetSide> getRootInsetSides();
 
 	@Nullable
 	List<Integer> getFabIds();
diff --git a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
index 3d72e5a7744..c8493709e46 100644
--- a/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/base/MenuBottomSheetDialogFragment.java
@@ -42,6 +42,7 @@
 import java.util.ArrayList;
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public abstract class MenuBottomSheetDialogFragment extends BottomSheetDialogFragment {
 
@@ -194,7 +195,7 @@ public void onGlobalLayout() {
 		});
 	}
 
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides(){
 		return EnumSet.of(InsetSide.BOTTOM);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/card/color/palette/main/ColorsPaletteFragment.java b/OsmAnd/src/net/osmand/plus/card/color/palette/main/ColorsPaletteFragment.java
index 37fcecbef22..912764f1cf7 100644
--- a/OsmAnd/src/net/osmand/plus/card/color/palette/main/ColorsPaletteFragment.java
+++ b/OsmAnd/src/net/osmand/plus/card/color/palette/main/ColorsPaletteFragment.java
@@ -2,14 +2,11 @@
 
 import static net.osmand.plus.card.color.palette.main.IColorsPaletteController.ALL_COLORS_PROCESS_ID;
 
-import android.app.Activity;
-import android.app.Dialog;
 import android.graphics.drawable.Drawable;
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
-import android.view.Window;
 import android.widget.ImageView;
 import android.widget.TextView;
 
@@ -59,6 +56,8 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 	@Override
 	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		updateNightMode();
+		paletteElements = new ColorsPaletteElements(requireContext(), nightMode);
+
 		View view = inflate(R.layout.fragment_palette, container, false);
 		setupToolbar(view);
 		setupColorsPalette(view);
diff --git a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapFragment.java b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapFragment.java
index a39500c7947..a389494962d 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/ConfigureMapFragment.java
@@ -38,11 +38,11 @@
 import net.osmand.plus.widgets.ctxmenu.callback.OnRowItemClick;
 import net.osmand.plus.widgets.ctxmenu.data.ContextMenuItem;
 
-import java.util.EnumSet;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.Objects;
+import java.util.Set;
 
 public class ConfigureMapFragment extends BaseFullScreenFragment implements OnDataChangeUiAdapter,
 		InAppPurchaseListener, SelectGpxTaskListener {
@@ -309,7 +309,7 @@ public static ConfigureMapFragment getVisibleInstance(@NonNull MapActivity mapAc
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java b/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
index 1553f7f3cf9..a74f54c2e9d 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/CoordinatesGridController.java
@@ -33,7 +33,7 @@
 
 import java.text.NumberFormat;
 import java.util.ArrayList;
-import java.util.EnumSet;
+import java.util.Set;
 import java.util.List;
 
 public class CoordinatesGridController extends BaseDialogController {
@@ -209,7 +209,7 @@ public static CoordinatesGridController getExistedInstance(@NonNull OsmandApplic
 	}
 
 	@Nullable
-	protected EnumSet<InsetSide> getSideInsets(){
+	protected Set<InsetSide> getSideInsets() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/configmap/routes/MapRoutesFragment.java b/OsmAnd/src/net/osmand/plus/configmap/routes/MapRoutesFragment.java
index 1b1fc07a1c6..df019e29cbe 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/routes/MapRoutesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/routes/MapRoutesFragment.java
@@ -39,8 +39,8 @@
 import org.apache.commons.logging.Log;
 
 import java.util.ArrayList;
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public abstract class MapRoutesFragment extends BaseFullScreenFragment implements CardListener {
 
@@ -212,7 +212,7 @@ public static String getFragmentName(@Nullable String attrName) {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/configmap/routes/TravelRoutesFragment.java b/OsmAnd/src/net/osmand/plus/configmap/routes/TravelRoutesFragment.java
index 56964701980..c0ad2f6eb67 100644
--- a/OsmAnd/src/net/osmand/plus/configmap/routes/TravelRoutesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/configmap/routes/TravelRoutesFragment.java
@@ -41,8 +41,8 @@
 import net.osmand.util.Algorithms;
 
 import java.util.Collections;
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class TravelRoutesFragment extends BaseFullScreenFragment {
 
@@ -434,7 +434,7 @@ private TextViewEx createEmptyView(@NonNull ViewGroup container, @StringRes int
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/helpers/AndroidUiHelper.java b/OsmAnd/src/net/osmand/plus/helpers/AndroidUiHelper.java
index 4df740dfd0a..b1f61796415 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/AndroidUiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/AndroidUiHelper.java
@@ -24,14 +24,10 @@
 import android.util.Log;
 import android.view.*;
 import android.view.View.OnAttachStateChangeListener;
+import android.widget.FrameLayout;
 import android.widget.ImageView;
 
-import androidx.annotation.ColorInt;
-import androidx.annotation.IdRes;
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-import androidx.annotation.RequiresApi;
-import androidx.annotation.UiContext;
+import androidx.annotation.*;
 import androidx.appcompat.app.ActionBar;
 import androidx.appcompat.app.AppCompatActivity;
 import androidx.core.graphics.Insets;
@@ -186,7 +182,7 @@ public static int setStatusBarColor(@NonNull Activity activity, @ColorInt int co
 	public static int setStatusBarColor(@NonNull Window window, @ColorInt int color) {
 		int previousColor = -1;
 		if (InsetsUtils.isEdgeToEdgeSupported()) {
-			View scrim = getOrCreateStatusBarScrim(window);
+			View scrim = getOrCreateScrim(window, R.id.status_bar_scrim, R.layout.status_bar_scrim);
 			if (scrim != null) {
 				if (scrim.getBackground() instanceof ColorDrawable drawable) {
 					previousColor = drawable.getColor();
@@ -200,35 +196,76 @@ public static int setStatusBarColor(@NonNull Window window, @ColorInt int color)
 		return previousColor;
 	}
 
-	@Nullable
-	private static View getOrCreateStatusBarScrim(@NonNull Window window) {
-		View scrim = window.findViewById(R.id.status_bar_scrim);
-		if (scrim != null) {
-			return scrim;
+	public static void setNavigationBarColor(@NonNull Activity activity, @ColorInt int color) {
+		setNavigationBarColor(activity.getWindow(), color);
+	}
+
+	public static void setNavigationBarColor(@NonNull Window window, @ColorInt int color) {
+		if (InsetsUtils.isEdgeToEdgeSupported()) {
+			View scrim = getOrCreateScrim(window, R.id.navigation_bar_scrim, R.layout.navigation_bar_scrim);
+			if (scrim != null) {
+				scrim.setBackgroundColor(color);
+			}
 		} else {
+			window.setNavigationBarColor(color);
+		}
+	}
+
+	@Nullable
+	private static View getOrCreateScrim(@NonNull Window window, @IdRes int scrimId, @LayoutRes int layoutId) {
+		View scrim = window.findViewById(scrimId);
+		if (scrim == null) {
 			View decorView = window.getDecorView();
 			if (decorView instanceof ViewGroup content) {
 				LayoutInflater inflater = LayoutInflater.from(window.getContext());
-				scrim = inflater.inflate(R.layout.status_bar_scrim, content, false);
+				scrim = inflater.inflate(layoutId, content, false);
 				content.addView(scrim);
-				setupStatusBarScrim(content, scrim);
-				return scrim;
+
+				setupSystemBarScrims(window);
 			}
 		}
-		return null;
+		return scrim;
 	}
 
-	private static void setupStatusBarScrim(@NonNull ViewGroup content, @NonNull View scrim) {
-		ViewCompat.setOnApplyWindowInsetsListener(content, (v, insets) -> {
-			Insets sysBars = insets.getInsets(WindowInsetsCompat.Type.statusBars() | WindowInsetsCompat.Type.displayCutout());
-
-			ViewGroup.LayoutParams params = scrim.getLayoutParams();
-			if (params.height != sysBars.top) {
-				params.height = sysBars.top;
-				scrim.setLayoutParams(params);
+	private static void setupSystemBarScrims(@NonNull Window window) {
+		View decorView = window.getDecorView();
+		ViewCompat.setOnApplyWindowInsetsListener(decorView, (v, insets) -> {
+			View statusBarScrim = v.findViewById(R.id.status_bar_scrim);
+			if (statusBarScrim != null) {
+				Insets statusBarInsets = insets.getInsets(WindowInsetsCompat.Type.statusBars()
+						| WindowInsetsCompat.Type.displayCutout()
+				);
+				ViewGroup.LayoutParams params = statusBarScrim.getLayoutParams();
+				if (params.height != statusBarInsets.top) {
+					params.height = statusBarInsets.top;
+					statusBarScrim.setLayoutParams(params);
+				}
+			}
+			View navBarScrim = v.findViewById(R.id.navigation_bar_scrim);
+			if (navBarScrim != null) {
+				Insets navBarInsets = insets.getInsets(WindowInsetsCompat.Type.navigationBars());
+				FrameLayout.LayoutParams params = (FrameLayout.LayoutParams) navBarScrim.getLayoutParams();
+				if (navBarInsets.bottom > 0) {
+					params.height = navBarInsets.bottom;
+					params.width = ViewGroup.LayoutParams.MATCH_PARENT;
+					params.gravity = Gravity.BOTTOM;
+				} else if (navBarInsets.left > 0) {
+					params.height = ViewGroup.LayoutParams.MATCH_PARENT;
+					params.width = navBarInsets.left;
+					params.gravity = Gravity.START;
+				} else if (navBarInsets.right > 0) {
+					params.height = ViewGroup.LayoutParams.MATCH_PARENT;
+					params.width = navBarInsets.right;
+					params.gravity = Gravity.END;
+				} else {
+					params.height = 0;
+					params.width = 0;
+				}
+				navBarScrim.setLayoutParams(params);
 			}
 			return insets;
 		});
+		ViewCompat.requestApplyInsets(decorView);
 	}
 
 	public static void setStatusBarContentColor(@Nullable View view, boolean nightMode) {
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
index 3a50231257c..ba3c4ca1344 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
@@ -93,6 +93,7 @@
 import java.util.Collections;
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class MapContextMenuFragment extends BaseFullScreenFragment implements DownloadEvents,
 		ICoveredScreenRectProvider, IMapDisplayPositionProvider {
@@ -598,7 +599,7 @@ private void recycleVelocityTracker() {
 
 	@Nullable
 	@Override
-	public EnumSet<InsetSide> getRootInsetSides() {
+	public Set<InsetSide> getRootInsetSides() {
 		return EnumSet.of(InsetSide.TOP, InsetSide.BOTTOM);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconPaletteFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconPaletteFragment.java
index 9f9ffa00bb5..67c7f2cf721 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconPaletteFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/editors/icon/EditorIconPaletteFragment.java
@@ -2,7 +2,6 @@
 
 import static net.osmand.plus.card.icon.IIconsPaletteController.ALL_ICONS_PROCESS_ID;
 
-import android.app.Activity;
 import android.app.Dialog;
 import android.os.Bundle;
 import android.text.Editable;
@@ -79,7 +78,7 @@ public void onCreate(Bundle savedInstanceState) {
 	@NonNull
 	@Override
 	public Dialog createDialog(@Nullable Bundle savedInstanceState) {
-		Dialog dialog = new Dialog(requireActivity(), getThemeId());
+		Dialog dialog = super.createDialog(savedInstanceState);
 		dialog.setOnKeyListener((d, keyCode, event) -> {
 			if (KeyEvent.KEYCODE_BACK == keyCode && KeyEvent.ACTION_UP == event.getAction()) {
 				onBackPressed();
diff --git a/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java b/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
index 095f8d33903..96220be96e0 100644
--- a/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
+++ b/OsmAnd/src/net/osmand/plus/myplaces/MyPlacesActivity.java
@@ -31,14 +31,12 @@
 import net.osmand.plus.plugins.PluginsHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.utils.AndroidUtils;
-import net.osmand.plus.utils.InsetsUtils;
 import net.osmand.plus.views.controls.PagerSlidingTabStrip;
 import net.osmand.util.Algorithms;
 
 import java.io.File;
 import java.lang.ref.WeakReference;
 import java.util.ArrayList;
-import java.util.EnumSet;
 import java.util.List;
 
 /**
diff --git a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryFiltersFragment.java b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryFiltersFragment.java
index 3549f197a1f..4f55ac7c236 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryFiltersFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/mapillary/MapillaryFiltersFragment.java
@@ -40,7 +40,7 @@
 import java.text.SimpleDateFormat;
 import java.util.Calendar;
 import java.util.Date;
-import java.util.EnumSet;
+import java.util.Set;
 
 public class MapillaryFiltersFragment extends BaseFullScreenFragment {
 
@@ -275,7 +275,7 @@ private void changeButtonState(Button button, float alpha, boolean enabled) {
     }
 
     @Nullable
-    public EnumSet<InsetSide> getRootInsetSides(){
+    public Set<InsetSide> getRootInsetSides() {
         return null;
     }
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/openseamaps/NauticalDepthContourFragment.java b/OsmAnd/src/net/osmand/plus/plugins/openseamaps/NauticalDepthContourFragment.java
index 49d298d53d6..e29f6c41877 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/openseamaps/NauticalDepthContourFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/openseamaps/NauticalDepthContourFragment.java
@@ -33,8 +33,8 @@
 
 import java.util.ArrayList;
 import java.util.Arrays;
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class NauticalDepthContourFragment extends BaseFullScreenFragment {
 
@@ -184,7 +184,7 @@ private Drawable getPropertyIcon(@NonNull String attrName) {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/Relief3DFragment.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/Relief3DFragment.java
index b6e97fd6e4b..890510c54e5 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/Relief3DFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/Relief3DFragment.java
@@ -27,7 +27,7 @@
 import net.osmand.plus.utils.InsetsUtils.InsetSide;
 import net.osmand.plus.utils.UiUtilities;
 
-import java.util.EnumSet;
+import java.util.Set;
 
 public class Relief3DFragment extends BaseFullScreenFragment implements View.OnClickListener, DownloadEvents, MapOptionSliderListener {
 
@@ -176,7 +176,7 @@ protected void refreshMap() {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainFragment.java b/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainFragment.java
index 0b2de9d1300..a1c8c365595 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/srtm/TerrainFragment.java
@@ -65,8 +65,8 @@
 import java.text.DecimalFormat;
 import java.text.NumberFormat;
 import java.util.ArrayList;
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 
 public class TerrainFragment extends BaseFullScreenFragment implements View.OnClickListener, DownloadEvents {
@@ -405,7 +405,7 @@ private boolean isColoringTypeAvailable() {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherContoursFragment.java b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherContoursFragment.java
index f4328be1c1d..f9528438304 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherContoursFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherContoursFragment.java
@@ -28,9 +28,9 @@
 import net.osmand.plus.utils.InsetsUtils.InsetSide;
 import net.osmand.plus.utils.UiUtilities;
 
-import java.util.EnumSet;
 import java.util.HashMap;
 import java.util.Map;
+import java.util.Set;
 
 public class WeatherContoursFragment extends BaseFullScreenFragment {
 
@@ -243,7 +243,7 @@ private String formatPercent(int percent) {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherLayerFragment.java b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherLayerFragment.java
index 4a53202167b..bf76beeb3d8 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherLayerFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherLayerFragment.java
@@ -33,7 +33,7 @@
 import net.osmand.plus.utils.InsetsUtils.InsetSide;
 import net.osmand.plus.utils.UiUtilities;
 
-import java.util.EnumSet;
+import java.util.Set;
 
 public class WeatherLayerFragment extends BaseFullScreenFragment {
 
@@ -249,7 +249,7 @@ private void updateScreenMode(@NonNull View view, boolean enabled) {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
index 73215848eb3..4ee545e7eb1 100644
--- a/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
+++ b/OsmAnd/src/net/osmand/plus/plugins/weather/dialogs/WeatherMainFragment.java
@@ -36,8 +36,8 @@
 import net.osmand.plus.utils.InsetsUtils.InsetSide;
 import net.osmand.plus.utils.UiUtilities;
 
-import java.util.EnumSet;
 import java.util.Iterator;
+import java.util.Set;
 
 public class WeatherMainFragment extends BaseFullScreenFragment implements DownloadEvents, RemoveLocalForecastListener {
 
@@ -223,7 +223,7 @@ private void updateScreenMode(@NonNull View view, boolean enabled) {
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java b/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
index c13e9a56ba3..142f265950c 100644
--- a/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/settings/fragments/BaseSettingsFragment.java
@@ -164,7 +164,7 @@ public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceStat
 
 	@Nullable
 	@Override
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides(){
 		return EnumSet.of(InsetSide.TOP);
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/track/SelectTrackFolderFragment.java b/OsmAnd/src/net/osmand/plus/track/SelectTrackFolderFragment.java
index 21e6e4efb66..c25bab219c0 100644
--- a/OsmAnd/src/net/osmand/plus/track/SelectTrackFolderFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/SelectTrackFolderFragment.java
@@ -107,8 +107,7 @@ public int getStatusBarColorId() {
 
 	@Nullable
 	@Override
-	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
-			@Nullable Bundle savedInstanceState) {
+	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		importHelper = app.getImportHelper();
 		updateNightMode();
 		view = inflate(R.layout.select_track_folder_fragment, container, false);
@@ -325,11 +324,9 @@ public void setTracksSortMode(@NonNull TracksSortMode sortMode, boolean sortSubF
 		adapter.notifyDataSetChanged();
 	}
 
-	public static void showInstance(@NonNull FragmentManager manager,
-			@NonNull BaseTracksTabsFragment selectTrackFragment, @Nullable TracksSortMode sortMode,
-			@Nullable Object fileSelectionListener, @NonNull TrackFolder baseTrackFolder,
-			@NonNull TrackFolder currentTrackFolder,
-			@Nullable ItemVisibilityCallback itemVisibilityCallback) {
+	public static void showInstance(@NonNull FragmentManager manager, @NonNull BaseTracksTabsFragment selectTrackFragment, @Nullable TracksSortMode sortMode,
+									@Nullable Object fileSelectionListener, @NonNull TrackFolder baseTrackFolder, @NonNull TrackFolder currentTrackFolder,
+									@Nullable ItemVisibilityCallback itemVisibilityCallback) {
 		if (AndroidUtils.isFragmentCanBeAdded(manager, TAG)) {
 			SelectTrackFolderFragment fragment = new SelectTrackFolderFragment();
 			fragment.sortMode = sortMode;
@@ -380,8 +377,7 @@ private GpxImportListener getGpxImportListener(int filesSize) {
 		return new MultipleTracksImportListener(filesSize) {
 
 			@Override
-			public void onImportStarted() {
-			}
+			public void onImportStarted() {}
 
 			@Override
 			public void onImportFinished() {
diff --git a/OsmAnd/src/net/osmand/plus/track/SelectTrackTabsFragment.java b/OsmAnd/src/net/osmand/plus/track/SelectTrackTabsFragment.java
index 2e195b2e3f5..bb3d644a2c0 100644
--- a/OsmAnd/src/net/osmand/plus/track/SelectTrackTabsFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/SelectTrackTabsFragment.java
@@ -56,8 +56,7 @@ protected int getThemeId() {
 
 	@Nullable
 	@Override
-	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
-			@Nullable Bundle savedInstanceState) {
+	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		updateNightMode();
 		View view = inflate(R.layout.select_track_fragment, container, false);
 
@@ -191,13 +190,11 @@ public boolean selectTrackMode() {
 		return true;
 	}
 
-	public static void showInstance(@NonNull FragmentManager manager,
-			Object fileSelectionListener) {
+	public static void showInstance(@NonNull FragmentManager manager, Object fileSelectionListener) {
 		showInstance(manager, fileSelectionListener, null);
 	}
 
-	public static void showInstance(@NonNull FragmentManager manager, Object fileSelectionListener,
-			@Nullable ItemVisibilityCallback itemVisibilityCallback) {
+	public static void showInstance(@NonNull FragmentManager manager, Object fileSelectionListener, @Nullable ItemVisibilityCallback itemVisibilityCallback) {
 		if (AndroidUtils.isFragmentCanBeAdded(manager, TAG)) {
 			SelectTrackTabsFragment fragment = new SelectTrackTabsFragment();
 			fragment.fileSelectionListener = fileSelectionListener;
diff --git a/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java b/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
index f7ee022aa1f..2329bef6cb9 100644
--- a/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
+++ b/OsmAnd/src/net/osmand/plus/track/fragments/ReadDescriptionFragment.java
@@ -67,8 +67,7 @@ public void onCreate(@Nullable Bundle savedInstanceState) {
 
 	@Nullable
 	@Override
-	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
-			@Nullable Bundle savedInstanceState) {
+	public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
 		updateNightMode();
 		View view = inflate(R.layout.dialog_read_description, container, false);
 		setupToolbar(view);
@@ -172,8 +171,7 @@ private void loadPlainText() {
 		}
 	}
 
-	public void setupWebViewClient(@NonNull View view) {
-	}
+	public void setupWebViewClient(@NonNull View view) { }
 
 	private String setupContentStyle(@NonNull String content, boolean isNight) {
 		StringBuilder sb = new StringBuilder();
diff --git a/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java b/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
index 86ecc2b2d20..c93a56e4ee4 100644
--- a/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
+++ b/OsmAnd/src/net/osmand/plus/transport/TransportLinesFragment.java
@@ -29,8 +29,8 @@
 import net.osmand.render.RenderingRuleProperty;
 import net.osmand.util.Algorithms;
 
-import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class TransportLinesFragment extends BaseFullScreenFragment {
 
@@ -174,7 +174,7 @@ public static void setupButton(@NonNull View view, int iconId, @NonNull String t
 	}
 
 	@Nullable
-	public EnumSet<InsetSide> getRootInsetSides(){
+	public Set<InsetSide> getRootInsetSides() {
 		return null;
 	}
 
diff --git a/OsmAnd/src/net/osmand/plus/utils/AndroidUtils.java b/OsmAnd/src/net/osmand/plus/utils/AndroidUtils.java
index 54460039b2a..ef9f2ed9689 100644
--- a/OsmAnd/src/net/osmand/plus/utils/AndroidUtils.java
+++ b/OsmAnd/src/net/osmand/plus/utils/AndroidUtils.java
@@ -779,10 +779,7 @@ public static int getCutoutHeight(@NonNull Activity activity) {
 	}
 
 	public static void addStatusBarPadding21v(@NonNull Activity activity, @NonNull View view) {
-		if (InsetsUtils.isEdgeToEdgeSupported()) {
-			return;
-		}
-		if (isInFullScreenMode(activity)) {
+		if (!InsetsUtils.isEdgeToEdgeSupported() && isInFullScreenMode(activity)) {
 			int paddingLeft = view.getPaddingLeft();
 			int paddingTop = view.getPaddingTop();
 			int paddingRight = view.getPaddingRight();
diff --git a/OsmAnd/src/net/osmand/plus/utils/InsetsUtils.java b/OsmAnd/src/net/osmand/plus/utils/InsetsUtils.java
index 87aa260a04d..cf4cfb64a0a 100644
--- a/OsmAnd/src/net/osmand/plus/utils/InsetsUtils.java
+++ b/OsmAnd/src/net/osmand/plus/utils/InsetsUtils.java
@@ -21,6 +21,7 @@
 
 import java.util.EnumSet;
 import java.util.List;
+import java.util.Set;
 
 public class InsetsUtils {
 
@@ -38,16 +39,12 @@ public static boolean isEdgeToEdgeSupported(){
 		return Build.VERSION.SDK_INT >= MINIMUM_EDGE_TO_EDGE_SUPPORTED_API;
 	}
 
+	@Nullable
 	public static Insets getSysBars(@NonNull Context ctx, @Nullable WindowInsetsCompat insets) {
 		if (!isEdgeToEdgeSupported()) {
 			return Insets.of(0, AndroidUtils.getStatusBarHeight(ctx), 0, 0);
-		} else {
-			if (insets == null) {
-				return null;
-			} else {
-				return insets.getInsets(WindowInsetsCompat.Type.systemBars());
-			}
 		}
+		return insets != null ? insets.getInsets(WindowInsetsCompat.Type.systemBars()) : null;
 	}
 
 	public static void setWindowInsetsListener(@NonNull final View view,
@@ -83,16 +80,13 @@ public void onViewDetachedFromWindow(@NonNull View v) {}
 		}
 	}
 
-	public static void setWindowInsetsListener(@NonNull final View view,
-	                                           @Nullable final EnumSet<InsetSide> sides) {
-		setWindowInsetsListener(view, (v, insets) -> {
-			applyPadding(v, insets, sides);
-		}, false);
+	public static void setWindowInsetsListener(@NonNull View view, @Nullable Set<InsetSide> sides) {
+		setWindowInsetsListener(view, (v, insets) -> applyPadding(v, insets, sides), false);
 	}
 
 	public static void applyPadding(@NonNull View view,
 	                                @NonNull WindowInsetsCompat insets,
-	                                @Nullable EnumSet<InsetSide> sides) {
+	                                @Nullable Set<InsetSide> sides) {
 		if (sides == null || !isEdgeToEdgeSupported()) {
 			return;
 		}
@@ -146,7 +140,7 @@ public static void processInsets(@NonNull ISupportInsets insetSupportedFragment,
 		if (!allowProcessInsets) {
 			return;
 		}
-		EnumSet<InsetSide> insetSides = insetSupportedFragment.getRootInsetSides();
+		Set<InsetSide> insetSides = insetSupportedFragment.getRootInsetSides();
 		List<Integer> rootScrollableIds = insetSupportedFragment.getScrollableViewIds();
 		List<Integer> bottomContainers = insetSupportedFragment.getBottomContainersIds();
 		List<Integer> fabs = insetSupportedFragment.getFabIds();
@@ -176,7 +170,7 @@ private static boolean shouldAllowProcessInsets(@NonNull ISupportInsets insetSup
 	}
 
 	private static void processRootInsetSides(@NonNull WindowInsetsCompat insets,
-	                                          @Nullable EnumSet<InsetSide> insetSides,
+	                                          @Nullable Set<InsetSide> insetSides,
 	                                          @NonNull View view){
 		InsetsUtils.applyPadding(view, insets, insetSides);
 	}
@@ -265,7 +259,7 @@ private static void processScrollInsets(@NonNull ISupportInsets insetSupportedFr
 	                                        @NonNull WindowInsetsCompat insets,
 	                                        @Nullable List<Integer> rootScrollableIds,
 	                                        @NonNull View view,
-	                                        @Nullable EnumSet<InsetSide> insetSides) {
+	                                        @Nullable Set<InsetSide> insetSides) {
 		View listView = null;
 		if (rootScrollableIds != null) {
 			for (int id : rootScrollableIds) {
diff --git a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
index 916cabb777c..f530aa4e1e5 100644
--- a/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
+++ b/OsmAnd/src/net/osmand/plus/wikivoyage/explore/WikivoyageExploreActivity.java
@@ -43,7 +43,6 @@
 
 import java.lang.ref.WeakReference;
 import java.util.ArrayList;
-import java.util.EnumSet;
 import java.util.List;
 
 public class WikivoyageExploreActivity extends TabActivity implements DownloadEvents, OnDialogFragmentResultListener,
