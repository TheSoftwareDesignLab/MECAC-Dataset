diff --git a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
index 5bb9cc73c03..02cbcd423c0 100644
--- a/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
+++ b/OsmAnd/src/net/osmand/aidl/OsmandAidlApi.java
@@ -81,6 +81,7 @@
 import net.osmand.plus.helpers.ExternalApiHelper;
 import net.osmand.plus.helpers.GpxNavigationParams;
 import net.osmand.plus.helpers.LockHelper;
+import net.osmand.plus.helpers.NavigateGpxHelper;
 import net.osmand.plus.mapcontextmenu.MapContextMenu;
 import net.osmand.plus.mapcontextmenu.other.IContextMenuButtonListener;
 import net.osmand.plus.mapmarkers.MapMarker;
@@ -668,13 +669,13 @@ public void onReceive(Context context, Intent intent) {
 					boolean locationPermission = intent.getBooleanExtra(AIDL_LOCATION_PERMISSION, false);
 					if (routingHelper.isFollowingMode() && !force) {
 						mapActivity.getMapActions().stopNavigationActionConfirm(dialog -> {
-							MapActivity mapActivity1 = mapActivityRef.get();
-							if (mapActivity1 != null && !routingHelper.isFollowingMode()) {
-								ExternalApiHelper.startNavigation(mapActivity1, start, startDesc, dest, destDesc, profile, locationPermission);
+							MapActivity activity = mapActivityRef.get();
+							if (activity != null && !routingHelper.isFollowingMode()) {
+								NavigateGpxHelper.startNavigation(activity, start, startDesc, dest, destDesc, profile, locationPermission);
 							}
 						});
 					} else {
-						ExternalApiHelper.startNavigation(mapActivity, start, startDesc, dest, destDesc, profile, locationPermission);
+						NavigateGpxHelper.startNavigation(mapActivity, start, startDesc, dest, destDesc, profile, locationPermission);
 					}
 				}
 			}
@@ -764,7 +765,7 @@ public void onReceive(Context context, Intent intent) {
 						params.setSnapToRoad(intent.getBooleanExtra(AIDL_SNAP_TO_ROAD, false));
 						params.setSnapToRoadMode(intent.getStringExtra(AIDL_SNAP_TO_ROAD_MODE));
 						params.setSnapToRoadThreshold(intent.getIntExtra(AIDL_SNAP_TO_ROAD_THRESHOLD, 50));
-						ExternalApiHelper.saveAndNavigateGpx(mapActivity, gpx, params);
+						NavigateGpxHelper.saveAndNavigateGpx(mapActivity, gpx, params);
 					}
 				}
 			}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
index 536686852da..a8fc8e2eaec 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/ExternalApiHelper.java
@@ -1,5 +1,6 @@
 package net.osmand.plus.helpers;
 
+import static net.osmand.plus.helpers.NavigateGpxHelper.startNavigation;
 import static net.osmand.search.core.ObjectType.CITY;
 import static net.osmand.search.core.ObjectType.HOUSE;
 import static net.osmand.search.core.ObjectType.POI;
@@ -257,7 +258,7 @@ public Intent processApiRequest(Intent intent) {
 						GpxNavigationParams params = new GpxNavigationParams();
 						params.setForce(uri.getBooleanQueryParameter(PARAM_FORCE, false));
 						params.setCheckLocationPermission(uri.getBooleanQueryParameter(PARAM_LOCATION_PERMISSION, false));
-						saveAndNavigateGpx(mapActivity, gpx, params);
+						NavigateGpxHelper.saveAndNavigateGpx(mapActivity, gpx, params);
 					} else {
 						app.getSelectedGpxHelper().setGpxFileToDisplay(gpx);
 					}
@@ -649,89 +650,6 @@ private ApplicationMode findNavigationProfile(@NonNull OsmandApplication app, @N
 		return null;
 	}
 
-	public static void saveAndNavigateGpx(MapActivity mapActivity, GPXFile gpxFile,
-	                                      GpxNavigationParams params) {
-		WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
-		saveGpx(mapActivity, gpxFile, errorMessage -> {
-			MapActivity activity = activityRef.get();
-			if (errorMessage == null && AndroidUtils.isActivityNotDestroyed(activity)) {
-				navigateGpx_ShowOnMap(activity, gpxFile, params);
-			}
-		});
-	}
-
-	private static void saveGpx(MapActivity mapActivity, GPXFile gpxFile, SaveGpxListener listener) {
-		if (Algorithms.isEmpty(gpxFile.path)) {
-			OsmandApplication app = mapActivity.getMyApplication();
-			String destFileName = "route" + IndexConstants.GPX_FILE_EXT;
-			File destDir = app.getAppPath(IndexConstants.GPX_IMPORT_DIR);
-			File destFile = app.getAppPath(IndexConstants.GPX_IMPORT_DIR + destFileName);
-			while (destFile.exists()) {
-				destFileName = AndroidUtils.createNewFileName(destFileName);
-				destFile = new File(destDir, destFileName);
-			}
-			gpxFile.path = destFile.getAbsolutePath();
-		}
-		SaveGpxHelper.saveGpx(new File(gpxFile.path), gpxFile, listener);
-	}
-
-	public static void navigateGpx_ShowOnMap(@NonNull MapActivity activity, @NonNull GPXFile gpxFile,
-	                                         @NonNull GpxNavigationParams navigationParams) {
-		OsmandApplication app = activity.getMyApplication();
-		GpxSelectionHelper helper = app.getSelectedGpxHelper();
-		SelectedGpxFile selectedGpx = helper.getSelectedFileByPath(gpxFile.path);
-		if (selectedGpx != null) {
-			selectedGpx.setGpxFile(gpxFile, app);
-		} else {
-			GpxSelectionParams selectionParams = GpxSelectionParams.newInstance()
-					.showOnMap().syncGroup().selectedByUser().addToMarkers()
-					.addToHistory().saveSelection();
-			helper.selectGpxFile(gpxFile, selectionParams);
-		}
-		navigateGpx_ApproximateIfNeeded(activity, gpxFile, navigationParams);
-	}
-
-	public static void navigateGpx_ApproximateIfNeeded(@NonNull MapActivity mapActivity,
-	                                                   @NonNull GPXFile gpxFile,
-	                                                   @NonNull GpxNavigationParams params) {
-		if (params.isSnapToRoad()) {
-			OsmandApplication app = mapActivity.getMyApplication();
-			GpxApproximationParams approxParams = new GpxApproximationParams();
-			approxParams.setAppMode(ApplicationMode.valueOfStringKey(params.getSnapToRoadMode(), null));
-			approxParams.setDistanceThreshold(params.getSnapToRoadThreshold());
-			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
-			GpxApproximationHelper.approximateGpxSilently(app, gpxFile, approxParams, approxGpx -> {
-				MapActivity activity = activityRef.get();
-				if (AndroidUtils.isActivityNotDestroyed(activity)) {
-					navigateGpx_FinalCheck(activity, approxGpx, params);
-				}
-				return true;
-			});
-		} else {
-			navigateGpx_FinalCheck(mapActivity, gpxFile, params);
-		}
-	}
-
-	public static void navigateGpx_FinalCheck(@NonNull MapActivity mapActivity, @NonNull GPXFile gpxFile,
-	                                          @NonNull GpxNavigationParams params) {
-		OsmandApplication app = mapActivity.getMyApplication();
-		boolean force = params.isForce();
-		boolean checkLocationPermission = params.isCheckLocationPermission();
-		boolean passWholeRoute = params.isPassWholeRoute();
-		RoutingHelper routingHelper = app.getRoutingHelper();
-		if (routingHelper.isFollowingMode() && !force) {
-			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
-			mapActivity.getMapActions().stopNavigationActionConfirm(dialog -> {
-				MapActivity activity = activityRef.get();
-				if (activity != null && !routingHelper.isFollowingMode()) {
-					startNavigation(activity, gpxFile, checkLocationPermission, passWholeRoute);
-				}
-			});
-		} else {
-			startNavigation(mapActivity, gpxFile, checkLocationPermission, passWholeRoute);
-		}
-	}
-
 	public static void updateTurnInfo(String prefix, Bundle bundle, NextDirectionInfo nextInfo) {
 		bundle.putInt(prefix + PARAM_NT_DISTANCE, nextInfo.distanceTo);
 		bundle.putInt(prefix + PARAM_NT_IMMINENT, nextInfo.imminent);
@@ -802,54 +720,6 @@ private void showOnMap(double lat, double lon, Object object, PointDescription p
 		mapContextMenu.show(new LatLon(lat, lon), pointDescription, object);
 	}
 
-	public static void startNavigation(MapActivity mapActivity, @NonNull GPXFile gpx, boolean checkLocationPermission, boolean passWholeRoute) {
-		startNavigation(mapActivity, gpx, null, null, null, null, null, checkLocationPermission, passWholeRoute);
-	}
-
-	public static void startNavigation(MapActivity mapActivity,
-	                                   @Nullable LatLon from, @Nullable PointDescription fromDesc,
-	                                   @Nullable LatLon to, @Nullable PointDescription toDesc,
-	                                   @NonNull ApplicationMode mode, boolean checkLocationPermission) {
-		startNavigation(mapActivity, null, from, fromDesc, to, toDesc, mode, checkLocationPermission, false);
-	}
-
-	private static void startNavigation(MapActivity mapActivity, GPXFile gpx,
-	                                    LatLon from, PointDescription fromDesc,
-	                                    LatLon to, PointDescription toDesc,
-	                                    ApplicationMode mode,
-	                                    boolean checkLocationPermission,
-	                                    boolean passWholeRoute) {
-		OsmandApplication app = mapActivity.getMyApplication();
-		OsmandSettings settings = app.getSettings();
-		RoutingHelper routingHelper = app.getRoutingHelper();
-		MapViewTrackingUtilities mapViewTrackingUtilities = mapActivity.getMapViewTrackingUtilities();
-		if (gpx == null) {
-			settings.setApplicationMode(mode);
-			TargetPointsHelper targets = mapActivity.getMyApplication().getTargetPointsHelper();
-			targets.removeAllWayPoints(false, true);
-			targets.navigateToPoint(to, true, -1, toDesc);
-		}
-		mapActivity.getMapActions().enterRoutePlanningModeGivenGpx(
-				gpx, from, fromDesc, true, false, passWholeRoute);
-		if (!app.getTargetPointsHelper().checkPointToNavigateShort()) {
-			mapActivity.getMapRouteInfoMenu().show();
-		} else {
-			if (settings.APPLICATION_MODE.get() != routingHelper.getAppMode()) {
-				settings.setApplicationMode(routingHelper.getAppMode(), false);
-			}
-			mapViewTrackingUtilities.backToLocationImpl();
-			settings.FOLLOW_THE_ROUTE.set(true);
-			routingHelper.setFollowingMode(true);
-			routingHelper.setRoutePlanningMode(false);
-			mapViewTrackingUtilities.switchRoutePlanningMode();
-			routingHelper.notifyIfRouteIsCalculated();
-			routingHelper.setCurrentLocation(app.getLocationProvider().getLastKnownLocation(), false);
-		}
-		if (checkLocationPermission) {
-			OsmAndLocationProvider.requestFineLocationPermissionIfNeeded(mapActivity);
-		}
-	}
-
 	public static void searchAndNavigate(@NonNull MapActivity mapActivity, @NonNull LatLon searchLocation,
 	                                     @Nullable LatLon from, @Nullable PointDescription fromDesc,
 	                                     @NonNull ApplicationMode mode, @NonNull String searchQuery,
diff --git a/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java b/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java
new file mode 100644
index 00000000000..d3770822aac
--- /dev/null
+++ b/OsmAnd/src/net/osmand/plus/helpers/NavigateGpxHelper.java
@@ -0,0 +1,163 @@
+package net.osmand.plus.helpers;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import net.osmand.IndexConstants;
+import net.osmand.data.LatLon;
+import net.osmand.data.PointDescription;
+import net.osmand.gpx.GPXFile;
+import net.osmand.plus.OsmAndLocationProvider;
+import net.osmand.plus.OsmandApplication;
+import net.osmand.plus.activities.MapActivity;
+import net.osmand.plus.base.MapViewTrackingUtilities;
+import net.osmand.plus.measurementtool.GpxApproximationHelper;
+import net.osmand.plus.measurementtool.GpxApproximationParams;
+import net.osmand.plus.routing.RoutingHelper;
+import net.osmand.plus.settings.backend.ApplicationMode;
+import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.track.GpxSelectionParams;
+import net.osmand.plus.track.helpers.GpxSelectionHelper;
+import net.osmand.plus.track.helpers.SelectedGpxFile;
+import net.osmand.plus.track.helpers.save.SaveGpxHelper;
+import net.osmand.plus.track.helpers.save.SaveGpxListener;
+import net.osmand.plus.utils.AndroidUtils;
+import net.osmand.util.Algorithms;
+
+import java.io.File;
+import java.lang.ref.WeakReference;
+
+public class NavigateGpxHelper {
+
+	public static void saveAndNavigateGpx(MapActivity mapActivity, GPXFile gpxFile,
+	                                      GpxNavigationParams params) {
+		WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
+		saveGpx(mapActivity, gpxFile, errorMessage -> {
+			MapActivity activity = activityRef.get();
+			if (errorMessage == null && AndroidUtils.isActivityNotDestroyed(activity)) {
+				navigateGpx_ShowOnMap(activity, gpxFile, params);
+			}
+		});
+	}
+
+	private static void saveGpx(MapActivity mapActivity, GPXFile gpxFile, SaveGpxListener listener) {
+		if (Algorithms.isEmpty(gpxFile.path)) {
+			OsmandApplication app = mapActivity.getMyApplication();
+			String destFileName = "route" + IndexConstants.GPX_FILE_EXT;
+			File destDir = app.getAppPath(IndexConstants.GPX_IMPORT_DIR);
+			File destFile = app.getAppPath(IndexConstants.GPX_IMPORT_DIR + destFileName);
+			while (destFile.exists()) {
+				destFileName = AndroidUtils.createNewFileName(destFileName);
+				destFile = new File(destDir, destFileName);
+			}
+			gpxFile.path = destFile.getAbsolutePath();
+		}
+		SaveGpxHelper.saveGpx(new File(gpxFile.path), gpxFile, listener);
+	}
+
+	public static void navigateGpx_ShowOnMap(@NonNull MapActivity activity, @NonNull GPXFile gpxFile,
+	                                         @NonNull GpxNavigationParams navigationParams) {
+		OsmandApplication app = activity.getMyApplication();
+		GpxSelectionHelper helper = app.getSelectedGpxHelper();
+		SelectedGpxFile selectedGpx = helper.getSelectedFileByPath(gpxFile.path);
+		if (selectedGpx != null) {
+			selectedGpx.setGpxFile(gpxFile, app);
+		} else {
+			GpxSelectionParams selectionParams = GpxSelectionParams.newInstance()
+					.showOnMap().syncGroup().selectedByUser().addToMarkers()
+					.addToHistory().saveSelection();
+			helper.selectGpxFile(gpxFile, selectionParams);
+		}
+		navigateGpx_ApproximateIfNeeded(activity, gpxFile, navigationParams);
+	}
+
+	public static void navigateGpx_ApproximateIfNeeded(@NonNull MapActivity mapActivity,
+	                                                   @NonNull GPXFile gpxFile,
+	                                                   @NonNull GpxNavigationParams params) {
+		if (params.isSnapToRoad()) {
+			OsmandApplication app = mapActivity.getMyApplication();
+			GpxApproximationParams approxParams = new GpxApproximationParams();
+			approxParams.setAppMode(ApplicationMode.valueOfStringKey(params.getSnapToRoadMode(), null));
+			approxParams.setDistanceThreshold(params.getSnapToRoadThreshold());
+			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
+			GpxApproximationHelper.approximateGpxSilently(app, gpxFile, approxParams, approxGpx -> {
+				MapActivity activity = activityRef.get();
+				if (AndroidUtils.isActivityNotDestroyed(activity)) {
+					navigateGpx_FinalCheck(activity, approxGpx, params);
+				}
+				return true;
+			});
+		} else {
+			navigateGpx_FinalCheck(mapActivity, gpxFile, params);
+		}
+	}
+
+	public static void navigateGpx_FinalCheck(@NonNull MapActivity mapActivity, @NonNull GPXFile gpxFile,
+	                                          @NonNull GpxNavigationParams params) {
+		OsmandApplication app = mapActivity.getMyApplication();
+		boolean force = params.isForce();
+		boolean checkLocationPermission = params.isCheckLocationPermission();
+		boolean passWholeRoute = params.isPassWholeRoute();
+		RoutingHelper routingHelper = app.getRoutingHelper();
+		if (routingHelper.isFollowingMode() && !force) {
+			WeakReference<MapActivity> activityRef = new WeakReference<>(mapActivity);
+			mapActivity.getMapActions().stopNavigationActionConfirm(dialog -> {
+				MapActivity activity = activityRef.get();
+				if (activity != null && !routingHelper.isFollowingMode()) {
+					startNavigation(activity, gpxFile, checkLocationPermission, passWholeRoute);
+				}
+			});
+		} else {
+			startNavigation(mapActivity, gpxFile, checkLocationPermission, passWholeRoute);
+		}
+	}
+
+	public static void startNavigation(MapActivity mapActivity, @NonNull GPXFile gpx, boolean checkLocationPermission, boolean passWholeRoute) {
+		startNavigation(mapActivity, gpx, null, null, null, null, null, checkLocationPermission, passWholeRoute);
+	}
+
+	public static void startNavigation(MapActivity mapActivity,
+	                                   @Nullable LatLon from, @Nullable PointDescription fromDesc,
+	                                   @Nullable LatLon to, @Nullable PointDescription toDesc,
+	                                   @NonNull ApplicationMode mode, boolean checkLocationPermission) {
+		startNavigation(mapActivity, null, from, fromDesc, to, toDesc, mode, checkLocationPermission, false);
+	}
+
+	private static void startNavigation(MapActivity mapActivity, GPXFile gpx,
+	                                    LatLon from, PointDescription fromDesc,
+	                                    LatLon to, PointDescription toDesc,
+	                                    ApplicationMode mode,
+	                                    boolean checkLocationPermission,
+	                                    boolean passWholeRoute) {
+		OsmandApplication app = mapActivity.getMyApplication();
+		OsmandSettings settings = app.getSettings();
+		RoutingHelper routingHelper = app.getRoutingHelper();
+		MapViewTrackingUtilities mapViewTrackingUtilities = mapActivity.getMapViewTrackingUtilities();
+		if (gpx == null) {
+			settings.setApplicationMode(mode);
+			TargetPointsHelper targets = mapActivity.getMyApplication().getTargetPointsHelper();
+			targets.removeAllWayPoints(false, true);
+			targets.navigateToPoint(to, true, -1, toDesc);
+		}
+		mapActivity.getMapActions().enterRoutePlanningModeGivenGpx(
+				gpx, from, fromDesc, true, false, passWholeRoute);
+		if (!app.getTargetPointsHelper().checkPointToNavigateShort()) {
+			mapActivity.getMapRouteInfoMenu().show();
+		} else {
+			if (settings.APPLICATION_MODE.get() != routingHelper.getAppMode()) {
+				settings.setApplicationMode(routingHelper.getAppMode(), false);
+			}
+			mapViewTrackingUtilities.backToLocationImpl();
+			settings.FOLLOW_THE_ROUTE.set(true);
+			routingHelper.setFollowingMode(true);
+			routingHelper.setRoutePlanningMode(false);
+			mapViewTrackingUtilities.switchRoutePlanningMode();
+			routingHelper.notifyIfRouteIsCalculated();
+			routingHelper.setCurrentLocation(app.getLocationProvider().getLastKnownLocation(), false);
+		}
+		if (checkLocationPermission) {
+			OsmAndLocationProvider.requestFineLocationPermissionIfNeeded(mapActivity);
+		}
+	}
+
+}
