diff --git a/OsmAnd/src/net/osmand/plus/routing/RouteProvider.java b/OsmAnd/src/net/osmand/plus/routing/RouteProvider.java
index a9ce41cdd7c..aa2e3713d13 100644
--- a/OsmAnd/src/net/osmand/plus/routing/RouteProvider.java
+++ b/OsmAnd/src/net/osmand/plus/routing/RouteProvider.java
@@ -462,9 +462,12 @@ public void insertInitialSegment(RouteCalculationParams routeParams, List<Locati
 		}
 	}
 
-	public void insertIntermediateSegments(RouteCalculationParams routeParams, List<Location> points, List<RouteDirectionInfo> directions,
-										   List<Location> segmentEndpoints, boolean calculateOsmAndRouteParts) {
-		for (int i = 0; i < segmentEndpoints.size() - 1; i++) {
+	public void insertIntermediateSegments(RouteCalculationParams routeParams,
+	                                       List<Location> points,
+	                                       List<RouteDirectionInfo> directions,
+	                                       List<Location> segmentEndpoints,
+	                                       boolean calculateOsmAndRouteParts) {
+		for (int i = 0; i < segmentEndpoints.size() - 1; i += 2) {
 			Location prevSegmentPoint = segmentEndpoints.get(i);
 			Location newSegmentPoint = segmentEndpoints.get(i + 1);
 
@@ -477,13 +480,13 @@ public void insertIntermediateSegments(RouteCalculationParams routeParams, List<
 				RouteCalculationResult newRes = findOfflineRouteSegment(routeParams, prevSegmentPoint, end);
 
 				if (newRes != null && newRes.isCalculated()) {
-					List<Location> loct = newRes.getImmutableAllLocations();
+					List<Location> locations = newRes.getImmutableAllLocations();
 					List<RouteDirectionInfo> dt = newRes.getImmutableAllDirections();
 
 					for (RouteDirectionInfo directionInfo : dt) {
 						directionInfo.routePointOffset += points.size();
 					}
-					points.addAll(index, loct);
+					points.addAll(index, locations);
 					directions.addAll(dt);
 				}
 			}
@@ -491,14 +494,14 @@ public void insertIntermediateSegments(RouteCalculationParams routeParams, List<
 	}
 
 	public List<RouteSegmentResult> findRouteWithIntermediateSegments(RouteCalculationParams routeParams,
-																	  RouteCalculationResult result,
-																	  List<Location> gpxRouteLocations,
-																	  List<Location> segmentEndpoints,
-																	  int nearestGpxPointInd) {
+	                                                                  RouteCalculationResult result,
+	                                                                  List<Location> gpxRouteLocations,
+	                                                                  List<Location> segmentEndpoints,
+	                                                                  int nearestGpxPointInd) {
 		List<RouteSegmentResult> newGpxRoute = new ArrayList<>();
 
 		int lastIndex = nearestGpxPointInd;
-		for (int i = 0; i < segmentEndpoints.size() - 1; i++) {
+		for (int i = 0; i < segmentEndpoints.size() - 1; i += 2) {
 			Location prevSegmentPoint = segmentEndpoints.get(i);
 			Location newSegmentPoint = segmentEndpoints.get(i + 1);
 
@@ -508,7 +511,10 @@ public List<RouteSegmentResult> findRouteWithIntermediateSegments(RouteCalculati
 			int indexNew = findNearestGpxPointIndexFromRoute(gpxRouteLocations, newSegmentPoint, routeParams.gpxRoute.calculateOsmAndRouteParts);
 			int indexPrev = findNearestGpxPointIndexFromRoute(gpxRouteLocations, prevSegmentPoint, routeParams.gpxRoute.calculateOsmAndRouteParts);
 			if (indexPrev != -1 && indexPrev > nearestGpxPointInd && indexNew != -1) {
-				newGpxRoute.addAll(result.getOriginalRoute(lastIndex, indexPrev, true));
+				List<RouteSegmentResult> route = result.getOriginalRoute(lastIndex, indexPrev, true);
+				if (!Algorithms.isEmpty(route)) {
+					newGpxRoute.addAll(route);
+				}
 				lastIndex = indexNew;
 
 				LatLon end = new LatLon(newSegmentPoint.getLatitude(), newSegmentPoint.getLongitude());
@@ -519,7 +525,11 @@ public List<RouteSegmentResult> findRouteWithIntermediateSegments(RouteCalculati
 				}
 			}
 		}
-		newGpxRoute.addAll(result.getOriginalRoute(lastIndex));
+
+		List<RouteSegmentResult> route = result.getOriginalRoute(lastIndex);
+		if (!Algorithms.isEmpty(route)) {
+			newGpxRoute.addAll(route);
+		}
 
 		return newGpxRoute;
 	}
