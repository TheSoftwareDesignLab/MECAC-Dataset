diff --git a/OsmAnd/src/net/osmand/plus/NavigationService.java b/OsmAnd/src/net/osmand/plus/NavigationService.java
index f132859bd11..7e1c19a604d 100644
--- a/OsmAnd/src/net/osmand/plus/NavigationService.java
+++ b/OsmAnd/src/net/osmand/plus/NavigationService.java
@@ -15,31 +15,20 @@
 import android.widget.Toast;
 
 import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-import androidx.car.app.CarContext;
-import androidx.car.app.CarToast;
-import androidx.car.app.navigation.NavigationManager;
-import androidx.car.app.navigation.NavigationManagerCallback;
-import androidx.car.app.navigation.model.Destination;
-import androidx.car.app.navigation.model.TravelEstimate;
-import androidx.car.app.navigation.model.Trip;
 
 import net.osmand.Location;
 import net.osmand.PlatformUtil;
 import net.osmand.StateChangedListener;
+import net.osmand.plus.auto.NavigationCarAppService;
 import net.osmand.plus.auto.NavigationSession;
-import net.osmand.plus.auto.TripHelper;
-import net.osmand.plus.auto.screens.NavigationScreen;
 import net.osmand.plus.helpers.LocationCallback;
 import net.osmand.plus.helpers.LocationServiceHelper;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.enums.LocationSource;
-import net.osmand.plus.simulation.OsmAndLocationSimulation;
 
 import org.apache.commons.logging.Log;
 
-import java.util.Collections;
 import java.util.List;
 
 public class NavigationService extends Service {
@@ -54,7 +43,6 @@ public static class NavigationServiceBinder extends Binder {
 	// global id don't conflict with others
 	public static int USED_BY_NAVIGATION = 1;
 	public static int USED_BY_GPX = 2;
-	public static int USED_BY_CAR_APP = 4;
 	public static final String USAGE_INTENT = "SERVICE_USED_BY";
 
 	private final NavigationServiceBinder binder = new NavigationServiceBinder();
@@ -68,17 +56,15 @@ public static class NavigationServiceBinder extends Binder {
 	private StateChangedListener<LocationSource> locationSourceListener;
 	private long lastTimeGPSLocationFixed;
 
-	// Android Auto
-	private CarContext carContext;
-	private NavigationManager navigationManager;
-	private boolean carNavigationActive;
-	private TripHelper tripHelper;
-
 	@Override
 	public IBinder onBind(Intent intent) {
 		return binder;
 	}
 
+	private OsmandApplication getApp() {
+		return (OsmandApplication) getApplication();
+	}
+
 	public int getUsedBy() {
 		return usedBy;
 	}
@@ -91,110 +77,130 @@ public boolean isUsedBy(int type) {
 		return (usedBy & type) == type;
 	}
 
+	private void onServiceChanged(boolean start) {
+		OsmandApplication app = getApp();
+		NavigationSession carSession = app.getCarNavigationSession();
+		if (start) {
+			if (carSession != null) {
+				if (isUsedBy(USED_BY_NAVIGATION)) {
+					carSession.startCarNavigation();
+				}
+				if (routingHelper.isRouteCalculated() && routingHelper.isPauseNavigation()) {
+					routingHelper.resumeNavigation();
+				}
+			}
+		} else {
+			if (!isUsedBy(USED_BY_NAVIGATION)) {
+				if (carSession != null) {
+					carSession.stopCarNavigation();
+				}
+			}
+		}
+		app.getNotificationHelper().refreshNotifications();
+	}
+
 	public void addUsageIntent(int usageIntent) {
 		usedBy |= usageIntent;
+		onServiceChanged(true);
 	}
 
 	public void stopIfNeeded(@NonNull Context context, int usageIntent) {
+		OsmandApplication app = getApp();
 		if ((usedBy & usageIntent) > 0) {
 			usedBy -= usageIntent;
 		}
-		if (!isUsedBy(USED_BY_NAVIGATION)) {
-			stopCarNavigation();
-		}
-		if (usageIntent == USED_BY_CAR_APP) {
-			setCarContext(null);
-		}
+		onServiceChanged(false);
 		if (usedBy == 0) {
+			LOG.info(">>>> NavigationService - Stop = " + usedBy);
+
 			context.stopService(new Intent(context, NavigationService.class));
 		} else {
-			OsmandApplication app = getApp();
+			LOG.info(">>>> NavigationService - Not Stop = " + usedBy);
+
 			app.getNotificationHelper().updateTopNotification();
 			app.getNotificationHelper().refreshNotifications();
 		}
 	}
 
-	private OsmandApplication getApp() {
-		return (OsmandApplication) getApplication();
-	}
-
 	@Override
 	public int onStartCommand(Intent intent, int flags, int startId) {
+		LOG.info(">>>> NavigationService - onStartCommand");
+
+		if (isUsed()) {
+			addUsageIntent(intent.getIntExtra(USAGE_INTENT, 0));
+			LOG.info(">>>> NavigationService - addUsageIntent = " + usedBy);
+			return START_REDELIVER_INTENT;
+		}
+
 		OsmandApplication app = getApp();
 		settings = app.getSettings();
 		routingHelper = app.getRoutingHelper();
 		usedBy = intent.getIntExtra(USAGE_INTENT, 0);
 
+		LOG.info(">>>> NavigationService - Start = " + usedBy);
+
 		locationProvider = app.getLocationProvider();
 		locationServiceHelper = app.createLocationServiceHelper();
 		app.setNavigationService(this);
 
-		NavigationSession carNavigationSession = app.getCarNavigationSession();
-		if (carNavigationSession != null) {
-			setCarContext(carNavigationSession.getCarContext());
-		}
-
 		Notification notification = app.getNotificationHelper().buildTopNotification(this);
 		boolean hasNotification = notification != null;
 		if (hasNotification) {
-			if (isUsedBy(USED_BY_NAVIGATION)) {
-				startCarNavigation();
-			}
 			try {
 				if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
 					startForeground(TOP_NOTIFICATION_SERVICE_ID, notification, FOREGROUND_SERVICE_TYPE_LOCATION);
 				} else {
 					startForeground(TOP_NOTIFICATION_SERVICE_ID, notification);
 				}
-				app.getNotificationHelper().refreshNotifications();
 			} catch (Exception e) {
-				setCarContext(null);
 				app.setNavigationService(null);
-				LOG.error("Failed to start NavigationService (usedBy=" + usedBy + ", "
-						+ "carNavigationSession = " + (carNavigationSession != null ? "yes" : "no") + ")", e);
+				LOG.error("Failed to start NavigationService (usedBy=" + usedBy + ")", e);
 				usedBy = 0;
 				return START_NOT_STICKY;
 			}
+			try {
+				onServiceChanged(true);
+			} catch (Exception e) {
+				LOG.error(e.getMessage(), e);
+			}
 		} else {
-			LOG.error("NavigationService could not be started because the notification is null. usedBy=" + usedBy
-					+ " carNavigationSession = " + (carNavigationSession != null ? "yes" : "no"));
+			LOG.error("NavigationService could not be started because the notification is null. usedBy=" + usedBy);
 			stopSelf();
 			return START_NOT_STICKY;
 		}
 		requestLocationUpdates();
-
-		if (isUsedBy(USED_BY_CAR_APP)) {
-			if (routingHelper.isRouteCalculated() && routingHelper.isPauseNavigation()) {
-				routingHelper.resumeNavigation();
-			}
-		}
 		return START_REDELIVER_INTENT;
 	}
 
 	@Override
 	public void onCreate() {
+		LOG.info(">>>> NavigationService - onCreate");
+
 		super.onCreate();
 		addLocationSourceListener();
 	}
 
 	@Override
 	public void onDestroy() {
+		LOG.info(">>>> NavigationService - onDestroy");
+
 		super.onDestroy();
 		OsmandApplication app = getApp();
-		setCarContext(null);
 		app.setNavigationService(null);
 		usedBy = 0;
 		removeLocationUpdates();
 		removeLocationSourceListener();
 
 		// remove notification
-		stopForeground(Boolean.TRUE);
+		stopForeground(STOP_FOREGROUND_REMOVE);
 		app.getNotificationHelper().updateTopNotification();
 		app.runInUIThread(() -> app.getNotificationHelper().refreshNotifications(), 500);
 	}
 
 	@Override
 	public void onTaskRemoved(Intent rootIntent) {
+		LOG.info(">>>> NavigationService - onTaskRemoved");
+
 		OsmandApplication app = getApp();
 		app.getNotificationHelper().removeNotifications(false);
 		if (app.getNavigationService() != null && app.getSettings().DISABLE_RECORDING_ONCE_APP_KILLED.get()) {
@@ -223,10 +229,9 @@ private void requestLocationUpdates() {
 				public void onLocationResult(@NonNull List<net.osmand.Location> locations) {
 					if (!locations.isEmpty()) {
 						Location location = locations.get(locations.size() - 1);
+						NavigationCarAppService navigationCarAppService = getApp().getNavigationCarAppService();
 						lastTimeGPSLocationFixed = System.currentTimeMillis();
-						NavigationSession carNavigationSession = getApp().getCarNavigationSession();
-						boolean hasCarSurface = carNavigationSession != null && carNavigationSession.hasStarted();
-						if (!settings.MAP_ACTIVITY_ENABLED || hasCarSurface) {
+						if (!settings.MAP_ACTIVITY_ENABLED && navigationCarAppService == null) {
 							locationProvider.setLocationFromService(location);
 						}
 					}
@@ -237,9 +242,8 @@ public void onLocationResult(@NonNull List<net.osmand.Location> locations) {
 				locationServiceHelper.requestNetworkLocationUpdates(new LocationCallback() {
 					@Override
 					public void onLocationResult(@NonNull List<net.osmand.Location> locations) {
-						NavigationSession carNavigationSession = getApp().getCarNavigationSession();
-						boolean hasCarSurface = carNavigationSession != null && carNavigationSession.hasStarted();
-						if ((!settings.MAP_ACTIVITY_ENABLED || hasCarSurface) && !locations.isEmpty() && !useOnlyGPS()) {
+						NavigationCarAppService navigationCarAppService = getApp().getNavigationCarAppService();
+						if (!settings.MAP_ACTIVITY_ENABLED && navigationCarAppService == null && !locations.isEmpty() && !useOnlyGPS()) {
 							locationProvider.setLocationFromService(locations.get(locations.size() - 1));
 						}
 					}
@@ -273,120 +277,4 @@ private boolean useOnlyGPS() {
 		}
 		return isRunningOnEmulator();
 	}
-
-	/**
-	 * Sets the {@link CarContext} to use while the service is running.
-	 */
-	public void setCarContext(@Nullable CarContext carContext) {
-		this.carContext = carContext;
-		if (carContext != null) {
-			this.tripHelper = new TripHelper(getApp());
-			this.navigationManager = carContext.getCarService(NavigationManager.class);
-			this.navigationManager.setNavigationManagerCallback(new NavigationManagerCallback() {
-				@Override
-				public void onStopNavigation() {
-					if (routingHelper.isRouteCalculated() && routingHelper.isFollowingMode()) {
-						routingHelper.pauseNavigation();
-					} else {
-						getApp().stopNavigation();
-					}
-				}
-
-				@Override
-				public void onAutoDriveEnabled() {
-					CarToast.makeText(carContext, "Auto drive enabled", CarToast.LENGTH_LONG).show();
-					if (!settings.simulateNavigation) {
-						OsmAndLocationSimulation sim = getApp().getLocationProvider().getLocationSimulation();
-						sim.startStopRouteAnimation(null);
-						settings.simulateNavigation = true;
-						settings.simulateNavigationStartedFromAdb = true;
-					}
-				}
-			});
-			// Uncomment if navigating
-			// mNavigationManager.navigationStarted();
-		} else {
-			this.navigationManager = null;
-		}
-	}
-
-	/**
-	 * Clears the currently used {@link CarContext}.
-	 */
-	public void clearCarContext() {
-		carContext = null;
-		navigationManager = null;
-		tripHelper = null;
-	}
-
-	/**
-	 * Starts navigation.
-	 */
-	public void startCarNavigation() {
-		if (navigationManager != null) {
-			navigationManager.navigationStarted();
-			carNavigationActive = true;
-		}
-	}
-
-	/**
-	 * Stops navigation.
-	 */
-	public void stopCarNavigation() {
-		getApp().runInUIThread(() -> {
-					if (navigationManager != null) {
-						NavigationSession carNavigationSession = getApp().getCarNavigationSession();
-						if (carNavigationSession != null) {
-							NavigationScreen navigationScreen = carNavigationSession.getNavigationScreen();
-							if (navigationScreen != null) {
-								navigationScreen.stopTrip();
-							}
-						}
-						carNavigationActive = false;
-						navigationManager.navigationEnded();
-					}
-				}
-		);
-	}
-
-	public void updateCarNavigation(Location currentLocation) {
-		OsmandApplication app = getApp();
-		TripHelper tripHelper = this.tripHelper;
-		if (carNavigationActive && navigationManager != null && tripHelper != null
-				&& routingHelper.isRouteCalculated() && routingHelper.isFollowingMode()) {
-			NavigationSession carNavigationSession = app.getCarNavigationSession();
-			if (carNavigationSession != null) {
-				NavigationScreen navigationScreen = carNavigationSession.getNavigationScreen();
-				if (navigationScreen == null) {
-					carNavigationSession.startNavigation();
-					navigationScreen = carNavigationSession.getNavigationScreen();
-				}
-				if (navigationScreen != null) {
-					float density = carNavigationSession.getNavigationCarSurface().getDensity();
-					if (density == 0) {
-						density = 1;
-					}
-					Trip trip = tripHelper.buildTrip(currentLocation, density);
-					navigationManager.updateTrip(trip);
-
-					List<Destination> destinations = null;
-					Destination destination = tripHelper.getLastDestination();
-					TravelEstimate destinationTravelEstimate = tripHelper.getLastDestinationTravelEstimate();
-					if (destination != null) {
-						destinations = Collections.singletonList(destination);
-					}
-					TravelEstimate lastStepTravelEstimate = tripHelper.getLastStepTravelEstimate();
-					navigationScreen.updateTrip(true, routingHelper.isRouteBeingCalculated(),
-							false/*routingHelper.isRouteWasFinished()*/,
-							destinations, trip.getSteps(), destinationTravelEstimate,
-							lastStepTravelEstimate != null ? lastStepTravelEstimate.getRemainingDistance() : null,
-							true, true, null);
-				}
-			}
-		}
-	}
-
-	public boolean isCarNavigationActive() {
-		return carNavigationActive;
-	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/OsmandApplication.java b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
index c3903db8f9b..e42c0602932 100644
--- a/OsmAnd/src/net/osmand/plus/OsmandApplication.java
+++ b/OsmAnd/src/net/osmand/plus/OsmandApplication.java
@@ -685,22 +685,10 @@ public NavigationSession getCarNavigationSession() {
 
 	public void onCarNavigationSessionStart(@NonNull NavigationSession carNavigationSession) {
 		androidAutoInForeground = true;
-		NavigationService navigationService = this.navigationService;
-		if (navigationService != null) {
-			if (!navigationService.isUsedBy(NavigationService.USED_BY_CAR_APP)) {
-				startNavigationService(carNavigationSession.getCarContext(), NavigationService.USED_BY_CAR_APP);
-			}
-		} else {
-			startNavigationService(carNavigationSession.getCarContext(), NavigationService.USED_BY_CAR_APP);
-		}
 	}
 
 	public void onCarNavigationSessionStop(@NonNull NavigationSession carNavigationSession) {
 		androidAutoInForeground = false;
-		NavigationService navigationService = this.navigationService;
-		if (navigationService != null) {
-			navigationService.stopIfNeeded(this, NavigationService.USED_BY_CAR_APP);
-		}
 	}
 
 	public void setCarNavigationSession(@Nullable NavigationSession carNavigationSession) {
@@ -1001,16 +989,13 @@ public void startNavigationService(int usageIntent) {
 	}
 
 	public void startNavigationService(@NonNull Context context, int usageIntent) {
-		NavigationService service = getNavigationService();
-		if (service != null) {
-			usageIntent |= service.getUsedBy();
-			service.stopSelf();
-		}
+		LOG.info(">>>> APP - startNavigationService");
 		Intent intent = new Intent(context, NavigationService.class);
 		intent.putExtra(NavigationService.USAGE_INTENT, usageIntent);
 		if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
 			runInUIThread(() -> {
 				if (isAppInForeground()) {
+					LOG.info(">>>> APP --- startForegroundService");
 					context.startForegroundService(intent);
 				}
 			});
diff --git a/OsmAnd/src/net/osmand/plus/auto/CarAppNotification.java b/OsmAnd/src/net/osmand/plus/auto/CarAppNotification.java
index a8f9a8bb1b2..0fed1a65d01 100644
--- a/OsmAnd/src/net/osmand/plus/auto/CarAppNotification.java
+++ b/OsmAnd/src/net/osmand/plus/auto/CarAppNotification.java
@@ -1,14 +1,11 @@
 package net.osmand.plus.auto;
 
-import static net.osmand.plus.NavigationService.USED_BY_CAR_APP;
-
 import android.app.Service;
 import android.content.Intent;
 
 import androidx.annotation.Nullable;
 import androidx.core.app.NotificationCompat;
 
-import net.osmand.plus.NavigationService;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
 import net.osmand.plus.activities.MapActivity;
@@ -34,14 +31,12 @@ public int getPriority() {
 
 	@Override
 	public boolean isActive() {
-		return app.getCarNavigationSession() != null;
+		return app.getNavigationCarAppService() != null;
 	}
 
 	@Override
 	public boolean isUsedByService(@Nullable Service service) {
-		NavigationService navService = service instanceof NavigationService
-				? (NavigationService) service : app.getNavigationService();
-		return navService != null && (navService.getUsedBy() & USED_BY_CAR_APP) != 0;
+		return service instanceof NavigationCarAppService;
 	}
 
 	@Override
diff --git a/OsmAnd/src/net/osmand/plus/auto/NavigationCarAppService.java b/OsmAnd/src/net/osmand/plus/auto/NavigationCarAppService.java
index f60adebc02d..4eea18177db 100644
--- a/OsmAnd/src/net/osmand/plus/auto/NavigationCarAppService.java
+++ b/OsmAnd/src/net/osmand/plus/auto/NavigationCarAppService.java
@@ -1,7 +1,6 @@
 package net.osmand.plus.auto;
 
-import static net.osmand.plus.AppInitEvents.ROUTING_CONFIG_INITIALIZED;
-
+import android.app.Notification;
 import android.content.Intent;
 import android.content.pm.ApplicationInfo;
 import android.net.Uri;
@@ -14,11 +13,8 @@
 import androidx.lifecycle.LifecycleOwner;
 
 import net.osmand.PlatformUtil;
-import net.osmand.plus.AppInitEvents;
-import net.osmand.plus.AppInitializeListener;
-import net.osmand.plus.AppInitializer;
 import net.osmand.plus.OsmandApplication;
-import net.osmand.plus.helpers.RestoreNavigationHelper;
+import net.osmand.plus.notifications.OsmandNotification.NotificationType;
 
 /**
  * Entry point for the templated app.
@@ -45,6 +41,8 @@ public static Uri createDeepLinkUri(@NonNull String deepLinkAction) {
 
 	@Override
 	public int onStartCommand(Intent intent, int flags, int startId) {
+		LOG.info(">>>> NavigationCarAppService - onStartCommand");
+
 		int result = super.onStartCommand(intent, flags, startId);
 		getApp().setNavigationCarAppService(this);
 		return result;
@@ -52,6 +50,8 @@ public int onStartCommand(Intent intent, int flags, int startId) {
 
 	@Override
 	public void onDestroy() {
+		LOG.info(">>>> NavigationCarAppService - onDestroy");
+
 		super.onDestroy();
 		getApp().setNavigationCarAppService(null);
 	}
@@ -59,62 +59,25 @@ public void onDestroy() {
 	@Override
 	@NonNull
 	public Session onCreateSession() {
+		LOG.info(">>>> NavigationCarAppService - onCreateSession");
+
+		OsmandApplication app = getApp();
+		Notification notification = app.getNotificationHelper().buildCarAppNotification();
+		LOG.info(">>>> NavigationCarAppService - startForeground");
+		startForeground(app.getNotificationHelper().getOsmandNotificationId(NotificationType.CAR_APP), notification);
+
 		NavigationSession session = new NavigationSession();
-		getApp().getLocationProvider().addLocationListener(session);
 		session.getLifecycle()
-				.addObserver(
-						new DefaultLifecycleObserver() {
-							@Override
-							public void onCreate(@NonNull LifecycleOwner owner) {
-								getApp().setCarNavigationSession(session);
-								if (!getApp().isAppInForegroundOnRootDevice()) {
-									checkAppInitialization(new RestoreNavigationHelper(getApp(), null));
-								}
-							}
-
-							@Override
-							public void onStart(@NonNull LifecycleOwner owner) {
-								getApp().onCarNavigationSessionStart(session);
-								getApp().getOsmandMap().getMapView().setupRenderingView();
-							}
-
-							@Override
-							public void onStop(@NonNull LifecycleOwner owner) {
-								getApp().getOsmandMap().getMapView().setupRenderingView();
-								getApp().onCarNavigationSessionStop(session);
-							}
-
-							@Override
-							public void onDestroy(@NonNull LifecycleOwner owner) {
-								getApp().setCarNavigationSession(null);
-								getApp().getLocationProvider().removeLocationListener(session);
-							}
-						});
+				.addObserver(new DefaultLifecycleObserver() {
+					@Override
+					public void onDestroy(@NonNull LifecycleOwner owner) {
+						LOG.info(">>>> NavigationCarAppService - stopForeground");
 
-		return session;
-	}
-
-	private void checkAppInitialization(@NonNull RestoreNavigationHelper restoreNavigationHelper) {
-		OsmandApplication app = getApp();
-		if (app.isApplicationInitializing()) {
-			app.getAppInitializer().addListener(new AppInitializeListener() {
-				@Override
-				public void onProgress(@NonNull AppInitializer init, @NonNull AppInitEvents event) {
-					if (event == AppInitEvents.INDEX_REGION_BOUNDARIES) {
-						if (app.getAppInitializer().isRoutingConfigInitialized()) {
-							restoreNavigationHelper.checkRestoreRoutingMode();
-						}
+						stopForeground(STOP_FOREGROUND_REMOVE);
 					}
-					if (event == ROUTING_CONFIG_INITIALIZED) {
-						if (app.getRegions() != null) {
-							restoreNavigationHelper.checkRestoreRoutingMode();
-						}
-					}
-				}
-			});
-		} else {
-			restoreNavigationHelper.checkRestoreRoutingMode();
-		}
+				});
+
+		return session;
 	}
 
 	@NonNull
diff --git a/OsmAnd/src/net/osmand/plus/auto/NavigationSession.java b/OsmAnd/src/net/osmand/plus/auto/NavigationSession.java
index a235f0b9edc..cdd98672ba4 100644
--- a/OsmAnd/src/net/osmand/plus/auto/NavigationSession.java
+++ b/OsmAnd/src/net/osmand/plus/auto/NavigationSession.java
@@ -1,7 +1,10 @@
 package net.osmand.plus.auto;
 
 import static androidx.car.app.CarContext.ACTION_NAVIGATE;
+import static net.osmand.plus.AppInitEvents.ROUTING_CONFIG_INITIALIZED;
 import static net.osmand.plus.NavigationService.DEEP_LINK_ACTION_OPEN_ROOT_SCREEN;
+import static net.osmand.plus.OsmAndLocationProvider.NOT_SWITCH_TO_NETWORK_WHEN_GPS_LOST_MS;
+import static net.osmand.plus.OsmAndLocationProvider.isRunningOnEmulator;
 
 import android.Manifest;
 import android.content.Intent;
@@ -9,6 +12,7 @@
 import android.content.res.Configuration;
 import android.net.Uri;
 import android.util.Log;
+import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -19,6 +23,11 @@
 import androidx.car.app.Session;
 import androidx.car.app.model.Action;
 import androidx.car.app.model.CarIcon;
+import androidx.car.app.navigation.NavigationManager;
+import androidx.car.app.navigation.NavigationManagerCallback;
+import androidx.car.app.navigation.model.Destination;
+import androidx.car.app.navigation.model.TravelEstimate;
+import androidx.car.app.navigation.model.Trip;
 import androidx.core.app.ActivityCompat;
 import androidx.core.graphics.drawable.IconCompat;
 import androidx.lifecycle.DefaultLifecycleObserver;
@@ -27,10 +36,15 @@
 import androidx.lifecycle.LifecycleOwner;
 
 import net.osmand.Location;
+import net.osmand.PlatformUtil;
+import net.osmand.StateChangedListener;
 import net.osmand.data.LatLon;
 import net.osmand.data.PointDescription;
 import net.osmand.data.ValueHolder;
-import net.osmand.plus.NavigationService;
+import net.osmand.plus.AppInitEvents;
+import net.osmand.plus.AppInitializeListener;
+import net.osmand.plus.AppInitializer;
+import net.osmand.plus.OsmAndLocationProvider;
 import net.osmand.plus.OsmAndLocationProvider.OsmAndLocationListener;
 import net.osmand.plus.OsmandApplication;
 import net.osmand.plus.R;
@@ -42,11 +56,15 @@
 import net.osmand.plus.auto.screens.RoutePreviewScreen;
 import net.osmand.plus.auto.screens.SearchResultsScreen;
 import net.osmand.plus.auto.screens.SettingsScreen;
+import net.osmand.plus.helpers.LocationCallback;
+import net.osmand.plus.helpers.LocationServiceHelper;
+import net.osmand.plus.helpers.RestoreNavigationHelper;
 import net.osmand.plus.inapp.InAppPurchaseUtils;
 import net.osmand.plus.routing.IRouteInformationListener;
 import net.osmand.plus.routing.RoutingHelper;
 import net.osmand.plus.settings.backend.ApplicationMode;
 import net.osmand.plus.settings.backend.OsmandSettings;
+import net.osmand.plus.settings.enums.LocationSource;
 import net.osmand.plus.simulation.OsmAndLocationSimulation;
 import net.osmand.plus.views.OsmandMapTileView;
 import net.osmand.search.core.ObjectType;
@@ -55,6 +73,7 @@
 import net.osmand.util.GeoParsedPoint;
 import net.osmand.util.GeoPointParserUtil;
 
+import java.util.Collections;
 import java.util.List;
 
 /**
@@ -63,6 +82,8 @@
 public class NavigationSession extends Session implements NavigationListener, OsmAndLocationListener,
 		DefaultLifecycleObserver, IRouteInformationListener {
 
+	private static final org.apache.commons.logging.Log LOG = PlatformUtil.getLog(NavigationSession.class);
+
 	static final String TAG = NavigationSession.class.getSimpleName();
 	static final String URI_SCHEME = "osmand";
 	static final String URI_HOST = "car_navigation";
@@ -82,6 +103,9 @@ public class NavigationSession extends Session implements NavigationListener, Os
 	 */
 	public static final float ZOOM_OUT_BUTTON_SCALE_FACTOR = 0.9f;
 
+	private OsmandSettings settings;
+	private RoutingHelper routingHelper;
+
 	NavigationScreen navigationScreen;
 	LandingScreen landingScreen;
 
@@ -92,6 +116,16 @@ public class NavigationSession extends Session implements NavigationListener, Os
 	private OsmandMapTileView mapView;
 	private ApplicationMode defaultAppMode;
 
+	private OsmAndLocationProvider locationProvider;
+	private LocationServiceHelper locationServiceHelper;
+	private StateChangedListener<LocationSource> locationSourceListener;
+	private long lastTimeGPSLocationFixed;
+
+	private CarContext carContext;
+	private NavigationManager navigationManager;
+	private boolean carNavigationActive;
+	private TripHelper tripHelper;
+
 	NavigationSession() {
 		getLifecycle().addObserver(this);
 	}
@@ -113,8 +147,7 @@ public OsmandMapTileView getMapView() {
 		return mapView;
 	}
 
-	private final LocationPermissionCheckCallback locationPermissionGrantedCallback =
-			() -> getApp().startNavigationService(getCarContext(), NavigationService.USED_BY_CAR_APP);
+	private final LocationPermissionCheckCallback locationPermissionGrantedCallback = this::requestLocationUpdates;
 
 	public void setMapView(OsmandMapTileView mapView) {
 		this.mapView = mapView;
@@ -128,16 +161,37 @@ private OsmandApplication getApp() {
 		return (OsmandApplication) getCarContext().getApplicationContext();
 	}
 
+	@Override
+	public void onCreate(@NonNull LifecycleOwner owner) {
+		LOG.info(">>>> NavigationSession - onCreate");
+
+		OsmandApplication app = getApp();
+		settings = app.getSettings();
+		routingHelper = app.getRoutingHelper();
+		locationProvider = app.getLocationProvider();
+		locationServiceHelper = app.createLocationServiceHelper();
+
+		app.setCarNavigationSession(this);
+		app.getLocationProvider().addLocationListener(this);
+		setCarContext(getCarContext());
+		requestLocationUpdates();
+		addLocationSourceListener();
+	}
+
 	@Override
 	public void onStart(@NonNull LifecycleOwner owner) {
-		getApp().getRoutingHelper().addListener(this);
+		LOG.info(">>>> NavigationSession - onStart");
+
+		OsmandApplication app = getApp();
+		routingHelper.addListener(this);
 
-		OsmandSettings settings = getApp().getSettings();
 		defaultAppMode = settings.getApplicationMode();
 		if (!isAppModeDerivedFromCar(defaultAppMode)) {
-			List<ApplicationMode> availableAppModes = ApplicationMode.values(getApp());
+			List<ApplicationMode> availableAppModes = ApplicationMode.values(app);
 			for (ApplicationMode availableAppMode : availableAppModes) {
 				if (isAppModeDerivedFromCar(availableAppMode)) {
+					LOG.info(">>>> Set app mode = " + availableAppMode.getStringKey());
+
 					settings.setApplicationMode(availableAppMode);
 					break;
 				}
@@ -146,38 +200,57 @@ public void onStart(@NonNull LifecycleOwner owner) {
 		if (navigationCarSurface != null) {
 			navigationCarSurface.handleRecenter();
 		}
-	}
 
-	private boolean isAppModeDerivedFromCar(ApplicationMode appMode) {
-		return appMode == ApplicationMode.CAR || appMode.isDerivedRoutingFrom(ApplicationMode.CAR);
+		app.onCarNavigationSessionStart(this);
+		app.getOsmandMap().getMapView().setupRenderingView();
+
+		if (!app.isAppInForegroundOnRootDevice()) {
+			LOG.info(">>>> checkAppInitialization");
+			checkAppInitialization(new RestoreNavigationHelper(app, null));
+		}
 	}
 
 	@Override
 	public void onStop(@NonNull LifecycleOwner owner) {
-		OsmandApplication app = getApp();
-		OsmandSettings settings = app.getSettings();
-		RoutingHelper routingHelper = app.getRoutingHelper();
+		LOG.info(">>>> NavigationSession - onStop");
 
+		OsmandApplication app = getApp();
 		routingHelper.removeListener(this);
 		boolean routing = settings.FOLLOW_THE_ROUTE.get() || routingHelper.isRouteCalculated() || routingHelper.isRouteBeingCalculated();
 		if (defaultAppMode != null && !routing) {
 			settings.setApplicationMode(defaultAppMode);
 		}
 		defaultAppMode = null;
+
+		app.getOsmandMap().getMapView().setupRenderingView();
+		app.onCarNavigationSessionStop(this);
 	}
 
 	@Override
 	public void onDestroy(@NonNull LifecycleOwner owner) {
+		LOG.info(">>>> NavigationSession - onDestroy");
+
+		OsmandApplication app = getApp();
+		removeLocationUpdates();
+		removeLocationSourceListener();
+
 		getLifecycle().removeObserver(this);
-		OsmandSettings settings = getApp().getSettings();
 		if (settings.simulateNavigationStartedFromAdb) {
 			settings.simulateNavigation = false;
-			OsmAndLocationSimulation locationSimulation = getApp().getLocationProvider().getLocationSimulation();
+			OsmAndLocationSimulation locationSimulation = app.getLocationProvider().getLocationSimulation();
 			if (locationSimulation.isRouteAnimating() || locationSimulation.isLoadingRouteLocations()) {
 				locationSimulation.stop();
 			}
 		}
-		getApp().getSettings().simulateNavigationStartedFromAdb = false;
+		settings.simulateNavigationStartedFromAdb = false;
+
+		clearCarContext();
+		app.getLocationProvider().removeLocationListener(this);
+		app.setCarNavigationSession(null);
+	}
+
+	private boolean isAppModeDerivedFromCar(ApplicationMode appMode) {
+		return appMode == ApplicationMode.CAR || appMode.isDerivedRoutingFrom(ApplicationMode.CAR);
 	}
 
 	public boolean hasStarted() {
@@ -313,7 +386,6 @@ private void processDeepLinkActions(@NonNull Uri uri) {
 			ScreenManager screenManager = getCarContext().getCarService(ScreenManager.class);
 			Screen top = screenManager.getTop();
 
-			RoutingHelper routingHelper = getApp().getRoutingHelper();
 			boolean followingMode = routingHelper.isFollowingMode();
 			boolean routeCalculated = routingHelper.isRouteCalculated();
 			boolean pauseNavigation = routingHelper.isPauseNavigation();
@@ -365,7 +437,10 @@ private void clearNavigationScreen() {
 
 	@Override
 	public void updateLocation(Location location) {
-		navigationCarSurface.updateLocation(location);
+		SurfaceRenderer navigationCarSurface = this.navigationCarSurface;
+		if (navigationCarSurface != null) {
+			navigationCarSurface.updateLocation(location);
+		}
 	}
 
 	@Override
@@ -381,4 +456,212 @@ public void routeWasCancelled() {
 	public void routeWasFinished() {
 		getApp().stopNavigation();
 	}
+
+	private void addLocationSourceListener() {
+		OsmandApplication app = getApp();
+		locationSourceListener = change -> {
+			removeLocationUpdates();
+			locationServiceHelper = app.createLocationServiceHelper();
+			requestLocationUpdates();
+		};
+		settings.LOCATION_SOURCE.addListener(locationSourceListener);
+	}
+
+	private void removeLocationSourceListener() {
+		settings.LOCATION_SOURCE.removeListener(locationSourceListener);
+	}
+
+	private void requestLocationUpdates() {
+		try {
+			locationServiceHelper.requestLocationUpdates(new LocationCallback() {
+				@Override
+				public void onLocationResult(@NonNull List<Location> locations) {
+					if (!locations.isEmpty()) {
+						Location location = locations.get(locations.size() - 1);
+						lastTimeGPSLocationFixed = System.currentTimeMillis();
+						locationProvider.setLocationFromService(location);
+					}
+				}
+			});
+			// try to always ask for network provide : it is faster way to find location
+			if (locationServiceHelper.isNetworkLocationUpdatesSupported()) {
+				locationServiceHelper.requestNetworkLocationUpdates(new LocationCallback() {
+					@Override
+					public void onLocationResult(@NonNull List<net.osmand.Location> locations) {
+						if (!locations.isEmpty() && !useOnlyGPS()) {
+							locationProvider.setLocationFromService(locations.get(locations.size() - 1));
+						}
+					}
+				});
+			}
+		} catch (SecurityException e) {
+			Toast.makeText(getCarContext(), R.string.no_location_permission, Toast.LENGTH_LONG).show();
+		} catch (IllegalArgumentException e) {
+			Toast.makeText(getCarContext(), R.string.gps_not_available, Toast.LENGTH_LONG).show();
+		}
+	}
+
+	private void removeLocationUpdates() {
+		if (locationServiceHelper != null) {
+			try {
+				locationServiceHelper.removeLocationUpdates();
+			} catch (SecurityException e) {
+				// Location service permission not granted
+			} finally {
+				lastTimeGPSLocationFixed = 0;
+			}
+		}
+	}
+
+	private boolean useOnlyGPS() {
+		if (routingHelper.isFollowingMode()) {
+			return true;
+		}
+		if (lastTimeGPSLocationFixed > 0 && (System.currentTimeMillis() - lastTimeGPSLocationFixed) < NOT_SWITCH_TO_NETWORK_WHEN_GPS_LOST_MS) {
+			return true;
+		}
+		return isRunningOnEmulator();
+	}
+
+	/**
+	 * Sets the {@link CarContext} to use while the service is running.
+	 */
+	public void setCarContext(@Nullable CarContext carContext) {
+		this.carContext = carContext;
+		if (carContext != null) {
+			this.tripHelper = new TripHelper(getApp());
+			this.navigationManager = carContext.getCarService(NavigationManager.class);
+			this.navigationManager.setNavigationManagerCallback(new NavigationManagerCallback() {
+				@Override
+				public void onStopNavigation() {
+					if (routingHelper.isRouteCalculated() && routingHelper.isFollowingMode()) {
+						routingHelper.pauseNavigation();
+					} else {
+						getApp().stopNavigation();
+					}
+				}
+
+				@Override
+				public void onAutoDriveEnabled() {
+					CarToast.makeText(carContext, "Auto drive enabled", CarToast.LENGTH_LONG).show();
+					if (!settings.simulateNavigation) {
+						OsmAndLocationSimulation sim = getApp().getLocationProvider().getLocationSimulation();
+						sim.startStopRouteAnimation(null);
+						settings.simulateNavigation = true;
+						settings.simulateNavigationStartedFromAdb = true;
+					}
+				}
+			});
+			// Uncomment if navigating
+			// mNavigationManager.navigationStarted();
+		} else {
+			this.navigationManager = null;
+		}
+	}
+
+	/**
+	 * Clears the currently used {@link CarContext}.
+	 */
+	public void clearCarContext() {
+		carContext = null;
+		if (navigationManager != null) {
+			navigationManager.clearNavigationManagerCallback();
+		}
+		navigationManager = null;
+		tripHelper = null;
+	}
+
+	/**
+	 * Starts navigation.
+	 */
+	public void startCarNavigation() {
+		if (navigationManager != null) {
+			navigationManager.navigationStarted();
+			carNavigationActive = true;
+		}
+	}
+
+	/**
+	 * Stops navigation.
+	 */
+	public void stopCarNavigation() {
+		getApp().runInUIThread(() -> {
+					if (navigationManager != null) {
+						NavigationSession carNavigationSession = getApp().getCarNavigationSession();
+						if (carNavigationSession != null) {
+							NavigationScreen navigationScreen = carNavigationSession.getNavigationScreen();
+							if (navigationScreen != null) {
+								navigationScreen.stopTrip();
+							}
+						}
+						carNavigationActive = false;
+						navigationManager.navigationEnded();
+					}
+				}
+		);
+	}
+
+	public void updateCarNavigation(Location currentLocation) {
+		OsmandApplication app = getApp();
+		TripHelper tripHelper = this.tripHelper;
+		if (carNavigationActive && navigationManager != null && tripHelper != null
+				&& routingHelper.isRouteCalculated() && routingHelper.isFollowingMode()) {
+			NavigationSession carNavigationSession = app.getCarNavigationSession();
+			if (carNavigationSession != null) {
+				NavigationScreen navigationScreen = carNavigationSession.getNavigationScreen();
+				if (navigationScreen == null) {
+					carNavigationSession.startNavigation();
+					navigationScreen = carNavigationSession.getNavigationScreen();
+				}
+				if (navigationScreen != null) {
+					float density = carNavigationSession.getNavigationCarSurface().getDensity();
+					if (density == 0) {
+						density = 1;
+					}
+					Trip trip = tripHelper.buildTrip(currentLocation, density);
+					navigationManager.updateTrip(trip);
+
+					List<Destination> destinations = null;
+					Destination destination = tripHelper.getLastDestination();
+					TravelEstimate destinationTravelEstimate = tripHelper.getLastDestinationTravelEstimate();
+					if (destination != null) {
+						destinations = Collections.singletonList(destination);
+					}
+					TravelEstimate lastStepTravelEstimate = tripHelper.getLastStepTravelEstimate();
+					navigationScreen.updateTrip(true, routingHelper.isRouteBeingCalculated(),
+							false/*routingHelper.isRouteWasFinished()*/,
+							destinations, trip.getSteps(), destinationTravelEstimate,
+							lastStepTravelEstimate != null ? lastStepTravelEstimate.getRemainingDistance() : null,
+							true, true, null);
+				}
+			}
+		}
+	}
+
+	public boolean isCarNavigationActive() {
+		return carNavigationActive;
+	}
+
+	private void checkAppInitialization(@NonNull RestoreNavigationHelper restoreNavigationHelper) {
+		OsmandApplication app = getApp();
+		if (app.isApplicationInitializing()) {
+			app.getAppInitializer().addListener(new AppInitializeListener() {
+				@Override
+				public void onProgress(@NonNull AppInitializer init, @NonNull AppInitEvents event) {
+					if (event == AppInitEvents.INDEX_REGION_BOUNDARIES) {
+						if (app.getAppInitializer().isRoutingConfigInitialized()) {
+							restoreNavigationHelper.checkRestoreRoutingMode();
+						}
+					}
+					if (event == ROUTING_CONFIG_INITIALIZED) {
+						if (app.getRegions() != null) {
+							restoreNavigationHelper.checkRestoreRoutingMode();
+						}
+					}
+				}
+			});
+		} else {
+			restoreNavigationHelper.checkRestoreRoutingMode();
+		}
+	}
 }
diff --git a/OsmAnd/src/net/osmand/plus/download/DownloadService.java b/OsmAnd/src/net/osmand/plus/download/DownloadService.java
index 047e43342c2..b5052d98573 100644
--- a/OsmAnd/src/net/osmand/plus/download/DownloadService.java
+++ b/OsmAnd/src/net/osmand/plus/download/DownloadService.java
@@ -73,7 +73,7 @@ public void onDestroy() {
 		app.setDownloadService(null);
 
 		// remove notification
-		stopForeground(Boolean.TRUE);
+		stopForeground(STOP_FOREGROUND_REMOVE);
 		app.getNotificationHelper().refreshNotification(NotificationType.DOWNLOAD);
 		app.runInUIThread(() -> app.getNotificationHelper().refreshNotification(NotificationType.DOWNLOAD), 500);
 	}
diff --git a/OsmAnd/src/net/osmand/plus/helpers/RestoreNavigationHelper.java b/OsmAnd/src/net/osmand/plus/helpers/RestoreNavigationHelper.java
index 5cc20453378..cd6650da270 100644
--- a/OsmAnd/src/net/osmand/plus/helpers/RestoreNavigationHelper.java
+++ b/OsmAnd/src/net/osmand/plus/helpers/RestoreNavigationHelper.java
@@ -122,6 +122,7 @@ private GPXRouteParamsBuilder createGpxRouteParams(@Nullable GPXFile gpxFile) {
 
 	public void enterRoutingMode(@Nullable GPXRouteParamsBuilder gpxRoute) {
 		app.logRoutingEvent("enterRoutingMode gpxRoute " + gpxRoute);
+		LOG.info(">>>> RESTORE ROUTE - enterRoutingMode");
 
 		app.getMapViewTrackingUtilities().backToLocationImpl();
 		settings.FOLLOW_THE_GPX_ROUTE.set(gpxRoute != null ? gpxRoute.getFile().path : null);
diff --git a/OsmAnd/src/net/osmand/plus/notifications/NotificationHelper.java b/OsmAnd/src/net/osmand/plus/notifications/NotificationHelper.java
index cc2e2396d1b..db4f7a87ea1 100644
--- a/OsmAnd/src/net/osmand/plus/notifications/NotificationHelper.java
+++ b/OsmAnd/src/net/osmand/plus/notifications/NotificationHelper.java
@@ -74,11 +74,14 @@ public Notification buildDownloadNotification() {
 		return downloadNotification.buildNotification(null, false).build();
 	}
 
+	@NonNull
+	public Notification buildCarAppNotification() {
+		return carAppNotification.buildNotification(null, false).build();
+	}
+
 	@Nullable
 	private OsmandNotification acquireTopNotification(@Nullable Service service) {
-		if (carAppNotification.isEnabled(service)) {
-			return carAppNotification;
-		} else if (navigationNotification.isEnabled(service)) {
+		if (navigationNotification.isEnabled(service)) {
 			return navigationNotification;
 		} else if (gpxNotification.isEnabled(service)) {
 			return gpxNotification;
@@ -125,6 +128,15 @@ public void onNotificationDismissed(NotificationType notificationType) {
 		}
 	}
 
+	public int getOsmandNotificationId(NotificationType notificationType) {
+		for (OsmandNotification notification : all) {
+			if (notification.getType() == notificationType) {
+				return notification.getOsmandNotificationId();
+			}
+		}
+		return -1;
+	}
+
 	public boolean hasAnyTopNotification() {
 		for (OsmandNotification notification : all) {
 			if (notification.isTop()) {
diff --git a/OsmAnd/src/net/osmand/plus/notifications/OsmandNotification.java b/OsmAnd/src/net/osmand/plus/notifications/OsmandNotification.java
index cc0f5205bea..5916bc57ff3 100644
--- a/OsmAnd/src/net/osmand/plus/notifications/OsmandNotification.java
+++ b/OsmAnd/src/net/osmand/plus/notifications/OsmandNotification.java
@@ -167,13 +167,9 @@ public boolean refreshNotification() {
 				return true;
 			} else {
 				notificationManager.cancel(getOsmandNotificationId());
-				// there could be a different primary notification, so additionally clear CAR_APP explicitly
-				notificationManager.cancel(CAR_APP_NOTIFICATION_SERVICE_ID);
 			}
 		} else {
 			notificationManager.cancel(getOsmandNotificationId());
-			// there could be a different primary notification, so additionally clear CAR_APP explicitly
-			notificationManager.cancel(CAR_APP_NOTIFICATION_SERVICE_ID);
 		}
 		return false;
 	}
diff --git a/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java b/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
index b0612f2d205..9a75fbd1c87 100644
--- a/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
+++ b/OsmAnd/src/net/osmand/plus/routing/RoutingHelper.java
@@ -83,7 +83,6 @@ public class RoutingHelper {
 	private long deviateFromRouteDetected;
 	//private long wrongMovementDetected = 0;
 	private boolean voiceRouterStopped;
-	private long lastCarNavUpdateTime;
 
 	public boolean isDeviatedFromRoute() {
 		return isDeviatedFromRoute;
@@ -630,10 +629,8 @@ private boolean updateCurrentRouteStatus(Location currentLocation, double posTol
 
 		// 5. Update car navigation
 		NavigationSession carNavigationSession = app.getCarNavigationSession();
-		NavigationService navigationService = app.getNavigationService();
-		if (carNavigationSession != null && navigationService != null && System.currentTimeMillis() - lastCarNavUpdateTime > 1000) {
-			lastCarNavUpdateTime = System.currentTimeMillis();
-			app.runInUIThread(() -> navigationService.updateCarNavigation(currentLocation));
+		if (carNavigationSession != null) {
+			app.runInUIThread(() -> carNavigationSession.updateCarNavigation(currentLocation));
 		}
 		return false;
 	}
