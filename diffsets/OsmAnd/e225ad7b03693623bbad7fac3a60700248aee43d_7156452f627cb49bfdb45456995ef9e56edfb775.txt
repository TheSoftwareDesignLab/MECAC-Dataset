diff --git a/OsmAnd-java/src/main/java/net/osmand/GPXUtilities.java b/OsmAnd-java/src/main/java/net/osmand/GPXUtilities.java
index f3cb0f8b84b..6eb20d0f154 100644
--- a/OsmAnd-java/src/main/java/net/osmand/GPXUtilities.java
+++ b/OsmAnd-java/src/main/java/net/osmand/GPXUtilities.java
@@ -957,6 +957,24 @@ private static List<GPXTrackAnalysis> convert(List<SplitSegment> splitSegments)
 		return ls;
 	}
 
+	public static QuadRect calculateBounds(List<WptPt> pts) {
+		QuadRect trackBounds = new QuadRect(Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY,
+				Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY);
+		updateBounds(trackBounds, pts, 0);
+
+		return trackBounds;
+	}
+
+	public static void updateBounds(QuadRect trackBounds, List<WptPt> pts, int startIndex) {
+		for (int i = startIndex; i < pts.size(); i++) {
+			WptPt pt = pts.get(i);
+			trackBounds.right = Math.max(trackBounds.right, pt.lon);
+			trackBounds.left = Math.min(trackBounds.left, pt.lon);
+			trackBounds.top = Math.max(trackBounds.top, pt.lat);
+			trackBounds.bottom = Math.min(trackBounds.bottom, pt.lat);
+		}
+	}
+
 	public static class GPXFile extends GPXExtensions {
 		public String author;
 		public Metadata metadata;
diff --git a/OsmAnd/src/net/osmand/data/PointDescription.java b/OsmAnd/src/net/osmand/data/PointDescription.java
index 79b4cfe9e78..30576785263 100644
--- a/OsmAnd/src/net/osmand/data/PointDescription.java
+++ b/OsmAnd/src/net/osmand/data/PointDescription.java
@@ -289,6 +289,10 @@ public boolean isCustomPoiFilter() {
 		return POINT_TYPE_CUSTOM_POI_FILTER.equals(type);
 	}
 
+	public boolean isGpxPoint() {
+		return POINT_TYPE_GPX.equals(type);
+	}
+
 	@Override
 	public int hashCode() {
 		final int prime = 31;
diff --git a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
index 9bc9d3e24b7..e1b80ebf539 100644
--- a/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
+++ b/OsmAnd/src/net/osmand/plus/activities/MapActivity.java
@@ -673,6 +673,11 @@ public void onBackPressed() {
 		}
 		if (trackDetailsMenu.isVisible()) {
 			trackDetailsMenu.hide(true);
+			if (mapContextMenu.isActive() && mapContextMenu.getPointDescription() != null
+					&& mapContextMenu.getPointDescription().isGpxPoint()) {
+				mapContextMenu.show();
+				return;
+			}
 			if (prevActivityIntent == null) {
 				return;
 			}
diff --git a/OsmAnd/src/net/osmand/plus/views/GPXLayer.java b/OsmAnd/src/net/osmand/plus/views/GPXLayer.java
index ee73e581c99..ad6f8b89dbf 100644
--- a/OsmAnd/src/net/osmand/plus/views/GPXLayer.java
+++ b/OsmAnd/src/net/osmand/plus/views/GPXLayer.java
@@ -604,8 +604,8 @@ public void getTracksFromPoint(RotatedTileBox tb, PointF point, List<Object> res
 		for (SelectedGpxFile selectedGpxFile : selectedGpxFiles) {
 			List<TrkSegment> segments = selectedGpxFile.getPointsToDisplay();
 			for (TrkSegment segment : segments) {
-				boolean nearSegment = isPointNearSegment(tb, segment.points, r, mx, my);
-				if (nearSegment) {
+				QuadRect trackBounds = GPXUtilities.calculateBounds(segment.points);
+				if (QuadRect.trivialOverlap(tb.getLatLonBounds(), trackBounds) && isPointNearSegment(tb, segment.points, r, mx, my)) {
 					res.add(selectedGpxFile);
 					break;
 				}
diff --git a/OsmAnd/src/net/osmand/plus/views/Renderable.java b/OsmAnd/src/net/osmand/plus/views/Renderable.java
index 5204ca9332e..e8bd0e75be8 100644
--- a/OsmAnd/src/net/osmand/plus/views/Renderable.java
+++ b/OsmAnd/src/net/osmand/plus/views/Renderable.java
@@ -5,6 +5,7 @@
 
 import androidx.annotation.NonNull;
 
+import net.osmand.GPXUtilities;
 import net.osmand.GPXUtilities.WptPt;
 import net.osmand.data.QuadRect;
 import net.osmand.data.RotatedTileBox;
@@ -61,10 +62,10 @@ public static abstract class RenderableSegment {
         protected AsynchronousResampler culler = null;                        // The currently active resampler
         protected Paint paint = null;                               // MUST be set by 'updateLocalPaint' before use
 
-        public RenderableSegment(List <WptPt> points, double segmentSize) {
+        public RenderableSegment(List<WptPt> points, double segmentSize) {
             this.points = points;
-            calculateBounds(points);
             this.segmentSize = segmentSize;
+            trackBounds = GPXUtilities.calculateBounds(points);
         }
 
         protected void updateLocalPaint(Paint p) {
@@ -90,23 +91,6 @@ public void drawSegment(double zoom, Paint p, Canvas canvas, RotatedTileBox tile
             }
         }
 
-        private void calculateBounds(List<WptPt> pts) {
-            trackBounds = new QuadRect(Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY,
-                    Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY);
-            updateBounds(pts, 0);
-        }
-
-        protected void updateBounds(List<WptPt> pts, int startIndex) {
-            pointSize = pts.size();
-            for (int i = startIndex; i < pointSize; i++) {
-                WptPt pt = pts.get(i);
-                trackBounds.right = Math.max(trackBounds.right, pt.lon);
-                trackBounds.left = Math.min(trackBounds.left, pt.lon);
-                trackBounds.top = Math.max(trackBounds.top, pt.lat);
-                trackBounds.bottom = Math.min(trackBounds.bottom, pt.lat);
-            }
-        }
-
         public void setRDP(List<WptPt> cull) {
             culled = cull;
         }
@@ -198,7 +182,9 @@ public CurrentTrack(List<WptPt> pt) {
 
         @Override public void drawSegment(double zoom, Paint p, Canvas canvas, RotatedTileBox tileBox) {
             if (points.size() != pointSize) {
-                updateBounds(points, pointSize);
+                int prevSize = pointSize;
+                pointSize = points.size();
+                GPXUtilities.updateBounds(trackBounds, points, prevSize);
             }
             drawSingleSegment(zoom, p, canvas, tileBox);
         }
