diff --git a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
index ab03574f923..1cdddd794c2 100644
--- a/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapcontextmenu/MapContextMenuFragment.java
@@ -565,6 +565,7 @@ private void changeMenuState(int currentY, boolean skipHalfScreenState,
 		boolean needMapAdjust = oldMenuState != newMenuState && newMenuState != MenuState.FULL_SCREEN;
 
 		if (newMenuState != oldMenuState) {
+			restoreCustomMapRatio();
 			menu.updateControlsVisibility(true);
 			doBeforeMenuStateChange(oldMenuState, newMenuState);
 		}
@@ -572,20 +573,39 @@ private void changeMenuState(int currentY, boolean skipHalfScreenState,
 		applyPosY(currentY, needCloseMenu, needMapAdjust, oldMenuState, newMenuState, 0);
 	}
 
+	private void restoreCustomMapRatio() {
+		if (map.hasCustomMapRatio()) {
+			map.restoreMapRatio();
+		}
+	}
+
+	private void setCustomMapRatio() {
+		LatLon latLon = menu.getLatLon();
+		RotatedTileBox tb = map.getCurrentRotatedTileBox().copy();
+		float px = tb.getPixXFromLatLon(latLon.getLatitude(), latLon.getLongitude());
+		float py = tb.getPixYFromLatLon(latLon.getLatitude(), latLon.getLongitude());
+		float ratioX = px / tb.getPixWidth();
+		float ratioY = py / tb.getPixHeight();
+		map.setCustomMapRatio(ratioX, ratioY);
+		map.setLatLon(latLon.getLatitude(), latLon.getLongitude());
+	}
+
 	public void doZoomIn() {
-		if (!centered) {
-			centered = true;
-			calculateCenterLatLon(menu.getLatLon(), getZoom() + 1, true);
+		if (map.isZooming() && map.hasCustomMapRatio()) {
+			getMapActivity().changeZoom(2, System.currentTimeMillis());
+		} else {
+			if (!map.hasCustomMapRatio()) {
+				setCustomMapRatio();
+			}
+			getMapActivity().changeZoom(1, System.currentTimeMillis());
 		}
-		applyPosY(getViewY(), false, true, 0, 0, 1);
 	}
 
 	public void doZoomOut() {
-		if (!centered) {
-			centered = true;
-			calculateCenterLatLon(menu.getLatLon(), getZoom() - 1, true);
+		if (!map.hasCustomMapRatio()) {
+			setCustomMapRatio();
 		}
-		applyPosY(getViewY(), false, true, 0, 0, -1);
+		getMapActivity().changeZoom(-1, System.currentTimeMillis());
 	}
 
 	private void applyPosY(final int currentY, final boolean needCloseMenu, boolean needMapAdjust,
@@ -859,6 +879,8 @@ public void onResume() {
 
 	@Override
 	public void onPause() {
+		restoreCustomMapRatio();
+
 		ViewParent parent = view.getParent();
 		if (parent != null && containerLayoutListener != null) {
 			((View) parent).removeOnLayoutChangeListener(containerLayoutListener);
diff --git a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
index 79aa23f4345..230ff660c73 100644
--- a/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
+++ b/OsmAnd/src/net/osmand/plus/views/OsmandMapTileView.java
@@ -124,9 +124,12 @@ public int getDefaultColor() {
 	private float rotate; // accumulate
 
 	private int mapPosition;
-
 	private int mapPositionX;
 
+	private float mapRatioX;
+	private float mapRatioY;
+	private LatLon originalRatioCenterLatLon;
+
 	private boolean showMapPosition = true;
 
 	private IMapLocationListener locationListener;
@@ -488,6 +491,25 @@ public void setMapPositionX(int type) {
 		this.mapPositionX = type;
 	}
 
+	public void setCustomMapRatio(float ratioX, float ratioY) {
+		this.mapRatioX = ratioX;
+		this.mapRatioY = ratioY;
+		originalRatioCenterLatLon = currentViewport.getCenterLatLon();
+	}
+
+	public void restoreMapRatio() {
+		mapRatioX = 0;
+		mapRatioY = 0;
+		if (originalRatioCenterLatLon != null) {
+			setLatLon(originalRatioCenterLatLon.getLatitude(), originalRatioCenterLatLon.getLongitude());
+			originalRatioCenterLatLon = null;
+		}
+	}
+
+	public boolean hasCustomMapRatio() {
+		return mapRatioX != 0 && mapRatioY != 0;
+	}
+
 	public OsmandSettings getSettings() {
 		return settings;
 	}
@@ -576,7 +598,9 @@ private void refreshMapInternal(DrawSettings drawSettings) {
 			return;
 		}
 		final float ratioy;
-		if (mapPosition == OsmandSettings.BOTTOM_CONSTANT) {
+		if (mapRatioY != 0) {
+			ratioy = mapRatioY;
+		} else if (mapPosition == OsmandSettings.BOTTOM_CONSTANT) {
 			ratioy = 0.85f;
 		} else if (mapPosition == OsmandSettings.MIDDLE_BOTTOM_CONSTANT) {
 			ratioy = 0.70f;
@@ -586,7 +610,9 @@ private void refreshMapInternal(DrawSettings drawSettings) {
 			ratioy = 0.5f;
 		}
 		final float ratiox;
-		if (mapPosition == OsmandSettings.LANDSCAPE_MIDDLE_RIGHT_CONSTANT) {
+		if (mapRatioX != 0) {
+			ratiox = mapRatioX;
+		} else if (mapPosition == OsmandSettings.LANDSCAPE_MIDDLE_RIGHT_CONSTANT) {
 			ratiox = 0.7f;
 		} else {
 			ratiox = mapPositionX == 0 ? 0.5f : 0.75f;
