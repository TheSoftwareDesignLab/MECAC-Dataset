diff --git a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
index 0833c220a1d..79d10118e68 100644
--- a/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
+++ b/OsmAnd/src/net/osmand/plus/search/dialogs/QuickSearchHistoryListFragment.java
@@ -8,6 +8,7 @@
 
 import androidx.annotation.LayoutRes;
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import androidx.fragment.app.FragmentManager;
 
 import net.osmand.data.Amenity;
@@ -25,6 +26,7 @@
 import net.osmand.search.SearchUICore;
 import net.osmand.search.core.SearchCoreFactory;
 import net.osmand.search.core.SearchPhrase;
+import net.osmand.search.core.SearchResult;
 
 import java.util.List;
 
@@ -92,9 +94,11 @@ public void onActivityCreated(Bundle savedInstanceState) {
 			FragmentManager fragmentManager = dialogFragment.getFragmentManager();
 			if (fragmentManager != null && index >= 0 && index < getListAdapter().getCount()) {
 				QuickSearchListItem item = getListAdapter().getItem(index);
-				if (item != null && item.getSearchResult().object instanceof HistoryEntry) {
-					HistoryEntry entry = (HistoryEntry) item.getSearchResult().object;
-					HistoryItemsFragment.showInstance(fragmentManager, entry.getSource(), dialogFragment);
+				if (item != null) {
+					HistoryEntry entry = getEntryFromSearchItem(item);
+					if (entry != null) {
+						HistoryItemsFragment.showInstance(fragmentManager, entry.getSource(), dialogFragment);
+					}
 				}
 			}
 			return true;
@@ -112,6 +116,19 @@ public void reloadData() {
 		});
 	}
 
+	@Nullable
+	private HistoryEntry getEntryFromSearchItem(@NonNull QuickSearchListItem item) {
+		SearchResult searchResult = item.getSearchResult();
+
+		if (searchResult.object instanceof HistoryEntry historyEntry) {
+			return historyEntry;
+		}
+		if (searchResult.relatedObject instanceof HistoryEntry historyEntry) {
+			return historyEntry;
+		}
+		return null;
+	}
+
 	@Override
 	public void onListItemClick(@NonNull ListView listView, @NonNull View view, int position, long id) {
 		if (selectionMode) {
