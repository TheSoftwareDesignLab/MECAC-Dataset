diff --git a/OsmAnd/res/layout/fragment_cloud_authorize.xml b/OsmAnd/res/layout/fragment_cloud_authorize.xml
index e34d006663f..611be69a1b0 100644
--- a/OsmAnd/res/layout/fragment_cloud_authorize.xml
+++ b/OsmAnd/res/layout/fragment_cloud_authorize.xml
@@ -7,90 +7,11 @@
 	android:layout_height="match_parent"
 	android:background="?attr/list_background_color">
 
-	<com.google.android.material.appbar.AppBarLayout
-		android:id="@+id/appbar"
-		android:layout_width="match_parent"
-		android:layout_height="wrap_content"
-		android:focusableInTouchMode="false"
-		android:background="?attr/actionModeBackground">
-
-		<com.google.android.material.appbar.CollapsingToolbarLayout
-			android:id="@+id/collapsing_toolbar"
-			android:layout_width="match_parent"
-			android:layout_height="wrap_content"
-			osmand:layout_scrollFlags="scroll|exitUntilCollapsed">
-
-			<LinearLayout
-				android:id="@+id/header"
-				android:layout_width="match_parent"
-				android:layout_height="wrap_content"
-				android:layout_marginStart="@dimen/content_padding"
-				android:layout_marginLeft="@dimen/content_padding"
-				android:layout_marginRight="@dimen/content_padding"
-				android:layout_marginEnd="@dimen/content_padding"
-				android:paddingTop="@dimen/toolbar_height_expanded"
-				android:layout_marginBottom="@dimen/content_padding_small"
-				osmand:layout_collapseMode="pin">
-
-				<net.osmand.plus.widgets.TextViewEx
-					android:id="@+id/header_title"
-					android:layout_width="match_parent"
-					android:layout_height="wrap_content"
-					android:layout_gravity="bottom"
-					android:letterSpacing="@dimen/text_button_letter_spacing"
-					android:textColor="@color/list_background_color_light"
-					android:textSize="@dimen/default_desc_line_height"
-					osmand:lineHeight="@dimen/welcome_header_text_size"
-					osmand:typeface="@string/font_roboto_medium"
-					tools:text="@string/register_opr_create_new_account" />
-
-			</LinearLayout>
-
-			<androidx.appcompat.widget.Toolbar
-				android:id="@+id/toolbar"
-				android:layout_width="match_parent"
-				android:layout_height="@dimen/toolbar_height"
-				osmand:layout_collapseMode="pin"
-				osmand:theme="@style/ThemeOverlay.AppCompat.ActionBar">
-
-				<LinearLayout
-					android:layout_width="match_parent"
-					android:layout_height="match_parent"
-					android:orientation="horizontal">
-
-					<net.osmand.plus.widgets.TextViewEx
-						android:id="@+id/toolbar_title"
-						android:layout_width="0dp"
-						android:layout_height="wrap_content"
-						android:layout_gravity="start|center_vertical"
-						android:layout_weight="1"
-						android:letterSpacing="@dimen/text_button_letter_spacing"
-						android:textColor="@color/list_background_color_light"
-						android:textSize="@dimen/dialog_header_text_size"
-						osmand:typeface="@string/font_roboto_medium"
-						tools:text="@string/register_opr_create_new_account" />
-
-					<ImageButton
-						android:id="@+id/action_button"
-						style="@style/Widget.AppCompat.Toolbar.Button.Navigation"
-						android:layout_width="@dimen/toolbar_height"
-						android:layout_height="match_parent"
-						android:contentDescription="@string/shared_string_help"
-						tools:srcCompat="@drawable/ic_action_help_online" />
-
-				</LinearLayout>
-
-			</androidx.appcompat.widget.Toolbar>
-
-		</com.google.android.material.appbar.CollapsingToolbarLayout>
-
-	</com.google.android.material.appbar.AppBarLayout>
-
 	<FrameLayout
 		android:layout_width="match_parent"
 		android:layout_height="match_parent"
 		android:orientation="vertical"
-		osmand:layout_behavior=".backup.ui.AuthorizeFragment$FixScrollingFooterBehaviour">
+		osmand:layout_behavior="@string/appbar_scrolling_view_behavior">
 
 		<me.zhanghai.android.materialprogressbar.MaterialProgressBar
 			android:id="@+id/progress_bar"
@@ -105,6 +26,7 @@
 			tools:visibility="visible" />
 
 		<ScrollView
+			android:id="@+id/scroll_view"
 			android:layout_width="match_parent"
 			android:layout_height="match_parent"
 			android:fillViewport="true">
@@ -192,8 +114,7 @@
 				<Space
 					android:id="@+id/keyboard_space"
 					android:layout_width="match_parent"
-					android:layout_height="0dp"
-					android:background="@color/color_black"
+					android:layout_height="@dimen/toolbar_height_expanded"
 					android:visibility="gone" />
 
 			</LinearLayout>
@@ -202,4 +123,41 @@
 
 	</FrameLayout>
 
+	<com.google.android.material.appbar.AppBarLayout
+		android:id="@+id/appbar"
+		android:layout_width="match_parent"
+		android:layout_height="wrap_content"
+		android:background="@android:color/transparent"
+		android:stateListAnimator="@animator/appbar_always_elevated">
+
+		<com.google.android.material.appbar.CollapsingToolbarLayout
+			android:id="@+id/toolbar_layout"
+			android:layout_width="match_parent"
+			android:layout_height="@dimen/toolbar_height_expanded"
+			android:background="?attr/actionModeBackground"
+			osmand:collapsedTitleTextAppearance="@style/AppBarTitle"
+			osmand:expandedTitleGravity="start|bottom"
+			osmand:expandedTitleMarginBottom="@dimen/content_padding_small"
+			osmand:expandedTitleMarginEnd="@dimen/content_padding"
+			osmand:expandedTitleMarginStart="@dimen/content_padding"
+			osmand:expandedTitleTextAppearance="@style/AppBarTitle"
+			osmand:layout_scrollFlags="scroll|exitUntilCollapsed">
+
+			<androidx.appcompat.widget.Toolbar
+				android:id="@+id/toolbar"
+				android:layout_width="match_parent"
+				android:layout_height="@dimen/toolbar_height"
+				android:minHeight="@dimen/toolbar_height"
+				osmand:layout_collapseMode="pin"
+				osmand:layout_scrollFlags="scroll|enterAlways|exitUntilCollapsed"
+				osmand:title="@string/shared_string_import"
+				osmand:titleMarginEnd="0dp"
+				osmand:titleMarginStart="0dp">
+
+			</androidx.appcompat.widget.Toolbar>
+
+		</com.google.android.material.appbar.CollapsingToolbarLayout>
+
+	</com.google.android.material.appbar.AppBarLayout>
+
 </androidx.coordinatorlayout.widget.CoordinatorLayout>
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/AndroidUtils.java b/OsmAnd/src/net/osmand/AndroidUtils.java
index 6176bc9e0b7..47ddbf470ca 100644
--- a/OsmAnd/src/net/osmand/AndroidUtils.java
+++ b/OsmAnd/src/net/osmand/AndroidUtils.java
@@ -13,7 +13,6 @@
 import android.graphics.Matrix;
 import android.graphics.Paint;
 import android.graphics.PointF;
-import android.graphics.Rect;
 import android.graphics.Typeface;
 import android.graphics.drawable.BitmapDrawable;
 import android.graphics.drawable.ClipDrawable;
@@ -138,15 +137,7 @@ public static void hideSoftKeyboard(final Activity activity, final View input) {
 				}
 			}
 		}
-	}
 
-	public static int getSoftKeyboardHeight(@NonNull View rootView) {
-		Context context = rootView.getContext();
-		Rect visibleBounds = new Rect();
-		rootView.getWindowVisibleDisplayFrame(visibleBounds);
-		int windowCoveredHeight = rootView.getHeight() - visibleBounds.height() - getStatusBarHeight(context);
-		int supposedKeyboardMinHeight = dpToPx(context, 50);
-		return windowCoveredHeight > supposedKeyboardMinHeight ? windowCoveredHeight : 0;
 	}
 
 	public static Bitmap scaleBitmap(Bitmap bm, int newWidth, int newHeight, boolean keepOriginalBitmap) {
diff --git a/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java b/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
index f975c0b1d4b..ab37fc6923d 100644
--- a/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
+++ b/OsmAnd/src/net/osmand/plus/backup/ui/AuthorizeFragment.java
@@ -1,27 +1,37 @@
 package net.osmand.plus.backup.ui;
 
-import android.content.Context;
-import android.net.Uri;
+import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_NO_VALID_SUBSCRIPTION;
+import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_SUBSCRIPTION_WAS_EXPIRED_OR_NOT_PRESENT;
+import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_TOKEN_IS_NOT_VALID_OR_EXPIRED;
+import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_USER_IS_NOT_REGISTERED;
+import static net.osmand.plus.mapmarkers.CoordinateInputDialogFragment.SOFT_KEYBOARD_MIN_DETECTION_SIZE;
+
+import android.graphics.Rect;
 import android.os.Bundle;
 import android.text.Editable;
 import android.text.Spannable;
 import android.text.SpannableString;
 import android.text.TextWatcher;
 import android.text.style.ForegroundColorSpan;
-import android.util.AttributeSet;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 import android.view.ViewTreeObserver.OnGlobalLayoutListener;
 import android.widget.EditText;
-import android.widget.ImageView;
 import android.widget.LinearLayout.LayoutParams;
 import android.widget.ProgressBar;
 import android.widget.TextView;
 
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.annotation.StringRes;
+import androidx.appcompat.widget.Toolbar;
+import androidx.core.content.ContextCompat;
+import androidx.core.view.ViewCompat;
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
+
 import com.google.android.material.appbar.AppBarLayout;
-import com.google.android.material.appbar.AppBarLayout.Behavior;
-import com.google.android.material.appbar.AppBarLayout.Behavior.DragCallback;
 
 import net.osmand.AndroidUtils;
 import net.osmand.PlatformUtil;
@@ -30,36 +40,20 @@
 import net.osmand.plus.UiUtilities;
 import net.osmand.plus.UiUtilities.DialogButtonType;
 import net.osmand.plus.Version;
+import net.osmand.plus.backup.BackupError;
 import net.osmand.plus.backup.BackupHelper;
 import net.osmand.plus.backup.BackupListeners.OnRegisterDeviceListener;
 import net.osmand.plus.backup.BackupListeners.OnRegisterUserListener;
-import net.osmand.plus.backup.BackupError;
 import net.osmand.plus.base.BaseOsmAndFragment;
 import net.osmand.plus.chooseplan.ChoosePlanFragment;
 import net.osmand.plus.chooseplan.OsmAndFeature;
 import net.osmand.plus.helpers.AndroidUiHelper;
 import net.osmand.plus.settings.backend.OsmandSettings;
 import net.osmand.plus.settings.fragments.BaseSettingsFragment;
-import net.osmand.plus.wikipedia.WikipediaDialogFragment;
 import net.osmand.util.Algorithms;
 
 import org.apache.commons.logging.Log;
 
-import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
-import androidx.annotation.StringRes;
-import androidx.appcompat.widget.Toolbar;
-import androidx.coordinatorlayout.widget.CoordinatorLayout;
-import androidx.core.content.ContextCompat;
-import androidx.core.view.ViewCompat;
-import androidx.fragment.app.FragmentActivity;
-import androidx.fragment.app.FragmentManager;
-
-import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_NO_VALID_SUBSCRIPTION;
-import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_SUBSCRIPTION_WAS_EXPIRED_OR_NOT_PRESENT;
-import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_TOKEN_IS_NOT_VALID_OR_EXPIRED;
-import static net.osmand.plus.backup.BackupHelper.SERVER_ERROR_CODE_USER_IS_NOT_REGISTERED;
-
 public class AuthorizeFragment extends BaseOsmAndFragment implements OnRegisterUserListener, OnRegisterDeviceListener {
 
 	private static final Log LOG = PlatformUtil.getLog(AuthorizeFragment.class);
@@ -67,7 +61,6 @@ public class AuthorizeFragment extends BaseOsmAndFragment implements OnRegisterU
 	public static final String TAG = AuthorizeFragment.class.getSimpleName();
 
 	private static final String OSMAND_EMAIL = "support@osmand.net";
-	private static final String OSMAND_DOCS = "https://docs.osmand.net/en/main@latest/osmand/purchases/android";
 
 	private static final String LOGIN_DIALOG_TYPE_KEY = "login_dialog_type_key";
 	private static final String SIGN_IN_KEY = "sign_in_key";
@@ -80,14 +73,14 @@ public class AuthorizeFragment extends BaseOsmAndFragment implements OnRegisterU
 
 	private View mainView;
 	private Toolbar toolbar;
-	private TextView toolbarTitle;
 	private ProgressBar progressBar;
-	private TextView headerTitle;
 	private TextView description;
 	private View buttonContinue;
 	private View buttonChoosePlan;
 	private TextView errorText;
 	private View buttonAuthorize;
+	private View keyboardSpace;
+	private View space;
 
 	private LoginDialogType dialogType = LoginDialogType.SIGN_UP;
 
@@ -134,23 +127,20 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c
 		View view = themedInflater.inflate(R.layout.fragment_cloud_authorize, container, false);
 		AndroidUtils.addStatusBarPadding21v(app, view);
 
-		toolbarTitle = view.findViewById(R.id.toolbar_title);
-		headerTitle = view.findViewById(R.id.header_title);
+		space = view.findViewById(R.id.space);
 		toolbar = view.findViewById(R.id.toolbar);
 		mainView = view.findViewById(R.id.main_view);
 		description = view.findViewById(R.id.description);
 		progressBar = view.findViewById(R.id.progress_bar);
 		buttonContinue = view.findViewById(R.id.continue_button);
 		buttonChoosePlan = view.findViewById(R.id.get_button);
+		keyboardSpace = view.findViewById(R.id.keyboard_space);
 
-		setupAppbar();
 		setupToolbar();
 		setupTextWatchers();
 		updateContent();
 		setupSupportButton();
-		if (AndroidUiHelper.isOrientationPortrait(requireActivity())) {
-			setupKeyboardListener();
-		}
+		setupKeyboardListener();
 
 		UiUtilities.setupDialogButton(nightMode, buttonChoosePlan, DialogButtonType.SECONDARY, R.string.get_plugin);
 		UiUtilities.setupDialogButton(nightMode, buttonContinue, DialogButtonType.PRIMARY, R.string.shared_string_continue);
@@ -192,38 +182,6 @@ private void setupTextWatchers() {
 		}
 	}
 
-	private void setupAppbar() {
-		AppBarLayout appbar = mainView.findViewById(R.id.appbar);
-
-		appbar.addOnOffsetChangedListener((appBar, verticalOffset) -> {
-			float absOffset = Math.abs(verticalOffset);
-			float totalScrollRange = appBar.getTotalScrollRange();
-			float alpha = UiUtilities.getProportionalAlpha(totalScrollRange * 0.25f,
-					totalScrollRange * 0.9f, absOffset);
-			float inverseAlpha = 1.0f - UiUtilities.getProportionalAlpha(totalScrollRange * 0.5f,
-					totalScrollRange, absOffset);
-
-			toolbarTitle.setAlpha(inverseAlpha);
-			headerTitle.setAlpha(alpha);
-		});
-
-		forbidAppbarDragging(appbar);
-	}
-
-	private void forbidAppbarDragging(AppBarLayout appbar) {
-		CoordinatorLayout.LayoutParams appBarParams = (CoordinatorLayout.LayoutParams) appbar.getLayoutParams();
-		if (appBarParams.getBehavior() == null) {
-			appBarParams.setBehavior(new AppBarLayout.Behavior());
-		}
-		AppBarLayout.Behavior appBarBehaviour = (Behavior) appBarParams.getBehavior();
-		appBarBehaviour.setDragCallback(new DragCallback() {
-			@Override
-			public boolean canDrag(@NonNull AppBarLayout appBarLayout) {
-				return false;
-			}
-		});
-	}
-
 	private void setupToolbar() {
 		AppBarLayout appBarLayout = mainView.findViewById(R.id.appbar);
 		ViewCompat.setElevation(appBarLayout, 5.0f);
@@ -236,21 +194,10 @@ private void setupToolbar() {
 				activity.onBackPressed();
 			}
 		});
-		ImageView actionButton = toolbar.findViewById(R.id.action_button);
-		actionButton.setImageDrawable(app.getUIUtilities().getIcon(R.drawable.ic_action_help_online));
-		actionButton.setOnClickListener(v -> {
-			FragmentActivity activity = getActivity();
-			if (activity != null) {
-				WikipediaDialogFragment.showFullArticle(activity, Uri.parse(OSMAND_DOCS), nightMode);
-			}
-		});
-		AndroidUiHelper.updateVisibility(toolbar.findViewById(R.id.toolbar_switch_container), false);
 	}
 
 	private void updateContent() {
-		toolbarTitle.setText(dialogType.titleId);
-		headerTitle.setText(dialogType.titleId);
-		
+		toolbar.setTitle(dialogType.titleId);
 		updateDescription();
 
 		for (LoginDialogType type : LoginDialogType.values()) {
@@ -497,35 +444,32 @@ private void setupSupportButton() {
 	}
 
 	private void setupKeyboardListener() {
-		mainView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
-
-			private int previousKeyboardHeight = 0;
-
-			@Override
-			public void onGlobalLayout() {
-				AppBarLayout appbar = mainView.findViewById(R.id.appbar);
-				View keyboardSpace = mainView.findViewById(R.id.keyboard_space);
-				View space = mainView.findViewById(R.id.space);
-				int keyboardHeight = AndroidUtils.getSoftKeyboardHeight(mainView);
-				boolean heightChanged = previousKeyboardHeight != keyboardHeight;
-				if (!heightChanged) {
-					return;
-				}
-
-				previousKeyboardHeight = keyboardHeight;
-				if (keyboardHeight > 0) {
-					space.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, space.getHeight()));
-					keyboardSpace.setLayoutParams(new LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,
-							keyboardHeight));
-					AndroidUiHelper.updateVisibility(keyboardSpace, true);
-					appbar.setExpanded(false);
-				} else {
-					space.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, 0, 1));
-					AndroidUiHelper.updateVisibility(keyboardSpace, false);
-					appbar.setExpanded(true);
+		if (AndroidUiHelper.isOrientationPortrait(requireActivity())) {
+			mainView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
+
+				private int previousKeyboardHeight = 0;
+
+				@Override
+				public void onGlobalLayout() {
+					Rect r = new Rect();
+					mainView.getWindowVisibleDisplayFrame(r);
+					int screenHeight = mainView.getRootView().getHeight();
+					int keypadHeight = screenHeight - r.bottom;
+					boolean softKeyboardVisible = keypadHeight > screenHeight * SOFT_KEYBOARD_MIN_DETECTION_SIZE;
+
+					if (previousKeyboardHeight != keypadHeight) {
+						previousKeyboardHeight = keypadHeight;
+						if (softKeyboardVisible) {
+							space.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, space.getHeight()));
+							keyboardSpace.setLayoutParams(new LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, keypadHeight));
+						} else {
+							space.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, 0, 1));
+						}
+						AndroidUiHelper.updateVisibility(keyboardSpace, softKeyboardVisible);
+					}
 				}
-			}
-		});
+			});
+		}
 	}
 
 	public enum LoginDialogType {
@@ -564,36 +508,4 @@ public static void showInstance(@NonNull FragmentManager fragmentManager, boolea
 					.commitAllowingStateLoss();
 		}
 	}
-
-	public static class FixScrollingFooterBehaviour extends AppBarLayout.ScrollingViewBehavior {
-
-		private AppBarLayout appBar;
-
-		public FixScrollingFooterBehaviour() {
-			super();
-		}
-
-		public FixScrollingFooterBehaviour(Context context, AttributeSet attrs) {
-			super(context, attrs);
-		}
-
-		@Override
-		public boolean onDependentViewChanged(@NonNull CoordinatorLayout parent, @NonNull View child, @NonNull View dependency) {
-			if (appBar == null) {
-				appBar = ((AppBarLayout) dependency);
-			}
-
-			boolean viewChanged = super.onDependentViewChanged(parent, child, dependency);
-			int bottomPadding = appBar.getTop() + appBar.getTotalScrollRange()
-					- AndroidUtils.getStatusBarHeight(parent.getContext());
-			boolean paddingChanged = bottomPadding != child.getPaddingBottom();
-			if (paddingChanged) {
-				child.setPadding(child.getPaddingLeft(), child.getPaddingTop(), child.getPaddingRight(),
-						bottomPadding);
-				child.requestLayout();
-			}
-
-			return paddingChanged || viewChanged;
-		}
-	}
 }
\ No newline at end of file
diff --git a/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java b/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
index 96d6f9a8f46..a84c899d3d3 100644
--- a/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
+++ b/OsmAnd/src/net/osmand/plus/mapmarkers/CoordinateInputDialogFragment.java
@@ -99,7 +99,7 @@ public class CoordinateInputDialogFragment extends DialogFragment implements Osm
 	public static final String ADDED_POINTS_NUMBER_KEY = "added_points_number_key";
 
 	private static final String SELECTED_POINT_KEY = "selected_point_key";
-	private static final double SOFT_KEYBOARD_MIN_DETECTION_SIZE = 0.15;
+	public static final double SOFT_KEYBOARD_MIN_DETECTION_SIZE = 0.15;
 
 	private GPXFile newGpxFile;
 	private OnPointsSavedListener listener;
