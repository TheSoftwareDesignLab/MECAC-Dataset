diff --git a/Wikipedia/assets/codemirror/codemirror-index.html b/Wikipedia/assets/codemirror/codemirror-index.html
index b1fd6f388b3..1f5c3e7e442 100644
--- a/Wikipedia/assets/codemirror/codemirror-index.html
+++ b/Wikipedia/assets/codemirror/codemirror-index.html
@@ -782,6 +782,11 @@
           from = { line: anchor.line, ch: fromCh }
           const toCh = head.ch + info.closeDistance
           to = { line: head.line, ch: toCh }
+        } else if (info.openWithinDistance !== -1 && info.closeWithinDistance !== -1) {
+          const fromCh = anchor.ch + info.openWithinDistance + anchorLength
+          from = { line: anchor.line, ch: fromCh }
+          const toCh = head.ch - info.closeWithinDistance - anchorLength
+          to = { line: head.line, ch: toCh }
         }
 
         if (from && to) {
diff --git a/www/codemirror/codemirror-index.html b/www/codemirror/codemirror-index.html
index b1fd6f388b3..1f5c3e7e442 100644
--- a/www/codemirror/codemirror-index.html
+++ b/www/codemirror/codemirror-index.html
@@ -782,6 +782,11 @@
           from = { line: anchor.line, ch: fromCh }
           const toCh = head.ch + info.closeDistance
           to = { line: head.line, ch: toCh }
+        } else if (info.openWithinDistance !== -1 && info.closeWithinDistance !== -1) {
+          const fromCh = anchor.ch + info.openWithinDistance + anchorLength
+          from = { line: anchor.line, ch: fromCh }
+          const toCh = head.ch - info.closeWithinDistance - anchorLength
+          to = { line: head.line, ch: toCh }
         }
 
         if (from && to) {
