diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+LastVisibleSortId.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+LastVisibleSortId.swift
index e57246ea194..9cb3a74e0ed 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+LastVisibleSortId.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+LastVisibleSortId.swift
@@ -24,6 +24,7 @@ extension ConversationViewController {
         // with the updated -contentOffset in -scrollViewDidScroll:. So instead, we'll just see what layoutAttributes
         // are now in the collection view's visible content rect. This should be safe, since it's computed from the
         // already updated -contentOffset.
+        layout.prepare()
         let visibleLayoutAttributes = layout.layoutAttributesForElements(in: visibleContentRect) ?? []
 
         let lastVisibleIndexPath = visibleLayoutAttributes
@@ -91,6 +92,8 @@ extension ConversationViewController {
     }
 
     private func percentOfIndexPathVisibleAboveBottom(_ indexPath: IndexPath) -> CGFloat {
+        layout.prepare()
+
         // If we don't have layout attributes, it's not visible
         guard let attributes = layout.layoutAttributesForItem(at: indexPath) else { return 0.0 }
 
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Scroll.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Scroll.swift
index 7ad4e1256b9..e15133032da 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Scroll.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Scroll.swift
@@ -236,6 +236,7 @@ extension ConversationViewController {
         guard !isUserScrolling else { return }
 
         view.layoutIfNeeded()
+        layout.prepare()
 
         guard let attributes = layout.layoutAttributesForItem(at: indexPath) else {
             return owsFailDebug("failed to get attributes for indexPath \(indexPath)")
@@ -740,6 +741,7 @@ extension ConversationViewController {
             // This is expected if the menu action interaction is being deleted.
             return nil
         }
+        layout.prepare()
         guard let layoutAttributes = layout.layoutAttributesForItem(at: indexPath) else {
             owsFailDebug("Missing layoutAttributes.")
             return nil
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Selection.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Selection.swift
index 6d3b461bf2f..d2b7da57261 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Selection.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Selection.swift
@@ -200,6 +200,7 @@ extension ConversationViewController {
             return nil
         }
 
+        layout.prepare()
         guard let firstFrame = self.layout.layoutAttributesForItem(at: first)?.frame else {
             owsFailDebug("firstFrame was unexpectedly nil")
             return nil
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
index 6186da28591..c030882ebea 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
@@ -1845,6 +1845,7 @@ - (nullable NSValue *)targetContentOffsetForMessageActionInteraction
         // This is expected if the menu action interaction is being deleted.
         return nil;
     }
+    [self.layout prepareLayout];
     UICollectionViewLayoutAttributes *_Nullable layoutAttributes =
         [self.layout layoutAttributesForItemAtIndexPath:indexPath];
     if (layoutAttributes == nil) {
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.swift
index 0cf73f657fe..c4dbcb5b70e 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.swift
@@ -208,8 +208,9 @@ public class ConversationViewLayout: UICollectionViewLayout {
 
     @objc
     public override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
-        var result = [UICollectionViewLayoutAttributes]()
+        owsAssertDebug(hasLayout)
 
+        var result = [UICollectionViewLayoutAttributes]()
         if let headerLayoutAttributes = headerLayoutAttributes {
             result.append(headerLayoutAttributes)
         }
@@ -222,6 +223,8 @@ public class ConversationViewLayout: UICollectionViewLayout {
 
     @objc
     public override func layoutAttributesForItem(at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
+        owsAssertDebug(hasLayout)
+
         guard let attributes = itemAttributesMap[indexPath.row] else {
             Logger.verbose("Missing attributes: \(itemAttributesMap.keys)")
             return nil
@@ -231,6 +234,8 @@ public class ConversationViewLayout: UICollectionViewLayout {
 
     @objc
     public override func layoutAttributesForSupplementaryView(ofKind elementKind: String, at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
+        owsAssertDebug(hasLayout)
+
         if elementKind == UICollectionView.elementKindSectionHeader {
             return headerLayoutAttributes
         } else if elementKind == UICollectionView.elementKindSectionFooter {
