diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index 95c8c5dcc82..e6b2e094391 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -966,6 +966,7 @@
 		6673FF89297B6AF800F96CFD /* DBTransaction.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6673FF88297B6AF800F96CFD /* DBTransaction.swift */; };
 		6673FF8B297B6FA800F96CFD /* SDSDB.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6673FF8A297B6FA800F96CFD /* SDSDB.swift */; };
 		6674807C2E32EA52004DA6E9 /* Optional+SSK.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6674807B2E32EA4D004DA6E9 /* Optional+SSK.swift */; };
+		6674807E2E344EE9004DA6E9 /* OWSOutgoingPaymentMessage.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6674807D2E344EE9004DA6E9 /* OWSOutgoingPaymentMessage.swift */; };
 		6675F64F29261C39007A311E /* SyncPushTokensJob.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6675F64E29261C39007A311E /* SyncPushTokensJob.swift */; };
 		6675F65129261E0C007A311E /* APNSRotationStoreTest.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6675F65029261E0C007A311E /* APNSRotationStoreTest.swift */; };
 		667664362A43BBCD00716B84 /* OWSFingerprint.swift in Sources */ = {isa = PBXBuildFile; fileRef = 667664352A43BBCD00716B84 /* OWSFingerprint.swift */; };
@@ -4904,6 +4905,7 @@
 		6673FF88297B6AF800F96CFD /* DBTransaction.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = DBTransaction.swift; sourceTree = "<group>"; };
 		6673FF8A297B6FA800F96CFD /* SDSDB.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = SDSDB.swift; sourceTree = "<group>"; };
 		6674807B2E32EA4D004DA6E9 /* Optional+SSK.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = "Optional+SSK.swift"; sourceTree = "<group>"; };
+		6674807D2E344EE9004DA6E9 /* OWSOutgoingPaymentMessage.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = OWSOutgoingPaymentMessage.swift; sourceTree = "<group>"; };
 		6675F64C2925C012007A311E /* APNSRotationStore.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = APNSRotationStore.swift; sourceTree = "<group>"; };
 		6675F64E29261C39007A311E /* SyncPushTokensJob.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = SyncPushTokensJob.swift; sourceTree = "<group>"; };
 		6675F65029261E0C007A311E /* APNSRotationStoreTest.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = APNSRotationStoreTest.swift; sourceTree = "<group>"; };
@@ -13818,6 +13820,7 @@
 				F9C5C913289453B100548EEE /* OWSOutgoingPaymentMessage+SDS.swift */,
 				F9C5C912289453B100548EEE /* OWSOutgoingPaymentMessage.h */,
 				F9C5C914289453B100548EEE /* OWSOutgoingPaymentMessage.m */,
+				6674807D2E344EE9004DA6E9 /* OWSOutgoingPaymentMessage.swift */,
 				6642A8782A8D85F500E591C2 /* OWSPaymentActivationRequestFinishedMessage+SDS.swift */,
 				6642A86F2A8D7B3400E591C2 /* OWSPaymentActivationRequestFinishedMessage.h */,
 				6642A8712A8D7C5700E591C2 /* OWSPaymentActivationRequestFinishedMessage.m */,
@@ -18230,6 +18233,7 @@
 				F9C5CC37289453B300548EEE /* OWSOutgoingNullMessage.m in Sources */,
 				F9C5CC06289453B300548EEE /* OWSOutgoingPaymentMessage+SDS.swift in Sources */,
 				F9C5CC07289453B300548EEE /* OWSOutgoingPaymentMessage.m in Sources */,
+				6674807E2E344EE9004DA6E9 /* OWSOutgoingPaymentMessage.swift in Sources */,
 				F9C5CC3B289453B300548EEE /* OWSOutgoingReactionMessage.m in Sources */,
 				F9C5CC82289453B300548EEE /* OWSOutgoingResendRequest.m in Sources */,
 				F9C5CC1F289453B300548EEE /* OWSOutgoingResendRequest.swift in Sources */,
diff --git a/Signal/Notifications/NotificationActionHandler.swift b/Signal/Notifications/NotificationActionHandler.swift
index 3f705a89649..46d94c2cd5e 100644
--- a/Signal/Notifications/NotificationActionHandler.swift
+++ b/Signal/Notifications/NotificationActionHandler.swift
@@ -116,6 +116,8 @@ public class NotificationActionHandler {
     }
 
     private class func reply(userInfo: AppNotificationUserInfo, replyText: String) async throws {
+        guard !replyText.isEmpty else { return }
+
         let notificationMessage = try await self.notificationMessage(forUserInfo: userInfo)
         let thread = notificationMessage.thread
         let interaction = notificationMessage.interaction
@@ -137,10 +139,13 @@ public class NotificationActionHandler {
             draftModelForSending = try? await DependenciesBridge.shared.quotedReplyManager.prepareDraftForSending(draftModel)
         }
 
+        let messageBody = try await DependenciesBridge.shared.attachmentContentValidator
+            .prepareOversizeTextIfNeeded(MessageBody(text: replyText, ranges: .empty))
+
         do {
             try await SSKEnvironment.shared.databaseStorageRef.awaitableWrite { transaction in
                 let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread)
-                builder.messageBody = replyText
+                builder.setMessageBody(messageBody)
 
                 // If we're replying to a group story reply, keep the reply within that context.
                 if
@@ -160,13 +165,17 @@ public class NotificationActionHandler {
                     builder.expireTimerVersion = NSNumber(value: dmConfig.timerVersion)
                 }
 
-                let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(TSOutgoingMessage(
-                    outgoingMessageWith: builder,
-                    additionalRecipients: [],
-                    explicitRecipients: [],
-                    skippedRecipients: [],
-                    transaction: transaction
-                ), quotedReplyDraft: draftModelForSending)
+                let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
+                    TSOutgoingMessage(
+                        outgoingMessageWith: builder,
+                        additionalRecipients: [],
+                        explicitRecipients: [],
+                        skippedRecipients: [],
+                        transaction: transaction
+                    ),
+                    body: messageBody,
+                    quotedReplyDraft: draftModelForSending
+                )
                 let preparedMessage = try unpreparedMessage.prepare(tx: transaction)
                 return ThreadUtil.enqueueMessagePromise(message: preparedMessage, transaction: transaction)
             }.awaitable()
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift
index 6a1e58cfa2e..276dbee8696 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
@@ -11,7 +11,7 @@ import UIKit
 let kMaxMessageBodyCharacterCount = 2000
 
 protocol StoryReplyInputToolbarDelegate: MessageReactionPickerDelegate {
-    func storyReplyInputToolbarDidTapSend(_ storyReplyInputToolbar: StoryReplyInputToolbar)
+    func storyReplyInputToolbarDidTapSend(_ storyReplyInputToolbar: StoryReplyInputToolbar) async throws
     func storyReplyInputToolbarDidTapReact(_ storyReplyInputToolbar: StoryReplyInputToolbar)
     func storyReplyInputToolbarDidBeginEditing(_ storyReplyInputToolbar: StoryReplyInputToolbar)
     func storyReplyInputToolbarHeightDidChange(_ storyReplyInputToolbar: StoryReplyInputToolbar)
@@ -285,7 +285,9 @@ class StoryReplyInputToolbar: UIView {
     @objc
     private func didTapSend() {
         textView.acceptAutocorrectSuggestion()
-        delegate?.storyReplyInputToolbarDidTapSend(self)
+        Task {
+            try await delegate?.storyReplyInputToolbarDidTapSend(self)
+        }
     }
 
     private func didTapReact() {
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplySheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplySheet.swift
index e2011626663..0c7ddea956f 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplySheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplySheet.swift	
@@ -23,7 +23,10 @@ protocol StoryReplySheet: OWSViewController, StoryReplyInputToolbarDelegate, Mes
 // MARK: - Sending
 
 extension StoryReplySheet {
-    func tryToSendMessage(_ builder: TSOutgoingMessageBuilder) {
+    func tryToSendMessage(
+        _ builder: TSOutgoingMessageBuilder,
+        messageBody: ValidatedMessageBody?,
+    ) {
         guard let thread = thread else {
             return owsFailDebug("Unexpectedly missing thread")
         }
@@ -32,7 +35,7 @@ extension StoryReplySheet {
         guard !isThreadBlocked else {
             BlockListUIUtils.showUnblockThreadActionSheet(thread, from: self) { [weak self] isBlocked in
                 guard !isBlocked else { return }
-                self?.tryToSendMessage(builder)
+                self?.tryToSendMessage(builder, messageBody: messageBody)
             }
             return
         }
@@ -48,7 +51,7 @@ extension StoryReplySheet {
             confirmationText: SafetyNumberStrings.confirmSendButton,
             completion: { [weak self] didConfirmIdentity in
                 guard didConfirmIdentity else { return }
-                self?.tryToSendMessage(builder)
+                self?.tryToSendMessage(builder, messageBody: messageBody)
             }
         ) else { return }
 
@@ -70,7 +73,10 @@ extension StoryReplySheet {
                 builder.expireTimerVersion = NSNumber(value: dmConfig.timerVersion)
             }
 
-            let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(builder.build(transaction: transaction))
+            let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
+                builder.build(transaction: transaction),
+                body: messageBody
+            )
             guard let preparedMessage = try? unpreparedMessage.prepare(tx: transaction) else {
                 owsFailDebug("Failed to prepare message")
                 return
@@ -108,7 +114,7 @@ extension StoryReplySheet {
             storyReactionEmoji: reaction
         )
 
-        tryToSendMessage(builder)
+        tryToSendMessage(builder, messageBody: nil)
 
         ReactionFlybyAnimation(reaction: reaction).present(from: self)
     }
@@ -139,13 +145,20 @@ extension StoryReplySheet {
 // MARK: - StoryReplyInputToolbarDelegate
 
 extension StoryReplySheet {
-    func storyReplyInputToolbarDidTapSend(_ storyReplyInputToolbar: StoryReplyInputToolbar) {
-        guard let messageBody = storyReplyInputToolbar.messageBodyForSending, !messageBody.text.isEmpty else {
-            return owsFailDebug("Unexpectedly missing message body")
+    @MainActor
+    func storyReplyInputToolbarDidTapSend(_ storyReplyInputToolbar: StoryReplyInputToolbar) async throws {
+        guard
+            let originalMessageBody = storyReplyInputToolbar.messageBodyForSending,
+            !originalMessageBody.text.isEmpty
+        else {
+            throw OWSAssertionError("Unexpectedly missing message body")
         }
 
+        let messageBody = try await DependenciesBridge.shared.attachmentContentValidator
+            .prepareOversizeTextIfNeeded(originalMessageBody)
+
         guard let thread = thread else {
-            return owsFailDebug("Unexpectedly missing thread")
+            throw OWSAssertionError("Unexpectedly missing thread")
         }
         owsAssertDebug(
             !storyMessage.authorAddress.isSystemStoryAddress,
@@ -154,13 +167,12 @@ extension StoryReplySheet {
 
         let builder: TSOutgoingMessageBuilder = .withDefaultValues(
             thread: thread,
-            messageBody: messageBody.text,
-            bodyRanges: messageBody.ranges,
+            messageBody: messageBody,
             storyAuthorAci: storyMessage.authorAci,
             storyTimestamp: storyMessage.timestamp
         )
 
-        tryToSendMessage(builder)
+        tryToSendMessage(builder, messageBody: messageBody)
     }
 
     func storyReplyInputToolbarDidTapReact(_ storyReplyInputToolbar: StoryReplyInputToolbar) {
diff --git a/Signal/src/views/MockConversationView.swift b/Signal/src/views/MockConversationView.swift
index fa1076b1dad..c257f383665 100644
--- a/Signal/src/views/MockConversationView.swift
+++ b/Signal/src/views/MockConversationView.swift
@@ -120,6 +120,20 @@ class MockConversationView: UIView {
             return
         }
 
+        let modelItems: [(MockItem, ValidatedInlineMessageBody?)] = SSKEnvironment.shared.databaseStorageRef.write { tx in
+            return model.items.map { item in
+                switch item {
+                case .date:
+                    return (item, nil)
+                case .incoming(let text), .outgoing(let text):
+                    return (item, DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+                        MessageBody(text: text, ranges: .empty),
+                        tx: tx
+                    ))
+                }
+            }
+        }
+
         var renderItems = [CVRenderItem]()
         SSKEnvironment.shared.databaseStorageRef.read { transaction in
             let chatColor = self.customChatColor ?? DependenciesBridge.shared.chatColorSettingStore.resolvedChatColor(
@@ -135,15 +149,15 @@ class MockConversationView: UIView {
                 chatColor: chatColor
             )
             let threadAssociatedData = ThreadAssociatedData.fetchOrDefault(for: thread, transaction: transaction)
-            for item in model.items {
+            for (item, text) in modelItems {
                 let interaction: TSInteraction
                 switch item {
                 case .date:
                     interaction = DateHeaderInteraction(thread: self.thread, timestamp: NSDate.ows_millisecondTimeStamp())
-                case .outgoing(let text):
-                    interaction = MockOutgoingMessage(messageBody: text, thread: self.thread, transaction: transaction)
-                case .incoming(let text):
-                    interaction = MockIncomingMessage(messageBody: text, thread: self.thread)
+                case .outgoing:
+                    interaction = MockOutgoingMessage(messageBody: text!, thread: self.thread, transaction: transaction)
+                case .incoming:
+                    interaction = MockIncomingMessage(messageBody: text!, thread: self.thread)
                 }
 
                 guard let renderItem = CVLoader.buildStandaloneRenderItem(
@@ -200,7 +214,7 @@ private class MockThread: TSContactThread {
 // MARK: -
 
 private class MockIncomingMessage: TSIncomingMessage {
-    init(messageBody: String, thread: MockThread) {
+    init(messageBody: ValidatedInlineMessageBody, thread: MockThread) {
         let builder: TSIncomingMessageBuilder = .withDefaultValues(
             thread: thread,
             authorAci: thread.contactAddress.aci!,
@@ -229,7 +243,7 @@ private class MockIncomingMessage: TSIncomingMessage {
 // MARK: -
 
 private class MockOutgoingMessage: TSOutgoingMessage {
-    init(messageBody: String, thread: TSThread, transaction: DBReadTransaction) {
+    init(messageBody: ValidatedInlineMessageBody, thread: TSThread, transaction: DBReadTransaction) {
         let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
         super.init(
             outgoingMessageWith: builder,
diff --git a/Signal/test/util/FTS/GRDBFullTextSearcherTest.swift b/Signal/test/util/FTS/GRDBFullTextSearcherTest.swift
index bb63e82253c..bd4c1e7fd9d 100644
--- a/Signal/test/util/FTS/GRDBFullTextSearcherTest.swift
+++ b/Signal/test/util/FTS/GRDBFullTextSearcherTest.swift
@@ -635,7 +635,10 @@ class GRDBFullTextSearcherTest: SignalBaseTest {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSIncomingMessageArchiver.swift b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSIncomingMessageArchiver.swift
index 81cee19429e..500b05904be 100644
--- a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSIncomingMessageArchiver.swift
+++ b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSIncomingMessageArchiver.swift
@@ -351,7 +351,6 @@ extension BackupArchiveTSIncomingMessageArchiver: BackupArchiveTSMessageEditHist
                 authorAci: authorAci,
                 authorE164: authorE164,
                 messageBody: nil,
-                bodyRanges: nil,
                 editState: editState,
                 expiresInSeconds: expiresInSeconds,
                 // Backed up messages don't set the chat timer; version is irrelevant.
@@ -388,8 +387,7 @@ extension BackupArchiveTSIncomingMessageArchiver: BackupArchiveTSMessageEditHist
             case .remoteDeleteTombstone:
                 messageBuilder.wasRemotelyDeleted = true
             case .text(let text):
-                messageBuilder.messageBody = text.body?.messageBody.text
-                messageBuilder.bodyRanges = text.body?.messageBody.ranges
+                messageBuilder.setMessageBody(text.body)
                 messageBuilder.quotedMessage = text.quotedMessage
                 messageBuilder.linkPreview = text.linkPreview
             case .contactShare(let contactShare):
@@ -409,8 +407,7 @@ extension BackupArchiveTSIncomingMessageArchiver: BackupArchiveTSMessageEditHist
             case .storyReply(let storyReply):
                 switch storyReply.replyType {
                 case .textReply(let textReply):
-                    messageBuilder.messageBody = textReply.body.messageBody.text
-                    messageBuilder.bodyRanges = textReply.body.messageBody.ranges
+                    messageBuilder.setMessageBody(textReply.body)
                 case .emoji(let emoji):
                     messageBuilder.storyReactionEmoji = emoji
                 }
diff --git a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSMessageContentsArchiver.swift b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSMessageContentsArchiver.swift
index c605369fa34..aa69437f1bf 100644
--- a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSMessageContentsArchiver.swift
+++ b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSMessageContentsArchiver.swift
@@ -33,7 +33,7 @@ extension BackupArchive {
         }
 
         struct Text {
-            struct RestoredMessageBody {
+            struct RestoredMessageBody: ValidatedInlineMessageBody {
                 enum OversizeText {
                     // The exporter presumably hadn't downloaded the attachment
                     // at export time, so all we have is a pointer.
@@ -45,11 +45,11 @@ extension BackupArchive {
                 }
 
                 // This is the body we put on the message
-                let messageBody: MessageBody
+                let inlinedBody: MessageBody
                 fileprivate let oversizeText: OversizeText?
 
-                init(messageBody: MessageBody, oversizeText: OversizeText?) {
-                    self.messageBody = messageBody
+                init(inlinedBody: MessageBody, oversizeText: OversizeText?) {
+                    self.inlinedBody = inlinedBody
                     self.oversizeText = oversizeText
                 }
             }
@@ -1636,7 +1636,7 @@ class BackupArchiveTSMessageContentsArchiver: BackupArchiveProtoStreamWriter {
                         chatItemId
                     ))
                 }
-                quoteBody = component?.messageBody
+                quoteBody = component?.inlinedBody
             case .bubbleUpError(let error):
                 return error
             }
diff --git a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSOutgoingMessageArchiver.swift b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSOutgoingMessageArchiver.swift
index 1875c87fd18..28caa5fa0c3 100644
--- a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSOutgoingMessageArchiver.swift
+++ b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupArchiveTSOutgoingMessageArchiver.swift
@@ -518,7 +518,6 @@ extension BackupArchiveTSOutgoingMessageArchiver: BackupArchiveTSMessageEditHist
                 // messages, "sent" and "received" are the same, anyway.
                 receivedAtTimestamp: chatItem.dateSent,
                 messageBody: nil,
-                bodyRanges: nil,
                 editState: editState,
                 expiresInSeconds: expiresInSeconds,
                 // Backed up messages don't set the chat timer; version is irrelevant.
@@ -555,8 +554,7 @@ extension BackupArchiveTSOutgoingMessageArchiver: BackupArchiveTSMessageEditHist
             case .remoteDeleteTombstone:
                 outgoingMessageBuilder.wasRemotelyDeleted = true
             case .text(let text):
-                outgoingMessageBuilder.messageBody = text.body?.messageBody.text
-                outgoingMessageBuilder.bodyRanges = text.body?.messageBody.ranges
+                outgoingMessageBuilder.setMessageBody(text.body)
                 outgoingMessageBuilder.quotedMessage = text.quotedMessage
                 outgoingMessageBuilder.linkPreview = text.linkPreview
                 outgoingMessageBuilder.isVoiceMessage = text.isVoiceMessage
@@ -577,8 +575,7 @@ extension BackupArchiveTSOutgoingMessageArchiver: BackupArchiveTSMessageEditHist
             case .storyReply(let storyReply):
                 switch storyReply.replyType {
                 case .textReply(let textReply):
-                    outgoingMessageBuilder.messageBody = textReply.body.messageBody.text
-                    outgoingMessageBuilder.bodyRanges = textReply.body.messageBody.ranges
+                    outgoingMessageBuilder.setMessageBody(textReply.body)
                 case .emoji(let emoji):
                     outgoingMessageBuilder.storyReactionEmoji = emoji
                 }
diff --git a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupOversizeTextCache.swift b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupOversizeTextCache.swift
index 2732bedca74..8f1fdda1368 100644
--- a/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupOversizeTextCache.swift
+++ b/SignalServiceKit/Backups/Archiving/Archivers/ChatItem/BackupOversizeTextCache.swift
@@ -239,14 +239,14 @@ class BackupArchiveInlinedOversizeTextArchiver {
             ))
             text = text.trimToUtf8ByteCount(BackupOversizeTextCache.maxTextLengthBytes)
         }
-        let messageBody: MessageBody
+        let inlinedBody: MessageBody
         if inlinedTextLength > OWSMediaUtils.kOversizeTextMessageSizeThresholdBytes {
-            messageBody = MessageBody(
+            inlinedBody = MessageBody(
                 text: text.trimToUtf8ByteCount(OWSMediaUtils.kOversizeTextMessageSizeThresholdBytes),
                 ranges: bodyRanges
             )
         } else {
-            messageBody = MessageBody(text: text, ranges: bodyRanges)
+            inlinedBody = MessageBody(text: text, ranges: bodyRanges)
         }
 
         let oversizeText: RestoredMessageBody.OversizeText?
@@ -275,7 +275,7 @@ class BackupArchiveInlinedOversizeTextArchiver {
         }
 
         let restoredBody = RestoredMessageBody(
-            messageBody: messageBody,
+            inlinedBody: inlinedBody,
             oversizeText: oversizeText
         )
 
@@ -517,21 +517,19 @@ class BackupArchiveInlinedOversizeTextArchiver {
                 }
                 for (recordId, validatedMessageBody) in pendingAttachments {
                     maxRecordId = max(maxRecordId, recordId)
-                    switch validatedMessageBody {
-                    case .inline:
+                    guard let pendingAttachment = validatedMessageBody.oversizeText else {
                         owsFailDebug("Got oversize text thats fits a normal message?")
                         continue
-                    case let .oversize(_, pendingAttachment):
-                        guard let attachmentId = cacheIdToAttachmentId[recordId] else {
-                            owsFailDebug("Missing attachment id")
-                            continue
-                        }
-                        try attachmentManager.updateAttachmentWithOversizeTextFromBackup(
-                            attachmentId: attachmentId,
-                            pendingAttachment: pendingAttachment,
-                            tx: tx
-                        )
                     }
+                    guard let attachmentId = cacheIdToAttachmentId[recordId] else {
+                        owsFailDebug("Missing attachment id")
+                        continue
+                    }
+                    try attachmentManager.updateAttachmentWithOversizeTextFromBackup(
+                        attachmentId: attachmentId,
+                        pendingAttachment: pendingAttachment,
+                        tx: tx
+                    )
                 }
             }
         } catch let error {
diff --git a/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscript.swift b/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscript.swift
index 350dc943c3a..f5df1743372 100644
--- a/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscript.swift
+++ b/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscript.swift
@@ -27,8 +27,7 @@ public enum SentMessageTranscriptType {
     public struct Message {
         public let target: SentMessageTranscriptTarget
 
-        public let body: String?
-        public let bodyRanges: MessageBodyRanges?
+        public let body: ValidatedInlineMessageBody?
 
         public let attachmentPointerProtos: [SSKProtoAttachmentPointer]
 
diff --git a/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscriptReceiverImpl.swift b/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscriptReceiverImpl.swift
index cacd99dd526..8afbded30fa 100644
--- a/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscriptReceiverImpl.swift
+++ b/SignalServiceKit/Devices/SentMessageTranscriptReceiver/SentMessageTranscriptReceiverImpl.swift
@@ -199,7 +199,6 @@ public class SentMessageTranscriptReceiverImpl: SentMessageTranscriptReceiver {
             timestamp: transcript.timestamp,
             receivedAtTimestamp: nil,
             messageBody: messageParams.body,
-            bodyRanges: messageParams.bodyRanges,
             editState: .none, // Sent transcripts with edit state are handled by a different codepath
             expiresInSeconds: messageParams.expirationDurationSeconds,
             expireTimerVersion: messageParams.expireTimerVersion,
diff --git a/SignalServiceKit/Environment/AppSetup.swift b/SignalServiceKit/Environment/AppSetup.swift
index 16ba13a9672..cd7869aa046 100644
--- a/SignalServiceKit/Environment/AppSetup.swift
+++ b/SignalServiceKit/Environment/AppSetup.swift
@@ -659,6 +659,7 @@ public class AppSetup {
         let editMessageStore = EditMessageStoreImpl()
         let editManager = EditManagerImpl(
             context: .init(
+                attachmentContentValidator: attachmentContentValidator,
                 attachmentStore: attachmentStore,
                 dataStore: EditManagerImpl.Wrappers.DataStore(),
                 editManagerAttachments: EditManagerAttachmentsImpl(
diff --git a/SignalServiceKit/Jobs/SendGiftBadgeJobQueue.swift b/SignalServiceKit/Jobs/SendGiftBadgeJobQueue.swift
index 54d1694d35a..f9a5e6e2e50 100644
--- a/SignalServiceKit/Jobs/SendGiftBadgeJobQueue.swift
+++ b/SignalServiceKit/Jobs/SendGiftBadgeJobQueue.swift
@@ -243,11 +243,19 @@ private class SendGiftBadgeJobRunner: JobRunner {
             receiptCredentialRequestContext: receiptCredentialRequestContext
         )
 
+        let messageBody: ValidatedMessageBody?
+        if let text = jobRecord.messageText.nilIfEmpty {
+            messageBody = try await DependenciesBridge.shared.attachmentContentValidator
+                    .prepareOversizeTextIfNeeded(MessageBody(text: text, ranges: .empty))
+        } else {
+            messageBody = nil
+        }
+
         Logger.info("[Gifting] Enqueueing messages & finishing up...")
         try await SSKEnvironment.shared.databaseStorageRef.awaitableWrite { tx in
             try self.enqueueMessages(
                 threadUniqueId: jobRecord.threadId,
-                messageText: jobRecord.messageText,
+                messageBody: messageBody,
                 receiptCredentialPresentation: receiptCredentialPresentation,
                 tx: tx
             )
@@ -317,7 +325,7 @@ private class SendGiftBadgeJobRunner: JobRunner {
 
     private func enqueueMessages(
         threadUniqueId: String,
-        messageText: String,
+        messageBody: ValidatedMessageBody?,
         receiptCredentialPresentation: ReceiptCredentialPresentation,
         tx: DBWriteTransaction
     ) throws {
@@ -334,8 +342,8 @@ private class SendGiftBadgeJobRunner: JobRunner {
             tx: tx
         ))
 
-        if !messageText.isEmpty {
-            try send(UnpreparedOutgoingMessage.build(messageBody: messageText, thread: thread, tx: tx))
+        if let messageBody {
+            try send(UnpreparedOutgoingMessage.build(messageBody: messageBody, thread: thread, tx: tx))
         }
     }
 }
@@ -356,11 +364,11 @@ extension UnpreparedOutgoingMessage {
             expireTimerVersion: dmConfig.timerVersion,
             giftBadge: OWSGiftBadge(redemptionCredential: giftBadgeReceiptCredentialPresentation.serialize())
         )
-        return .forMessage(builder.build(transaction: tx))
+        return .forMessage(builder.build(transaction: tx), body: nil)
     }
 
     fileprivate static func build(
-        messageBody: String,
+        messageBody: ValidatedMessageBody,
         thread: TSThread,
         tx: DBReadTransaction
     ) -> UnpreparedOutgoingMessage {
@@ -372,6 +380,6 @@ extension UnpreparedOutgoingMessage {
             expiresInSeconds: dmConfig.durationSeconds,
             expireTimerVersion: dmConfig.timerVersion
         )
-        return .forMessage(builder.build(transaction: tx))
+        return .forMessage(builder.build(transaction: tx), body: messageBody)
     }
 }
diff --git a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidator.swift b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidator.swift
index 7b34506a5e0..ff2650902b4 100644
--- a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidator.swift
+++ b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidator.swift
@@ -49,11 +49,15 @@ public protocol RevalidatedAttachment {
     var orphanRecordId: OrphanedAttachmentRecord.IDType { get }
 }
 
-public enum ValidatedMessageBody {
-    /// The original body was small enough to send as-is.
-    case inline(MessageBody)
-    /// The original body was too large; we truncated and created an attachment with the untruncated text.
-    case oversize(truncated: MessageBody, fullsize: PendingAttachment)
+public protocol ValidatedInlineMessageBody {
+    /// The (possibly truncated) body to inline in the message.
+    var inlinedBody: MessageBody { get }
+}
+
+public protocol ValidatedMessageBody: ValidatedInlineMessageBody {
+    /// If the original text didn't fit inline, the pending attachment that
+    /// should be used to create the oversize text Attachment.
+    var oversizeText: PendingAttachment? { get }
 }
 
 public protocol AttachmentContentValidator {
@@ -141,6 +145,20 @@ public protocol AttachmentContentValidator {
         sourceFilename: String?
     ) async throws -> PendingAttachment
 
+    /// Truncates the provided message body if necessary for inlining in a message,
+    /// dropping any remaining text even if it might otherwise fit in an oversized text
+    /// attachment.
+    /// It is much preferred to use ``prepareOversizeTextsIfNeeded(from:)``;
+    /// this method only exists as a temporary solution for callsites that process bodies
+    /// from within inescapable write transactions and therefore cannot do the
+    /// double-commit necessary to prepare an oversize text Attachment.
+    /// (This method takes a transaction, despite not using it, to nudge callers.
+    /// If you're not already in a write tx, you should use prepareOversizeTextsIfNeeded).
+    func truncatedMessageBodyForInlining(
+        _ body: MessageBody,
+        tx: DBWriteTransaction
+    ) -> ValidatedInlineMessageBody
+
     /// If the provided message body is large enough to require an oversize text
     /// attachment, creates a pending one, alongside the truncated message body.
     /// If not, just returns the message body as is.
diff --git a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
index 65b31d9399a..832add62da0 100644
--- a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
+++ b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
@@ -222,6 +222,21 @@ public class AttachmentContentValidatorImpl: AttachmentContentValidator {
         ).values.first!
     }
 
+    public func truncatedMessageBodyForInlining(
+        _ body: MessageBody,
+        tx: DBWriteTransaction
+    ) -> ValidatedInlineMessageBody {
+        guard !body.text.isEmpty else {
+            return ValidatedMessageBodyImpl(inlinedBody: body, oversizeText: nil)
+        }
+        guard let truncatedText = body.text.trimmedIfNeeded(maxByteCount: OWSMediaUtils.kOversizeTextMessageSizeThresholdBytes) else {
+            // No need to truncate
+            return ValidatedMessageBodyImpl(inlinedBody: body, oversizeText: nil)
+        }
+        let truncatedBody = MessageBody(text: truncatedText, ranges: body.ranges)
+        return ValidatedMessageBodyImpl(inlinedBody: truncatedBody, oversizeText: nil)
+    }
+
     public func prepareOversizeTextsIfNeeded<Key: Hashable>(
         from texts: [Key: MessageBody],
         encryptionKeys: [Key: Data],
@@ -233,7 +248,7 @@ public class AttachmentContentValidatorImpl: AttachmentContentValidator {
             let truncatedText = messageBody.text.trimmedIfNeeded(maxByteCount: OWSMediaUtils.kOversizeTextMessageSizeThresholdBytes)
             guard let truncatedText else {
                 // No need to truncate
-                results[key] = .inline(messageBody)
+                results[key] = ValidatedMessageBodyImpl(inlinedBody: messageBody, oversizeText: nil)
                 continue
             }
             let truncatedBody = MessageBody(text: truncatedText, ranges: messageBody.ranges)
@@ -262,7 +277,7 @@ public class AttachmentContentValidatorImpl: AttachmentContentValidator {
             guard let truncatedBody = truncatedBodies[key] else {
                 throw OWSAssertionError("Missing truncated body!")
             }
-            results[key] = .oversize(truncated: truncatedBody, fullsize: pendingAttachment)
+            results[key] = ValidatedMessageBodyImpl(inlinedBody: truncatedBody, oversizeText: pendingAttachment)
         }
 
         return results
@@ -339,6 +354,11 @@ public class AttachmentContentValidatorImpl: AttachmentContentValidator {
         let orphanRecordId: OrphanedAttachmentRecord.IDType
     }
 
+    private struct ValidatedMessageBodyImpl: ValidatedMessageBody {
+        let inlinedBody: MessageBody
+        let oversizeText: (any PendingAttachment)?
+    }
+
     private enum InputType {
         case inMemory(Data)
         case unencryptedFile(URL)
diff --git a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorMock.swift b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorMock.swift
index 0d33831717b..e838aeed5d3 100644
--- a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorMock.swift
+++ b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorMock.swift
@@ -63,11 +63,31 @@ open class AttachmentContentValidatorMock: AttachmentContentValidator {
         throw OWSAssertionError("Unimplemented")
     }
 
+    struct MockValidatedMessageBody: ValidatedMessageBody {
+        var oversizeText: (any PendingAttachment)? { nil }
+        let inlinedBody: MessageBody
+
+        fileprivate init(inlinedBody: MessageBody) {
+            self.inlinedBody = inlinedBody
+        }
+    }
+
+    static func mockValidatedBody(_ body: String) -> ValidatedMessageBody {
+        return MockValidatedMessageBody(inlinedBody: MessageBody(text: body, ranges: .empty))
+    }
+
+    open func truncatedMessageBodyForInlining(
+        _ body: MessageBody,
+        tx: DBWriteTransaction
+    ) -> ValidatedInlineMessageBody {
+        return MockValidatedMessageBody(inlinedBody: body)
+    }
+
     open func prepareOversizeTextsIfNeeded<Key: Hashable>(
         from texts: [Key: MessageBody],
         encryptionKeys: [Key: Data],
     ) async throws -> [Key: ValidatedMessageBody] {
-        return texts.mapValues { .inline($0) }
+        throw OWSAssertionError("Unimplemented")
     }
 
     open func prepareQuotedReplyThumbnail(
diff --git a/SignalServiceKit/Messages/DeviceSyncing/OWSIncomingSentMessageTranscript.swift b/SignalServiceKit/Messages/DeviceSyncing/OWSIncomingSentMessageTranscript.swift
index b345108b2f6..9c47de6bb75 100644
--- a/SignalServiceKit/Messages/DeviceSyncing/OWSIncomingSentMessageTranscript.swift
+++ b/SignalServiceKit/Messages/DeviceSyncing/OWSIncomingSentMessageTranscript.swift
@@ -209,13 +209,12 @@ public class OWSIncomingSentMessageTranscript: SentMessageTranscript {
     ) throws -> SentMessageTranscriptType.Message? {
         let isViewOnceMessage = dataMessage.hasIsViewOnce && dataMessage.isViewOnce
 
-        let body = dataMessage.body
-
-        let bodyRanges: MessageBodyRanges?
-        if dataMessage.bodyRanges.isEmpty.negated {
-            bodyRanges = MessageBodyRanges(protos: dataMessage.bodyRanges)
-        } else {
-            bodyRanges = nil
+        let bodyRanges = dataMessage.bodyRanges.isEmpty ? MessageBodyRanges.empty : MessageBodyRanges(protos: dataMessage.bodyRanges)
+        let body = dataMessage.body.map {
+            DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+                MessageBody(text: $0, ranges: bodyRanges),
+                tx: tx
+            )
         }
 
         let makeContactBuilder = { [dataMessage] tx in
@@ -301,7 +300,6 @@ public class OWSIncomingSentMessageTranscript: SentMessageTranscript {
         return .init(
             target: target,
             body: body,
-            bodyRanges: bodyRanges,
             attachmentPointerProtos: dataMessage.attachments,
             makeQuotedMessageBuilder: makeQuotedMessageBuilder,
             makeContactBuilder: makeContactBuilder,
diff --git a/SignalServiceKit/Messages/Edit/EditManagerImpl.swift b/SignalServiceKit/Messages/Edit/EditManagerImpl.swift
index f2157a74943..d194b4ccedc 100644
--- a/SignalServiceKit/Messages/Edit/EditManagerImpl.swift
+++ b/SignalServiceKit/Messages/Edit/EditManagerImpl.swift
@@ -30,6 +30,7 @@ public class EditManagerImpl: EditManager {
     }
 
     public struct Context {
+        let attachmentContentValidator: AttachmentContentValidator
         let attachmentStore: AttachmentStore
         let dataStore: EditManagerImpl.Shims.DataStore
         let editManagerAttachments: EditManagerAttachments
@@ -37,12 +38,14 @@ public class EditManagerImpl: EditManager {
         let receiptManagerShim: EditManagerImpl.Shims.ReceiptManager
 
         public init(
+            attachmentContentValidator: AttachmentContentValidator,
             attachmentStore: AttachmentStore,
             dataStore: EditManagerImpl.Shims.DataStore,
             editManagerAttachments: EditManagerAttachments,
             editMessageStore: EditMessageStore,
             receiptManagerShim: EditManagerImpl.Shims.ReceiptManager
         ) {
+            self.attachmentContentValidator = attachmentContentValidator
             self.attachmentStore = attachmentStore
             self.dataStore = dataStore
             self.editManagerAttachments = editManagerAttachments
@@ -83,7 +86,7 @@ public class EditManagerImpl: EditManager {
             tx: tx
         )
 
-        var bodyRanges: MessageBodyRanges?
+        var bodyRanges: MessageBodyRanges = .empty
         if !newDataMessage.bodyRanges.isEmpty {
             bodyRanges = MessageBodyRanges(protos: newDataMessage.bodyRanges)
         }
@@ -107,6 +110,13 @@ public class EditManagerImpl: EditManager {
 
         let linkPreview = newDataMessage.preview.first.map { MessageEdits.LinkPreviewSource.proto($0, newDataMessage) }
 
+        let body = newDataMessage.body.map {
+            context.attachmentContentValidator.truncatedMessageBodyForInlining(
+                MessageBody(text: $0, ranges: bodyRanges),
+                    tx: tx
+            )
+        }
+
         let edits: MessageEdits = .forIncomingEdit(
             timestamp: .change(newDataMessage.timestamp),
             // Received now!
@@ -114,8 +124,7 @@ public class EditManagerImpl: EditManager {
             serverTimestamp: .change(serverTimestamp),
             serverDeliveryTimestamp: .change(serverDeliveryTimestamp),
             serverGuid: .change(serverGuid),
-            body: .change(newDataMessage.body),
-            bodyRanges: .change(bodyRanges)
+            body: .change(body),
         )
 
         let editedMessage = try applyAndInsertEdits(
@@ -277,7 +286,9 @@ public class EditManagerImpl: EditManager {
         /// Keep the original message's timestamp, as well as its content.
         let priorRevisionMessageBuilder = editTargetWrapper.cloneAsBuilderWithoutAttachments(
             applying: .noChanges(),
-            isLatestRevision: false
+            isLatestRevision: false,
+            attachmentContentValidator: context.attachmentContentValidator,
+            tx: tx
         )
         let priorRevisionMessage = EditTarget.build(
             priorRevisionMessageBuilder,
@@ -333,12 +344,14 @@ public class EditManagerImpl: EditManager {
     private func createEditedMessage<EditTarget: EditMessageWrapper>(
         editTargetWrapper editTarget: EditTarget,
         edits: MessageEdits,
-        tx: DBReadTransaction
+        tx: DBWriteTransaction
     ) -> EditTarget.MessageType {
 
         let editedMessageBuilder = editTarget.cloneAsBuilderWithoutAttachments(
             applying: edits,
-            isLatestRevision: true
+            isLatestRevision: true,
+            attachmentContentValidator: context.attachmentContentValidator,
+            tx: tx
         )
 
         let editedMessage = EditTarget.build(
diff --git a/SignalServiceKit/Messages/Edit/EditMessageWrapper.swift b/SignalServiceKit/Messages/Edit/EditMessageWrapper.swift
index d389f401ef4..90ccc6a434b 100644
--- a/SignalServiceKit/Messages/Edit/EditMessageWrapper.swift
+++ b/SignalServiceKit/Messages/Edit/EditMessageWrapper.swift
@@ -25,7 +25,9 @@ public protocol EditMessageWrapper {
     /// zeroing-out any attachment-related fields.
     func cloneAsBuilderWithoutAttachments(
         applying: MessageEdits,
-        isLatestRevision: Bool
+        isLatestRevision: Bool,
+        attachmentContentValidator: AttachmentContentValidator,
+        tx: DBWriteTransaction
     ) -> MessageBuilderType
 
     static func build(
@@ -87,7 +89,9 @@ public struct IncomingEditMessageWrapper: EditMessageWrapper {
 
     public func cloneAsBuilderWithoutAttachments(
         applying edits: MessageEdits,
-        isLatestRevision: Bool
+        isLatestRevision: Bool,
+        attachmentContentValidator: AttachmentContentValidator,
+        tx: DBWriteTransaction
     ) -> TSIncomingMessageBuilder {
         let editState: TSEditState = {
             if isLatestRevision {
@@ -101,8 +105,18 @@ public struct IncomingEditMessageWrapper: EditMessageWrapper {
             }
         }()
 
-        let body = edits.body.unwrapChange(orKeepValue: message.body)
-        let bodyRanges = edits.bodyRanges.unwrapChange(orKeepValue: message.bodyRanges)
+        let messageBody: ValidatedInlineMessageBody?
+        switch edits.body {
+        case .keep:
+            messageBody = message.body.map {
+                attachmentContentValidator.truncatedMessageBodyForInlining(
+                    MessageBody(text: $0, ranges: message.bodyRanges ?? .empty),
+                    tx: tx
+                )
+            }
+        case .change(let body):
+            messageBody = body
+        }
         let timestamp = edits.timestamp.unwrapChange(orKeepValue: message.timestamp)
         let receivedAtTimestamp = edits.receivedAtTimestamp.unwrapChange(orKeepValue: message.receivedAtTimestamp)
         let serverTimestamp = edits.serverTimestamp.unwrapChange(orKeepValue: message.serverTimestamp?.uint64Value ?? 0)
@@ -118,8 +132,7 @@ public struct IncomingEditMessageWrapper: EditMessageWrapper {
             receivedAtTimestamp: receivedAtTimestamp,
             authorAci: authorAci,
             authorE164: nil,
-            messageBody: body,
-            bodyRanges: bodyRanges,
+            messageBody: messageBody,
             editState: editState,
             // Prior revisions don't expire (timer=0); instead they
             // are cascade-deleted when the latest revision expires.
@@ -180,10 +193,22 @@ public struct OutgoingEditMessageWrapper: EditMessageWrapper {
 
     public func cloneAsBuilderWithoutAttachments(
         applying edits: MessageEdits,
-        isLatestRevision: Bool
+        isLatestRevision: Bool,
+        attachmentContentValidator: AttachmentContentValidator,
+        tx: DBWriteTransaction
     ) -> TSOutgoingMessageBuilder {
-        let body = edits.body.unwrapChange(orKeepValue: message.body)
-        let bodyRanges = edits.bodyRanges.unwrapChange(orKeepValue: message.bodyRanges)
+        let messageBody: ValidatedInlineMessageBody?
+        switch edits.body {
+        case .keep:
+            messageBody = message.body.map {
+                attachmentContentValidator.truncatedMessageBodyForInlining(
+                    MessageBody(text: $0, ranges: message.bodyRanges ?? .empty),
+                    tx: tx
+                )
+            }
+        case .change(let body):
+            messageBody = body
+        }
         let timestamp = edits.timestamp.unwrapChange(orKeepValue: message.timestamp)
         let receivedAtTimestamp = edits.receivedAtTimestamp.unwrapChange(orKeepValue: message.receivedAtTimestamp)
 
@@ -194,8 +219,7 @@ public struct OutgoingEditMessageWrapper: EditMessageWrapper {
             thread: thread,
             timestamp: timestamp,
             receivedAtTimestamp: receivedAtTimestamp,
-            messageBody: body,
-            bodyRanges: bodyRanges,
+            messageBody: messageBody,
             // Outgoing messages are implicitly read.
             editState: isLatestRevision ? .latestRevisionRead : .pastRevision,
             // Prior revisions don't expire (timer=0); instead they
diff --git a/SignalServiceKit/Messages/Edit/MessageEdits.swift b/SignalServiceKit/Messages/Edit/MessageEdits.swift
index 15fe75fb0e9..3ff56330204 100644
--- a/SignalServiceKit/Messages/Edit/MessageEdits.swift
+++ b/SignalServiceKit/Messages/Edit/MessageEdits.swift
@@ -25,9 +25,7 @@ public struct MessageEdits {
     }
 
     /// - SeeAlso ``TSMessage/body``
-    public let body: Edit<String?>
-    /// - SeeAlso ``TSMessage/bodyRanges``
-    public let bodyRanges: Edit<MessageBodyRanges?>
+    public let body: Edit<ValidatedInlineMessageBody?>
 
     /// - SeeAlso ``TSInteraction/timestamp``
     public let timestamp: Edit<UInt64>
@@ -49,8 +47,7 @@ public struct MessageEdits {
         serverTimestamp: Edit<UInt64>,
         serverDeliveryTimestamp: Edit<UInt64>,
         serverGuid: Edit<String?>,
-        body: Edit<String?>,
-        bodyRanges: Edit<MessageBodyRanges?>
+        body: Edit<ValidatedInlineMessageBody?>,
     ) -> MessageEdits {
         return MessageEdits(
             timestamp: timestamp,
@@ -59,15 +56,13 @@ public struct MessageEdits {
             serverDeliveryTimestamp: serverDeliveryTimestamp,
             serverGuid: serverGuid,
             body: body,
-            bodyRanges: bodyRanges
         )
     }
 
     public static func forOutgoingEdit(
         timestamp: Edit<UInt64>,
         receivedAtTimestamp: Edit<UInt64>,
-        body: Edit<String?>,
-        bodyRanges: Edit<MessageBodyRanges?>
+        body: Edit<ValidatedInlineMessageBody?>,
     ) -> MessageEdits {
         return MessageEdits(
             timestamp: timestamp,
@@ -79,7 +74,6 @@ public struct MessageEdits {
             // Not relevant to outgoing edits.
             serverGuid: .keep,
             body: body,
-            bodyRanges: bodyRanges
         )
     }
 
@@ -92,7 +86,6 @@ public struct MessageEdits {
             serverDeliveryTimestamp: .keep,
             serverGuid: .keep,
             body: .keep,
-            bodyRanges: .keep
         )
     }
 
@@ -102,8 +95,7 @@ public struct MessageEdits {
         serverTimestamp: Edit<UInt64>,
         serverDeliveryTimestamp: Edit<UInt64>,
         serverGuid: Edit<String?>,
-        body: Edit<String?>,
-        bodyRanges: Edit<MessageBodyRanges?>
+        body: Edit<ValidatedInlineMessageBody?>,
     ) {
         self.timestamp = timestamp
         self.receivedAtTimestamp = receivedAtTimestamp
@@ -111,6 +103,5 @@ public struct MessageEdits {
         self.serverDeliveryTimestamp = serverDeliveryTimestamp
         self.serverGuid = serverGuid
         self.body = body
-        self.bodyRanges = bodyRanges
     }
 }
diff --git a/SignalServiceKit/Messages/Interactions/TSErrorMessage+Builder.swift b/SignalServiceKit/Messages/Interactions/TSErrorMessage+Builder.swift
index 074f7012aed..e4a99914767 100644
--- a/SignalServiceKit/Messages/Interactions/TSErrorMessage+Builder.swift
+++ b/SignalServiceKit/Messages/Interactions/TSErrorMessage+Builder.swift
@@ -21,7 +21,6 @@ public class TSErrorMessageBuilder: TSMessageBuilder {
             timestamp: nil,
             receivedAtTimestamp: nil,
             messageBody: nil,
-            bodyRanges: nil,
             editState: .none,
             expiresInSeconds: nil,
             expireTimerVersion: nil,
diff --git a/SignalServiceKit/Messages/Interactions/TSIncomingMessage+Builder.swift b/SignalServiceKit/Messages/Interactions/TSIncomingMessage+Builder.swift
index 040a8251f5a..b3482c0c9c7 100644
--- a/SignalServiceKit/Messages/Interactions/TSIncomingMessage+Builder.swift
+++ b/SignalServiceKit/Messages/Interactions/TSIncomingMessage+Builder.swift
@@ -30,8 +30,7 @@ public class TSIncomingMessageBuilder: TSMessageBuilder {
         receivedAtTimestamp: UInt64?,
         authorAci: Aci?,
         authorE164: E164?,
-        messageBody: String?,
-        bodyRanges: MessageBodyRanges?,
+        messageBody: ValidatedInlineMessageBody?,
         editState: TSEditState,
         expiresInSeconds: UInt32,
         expireTimerVersion: UInt32?,
@@ -69,7 +68,6 @@ public class TSIncomingMessageBuilder: TSMessageBuilder {
             timestamp: timestamp,
             receivedAtTimestamp: receivedAtTimestamp,
             messageBody: messageBody,
-            bodyRanges: bodyRanges,
             editState: editState,
             expiresInSeconds: expiresInSeconds,
             expireTimerVersion: expireTimerVersion,
@@ -96,8 +94,7 @@ public class TSIncomingMessageBuilder: TSMessageBuilder {
         receivedAtTimestamp: UInt64? = nil,
         authorAci: Aci? = nil,
         authorE164: E164? = nil,
-        messageBody: String? = nil,
-        bodyRanges: MessageBodyRanges? = nil,
+        messageBody: ValidatedInlineMessageBody? = nil,
         editState: TSEditState = .none,
         expiresInSeconds: UInt32 = 0,
         expireTimerVersion: UInt32? = nil,
@@ -128,7 +125,6 @@ public class TSIncomingMessageBuilder: TSMessageBuilder {
             authorAci: authorAci,
             authorE164: authorE164,
             messageBody: messageBody,
-            bodyRanges: bodyRanges,
             editState: editState,
             expiresInSeconds: expiresInSeconds,
             expireTimerVersion: expireTimerVersion,
diff --git a/SignalServiceKit/Messages/Interactions/TSMessage+Builder.swift b/SignalServiceKit/Messages/Interactions/TSMessage+Builder.swift
index 3873addd920..7f36096891d 100644
--- a/SignalServiceKit/Messages/Interactions/TSMessage+Builder.swift
+++ b/SignalServiceKit/Messages/Interactions/TSMessage+Builder.swift
@@ -10,8 +10,8 @@ public class TSMessageBuilder: NSObject {
     public let thread: TSThread
     public var timestamp: UInt64
     public var receivedAtTimestamp: UInt64
-    public var messageBody: String?
-    public var bodyRanges: MessageBodyRanges?
+    public private(set) var messageBody: String?
+    public private(set) var bodyRanges: MessageBodyRanges?
     public var editState: TSEditState
     public var expiresInSeconds: UInt32
     public var expireTimerVersion: NSNumber?
@@ -39,8 +39,7 @@ public class TSMessageBuilder: NSObject {
         thread: TSThread,
         timestamp: UInt64?,
         receivedAtTimestamp: UInt64?,
-        messageBody: String?,
-        bodyRanges: MessageBodyRanges?,
+        messageBody: ValidatedInlineMessageBody?,
         editState: TSEditState,
         expiresInSeconds: UInt32?,
         expireTimerVersion: UInt32?,
@@ -63,8 +62,8 @@ public class TSMessageBuilder: NSObject {
         self.thread = thread
         self.timestamp = timestamp ?? nowMs
         self.receivedAtTimestamp = receivedAtTimestamp ?? nowMs
-        self.messageBody = messageBody
-        self.bodyRanges = bodyRanges
+        self.messageBody = messageBody?.inlinedBody.text
+        self.bodyRanges = messageBody?.inlinedBody.ranges
         self.editState = editState
         self.expiresInSeconds = expiresInSeconds ?? 0
         self.expireTimerVersion = expireTimerVersion.map(NSNumber.init(value:))
@@ -91,8 +90,7 @@ public class TSMessageBuilder: NSObject {
         thread: TSThread,
         timestamp: UInt64? = nil,
         receivedAtTimestamp: UInt64? = nil,
-        messageBody: String? = nil,
-        bodyRanges: MessageBodyRanges? = nil,
+        messageBody: ValidatedInlineMessageBody? = nil,
         editState: TSEditState = .none,
         expiresInSeconds: UInt32? = nil,
         expireTimerVersion: UInt32? = nil,
@@ -115,7 +113,6 @@ public class TSMessageBuilder: NSObject {
             timestamp: timestamp,
             receivedAtTimestamp: receivedAtTimestamp,
             messageBody: messageBody,
-            bodyRanges: bodyRanges,
             editState: editState,
             expiresInSeconds: expiresInSeconds,
             expireTimerVersion: expireTimerVersion,
@@ -135,6 +132,11 @@ public class TSMessageBuilder: NSObject {
         )
     }
 
+    public func setMessageBody(_ messageBody: ValidatedInlineMessageBody?) {
+        self.messageBody = messageBody?.inlinedBody.text
+        self.bodyRanges = messageBody?.inlinedBody.ranges
+    }
+
     class func messageBuilder(thread: TSThread) -> TSMessageBuilder {
         return .withDefaultValues(thread: thread)
     }
diff --git a/SignalServiceKit/Messages/Interactions/TSOutgoingMessage+Builder.swift b/SignalServiceKit/Messages/Interactions/TSOutgoingMessage+Builder.swift
index ea9ddfffc04..872f410d7d0 100644
--- a/SignalServiceKit/Messages/Interactions/TSOutgoingMessage+Builder.swift
+++ b/SignalServiceKit/Messages/Interactions/TSOutgoingMessage+Builder.swift
@@ -17,8 +17,7 @@ public class TSOutgoingMessageBuilder: TSMessageBuilder {
         thread: TSThread,
         timestamp: UInt64?,
         receivedAtTimestamp: UInt64?,
-        messageBody: String?,
-        bodyRanges: MessageBodyRanges?,
+        messageBody: ValidatedInlineMessageBody?,
         editState: TSEditState,
         expiresInSeconds: UInt32?,
         expireTimerVersion: UInt32?,
@@ -50,7 +49,6 @@ public class TSOutgoingMessageBuilder: TSMessageBuilder {
             timestamp: timestamp,
             receivedAtTimestamp: receivedAtTimestamp,
             messageBody: messageBody,
-            bodyRanges: bodyRanges,
             editState: editState,
             expiresInSeconds: expiresInSeconds,
             expireTimerVersion: expireTimerVersion,
@@ -75,8 +73,7 @@ public class TSOutgoingMessageBuilder: TSMessageBuilder {
         thread: TSThread,
         timestamp: UInt64? = nil,
         receivedAtTimestamp: UInt64? = nil,
-        messageBody: String? = nil,
-        bodyRanges: MessageBodyRanges? = nil,
+        messageBody: ValidatedInlineMessageBody? = nil,
         editState: TSEditState = .none,
         expiresInSeconds: UInt32? = nil,
         expireTimerVersion: UInt32? = nil,
@@ -103,7 +100,6 @@ public class TSOutgoingMessageBuilder: TSMessageBuilder {
             timestamp: timestamp,
             receivedAtTimestamp: receivedAtTimestamp,
             messageBody: messageBody,
-            bodyRanges: bodyRanges,
             editState: editState,
             expiresInSeconds: expiresInSeconds,
             expireTimerVersion: expireTimerVersion,
@@ -137,7 +133,7 @@ public class TSOutgoingMessageBuilder: TSMessageBuilder {
 
     public static func outgoingMessageBuilder(
         thread: TSThread,
-        messageBody: String?
+        messageBody: ValidatedInlineMessageBody?
     ) -> TSOutgoingMessageBuilder {
         return .withDefaultValues(thread: thread, messageBody: messageBody)
     }
diff --git a/SignalServiceKit/Messages/MessageReceiver.swift b/SignalServiceKit/Messages/MessageReceiver.swift
index d1217dab9c0..971b5cf00f1 100644
--- a/SignalServiceKit/Messages/MessageReceiver.swift
+++ b/SignalServiceKit/Messages/MessageReceiver.swift
@@ -977,8 +977,15 @@ public final class MessageReceiver {
             return nil
         }
 
-        let body = dataMessage.body
-        let bodyRanges = dataMessage.bodyRanges.isEmpty ? nil : MessageBodyRanges(protos: dataMessage.bodyRanges)
+        let bodyRanges = dataMessage.bodyRanges.isEmpty ? MessageBodyRanges.empty : MessageBodyRanges(protos: dataMessage.bodyRanges)
+        let body = dataMessage.body.map {
+            // Note: we already checked above that the length doesn't need truncation; this
+            // just returns the validated body object needed for downstream APIs.
+            DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+                MessageBody(text: $0, ranges: bodyRanges),
+                tx: tx
+            )
+        }
         let serverGuid = envelope.envelope.serverGuid.flatMap { UUID(uuidString: $0) }
         let quotedMessageBuilder = DependenciesBridge.shared.quotedReplyManager.quotedMessage(
             for: dataMessage,
@@ -1097,7 +1104,6 @@ public final class MessageReceiver {
             authorAci: envelope.sourceAci,
             authorE164: nil,
             messageBody: body,
-            bodyRanges: bodyRanges,
             editState: .none,
             expiresInSeconds: dataMessage.expireTimer,
             expireTimerVersion: dataMessage.expireTimerVersion,
diff --git a/SignalServiceKit/Messages/OutgoingMessagePreparer/UnpreparedOutgoingMessage.swift b/SignalServiceKit/Messages/OutgoingMessagePreparer/UnpreparedOutgoingMessage.swift
index 86dcc235360..9d15896d4cb 100644
--- a/SignalServiceKit/Messages/OutgoingMessagePreparer/UnpreparedOutgoingMessage.swift
+++ b/SignalServiceKit/Messages/OutgoingMessagePreparer/UnpreparedOutgoingMessage.swift
@@ -16,13 +16,16 @@ public class UnpreparedOutgoingMessage {
 
     public static func forMessage(
         _ message: TSOutgoingMessage,
+        body: ValidatedMessageBody?,
         unsavedBodyMediaAttachments: [AttachmentDataSource] = [],
-        oversizeTextDataSource: AttachmentDataSource? = nil,
         linkPreviewDraft: LinkPreviewDataSource? = nil,
         quotedReplyDraft: DraftQuotedReplyModel.ForSending? = nil,
         messageStickerDraft: MessageStickerDataSource? = nil,
         contactShareDraft: ContactShareDraft.ForSending? = nil
     ) -> UnpreparedOutgoingMessage {
+        let oversizeTextDataSource = (body?.oversizeText).map {
+            AttachmentDataSource.pendingAttachment($0)
+        }
         if !message.shouldBeSaved {
             owsAssertDebug(
                 unsavedBodyMediaAttachments.isEmpty
diff --git a/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.h b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.h
index 76f5a910e88..1e3c97d7524 100644
--- a/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.h
+++ b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.h
@@ -69,12 +69,9 @@ NS_ASSUME_NONNULL_BEGIN
                 storedMessageState:(TSOutgoingMessageState)storedMessageState
               wasNotCreatedLocally:(BOOL)wasNotCreatedLocally NS_UNAVAILABLE;
 
-- (instancetype)initWithThread:(TSThread *)thread
-                   messageBody:(nullable NSString *)messageBody
-           paymentNotification:(TSPaymentNotification *)paymentNotification
-              expiresInSeconds:(uint32_t)expiresInSeconds
-            expireTimerVersion:(nullable NSNumber *)expireTimerVersion
-                   transaction:(DBReadTransaction *)transaction NS_DESIGNATED_INITIALIZER;
+- (instancetype)initWithBuilder:(TSOutgoingMessageBuilder *)builder
+            paymentNotification:(TSPaymentNotification *)paymentNotification
+                    transaction:(DBReadTransaction *)transaction NS_DESIGNATED_INITIALIZER;
 
 // --- CODE GENERATION MARKER
 
diff --git a/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.m b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.m
index 61a95f888fc..327d2064485 100644
--- a/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.m
+++ b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.m
@@ -12,21 +12,12 @@
 
 @implementation OWSOutgoingPaymentMessage
 
-- (instancetype)initWithThread:(TSThread *)thread
-                   messageBody:(nullable NSString *)messageBody
-           paymentNotification:(TSPaymentNotification *)paymentNotification
-              expiresInSeconds:(uint32_t)expiresInSeconds
-            expireTimerVersion:(nullable NSNumber *)expireTimerVersion
-                   transaction:(DBReadTransaction *)transaction
+- (instancetype)initWithBuilder:(TSOutgoingMessageBuilder *)messageBuilder
+            paymentNotification:(TSPaymentNotification *)paymentNotification
+                    transaction:(DBReadTransaction *)transaction
 {
     OWSAssertDebug(paymentNotification != nil);
 
-    TSOutgoingMessageBuilder *messageBuilder = [TSOutgoingMessageBuilder outgoingMessageBuilderWithThread:thread];
-    // Body ranges unsupported.
-    messageBuilder.messageBody = messageBody;
-    messageBuilder.isViewOnceMessage = false;
-    messageBuilder.expiresInSeconds = expiresInSeconds;
-    messageBuilder.expireTimerVersion = expireTimerVersion;
     self = [super initOutgoingMessageWithBuilder:messageBuilder
                             additionalRecipients:@[]
                               explicitRecipients:@[]
diff --git a/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.swift b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.swift
new file mode 100644
index 00000000000..841c9c513a3
--- /dev/null
+++ b/SignalServiceKit/Messages/Payments/OWSOutgoingPaymentMessage.swift
@@ -0,0 +1,28 @@
+//
+// Copyright 2025 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+extension OWSOutgoingPaymentMessage {
+
+    public convenience init(
+        thread: TSThread,
+        messageBody: ValidatedInlineMessageBody?,
+        paymentNotification: TSPaymentNotification,
+        expiresInSeconds: UInt32,
+        expireTimerVersion: UInt32?,
+        tx: DBReadTransaction
+    ) {
+        let messageBuilder = TSOutgoingMessageBuilder.outgoingMessageBuilder(thread: thread)
+        messageBuilder.setMessageBody(messageBody)
+        messageBuilder.isViewOnceMessage = false
+        messageBuilder.expiresInSeconds = expiresInSeconds
+        messageBuilder.expireTimerVersion = expireTimerVersion.map(NSNumber.init(value:))
+
+        self.init(
+            builder: messageBuilder,
+            paymentNotification: paymentNotification,
+            transaction: tx
+        )
+    }
+}
diff --git a/SignalServiceKit/Payments/PaymentsHelperImpl.swift b/SignalServiceKit/Payments/PaymentsHelperImpl.swift
index 694bb7c32d6..998e556f1e7 100644
--- a/SignalServiceKit/Payments/PaymentsHelperImpl.swift
+++ b/SignalServiceKit/Payments/PaymentsHelperImpl.swift
@@ -431,7 +431,13 @@ public class PaymentsHelperImpl: PaymentsHelperSwift, PaymentsHelper {
                 throw OWSAssertionError("Invalid payment sync message: invalid feeAmount.")
             }
             let recipientPublicAddressData = mobileCoinProto.recipientAddress
-            let memoMessage = paymentProto.note?.nilIfEmpty
+            let memoMessage = paymentProto.note?.nilIfEmpty.map {
+                DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+                    MessageBody(text: $0, ranges: .empty),
+                    tx: transaction
+                )
+            }
+
             let spentKeyImages = Array(Set(mobileCoinProto.spentKeyImages))
             owsAssertDebug(spentKeyImages.count == mobileCoinProto.spentKeyImages.count)
             guard !spentKeyImages.isEmpty else {
@@ -498,7 +504,7 @@ public class PaymentsHelperImpl: PaymentsHelperSwift, PaymentsHelper {
                                               paymentAmount: paymentAmount,
                                               createdDate: Date(millisecondsSince1970: messageTimestamp),
                                               senderOrRecipientAci: recipientAci.map { AciObjC($0) },
-                                              memoMessage: memoMessage,
+                                              memoMessage: memoMessage?.inlinedBody.text,
                                               isUnread: false,
                                               interactionUniqueId: nil,
                                               mobileCoin: mobileCoin)
@@ -517,7 +523,7 @@ public class PaymentsHelperImpl: PaymentsHelperSwift, PaymentsHelper {
                     transaction: transaction
                 )
                 let paymentNotification = TSPaymentNotification(
-                    memoMessage: memoMessage,
+                    memoMessage: memoMessage?.inlinedBody.text,
                     mcReceiptData: mcReceiptData
                 )
                 let dmConfigurationStore = DependenciesBridge.shared.disappearingMessagesConfigurationStore
@@ -527,8 +533,8 @@ public class PaymentsHelperImpl: PaymentsHelperSwift, PaymentsHelper {
                     messageBody: memoMessage,
                     paymentNotification: paymentNotification,
                     expiresInSeconds: dmConfig.durationSeconds,
-                    expireTimerVersion: NSNumber(value: dmConfig.timerVersion),
-                    transaction: transaction
+                    expireTimerVersion: dmConfig.timerVersion,
+                    tx: transaction
                 )
                 message.anyInsert(transaction: transaction)
                 paymentModel.update(withInteractionUniqueId: message.uniqueId, transaction: transaction)
diff --git a/SignalServiceKit/TestUtils/Factories.swift b/SignalServiceKit/TestUtils/Factories.swift
index 9d08c60ad71..7dc07058102 100644
--- a/SignalServiceKit/TestUtils/Factories.swift
+++ b/SignalServiceKit/TestUtils/Factories.swift
@@ -123,8 +123,7 @@ public class OutgoingMessageFactory: Factory {
             thread: threadCreator(transaction),
             timestamp: timestampBuilder(),
             receivedAtTimestamp: receivedAtTimestampBuilder(),
-            messageBody: messageBodyBuilder(),
-            bodyRanges: bodyRangesBuilder(),
+            messageBody: validatedMessageBodyBuilder(transaction),
             editState: editStateBuilder(),
             expiresInSeconds: expiresInSecondsBuilder(),
             expireTimerVersion: expireTimerVersionBuilder(),
@@ -172,6 +171,13 @@ public class OutgoingMessageFactory: Factory {
         return NSDate.ows_millisecondTimeStamp()
     }
 
+    public lazy var validatedMessageBodyBuilder: (_ tx: DBWriteTransaction) -> ValidatedInlineMessageBody = { tx in
+        DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+            MessageBody(text: self.messageBodyBuilder(), ranges: self.bodyRangesBuilder()),
+            tx: tx
+        )
+    }
+
     public var messageBodyBuilder: () -> String = {
         return CommonGenerator.paragraph
     }
@@ -285,8 +291,7 @@ public class IncomingMessageFactory: Factory {
             receivedAtTimestamp: receivedAtTimestampBuilder(),
             authorAci: authorAciBuilder(thread),
             authorE164: nil,
-            messageBody: messageBodyBuilder(),
-            bodyRanges: bodyRangesBuilder(),
+            messageBody: validatedMessageBodyBuilder(transaction),
             editState: editStateBuilder(),
             expiresInSeconds: expiresInSecondsBuilder(),
             expireTimerVersion: expireTimerVersionBuilder(),
@@ -331,6 +336,13 @@ public class IncomingMessageFactory: Factory {
         return NSDate.ows_millisecondTimeStamp()
     }
 
+    public lazy var validatedMessageBodyBuilder: (_ tx: DBWriteTransaction) -> ValidatedInlineMessageBody = { tx in
+        DependenciesBridge.shared.attachmentContentValidator.truncatedMessageBodyForInlining(
+            MessageBody(text: self.messageBodyBuilder(), ranges: self.bodyRangesBuilder()),
+            tx: tx
+        )
+    }
+
     public var messageBodyBuilder: () -> String = {
         return CommonGenerator.paragraph
     }
@@ -440,36 +452,43 @@ public class ConversationFactory {
         outgoingFactory.threadCreator = threadCreator
         let message = outgoingFactory.create(transaction: transaction)
 
-        SSKEnvironment.shared.databaseStorageRef.asyncWrite { asyncTransaction in
-            let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
-                message,
-                unsavedBodyMediaAttachments: bodyAttachmentDataSources
+        Task {
+            let messageBody = try! await DependenciesBridge.shared.attachmentContentValidator.prepareOversizeTextIfNeeded(
+                MessageBody(text: outgoingFactory.messageBodyBuilder(), ranges: outgoingFactory.bodyRangesBuilder())
             )
-            _ = try! unpreparedMessage.prepare(tx: asyncTransaction)
 
-            for attachment in message.allAttachments(transaction: asyncTransaction) {
-                guard let stream = attachment.asStream() else {
-                    continue
-                }
-                let transitTierInfo = Attachment.TransitTierInfo(
-                    cdnNumber: 3,
-                    cdnKey: "1234",
-                    uploadTimestamp: 1,
-                    encryptionKey: Randomness.generateRandomBytes(16),
-                    unencryptedByteCount: 16,
-                    integrityCheck: .digestSHA256Ciphertext(Randomness.generateRandomBytes(16)),
-                    // TODO: [Attachment Streaming] support incremental mac
-                    incrementalMacInfo: nil,
-                    lastDownloadAttemptTimestamp: nil
-                )
-                try! (DependenciesBridge.shared.attachmentStore as? AttachmentUploadStore)?.markUploadedToTransitTier(
-                    attachmentStream: stream,
-                    info: transitTierInfo,
-                    tx: asyncTransaction
+            await SSKEnvironment.shared.databaseStorageRef.awaitableWrite { asyncTransaction in
+                let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
+                    message,
+                    body: messageBody,
+                    unsavedBodyMediaAttachments: bodyAttachmentDataSources
                 )
-            }
+                _ = try! unpreparedMessage.prepare(tx: asyncTransaction)
+
+                for attachment in message.allAttachments(transaction: asyncTransaction) {
+                    guard let stream = attachment.asStream() else {
+                        continue
+                    }
+                    let transitTierInfo = Attachment.TransitTierInfo(
+                        cdnNumber: 3,
+                        cdnKey: "1234",
+                        uploadTimestamp: 1,
+                        encryptionKey: Randomness.generateRandomBytes(16),
+                        unencryptedByteCount: 16,
+                        integrityCheck: .digestSHA256Ciphertext(Randomness.generateRandomBytes(16)),
+                        // TODO: [Attachment Streaming] support incremental mac
+                        incrementalMacInfo: nil,
+                        lastDownloadAttemptTimestamp: nil
+                    )
+                    try! (DependenciesBridge.shared.attachmentStore as? AttachmentUploadStore)?.markUploadedToTransitTier(
+                        attachmentStream: stream,
+                        info: transitTierInfo,
+                        tx: asyncTransaction
+                    )
+                }
 
-            message.updateWithFakeMessageState(.sent, tx: asyncTransaction)
+                message.updateWithFakeMessageState(.sent, tx: asyncTransaction)
+            }
         }
 
         return message
diff --git a/SignalServiceKit/Util/ThreadUtil.swift b/SignalServiceKit/Util/ThreadUtil.swift
index af844382d0d..3bbd7a7e102 100644
--- a/SignalServiceKit/Util/ThreadUtil.swift
+++ b/SignalServiceKit/Util/ThreadUtil.swift
@@ -79,8 +79,11 @@ public extension ThreadUtil {
                 return
             }
 
+            // stickers don't have bodies
+            owsPrecondition(message.body == nil)
             let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
                 message,
+                body: nil,
                 contactShareDraft: sendableContactShareDraft
             )
 
@@ -205,8 +208,12 @@ public extension ThreadUtil {
     ) {
         AssertNotOnMainThread()
 
+        // stickers don't have bodies
+        owsPrecondition(message.body == nil)
+
         let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
             message,
+            body: nil,
             messageStickerDraft: stickerDataSource
         )
         let preparedMessage: PreparedOutgoingMessage
diff --git a/SignalServiceKit/tests/Contacts/SignalRecipientTest.swift b/SignalServiceKit/tests/Contacts/SignalRecipientTest.swift
index dea5adbb8ea..3dad50fc2d7 100644
--- a/SignalServiceKit/tests/Contacts/SignalRecipientTest.swift
+++ b/SignalServiceKit/tests/Contacts/SignalRecipientTest.swift
@@ -152,7 +152,7 @@ class SignalRecipientTest: SSKBaseTest {
             let messageBuilder: TSIncomingMessageBuilder = .withDefaultValues(
                 thread: oldThread,
                 authorAci: aci,
-                messageBody: "Test 123"
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody("Test 123")
             )
             let oldMessage = messageBuilder.build()
             oldMessage.anyInsert(transaction: transaction)
@@ -239,7 +239,7 @@ class SignalRecipientTest: SSKBaseTest {
             let messageBuilder: TSIncomingMessageBuilder = .withDefaultValues(
                 thread: oldThread,
                 authorAci: oldAci,
-                messageBody: "Test 123"
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody("Test 123")
             )
             let oldMessage = messageBuilder.build()
             oldMessage.anyInsert(transaction: transaction)
diff --git a/SignalServiceKit/tests/MessageBackup/BackupEnablementReminderMegaphoneTests.swift b/SignalServiceKit/tests/MessageBackup/BackupEnablementReminderMegaphoneTests.swift
index 805f28bb4b1..d67c826d45f 100644
--- a/SignalServiceKit/tests/MessageBackup/BackupEnablementReminderMegaphoneTests.swift
+++ b/SignalServiceKit/tests/MessageBackup/BackupEnablementReminderMegaphoneTests.swift
@@ -132,7 +132,10 @@ class BackupEnablementReminderMegaphoneTests: XCTestCase {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/tests/Messages/DeliveryReceiptContextTests.swift b/SignalServiceKit/tests/Messages/DeliveryReceiptContextTests.swift
index d2d108541cb..b8ee72202c6 100644
--- a/SignalServiceKit/tests/Messages/DeliveryReceiptContextTests.swift
+++ b/SignalServiceKit/tests/Messages/DeliveryReceiptContextTests.swift
@@ -36,7 +36,10 @@ class DeliveryReceiptContextTests: SSKBaseTest {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/tests/Messages/DisappearingMessageFinderTest.swift b/SignalServiceKit/tests/Messages/DisappearingMessageFinderTest.swift
index 8699eb6523d..a3e861c94dd 100644
--- a/SignalServiceKit/tests/Messages/DisappearingMessageFinderTest.swift
+++ b/SignalServiceKit/tests/Messages/DisappearingMessageFinderTest.swift
@@ -46,7 +46,7 @@ final class DisappearingMessageFinderTest: SSKBaseTest {
                 thread: thread,
                 timestamp: 1,
                 authorAci: otherAddress.aci,
-                messageBody: body,
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody(body),
                 expiresInSeconds: expiresInSeconds
             )
             let message = incomingMessageBuilder.build()
@@ -85,7 +85,7 @@ final class DisappearingMessageFinderTest: SSKBaseTest {
 
             let messageBuilder: TSOutgoingMessageBuilder = .withDefaultValues(
                 thread: thread,
-                messageBody: body,
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody(body),
                 expiresInSeconds: expiresInSeconds,
                 expireStartedAt: expireStartedAt
             )
diff --git a/SignalServiceKit/tests/Messages/Edit/EditManagerTests.swift b/SignalServiceKit/tests/Messages/Edit/EditManagerTests.swift
index f80712ef551..b62c3c37100 100644
--- a/SignalServiceKit/tests/Messages/Edit/EditManagerTests.swift
+++ b/SignalServiceKit/tests/Messages/Edit/EditManagerTests.swift
@@ -43,7 +43,7 @@ class EditManagerTests: SSKBaseTest {
 
     func testBasicValidation() throws {
         let targetMessage = createIncomingMessage(with: thread) { builder in
-            builder.messageBody = "BAR"
+            builder.setMessageBody(AttachmentContentValidatorMock.mockValidatedBody("BAR"))
             builder.authorAci = authorAci
             builder.expireStartedAt = 3
         }
@@ -53,6 +53,7 @@ class EditManagerTests: SSKBaseTest {
         let editMessageStoreMock = EditMessageStoreMock()
         let editManager = EditManagerImpl(context:
             .init(
+                attachmentContentValidator: AttachmentContentValidatorMock(),
                 attachmentStore: AttachmentStoreMock(),
                 dataStore: dataStoreMock,
                 editManagerAttachments: MockEditManagerAttachments(),
@@ -100,6 +101,7 @@ class EditManagerTests: SSKBaseTest {
         let editMessageStoreMock = EditMessageStoreMock()
         let editManager = EditManagerImpl(context:
             .init(
+                attachmentContentValidator: AttachmentContentValidatorMock(),
                 attachmentStore: AttachmentStoreMock(),
                 dataStore: dataStoreMock,
                 editManagerAttachments: MockEditManagerAttachments(),
@@ -144,6 +146,7 @@ class EditManagerTests: SSKBaseTest {
         let editMessageStoreMock = EditMessageStoreMock()
         let editManager = EditManagerImpl(context:
             .init(
+                attachmentContentValidator: AttachmentContentValidatorMock(),
                 attachmentStore: AttachmentStoreMock(),
                 dataStore: dataStoreMock,
                 editManagerAttachments: MockEditManagerAttachments(),
@@ -190,6 +193,7 @@ class EditManagerTests: SSKBaseTest {
 
         let editManager = EditManagerImpl(context:
             .init(
+                attachmentContentValidator: AttachmentContentValidatorMock(),
                 attachmentStore: AttachmentStoreMock(),
                 dataStore: dataStoreMock,
                 editManagerAttachments: MockEditManagerAttachments(),
@@ -238,6 +242,7 @@ class EditManagerTests: SSKBaseTest {
 
         let editManager = EditManagerImpl(context:
             .init(
+                attachmentContentValidator: AttachmentContentValidatorMock(),
                 attachmentStore: AttachmentStoreMock(),
                 dataStore: dataStoreMock,
                 editManagerAttachments: MockEditManagerAttachments(),
diff --git a/SignalServiceKit/tests/Messages/Interactions/TSMessageTest.swift b/SignalServiceKit/tests/Messages/Interactions/TSMessageTest.swift
index 062ea9e5819..e2bfffd632b 100644
--- a/SignalServiceKit/tests/Messages/Interactions/TSMessageTest.swift
+++ b/SignalServiceKit/tests/Messages/Interactions/TSMessageTest.swift
@@ -16,7 +16,10 @@ class TSMessageTest: SSKBaseTest {
     }
 
     func testExpiresAtWithoutStartedTimer() {
-        let builder = TSOutgoingMessageBuilder.outgoingMessageBuilder(thread: self.thread, messageBody: "foo")
+        let builder = TSOutgoingMessageBuilder.outgoingMessageBuilder(
+            thread: self.thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody("foo")
+        )
         builder.timestamp = 1
         builder.expiresInSeconds = 100
 
@@ -28,7 +31,10 @@ class TSMessageTest: SSKBaseTest {
         let now = Date.ows_millisecondTimestamp()
         let expirationSeconds: UInt32 = 10
 
-        let builder = TSOutgoingMessageBuilder.outgoingMessageBuilder(thread: self.thread, messageBody: "foo")
+        let builder = TSOutgoingMessageBuilder.outgoingMessageBuilder(
+            thread: self.thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody("foo")
+        )
         builder.timestamp = 1
         builder.expiresInSeconds = expirationSeconds
         builder.expireStartedAt = now
diff --git a/SignalServiceKit/tests/Messages/OWSDisappearingMessagesJobTest.swift b/SignalServiceKit/tests/Messages/OWSDisappearingMessagesJobTest.swift
index 8e70035db52..8c896b887f8 100644
--- a/SignalServiceKit/tests/Messages/OWSDisappearingMessagesJobTest.swift
+++ b/SignalServiceKit/tests/Messages/OWSDisappearingMessagesJobTest.swift
@@ -17,7 +17,7 @@ final class OWSDisappearingMessagesJobTest: SSKBaseTest {
         let thread = TSContactThread.getOrCreateThread(contactAddress: localAddress)
         let messageBuilder: TSIncomingMessageBuilder = .withDefaultValues(
             thread: thread,
-            messageBody: body
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(body)
         )
         messageBuilder.timestamp = 1234
         messageBuilder.expiresInSeconds = expiresInSeconds
diff --git a/SignalServiceKit/tests/Storage/Database/DatabaseRecoveryTest.swift b/SignalServiceKit/tests/Storage/Database/DatabaseRecoveryTest.swift
index 6fb3a090f31..6b6763ef8f4 100644
--- a/SignalServiceKit/tests/Storage/Database/DatabaseRecoveryTest.swift
+++ b/SignalServiceKit/tests/Storage/Database/DatabaseRecoveryTest.swift
@@ -155,7 +155,7 @@ final class DatabaseRecoveryTest: SSKBaseTest {
                 thread: contactThread,
                 timestamp: 1234,
                 authorAci: contactAci,
-                messageBody: "test outgoing message"
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody("test outgoing message")
             )
             let message = messageBuilder.build()
             message.anyInsert(transaction: transaction)
@@ -324,7 +324,7 @@ final class DatabaseRecoveryTest: SSKBaseTest {
                 thread: contactThread,
                 timestamp: 1234,
                 authorAci: contactAci,
-                messageBody: "foo bar"
+                messageBody: AttachmentContentValidatorMock.mockValidatedBody("foo bar")
             )
             let message = messageBuilder.build()
             message.anyInsert(transaction: transaction)
diff --git a/SignalServiceKit/tests/Storage/InteractionFinderTest.swift b/SignalServiceKit/tests/Storage/InteractionFinderTest.swift
index 88350c6a3c4..3eeabc64c1b 100644
--- a/SignalServiceKit/tests/Storage/InteractionFinderTest.swift
+++ b/SignalServiceKit/tests/Storage/InteractionFinderTest.swift
@@ -98,7 +98,10 @@ class InteractionFinderTest: SSKBaseTest {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/tests/Storage/SDSDatabaseStorageObservationTest.swift b/SignalServiceKit/tests/Storage/SDSDatabaseStorageObservationTest.swift
index 920789a6e27..9c4e621bc0f 100644
--- a/SignalServiceKit/tests/Storage/SDSDatabaseStorageObservationTest.swift
+++ b/SignalServiceKit/tests/Storage/SDSDatabaseStorageObservationTest.swift
@@ -165,7 +165,10 @@ class SDSDatabaseStorageObservationTest: SSKBaseTest {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/tests/Storage/SDSDatabaseStorageTest.swift b/SignalServiceKit/tests/Storage/SDSDatabaseStorageTest.swift
index 37479c771ff..5e46b9e212d 100644
--- a/SignalServiceKit/tests/Storage/SDSDatabaseStorageTest.swift
+++ b/SignalServiceKit/tests/Storage/SDSDatabaseStorageTest.swift
@@ -170,7 +170,10 @@ class SDSDatabaseStorageTest: SSKBaseTest {
 
 private extension TSOutgoingMessage {
     convenience init(in thread: TSThread, messageBody: String) {
-        let builder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, messageBody: messageBody)
+        let builder: TSOutgoingMessageBuilder = .withDefaultValues(
+            thread: thread,
+            messageBody: AttachmentContentValidatorMock.mockValidatedBody(messageBody)
+        )
         self.init(outgoingMessageWith: builder, recipientAddressStates: [:])
     }
 }
diff --git a/SignalServiceKit/tests/Util/TSMessageStorageTest.swift b/SignalServiceKit/tests/Util/TSMessageStorageTest.swift
index 8db5dd31f5e..5fe6d3aa6c3 100644
--- a/SignalServiceKit/tests/Util/TSMessageStorageTest.swift
+++ b/SignalServiceKit/tests/Util/TSMessageStorageTest.swift
@@ -47,7 +47,7 @@ final class TSMessageStorageTest: SSKBaseTest {
                     thread: thread,
                     timestamp: timestamp,
                     authorAci: otherAci,
-                    messageBody: body
+                    messageBody: AttachmentContentValidatorMock.mockValidatedBody(body)
                 ).build()
             newMessage.anyInsert(transaction: tx)
 
@@ -76,7 +76,7 @@ final class TSMessageStorageTest: SSKBaseTest {
                         thread: thread,
                         timestamp: UInt64(idx) + 1,
                         authorAci: otherAci,
-                        messageBody: body
+                        messageBody: AttachmentContentValidatorMock.mockValidatedBody(body)
                     ).build()
                 newMessage.anyInsert(transaction: tx)
                 return newMessage
@@ -129,7 +129,7 @@ final class TSMessageStorageTest: SSKBaseTest {
                         thread: groupThread,
                         timestamp: UInt64(idx + 1),
                         authorAci: authorAddress.aci!,
-                        messageBody: body
+                        messageBody: AttachmentContentValidatorMock.mockValidatedBody(body)
                     ).build()
                 newMessage.anyInsert(transaction: tx)
                 return newMessage
diff --git a/SignalShareExtension/SharingThreadPickerViewController.swift b/SignalShareExtension/SharingThreadPickerViewController.swift
index a62c566beb5..0fae42f375e 100644
--- a/SignalShareExtension/SharingThreadPickerViewController.swift
+++ b/SignalShareExtension/SharingThreadPickerViewController.swift
@@ -288,6 +288,7 @@ extension SharingThreadPickerViewController {
                     let message = builder.build(transaction: tx)
                     let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
                         message,
+                        body: nil,
                         contactShareDraft: contactShareForSending
                     )
                     return try unpreparedMessage.prepare(tx: tx)
diff --git a/SignalUI/Payments/PaymentsImpl.swift b/SignalUI/Payments/PaymentsImpl.swift
index 987102cab4d..aed699e2b9d 100644
--- a/SignalUI/Payments/PaymentsImpl.swift
+++ b/SignalUI/Payments/PaymentsImpl.swift
@@ -820,8 +820,11 @@ public extension PaymentsImpl {
                                            transaction: transaction)
     }
 
-    class func sendPaymentNotificationMessage(paymentModel: TSPaymentModel,
-                                              transaction: DBWriteTransaction) throws -> OWSOutgoingPaymentMessage {
+    class func sendPaymentNotificationMessage(
+        paymentModel: TSPaymentModel,
+        messageBody: ValidatedMessageBody?,
+        transaction: DBWriteTransaction
+    ) throws -> OWSOutgoingPaymentMessage {
         guard paymentModel.paymentType == .outgoingPayment else {
             owsFailDebug("Invalid paymentType.")
             throw PaymentsError.invalidModel
@@ -860,7 +863,7 @@ public extension PaymentsImpl {
         let message = self.sendPaymentNotificationMessage(
             paymentModel: paymentModel,
             recipientAci: recipientAci,
-            memoMessage: paymentModel.memoMessage,
+            messageBody: messageBody,
             mcReceiptData: mcReceiptData,
             transaction: transaction
         )
@@ -938,7 +941,7 @@ public extension PaymentsImpl {
     private class func sendPaymentNotificationMessage(
         paymentModel: TSPaymentModel,
         recipientAci: Aci,
-        memoMessage: String?,
+        messageBody: ValidatedMessageBody?,
         mcReceiptData: Data,
         transaction: DBWriteTransaction
     ) -> OWSOutgoingPaymentMessage {
@@ -963,36 +966,27 @@ public extension PaymentsImpl {
             transaction: transaction
         )
         let paymentNotification = TSPaymentNotification(
-            memoMessage: memoMessage,
+            memoMessage: paymentModel.memoMessage,
             mcReceiptData: mcReceiptData
         )
         let dmConfigurationStore = DependenciesBridge.shared.disappearingMessagesConfigurationStore
         let dmConfig = dmConfigurationStore.fetchOrBuildDefault(for: .thread(thread), tx: transaction)
 
-        let messageBody: String? = {
-            guard let picoMob = paymentModel.paymentAmount?.picoMob else {
-                return nil
-            }
-            // Reverse type direction, so it reads correctly incoming to the recipient.
-            return PaymentsFormat.paymentPreviewText(
-                amount: picoMob,
-                transaction: transaction,
-                type: .incomingMessage
-            )
-        }()
-
         let message = OWSOutgoingPaymentMessage(
             thread: thread,
             messageBody: messageBody,
             paymentNotification: paymentNotification,
             expiresInSeconds: dmConfig.durationSeconds,
-            expireTimerVersion: NSNumber(value: dmConfig.timerVersion),
-            transaction: transaction
+            expireTimerVersion: dmConfig.timerVersion,
+            tx: transaction
         )
 
         paymentModel.update(withInteractionUniqueId: message.uniqueId, transaction: transaction)
         // No attachments to add.
-        let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(message)
+        let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
+            message,
+            body: messageBody,
+        )
 
         ThreadUtil.enqueueMessage(
             unpreparedMessage,
diff --git a/SignalUI/Payments/PaymentsProcessor.swift b/SignalUI/Payments/PaymentsProcessor.swift
index 66f37e1389f..6235a38c640 100644
--- a/SignalUI/Payments/PaymentsProcessor.swift
+++ b/SignalUI/Payments/PaymentsProcessor.swift
@@ -690,6 +690,28 @@ private class PaymentProcessingOperation {
             return
         }
 
+        let messageBodyText: String? = try SSKEnvironment.shared.databaseStorageRef.read { tx in
+            guard let paymentModel = TSPaymentModel.anyFetch(uniqueId: paymentModel.uniqueId, transaction: tx) else {
+                throw OWSAssertionError("Missing paymentModel.")
+            }
+            guard let picoMob = paymentModel.paymentAmount?.picoMob else {
+                return nil
+            }
+            // Reverse type direction, so it reads correctly incoming to the recipient.
+            return PaymentsFormat.paymentPreviewText(
+                amount: picoMob,
+                transaction: tx,
+                type: .incomingMessage
+            )?.nilIfEmpty
+        }
+        let messageBody: ValidatedMessageBody?
+        if let messageBodyText = messageBodyText?.nilIfEmpty {
+            messageBody = try await DependenciesBridge.shared.attachmentContentValidator
+                .prepareOversizeTextIfNeeded(MessageBody(text: messageBodyText, ranges: .empty))
+        } else {
+            messageBody = nil
+        }
+
         try await SSKEnvironment.shared.databaseStorageRef.awaitableWrite { transaction in
             guard let paymentModel = TSPaymentModel.anyFetch(uniqueId: paymentModel.uniqueId, transaction: transaction) else {
                 throw OWSAssertionError("Missing paymentModel.")
@@ -702,7 +724,11 @@ private class PaymentProcessingOperation {
                     if paymentModel.isDefragmentation {
                         PaymentsImpl.sendDefragmentationSyncMessage(paymentModel: paymentModel, transaction: transaction)
                     } else {
-                        _ = try PaymentsImpl.sendPaymentNotificationMessage(paymentModel: paymentModel, transaction: transaction)
+                        _ = try PaymentsImpl.sendPaymentNotificationMessage(
+                            paymentModel: paymentModel,
+                            messageBody: messageBody,
+                            transaction: transaction
+                        )
                         PaymentsImpl.sendOutgoingPaymentSyncMessage(paymentModel: paymentModel, transaction: transaction)
                     }
                 }
diff --git a/SignalUI/Sending/ThreadUtil+SignalUI.swift b/SignalUI/Sending/ThreadUtil+SignalUI.swift
index a71572cebfc..1727df676ba 100644
--- a/SignalUI/Sending/ThreadUtil+SignalUI.swift
+++ b/SignalUI/Sending/ThreadUtil+SignalUI.swift
@@ -187,26 +187,11 @@ extension UnpreparedOutgoingMessage {
         linkPreviewDataSource: LinkPreviewDataSource?,
         transaction: DBReadTransaction
     ) -> UnpreparedOutgoingMessage {
-
-        let truncatedBody: MessageBody?
-        let oversizeTextDataSource: AttachmentDataSource?
-        switch messageBody {
-        case .inline(let messageBody):
-            truncatedBody = messageBody
-            oversizeTextDataSource = nil
-        case .oversize(let truncated, let fullsize):
-            truncatedBody = truncated
-            oversizeTextDataSource = .pendingAttachment(fullsize)
-        case nil:
-            truncatedBody = nil
-            oversizeTextDataSource = nil
-        }
-
         let dmConfigurationStore = DependenciesBridge.shared.disappearingMessagesConfigurationStore
         let dmConfig = dmConfigurationStore.fetchOrBuildDefault(for: .thread(thread), tx: transaction)
 
         let isVoiceMessage = mediaAttachments.count == 1
-            && oversizeTextDataSource == nil
+            && messageBody?.oversizeText == nil
             && mediaAttachments.last?.renderingFlag == .voiceMessage
 
         var isViewOnceMessage = false
@@ -225,8 +210,7 @@ extension UnpreparedOutgoingMessage {
 
         let messageBuilder: TSOutgoingMessageBuilder = .withDefaultValues(thread: thread, timestamp: timestamp)
 
-        messageBuilder.messageBody = truncatedBody?.text
-        messageBuilder.bodyRanges = truncatedBody?.ranges
+        messageBuilder.setMessageBody(messageBody)
 
         messageBuilder.expiresInSeconds = dmConfig.durationSeconds
         messageBuilder.expireTimerVersion = NSNumber.init(value: dmConfig.timerVersion)
@@ -239,8 +223,8 @@ extension UnpreparedOutgoingMessage {
 
         let unpreparedMessage = UnpreparedOutgoingMessage.forMessage(
             message,
+            body: messageBody,
             unsavedBodyMediaAttachments: attachmentInfos,
-            oversizeTextDataSource: oversizeTextDataSource,
             linkPreviewDraft: linkPreviewDataSource,
             quotedReplyDraft: quotedReplyDraft
         )
@@ -256,26 +240,13 @@ extension UnpreparedOutgoingMessage {
         editTarget: TSOutgoingMessage
     ) -> UnpreparedOutgoingMessage {
 
-        let truncatedBody: MessageBody?
-        let oversizeTextDataSource: AttachmentDataSource?
-        switch messageBody {
-        case .inline(let messageBody):
-            truncatedBody = messageBody
-            oversizeTextDataSource = nil
-        case .oversize(let truncated, let fullsize):
-            truncatedBody = truncated
-            oversizeTextDataSource = .pendingAttachment(fullsize)
-        case nil:
-            truncatedBody = nil
-            oversizeTextDataSource = nil
-        }
+        let oversizeTextDataSource: AttachmentDataSource? = messageBody?.oversizeText.map { .pendingAttachment($0) }
 
         let edits: MessageEdits = .forOutgoingEdit(
             timestamp: .change(timestamp),
             // "Received" now!
             receivedAtTimestamp: .change(Date.ows_millisecondTimestamp()),
-            body: .change(truncatedBody?.text),
-            bodyRanges: .change(truncatedBody?.ranges)
+            body: .change(messageBody),
         )
 
         let unpreparedMessage = UnpreparedOutgoingMessage.forEditMessage(
