diff --git a/Signal/src/ViewControllers/NewContactThreadViewController.m b/Signal/src/ViewControllers/NewContactThreadViewController.m
index 1f2f7c174b6..309e8750f50 100644
--- a/Signal/src/ViewControllers/NewContactThreadViewController.m
+++ b/Signal/src/ViewControllers/NewContactThreadViewController.m
@@ -549,7 +549,7 @@ - (void)updateTableContents
 
     // Contacts, filtered with the search text.
     NSArray<SignalAccount *> *filteredSignalAccounts = [self filteredSignalAccounts];
-    BOOL hasSearchResults = NO;
+    __block BOOL hasSearchResults = NO;
 
     NSMutableSet<NSString *> *matchedAccountPhoneNumbers = [NSMutableSet new];
     NSMutableSet<NSString *> *matchedAccountUsernames = [NSMutableSet new];
@@ -558,55 +558,46 @@ - (void)updateTableContents
     contactsSection.headerTitle = NSLocalizedString(@"COMPOSE_MESSAGE_CONTACT_SECTION_TITLE",
         @"Table section header for contact listing when composing a new message");
 
-    // Load all usernames in a single transaction.
-    NSMutableDictionary<NSString *, NSString *> *signalAccountIdToUsernameMap = [NSMutableDictionary new];
-    [self.databaseStorage readWithBlock:^(SDSAnyReadTransaction *transaction) {
+    OWSAssertIsOnMainThread();
+    [self.databaseStorage uiReadWithBlock:^(SDSAnyReadTransaction *transaction) {
         for (SignalAccount *signalAccount in filteredSignalAccounts) {
-            NSString *_Nullable username =
-                [helper.profileManager usernameForAddress:signalAccount.recipientAddress transaction:transaction];
+            hasSearchResults = YES;
+
+            NSString *_Nullable phoneNumber = signalAccount.recipientAddress.phoneNumber;
+            if (phoneNumber) {
+                [matchedAccountPhoneNumbers addObject:phoneNumber];
+            }
+
+            NSString *_Nullable username = [helper.profileManager usernameForAddress:signalAccount.recipientAddress
+                                                                         transaction:transaction];
             if (username) {
-                signalAccountIdToUsernameMap[signalAccount.uniqueId] = username;
+                [matchedAccountUsernames addObject:username];
             }
-        }
-    }];
 
-    for (SignalAccount *signalAccount in filteredSignalAccounts) {
-        hasSearchResults = YES;
+            [contactsSection
+                addItem:[OWSTableItem
+                            itemWithCustomCellBlock:^{
+                                ContactTableViewCell *cell = [ContactTableViewCell new];
+                                BOOL isBlocked = [helper isSignalServiceAddressBlocked:signalAccount.recipientAddress];
+                                if (isBlocked) {
+                                    cell.accessoryMessage = MessageStrings.conversationIsBlocked;
+                                }
 
-        NSString *_Nullable phoneNumber = signalAccount.recipientAddress.phoneNumber;
-        if (phoneNumber) {
-            [matchedAccountPhoneNumbers addObject:phoneNumber];
-        }
+                                [cell configureWithRecipientAddress:signalAccount.recipientAddress];
 
-        NSString *_Nullable username = signalAccountIdToUsernameMap[signalAccount.uniqueId];
-        if (username) {
-            [matchedAccountUsernames addObject:username];
-        }
+                                NSString *cellName = [NSString stringWithFormat:@"signal_contact.%@",
+                                                               signalAccount.recipientAddress.stringForDisplay];
+                                cell.accessibilityIdentifier
+                                    = ACCESSIBILITY_IDENTIFIER_WITH_NAME(NewContactThreadViewController, cellName);
 
-        [contactsSection
-            addItem:[OWSTableItem
-                        itemWithCustomCellBlock:^{
-                            ContactTableViewCell *cell = [ContactTableViewCell new];
-                            BOOL isBlocked = [helper isSignalServiceAddressBlocked:signalAccount.recipientAddress];
-                            if (isBlocked) {
-                                cell.accessoryMessage = MessageStrings.conversationIsBlocked;
+                                return cell;
                             }
-
-                            [cell configureWithRecipientAddress:signalAccount.recipientAddress];
-
-                            NSString *cellName = [NSString
-                                stringWithFormat:@"signal_contact.%@", signalAccount.recipientAddress.stringForDisplay];
-                            cell.accessibilityIdentifier
-                                = ACCESSIBILITY_IDENTIFIER_WITH_NAME(NewContactThreadViewController, cellName);
-
-                            return cell;
-                        }
-                        customRowHeight:UITableViewAutomaticDimension
-                        actionBlock:^{
-                            [weakSelf
-                                newConversationWithAddress:signalAccount.recipientAddress];
-                        }]];
-    }
+                            customRowHeight:UITableViewAutomaticDimension
+                            actionBlock:^{
+                                [weakSelf newConversationWithAddress:signalAccount.recipientAddress];
+                            }]];
+        }
+    }];
     if (filteredSignalAccounts.count > 0) {
         [sections addObject:contactsSection];
     }
