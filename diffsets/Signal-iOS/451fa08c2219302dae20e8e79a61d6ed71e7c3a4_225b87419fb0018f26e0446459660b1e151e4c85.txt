diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Banners.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Banners.swift
index d99c55e8311..b9414fe5f36 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Banners.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Banners.swift
@@ -1,5 +1,5 @@
 //
-//  Copyright (c) 2021 Open Whisper Systems. All rights reserved.
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
 //
 
 import Foundation
@@ -549,23 +549,27 @@ extension ConversationViewController {
 
         // Most of these banners should hide themselves when the user scrolls
         if !userHasScrolled {
-            let noLongerVerifiedAddresses = self.noLongerVerifiedAddresses
-            if !noLongerVerifiedAddresses.isEmpty {
-                let message: String
-                if noLongerVerifiedAddresses.count > 1 {
-                    message = NSLocalizedString("MESSAGES_VIEW_N_MEMBERS_NO_LONGER_VERIFIED",
-                                                comment: "Indicates that more than one member of this group conversation is no longer verified.")
-                } else {
-                    let address = noLongerVerifiedAddresses.first!
-                    let displayName = contactsManager.displayName(for: address)
-                    let format = (isGroupConversation
-                                    ? NSLocalizedString("MESSAGES_VIEW_1_MEMBER_NO_LONGER_VERIFIED_FORMAT",
-                                                        comment: "Indicates that one member of this group conversation is no longer verified. Embeds {{user's name or phone number}}.")
-                                    : NSLocalizedString("MESSAGES_VIEW_CONTACT_NO_LONGER_VERIFIED_FORMAT",
-                                                        comment: "Indicates that this 1:1 conversation is no longer verified. Embeds {{user's name or phone number}}."))
-                    message = String(format: format, displayName)
-                }
-
+            let message: String?
+            let noLongerVerifiedAddressSample = self.arbitraryNoLongerVerifiedAddresses(limit: 2)
+            switch noLongerVerifiedAddressSample.count {
+            case 0:
+                message = nil
+
+            case 1:
+                let address = noLongerVerifiedAddressSample.first!
+                let displayName = contactsManager.displayName(for: address)
+                let format = (isGroupConversation
+                                ? NSLocalizedString("MESSAGES_VIEW_1_MEMBER_NO_LONGER_VERIFIED_FORMAT",
+                                                    comment: "Indicates that one member of this group conversation is no longer verified. Embeds {{user's name or phone number}}.")
+                                : NSLocalizedString("MESSAGES_VIEW_CONTACT_NO_LONGER_VERIFIED_FORMAT",
+                                                    comment: "Indicates that this 1:1 conversation is no longer verified. Embeds {{user's name or phone number}}."))
+                message = String(format: format, displayName)
+
+            default:
+                message = NSLocalizedString("MESSAGES_VIEW_N_MEMBERS_NO_LONGER_VERIFIED",
+                                            comment: "Indicates that more than one member of this group conversation is no longer verified.")
+            }
+            if let message = message {
                 let banner = ConversationViewController.createBanner(title: message,
                                                                      bannerColor: .ows_accentRed) { [weak self] in
                     self?.noLongerVerifiedBannerViewWasTapped()
@@ -688,19 +692,21 @@ extension ConversationViewController {
     private func noLongerVerifiedBannerViewWasTapped() {
         AssertIsOnMainThread()
 
-        let noLongerVerifiedAddresses = self.noLongerVerifiedAddresses
-        if noLongerVerifiedAddresses.isEmpty {
+        let title: String
+        switch arbitraryNoLongerVerifiedAddresses(limit: 2).count {
+        case 0:
             return
+        case 1:
+            title = NSLocalizedString("VERIFY_PRIVACY",
+                                      comment: "Label for button or row which allows users to verify the safety number of another user.")
+        default:
+            title = NSLocalizedString("VERIFY_PRIVACY_MULTIPLE",
+                                      comment: "Label for button or row which allows users to verify the safety numbers of multiple users.")
         }
-        let hasMultiple = noLongerVerifiedAddresses.count > 1
 
         let actionSheet = ActionSheetController()
 
-        actionSheet.addAction(ActionSheetAction(title: (hasMultiple
-                                                            ? NSLocalizedString("VERIFY_PRIVACY_MULTIPLE",
-                                                                                comment: "Label for button or row which allows users to verify the safety numbers of multiple users.")
-                                                            : NSLocalizedString("VERIFY_PRIVACY",
-                                                                                comment: "Label for button or row which allows users to verify the safety number of another user.")),
+        actionSheet.addAction(ActionSheetAction(title: title,
                                                 style: .default) { [weak self] _ in
             self?.showNoLongerVerifiedUI()
         })
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
index 256cc21a092..573eda33d3b 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
@@ -107,16 +107,20 @@ public extension ConversationViewController {
 
     // MARK: - Verification
 
-    // Returns a collection of the group members who are "no longer verified".
-    var noLongerVerifiedAddresses: [SignalServiceAddress] {
+    // Returns a random sub-collection of the group members who are "no longer verified".
+    func arbitraryNoLongerVerifiedAddresses(limit: Int) -> [SignalServiceAddress] {
         databaseStorage.read { transaction in
-            self.noLongerVerifiedAddresses(transaction: transaction)
+            self.noLongerVerifiedAddresses(limit: limit, transaction: transaction)
         }
     }
 
-    // Returns a collection of the group members who are "no longer verified".
-    func noLongerVerifiedAddresses(transaction: SDSAnyReadTransaction) -> [SignalServiceAddress] {
-        thread.recipientAddresses.filter { address in
+    func noLongerVerifiedAddresses(limit: Int, transaction: SDSAnyReadTransaction) -> [SignalServiceAddress] {
+        if let groupThread = thread as? TSGroupThread {
+            return Self.identityManager.noLongerVerifiedAddresses(inGroup: groupThread.uniqueId,
+                                                                  limit: limit,
+                                                                  transaction: transaction)
+        }
+        return thread.recipientAddresses.filter { address in
             Self.identityManager.verificationState(for: address,
                                                    transaction: transaction) == .noLongerVerified
         }
@@ -126,7 +130,8 @@ public extension ConversationViewController {
         AssertIsOnMainThread()
 
         databaseStorage.write { transaction in
-            let noLongerVerifiedAddresses = self.noLongerVerifiedAddresses(transaction: transaction)
+            let noLongerVerifiedAddresses = self.noLongerVerifiedAddresses(limit: Int.max,
+                                                                           transaction: transaction)
             for address in noLongerVerifiedAddresses {
                 owsAssertDebug(address.isValid)
 
@@ -151,13 +156,17 @@ public extension ConversationViewController {
     func showNoLongerVerifiedUI() {
         AssertIsOnMainThread()
 
-        let noLongerVerifiedAddresses = self.noLongerVerifiedAddresses
-        if noLongerVerifiedAddresses.count > 1 {
-            showConversationSettingsAndShowVerification()
-        } else if noLongerVerifiedAddresses.count == 1,
-                  let address = noLongerVerifiedAddresses.last {
+        let addresses = arbitraryNoLongerVerifiedAddresses(limit: 2)
+        switch addresses.count {
+        case 0:
+             break
+
+        case 1:
             // Pick one in an arbitrary but deterministic manner.
-            showFingerprint(address: address)
+            showFingerprint(address: addresses[0])
+
+        default:
+            showConversationSettingsAndShowVerification()
         }
     }
 
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+UI.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+UI.swift
index 47924506625..0992872725d 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+UI.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+UI.swift
@@ -1,5 +1,5 @@
 //
-//  Copyright (c) 2021 Open Whisper Systems. All rights reserved.
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
 //
 
 import Foundation
@@ -176,6 +176,18 @@ extension ConversationViewController {
         }
     }
 
+    private func threadContainsUnverifiedMember(_ thread: TSThread) -> Bool {
+        guard !thread.recipientAddresses.isEmpty else {
+            return false
+        }
+        if let groupThread = thread as? TSGroupThread {
+            return Self.identityManager.groupContainsUnverifiedMember(groupThread.uniqueId)
+        }
+        return thread.recipientAddresses.contains { address in
+            Self.identityManager.verificationState(for: address) != .verified
+        }
+    }
+
     public func updateNavigationBarSubtitleLabel() {
         AssertIsOnMainThread()
 
@@ -198,13 +210,7 @@ extension ConversationViewController {
 
         let isMuted = threadViewModel.isMuted
         let hasTimer = disappearingMessagesConfiguration.isEnabled
-        var isVerified = thread.recipientAddresses.count > 0
-        for address in thread.recipientAddresses {
-            if Self.identityManager.verificationState(for: address) != .verified {
-                isVerified = false
-                break
-            }
-        }
+        let isVerified = threadContainsUnverifiedMember(thread)
 
         if isMuted {
             subtitleText.appendTemplatedImage(named: "bell-disabled-outline-24", font: subtitleFont)
diff --git a/SignalServiceKit/src/Messages/OWSIdentityManager.h b/SignalServiceKit/src/Messages/OWSIdentityManager.h
index afcf035fbac..dac665a983a 100644
--- a/SignalServiceKit/src/Messages/OWSIdentityManager.h
+++ b/SignalServiceKit/src/Messages/OWSIdentityManager.h
@@ -1,5 +1,5 @@
 //
-//  Copyright (c) 2021 Open Whisper Systems. All rights reserved.
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
 //
 
 #import <SignalServiceKit/OWSRecipientIdentity.h>
@@ -51,9 +51,14 @@ typedef NS_ENUM(NSInteger, TSMessageDirection) {
                  transaction:(SDSAnyWriteTransaction *)transaction;
 
 - (OWSVerificationState)verificationStateForAddress:(SignalServiceAddress *)address;
+- (BOOL)groupContainsUnverifiedMember:(NSString *)threadUniqueID;
 - (OWSVerificationState)verificationStateForAddress:(SignalServiceAddress *)address
                                         transaction:(SDSAnyReadTransaction *)transaction;
 
+- (NSArray<SignalServiceAddress *> *)noLongerVerifiedAddressesInGroup:(NSString *)groupThreadID
+                                                                limit:(NSInteger)limit
+                                                          transaction:(SDSAnyReadTransaction *)transaction;
+
 - (void)setVerificationState:(OWSVerificationState)verificationState
                  identityKey:(NSData *)identityKey
                      address:(SignalServiceAddress *)address
diff --git a/SignalServiceKit/src/Messages/OWSIdentityManager.m b/SignalServiceKit/src/Messages/OWSIdentityManager.m
index 5a2d1be6f4d..9f777ed0dd7 100644
--- a/SignalServiceKit/src/Messages/OWSIdentityManager.m
+++ b/SignalServiceKit/src/Messages/OWSIdentityManager.m
@@ -1,5 +1,5 @@
 //
-//  Copyright (c) 2021 Open Whisper Systems. All rights reserved.
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
 //
 
 #import "OWSIdentityManager.h"
@@ -346,6 +346,22 @@ - (void)setVerificationState:(OWSVerificationState)verificationState
     [self fireIdentityStateChangeNotificationAfterTransaction:transaction];
 }
 
+- (BOOL)groupContainsUnverifiedMember:(NSString *)threadUniqueID
+{
+    __block BOOL result = NO;
+    [self readWithUnfairLock:^(SDSAnyReadTransaction *_Nonnull transaction) {
+        result = [self groupContainsUnverifiedMember:threadUniqueID transaction:transaction];
+    }];
+    return result;
+}
+
+- (NSArray<SignalServiceAddress *> *)noLongerVerifiedAddressesInGroup:(NSString *)groupThreadID
+                                                                limit:(NSInteger)limit
+                                                          transaction:(SDSAnyReadTransaction *)transaction
+{
+    return [OWSRecipientIdentity noLongerVerifiedAddressesInGroup:groupThreadID limit:limit transaction:transaction];
+}
+
 - (OWSVerificationState)verificationStateForAddress:(SignalServiceAddress *)address
 {
     __block OWSVerificationState result;
diff --git a/SignalServiceKit/src/Messages/OWSIdentityManager.swift b/SignalServiceKit/src/Messages/OWSIdentityManager.swift
index 916587747b3..04d63bef17d 100644
--- a/SignalServiceKit/src/Messages/OWSIdentityManager.swift
+++ b/SignalServiceKit/src/Messages/OWSIdentityManager.swift
@@ -1,5 +1,5 @@
 //
-//  Copyright (c) 2020 Open Whisper Systems. All rights reserved.
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
 //
 
 import SignalClient
@@ -62,4 +62,10 @@ extension OWSIdentityManager: IdentityKeyStore {
         }
         return try SignalClient.IdentityKey(publicKey: ECPublicKey(keyData: data).key)
     }
+
+    @objc
+    public func groupContainsUnverifiedMember(_ groupUniqueID: String,
+                                              transaction: SDSAnyReadTransaction) -> Bool {
+        return OWSRecipientIdentity.groupContainsUnverifiedMember(groupUniqueID, transaction: transaction)
+    }
 }
diff --git a/SignalServiceKit/src/Security/OWSRecipientIdentity+SDS.swift b/SignalServiceKit/src/Security/OWSRecipientIdentity+SDS.swift
index 6c4ac2c7eb8..4d4d0129139 100644
--- a/SignalServiceKit/src/Security/OWSRecipientIdentity+SDS.swift
+++ b/SignalServiceKit/src/Security/OWSRecipientIdentity+SDS.swift
@@ -394,6 +394,27 @@ public extension OWSRecipientIdentity {
         }
     }
 
+    class func groupContainsUnverifiedMember(_ groupUniqueID: String,
+                                             transaction: SDSAnyReadTransaction) -> Bool {
+        let members = groupMembers(ofGroupWithUniqueID: groupUniqueID,
+                                   withVerificationState: .verified,
+                                   negated: true,
+                                   limit: 1,
+                                   transaction: transaction)
+        return !members.isEmpty
+    }
+
+    @objc(noLongerVerifiedAddressesInGroup:limit:transaction:)
+    class func noLongerVerifiedAddresses(inGroup groupThreadID: String,
+                                         limit: Int,
+                                         transaction: SDSAnyReadTransaction) -> [SignalServiceAddress] {
+        return groupMembers(ofGroupWithUniqueID: groupThreadID,
+                            withVerificationState: .noLongerVerified,
+                            negated: false,
+                            limit: limit,
+                            transaction: transaction)
+    }
+
     // Traverses all records.
     // Records are not visited in any particular order.
     class func anyEnumerate(transaction: SDSAnyReadTransaction,
@@ -587,6 +608,76 @@ public extension OWSRecipientIdentity {
     }
 }
 
+fileprivate extension OWSRecipientIdentity {
+    private class func sqlQueryToFetchVerifiedAddresses(groupUniqueID: String,
+                                                        withVerificationState state: OWSVerificationState,
+                                                        negated: Bool,
+                                                        limit: Int) -> String {
+        let limitClause: String
+        if limit < Int.max {
+            limitClause = "LIMIT \(limit)"
+        } else {
+            limitClause = ""
+        }
+        let comparisonOperator = negated ? "!=" : "="
+        let stateClause = "\(recipientIdentityColumnFullyQualified: .verificationState) \(comparisonOperator) \(state.rawValue)"
+
+        let groupMember_phoneNumber = "\(groupMemberColumnFullyQualified: .phoneNumber)"
+        let groupMember_groupThreadID = "\(groupMemberColumnFullyQualified: .groupThreadId)"
+        let groupMember_uuidString = "\(groupMemberColumnFullyQualified: .uuidString)"
+
+        let recipient_id = "\(signalRecipientColumnFullyQualified: .id)"
+        let recipient_recipientPhoneNumber = "\(signalRecipientColumnFullyQualified:  .recipientPhoneNumber)"
+        let recipient_recipientUUID = "\(signalRecipientColumnFullyQualified: .recipientUUID)"
+        let recipient_uniqueID = "\(signalRecipientColumnFullyQualified: .uniqueId)"
+
+        let recipientIdentity_uniqueID = "\(recipientIdentityColumnFullyQualified: .uniqueId)"
+
+        let sql =
+        """
+        SELECT \(recipient_recipientUUID), \(recipient_recipientPhoneNumber)
+        FROM \(SignalRecipientRecord.databaseTableName),
+             \(RecipientIdentityRecord.databaseTableName),
+             \(GroupMemberRecord.databaseTableName)
+        WHERE  \(recipient_uniqueID) = \(recipientIdentity_uniqueID) AND
+               \(groupMember_groupThreadID) = ? AND
+               (\(groupMember_uuidString) = \(recipient_recipientUUID) OR
+                \(groupMember_phoneNumber) = \(recipient_recipientPhoneNumber))
+        AND
+               \(stateClause)
+        ORDER BY \(recipient_id)
+        \(limitClause)
+        """
+        return sql
+    }
+
+    class func groupMembers(ofGroupWithUniqueID groupUniqueID: String,
+                            withVerificationState state: OWSVerificationState,
+                            negated: Bool,
+                            limit: Int,
+                            transaction: SDSAnyReadTransaction) -> [SignalServiceAddress] {
+        switch transaction.readTransaction {
+        case .grdbRead(let grdbTransaction):
+            let sql = sqlQueryToFetchVerifiedAddresses(groupUniqueID: groupUniqueID,
+                                                       withVerificationState: state,
+                                                       negated: negated,
+                                                       limit: limit)
+            do {
+                let cursor = try Row.fetchCursor(grdbTransaction.database,
+                                                 sql: sql,
+                                                 arguments: StatementArguments([groupUniqueID]))
+                let mapped = cursor.map { row in
+                    return SignalServiceAddress(uuid: row[0], phoneNumber: row[1])
+                }
+                return try Array(mapped)
+            } catch {
+                owsFailDebug("error: \(error)")
+                return []
+            }
+        }
+    }
+}
+
 // MARK: - SDSSerializer
 
 // The SDSSerializer protocol specifies how to insert and update the
