diff --git a/Signal/src/ViewControllers/AppSettings/Profile/BadgeConfigurationViewController.swift b/Signal/src/ViewControllers/AppSettings/Profile/BadgeConfigurationViewController.swift
index 68ae30eae0f..dbc222ea0e8 100644
--- a/Signal/src/ViewControllers/AppSettings/Profile/BadgeConfigurationViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Profile/BadgeConfigurationViewController.swift
@@ -4,10 +4,16 @@
 
 import Foundation
 import SignalUI
+import UIKit
+
+enum BadgeConfiguration {
+    case doNotDisplayPublicly
+    case display(featuredBadge: OWSUserProfileBadgeInfo)
+}
 
 protocol BadgeConfigurationDelegate: AnyObject {
-    func updateFeaturedBadge(_: OWSUserProfileBadgeInfo)
-    func shouldDisplayBadgesPublicly(_: Bool)
+    func badgeConfiguration(_: BadgeConfigurationViewController, didCompleteWithBadgeSetting setting: BadgeConfiguration)
+    func badgeConfirmationDidCancel(_: BadgeConfigurationViewController)
 }
 
 class BadgeConfigurationViewController: OWSTableViewController2, BadgeCollectionDataSource {
@@ -41,7 +47,32 @@ class BadgeConfigurationViewController: OWSTableViewController2, BadgeCollection
     }
 
     private var hasUnsavedChanges: Bool {
-        displayBadgeOnProfile != initialDisplaySetting || selectedBadgeIndex != 0
+        if displayBadgeOnProfile, selectedBadgeIndex != 0 {
+            return true
+        } else {
+            return displayBadgeOnProfile != initialDisplaySetting
+        }
+    }
+
+    public var showDismissalActivity = false {
+        didSet {
+            updateNavigation()
+        }
+    }
+
+    convenience init(fetchingDataFromLocalProfileWithDelegate delegate: BadgeConfigurationDelegate) {
+        let snapshot = Self.profileManagerImpl.localProfileSnapshot(shouldIncludeAvatar: false)
+        let allBadges = snapshot.profileBadgeInfo ?? []
+        let shouldDisplayOnProfile = allBadges.allSatisfy { badge in
+            if let isVisible = badge.isVisible {
+                return isVisible
+            } else {
+                owsFailDebug("Expecting visibility for local profile badge settings")
+                return true
+            }
+        }
+
+        self.init(availableBadges: allBadges, shouldDisplayOnProfile: shouldDisplayOnProfile, delegate: delegate)
     }
 
     init(availableBadges: [OWSUserProfileBadgeInfo], shouldDisplayOnProfile: Bool, avatarImage: UIImage? = nil, delegate: BadgeConfigurationDelegate) {
@@ -71,14 +102,23 @@ class BadgeConfigurationViewController: OWSTableViewController2, BadgeCollection
             accessibilityIdentifier: "cancel_button"
         )
 
-        if hasUnsavedChanges {
+        if hasUnsavedChanges, showDismissalActivity {
+            let indicatorStyle: UIActivityIndicatorView.Style
+            if #available(iOS 13, *) {
+                indicatorStyle = .medium
+            } else {
+                indicatorStyle = Theme.isDarkThemeEnabled ? .white : .gray
+            }
+            let spinner = UIActivityIndicatorView(style: indicatorStyle)
+            spinner.startAnimating()
+            navigationItem.rightBarButtonItem = UIBarButtonItem(customView: spinner)
+        } else if hasUnsavedChanges, !showDismissalActivity {
             navigationItem.rightBarButtonItem = UIBarButtonItem(
                 title: CommonStrings.setButton,
                 style: .done,
                 target: self,
                 action: #selector(didTapDone),
-                accessibilityIdentifier: "set_button"
-            )
+                accessibilityIdentifier: "set_button")
         } else {
             navigationItem.rightBarButtonItem = nil
         }
@@ -86,26 +126,25 @@ class BadgeConfigurationViewController: OWSTableViewController2, BadgeCollection
 
     @objc
     func didTapCancel() {
-        let dismissBlock: () -> Void = { [weak self] in
-            self?.dismiss(animated: true)
+        let requestDismissal: () -> Void = { [weak self] in
+            guard let self = self else { return }
+            self.badgeConfigDelegate?.badgeConfirmationDidCancel(self)
         }
 
         if hasUnsavedChanges {
-            OWSActionSheets.showPendingChangesActionSheet(discardAction: dismissBlock)
+            OWSActionSheets.showPendingChangesActionSheet(discardAction: requestDismissal)
         } else {
-            dismissBlock()
+            requestDismissal()
         }
     }
 
     @objc
     func didTapDone() {
-        if selectedBadgeIndex != 0, let selectedPrimaryBadge = selectedPrimaryBadge {
-            badgeConfigDelegate?.updateFeaturedBadge(selectedPrimaryBadge)
-        }
-        if displayBadgeOnProfile != initialDisplaySetting {
-            badgeConfigDelegate?.shouldDisplayBadgesPublicly(displayBadgeOnProfile)
+        if displayBadgeOnProfile, let selectedPrimaryBadge = selectedPrimaryBadge {
+            badgeConfigDelegate?.badgeConfiguration(self, didCompleteWithBadgeSetting: .display(featuredBadge: selectedPrimaryBadge))
+        } else {
+            badgeConfigDelegate?.badgeConfiguration(self, didCompleteWithBadgeSetting: .doNotDisplayPublicly)
         }
-        dismiss(animated: true)
     }
 
     override var isModalInPresentation: Bool {
diff --git a/Signal/src/ViewControllers/AppSettings/Profile/ProfileSettingsViewController.swift b/Signal/src/ViewControllers/AppSettings/Profile/ProfileSettingsViewController.swift
index b771c8bad44..bf3ec526eb3 100644
--- a/Signal/src/ViewControllers/AppSettings/Profile/ProfileSettingsViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Profile/ProfileSettingsViewController.swift
@@ -385,26 +385,35 @@ extension ProfileSettingsViewController: ProfileNameViewControllerDelegate {
 }
 
 extension ProfileSettingsViewController: BadgeConfigurationDelegate {
-    func updateFeaturedBadge(_ updatedFeaturedBadge: OWSUserProfileBadgeInfo) {
-        guard allBadges.contains(where: { $0.badgeId == updatedFeaturedBadge.badgeId}) else {
-            owsFailDebug("Invalid badge")
-            return
-        }
+    func badgeConfiguration(_ vc: BadgeConfigurationViewController, didCompleteWithBadgeSetting setting: BadgeConfiguration) {
+        switch setting {
+        case .doNotDisplayPublicly:
+            if displayBadgesOnProfile {
+                Logger.info("Configured to disable public badge visibility")
+                hasUnsavedChanges = true
+                displayBadgesOnProfile = false
+                updateTableContents()
+            }
+        case .display(featuredBadge: let newFeaturedBadge):
+            guard allBadges.contains(where: { $0.badgeId == newFeaturedBadge.badgeId }) else {
+                owsFailDebug("Invalid badge")
+                return
+            }
 
-        if updatedFeaturedBadge.badgeId != allBadges.first?.badgeId {
-            hasUnsavedChanges = true
+            if !displayBadgesOnProfile || newFeaturedBadge.badgeId != allBadges.first?.badgeId {
+                Logger.info("Configured to show badges publicly featuring: \(newFeaturedBadge.badgeId)")
+                hasUnsavedChanges = true
 
-            let nonPrimaryBadges = allBadges.filter { $0.badgeId != updatedFeaturedBadge.badgeId }
-            allBadges = [updatedFeaturedBadge] + nonPrimaryBadges
-            updateTableContents()
+                let nonPrimaryBadges = allBadges.filter { $0.badgeId != newFeaturedBadge.badgeId }
+                allBadges = [newFeaturedBadge] + nonPrimaryBadges
+                updateTableContents()
+            }
         }
+
+        vc.dismiss(animated: true)
     }
 
-    func shouldDisplayBadgesPublicly(_ shouldDisplayPublicly: Bool) {
-        if displayBadgesOnProfile != shouldDisplayPublicly {
-            hasUnsavedChanges = true
-            displayBadgesOnProfile = shouldDisplayPublicly
-            updateTableContents()
-        }
+    func badgeConfirmationDidCancel(_ vc: BadgeConfigurationViewController) {
+        vc.dismiss(animated: true)
     }
 }
diff --git a/Signal/src/ViewControllers/AppSettings/SubscriptionViewController.swift b/Signal/src/ViewControllers/AppSettings/SubscriptionViewController.swift
index f884ec5f5c3..85f1e457a46 100644
--- a/Signal/src/ViewControllers/AppSettings/SubscriptionViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/SubscriptionViewController.swift
@@ -627,10 +627,7 @@ class SubscriptionViewController: OWSTableViewController2 {
                 accessibilityIdentifier: UIView.accessibilityIdentifier(in: self, name: "badges"),
                 actionBlock: { [weak self] in
                     if let self = self {
-                        let vc = BadgeConfigurationViewController(
-                            availableBadges: self.profileManagerImpl.localUserProfile().profileBadgeInfo ?? [],
-                            shouldDisplayOnProfile: false,
-                            delegate: self)
+                        let vc = BadgeConfigurationViewController(fetchingDataFromLocalProfileWithDelegate: self)
                         self.navigationController?.pushViewController(vc, animated: true)
                     }
                 }
@@ -1189,12 +1186,54 @@ extension SubscriptionViewController: PKPaymentAuthorizationControllerDelegate {
 }
 
 extension SubscriptionViewController: BadgeConfigurationDelegate {
-    func updateFeaturedBadge(_ updatedFeaturedBadge: OWSUserProfileBadgeInfo) {
-        // TODO
+    func badgeConfiguration(_ vc: BadgeConfigurationViewController, didCompleteWithBadgeSetting setting: BadgeConfiguration) {
+        if !self.reachabilityManager.isReachable {
+            OWSActionSheets.showErrorAlert(
+                message: NSLocalizedString("PROFILE_VIEW_NO_CONNECTION",
+                                           comment: "Error shown when the user tries to update their profile when the app is not connected to the internet."))
+            return
+        }
+
+        firstly { () -> Promise<Void> in
+            let snapshot = profileManagerImpl.localProfileSnapshot(shouldIncludeAvatar: true)
+            let allBadges = snapshot.profileBadgeInfo ?? []
+            let oldVisibleBadgeIds = allBadges.filter { $0.isVisible ?? true }.map { $0.badgeId }
+            let newVisibleBadgeIds: [String]
+
+            switch setting {
+            case .doNotDisplayPublicly:
+                newVisibleBadgeIds = []
+            case .display(featuredBadge: let newFeaturedBadge):
+                guard allBadges.contains(where: { $0.badgeId == newFeaturedBadge.badgeId }) else {
+                    throw OWSAssertionError("Invalid badge")
+                }
+                newVisibleBadgeIds = [newFeaturedBadge.badgeId] + oldVisibleBadgeIds.filter { $0 != newFeaturedBadge.badgeId }
+            }
+
+            if oldVisibleBadgeIds != newVisibleBadgeIds {
+                Logger.info("Updating visible badges from \(oldVisibleBadgeIds) to \(newVisibleBadgeIds)")
+                vc.showDismissalActivity = true
+                return OWSProfileManager.updateLocalProfilePromise(
+                    profileGivenName: snapshot.givenName,
+                    profileFamilyName: snapshot.familyName,
+                    profileBio: snapshot.bio,
+                    profileBioEmoji: snapshot.bioEmoji,
+                    profileAvatarData: snapshot.avatarData,
+                    visibleBadgeIds: newVisibleBadgeIds,
+                    userProfileWriter: .localUser)
+            } else {
+                return Promise.value(())
+            }
+        }.done {
+            self.navigationController?.popViewController(animated: true)
+        }.catch { error in
+            owsFailDebug("Failed to update profile: \(error)")
+            self.navigationController?.popViewController(animated: true)
+        }
     }
 
-    func shouldDisplayBadgesPublicly(_ shouldDisplayPublicly: Bool) {
-        // TODO
+    func badgeConfirmationDidCancel(_: BadgeConfigurationViewController) {
+        self.navigationController?.popViewController(animated: true)
     }
 }
 
diff --git a/SignalUI/Views/ConversationAvatarView.swift b/SignalUI/Views/ConversationAvatarView.swift
index 0328d8ed900..a651422f134 100644
--- a/SignalUI/Views/ConversationAvatarView.swift
+++ b/SignalUI/Views/ConversationAvatarView.swift
@@ -550,6 +550,11 @@ public enum ConversationAvatarDataSource: Equatable, Dependencies, CustomStringC
             return badge
         }
 
+        if targetAddress.isLocalAddress, configuration.localUserDisplayMode == .noteToSelf {
+            // We never want to show badges on Note To Self
+            return nil
+        }
+
         let primaryBadge: ProfileBadge? = performWithTransaction(transaction) {
             let userProfile: OWSUserProfile?
             if targetAddress.isLocalAddress {
