diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
index d07dd73b23a..946a646afef 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
@@ -424,7 +424,7 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
         }
     }
 
-    private var textMessageFont: UIFont {
+    public var textMessageFont: UIFont {
         owsAssertDebug(DisplayableText.kMaxJumbomojiCount == 5)
 
         if isJumbomoji, let jumbomojiCount = bodyText.jumbomojiCount {
@@ -466,16 +466,27 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
     }
 
     public func bodyTextLabelConfig(textViewConfig: CVTextViewConfig) -> CVBodyTextLabel.Config {
-        let selectionColor = textSelectionColor
-        return CVBodyTextLabel.Config(attributedString: textViewConfig.text.attributedString,
-                                      font: textViewConfig.font,
-                                      textColor: textViewConfig.textColor,
-                                      selectionColor: selectionColor,
-                                      textAlignment: textViewConfig.textAlignment ?? .natural,
-                                      lineBreakMode: .byWordWrapping,
-                                      numberOfLines: 0,
-                                      cacheKey: textViewConfig.cacheKey,
-                                      items: bodyTextState.items)
+        CVBodyTextLabel.Config(attributedString: textViewConfig.text.attributedString,
+                               font: textViewConfig.font,
+                               textColor: textViewConfig.textColor,
+                               selectionColor: textSelectionColor,
+                               textAlignment: textViewConfig.textAlignment ?? .natural,
+                               lineBreakMode: .byWordWrapping,
+                               numberOfLines: 0,
+                               cacheKey: textViewConfig.cacheKey,
+                               items: bodyTextState.items)
+    }
+
+    public func bodyTextLabelConfig(labelConfig: CVLabelConfig) -> CVBodyTextLabel.Config {
+        CVBodyTextLabel.Config(attributedString: labelConfig.attributedString,
+                               font: labelConfig.font,
+                               textColor: labelConfig.textColor,
+                               selectionColor: textSelectionColor,
+                               textAlignment: labelConfig.textAlignment ?? .natural,
+                               lineBreakMode: .byWordWrapping,
+                               numberOfLines: 0,
+                               cacheKey: labelConfig.cacheKey,
+                               items: bodyTextState.items)
     }
 
     public func configureForRendering(componentView: CVComponentView,
@@ -506,59 +517,46 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
 
     private func configureForRemotelyDeleted(componentView: CVComponentViewBodyText,
                                              cellMeasurement: CVCellMeasurement) {
-        _ = configureForLabel(componentView: componentView,
-                              labelConfig: labelConfigForRemotelyDeleted,
-                              cellMeasurement: cellMeasurement)
+        let labelConfig = labelConfigForRemotelyDeleted
+        let bodyTextLabelConfig = self.bodyTextLabelConfig(labelConfig: labelConfig)
+        configureForBodyTextLabel(componentView: componentView,
+                                  bodyTextLabelConfig: bodyTextLabelConfig,
+                                  cellMeasurement: cellMeasurement)
     }
 
     private func configureForOversizeTextDownloading(componentView: CVComponentViewBodyText,
                                                      cellMeasurement: CVCellMeasurement) {
-        _ = configureForLabel(componentView: componentView,
-                              labelConfig: labelConfigForOversizeTextDownloading,
-                              cellMeasurement: cellMeasurement)
+        let labelConfig = labelConfigForOversizeTextDownloading
+        let bodyTextLabelConfig = self.bodyTextLabelConfig(labelConfig: labelConfig)
+        configureForBodyTextLabel(componentView: componentView,
+                                  bodyTextLabelConfig: bodyTextLabelConfig,
+                                  cellMeasurement: cellMeasurement)
     }
 
-    private func configureForLabel(componentView: CVComponentViewBodyText,
-                                   labelConfig: CVLabelConfig,
-                                   cellMeasurement: CVCellMeasurement) -> UILabel {
-        let label = componentView.ensuredLabel
-        labelConfig.applyForRendering(label: label)
+    public func configureForBodyText(componentView: CVComponentViewBodyText,
+                                     displayableText: DisplayableText,
+                                     cellMeasurement: CVCellMeasurement) {
+        let textViewConfig = textConfig(displayableText: displayableText)
+        let bodyTextLabelConfig = self.bodyTextLabelConfig(textViewConfig: textViewConfig)
+        configureForBodyTextLabel(componentView: componentView,
+                                              bodyTextLabelConfig: bodyTextLabelConfig,
+                                              cellMeasurement: cellMeasurement)
+    }
+
+    public func configureForBodyTextLabel(componentView: CVComponentViewBodyText,
+                                          bodyTextLabelConfig: CVBodyTextLabel.Config,
+                                          cellMeasurement: CVCellMeasurement) {
 
-        if label.superview == nil {
+        let bodyTextLabel = componentView.bodyTextLabel
+        bodyTextLabel.configureForRendering(config: bodyTextLabelConfig)
+
+        if bodyTextLabel.view.superview == nil {
             let stackView = componentView.stackView
             stackView.reset()
-
             stackView.configure(config: stackViewConfig,
                                 cellMeasurement: cellMeasurement,
                                 measurementKey: Self.measurementKey_stackView,
-                                subviews: [ label ])
-        }
-
-        return label
-    }
-
-    public func configureForBodyText(componentView: CVComponentViewBodyText,
-                                     displayableText: DisplayableText,
-                                     cellMeasurement: CVCellMeasurement) {
-
-        switch textConfig(displayableText: displayableText) {
-        case .labelConfig(let labelConfig):
-            _ = configureForLabel(componentView: componentView,
-                                  labelConfig: labelConfig,
-                                  cellMeasurement: cellMeasurement)
-        case .textViewConfig(let textViewConfig):
-            let bodyTextLabel = componentView.ensuredBodyTextLabel
-            let bodyTextLabelConfig = self.bodyTextLabelConfig(textViewConfig: textViewConfig)
-            bodyTextLabel.configureForRendering(config: bodyTextLabelConfig)
-
-            if bodyTextLabel.view.superview == nil {
-                let stackView = componentView.stackView
-                stackView.reset()
-                stackView.configure(config: stackViewConfig,
-                                    cellMeasurement: cellMeasurement,
-                                    measurementKey: Self.measurementKey_stackView,
-                                    subviews: [ bodyTextLabel.view ])
-            }
+                                subviews: [ bodyTextLabel.view ])
         }
     }
 
@@ -592,10 +590,7 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
                              textAlignment: .center)
     }
 
-    private enum TextConfig {
-        case labelConfig(labelConfig: CVLabelConfig)
-        case textViewConfig(textViewConfig: CVTextViewConfig)
-    }
+    private typealias TextConfig = CVTextViewConfig
 
     private func textConfig(displayableText: DisplayableText) -> TextConfig {
 
@@ -603,28 +598,12 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
 
         switch textValue {
         case .text(let text):
-            if shouldUseAttributedText {
-                let attributedText = NSAttributedString(string: text)
-                let textViewConfig = self.textViewConfig(displayableText: displayableText,
-                                                         attributedText: attributedText)
-                return .textViewConfig(textViewConfig: textViewConfig)
-            } else {
-                let labelConfig = CVLabelConfig(
-                    text: text,
-                    font: textMessageFont,
-                    textColor: bodyTextColor,
-                    numberOfLines: 0,
-                    lineBreakMode: .byWordWrapping,
-                    textAlignment: isTextExpanded
-                        ? displayableText.fullTextNaturalAlignment
-                        : displayableText.displayTextNaturalAlignment
-                )
-                return .labelConfig(labelConfig: labelConfig)
-            }
+            let attributedText = NSAttributedString(string: text)
+            return self.textViewConfig(displayableText: displayableText,
+                                       attributedText: attributedText)
         case .attributedText(let attributedText):
-            let textViewConfig = self.textViewConfig(displayableText: displayableText,
-                                                     attributedText: attributedText)
-            return .textViewConfig(textViewConfig: textViewConfig)
+            return self.textViewConfig(displayableText: displayableText,
+                                       attributedText: attributedText)
         }
     }
 
@@ -763,26 +742,38 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
     }
 
     private static let measurementKey_stackView = "CVComponentBodyText.measurementKey_stackView"
+    private static let measurementKey_textMeasurement = "CVComponentBodyText.measurementKey_textMeasurement"
+    private static let measurementKey_maxWidth = "CVComponentBodyText.measurementKey_maxWidth"
+
+    // Extract the max width used for measuring for this component.
+    public static func bodyTextMaxWidth(measurementBuilder: CVCellMeasurement.Builder) -> CGFloat? {
+        measurementBuilder.getValue(key: measurementKey_maxWidth)
+    }
+
+    // Extract the overall measurement for this component.
+    public static func bodyTextMeasurement(measurementBuilder: CVCellMeasurement.Builder) -> CVBodyTextLabel.Measurement? {
+        measurementBuilder.getObject(key: measurementKey_textMeasurement) as? CVBodyTextLabel.Measurement
+    }
 
     public func measure(maxWidth: CGFloat, measurementBuilder: CVCellMeasurement.Builder) -> CGSize {
         owsAssertDebug(maxWidth > 0)
+        let maxWidth = max(maxWidth, 0)
 
-        let textSize: CGSize = {
+        let bodyTextLabelConfig: CVBodyTextLabel.Config = {
             switch bodyText {
             case .bodyText(let displayableText):
-                switch textConfig(displayableText: displayableText) {
-                case .labelConfig(let labelConfig):
-                    return CVText.measureLabel(config: labelConfig, maxWidth: maxWidth).ceil
-                case .textViewConfig(let textViewConfig):
-                    let bodyTextLabelConfig = self.bodyTextLabelConfig(textViewConfig: textViewConfig)
-                    return CVText.measureBodyTextLabel(config: bodyTextLabelConfig, maxWidth: maxWidth).ceil
-                }
+                let textViewConfig = textConfig(displayableText: displayableText)
+                return self.bodyTextLabelConfig(textViewConfig: textViewConfig)
             case .oversizeTextDownloading:
-                return CVText.measureLabel(config: labelConfigForOversizeTextDownloading, maxWidth: maxWidth).ceil
+                return self.bodyTextLabelConfig(labelConfig: labelConfigForOversizeTextDownloading)
             case .remotelyDeleted:
-                return CVText.measureLabel(config: labelConfigForRemotelyDeleted, maxWidth: maxWidth).ceil
+                return self.bodyTextLabelConfig(labelConfig: labelConfigForRemotelyDeleted)
             }
         }()
+        let textMeasurement = CVText.measureBodyTextLabel(config: bodyTextLabelConfig, maxWidth: maxWidth)
+        measurementBuilder.setObject(key: Self.measurementKey_textMeasurement, value: textMeasurement)
+        measurementBuilder.setValue(key: Self.measurementKey_maxWidth, value: maxWidth)
+        let textSize = textMeasurement.size.ceil
         let textInfo = textSize.asManualSubviewInfo
         let stackMeasurement = ManualStackView.measure(config: stackViewConfig,
                                                        measurementBuilder: measurementBuilder,
@@ -807,8 +798,8 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
             return false
         }
 
-        if let bodyTextLabel = componentView.possibleBodyTextLabel,
-           let item = bodyTextLabel.itemForGesture(sender: sender) {
+        let bodyTextLabel = componentView.bodyTextLabel
+        if let item = bodyTextLabel.itemForGesture(sender: sender) {
             bodyTextLabel.animate(selectedItem: item)
             componentDelegate.cvc_didTapBodyTextItem(.init(item: item))
             return true
@@ -837,8 +828,8 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
             return nil
         }
 
-        guard let bodyTextLabel = componentView.possibleBodyTextLabel,
-              let item = bodyTextLabel.itemForGesture(sender: sender) else {
+        let bodyTextLabel = componentView.bodyTextLabel
+        guard let item = bodyTextLabel.itemForGesture(sender: sender) else {
             return nil
         }
         bodyTextLabel.animate(selectedItem: item)
@@ -873,27 +864,7 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
 
         fileprivate let stackView = BodyTextRootView(name: "bodyText")
 
-        private var _bodyTextLabel: CVBodyTextLabel?
-        fileprivate var possibleBodyTextLabel: CVBodyTextLabel? { _bodyTextLabel }
-        fileprivate var ensuredBodyTextLabel: CVBodyTextLabel {
-            if let bodyTextLabel = _bodyTextLabel {
-                return bodyTextLabel
-            }
-            let bodyTextLabel = CVBodyTextLabel()
-            _bodyTextLabel = bodyTextLabel
-            return bodyTextLabel
-        }
-
-        private var _label: UILabel?
-        fileprivate var possibleLabel: UILabel? { _label }
-        fileprivate var ensuredLabel: UILabel {
-            if let label = _label {
-                return label
-            }
-            let label = CVLabel()
-            _label = label
-            return label
-        }
+        public let bodyTextLabel = CVBodyTextLabel()
 
         public var isDedicatedCellView = false
 
@@ -914,10 +885,8 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
                 stackView.reset()
             }
 
-            _label?.text = nil
-            _bodyTextLabel?.reset()
+            bodyTextLabel.reset()
         }
-
     }
 }
 
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
index e5db3211ff9..7a997f58bee 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
@@ -304,6 +304,11 @@ public class CVComponentFooter: CVComponentBase, CVComponent {
     private static let measurementKey_outerStack = "CVComponentFooter.measurementKey_outerStack"
     private static let measurementKey_innerStack = "CVComponentFooter.measurementKey_innerStack"
 
+    // Extract the overall measurement for this component.
+    public static func footerMeasurement(measurementBuilder: CVCellMeasurement.Builder) -> CVCellMeasurement.Measurement? {
+        measurementBuilder.getMeasurement(key: measurementKey_outerStack)
+    }
+
     public func measure(maxWidth: CGFloat, measurementBuilder: CVCellMeasurement.Builder) -> CGSize {
         owsAssertDebug(maxWidth > 0)
 
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentMessage.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentMessage.swift
index c1592e2783e..2bed4d7eae4 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentMessage.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentMessage.swift
@@ -744,6 +744,13 @@ public class CVComponentMessage: CVComponentBase, CVRootComponent {
                     return
                 }
                 let componentKeys = contentSection.components.map { $0.componentKey }
+
+                var stackConfig = stackConfig
+                if contentSection.sectionType == .bottomNestedText,
+                   let bottomNestedTextSpacing = cellMeasurement.value(key: Self.measurementKey_bottomNestedTextSpacing) {
+                    stackConfig = stackConfig.withSpacing(bottomNestedTextSpacing)
+                }
+
                 _ = configureStackView(stackView,
                                        stackConfig: stackConfig,
                                        measurementKey: stackMeasurementKey,
@@ -1203,6 +1210,7 @@ public class CVComponentMessage: CVComponentBase, CVRootComponent {
     private static let measurementKey_bottomNestedShareStackView = "CVComponentMessage.measurementKey_bottomNestedShareStackView"
     private static let measurementKey_bottomNestedTextStackView = "CVComponentMessage.measurementKey_bottomNestedTextStackView"
     private static let measurementKey_reactions = "CVComponentMessage.measurementKey_reactions"
+    private static let measurementKey_bottomNestedTextSpacing = "CVComponentMessage.measurementKey_bottomNestedTextSpacing"
 
     public func measure(maxWidth: CGFloat, measurementBuilder: CVCellMeasurement.Builder) -> CGSize {
         owsAssertDebug(maxWidth > 0)
@@ -1313,6 +1321,60 @@ public class CVComponentMessage: CVComponentBase, CVRootComponent {
             let subviewInfos: [ManualStackSubviewInfo] = subviewSizes.map { subviewSize in
                 subviewSize.asManualSubviewInfo
             }
+
+            var stackConfig = stackConfig
+            if let bodyText = self.bodyText as? CVComponentBodyText,
+               keys == [ .bodyText, .footer ] {
+                if let footerMeasurement = CVComponentFooter.footerMeasurement(measurementBuilder: measurementBuilder),
+                   let bodyTextMaxWidth = CVComponentBodyText.bodyTextMaxWidth(measurementBuilder: measurementBuilder),
+                    let bodyTextMeasurement = CVComponentBodyText.bodyTextMeasurement(measurementBuilder: measurementBuilder),
+                    let lastLineRect = bodyTextMeasurement.lastLineRect {
+                    //                    let lastGlyphRect = bodyTextMeasurement.lastGlyphRect {
+                    Logger.verbose("----- footerMeasurement: \(footerMeasurement.measuredSize)")
+                    Logger.verbose("----- bodyTextMaxWidth: \(bodyTextMaxWidth)")
+                    Logger.verbose("----- bodyTextMeasurement: \(bodyTextMeasurement.size)")
+                    //                        Logger.verbose("----- lastGlyphRect: \(lastGlyphRect)")
+                    Logger.verbose("----- lastLineRect: \(lastLineRect)")
+
+                    // TODO: Design is finalizing how this value should scale with dynamic type.
+                    let kMinimumOverlapSpacing: CGFloat = 6
+                    let overlapWidth = ceil(lastLineRect.width) + kMinimumOverlapSpacing + footerMeasurement.measuredSize.width
+                    // TODO: Refine to account for RTL.
+                    let shouldOverlap = overlapWidth <= bodyTextMaxWidth
+                    Logger.verbose("----- shouldOverlap: \(shouldOverlap)")
+                    if shouldOverlap {
+                        let measurement1 = ManualStackView.measure(config: stackConfig,
+                                                                   subviewInfos: subviewInfos)
+                        let textMessageFont = bodyText.textMessageFont
+                        let lineHeight = max(0, textMessageFont.lineHeight)
+                        let capHeight = max(0, textMessageFont.capHeight)
+                        // NOTE: descender is expressed as a negative value.
+                        let descender = max(0, -textMessageFont.descender)
+                        let fontOuterSpacing = max(0, lineHeight - (capHeight + descender)) * 0.5
+                        let baselineSpacing = max(0, fontOuterSpacing + descender)
+                        // We want to v-align the center of the footer with the baseline of the
+                        // last line of body text.
+                        let overlapHeight = footerMeasurement.measuredSize.height * 0.5 + baselineSpacing
+                        let bottomNestedTextSpacing = -overlapHeight
+                        stackConfig = stackConfig.withSpacing(bottomNestedTextSpacing)
+                        measurementBuilder.setValue(key: Self.measurementKey_bottomNestedTextSpacing,
+                                                    value: bottomNestedTextSpacing)
+                        let measurement2 = ManualStackView.measure(config: stackConfig,
+                                                                   subviewInfos: subviewInfos)
+                        Logger.verbose("----- lineHeight: \(textMessageFont.lineHeight)")
+                        Logger.verbose("----- capHeight: \(textMessageFont.capHeight)")
+                        Logger.verbose("----- descender: \(textMessageFont.descender)")
+                        Logger.verbose("----- fontOuterSpacing: \(fontOuterSpacing)")
+                        Logger.verbose("----- baselineSpacing: \(baselineSpacing)")
+                        Logger.verbose("----- overlapHeight: \(overlapHeight)")
+                        Logger.verbose("----- measurement1: \(measurement1.measuredSize)")
+                        Logger.verbose("----- measurement2: \(measurement2.measuredSize)")
+                    }
+                } else {
+                    owsFailDebug("Missing measurements.")
+                }
+            }
+
             let stackMeasurement = ManualStackView.measure(config: stackConfig,
                                                            measurementBuilder: measurementBuilder,
                                                            measurementKey: measurementKey,
@@ -2329,7 +2391,8 @@ fileprivate extension CVComponentMessage {
     }
 
     private func buildNestedStackConfig(topMargin: ContentStackMargin,
-                                        bottomMargin: ContentStackMargin) -> CVStackViewConfig {
+                                        bottomMargin: ContentStackMargin,
+                                        customSpacing: CGFloat? = nil) -> CVStackViewConfig {
         func marginValue(_ margin: ContentStackMargin) -> CGFloat {
             switch margin {
             case .none:
@@ -2347,9 +2410,10 @@ fileprivate extension CVComponentMessage {
         var layoutMargins = conversationStyle.textInsets
         layoutMargins.top = marginValue(topMargin)
         layoutMargins.bottom = marginValue(bottomMargin)
+        let spacing = customSpacing ?? Self.textViewVSpacing
         return CVStackViewConfig(axis: .vertical,
                                  alignment: .fill,
-                                 spacing: Self.textViewVSpacing,
+                                 spacing: spacing,
                                  layoutMargins: layoutMargins)
     }
 
diff --git a/SignalMessaging/Views/ConversationView/CVBodyTextLabel.swift b/SignalMessaging/Views/ConversationView/CVBodyTextLabel.swift
index 4d24528a582..006defa9989 100644
--- a/SignalMessaging/Views/ConversationView/CVBodyTextLabel.swift
+++ b/SignalMessaging/Views/ConversationView/CVBodyTextLabel.swift
@@ -151,9 +151,36 @@ public class CVBodyTextLabel: NSObject {
         label.reset()
     }
 
-    public static func measureSize(config: Config, maxWidth: CGFloat) -> CGSize {
+    public class Measurement: CVMeasurementObject {
+        public let size: CGSize
+        // TODO:
+//        public let lastGlyphRect: CGRect?
+        public let lastLineRect: CGRect?
+
+        init(size: CGSize, lastLineRect: CGRect?) {
+            self.size = size
+            self.lastLineRect = lastLineRect
+        }
+
+//        init(size: CGSize, lastGlyphRect: CGRect?) {
+//            self.size = size
+//            self.lastGlyphRect = lastGlyphRect
+//        }
+
+//        static let empty = { Measurement(size: .zero, lastGlyphRect: nil) }()
+        static let empty = { Measurement(size: .zero, lastLineRect: nil) }()
+
+        // MARK: - Equatable
+
+        public static func == (lhs: Measurement, rhs: Measurement) -> Bool {
+//            lhs.size == rhs.size && lhs.lastGlyphRect == rhs.lastGlyphRect
+            lhs.size == rhs.size && lhs.lastLineRect == rhs.lastLineRect
+        }
+    }
+
+    public static func measureSize(config: Config, maxWidth: CGFloat) -> Measurement {
         guard config.attributedString.length > 0 else {
-            return .zero
+            return .empty
         }
         let attributedString = Label.formatAttributedString(config: config)
 
@@ -179,7 +206,58 @@ public class CVBodyTextLabel: NSObject {
         // this can result in it being freed before we perform measurement.
         // We can work around this by explicitly extending the lifetime of
         // textStorage until measurement is completed.
-        return withExtendedLifetime(textStorage) { layoutManager.usedRect(for: textContainer).size }.ceil
+        return withExtendedLifetime(textStorage) {
+            let glyphRange = layoutManager.glyphRange(for: textContainer)
+//            var lastGlyphRect: CGRect?
+            var lastLineRect: CGRect?
+            if glyphRange.location != NSNotFound,
+               glyphRange.length > 0 {
+                let lastGlyphIndex = glyphRange.length - 1
+                lastLineRect = layoutManager.lineFragmentUsedRect(forGlyphAt: lastGlyphIndex,
+                                                                      effectiveRange: nil,
+                                                                      withoutAdditionalLayout: true)
+                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+
+//                var lastLineRect: CGRect = .zero
+//                lastLineRect = layoutManager.lineFragmentRect(forGlyphAt: lastGlyphIndex,
+//                                                              effectiveRange: nil)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.lineFragmentUsedRect(forGlyphAt: lastGlyphIndex,
+//                                                                  effectiveRange: nil,
+//                                                                  withoutAdditionalLayout: false)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.lineFragmentUsedRect(forGlyphAt: lastGlyphIndex,
+//                                                                  effectiveRange: nil,
+//                                                                  withoutAdditionalLayout: true)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.lineFragmentRect(forGlyphAt: lastGlyphIndex,
+//                                                              effectiveRange: nil)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.lineFragmentRect(forGlyphAt: lastGlyphIndex,
+//                                                              effectiveRange: nil,
+//                                                              withoutAdditionalLayout: false)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.lineFragmentRect(forGlyphAt: lastGlyphIndex,
+//                                                              effectiveRange: nil,
+//                                                              withoutAdditionalLayout: true)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//                lastLineRect = layoutManager.boundingRect(forGlyphRange: NSRange(location: lastGlyphIndex,
+//                                                                                 length: 1),
+//                                                          in: textContainer)
+//                Logger.verbose("---- lastLineRect: \(lastLineRect)")
+//
+//                let lastGlyphRange = NSRange(location: lastGlyphIndex, length: 1)
+//                lastGlyphRect = layoutManager.boundingRect(forGlyphRange: lastGlyphRange,
+//                                                           in: textContainer)
+//                Logger.verbose("---- lastGlyphRect: \(lastGlyphRect)")
+            }
+            let totalUsedRect = layoutManager.usedRect(for: textContainer).size.ceil
+            Logger.verbose("---- totalUsedRect: \(totalUsedRect)")
+
+            let size = layoutManager.usedRect(for: textContainer).size.ceil
+//            return Measurement(size: size, lastGlyphRect: lastGlyphRect)
+            return Measurement(size: size, lastLineRect: lastLineRect)
+        }
     }
 
     // MARK: - Animation
diff --git a/SignalMessaging/Views/ConversationView/CVCellMeasurement.swift b/SignalMessaging/Views/ConversationView/CVCellMeasurement.swift
index 80c762a5b7e..93858268a42 100644
--- a/SignalMessaging/Views/ConversationView/CVCellMeasurement.swift
+++ b/SignalMessaging/Views/ConversationView/CVCellMeasurement.swift
@@ -61,17 +61,29 @@ public struct CVCellMeasurement: Equatable {
             values[key] = value
         }
 
+        public func getValue(key: String) -> CGFloat? {
+            values[key]
+        }
+
         public func setMeasurement(key: String, value: Measurement) {
             owsAssertDebug(measurements[key] == nil)
 
             measurements[key] = value
         }
 
+        public func getMeasurement(key: String) -> Measurement? {
+            measurements[key]
+        }
+
         public func setObject(key: String, value: ObjectType) {
-            owsAssertDebug(measurements[key] == nil)
+            owsAssertDebug(objects[key] == nil)
 
             objects[key] = value
         }
+
+        public func getObject(key: String) -> CVMeasurementObject? {
+            objects[key]
+        }
     }
 
     public func size(key: String) -> CGSize? {
diff --git a/SignalMessaging/Views/ConversationView/CVText.swift b/SignalMessaging/Views/ConversationView/CVText.swift
index fa468e50ad1..cab012cd506 100644
--- a/SignalMessaging/Views/ConversationView/CVText.swift
+++ b/SignalMessaging/Views/ConversationView/CVText.swift
@@ -147,11 +147,15 @@ public struct CVLabelConfig {
         text.stringValue
     }
 
+    public var attributedString: NSAttributedString {
+        text.attributedString
+    }
+
     public var debugDescription: String {
         "CVLabelConfig: \(text.debugDescription)"
     }
 
-    fileprivate var cacheKey: CacheKey {
+    public var cacheKey: CacheKey {
         // textColor doesn't affect measurement.
         "\(text.cacheKey),\(font.fontName),\(font.pointSize),\(numberOfLines),\(lineBreakMode.rawValue),\(textAlignment?.rawValue ?? 0)"
     }
@@ -269,24 +273,25 @@ public class CVText {
 
     // MARK: - CVBodyTextLabel
 
-    private static let bodyTextLabelCache = LRUCache<CacheKey, CGSize>(maxSize: cacheSize)
+    private static let bodyTextLabelCache = LRUCache<CacheKey, CVBodyTextLabel.Measurement>(maxSize: cacheSize)
 
-    public static func measureBodyTextLabel(config: CVBodyTextLabel.Config, maxWidth: CGFloat) -> CGSize {
+    public static func measureBodyTextLabel(config: CVBodyTextLabel.Config, maxWidth: CGFloat) -> CVBodyTextLabel.Measurement {
         let cacheKey = buildCacheKey(configKey: config.cacheKey, maxWidth: maxWidth)
         if cacheMeasurements,
            let result = bodyTextLabelCache.get(key: cacheKey) {
             return result
         }
 
-        let result = CVBodyTextLabel.measureSize(config: config, maxWidth: maxWidth)
-        owsAssertDebug(result.width > 0)
-        owsAssertDebug(result.height > 0)
+        let measurement = CVBodyTextLabel.measureSize(config: config, maxWidth: maxWidth)
+        owsAssertDebug(measurement.size.width > 0)
+        owsAssertDebug(measurement.size.height > 0)
+        owsAssertDebug(measurement.size == measurement.size.ceil)
 
         if cacheMeasurements {
-            bodyTextLabelCache.set(key: cacheKey, value: result.ceil)
+            bodyTextLabelCache.set(key: cacheKey, value: measurement)
         }
 
-        return result.ceil
+        return measurement
     }
 }
 
diff --git a/SignalMessaging/Views/OWSStackView.swift b/SignalMessaging/Views/OWSStackView.swift
index 06865ad21a5..00c65ff893c 100644
--- a/SignalMessaging/Views/OWSStackView.swift
+++ b/SignalMessaging/Views/OWSStackView.swift
@@ -22,6 +22,13 @@ open class OWSStackView: UIStackView {
             self.layoutMargins = layoutMargins
         }
 
+        public func withSpacing(_ spacing: CGFloat) -> Config {
+            Config(axis: self.axis,
+                   alignment: self.alignment,
+                   spacing: spacing,
+                   layoutMargins: self.layoutMargins)
+        }
+
         public var debugDescription: String {
             let components: [String] = [
                 "axis: \(axis)",
