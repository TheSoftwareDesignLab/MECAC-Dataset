diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index 42a496184dd..55a833ad34d 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -140,7 +140,7 @@
 		3402AAA3271D9E180084CBAE /* DirectionalPanGestureRecognizer.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95526271B510400B05242 /* DirectionalPanGestureRecognizer.swift */; };
 		3402AAA6271D9E180084CBAE /* MentionPicker.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9552C271B510400B05242 /* MentionPicker.swift */; };
 		3402AAA7271D9E180084CBAE /* AvatarImageView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95545271B510400B05242 /* AvatarImageView.swift */; };
-		3402AAA8271D9E180084CBAE /* MentionTextView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9552D271B510400B05242 /* MentionTextView.swift */; };
+		3402AAA8271D9E180084CBAE /* BodyRangesTextView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9552D271B510400B05242 /* BodyRangesTextView.swift */; };
 		3402AAA9271D9E180084CBAE /* GradientView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95546271B510400B05242 /* GradientView.swift */; };
 		3402AAAA271D9E180084CBAE /* InputAccessoryViewPlaceholder.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9554F271B510400B05242 /* InputAccessoryViewPlaceholder.swift */; };
 		3402AAAB271D9E180084CBAE /* OWSActionSheets.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9553D271B510400B05242 /* OWSActionSheets.swift */; };
@@ -2785,7 +2785,7 @@
 		34A95528271B510400B05242 /* TextFieldWithPlaceholder.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = TextFieldWithPlaceholder.swift; sourceTree = "<group>"; };
 		34A95529271B510400B05242 /* LinkingTextView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = LinkingTextView.swift; sourceTree = "<group>"; };
 		34A9552C271B510400B05242 /* MentionPicker.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MentionPicker.swift; sourceTree = "<group>"; };
-		34A9552D271B510400B05242 /* MentionTextView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MentionTextView.swift; sourceTree = "<group>"; };
+		34A9552D271B510400B05242 /* BodyRangesTextView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = BodyRangesTextView.swift; sourceTree = "<group>"; };
 		34A9552F271B510400B05242 /* LoopingVideoView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = LoopingVideoView.swift; sourceTree = "<group>"; };
 		34A95530271B510400B05242 /* OWSButton.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = OWSButton.swift; sourceTree = "<group>"; };
 		34A95531271B510400B05242 /* ResizingScrollView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ResizingScrollView.swift; sourceTree = "<group>"; };
@@ -5660,10 +5660,10 @@
 		34A95508271B510400B05242 /* Views */ = {
 			isa = PBXGroup;
 			children = (
+				34A9552A271B510400B05242 /* BodyRanges */,
 				34A95521271B510400B05242 /* ConversationView */,
 				34A95551271B510400B05242 /* ImageEditor */,
 				34A95514271B510400B05242 /* Link Preview */,
-				34A9552A271B510400B05242 /* Mentions */,
 				34A9554A271B510400B05242 /* Tooltips */,
 				34A9551A271B510400B05242 /* VideoEditor */,
 				34A95545271B510400B05242 /* AvatarImageView.swift */,
@@ -5754,16 +5754,16 @@
 			path = ConversationView;
 			sourceTree = "<group>";
 		};
-		34A9552A271B510400B05242 /* Mentions */ = {
+		34A9552A271B510400B05242 /* BodyRanges */ = {
 			isa = PBXGroup;
 			children = (
+				34A9552D271B510400B05242 /* BodyRangesTextView.swift */,
 				66FC637D29E0B00F00F00DAC /* MentionDisplayConfigurations.swift */,
 				34A9552C271B510400B05242 /* MentionPicker.swift */,
-				34A9552D271B510400B05242 /* MentionTextView.swift */,
 				66FC638D29EDABAC00F00DAC /* SearchDisplayConfigurations.swift */,
 				66FC637F29E0B9DA00F00DAC /* SpoilerDisplayConfigurations.swift */,
 			);
-			path = Mentions;
+			path = BodyRanges;
 			sourceTree = "<group>";
 		};
 		34A9554A271B510400B05242 /* Tooltips */ = {
@@ -10754,6 +10754,7 @@
 				88B98700288088B800F8C74D /* BaseMemberViewController.swift in Sources */,
 				760981882936DE90008F8300 /* BezierPathView.swift in Sources */,
 				762EBBD22A2FE370002FD28F /* BlockListUIUtils.swift in Sources */,
+				3402AAA8271D9E180084CBAE /* BodyRangesTextView.swift in Sources */,
 				83B9573927C9A1FA00A678FD /* CaptchaView.swift in Sources */,
 				34A954DE271B4F3E00B05242 /* ChatColors.swift in Sources */,
 				D925F5512983399D00158EE4 /* CircleButton.swift in Sources */,
@@ -10839,7 +10840,6 @@
 				766035A9286CE4CB00F6B71C /* MediaTopBar.swift in Sources */,
 				66FC637E29E0B00F00F00DAC /* MentionDisplayConfigurations.swift in Sources */,
 				3402AAA6271D9E180084CBAE /* MentionPicker.swift in Sources */,
-				3402AAA8271D9E180084CBAE /* MentionTextView.swift in Sources */,
 				3465F4D727287677001663AF /* MobileCoinAPI+Configuration.swift in Sources */,
 				3465F4D927287677001663AF /* MobileCoinAPI.swift in Sources */,
 				34BB78B7272C51B600DA0D04 /* MobileCoinHelperSDK.swift in Sources */,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVItemViewModelImpl.swift b/Signal/src/ViewControllers/ConversationView/CV/CVItemViewModelImpl.swift
index 6d7d45e43e1..6bc1feeb281 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVItemViewModelImpl.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVItemViewModelImpl.swift
@@ -173,7 +173,7 @@ extension CVItemViewModelImpl {
         guard let displayableBodyText = self.displayableBodyText else {
             return
         }
-        MentionTextView.copyAttributedStringToPasteboard(displayableBodyText.fullAttributedText)
+        BodyRangesTextView.copyAttributedStringToPasteboard(displayableBodyText.fullAttributedText)
     }
 
     var canShareMedia: Bool {
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationInputTextView.swift b/Signal/src/ViewControllers/ConversationView/ConversationInputTextView.swift
index e65dc1f29ea..4aeac59a7d8 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationInputTextView.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationInputTextView.swift
@@ -22,7 +22,7 @@ protocol ConversationTextViewToolbarDelegate: AnyObject {
 
 // MARK: -
 
-class ConversationInputTextView: MentionTextView {
+class ConversationInputTextView: BodyRangesTextView {
 
     private lazy var placeholderView = UILabel()
     private var placeholderConstraints: [NSLayoutConstraint]?
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationInputToolbar.swift b/Signal/src/ViewControllers/ConversationView/ConversationInputToolbar.swift
index ed5066f787f..79a2eadd723 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationInputToolbar.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationInputToolbar.swift
@@ -73,7 +73,7 @@ public class ConversationInputToolbar: UIView, LinkPreviewViewDraftDelegate, Quo
         quotedReply: QuotedReplyModel?,
         inputToolbarDelegate: ConversationInputToolbarDelegate,
         inputTextViewDelegate: ConversationInputTextViewDelegate,
-        mentionDelegate: MentionTextViewDelegate
+        mentionDelegate: BodyRangesTextViewDelegate
     ) {
         self.conversationStyle = conversationStyle
         self.spoilerReveal = spoilerReveal
@@ -301,7 +301,7 @@ public class ConversationInputToolbar: UIView, LinkPreviewViewDraftDelegate, Quo
         _ messageDraft: MessageBody?,
         quotedReply: QuotedReplyModel?,
         inputTextViewDelegate: ConversationInputTextViewDelegate,
-        mentionDelegate: MentionTextViewDelegate
+        mentionDelegate: BodyRangesTextViewDelegate
     ) {
         // The input toolbar should *always* be laid out left-to-right, even when using
         // a right-to-left language. The convention for messaging apps is for the send
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Mentions.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Mentions.swift
index 56ec3f44f75..4e5f986a778 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Mentions.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Mentions.swift
@@ -6,30 +6,30 @@
 import SignalServiceKit
 import SignalUI
 
-extension ConversationViewController: MentionTextViewDelegate {
+extension ConversationViewController: BodyRangesTextViewDelegate {
     var supportsMentions: Bool { thread.allowsMentionSend }
 
-    public func textViewDidBeginTypingMention(_ textView: MentionTextView) {}
+    public func textViewDidBeginTypingMention(_ textView: BodyRangesTextView) {}
 
-    public func textViewDidEndTypingMention(_ textView: MentionTextView) {}
+    public func textViewDidEndTypingMention(_ textView: BodyRangesTextView) {}
 
-    public func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView? {
         view
     }
 
-    public func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
         bottomBar
     }
 
-    public func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress] {
+    public func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress] {
         supportsMentions ? thread.recipientAddressesWithSneakyTransaction : []
     }
 
-    public func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration {
+    public func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration {
         return .composing
     }
 
-    public func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle {
+    public func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle {
         return .default
     }
 }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift
index 2ebfaf0533d..3f42c1b9489 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift	
@@ -403,7 +403,7 @@ extension StoryGroupReplyViewController: ContextMenuInteractionDelegate {
                     image: Theme.iconImage(.messageActionCopy, isDarkThemeEnabled: true),
                     handler: { _ in
                         guard let displayableText = item.displayableText else { return }
-                        MentionTextView.copyAttributedStringToPasteboard(displayableText.fullAttributedText)
+                        BodyRangesTextView.copyAttributedStringToPasteboard(displayableText.fullAttributedText)
                     }))
             }
 
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift
index 6e0d8c36b4b..e364bd58472 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
@@ -149,7 +149,7 @@ class StoryReplyInputToolbar: UIView {
         return button
     }()
 
-    private lazy var textView: MentionTextView = {
+    private lazy var textView: BodyRangesTextView = {
         let textView = buildTextView()
         textView.scrollIndicatorInsets = UIEdgeInsets(top: 5, left: 0, bottom: 5, right: 3)
         textView.mentionDelegate = self
@@ -214,8 +214,8 @@ class StoryReplyInputToolbar: UIView {
         return textContainer
     }()
 
-    private func buildTextView() -> MentionTextView {
-        let textView = MentionTextView()
+    private func buildTextView() -> BodyRangesTextView {
+        let textView = BodyRangesTextView()
 
         textView.keyboardAppearance = Theme.darkThemeKeyboardAppearance
         textView.backgroundColor = .clear
@@ -339,29 +339,29 @@ class StoryReplyInputToolbar: UIView {
     }
 }
 
-extension StoryReplyInputToolbar: MentionTextViewDelegate {
+extension StoryReplyInputToolbar: BodyRangesTextViewDelegate {
 
-    func textViewDidBeginTypingMention(_ textView: MentionTextView) {}
+    func textViewDidBeginTypingMention(_ textView: BodyRangesTextView) {}
 
-    func textViewDidEndTypingMention(_ textView: MentionTextView) {}
+    func textViewDidEndTypingMention(_ textView: BodyRangesTextView) {}
 
-    func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView? {
+    func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView? {
         delegate?.storyReplyInputToolbarMentionPickerParentView(self)
     }
 
-    func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView? {
+    func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
         delegate?.storyReplyInputToolbarMentionPickerReferenceView(self)
     }
 
-    func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress] {
+    func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress] {
         delegate?.storyReplyInputToolbarMentionPickerPossibleAddresses(self) ?? []
     }
 
-    public func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration {
+    public func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration {
         return .groupReply
     }
 
-    public func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle {
+    public func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle {
         return .groupReply
     }
 
diff --git a/Signal/translations/en.lproj/Localizable.strings b/Signal/translations/en.lproj/Localizable.strings
index a7768e665df..fd2222abf3b 100644
--- a/Signal/translations/en.lproj/Localizable.strings
+++ b/Signal/translations/en.lproj/Localizable.strings
@@ -7069,6 +7069,33 @@
 /* Tap to Replace Emoji string for reaction configuration */
 "TAP_REPLACE_EMOJI" = "Tap to replace an emoji";
 
+/* Option in selected text edit menu to make text bold */
+"TEXT_MENU_BOLD" = "Bold";
+
+/* Option in selected text edit menu to view text formatting options */
+"TEXT_MENU_FORMAT" = "Format";
+
+/* Option in selected text edit menu to make text italic */
+"TEXT_MENU_ITALIC" = "Italic";
+
+/* Option in selected text edit menu to look up word definitions */
+"TEXT_MENU_LOOK_UP" = "Look Up";
+
+/* Option in selected text edit menu to make text monospace */
+"TEXT_MENU_MONOSPACE" = "Monospace";
+
+/* Option in selected text edit menu to replace text with suggestions */
+"TEXT_MENU_REPLACE" = "Replace";
+
+/* Option in selected text edit menu to share selected text */
+"TEXT_MENU_SHARE" = "Share";
+
+/* Option in selected text edit menu to make text spoiler */
+"TEXT_MENU_SPOILER" = "Spoiler";
+
+/* Option in selected text edit menu to make text strikethrough */
+"TEXT_MENU_STRIKETHROUGH" = "Strikethrough";
+
 /* text indicating the message was remotely deleted */
 "THIS_MESSAGE_WAS_DELETED" = "This message was deleted.";
 
diff --git a/SignalServiceKit/src/Util/FeatureFlags.swift b/SignalServiceKit/src/Util/FeatureFlags.swift
index e8f5b627e8f..5802b06b14e 100644
--- a/SignalServiceKit/src/Util/FeatureFlags.swift
+++ b/SignalServiceKit/src/Util/FeatureFlags.swift
@@ -116,6 +116,8 @@ public class FeatureFlags: BaseFlags {
             logFlag("FeatureFlag", key, value)
         }
     }
+
+    public static let textFormattingSend = build.includes(.dev)
 }
 
 // MARK: -
diff --git a/SignalUI/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift b/SignalUI/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
index 9934ae02c32..4dd8ac03756 100644
--- a/SignalUI/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
+++ b/SignalUI/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
@@ -1250,29 +1250,29 @@ extension AttachmentApprovalViewController {
     }
 }
 
-extension AttachmentApprovalViewController: MentionTextViewDelegate {
+extension AttachmentApprovalViewController: BodyRangesTextViewDelegate {
 
-    public func textViewDidBeginTypingMention(_ textView: MentionTextView) { }
+    public func textViewDidBeginTypingMention(_ textView: BodyRangesTextView) { }
 
-    public func textViewDidEndTypingMention(_ textView: MentionTextView) { }
+    public func textViewDidEndTypingMention(_ textView: BodyRangesTextView) { }
 
-    public func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView? {
         return view
     }
 
-    public func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
         return bottomToolView.attachmentTextToolbar
     }
 
-    public func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress] {
+    public func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress] {
         return approvalDataSource?.attachmentApprovalMentionableAddresses ?? []
     }
 
-    public func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration {
+    public func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration {
         return .composingAttachment
     }
 
-    public func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle {
+    public func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle {
         return .composingAttachment
     }
 }
diff --git a/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextToolbar.swift b/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextToolbar.swift
index ebcdcc6466f..acfbea5806b 100644
--- a/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextToolbar.swift
+++ b/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextToolbar.swift
@@ -26,7 +26,7 @@ class AttachmentTextToolbar: UIView {
     weak var delegate: AttachmentTextToolbarDelegate?
 
     // Forward mention-related calls directly to the view controller.
-    weak var mentionTextViewDelegate: MentionTextViewDelegate?
+    weak var mentionTextViewDelegate: BodyRangesTextViewDelegate?
 
     private var isViewOnceEnabled: Bool = false
     func setIsViewOnce(enabled: Bool, animated: Bool) {
@@ -207,7 +207,7 @@ class AttachmentTextToolbar: UIView {
 
     // MARK: - Subviews
 
-    lazy private(set) var textView: MentionTextView = {
+    lazy private(set) var textView: BodyRangesTextView = {
         let textView = buildTextView()
         textView.returnKeyType = .done
         textView.scrollIndicatorInsets = UIEdgeInsets(top: 5, left: 0, bottom: 5, right: 3)
@@ -297,7 +297,7 @@ class AttachmentTextToolbar: UIView {
         return wrapperView
     }()
 
-    private func buildTextView() -> MentionTextView {
+    private func buildTextView() -> BodyRangesTextView {
         let textView = AttachmentTextView()
         textView.keyboardAppearance = Theme.darkThemeKeyboardAppearance
         textView.backgroundColor = .clear
@@ -325,33 +325,33 @@ extension AttachmentTextToolbar {
     }
 }
 
-extension AttachmentTextToolbar: MentionTextViewDelegate {
+extension AttachmentTextToolbar: BodyRangesTextViewDelegate {
 
-    func textViewDidBeginTypingMention(_ textView: MentionTextView) {
+    func textViewDidBeginTypingMention(_ textView: BodyRangesTextView) {
         mentionTextViewDelegate?.textViewDidBeginTypingMention(textView)
     }
 
-    func textViewDidEndTypingMention(_ textView: MentionTextView) {
+    func textViewDidEndTypingMention(_ textView: BodyRangesTextView) {
         mentionTextViewDelegate?.textViewDidEndTypingMention(textView)
     }
 
-    func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView? {
+    func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView? {
         return mentionTextViewDelegate?.textViewMentionPickerParentView(textView)
     }
 
-    func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView? {
+    func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
         return mentionTextViewDelegate?.textViewMentionPickerReferenceView(textView)
     }
 
-    func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress] {
+    func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress] {
         return mentionTextViewDelegate?.textViewMentionPickerPossibleAddresses(textView) ?? []
     }
 
-    public func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration {
+    public func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration {
         return .composingAttachment
     }
 
-    public func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle {
+    public func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle {
         return .composingAttachment
     }
 }
diff --git a/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextView.swift b/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextView.swift
index 6c096625a27..fc08b2c19fe 100644
--- a/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextView.swift
+++ b/SignalUI/ViewControllers/AttachmentApproval/AttachmentTextView.swift
@@ -6,7 +6,7 @@
 import Foundation
 import UIKit
 
-class AttachmentTextView: MentionTextView {
+class AttachmentTextView: BodyRangesTextView {
 
     private var textIsChanging = false
 
diff --git a/SignalUI/ViewControllers/TextApprovalViewController.swift b/SignalUI/ViewControllers/TextApprovalViewController.swift
index b1ffd4e9dd8..a8aee5287e4 100644
--- a/SignalUI/ViewControllers/TextApprovalViewController.swift
+++ b/SignalUI/ViewControllers/TextApprovalViewController.swift
@@ -20,7 +20,7 @@ public protocol TextApprovalViewControllerDelegate: AnyObject {
 
 // MARK: -
 
-public class TextApprovalViewController: OWSViewController, MentionTextViewDelegate {
+public class TextApprovalViewController: OWSViewController, BodyRangesTextViewDelegate {
 
     public weak var delegate: TextApprovalViewControllerDelegate?
 
@@ -29,7 +29,7 @@ public class TextApprovalViewController: OWSViewController, MentionTextViewDeleg
     private let initialMessageBody: MessageBody
     private let linkPreviewFetcher: LinkPreviewFetcher
 
-    private let textView = MentionTextView()
+    private let textView = BodyRangesTextView()
     private let footerView = ApprovalFooterView()
     private var bottomConstraint: NSLayoutConstraint?
 
@@ -178,27 +178,27 @@ public class TextApprovalViewController: OWSViewController, MentionTextViewDeleg
         updateLinkPreviewText()
     }
 
-    public func textViewDidBeginTypingMention(_ textView: MentionTextView) {}
+    public func textViewDidBeginTypingMention(_ textView: BodyRangesTextView) {}
 
-    public func textViewDidEndTypingMention(_ textView: MentionTextView) {}
+    public func textViewDidEndTypingMention(_ textView: BodyRangesTextView) {}
 
-    public func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView? {
         return nil
     }
 
-    public func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView? {
+    public func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
         return nil
     }
 
-    public func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress] {
+    public func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress] {
         return []
     }
 
-    public func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration {
+    public func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration {
         return .composing
     }
 
-    public func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle {
+    public func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle {
         return .default
     }
 }
diff --git a/SignalUI/Views/Mentions/MentionTextView.swift b/SignalUI/Views/BodyRanges/BodyRangesTextView.swift
similarity index 69%
rename from SignalUI/Views/Mentions/MentionTextView.swift
rename to SignalUI/Views/BodyRanges/BodyRangesTextView.swift
index 28fc10ab16d..72708608bbe 100644
--- a/SignalUI/Views/Mentions/MentionTextView.swift
+++ b/SignalUI/Views/BodyRanges/BodyRangesTextView.swift
@@ -5,21 +5,21 @@
 
 import SignalMessaging
 
-public protocol MentionTextViewDelegate: UITextViewDelegate {
-    func textViewDidBeginTypingMention(_ textView: MentionTextView)
-    func textViewDidEndTypingMention(_ textView: MentionTextView)
+public protocol BodyRangesTextViewDelegate: UITextViewDelegate {
+    func textViewDidBeginTypingMention(_ textView: BodyRangesTextView)
+    func textViewDidEndTypingMention(_ textView: BodyRangesTextView)
 
-    func textViewMentionPickerParentView(_ textView: MentionTextView) -> UIView?
-    func textViewMentionPickerReferenceView(_ textView: MentionTextView) -> UIView?
-    func textViewMentionPickerPossibleAddresses(_ textView: MentionTextView) -> [SignalServiceAddress]
+    func textViewMentionPickerParentView(_ textView: BodyRangesTextView) -> UIView?
+    func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView?
+    func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView) -> [SignalServiceAddress]
 
-    func textViewMentionDisplayConfiguration(_ textView: MentionTextView) -> MentionDisplayConfiguration
-    func mentionPickerStyle(_ textView: MentionTextView) -> MentionPickerStyle
+    func textViewMentionDisplayConfiguration(_ textView: BodyRangesTextView) -> MentionDisplayConfiguration
+    func mentionPickerStyle(_ textView: BodyRangesTextView) -> MentionPickerStyle
 }
 
-open class MentionTextView: OWSTextView {
+open class BodyRangesTextView: OWSTextView {
 
-    public weak var mentionDelegate: MentionTextViewDelegate? {
+    public weak var mentionDelegate: BodyRangesTextViewDelegate? {
         didSet { updateMentionState() }
     }
 
@@ -477,6 +477,222 @@ open class MentionTextView: OWSTextView {
         state = .notTypingMention
     }
 
+    // MARK: - Text Formatting
+
+    // MARK: Menu items
+
+    private let cutUIMenuAction = #selector(cut)
+    private let copyUIMenuAction = #selector(copy)
+    private let pasteUIMenuAction = #selector(UIResponderStandardEditActions.paste(_:))
+
+    private let uiMenuPromptReplaceAction = Selector(("_promptForReplace:"))
+    private let uiMenuReplaceAction = Selector(("replace:"))
+    private let customUIMenuPromptReplaceAction = #selector(customUIMenuPromptReplace)
+    @objc
+    func customUIMenuPromptReplace(_ sender: Any?) { super.perform(uiMenuPromptReplaceAction, with: sender) }
+
+    private let uiMenuLookUpAction = Selector(("_define:"))
+    private let customUIMenuLookUpAction = #selector(customUIMenuLookUp)
+    @objc
+    func customUIMenuLookUp(_ sender: Any?) { super.perform(uiMenuLookUpAction, with: sender) }
+
+    private let uiMenuShareAction = Selector(("_share:"))
+    private let customUIMenuShareAction = #selector(customUIMenuShare)
+    @objc
+    func customUIMenuShare(_ sender: Any?) { super.perform(uiMenuShareAction, with: sender) }
+
+    open override func buildMenu(with builder: UIMenuBuilder) {
+        guard FeatureFlags.textFormattingSend else {
+            super.buildMenu(with: builder)
+            return
+        }
+        if builder.menu(for: .lookup) != nil, selectedRange.length > 0 {
+            // The lookup action is special; for whatever reason it doesn't go
+            // through `canPerformAction` at all, so we have to disable it here
+            // or it will appear before our custom format options.
+            builder.remove(menu: .lookup)
+        }
+        super.buildMenu(with: builder)
+    }
+
+    open override func canPerformAction(_ action: Selector, withSender sender: Any?) -> Bool {
+        // We only mess with actions when there's a selection.
+        guard FeatureFlags.textFormattingSend, selectedRange.length > 0 else {
+            return super.canPerformAction(action, withSender: sender)
+        }
+        // Let our custom style actions through.
+        if action == #selector(didSelectTextFormattingSubmenu) {
+            return selectedRange.length > 0
+        }
+        if MessageBodyRanges.SingleStyle.allCases.lazy
+            .map({ (style: MessageBodyRanges.SingleStyle) -> Selector in
+                return self.uiMenuItemSelector(for: style)
+            })
+            .contains(action) {
+            return isShowingFormatMenu
+        }
+
+        switch action {
+        // Cut, copy, paste are let through as they are first in the list.
+        case cutUIMenuAction, copyUIMenuAction, pasteUIMenuAction:
+            guard !isShowingFormatMenu else {
+                return false
+            }
+            return super.canPerformAction(action, withSender: sender)
+
+        // We want these actions to appear, but _after_ format. To do that, we disable
+        // the system's action and use custom ones of our own that forward to the same selector.
+        case customUIMenuPromptReplaceAction:
+            return super.canPerformAction(uiMenuPromptReplaceAction, withSender: sender)
+        case customUIMenuLookUpAction:
+            return super.canPerformAction(uiMenuLookUpAction, withSender: sender)
+        case customUIMenuShareAction:
+            return super.canPerformAction(uiMenuShareAction, withSender: sender)
+
+        // The second stage of replace (picking the thing to replace with) is allowed.
+        case uiMenuReplaceAction:
+            return super.canPerformAction(action, withSender: sender)
+
+        // All other actions are disallowed.
+        default:
+            return false
+        }
+    }
+
+    // When the user selects text, we show a "format" option in the menu. Tapping
+    // that sets this to true, reloading the menu with styles (bold, italic, etc) and
+    // omitting all other options.
+    // We have to be careful to set this to false again once the menu is dismissed by
+    // any means, so that when it shows again we see cut/copy/paste and "format" again.
+    // There is no one callback for this dismissal, so we have to set it to false all over:
+    // resign first responder, selection changed, text changed, style option tapped, etc.
+    private var isShowingFormatMenu = false {
+        didSet {
+            guard FeatureFlags.textFormattingSend else {
+                return
+            }
+            if oldValue, !isShowingFormatMenu, UIMenuController.shared.isMenuVisible {
+                UIMenuController.shared.hideMenu(from: self)
+            }
+        }
+    }
+
+    open override func resignFirstResponder() -> Bool {
+        isShowingFormatMenu = false
+        return super.resignFirstResponder()
+    }
+
+    fileprivate func updateUIMenuState() {
+        guard FeatureFlags.textFormattingSend else {
+            return
+        }
+        if selectedRange.length > 0 {
+            if isShowingFormatMenu {
+                let orderedStyles: [MessageBodyRanges.SingleStyle] = [
+                    .bold, .italic, .monospace, .strikethrough, .spoiler
+                ]
+                UIMenuController.shared.menuItems = orderedStyles.map { style in
+                    return UIMenuItem(title: style.displayText, action: self.uiMenuItemSelector(for: style))
+                }
+            } else {
+                UIMenuController.shared.menuItems = [
+                    // to get format to show up before system menu items, put our format
+                    // first and then our own replacements for the system ones after.
+                    UIMenuItem(
+                        title: OWSLocalizedString(
+                            "TEXT_MENU_FORMAT",
+                            comment: "Option in selected text edit menu to view text formatting options"
+                        ),
+                        action: #selector(didSelectTextFormattingSubmenu)
+                    ),
+                    UIMenuItem(
+                        title: OWSLocalizedString(
+                            "TEXT_MENU_REPLACE",
+                            comment: "Option in selected text edit menu to replace text with suggestions"
+                        ),
+                        action: #selector(customUIMenuPromptReplace)
+                    ),
+                    UIMenuItem(
+                        title: OWSLocalizedString(
+                            "TEXT_MENU_LOOK_UP",
+                            comment: "Option in selected text edit menu to look up word definitions"
+                        ),
+                        action: #selector(customUIMenuLookUp)
+                    ),
+                    UIMenuItem(
+                        title: OWSLocalizedString(
+                            "TEXT_MENU_SHARE",
+                            comment: "Option in selected text edit menu to share selected text"
+                        ),
+                        action: #selector(customUIMenuShare)
+                    )
+                ]
+            }
+        } else {
+            UIMenuController.shared.menuItems = nil
+        }
+        UIMenuController.shared.update()
+    }
+
+    @objc
+    private func didSelectTextFormattingSubmenu(_ sender: UIMenu) {
+        guard FeatureFlags.textFormattingSend else {
+            return
+        }
+        isShowingFormatMenu = true
+        updateUIMenuState()
+        // No way to set a sub-menu in iOS 13. Have to wait for it to dismiss
+        // and then show it again in the next runloop.
+        DispatchQueue.main.async { [self] in
+            guard let selectedTextRange, isShowingFormatMenu else {
+                return
+            }
+            let selectionRects = selectionRects(for: selectedTextRange)
+            var completeRect = CGRect.null
+            for rect in selectionRects {
+                if completeRect.isNull {
+                    completeRect = rect.rect
+                } else {
+                    completeRect = rect.rect.union(completeRect)
+                }
+            }
+            UIMenuController.shared.showMenu(from: self, rect: completeRect)
+        }
+    }
+
+    private func uiMenuItemSelector(for style: MessageBodyRanges.SingleStyle) -> Selector {
+        switch style {
+        case .bold: return #selector(didSelectBold)
+        case .italic: return #selector(didSelectItalic)
+        case .spoiler: return #selector(didSelectSpoiler)
+        case .strikethrough: return #selector(didSelectStrikethrough)
+        case .monospace: return #selector(didSelectMonospace)
+        }
+    }
+
+    @objc
+    func didSelectBold() { didSelectStyle(.bold) }
+    @objc
+    func didSelectItalic() { didSelectStyle(.italic) }
+    @objc
+    func didSelectSpoiler() { didSelectStyle(.spoiler) }
+    @objc
+    func didSelectStrikethrough() { didSelectStyle(.strikethrough) }
+    @objc
+    func didSelectMonospace() { didSelectStyle(.monospace) }
+
+    private func didSelectStyle(_ style: MessageBodyRanges.SingleStyle) {
+        guard FeatureFlags.textFormattingSend else {
+            return
+        }
+        Logger.info("Applying style: \(style)")
+        isShowingFormatMenu = false
+        guard selectedRange.length > 0 else {
+            return
+        }
+        // TODO[TextFormattingSend]
+    }
+
     // MARK: - Text Container Insets
 
     open var defaultTextContainerInset: UIEdgeInsets {
@@ -509,7 +725,7 @@ open class MentionTextView: OWSTextView {
 
 // MARK: - Picker Keyboard Interaction
 
-extension MentionTextView {
+extension BodyRangesTextView {
     open override var keyCommands: [UIKeyCommand]? {
         guard pickerView != nil else { return nil }
 
@@ -548,7 +764,7 @@ extension MentionTextView {
 
 // MARK: - Cut/Copy/Paste
 
-extension MentionTextView {
+extension BodyRangesTextView {
     open override func cut(_ sender: Any?) {
         copy(sender)
         replaceCharacters(in: selectedRange, with: "")
@@ -607,7 +823,7 @@ extension MentionTextView {
 
 // MARK: - UITextViewDelegate
 
-extension MentionTextView: UITextViewDelegate {
+extension BodyRangesTextView: UITextViewDelegate {
     open func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
         guard shouldUpdateMentionText(in: range, changedText: text) else { return false }
         return mentionDelegate?.textView?(textView, shouldChangeTextIn: range, replacementText: text) ?? true
@@ -616,9 +832,12 @@ extension MentionTextView: UITextViewDelegate {
     open func textViewDidChangeSelection(_ textView: UITextView) {
         mentionDelegate?.textViewDidChangeSelection?(textView)
         updateMentionState()
+        isShowingFormatMenu = false
+        updateUIMenuState()
     }
 
     open func textViewDidChange(_ textView: UITextView) {
+        isShowingFormatMenu = false
         mentionDelegate?.textViewDidChange?(textView)
         if textStorage.length == 0 { updateMentionState() }
     }
@@ -628,6 +847,7 @@ extension MentionTextView: UITextViewDelegate {
     }
 
     open func textViewShouldEndEditing(_ textView: UITextView) -> Bool {
+        isShowingFormatMenu = false
         return mentionDelegate?.textViewShouldEndEditing?(textView) ?? true
     }
 
@@ -647,3 +867,36 @@ extension MentionTextView: UITextViewDelegate {
         return mentionDelegate?.textView?(textView, shouldInteractWith: textAttachment, in: characterRange, interaction: interaction) ?? true
     }
 }
+
+extension MessageBodyRanges.SingleStyle {
+
+    var displayText: String {
+        switch self {
+        case .bold:
+            return OWSLocalizedString(
+                "TEXT_MENU_BOLD",
+                comment: "Option in selected text edit menu to make text bold"
+            )
+        case .italic:
+            return OWSLocalizedString(
+                "TEXT_MENU_ITALIC",
+                comment: "Option in selected text edit menu to make text italic"
+            )
+        case .spoiler:
+            return OWSLocalizedString(
+                "TEXT_MENU_SPOILER",
+                comment: "Option in selected text edit menu to make text spoiler"
+            )
+        case .strikethrough:
+            return OWSLocalizedString(
+                "TEXT_MENU_STRIKETHROUGH",
+                comment: "Option in selected text edit menu to make text strikethrough"
+            )
+        case .monospace:
+            return OWSLocalizedString(
+                "TEXT_MENU_MONOSPACE",
+                comment: "Option in selected text edit menu to make text monospace"
+            )
+        }
+    }
+}
diff --git a/SignalUI/Views/Mentions/Mention.swift b/SignalUI/Views/BodyRanges/Mention.swift
similarity index 100%
rename from SignalUI/Views/Mentions/Mention.swift
rename to SignalUI/Views/BodyRanges/Mention.swift
diff --git a/SignalUI/Views/Mentions/MentionDisplayConfigurations.swift b/SignalUI/Views/BodyRanges/MentionDisplayConfigurations.swift
similarity index 100%
rename from SignalUI/Views/Mentions/MentionDisplayConfigurations.swift
rename to SignalUI/Views/BodyRanges/MentionDisplayConfigurations.swift
diff --git a/SignalUI/Views/Mentions/MentionPicker.swift b/SignalUI/Views/BodyRanges/MentionPicker.swift
similarity index 100%
rename from SignalUI/Views/Mentions/MentionPicker.swift
rename to SignalUI/Views/BodyRanges/MentionPicker.swift
diff --git a/SignalUI/Views/Mentions/SearchDisplayConfigurations.swift b/SignalUI/Views/BodyRanges/SearchDisplayConfigurations.swift
similarity index 100%
rename from SignalUI/Views/Mentions/SearchDisplayConfigurations.swift
rename to SignalUI/Views/BodyRanges/SearchDisplayConfigurations.swift
diff --git a/SignalUI/Views/Mentions/SpoilerDisplayConfigurations.swift b/SignalUI/Views/BodyRanges/SpoilerDisplayConfigurations.swift
similarity index 100%
rename from SignalUI/Views/Mentions/SpoilerDisplayConfigurations.swift
rename to SignalUI/Views/BodyRanges/SpoilerDisplayConfigurations.swift
