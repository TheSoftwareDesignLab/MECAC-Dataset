diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
index df0753028c3..530ecef421e 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
@@ -4584,7 +4584,8 @@ - (CGPoint)collectionView:(UICollectionView *)collectionView
         }
     }
 
-    if (self.scrollContinuity == kScrollContinuityBottom && self.lastKnownDistanceFromBottom) {
+    if (self.scrollContinuity == kScrollContinuityBottom && self.lastKnownDistanceFromBottom
+        && CurrentAppContext().isAppForegroundAndActive) {
         NSValue *_Nullable contentOffset =
             [self contentOffsetForLastKnownDistanceFromBottom:self.lastKnownDistanceFromBottom.floatValue];
         if (contentOffset) {
diff --git a/Signal/src/ViewControllers/DebugUI/DebugUIMessages.m b/Signal/src/ViewControllers/DebugUI/DebugUIMessages.m
index 55fc1e26e56..bd1d90abf7b 100644
--- a/Signal/src/ViewControllers/DebugUI/DebugUIMessages.m
+++ b/Signal/src/ViewControllers/DebugUI/DebugUIMessages.m
@@ -329,6 +329,11 @@ - (void)readWithBlock:(void (^)(SDSAnyReadTransaction *transaction))block
     [self.class readWithBlock:block];
 }
 
++ (id<GroupsV2>)groupsV2
+{
+    return SSKEnvironment.shared.groupsV2;
+}
+
 #pragma mark -
 
 + (void)sendMessages:(NSUInteger)count toAllMembersOfGroup:(TSGroupThread *)groupThread
@@ -3902,16 +3907,37 @@ + (void)injectIncomingMessageInThread:(TSThread *)thread counter:(NSUInteger)cou
     OWSLogInfo(@"injectIncomingMessageInThread: %lu", (unsigned long)counter);
 
     NSString *randomText = [self randomText];
+    randomText = [[randomText stringByAppendingString:randomText] stringByAppendingString:@"\n"];
+    randomText = [[randomText stringByAppendingString:randomText] stringByAppendingString:@"\n"];
+    randomText = [[randomText stringByAppendingString:randomText] stringByAppendingString:@"\n"];
+    randomText = [[randomText stringByAppendingString:randomText] stringByAppendingString:@"\n"];
+    randomText = [[randomText stringByAppendingString:randomText] stringByAppendingString:@"\n"];
     NSString *text = [[[@(counter) description] stringByAppendingString:@" "] stringByAppendingString:randomText];
 
     SSKProtoDataMessageBuilder *dataMessageBuilder = [SSKProtoDataMessage builder];
     [dataMessageBuilder setBody:text];
 
     if ([thread isKindOfClass:[TSGroupThread class]]) {
-        TSGroupThread *groupThread = (TSGroupThread *)thread;
-        SSKProtoGroupContextBuilder *groupBuilder = [SSKProtoGroupContext builderWithId:groupThread.groupModel.groupId];
-        [groupBuilder setType:SSKProtoGroupContextTypeDeliver];
-        [dataMessageBuilder setGroup:groupBuilder.buildIgnoringErrors];
+        if (thread.isGroupV2Thread) {
+            TSGroupThread *groupThread = (TSGroupThread *)thread;
+            TSGroupModelV2 *groupModel = (TSGroupModelV2 *)groupThread.groupModel;
+
+            NSError *error;
+            SSKProtoGroupContextV2 *_Nullable groupContextV2 =
+                [self.groupsV2 buildGroupContextV2ProtoWithGroupModel:groupModel
+                                               changeActionsProtoData:nil
+                                                                error:&error];
+            if (groupContextV2 == nil || error != nil) {
+                OWSFailDebug(@"Error: %@", error);
+            }
+            [dataMessageBuilder setGroupV2:groupContextV2];
+        } else {
+            TSGroupThread *groupThread = (TSGroupThread *)thread;
+            SSKProtoGroupContextBuilder *groupBuilder =
+                [SSKProtoGroupContext builderWithId:groupThread.groupModel.groupId];
+            [groupBuilder setType:SSKProtoGroupContextTypeDeliver];
+            [dataMessageBuilder setGroup:groupBuilder.buildIgnoringErrors];
+        }
     }
 
     SSKProtoContentBuilder *payloadBuilder = [SSKProtoContent builder];
