diff --git a/SignalServiceKit/Cryptography/Cryptography.swift b/SignalServiceKit/Cryptography/Cryptography.swift
index bc6a669c436..4f28a31299b 100644
--- a/SignalServiceKit/Cryptography/Cryptography.swift
+++ b/SignalServiceKit/Cryptography/Cryptography.swift
@@ -280,12 +280,14 @@ public extension Cryptography {
     /// - parameter input: The data to encrypt.
     /// - parameter encryptionKey: The key to encrypt with; the AES key and the hmac key concatenated together.
     ///     (The same format as ``EncryptionMetadata/key``). A random key will be generated if none is provided.
+    /// - parameter applyExtraPadding: If true, extra zero padding will be applied to ensure bucketing of file sizes,
+    ///     in addition to standard PKCS7 padding. If false, only standard PKCS7 padding is applied.
     ///
-    /// - returns: The encrypted data prefixed with the random iv and postfixed with the hmac. The ciphertext
-    /// is padded using standard pkcs7 padding but NOT with any custom padding applied to the plaintext prior to encryption.
+    /// - returns: The encrypted padded data prefixed with the random iv and postfixed with the hmac.
     static func encrypt(
         _ input: Data,
-        encryptionKey inputKey: Data? = nil
+        encryptionKey inputKey: Data? = nil,
+        applyExtraPadding: Bool = false
     ) throws -> (Data, EncryptionMetadata) {
         if let inputKey, inputKey.count != concatenatedEncryptionKeyLength {
             throw OWSAssertionError("Invalid encryption key length")
@@ -307,7 +309,7 @@ public extension Cryptography {
             },
             encryptionKey: encryptionKey,
             hmacKey: hmacKey,
-            applyExtraPadding: false
+            applyExtraPadding: applyExtraPadding
         )
         return (outputData, encryptionMetadata)
     }
diff --git a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
index 19e5f5fa241..244672f62d8 100644
--- a/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
+++ b/SignalServiceKit/Messages/Attachments/V2/ContentValidation/AttachmentContentValidatorImpl.swift
@@ -763,7 +763,8 @@ public class AttachmentContentValidatorImpl: AttachmentContentValidator {
         case .inMemory(let data):
             let (encryptedData, encryptionMetadata) = try Cryptography.encrypt(
                 data,
-                encryptionKey: encryptionKey
+                encryptionKey: encryptionKey,
+                applyExtraPadding: true
             )
             // We'll unwrap the digest again later, but unwrap and fail
             // early so we don't waste time writing bytes to disk.
