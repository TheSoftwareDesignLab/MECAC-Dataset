diff --git a/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift b/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
index d7011ff38d2..44deca035bd 100644
--- a/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
+++ b/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentApprovalViewController.swift
@@ -416,7 +416,10 @@ public class AttachmentApprovalViewController: UIPageViewController, UIPageViewC
             }
         }
 
-        guard let cell = galleryRailView.cellViews.first(where: { $0.item === attachmentApprovalItem }) else {
+        guard let cell = galleryRailView.cellViews.first(where: { cellView in
+            guard let item = cellView.item else { return false }
+            return item.isEqualToGalleryRailItem(attachmentApprovalItem)
+        }) else {
             owsFailDebug("cell was unexpectedly nil")
             return
         }
diff --git a/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentItemCollection.swift b/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentItemCollection.swift
index 47df03f73d9..689798c7c4d 100644
--- a/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentItemCollection.swift
+++ b/SignalMessaging/ViewControllers/AttachmentApproval/AttachmentItemCollection.swift
@@ -21,6 +21,12 @@ class AddMoreRailItem: GalleryRailItem {
     }
 }
 
+extension AddMoreRailItem: Equatable {
+    static func == (lhs: AddMoreRailItem, rhs: AddMoreRailItem) -> Bool {
+        return true
+    }
+}
+
 public class AttachmentApprovalItem: Hashable {
 
     enum AttachmentApprovalItemError: Error {
diff --git a/SignalMessaging/Views/GalleryRailView.swift b/SignalMessaging/Views/GalleryRailView.swift
index 67d5e4bf041..a53a900665a 100644
--- a/SignalMessaging/Views/GalleryRailView.swift
+++ b/SignalMessaging/Views/GalleryRailView.swift
@@ -8,8 +8,18 @@ public protocol GalleryRailItemProvider: class {
     var railItems: [GalleryRailItem] { get }
 }
 
-public protocol GalleryRailItem: class {
+public protocol GalleryRailItem {
     func buildRailItemView() -> UIView
+    func isEqualToGalleryRailItem(_ other: GalleryRailItem?) -> Bool
+}
+
+public extension GalleryRailItem where Self: Equatable {
+    func isEqualToGalleryRailItem(_ other: GalleryRailItem?) -> Bool {
+        guard let other = other as? Self else {
+            return false
+        }
+        return self == other
+    }
 }
 
 protocol GalleryRailCellViewDelegate: class {
@@ -157,7 +167,7 @@ public class GalleryRailView: UIView, GalleryRailCellViewDelegate {
                 return false
             }
             for (index, element) in lhs.enumerated() {
-                guard element === rhs[index] else {
+                guard element.isEqualToGalleryRailItem(rhs[index]) else {
                     return false
                 }
             }
@@ -246,7 +256,7 @@ public class GalleryRailView: UIView, GalleryRailCellViewDelegate {
     func updateFocusedItem(_ focusedItem: GalleryRailItem?) {
         var selectedCellView: GalleryRailCellView?
         cellViews.forEach { cellView in
-            if cellView.item === focusedItem {
+            if let item = cellView.item, item.isEqualToGalleryRailItem(focusedItem) {
                 assert(selectedCellView == nil)
                 selectedCellView = cellView
                 cellView.setIsSelected(true)
