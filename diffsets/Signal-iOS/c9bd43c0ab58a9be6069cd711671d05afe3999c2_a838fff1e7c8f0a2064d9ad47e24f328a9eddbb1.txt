diff --git a/Signal/src/ViewControllers/ConversationView/Cells/QuotedMessageView.swift b/Signal/src/ViewControllers/ConversationView/Cells/QuotedMessageView.swift
index 4d4f9657e3c..8d5ab8d86ab 100644
--- a/Signal/src/ViewControllers/ConversationView/Cells/QuotedMessageView.swift
+++ b/Signal/src/ViewControllers/ConversationView/Cells/QuotedMessageView.swift
@@ -501,7 +501,9 @@ public class QuotedMessageView: ManualStackViewWithLayer {
         let thumbnailView: UIView? = {
             guard configurator.hasQuotedThumbnail else { return nil }
 
-            if let thumbnailView = configurator.quotedReplyModel.thumbnailViewFactory?() { return thumbnailView }
+            if let thumbnailView = configurator.quotedReplyModel.thumbnailViewFactory?(
+                componentDelegate.spoilerState
+            ) { return thumbnailView }
 
             let quotedImageView = self.quotedImageView
             // Use trilinear filters for better scaling quality at
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVComponentDelegate.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVComponentDelegate.swift
index 8338809b201..893ee87195e 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVComponentDelegate.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVComponentDelegate.swift
@@ -277,7 +277,11 @@ extension ConversationViewController: CVComponentDelegate {
                 context = .authorUuid(quotedStory.authorUuid)
             }
 
-            let vc = StoryPageViewController(context: context, loadMessage: quotedStory)
+            let vc = StoryPageViewController(
+                context: context,
+                spoilerState: spoilerState,
+                loadMessage: quotedStory
+            )
             presentFullScreen(vc, animated: true)
         } else {
             scrollToQuotedMessage(quotedReply, isAnimated: true)
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Delegates.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Delegates.swift
index 6b6afe1a9ac..508ddb81464 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Delegates.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Delegates.swift
@@ -246,7 +246,10 @@ extension ConversationViewController: ConversationHeaderViewDelegate {
         AssertIsOnMainThread()
 
         if conversationHeaderView.avatarView.configuration.hasStoriesToDisplay {
-            let vc = StoryPageViewController(context: thread.storyContext)
+            let vc = StoryPageViewController(
+                context: thread.storyContext,
+                spoilerState: spoilerState
+            )
             present(vc, animated: true)
         } else {
             showConversationSettings()
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
index 1b7c89af1c0..aaa41c027e3 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+Misc.swift
@@ -245,7 +245,7 @@ public extension ConversationViewController {
             groupViewHelper!.delegate = self
         }
 
-        let actionSheet = MemberActionSheet(address: address, groupViewHelper: groupViewHelper)
+        let actionSheet = MemberActionSheet(address: address, groupViewHelper: groupViewHelper, spoilerState: spoilerState)
         actionSheet.present(from: self)
     }
 }
diff --git a/Signal/src/ViewControllers/HomeView/HomeTabBarController.swift b/Signal/src/ViewControllers/HomeView/HomeTabBarController.swift
index 28b9bc4a178..1d0e0568059 100644
--- a/Signal/src/ViewControllers/HomeView/HomeTabBarController.swift
+++ b/Signal/src/ViewControllers/HomeView/HomeTabBarController.swift
@@ -22,7 +22,8 @@ class HomeTabBarController: UITabBarController {
         selectedImage: UIImage(named: "tab-chats")
     )
 
-    lazy var storiesViewController = StoriesViewController()
+    // No need to share spoiler render state across the whole app.
+    lazy var storiesViewController = StoriesViewController(spoilerState: SpoilerRenderState())
     lazy var storiesNavController = OWSNavigationController(rootViewController: storiesViewController)
     lazy var storiesTabBarItem = UITabBarItem(
         title: OWSLocalizedString("STORIES_TITLE", comment: "Title for the stories view."),
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryContextViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryContextViewController.swift
index 0167d5286b1..e42ffb12775 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryContextViewController.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryContextViewController.swift	
@@ -32,6 +32,8 @@ class StoryContextViewController: OWSViewController {
 
     weak var delegate: StoryContextViewControllerDelegate?
 
+    private let spoilerState: SpoilerRenderState
+
     private lazy var playbackProgressView = StoryPlaybackProgressView()
 
     private var items = [StoryItem]()
@@ -48,6 +50,9 @@ class StoryContextViewController: OWSViewController {
             {
                 pauseCurrentMediaItem(hideChrome: pauseAndHideChromeWhenMediaViewIsCreated)
             }
+
+            oldValue?.setIsViewVisible(false)
+            currentItemMediaView?.setIsViewVisible(true)
         }
     }
 
@@ -76,8 +81,14 @@ class StoryContextViewController: OWSViewController {
 
     private(set) lazy var contextMenuGenerator = StoryContextMenuGenerator(presentingController: self, delegate: self)
 
-    required init(context: StoryContext, loadPositionIfRead: LoadPosition = .default, delegate: StoryContextViewControllerDelegate) {
+    required init(
+        context: StoryContext,
+        loadPositionIfRead: LoadPosition = .default,
+        spoilerState: SpoilerRenderState,
+        delegate: StoryContextViewControllerDelegate
+    ) {
         self.context = context
+        self.spoilerState = spoilerState
         self.loadPositionIfRead = loadPositionIfRead
         super.init()
         self.delegate = delegate
@@ -94,7 +105,7 @@ class StoryContextViewController: OWSViewController {
         if let currentItemMediaView = currentItemMediaView {
             pauseAndHideChromeWhenMediaViewIsCreated = nil
             // Restart playback for the current item
-            currentItemMediaView.reset()
+            currentItemMediaView.resetPlayback()
             updateProgressState()
         } else {
             // If a specific message was specified to load to, present that first.
@@ -349,7 +360,7 @@ class StoryContextViewController: OWSViewController {
     private func currentItemWasUpdated(messageDidChange: Bool) {
         if let currentItem = currentItem {
             if currentItemMediaView == nil {
-                let itemView = StoryItemMediaView(item: currentItem, delegate: self)
+                let itemView = StoryItemMediaView(item: currentItem, spoilerState: spoilerState, delegate: self)
                 self.currentItemMediaView = itemView
                 mediaViewContainer.addSubview(itemView)
                 itemView.autoPinEdgesToSuperviewEdges()
@@ -869,13 +880,20 @@ extension StoryContextViewController: UIGestureRecognizerDelegate {
         case .groupId:
             switch currentItem.message.direction {
             case .outgoing:
-                let groupRepliesAndViewsVC = StoryGroupRepliesAndViewsSheet(storyMessage: currentItem.message, context: context)
+                let groupRepliesAndViewsVC = StoryGroupRepliesAndViewsSheet(
+                    storyMessage: currentItem.message,
+                    context: context,
+                    spoilerState: spoilerState
+                )
                 groupRepliesAndViewsVC.dismissHandler = { [weak self] in self?.play() }
                 groupRepliesAndViewsVC.focusedTab = currentItem.numberOfReplies > 0 ? .replies : .views
                 self.pause()
                 self.present(groupRepliesAndViewsVC, animated: true)
             case .incoming:
-                let groupReplyVC = StoryGroupReplySheet(storyMessage: currentItem.message)
+                let groupReplyVC = StoryGroupReplySheet(
+                    storyMessage: currentItem.message,
+                    spoilerState: spoilerState
+                )
                 groupReplyVC.dismissHandler = { [weak self] in self?.play() }
                 self.pause()
                 self.present(groupReplyVC, animated: true)
@@ -885,7 +903,7 @@ extension StoryContextViewController: UIGestureRecognizerDelegate {
                 !currentItem.message.authorAddress.isSystemStoryAddress,
                 "Should be impossible to reply to system stories"
             )
-            let directReplyVC = StoryDirectReplySheet(storyMessage: currentItem.message)
+            let directReplyVC = StoryDirectReplySheet(storyMessage: currentItem.message, spoilerState: spoilerState)
             directReplyVC.dismissHandler = { [weak self] in self?.play() }
             self.pause()
             self.present(directReplyVC, animated: true)
@@ -902,7 +920,7 @@ extension StoryContextViewController: UIGestureRecognizerDelegate {
     func presentInfoSheet() {
         guard let currentItem = currentItem else { return }
 
-        let vc = StoryInfoSheet(storyMessage: currentItem.message, context: context)
+        let vc = StoryInfoSheet(storyMessage: currentItem.message, context: context, spoilerState: spoilerState)
         vc.dismissHandler = { [weak self] in self?.play() }
         pause()
         present(vc, animated: true)
@@ -1036,6 +1054,7 @@ extension StoryContextViewController: StoryItemMediaViewDelegate {
                         for: item.message,
                         in: self.context.thread(transaction: $0),
                         attachment: attachment,
+                        spoilerState: self.spoilerState,
                         sourceView: { return contextMenuButton },
                         transaction: $0
                     ))
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryItemMediaView.swift b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryItemMediaView.swift
index 63d8543e395..9d15a96b77e 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryItemMediaView.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryItemMediaView.swift	
@@ -26,15 +26,20 @@ class StoryItemMediaView: UIView {
     weak var delegate: StoryItemMediaViewDelegate?
     public private(set) var item: StoryItem
 
-    private var revealedSpoilerIds = Set<StyleIdType>()
+    private let spoilerState: SpoilerRenderState
 
     private lazy var gradientProtectionView = GradientView(colors: [])
     private var gradientProtectionViewHeightConstraint: NSLayoutConstraint?
 
     private let bottomContentVStack = UIStackView()
 
-    init(item: StoryItem, delegate: StoryItemMediaViewDelegate) {
+    init(
+        item: StoryItem,
+        spoilerState: SpoilerRenderState,
+        delegate: StoryItemMediaViewDelegate
+    ) {
         self.item = item
+        self.spoilerState = spoilerState
         self.delegate = delegate
 
         super.init(frame: .zero)
@@ -80,7 +85,7 @@ class StoryItemMediaView: UIView {
         fatalError("init(coder:) has not been implemented")
     }
 
-    func reset() {
+    func resetPlayback() {
         videoPlayerLoopCount = 0
         videoPlayer?.seek(to: .zero)
         videoPlayer?.play()
@@ -148,6 +153,18 @@ class StoryItemMediaView: UIView {
         return false
     }
 
+    // MARK: - Appearance
+
+    private var isViewVisible = false {
+        didSet {
+            captionLabel.isViewVisible = isViewVisible
+        }
+    }
+
+    func setIsViewVisible(_ isVisible: Bool) {
+        self.isViewVisible = isVisible
+    }
+
     // MARK: - Playback
 
     func pause(hideChrome: Bool = false, animateAlongside: (() -> Void)? = nil) {
@@ -442,63 +459,164 @@ class StoryItemMediaView: UIView {
 
     // MARK: - Caption
 
-    private lazy var captionLabel: UILabel = {
-        let label = UILabel()
-        label.font = .systemFont(ofSize: 17)
-        label.adjustsFontSizeToFitWidth = true
-        label.minimumScaleFactor = 15/17
-        label.textColor = Theme.darkThemePrimaryColor
+    private class CaptionLabel: UILabel {
 
-        label.layer.shadowRadius = 48
-        label.layer.shadowOpacity = 0.8
-        label.layer.shadowColor = UIColor.black.cgColor
-        label.layer.shadowOffset = .zero
+        static let desiredFont = UIFont.systemFont(ofSize: 17)
+        static let minimumScaleFactor: CGFloat = 15/17
 
-        return label
-    }()
+        static var minimumScaleFont: UIFont { desiredFont.withSize(desiredFont.pointSize * minimumScaleFactor) }
 
-    private var fullCaptionText: NSAttributedString?
-    private var truncatedCaptionText: NSAttributedString?
-    private var isCaptionTruncated: Bool { truncatedCaptionText != nil }
-    private var hasCaption: Bool { fullCaptionText != nil }
-    private var tappableCaptionItems: [HydratedMessageBody.TappableItem]?
+        static let maxCollapsedLines = 5
 
-    private var maxCaptionLines = 5
-    private func updateCaption() {
-        let captionText: NSAttributedString? = { () -> NSAttributedString? in
-            let body: StyleOnlyMessageBody
-            switch item.attachment {
-            case let .stream(attachment, captionStyles):
-                guard let text = attachment.caption?.nilIfEmpty else {
-                    return nil
-                }
-                body = StyleOnlyMessageBody(text: text, collapsedStyles: captionStyles)
-            case let .pointer(attachment, captionStyles):
-                guard let text = attachment.caption?.nilIfEmpty else {
-                    return nil
-                }
-                body = StyleOnlyMessageBody(text: text, collapsedStyles: captionStyles)
-            case .text:
-                return nil
+        public var interactionIdentifier: InteractionSnapshotIdentifier
+        private let spoilerState: SpoilerRenderState
+
+        init(
+            interactionIdentifier: InteractionSnapshotIdentifier,
+            spoilerState: SpoilerRenderState
+        ) {
+            self.interactionIdentifier = interactionIdentifier
+            self.spoilerState = spoilerState
+            self.spoilerConfig = .init(isViewVisible: false)
+            super.init(frame: .zero)
+            spoilerConfig.animator = spoilerState.animator
+
+            super.textColor = Theme.darkThemePrimaryColor
+
+            super.layer.shadowRadius = 48
+            super.layer.shadowOpacity = 0.8
+            super.layer.shadowColor = UIColor.black.cgColor
+            super.layer.shadowOffset = .zero
+        }
+
+        required init?(coder: NSCoder) {
+            fatalError("init(coder:) has not been implemented")
+        }
+
+        private var spoilerConfig: SpoilerableTextConfig.Builder {
+            didSet {
+                spoilerAnimator.updateAnimationState(spoilerConfig)
             }
-            self.tappableCaptionItems = body.asHydratedMessageBody().tappableItems(
-                revealedSpoilerIds: self.revealedSpoilerIds,
+        }
+
+        private lazy var spoilerAnimator = SpoilerableLabelAnimator(label: self)
+
+        var isViewVisible: Bool = false {
+            didSet {
+                spoilerConfig.isViewVisible = isViewVisible
+            }
+        }
+
+        func stopAnimatingSpoiler() {
+            spoilerConfig.isViewVisible = false
+        }
+
+        func resumeAnimatingSpoiler() {
+            spoilerConfig.isViewVisible = isViewVisible
+        }
+
+        @available(*, unavailable)
+        override var text: String? {
+            get { return super.text }
+            set { super.text = newValue }
+        }
+
+        @available(*, unavailable)
+        override var attributedText: NSAttributedString? {
+            get { return super.attributedText }
+            set { super.attributedText = newValue }
+        }
+
+        @available(*, unavailable)
+        override var font: UIFont! {
+            get { return super.font }
+            set { super.font = newValue }
+        }
+
+        var isTruncated: Bool = false
+
+        var tappableItems = [HydratedMessageBody.TappableItem]()
+
+        public func setBody(_ body: StyleOnlyMessageBody?, isTruncated: Bool) {
+            guard let body else {
+                super.attributedText = nil
+                spoilerConfig.text = nil
+                spoilerConfig.displayConfig = nil
+                return
+            }
+
+            let actualFont: UIFont
+            if isTruncated {
+                actualFont = Self.minimumScaleFont
+                super.numberOfLines = Self.maxCollapsedLines
+            } else {
+                let actualFontSize = self.actualFontSize(body: body)
+                actualFont = Self.desiredFont.withSize(actualFontSize)
+                super.numberOfLines = 0
+            }
+            super.font = actualFont
+
+            let hydratedBody = body.asHydratedMessageBody()
+            spoilerConfig.text = .messageBody(hydratedBody)
+
+            let revealedSpoilerIds = self.spoilerState.revealState.revealedSpoilerIds(
+                interactionIdentifier: interactionIdentifier
+            )
+            let config = HydratedMessageBody.DisplayConfiguration.storyCaption(
+                font: actualFont,
+                revealedSpoilerIds: revealedSpoilerIds
+            )
+            self.tappableItems = hydratedBody.tappableItems(
+                revealedSpoilerIds: revealedSpoilerIds,
                 dataDetector: nil
             )
-            return body.asAttributedStringForDisplay(
-                config: StyleDisplayConfiguration(
-                    baseFont: captionLabel.font,
-                    textColor: .fixed(captionLabel.textColor),
-                    revealAllIds: false,
-                    revealedIds: self.revealedSpoilerIds
-                ),
+            spoilerConfig.text = .messageBody(hydratedBody)
+            spoilerConfig.displayConfig = config
+            super.attributedText = body.asAttributedStringForDisplay(
+                config: config.style,
+                baseFont: config.baseFont,
+                baseTextColor: config.baseTextColor.forCurrentTheme,
                 isDarkThemeEnabled: Theme.isDarkThemeEnabled
             )
-        }()
 
-        fullCaptionText = captionText
-        captionLabel.attributedText = captionText
-        updateCaptionTruncation()
+        }
+
+        private func actualFontSize(body: StyleOnlyMessageBody) -> CGFloat {
+            let drawingContext = NSStringDrawingContext()
+            drawingContext.minimumScaleFactor = Self.minimumScaleFactor
+            let attributedTextForSizing = body.asAttributedStringForDisplay(
+                config: HydratedMessageBody.DisplayConfiguration.storyCaption(
+                    font: Self.desiredFont,
+                    revealedSpoilerIds: Set() // irrelevant for sizing.
+                ).style,
+                isDarkThemeEnabled: false // irrelevant for sizing.
+            )
+            attributedTextForSizing.boundingRect(
+                with: bounds.size,
+                options: [.usesLineFragmentOrigin, .usesFontLeading],
+                context: drawingContext
+            )
+            return Self.desiredFont.pointSize * drawingContext.actualScaleFactor
+        }
+    }
+
+    private lazy var captionLabel = CaptionLabel(
+        interactionIdentifier: .fromStoryMessage(item.message),
+        spoilerState: spoilerState
+    )
+
+    private var truncatedCaptionText: StyleOnlyMessageBody?
+    private var isTruncationRequired: Bool { truncatedCaptionText != nil }
+    private var hasCaption: Bool { item.caption != nil }
+
+    private func updateCaption() {
+        captionLabel.interactionIdentifier = .fromStoryMessage(item.message)
+        recomputeCaptionTruncation()
+        if !isCaptionExpanded, let truncatedCaptionText {
+            captionLabel.setBody(truncatedCaptionText, isTruncated: true)
+        } else {
+            captionLabel.setBody(item.caption, isTruncated: false)
+        }
     }
 
     private func revealSpoilerIfNecessary(_ gesture: UIGestureRecognizer) -> Bool {
@@ -509,7 +627,7 @@ class StoryItemMediaView: UIView {
         else {
             return false
         }
-        let spoilerItem = tappableCaptionItems?.lazy
+        let spoilerItem = captionLabel.tappableItems.lazy
             .compactMap {
                 switch $0 {
                 case .unrevealedSpoiler(let unrevealedSpoiler):
@@ -522,7 +640,10 @@ class StoryItemMediaView: UIView {
                 $0.range.contains(tapIndex)
             })
         if let spoilerItem {
-            revealedSpoilerIds.insert(spoilerItem.id)
+            spoilerState.revealState.setSpoilerRevealed(
+                withID: spoilerItem.id,
+                interactionIdentifier: .fromStoryMessage(item.message)
+            )
             updateCaption()
             return true
         }
@@ -532,7 +653,7 @@ class StoryItemMediaView: UIView {
     private var isCaptionExpanded = false
     private var captionBackdrop: UIView?
     private func toggleCaptionExpansionIfNecessary(_ gesture: UIGestureRecognizer) -> Bool {
-        guard hasCaption, isCaptionTruncated else { return false }
+        guard hasCaption, isTruncationRequired else { return false }
 
         if !isCaptionExpanded {
             guard captionLabel.bounds.contains(gesture.location(in: captionLabel)) else { return false }
@@ -554,16 +675,15 @@ class StoryItemMediaView: UIView {
             insertSubview(captionBackdrop, belowSubview: bottomContentVStack)
             captionBackdrop.autoPinEdgesToSuperviewEdges()
 
-            captionLabel.numberOfLines = 0
-            captionLabel.attributedText = fullCaptionText
             delegate?.storyItemMediaViewWantsToPause(self)
         } else {
-            captionLabel.numberOfLines = maxCaptionLines
-            captionLabel.attributedText = truncatedCaptionText
             delegate?.storyItemMediaViewWantsToPlay(self)
-            updateCaptionTruncation()
         }
 
+        updateCaption()
+
+        // Hide spoilers for the animation's duration.
+        captionLabel.stopAnimatingSpoiler()
         UIView.animate(withDuration: 0.2) {
             self.captionBackdrop?.alpha = isExpanding ? 1 : 0
             self.captionLabel.layoutIfNeeded()
@@ -572,89 +692,105 @@ class StoryItemMediaView: UIView {
                 self.captionBackdrop?.removeFromSuperview()
                 self.captionBackdrop = nil
             }
+            self.captionLabel.resumeAnimatingSpoiler()
         }
 
         return true
     }
 
     private var lastTruncationWidth: CGFloat?
-    private func updateCaptionTruncation() {
-        guard let fullCaptionText = fullCaptionText, !isCaptionExpanded else { return }
 
+    private func recomputeCaptionTruncation() {
+        guard let body = item.caption else {
+            lastTruncationWidth = nil
+            truncatedCaptionText = nil
+            return
+        }
         // Only update truncation if the view's width has changed.
         guard width != lastTruncationWidth else { return }
         lastTruncationWidth = width
 
-        captionLabel.numberOfLines = maxCaptionLines
-        captionLabel.attributedText = fullCaptionText
         bottomContentVStack.layoutIfNeeded()
 
-        let labelMinimumScaledFont = captionLabel.font
-            .withSize(captionLabel.font.pointSize * captionLabel.minimumScaleFactor)
+        self.truncatedCaptionText = Self.truncatedCaptionText(
+            fullCaptionBody: body,
+            labelSize: CGSize(width: captionLabel.bounds.width, height: .infinity)
+        )
+    }
+
+    /// Nil means no truncation is necessary.
+    private static func truncatedCaptionText(
+        fullCaptionBody: StyleOnlyMessageBody,
+        labelSize: CGSize
+    ) -> StyleOnlyMessageBody? {
+        let labelMinimumScaledFont = CaptionLabel.minimumScaleFont
 
         let layoutManager = NSLayoutManager()
-        let textContainer = NSTextContainer(size: captionLabel.bounds.size)
+        let textContainer = NSTextContainer(size: labelSize)
         let textStorage = NSTextStorage()
 
         layoutManager.addTextContainer(textContainer)
         textStorage.addLayoutManager(layoutManager)
-        textStorage.setAttributedString(fullCaptionText.styled(with: .font(labelMinimumScaledFont)))
+        let displayConfigForSizing = HydratedMessageBody.DisplayConfiguration.storyCaption(
+            font: labelMinimumScaledFont,
+            revealedSpoilerIds: Set() // irrelevant for sizing
+        )
+        let fullCaptionText = fullCaptionBody.asAttributedStringForDisplay(
+            config: displayConfigForSizing.style,
+            isDarkThemeEnabled: false // irrelevant for sizing
+        )
+        textStorage.setAttributedString(fullCaptionText)
 
         textContainer.lineFragmentPadding = 0
         textContainer.lineBreakMode = .byWordWrapping
-        textContainer.maximumNumberOfLines = 5
+        textContainer.maximumNumberOfLines = CaptionLabel.maxCollapsedLines
 
         func visibleCaptionRange() -> NSRange {
-            layoutManager.glyphRange(for: textContainer)
+            layoutManager.characterRange(forGlyphRange: layoutManager.glyphRange(for: textContainer), actualGlyphRange: nil)
         }
 
         var visibleCharacterRangeUpperBound = visibleCaptionRange().upperBound
 
         // Check if we're displaying less than the full length of the caption text.
-        guard visibleCharacterRangeUpperBound < fullCaptionText.string.utf16.count else {
-            truncatedCaptionText = nil
-            return
+        guard visibleCharacterRangeUpperBound < (fullCaptionText.string as NSString).length else {
+            return nil
         }
 
-        let readMoreText = OWSLocalizedString(
+        let readMoreString = OWSLocalizedString(
             "STORIES_CAPTION_READ_MORE",
             comment: "Text indication a story caption can be tapped to read more."
-        ).styled(with: .font(labelMinimumScaledFont.semibold()))
+        )
+        let readMoreBody = StyleOnlyMessageBody(text: readMoreString, style: .bold)
+        let suffix = StyleOnlyMessageBody(plaintext: "… ").addingSuffix(readMoreBody)
 
-        var potentialTruncatedCaptionText = fullCaptionText
+        var potentialTruncatedCaptionBody = fullCaptionBody
         func truncatePotentialCaptionText(to index: Int) {
-            potentialTruncatedCaptionText = potentialTruncatedCaptionText.attributedSubstring(from: NSRange(location: 0, length: index))
-            textStorage.setAttributedString(buildTruncatedCaptionText().styled(with: .font(labelMinimumScaledFont)))
-        }
-
-        func buildTruncatedCaptionText() -> NSAttributedString {
-            .composed(of: [
-                potentialTruncatedCaptionText.ows_stripped(), "…", " ", readMoreText
-            ])
+            potentialTruncatedCaptionBody = potentialTruncatedCaptionBody.stripAndDropLast(
+                potentialTruncatedCaptionBody.length - index
+            )
         }
 
-        defer {
-            truncatedCaptionText = buildTruncatedCaptionText()
-            captionLabel.attributedText = truncatedCaptionText
+        func buildTruncatedCaptionText() -> StyleOnlyMessageBody {
+            return potentialTruncatedCaptionBody.stripAndDropLast(0).addingSuffix(suffix)
         }
 
         // We might fit without further truncation, for example if the caption
         // contains new line characters, so set the possible new text immediately.
         truncatePotentialCaptionText(to: visibleCharacterRangeUpperBound)
 
-        visibleCharacterRangeUpperBound = visibleCaptionRange().upperBound - readMoreText.string.utf16.count - 2
+        visibleCharacterRangeUpperBound = visibleCaptionRange().upperBound - suffix.length
 
         // If we're still truncated, trim down the visible text until
         // we have space to fit the read more text without truncation.
         // This should only take a few iterations.
         var iterationCount = 0
-        while visibleCharacterRangeUpperBound < potentialTruncatedCaptionText.string.utf16.count {
+        while visibleCharacterRangeUpperBound < potentialTruncatedCaptionBody.length {
             let truncateToIndex = max(0, visibleCharacterRangeUpperBound)
             guard truncateToIndex > 0 else { break }
 
             truncatePotentialCaptionText(to: truncateToIndex)
 
-            visibleCharacterRangeUpperBound = visibleCaptionRange().upperBound - readMoreText.string.utf16.count - 2
+            visibleCharacterRangeUpperBound = visibleCaptionRange().upperBound - suffix.length
 
             iterationCount += 1
             if iterationCount >= 5 {
@@ -662,6 +798,8 @@ class StoryItemMediaView: UIView {
                 break
             }
         }
+
+        return buildTruncatedCaptionText()
     }
 
     private func updateGradientProtection() {
@@ -684,7 +822,7 @@ class StoryItemMediaView: UIView {
 
     override func layoutSubviews() {
         super.layoutSubviews()
-        updateCaptionTruncation()
+        updateCaption()
     }
 
     // MARK: - Media
@@ -753,7 +891,11 @@ class StoryItemMediaView: UIView {
 
             return container
         case .text(let text):
-            return TextAttachmentView(attachment: text)
+            return TextAttachmentView(
+                attachment: text,
+                interactionIdentifier: .fromStoryMessage(item.message),
+                spoilerState: spoilerState
+            )
         }
     }
 
@@ -885,6 +1027,23 @@ class StoryItem: NSObject {
         self.numberOfReplies = numberOfReplies
         self.attachment = attachment
     }
+
+    var caption: StyleOnlyMessageBody? {
+        switch attachment {
+        case let .stream(attachment, captionStyles):
+            guard let text = attachment.caption?.nilIfEmpty else {
+                return nil
+            }
+            return StyleOnlyMessageBody(text: text, collapsedStyles: captionStyles)
+        case let .pointer(attachment, captionStyles):
+            guard let text = attachment.caption?.nilIfEmpty else {
+                return nil
+            }
+            return StyleOnlyMessageBody(text: text, collapsedStyles: captionStyles)
+        case .text:
+            return nil
+        }
+    }
 }
 
 extension StoryItem {
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryPageViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryPageViewController.swift
index 472b5afaa2b..15f4a7d6aca 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryPageViewController.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Context View/StoryPageViewController.swift	
@@ -17,10 +17,16 @@ class StoryPageViewController: UIPageViewController {
 
     // MARK: - State
 
+    private let spoilerState: SpoilerRenderState
+
     var currentContext: StoryContext {
         get { currentContextViewController.context }
         set {
-            setViewControllers([StoryContextViewController(context: newValue, delegate: self)], direction: .forward, animated: false)
+            setViewControllers(
+                [StoryContextViewController(context: newValue, spoilerState: spoilerState, delegate: self)],
+                direction: .forward,
+                animated: false
+            )
         }
     }
     let onlyRenderMyStories: Bool
@@ -57,12 +63,14 @@ class StoryPageViewController: UIPageViewController {
 
     required init(
         context: StoryContext,
+        spoilerState: SpoilerRenderState,
         viewableContexts: [StoryContext]? = nil,
         hiddenStoryFilter: Bool? = nil, /* If true only hidden stories, if false only unhidden. */
         loadMessage: StoryMessage? = nil,
         action: StoryContextViewController.Action = .none,
         onlyRenderMyStories: Bool = false
     ) {
+        self.spoilerState = spoilerState
         self.onlyRenderMyStories = onlyRenderMyStories
         self.viewableContexts = viewableContexts ?? [context]
         self.hiddenStoryFilter = hiddenStoryFilter
@@ -340,12 +348,12 @@ extension StoryPageViewController: UIPageViewControllerDelegate {
 extension StoryPageViewController: UIPageViewControllerDataSource {
     func pageViewController(_ pageViewController: UIPageViewController, viewControllerBefore viewController: UIViewController) -> UIViewController? {
         guard let contextBefore = previousStoryContext else { return nil }
-        return StoryContextViewController(context: contextBefore, delegate: self)
+        return StoryContextViewController(context: contextBefore, spoilerState: spoilerState, delegate: self)
     }
 
     func pageViewController(_ pageViewController: UIPageViewController, viewControllerAfter viewController: UIViewController) -> UIViewController? {
         guard let contextAfter = nextStoryContext else { return nil }
-        return StoryContextViewController(context: contextAfter, delegate: self)
+        return StoryContextViewController(context: contextAfter, spoilerState: spoilerState, delegate: self)
     }
 }
 
@@ -387,7 +395,12 @@ extension StoryPageViewController: StoryContextViewControllerDelegate {
             dismiss(animated: true)
             return
         }
-        let newControllers = [StoryContextViewController(context: nextContext, loadPositionIfRead: loadPositionIfRead, delegate: self)]
+        let newControllers = [StoryContextViewController(
+            context: nextContext,
+            loadPositionIfRead: loadPositionIfRead,
+            spoilerState: spoilerState,
+            delegate: self
+        )]
         self.willTransition(to: newControllers, fromDrag: false)
         setViewControllers(
             newControllers,
@@ -406,7 +419,12 @@ extension StoryPageViewController: StoryContextViewControllerDelegate {
             storyContextViewController.resetForPresentation()
             return
         }
-        let newControllers = [StoryContextViewController(context: previousContext, loadPositionIfRead: loadPositionIfRead, delegate: self)]
+        let newControllers = [StoryContextViewController(
+            context: previousContext,
+            loadPositionIfRead: loadPositionIfRead,
+            spoilerState: spoilerState,
+            delegate: self
+        )]
         self.willTransition(to: newControllers, fromDrag: false)
         setViewControllers(
             newControllers,
@@ -592,7 +610,11 @@ extension StoryPageViewController: UIViewControllerTransitioningDelegate {
                 blurHashImageView.autoPinEdgesToSuperviewEdges()
             }
         case .text(let attachment):
-            storyView = TextAttachmentView(attachment: attachment).asThumbnailView()
+            storyView = TextAttachmentView(
+                attachment: attachment,
+                interactionIdentifier: .fromStoryMessage(presentingMessage),
+                spoilerState: spoilerState
+            ).asThumbnailView()
         }
 
         storyView.clipsToBounds = true
diff --git a/Signal/src/ViewControllers/HomeView/Stories/MyStoriesViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/MyStoriesViewController.swift
index 4d9d64222a7..7f2147523b5 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/MyStoriesViewController.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/MyStoriesViewController.swift
@@ -30,7 +30,10 @@ class MyStoriesViewController: OWSViewController {
 
     private lazy var contextMenuGenerator = StoryContextMenuGenerator(presentingController: self)
 
-    override init() {
+    private let spoilerState: SpoilerRenderState
+
+    public init(spoilerState: SpoilerRenderState) {
+        self.spoilerState = spoilerState
         super.init()
         hidesBottomBarWhenPushed = true
         databaseStorage.appendDatabaseChangeDelegate(self)
@@ -149,6 +152,7 @@ extension MyStoriesViewController: UITableViewDelegate {
 
         let vc = StoryPageViewController(
             context: thread.storyContext,
+            spoilerState: spoilerState,
             viewableContexts: items.orderedKeys.compactMap { items[$0]?.first?.thread.storyContext },
             loadMessage: item.message,
             onlyRenderMyStories: true
@@ -194,6 +198,7 @@ extension MyStoriesViewController: UITableViewDelegate {
                 for: item.message,
                 in: item.thread,
                 attachment: item.attachment,
+                spoilerState: spoilerState,
                 sourceView: { [weak self] in
                     // refetch the cell in case it changes out from underneath us.
                     return self?.tableView(tableView, cellForRowAt: indexPath)
@@ -224,7 +229,7 @@ extension MyStoriesViewController: UITableViewDataSource {
         }
 
         let cell = tableView.dequeueReusableCell(withIdentifier: SentStoryCell.reuseIdentifier, for: indexPath) as! SentStoryCell
-        cell.configure(with: item, contextMenuButtonDelegate: self, indexPath: indexPath)
+        cell.configure(with: item, spoilerState: spoilerState, contextMenuButtonDelegate: self, indexPath: indexPath)
         return cell
     }
 
@@ -283,6 +288,7 @@ extension MyStoriesViewController: ContextMenuButtonDelegate {
                 for: item.message,
                 in: item.thread,
                 attachment: item.attachment,
+                spoilerState: spoilerState,
                 sourceView: { [weak self] in
                     // refetch the cell in case it changes out from underneath us.
                     return self?.tableView.dequeueReusableCell(withIdentifier: SentStoryCell.reuseIdentifier, for: indexPath)
@@ -419,12 +425,17 @@ class SentStoryCell: UITableViewCell {
 
     fileprivate func configure(
         with item: OutgoingStoryItem,
+        spoilerState: SpoilerRenderState,
         contextMenuButtonDelegate: ContextMenuButtonDelegate,
         indexPath: IndexPath
     ) {
         if self.attachment != item.attachment {
             self.attachment = item.attachment
-            let thumbnailView = StoryThumbnailView(attachment: item.attachment)
+            let thumbnailView = StoryThumbnailView(
+                attachment: item.attachment,
+                interactionIdentifier: .fromStoryMessage(item.message),
+                spoilerState: spoilerState
+            )
             attachmentThumbnail.removeAllSubviews()
             attachmentThumbnail.addSubview(thumbnailView)
             thumbnailView.autoPinEdgesToSuperviewEdges()
@@ -470,7 +481,10 @@ class SentStoryCell: UITableViewCell {
 
         if item.attachment.isSaveable {
             saveButton.isHiddenInStackView = false
-            saveButton.block = { item.attachment.save() }
+            saveButton.block = { item.attachment.save(
+                interactionIdentifier: .fromStoryMessage(item.message),
+                spoilerState: spoilerState
+            ) }
         } else {
             saveButton.isHiddenInStackView = true
             saveButton.block = {}
diff --git a/Signal/src/ViewControllers/HomeView/Stories/MyStoryCell.swift b/Signal/src/ViewControllers/HomeView/Stories/MyStoryCell.swift
index 5d655a390a7..b869f22a520 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/MyStoryCell.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/MyStoryCell.swift
@@ -77,10 +77,12 @@ class MyStoryCell: UITableViewCell {
 
     private var attachmentThumbnailDividerView: UIView?
 
+    private var latestMessageRevealedSpoilerIds: Set<StyleIdType>?
     private var latestMessageAttachment: StoryThumbnailView.Attachment?
+    private var secondLatestMessageRevealedSpoilerIds: Set<StyleIdType>?
     private var secondLatestMessageAttachment: StoryThumbnailView.Attachment?
 
-    func configure(with model: MyStoryViewModel, addStoryAction: @escaping () -> Void) {
+    func configure(with model: MyStoryViewModel, spoilerState: SpoilerRenderState, addStoryAction: @escaping () -> Void) {
         configureSubtitle(with: model)
 
         self.backgroundColor = .clear
@@ -100,25 +102,47 @@ class MyStoryCell: UITableViewCell {
             config.usePlaceholderImages()
         }
 
+        let latestMessageRevealedSpoilerIds: Set<StyleIdType> = model.latestMessageIdentifier.map(
+            spoilerState.revealState.revealedSpoilerIds(interactionIdentifier:)
+        ) ?? Set()
+        let secondLatestMessageRevealedSpoilerIds: Set<StyleIdType> = model.secondLatestMessageIdentifier.map(
+            spoilerState.revealState.revealedSpoilerIds(interactionIdentifier:)
+        ) ?? Set()
+
         if self.latestMessageAttachment != model.latestMessageAttachment ||
-            self.secondLatestMessageAttachment != model.secondLatestMessageAttachment {
+            self.secondLatestMessageAttachment != model.secondLatestMessageAttachment ||
+            self.latestMessageRevealedSpoilerIds != latestMessageRevealedSpoilerIds ||
+            self.secondLatestMessageRevealedSpoilerIds != secondLatestMessageRevealedSpoilerIds {
             self.latestMessageAttachment = model.latestMessageAttachment
             self.secondLatestMessageAttachment = model.secondLatestMessageAttachment
+            self.latestMessageRevealedSpoilerIds = latestMessageRevealedSpoilerIds
+            self.secondLatestMessageRevealedSpoilerIds = secondLatestMessageRevealedSpoilerIds
 
             attachmentThumbnail.removeAllSubviews()
             attachmentThumbnailDividerView = nil
 
-            if let latestMessageAttachment = model.latestMessageAttachment {
+            if let latestMessageAttachment = model.latestMessageAttachment, let latestMessageIdentifier = model.latestMessageIdentifier {
                 attachmentThumbnail.isHiddenInStackView = false
 
-                let latestThumbnailView = StoryThumbnailView(attachment: latestMessageAttachment)
+                let latestThumbnailView = StoryThumbnailView(
+                    attachment: latestMessageAttachment,
+                    interactionIdentifier: latestMessageIdentifier,
+                    spoilerState: spoilerState
+                )
                 attachmentThumbnail.addSubview(latestThumbnailView)
                 latestThumbnailView.autoPinHeightToSuperview()
                 latestThumbnailView.autoSetDimensions(to: CGSize(width: 56, height: 84))
                 latestThumbnailView.autoPinEdge(toSuperviewEdge: .trailing)
 
-                if let secondLatestMessageAttachment = model.secondLatestMessageAttachment {
-                    let secondLatestThumbnailView = StoryThumbnailView(attachment: secondLatestMessageAttachment)
+                if
+                    let secondLatestMessageAttachment = model.secondLatestMessageAttachment,
+                    let secondLatestMessageIdentifier = model.secondLatestMessageIdentifier
+                {
+                    let secondLatestThumbnailView = StoryThumbnailView(
+                        attachment: secondLatestMessageAttachment,
+                        interactionIdentifier: secondLatestMessageIdentifier,
+                        spoilerState: spoilerState
+                    )
                     secondLatestThumbnailView.layer.cornerRadius = 6
                     secondLatestThumbnailView.transform = .init(rotationAngle: (CurrentAppContext().isRTL ? 1 : -1) * 0.18168878)
                     attachmentThumbnail.insertSubview(secondLatestThumbnailView, belowSubview: latestThumbnailView)
diff --git a/Signal/src/ViewControllers/HomeView/Stories/MyStoryViewModel.swift b/Signal/src/ViewControllers/HomeView/Stories/MyStoryViewModel.swift
index 3736af75eff..4bc41738dd0 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/MyStoryViewModel.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/MyStoryViewModel.swift
@@ -9,6 +9,7 @@ import SignalServiceKit
 struct MyStoryViewModel: Dependencies {
     let messages: [StoryMessage]
 
+    let latestMessageIdentifier: InteractionSnapshotIdentifier?
     let latestMessageAttachment: StoryThumbnailView.Attachment?
     let latestMessageTimestamp: UInt64?
     let sendingCount: UInt64
@@ -20,6 +21,7 @@ struct MyStoryViewModel: Dependencies {
     }
     let failureState: FailureState
 
+    let secondLatestMessageIdentifier: InteractionSnapshotIdentifier?
     let secondLatestMessageAttachment: StoryThumbnailView.Attachment?
 
     init(messages: [StoryMessage], transaction: SDSAnyReadTransaction) {
@@ -37,16 +39,20 @@ struct MyStoryViewModel: Dependencies {
         }
 
         if let latestMessage = sortedFilteredMessages.last {
+            latestMessageIdentifier = .fromStoryMessage(latestMessage)
             latestMessageAttachment = .from(latestMessage.attachment, transaction: transaction)
             latestMessageTimestamp = latestMessage.timestamp
         } else {
+            latestMessageIdentifier = nil
             latestMessageAttachment = nil
             latestMessageTimestamp = nil
         }
 
         if let secondLatestMessage = sortedFilteredMessages.dropLast().last {
+            secondLatestMessageIdentifier = .fromStoryMessage(secondLatestMessage)
             secondLatestMessageAttachment = .from(secondLatestMessage.attachment, transaction: transaction)
         } else {
+            secondLatestMessageIdentifier = nil
             secondLatestMessageAttachment = nil
         }
     }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift
index ec87abbbbb0..8241ca489b7 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift	
@@ -41,8 +41,8 @@ class StoryGroupRepliesAndViewsSheet: InteractiveSheetViewController, StoryGroup
     }
     var focusedTab: Tab = .views
 
-    init(storyMessage: StoryMessage, context: StoryContext) {
-        self.groupReplyViewController = StoryGroupReplyViewController(storyMessage: storyMessage)
+    init(storyMessage: StoryMessage, context: StoryContext, spoilerState: SpoilerRenderState) {
+        self.groupReplyViewController = StoryGroupReplyViewController(storyMessage: storyMessage, spoilerState: spoilerState)
         self.viewsViewController = StoryViewsViewController(storyMessage: storyMessage, context: context)
 
         super.init()
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift
index 3e98ce0fb30..f5c27b0bee5 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift	
@@ -18,8 +18,8 @@ class StoryGroupReplySheet: InteractiveSheetViewController, StoryGroupReplier {
     var storyMessage: StoryMessage { groupReplyViewController.storyMessage }
     var threadUniqueId: String? { groupReplyViewController.thread?.uniqueId }
 
-    init(storyMessage: StoryMessage) {
-        self.groupReplyViewController = StoryGroupReplyViewController(storyMessage: storyMessage)
+    init(storyMessage: StoryMessage, spoilerState: SpoilerRenderState) {
+        self.groupReplyViewController = StoryGroupReplyViewController(storyMessage: storyMessage, spoilerState: spoilerState)
 
         super.init()
 
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift
index 555160995d9..0397627a4c7 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplyViewController.swift	
@@ -16,10 +16,10 @@ class StoryGroupReplyViewController: OWSViewController, StoryReplySheet {
 
     private(set) lazy var tableView = UITableView()
 
-    private lazy var spoilerState = SpoilerRenderState()
+    private let spoilerState: SpoilerRenderState
 
     let bottomBar = UIView()
-    private(set) lazy var inputToolbar = StoryReplyInputToolbar(isGroupStory: true)
+    private(set) lazy var inputToolbar = StoryReplyInputToolbar(isGroupStory: true, spoilerState: spoilerState)
     private lazy var bottomBarBottomConstraint = bottomBar.autoPinEdge(toSuperviewEdge: .bottom)
     private lazy var contextMenu = ContextMenuInteraction(delegate: self)
 
@@ -62,8 +62,9 @@ class StoryGroupReplyViewController: OWSViewController, StoryReplySheet {
     var reactionPickerBackdrop: UIView?
     var reactionPicker: MessageReactionPicker?
 
-    init(storyMessage: StoryMessage) {
+    init(storyMessage: StoryMessage, spoilerState: SpoilerRenderState) {
         self.storyMessage = storyMessage
+        self.spoilerState = spoilerState
 
         super.init()
 
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryContextMenuGenerator.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryContextMenuGenerator.swift
index 1614e358906..e6daf8c4fae 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryContextMenuGenerator.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryContextMenuGenerator.swift	
@@ -55,6 +55,7 @@ class StoryContextMenuGenerator: Dependencies {
 
     public func contextMenuActions(
         for model: StoryViewModel,
+        spoilerState: SpoilerRenderState,
         sourceView: @escaping () -> UIView?
     ) -> [ContextMenuAction] {
         return Self.databaseStorage.read {
@@ -63,6 +64,7 @@ class StoryContextMenuGenerator: Dependencies {
                 for: model.latestMessage,
                 in: thread,
                 attachment: model.latestMessageAttachment,
+                spoilerState: spoilerState,
                 sourceView: sourceView,
                 transaction: $0
             )
@@ -73,6 +75,7 @@ class StoryContextMenuGenerator: Dependencies {
         for message: StoryMessage,
         in thread: TSThread?,
         attachment: StoryThumbnailView.Attachment,
+        spoilerState: SpoilerRenderState,
         sourceView: @escaping () -> UIView?,
         hideSaveAction: Bool = false,
         onlyRenderMyStories: Bool = false,
@@ -81,8 +84,13 @@ class StoryContextMenuGenerator: Dependencies {
         return [
             deleteAction(for: message, in: thread),
             hideAction(for: message, transaction: transaction),
-            infoAction(for: message, in: thread, onlyRenderMyStories: onlyRenderMyStories),
-            hideSaveAction ? nil : saveAction(message: message, attachment: attachment),
+            infoAction(
+                for: message,
+                in: thread,
+                onlyRenderMyStories: onlyRenderMyStories,
+                spoilerState: spoilerState
+            ),
+            hideSaveAction ? nil : saveAction(message: message, attachment: attachment, spoilerState: spoilerState),
             forwardAction(message: message),
             shareAction(message: message, attachment: attachment, sourceView: sourceView),
             goToChatAction(thread: thread)
@@ -91,6 +99,7 @@ class StoryContextMenuGenerator: Dependencies {
 
     public func nativeContextMenuActions(
         for model: StoryViewModel,
+        spoilerState: SpoilerRenderState,
         sourceView: @escaping () -> UIView?
     ) -> [UIAction] {
         return Self.databaseStorage.read {
@@ -99,6 +108,7 @@ class StoryContextMenuGenerator: Dependencies {
                 for: model.latestMessage,
                 in: thread,
                 attachment: model.latestMessageAttachment,
+                spoilerState: spoilerState,
                 sourceView: sourceView,
                 transaction: $0
             )
@@ -109,6 +119,7 @@ class StoryContextMenuGenerator: Dependencies {
         for message: StoryMessage,
         in thread: TSThread?,
         attachment: StoryThumbnailView.Attachment,
+        spoilerState: SpoilerRenderState,
         sourceView: @escaping () -> UIView?,
         hideSaveAction: Bool = false,
         onlyRenderMyStories: Bool = false,
@@ -117,8 +128,8 @@ class StoryContextMenuGenerator: Dependencies {
         return [
             deleteAction(for: message, in: thread),
             hideAction(for: message, transaction: transaction),
-            infoAction(for: message, in: thread, onlyRenderMyStories: onlyRenderMyStories),
-            hideSaveAction ? nil : saveAction(message: message, attachment: attachment),
+            infoAction(for: message, in: thread, onlyRenderMyStories: onlyRenderMyStories, spoilerState: spoilerState),
+            hideSaveAction ? nil : saveAction(message: message, attachment: attachment, spoilerState: spoilerState),
             forwardAction(message: message),
             shareAction(message: message, attachment: attachment, sourceView: sourceView),
             goToChatAction(thread: thread)
@@ -374,7 +385,8 @@ extension StoryContextMenuGenerator {
     private func infoAction(
         for message: StoryMessage,
         in thread: TSThread?,
-        onlyRenderMyStories: Bool
+        onlyRenderMyStories: Bool,
+        spoilerState: SpoilerRenderState
     ) -> GenericContextAction? {
         guard let thread = thread else { return nil }
 
@@ -385,7 +397,12 @@ extension StoryContextMenuGenerator {
             ),
             icon: .contextMenuInfo,
             handler: { [weak self] completion in
-                self?.presentInfoSheet(message, in: thread, onlyRenderMyStories: onlyRenderMyStories)
+                self?.presentInfoSheet(
+                    message,
+                    in: thread,
+                    onlyRenderMyStories: onlyRenderMyStories,
+                    spoilerState: spoilerState
+                )
                 completion(true)
             }
         )
@@ -394,17 +411,24 @@ extension StoryContextMenuGenerator {
     private func presentInfoSheet(
         _ message: StoryMessage,
         in thread: TSThread,
-        onlyRenderMyStories: Bool
+        onlyRenderMyStories: Bool,
+        spoilerState: SpoilerRenderState
     ) {
         if presentingController is StoryContextViewController {
             isDisplayingFollowup = true
-            let vc = StoryInfoSheet(storyMessage: message, context: thread.storyContext)
+            let vc = StoryInfoSheet(storyMessage: message, context: thread.storyContext, spoilerState: spoilerState)
             vc.dismissHandler = { [weak self] in
                 self?.isDisplayingFollowup = false
             }
             presentingController?.present(vc, animated: true)
         } else {
-            let vc = StoryPageViewController(context: thread.storyContext, loadMessage: message, action: .presentInfo, onlyRenderMyStories: onlyRenderMyStories)
+            let vc = StoryPageViewController(
+                context: thread.storyContext,
+                spoilerState: spoilerState,
+                loadMessage: message,
+                action: .presentInfo,
+                onlyRenderMyStories: onlyRenderMyStories
+            )
             presentingController?.present(vc, animated: true)
         }
     }
@@ -532,7 +556,8 @@ extension StoryContextMenuGenerator {
 
     private func saveAction(
         message: StoryMessage,
-        attachment: StoryThumbnailView.Attachment
+        attachment: StoryThumbnailView.Attachment,
+        spoilerState: SpoilerRenderState
     ) -> GenericContextAction? {
         guard
             message.authorAddress.isLocalAddress
@@ -550,7 +575,7 @@ extension StoryContextMenuGenerator {
             ),
             icon: .contextMenuSave,
             handler: { completion in
-                attachment.save()
+                attachment.save(interactionIdentifier: .fromStoryMessage(message), spoilerState: spoilerState)
                 completion(true)
             }
         )
@@ -570,7 +595,7 @@ extension StoryThumbnailView.Attachment {
         }
     }
 
-    func save() {
+    func save(interactionIdentifier: InteractionSnapshotIdentifier, spoilerState: SpoilerRenderState) {
         guard let vc = CurrentAppContext().frontmostViewController() else {
             return owsFailDebug("Missing frontmost view controller")
         }
@@ -617,7 +642,11 @@ extension StoryThumbnailView.Attachment {
                 })
             }
         case .text(let attachment):
-            let view = TextAttachmentView(attachment: attachment)
+            let view = TextAttachmentView(
+                attachment: attachment,
+                interactionIdentifier: interactionIdentifier,
+                spoilerState: spoilerState
+            )
             view.frame.size = CGSize(width: 375, height: 666)
             view.layoutIfNeeded()
             let image = view.renderAsImage()
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift
index f96e6acb1d5..ba6cb950dca 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift	
@@ -15,7 +15,7 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
         let quotedReplyModel = databaseStorage.read {
             QuotedReplyModel(storyMessage: storyMessage, transaction: $0)
         }
-        let toolbar = StoryReplyInputToolbar(isGroupStory: false, quotedReplyModel: quotedReplyModel)
+        let toolbar = StoryReplyInputToolbar(isGroupStory: false, quotedReplyModel: quotedReplyModel, spoilerState: spoilerState)
         toolbar.delegate = self
         return toolbar
     }()
@@ -27,8 +27,11 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
 
     let backdropView: UIView? = UIView()
 
-    init(storyMessage: StoryMessage) {
+    let spoilerState: SpoilerRenderState
+
+    init(storyMessage: StoryMessage, spoilerState: SpoilerRenderState) {
         self.storyMessage = storyMessage
+        self.spoilerState = spoilerState
         super.init()
         modalPresentationStyle = .custom
     }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift
index d028de7fcbb..091fc8fef04 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyInputToolbar.swift	
@@ -29,6 +29,8 @@ class StoryReplyInputToolbar: UIView {
     let isGroupStory: Bool
     let quotedReplyModel: QuotedReplyModel?
 
+    let spoilerState: SpoilerRenderState
+
     var messageBodyForSending: MessageBody? {
         textView.messageBodyForSending
     }
@@ -57,10 +59,12 @@ class StoryReplyInputToolbar: UIView {
 
     init(
         isGroupStory: Bool,
-        quotedReplyModel: QuotedReplyModel? = nil
+        quotedReplyModel: QuotedReplyModel? = nil,
+        spoilerState: SpoilerRenderState
     ) {
         self.isGroupStory = isGroupStory
         self.quotedReplyModel = quotedReplyModel
+        self.spoilerState = spoilerState
         super.init(frame: CGRect.zero)
 
         // When presenting or dismissing the keyboard, there may be a slight
@@ -213,7 +217,10 @@ class StoryReplyInputToolbar: UIView {
         textContainer.addArrangedSubview(bubbleView)
 
         if let quotedReplyModel = quotedReplyModel {
-            let previewView = StoryReplyPreviewView(quotedReplyModel: quotedReplyModel)
+            let previewView = StoryReplyPreviewView(
+                quotedReplyModel: quotedReplyModel,
+                spoilerState: spoilerState
+            )
             let previewViewContainer = UIView()
             previewViewContainer.addSubview(previewView)
             previewView.autoPinEdgesToSuperviewEdges(with: UIEdgeInsets(top: 8, leading: 8, bottom: 2, trailing: 8))
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyPreviewView.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyPreviewView.swift
index a13ea17e990..b71e3214ab2 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyPreviewView.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryReplyPreviewView.swift	
@@ -11,7 +11,7 @@ import UIKit
 // TODO: We could theoretically replace this with QuotedMessageView, but that's very
 // deeply tied into the CV rendering system and not easy to use outside of that context.
 class StoryReplyPreviewView: UIView {
-    init(quotedReplyModel: QuotedReplyModel) {
+    init(quotedReplyModel: QuotedReplyModel, spoilerState: SpoilerRenderState) {
         super.init(frame: .zero)
 
         backgroundColor = .ows_gray60
@@ -84,7 +84,7 @@ class StoryReplyPreviewView: UIView {
             imageView.contentMode = .scaleAspectFill
             imageView.image = thumbnailImage
             trailingView = imageView
-        } else if let thumbnailView = quotedReplyModel.thumbnailViewFactory?() {
+        } else if let thumbnailView = quotedReplyModel.thumbnailViewFactory?(spoilerState) {
             trailingView = thumbnailView
         } else {
             owsFailDebug("Missing trailingView for quote")
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Settings/GroupStorySettingsViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/Settings/GroupStorySettingsViewController.swift
index 4e911236a1b..500f426ab3b 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Settings/GroupStorySettingsViewController.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/Settings/GroupStorySettingsViewController.swift
@@ -209,7 +209,8 @@ class GroupStorySettingsViewController: OWSTableViewController2 {
     }
 
     private func didSelectViewer(_ address: SignalServiceAddress) {
-        let sheet = MemberActionSheet(address: address, groupViewHelper: nil)
+        // No need to share spoiler state; just start fresh.
+        let sheet = MemberActionSheet(address: address, groupViewHelper: nil, spoilerState: SpoilerRenderState())
         present(sheet, animated: true)
     }
 }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoriesViewController.swift b/Signal/src/ViewControllers/HomeView/Stories/StoriesViewController.swift
index 4162ee503bc..c5cc999e70c 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoriesViewController.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoriesViewController.swift
@@ -42,11 +42,14 @@ class StoriesViewController: OWSViewController, StoryListDataSourceDelegate {
         return label
     }()
 
-    private lazy var dataSource = StoryListDataSource(delegate: self)
+    private lazy var dataSource = StoryListDataSource(delegate: self, spoilerState: spoilerState)
 
     private lazy var contextMenuGenerator = StoryContextMenuGenerator(presentingController: self, delegate: self)
 
-    override init() {
+    private let spoilerState: SpoilerRenderState
+
+    public init(spoilerState: SpoilerRenderState) {
+        self.spoilerState = spoilerState
         super.init()
         // Want to start loading right away to prevent cases where things aren't loaded
         // when you tab over into the stories list.
@@ -213,18 +216,18 @@ class StoriesViewController: OWSViewController, StoryListDataSourceDelegate {
             case .myStory:
                 guard let cell = self.tableView.cellForRow(at: indexPath) as? MyStoryCell else { continue }
                 guard let model = dataSource.myStory else { continue }
-                cell.configure(with: model) { [weak self] in self?.showCameraView() }
+                cell.configure(with: model, spoilerState: spoilerState) { [weak self] in self?.showCameraView() }
             case .visibleStories:
                 guard let cell = self.tableView.cellForRow(at: indexPath) as? StoryCell else { continue }
                 guard let model = self.model(for: indexPath) else { continue }
-                cell.configure(with: model)
+                cell.configure(with: model, spoilerState: spoilerState)
             case .hiddenStories:
                 let cell = self.tableView.cellForRow(at: indexPath)
                 if
                     let storyCell = cell as? StoryCell,
                     let model = self.model(for: indexPath)
                 {
-                    storyCell.configure(with: model)
+                    storyCell.configure(with: model, spoilerState: spoilerState)
                 } else if
                     let headerCell = cell as? HiddenStoryHeaderCell
                 {
@@ -438,7 +441,7 @@ extension StoriesViewController: UITableViewDelegate {
             if dataSource.myStory?.messages.isEmpty == true {
                 showCameraView()
             } else {
-                navigationController?.pushViewController(MyStoriesViewController(), animated: true)
+                navigationController?.pushViewController(MyStoriesViewController(spoilerState: spoilerState), animated: true)
             }
         case .hiddenStories:
             if indexPath.row == 0, dataSource.shouldDisplayHiddenStoriesHeader {
@@ -486,6 +489,7 @@ extension StoriesViewController: UITableViewDelegate {
 
             let vc = StoryPageViewController(
                 context: model.context,
+                spoilerState: spoilerState,
                 viewableContexts: viewableContexts,
                 hiddenStoryFilter: startedFromHidden
             )
@@ -541,12 +545,14 @@ extension StoriesViewController: UITableViewDelegate {
         }
 
         return .init(identifier: indexPath as NSCopying, previewProvider: nil, actionProvider: { [weak self] _ in
-            let actions = self?.contextMenuGenerator.nativeContextMenuActions(
+            guard let self else { return .init(children: []) }
+            let actions = self.contextMenuGenerator.nativeContextMenuActions(
                 for: model,
+                spoilerState: self.spoilerState,
                 sourceView: { [weak self] in
                     return self?.tableView.cellForRow(at: indexPath)
                 }
-            ) ?? []
+            )
             return .init(children: actions)
         })
     }
@@ -597,7 +603,7 @@ extension StoriesViewController: UITableViewDataSource {
                 owsFailDebug("Missing my story model")
                 return cell
             }
-            cell.configure(with: myStoryModel) { [weak self] in self?.showCameraView() }
+            cell.configure(with: myStoryModel, spoilerState: spoilerState) { [weak self] in self?.showCameraView() }
             return cell
         case .hiddenStories:
             if indexPath.row == 0 && dataSource.shouldDisplayHiddenStoriesHeader {
@@ -616,7 +622,7 @@ extension StoriesViewController: UITableViewDataSource {
                 owsFailDebug("Missing model for story")
                 return cell
             }
-            cell.configure(with: model)
+            cell.configure(with: model, spoilerState: spoilerState)
             return cell
         case .none:
             owsFailDebug("Unexpected section \(indexPath.section)")
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoryCell.swift b/Signal/src/ViewControllers/HomeView/Stories/StoryCell.swift
index e27691d1678..b22d687bf86 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoryCell.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoryCell.swift
@@ -67,8 +67,9 @@ class StoryCell: UITableViewCell {
     }
 
     private var attachment: StoryThumbnailView.Attachment?
+    private var revealedSpoilerIds: Set<StyleIdType>?
 
-    func configure(with model: StoryViewModel) {
+    func configure(with model: StoryViewModel, spoilerState: SpoilerRenderState) {
         configureSubtitle(with: model)
 
         switch model.context {
@@ -102,11 +103,17 @@ class StoryCell: UITableViewCell {
         }
 
         attachmentThumbnail.backgroundColor = Theme.washColor
-        if self.attachment != model.latestMessageAttachment {
+        let revealedSpoilerIds = spoilerState.revealState.revealedSpoilerIds(interactionIdentifier: model.latestMessageIdentifier)
+        if self.attachment != model.latestMessageAttachment || self.revealedSpoilerIds != revealedSpoilerIds {
             self.attachment = model.latestMessageAttachment
+            self.revealedSpoilerIds = revealedSpoilerIds
             attachmentThumbnail.removeAllSubviews()
 
-            let storyThumbnailView = StoryThumbnailView(attachment: model.latestMessageAttachment)
+            let storyThumbnailView = StoryThumbnailView(
+                attachment: model.latestMessageAttachment,
+                interactionIdentifier: model.latestMessageIdentifier,
+                spoilerState: spoilerState
+            )
             attachmentThumbnail.addSubview(storyThumbnailView)
             storyThumbnailView.autoPinEdgesToSuperviewEdges()
         }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoryInfoSheet.swift b/Signal/src/ViewControllers/HomeView/Stories/StoryInfoSheet.swift
index 3d959caf007..722f6abf945 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoryInfoSheet.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoryInfoSheet.swift
@@ -12,11 +12,14 @@ class StoryInfoSheet: OWSTableSheetViewController {
     let context: StoryContext
     var dismissHandler: (() -> Void)?
 
+    private let spoilerState: SpoilerRenderState
+
     override var sheetBackgroundColor: UIColor { .ows_gray90 }
 
-    init(storyMessage: StoryMessage, context: StoryContext) {
+    init(storyMessage: StoryMessage, context: StoryContext, spoilerState: SpoilerRenderState) {
         self.storyMessage = storyMessage
         self.context = context
+        self.spoilerState = spoilerState
         super.init()
 
         databaseStorage.appendDatabaseChangeDelegate(self)
@@ -277,7 +280,7 @@ class StoryInfoSheet: OWSTableSheetViewController {
             return cell
         }, actionBlock: { [weak self] in
             guard let self = self else { return }
-            let actionSheet = MemberActionSheet(address: address, groupViewHelper: nil)
+            let actionSheet = MemberActionSheet(address: address, groupViewHelper: nil, spoilerState: self.spoilerState)
             actionSheet.present(from: self)
         })
     }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoryListDataSource.swift b/Signal/src/ViewControllers/HomeView/Stories/StoryListDataSource.swift
index 765c07aec8a..c3354071130 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoryListDataSource.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoryListDataSource.swift
@@ -6,6 +6,7 @@
 import Foundation
 import GRDB
 import SignalServiceKit
+import SignalUI
 
 protocol StoryListDataSourceDelegate: AnyObject {
 
@@ -27,8 +28,11 @@ class StoryListDataSource: NSObject, Dependencies {
 
     private weak var delegate: StoryListDataSourceDelegate?
 
-    init(delegate: StoryListDataSourceDelegate) {
+    private let spoilerState: SpoilerRenderState
+
+    init(delegate: StoryListDataSourceDelegate, spoilerState: SpoilerRenderState) {
         self.delegate = delegate
+        self.spoilerState = spoilerState
         super.init()
     }
 
@@ -682,7 +686,7 @@ class StoryListDataSource: NSObject, Dependencies {
                     guard let model = models[safe: newIndex] else {
                         return owsFailDebug("Missing model for story")
                     }
-                    visibleCell.configure(with: model)
+                    visibleCell.configure(with: model, spoilerState: spoilerState)
                 } else {
                     tableView.reloadRows(at: [path], with: .none)
                 }
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoryThumbnailView.swift b/Signal/src/ViewControllers/HomeView/Stories/StoryThumbnailView.swift
index d21c8ef6170..48e4ef0f149 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoryThumbnailView.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoryThumbnailView.swift
@@ -26,7 +26,7 @@ class StoryThumbnailView: UIView {
         }
     }
 
-    init(attachment: Attachment) {
+    init(attachment: Attachment, interactionIdentifier: InteractionSnapshotIdentifier, spoilerState: SpoilerRenderState) {
         super.init(frame: .zero)
 
         layer.cornerRadius = 12
@@ -52,7 +52,11 @@ class StoryThumbnailView: UIView {
                 owsFailDebug("Unexpected attachment type \(type(of: attachment))")
             }
         case .text(let attachment):
-            let textThumbnailView = TextAttachmentView(attachment: attachment).asThumbnailView()
+            let textThumbnailView = TextAttachmentView(
+                attachment: attachment,
+                interactionIdentifier: interactionIdentifier,
+                spoilerState: spoilerState
+            ).asThumbnailView()
             addSubview(textThumbnailView)
             textThumbnailView.autoPinEdgesToSuperviewEdges()
         case .missing:
diff --git a/Signal/src/ViewControllers/HomeView/Stories/StoryViewModel.swift b/Signal/src/ViewControllers/HomeView/Stories/StoryViewModel.swift
index 5903c9b957e..5c8a250e6db 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/StoryViewModel.swift
+++ b/Signal/src/ViewControllers/HomeView/Stories/StoryViewModel.swift
@@ -20,6 +20,7 @@ struct StoryViewModel: Dependencies {
     let latestMessageAttachment: StoryThumbnailView.Attachment
     let hasReplies: Bool
     let latestMessageName: String
+    let latestMessageIdentifier: InteractionSnapshotIdentifier
     let latestMessageTimestamp: UInt64
     let latestMessageViewedTimestamp: UInt64?
     let latestMessageSendingState: TSOutgoingMessageState
@@ -54,6 +55,7 @@ struct StoryViewModel: Dependencies {
         )
         latestMessageAvatarDataSource = try StoryUtil.contextAvatarDataSource(for: latestMessage, transaction: transaction)
         latestMessageAttachment = .from(latestMessage.attachment, transaction: transaction)
+        latestMessageIdentifier = .fromStoryMessage(latestMessage)
         latestMessageTimestamp = latestMessage.timestamp
         latestMessageViewedTimestamp = latestMessage.localUserViewedTimestamp
         latestMessageSendingState = latestMessage.sendingState
diff --git a/Signal/src/ViewControllers/LongTextViewController.swift b/Signal/src/ViewControllers/LongTextViewController.swift
index 02f3d36425c..26f30a5e062 100644
--- a/Signal/src/ViewControllers/LongTextViewController.swift
+++ b/Signal/src/ViewControllers/LongTextViewController.swift
@@ -294,7 +294,11 @@ public class LongTextViewController: OWSViewController {
                     }
 
                     let address = SignalServiceAddress(uuid: mentionItem.mentionUUID)
-                    let actionSheet = MemberActionSheet(address: address, groupViewHelper: groupViewHelper)
+                    let actionSheet = MemberActionSheet(
+                        address: address,
+                        groupViewHelper: groupViewHelper,
+                        spoilerState: spoilerState
+                    )
                     actionSheet.present(from: self)
                     return
                 case .unrevealedSpoiler(let unrevealedSpoiler):
diff --git a/Signal/src/ViewControllers/MessageDetailViewController.swift b/Signal/src/ViewControllers/MessageDetailViewController.swift
index 4324ef5bfff..4cb1eb96fcd 100644
--- a/Signal/src/ViewControllers/MessageDetailViewController.swift
+++ b/Signal/src/ViewControllers/MessageDetailViewController.swift
@@ -494,7 +494,7 @@ class MessageDetailViewController: OWSTableViewController2 {
             },
             actionBlock: { [weak self] in
                 guard let self = self else { return }
-                let actionSheet = MemberActionSheet(address: address, groupViewHelper: nil)
+            let actionSheet = MemberActionSheet(address: address, groupViewHelper: nil, spoilerState: self.spoilerState)
                 actionSheet.present(from: self)
             }
         )
diff --git a/Signal/src/ViewControllers/Photos/PhotoCaptureViewController.swift b/Signal/src/ViewControllers/Photos/PhotoCaptureViewController.swift
index e48f4c34ad1..53d434f0a2d 100644
--- a/Signal/src/ViewControllers/Photos/PhotoCaptureViewController.swift
+++ b/Signal/src/ViewControllers/Photos/PhotoCaptureViewController.swift
@@ -1392,7 +1392,8 @@ private class TextStoryComposerView: TextAttachmentView, UITextViewDelegate {
 
     init(text: String) {
         super.init(
-            textContent: .styled(body: text, style: .regular),
+            text: text,
+            style: .regular,
             textForegroundColor: .white,
             textBackgroundColor: nil,
             background: TextStoryComposerView.defaultBackground,
diff --git a/Signal/src/ViewControllers/ThreadSettings/ConversationSettingsViewController.swift b/Signal/src/ViewControllers/ThreadSettings/ConversationSettingsViewController.swift
index ab9f73824be..3a5eeaa585b 100644
--- a/Signal/src/ViewControllers/ThreadSettings/ConversationSettingsViewController.swift
+++ b/Signal/src/ViewControllers/ThreadSettings/ConversationSettingsViewController.swift
@@ -350,7 +350,11 @@ class ConversationSettingsViewController: OWSTableViewController2, BadgeCollecti
             owsFailDebug("Invalid address.")
             return
         }
-        let memberActionSheet = MemberActionSheet(address: memberAddress, groupViewHelper: groupViewHelper)
+        let memberActionSheet = MemberActionSheet(
+            address: memberAddress,
+            groupViewHelper: groupViewHelper,
+            spoilerState: spoilerState
+        )
         memberActionSheet.present(from: self)
     }
 
@@ -388,7 +392,7 @@ class ConversationSettingsViewController: OWSTableViewController2, BadgeCollecti
     // MARK: - Actions
 
     func presentStoryViewController() {
-        let vc = StoryPageViewController(context: thread.storyContext)
+        let vc = StoryPageViewController(context: thread.storyContext, spoilerState: spoilerState)
         present(vc, animated: true)
     }
 
@@ -502,8 +506,11 @@ class ConversationSettingsViewController: OWSTableViewController2, BadgeCollecti
             owsFailDebug("Invalid thread.")
             return nil
         }
-        let groupMemberRequestsAndInvitesViewController = GroupMemberRequestsAndInvitesViewController(groupThread: groupThread,
-                                                                                                      groupViewHelper: groupViewHelper)
+        let groupMemberRequestsAndInvitesViewController = GroupMemberRequestsAndInvitesViewController(
+            groupThread: groupThread,
+            groupViewHelper: groupViewHelper,
+            spoilerState: spoilerState
+        )
         groupMemberRequestsAndInvitesViewController.groupMemberRequestsAndInvitesViewControllerDelegate = self
         return groupMemberRequestsAndInvitesViewController
     }
diff --git a/Signal/src/ViewControllers/ThreadSettings/GroupMemberRequestsAndInvitesViewController.swift b/Signal/src/ViewControllers/ThreadSettings/GroupMemberRequestsAndInvitesViewController.swift
index fd52af53fc3..7c0350e122d 100644
--- a/Signal/src/ViewControllers/ThreadSettings/GroupMemberRequestsAndInvitesViewController.swift
+++ b/Signal/src/ViewControllers/ThreadSettings/GroupMemberRequestsAndInvitesViewController.swift
@@ -23,6 +23,8 @@ public class GroupMemberRequestsAndInvitesViewController: OWSTableViewController
 
     private let groupViewHelper: GroupViewHelper
 
+    private let spoilerState: SpoilerRenderState
+
     private enum Mode: Int, CaseIterable {
         case memberRequests = 0
         case pendingInvites = 1
@@ -30,10 +32,11 @@ public class GroupMemberRequestsAndInvitesViewController: OWSTableViewController
 
     private let segmentedControl = UISegmentedControl()
 
-    required init(groupThread: TSGroupThread, groupViewHelper: GroupViewHelper) {
+    required init(groupThread: TSGroupThread, groupViewHelper: GroupViewHelper, spoilerState: SpoilerRenderState) {
         self.oldGroupThread = groupThread
         self.groupModel = groupThread.groupModel
         self.groupViewHelper = groupViewHelper
+        self.spoilerState = spoilerState
 
         super.init()
     }
@@ -431,7 +434,7 @@ public class GroupMemberRequestsAndInvitesViewController: OWSTableViewController
     }
 
     private func showMemberActionSheet(for address: SignalServiceAddress) {
-        let memberActionSheet = MemberActionSheet(address: address, groupViewHelper: groupViewHelper)
+        let memberActionSheet = MemberActionSheet(address: address, groupViewHelper: groupViewHelper, spoilerState: spoilerState)
         memberActionSheet.present(from: self)
     }
 
diff --git a/Signal/src/ViewControllers/ThreadSettings/MemberActionSheet.swift b/Signal/src/ViewControllers/ThreadSettings/MemberActionSheet.swift
index a9f12e51320..d35896b4567 100644
--- a/Signal/src/ViewControllers/ThreadSettings/MemberActionSheet.swift
+++ b/Signal/src/ViewControllers/ThreadSettings/MemberActionSheet.swift
@@ -14,11 +14,17 @@ class MemberActionSheet: OWSTableSheetViewController {
     var thread: TSThread { threadViewModel.threadRecord }
     var threadViewModel: ThreadViewModel
     let address: SignalServiceAddress
+    let spoilerState: SpoilerRenderState
 
-    init(address: SignalServiceAddress, groupViewHelper: GroupViewHelper?) {
+    init(
+        address: SignalServiceAddress,
+        groupViewHelper: GroupViewHelper?,
+        spoilerState: SpoilerRenderState
+    ) {
         self.threadViewModel = Self.fetchThreadViewModel(address: address)
         self.groupViewHelper = groupViewHelper
         self.address = address
+        self.spoilerState = spoilerState
 
         super.init()
 
@@ -270,7 +276,7 @@ extension MemberActionSheet: ConversationHeaderDelegate {
 
     func presentStoryViewController() {
         dismiss(animated: true) {
-            let vc = StoryPageViewController(context: self.thread.storyContext)
+            let vc = StoryPageViewController(context: self.thread.storyContext, spoilerState: self.spoilerState)
             self.fromViewController?.present(vc, animated: true)
         }
     }
diff --git a/Signal/src/ViewControllers/ThreadSettings/NameCollisionResolutionViewController.swift b/Signal/src/ViewControllers/ThreadSettings/NameCollisionResolutionViewController.swift
index 09cdaa339ce..0ebf06ca919 100644
--- a/Signal/src/ViewControllers/ThreadSettings/NameCollisionResolutionViewController.swift
+++ b/Signal/src/ViewControllers/ThreadSettings/NameCollisionResolutionViewController.swift
@@ -226,7 +226,8 @@ class NameCollisionResolutionViewController: OWSTableViewController2 {
                 guard let self = self else { return }
                 MemberActionSheet(
                     address: model.address,
-                    groupViewHelper: self.groupViewHelper
+                    groupViewHelper: self.groupViewHelper,
+                    spoilerState: SpoilerRenderState() // no need to share
                 ).present(from: self)
             }
             )
diff --git a/Signal/src/util/NotificationActionHandler.swift b/Signal/src/util/NotificationActionHandler.swift
index fd9a6ef9209..7a22a96b620 100644
--- a/Signal/src/util/NotificationActionHandler.swift
+++ b/Signal/src/util/NotificationActionHandler.swift
@@ -5,6 +5,7 @@
 
 import SignalMessaging
 import SignalServiceKit
+import SignalUI
 
 public class NotificationActionHandler: Dependencies {
 
@@ -223,7 +224,13 @@ public class NotificationActionHandler: Dependencies {
             }
         }
 
-        let vc = StoryPageViewController(context: storyMessage.context, loadMessage: storyMessage, action: .presentReplies)
+        let vc = StoryPageViewController(
+            context: storyMessage.context,
+            // Fresh state when coming in from a notification; no need to share.
+            spoilerState: SpoilerRenderState(),
+            loadMessage: storyMessage,
+            action: .presentReplies
+        )
         frontmostViewController.present(vc, animated: true)
     }
 
diff --git a/SignalServiceKit/src/Messages/BodyRanges/SpoilerRevealState.swift b/SignalServiceKit/src/Messages/BodyRanges/SpoilerRevealState.swift
index a264e40b91e..0def9dae881 100644
--- a/SignalServiceKit/src/Messages/BodyRanges/SpoilerRevealState.swift
+++ b/SignalServiceKit/src/Messages/BodyRanges/SpoilerRevealState.swift
@@ -29,6 +29,11 @@ public struct InteractionSnapshotIdentifier: Equatable, Hashable {
     public static func fromInteraction(_ interaction: TSInteraction) -> Self {
         return .init(timestamp: interaction.timestamp, authorUuid: (interaction as? TSIncomingMessage)?.authorUUID)
     }
+
+    // Not strictly an interaction, but can contain spoilers.
+    public static func fromStoryMessage(_ storyMessage: StoryMessage) -> Self {
+        return  .init(timestamp: storyMessage.timestamp, authorUuid: storyMessage.authorUuid.uuidString)
+    }
 }
 
 // MARK: -
diff --git a/SignalServiceKit/src/Messages/BodyRanges/StyleOnlyMessageBody.swift b/SignalServiceKit/src/Messages/BodyRanges/StyleOnlyMessageBody.swift
index 671252adf1d..2ac0869a3af 100644
--- a/SignalServiceKit/src/Messages/BodyRanges/StyleOnlyMessageBody.swift
+++ b/SignalServiceKit/src/Messages/BodyRanges/StyleOnlyMessageBody.swift
@@ -18,6 +18,8 @@ public class StyleOnlyMessageBody: NSObject, Codable {
         return text.isEmpty
     }
 
+    public var length: Int { (text as NSString).length }
+
     public var hasStyles: Bool {
         return collapsedStyles.isEmpty.negated
     }
@@ -135,6 +137,13 @@ public class StyleOnlyMessageBody: NSObject, Codable {
         stripAndPerformDrop(String.dropLast, count)
     }
 
+    public func addingSuffix(_ suffix: StyleOnlyMessageBody) -> StyleOnlyMessageBody {
+        let suffixOffset = self.length
+        return .init(text: self.text + suffix.text, collapsedStyles: collapsedStyles + suffix.collapsedStyles.map {
+            return NSRangedValue($0.value, range: NSRange(location: $0.range.location + suffixOffset, length: $0.range.length))
+        })
+    }
+
     private func stripAndPerformDrop(
         _ operation: (__owned String) -> (Int) -> Substring,
         _ count: Int
diff --git a/SignalUI/Utils/StoryMessage+SignalUI.swift b/SignalUI/Utils/StoryMessage+SignalUI.swift
index 48ecb175939..4f1321887a6 100644
--- a/SignalUI/Utils/StoryMessage+SignalUI.swift
+++ b/SignalUI/Utils/StoryMessage+SignalUI.swift
@@ -71,8 +71,12 @@ extension StoryMessage {
         }
     }
 
-    func thumbnailView() -> UIView? {
+    func thumbnailView(spoilerState: SpoilerRenderState) -> UIView? {
         guard case .text(let attachment) = attachment else { return nil }
-        return TextAttachmentView(attachment: attachment).asThumbnailView()
+        return TextAttachmentView(
+            attachment: attachment,
+            interactionIdentifier: .fromStoryMessage(self),
+            spoilerState: spoilerState
+        ).asThumbnailView()
     }
 }
diff --git a/SignalUI/ViewModels/QuotedReplyModel.swift b/SignalUI/ViewModels/QuotedReplyModel.swift
index 9727de4f17d..97be17b2635 100644
--- a/SignalUI/ViewModels/QuotedReplyModel.swift
+++ b/SignalUI/ViewModels/QuotedReplyModel.swift
@@ -37,13 +37,13 @@ public class QuotedReplyModel: NSObject {
     public let sourceFilename: String?
 
     public let thumbnailImage: UIImage?
-    public let thumbnailViewFactory: (() -> UIView?)?
+    public let thumbnailViewFactory: ((SpoilerRenderState) -> UIView?)?
 
     public convenience init?(storyMessage: StoryMessage, reactionEmoji: String? = nil, transaction: SDSAnyReadTransaction) {
         let thumbnailImage = storyMessage.thumbnailImage(transaction: transaction)
-        let thumbnailViewFactory: (() -> UIView?)?
+        let thumbnailViewFactory: ((SpoilerRenderState) -> UIView?)?
         if thumbnailImage == nil {
-            thumbnailViewFactory = { return storyMessage.thumbnailView() }
+            thumbnailViewFactory = { return storyMessage.thumbnailView(spoilerState: $0) }
         } else {
             thumbnailViewFactory = nil
         }
@@ -415,7 +415,7 @@ public class QuotedReplyModel: NSObject {
         body: String? = nil,
         bodyRanges: MessageBodyRanges? = nil,
         thumbnailImage: UIImage? = nil,
-        thumbnailViewFactory: (() -> UIView?)? = nil,
+        thumbnailViewFactory: ((SpoilerRenderState) -> UIView?)? = nil,
         contentType: String? = nil,
         sourceFilename: String? = nil,
         attachmentStream: TSAttachmentStream? = nil,
diff --git a/SignalUI/Views/BodyRanges/MessageBodyDisplayConfigurations.swift b/SignalUI/Views/BodyRanges/MessageBodyDisplayConfigurations.swift
index 6fd7b368b80..c238000f640 100644
--- a/SignalUI/Views/BodyRanges/MessageBodyDisplayConfigurations.swift
+++ b/SignalUI/Views/BodyRanges/MessageBodyDisplayConfigurations.swift
@@ -141,6 +141,29 @@ public extension HydratedMessageBody.DisplayConfiguration {
             revealedSpoilerIds: revealedSpoilerIds
         )
     }
+
+    static func storyCaption(
+        font: UIFont,
+        revealedSpoilerIds: Set<StyleIdType>
+    ) -> Self {
+        return .init(
+            baseFont: font,
+            baseTextColor: .fixed(Theme.darkThemePrimaryColor),
+            revealedSpoilerIds: revealedSpoilerIds
+        )
+    }
+
+    static func textStory(
+        font: UIFont,
+        textColor: UIColor,
+        revealedSpoilerIds: Set<StyleIdType>
+    ) -> Self {
+        return .init(
+            baseFont: font,
+            baseTextColor: .fixed(textColor),
+            revealedSpoilerIds: revealedSpoilerIds
+        )
+    }
 }
 
 extension ThemedColor {
diff --git a/SignalUI/Views/TextAttachmentView.swift b/SignalUI/Views/TextAttachmentView.swift
index 2d42ec38bb4..65ed22712b5 100644
--- a/SignalUI/Views/TextAttachmentView.swift
+++ b/SignalUI/Views/TextAttachmentView.swift
@@ -13,13 +13,30 @@ open class TextAttachmentView: UIView {
 
     public let contentLayoutGuide = UILayoutGuide()
 
-    convenience public init(attachment: TextAttachment) {
+    // Only set in viewing contexts; spoilers can't be added when editing.
+    private let interactionIdentifier: InteractionSnapshotIdentifier?
+    private let spoilerState: SpoilerRenderState?
+
+    private var revealedSpoilerIds: Set<StyleIdType> {
+        guard let spoilerState, let interactionIdentifier else {
+            return Set()
+        }
+        return spoilerState.revealState.revealedSpoilerIds(interactionIdentifier: interactionIdentifier)
+    }
+
+    convenience public init(
+        attachment: TextAttachment,
+        interactionIdentifier: InteractionSnapshotIdentifier,
+        spoilerState: SpoilerRenderState
+    ) {
         self.init(
             textContent: attachment.textContent,
             textForegroundColor: attachment.textForegroundColor,
             textBackgroundColor: attachment.textBackgroundColor,
             background: attachment.background,
-            linkPreview: attachment.preview
+            linkPreview: attachment.preview,
+            interactionIdentifier: interactionIdentifier,
+            spoilerState: spoilerState
         )
     }
 
@@ -30,25 +47,54 @@ open class TextAttachmentView: UIView {
             textBackgroundColor: attachment.textBackgroundColor,
             background: attachment.background,
             linkPreview: nil,
-            linkPreviewDraft: attachment.linkPreviewDraft
+            linkPreviewDraft: attachment.linkPreviewDraft,
+            interactionIdentifier: nil,
+            spoilerState: nil
         )
     }
 
     public init(
-        textContent: TextAttachment.TextContent,
+        text: String,
+        style: TextAttachment.TextStyle,
         textForegroundColor: UIColor?,
         textBackgroundColor: UIColor?,
         background: TextAttachment.Background,
         linkPreview: OWSLinkPreview?,
         linkPreviewDraft: OWSLinkPreviewDraft? = nil
+    ) {
+        self.textContent = .styled(body: text, style: style)
+        self.textForegroundColor = textForegroundColor ?? Theme.darkThemePrimaryColor
+        self.textBackgroundColor = textBackgroundColor
+        self.background = background
+        self.interactionIdentifier = nil
+        self.spoilerState = nil
+
+        super.init(frame: .zero)
+        performSetup(linkPreview: linkPreview, linkPreviewDraft: linkPreviewDraft)
+    }
+
+    private init(
+        textContent: TextAttachment.TextContent,
+        textForegroundColor: UIColor?,
+        textBackgroundColor: UIColor?,
+        background: TextAttachment.Background,
+        linkPreview: OWSLinkPreview?,
+        linkPreviewDraft: OWSLinkPreviewDraft? = nil,
+        interactionIdentifier: InteractionSnapshotIdentifier?,
+        spoilerState: SpoilerRenderState?
     ) {
         self.textContent = textContent
         self.textForegroundColor = textForegroundColor ?? Theme.darkThemePrimaryColor
         self.textBackgroundColor = textBackgroundColor
         self.background = background
+        self.interactionIdentifier = interactionIdentifier
+        self.spoilerState = spoilerState
 
         super.init(frame: .zero)
+        performSetup(linkPreview: linkPreview, linkPreviewDraft: linkPreviewDraft)
+    }
 
+    private func performSetup(linkPreview: OWSLinkPreview?, linkPreviewDraft: OWSLinkPreviewDraft?) {
         clipsToBounds = true
 
         addLayoutGuide(contentLayoutGuide)
@@ -175,7 +221,7 @@ open class TextAttachmentView: UIView {
         var textAreaHeight: CGFloat = 0
 
         // Position text and/or link preview.
-        if let textLabel = textLabel, textContentSize.height > 0 {
+        if hasNonEmptyTextContent, textContentSize.height > 0 {
             textLabel.bounds.size = textContentSize
 
             let cappedTextContentHeight = min(textContentSize.height, maxTextAreaHeight - 2 * LayoutConstants.textBackgroundVMargin)
@@ -206,7 +252,7 @@ open class TextAttachmentView: UIView {
     }
 
     open func calculateTextContentSize() -> CGSize {
-        guard let textLabel = textLabel else {
+        guard hasNonEmptyTextContent else {
             return .zero
         }
 
@@ -227,8 +273,13 @@ open class TextAttachmentView: UIView {
         didSet { updateTextAttributes() }
     }
 
-    private var revealedSpoilerIds = Set<StyleIdType>() {
-        didSet { updateTextAttributes() }
+    public var hasNonEmptyTextContent: Bool {
+        switch textContent {
+        case .empty:
+            return false
+        case .styled, .styledRanges:
+            return true
+        }
     }
 
     private var tappableItems: [HydratedMessageBody.TappableItem]?
@@ -256,58 +307,47 @@ open class TextAttachmentView: UIView {
     public func updateTextAttributes() {
         defer { updateVisibilityOfComponents(animated: false) }
 
-        func loadTextLabel() -> UILabel {
-            if let existingLabel = self.textLabel {
-                return existingLabel
-            } else {
-                let textLabel = UILabel()
-                textLabel.adjustsFontSizeToFitWidth = true
-                textLabel.allowsDefaultTighteningForTruncation = true
-                textLabel.lineBreakMode = .byWordWrapping
-                textLabel.minimumScaleFactor = 0.2
-                textLabel.numberOfLines = 0
-                addSubview(textLabel)
-                self.textLabel = textLabel
-                return textLabel
-            }
-        }
-
-        let textLabel: UILabel
         switch textContent {
         case .empty:
             tappableItems = nil
+            textLabelSpoilerConfig.text = nil
             return
         case .styled(let text, let textStyle):
-            textLabel = loadTextLabel()
+            if textLabel.superview == nil { addSubview(textLabel) }
             let (fontPointSize, textAlignment) = sizeAndAlignment(forText: text)
             textLabel.text = transformedText(text, for: textStyle)
             textLabel.textAlignment = textAlignment
             textLabel.font = .font(for: textStyle, withPointSize: fontPointSize)
             textLabel.textColor = textForegroundColor
             tappableItems = nil
+            textLabelSpoilerConfig.text = nil
         case .styledRanges(let body):
-            textLabel = loadTextLabel()
+            if textLabel.superview == nil { addSubview(textLabel) }
             let (fontPointSize, textAlignment) = sizeAndAlignment(forText: body.text)
             let font = UIFont.font(for: .regular, withPointSize: fontPointSize)
 
-            self.tappableItems = body.asHydratedMessageBody().tappableItems(
-                revealedSpoilerIds: revealedSpoilerIds,
+            let displayConfig = HydratedMessageBody.DisplayConfiguration.textStory(
+                font: font,
+                textColor: textForegroundColor,
+                revealedSpoilerIds: self.revealedSpoilerIds
+            )
+            let hydratedBody = body.asHydratedMessageBody()
+            self.tappableItems = hydratedBody.tappableItems(
+                revealedSpoilerIds: displayConfig.style.revealedIds,
                 dataDetector: nil
             )
 
             let attrText = body.asAttributedStringForDisplay(
-                config: StyleDisplayConfiguration(
-                    baseFont: font,
-                    textColor: .fixed(textForegroundColor),
-                    revealAllIds: false,
-                    revealedIds: self.revealedSpoilerIds
-                ),
+                config: displayConfig.style,
                 isDarkThemeEnabled: Theme.isDarkThemeEnabled
             )
             textLabel.font = font
+            textLabel.textColor = textForegroundColor
             textLabel.attributedText = attrText
             textLabel.textAlignment = textAlignment
-            textLabel.textColor = textForegroundColor
+            textLabelSpoilerConfig.displayConfig = displayConfig
+            textLabelSpoilerConfig.text = .messageBody(hydratedBody)
+            textLabelSpoilerConfig.animator = spoilerState?.animator
         }
 
         if let textBackgroundColor = textBackgroundColor {
@@ -335,15 +375,32 @@ open class TextAttachmentView: UIView {
         let isEditing = isEditing
         switch textContent {
         case .styledRanges, .styled:
-            textLabel?.setIsHidden(isEditing, animated: animated)
+            textLabel.setIsHidden(isEditing, animated: animated)
             textBackgroundView?.setIsHidden(isEditing || textBackgroundColor == nil, animated: animated)
+            textLabelSpoilerConfig.isViewVisible = !isEditing
         case .empty:
-            textLabel?.setIsHidden(true, animated: animated)
+            textLabel.setIsHidden(true, animated: animated)
             textBackgroundView?.setIsHidden(true, animated: animated)
+            textLabelSpoilerConfig.isViewVisible = false
         }
     }
 
-    public private(set) var textLabel: UILabel?
+    private lazy var textLabel: UILabel = {
+        let textLabel = UILabel()
+        textLabel.adjustsFontSizeToFitWidth = true
+        textLabel.allowsDefaultTighteningForTruncation = true
+        textLabel.lineBreakMode = .byWordWrapping
+        textLabel.minimumScaleFactor = 0.2
+        textLabel.numberOfLines = 0
+        return textLabel
+    }()
+
+    private lazy var textLabelSpoilerConfig = SpoilerableTextConfig.Builder(isViewVisible: false) {
+        didSet {
+            textLabelSpoilerAnimator.updateAnimationState(textLabelSpoilerConfig)
+        }
+    }
+    private lazy var textLabelSpoilerAnimator = SpoilerableLabelAnimator(label: textLabel)
 
     public private(set) var textBackgroundView: UIView?
 
@@ -471,7 +528,9 @@ open class TextAttachmentView: UIView {
         // indexing, once we do custom spoiler animations.
         let labelLocation = gesture.location(in: textLabel)
         if
-            let textLabel,
+            hasNonEmptyTextContent,
+            let spoilerState,
+            let interactionIdentifier,
             textLabel.bounds.contains(labelLocation),
             let tapIndex = textLabel.characterIndex(of: labelLocation)
         {
@@ -488,7 +547,11 @@ open class TextAttachmentView: UIView {
                     $0.range.contains(tapIndex)
                 })
             if let spoilerItem {
-                revealedSpoilerIds.insert(spoilerItem.id)
+                spoilerState.revealState.setSpoilerRevealed(
+                    withID: spoilerItem.id,
+                    interactionIdentifier: interactionIdentifier
+                )
+                updateTextAttributes()
                 return true
             }
         }
