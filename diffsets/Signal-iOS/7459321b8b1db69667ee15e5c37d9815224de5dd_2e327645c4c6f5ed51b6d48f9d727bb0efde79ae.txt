diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
index 07ab763af69..bd8c1541dda 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
@@ -127,7 +127,7 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
             componentView.bodyMediaGradientView = gradientView
             gradientView.layer.addSublayer(gradientLayer)
             albumView.addSubview(gradientView)
-            stackView.layoutSubviewToFillSuperviewBounds(gradientView)
+            stackView.layoutSubviewToFillSuperviewEdges(gradientView)
         }
 
         // Only apply "inner shadow" for single media, not albums.
@@ -140,29 +140,27 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
                                                                         opacity: 0.15))
             componentView.innerShadowView = innerShadowView
             firstMediaView.addSubview(innerShadowView)
-            stackView.layoutSubviewToFillSuperviewBounds(innerShadowView)
+            stackView.layoutSubviewToFillSuperviewEdges(innerShadowView)
         }
 
         if hasDownloadButton {
-            // TODO: Convert to manual layout.
             let iconView = UIImageView.withTemplateImageName("arrow-down-24",
                                                              tintColor: UIColor.ows_white)
             if albumView.itemViews.count > 1 {
-                let downloadStack = UIStackView()
-                downloadStack.axis = .horizontal
-                downloadStack.alignment = .center
-                downloadStack.spacing = 8
-                downloadStack.layoutMargins = UIEdgeInsets(hMargin: 16, vMargin: 10)
-                downloadStack.isLayoutMarginsRelativeArrangement = true
-
-                let pillView = OWSLayerView.pillView()
+                let downloadStackConfig = ManualStackView.Config(axis: .horizontal,
+                                                                 alignment: .center,
+                                                                 spacing: 8,
+                                                                 layoutMargins: UIEdgeInsets(hMargin: 16, vMargin: 10))
+                let downloadStack = ManualStackView(name: "downloadStack")
+                downloadStack.apply(config: downloadStackConfig)
+                var subviewInfos = [ManualStackSubviewInfo]()
+
+                let pillView = ManualLayoutViewWithLayer.pillView(name: "pillView")
                 pillView.backgroundColor = UIColor.ows_black.withAlphaComponent(0.8)
-                downloadStack.addSubview(pillView)
-                // TODO:
-                pillView.autoPinEdgesToSuperviewEdges()
+                downloadStack.addSubviewToFillSuperviewEdges(pillView)
 
-                iconView.autoSetDimensions(to: CGSize.square(20))
                 downloadStack.addArrangedSubview(iconView)
+                subviewInfos.append(CGSize.square(20).asManualSubviewInfo(hasFixedSize: true))
 
                 let downloadLabel = UILabel()
                 let downloadFormat = (areAllItemsImages
@@ -170,22 +168,27 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
                                         comment: "Format for an indicator of the number of image items in a media gallery. Embeds {{ the number of items in the media gallery }}.")
                                         : NSLocalizedString("MEDIA_GALLERY_ITEM_MIXED_COUNT_FORMAT",
                                         comment: "Format for an indicator of the number of image or video items in a media gallery. Embeds {{ the number of items in the media gallery }}."))
-                downloadLabel.text = String(format: downloadFormat, OWSFormat.formatInt(albumView.itemViews.count))
-                downloadLabel.textColor = UIColor.ows_white
-                downloadLabel.font = .ows_dynamicTypeSubheadline
                 downloadStack.addArrangedSubview(downloadLabel)
-
-                stackView.addSubview(downloadStack)
-                // TODO:
-                downloadStack.autoCenterInSuperview()
+                let downloadLabelConfig = CVLabelConfig(text: String(format: downloadFormat,
+                                                                     OWSFormat.formatInt(albumView.itemViews.count)),
+                                                        font: .ows_dynamicTypeSubheadline,
+                                                        textColor: UIColor.ows_white)
+                downloadLabelConfig.applyForRendering(label: downloadLabel)
+                let downloadLabelSize = CVText.measureLabel(config: downloadLabelConfig,
+                                                            maxWidth: CGFloat.greatestFiniteMagnitude)
+                subviewInfos.append(downloadLabelSize.asManualSubviewInfo)
+
+                let downloadStackMeasurement = ManualStackView.measure(config: downloadStackConfig,
+                                                                       subviewInfos: subviewInfos)
+                downloadStack.measurement = downloadStackMeasurement
+                stackView.addSubviewToCenterOnSuperview(downloadStack,
+                                                        size: downloadStackMeasurement.measuredSize)
             } else {
                 let circleSize: CGFloat = 44
                 let circleView = OWSLayerView.circleView(size: circleSize)
                 circleView.backgroundColor = UIColor.ows_black.withAlphaComponent(0.8)
-                stackView.addSubview(circleView)
-                stackView.centerSubviewOnSuperview(circleView, size: .square(circleSize))
-                stackView.addSubview(iconView)
-                stackView.centerSubviewOnSuperview(iconView, size: .square(24))
+                stackView.addSubviewToCenterOnSuperview(circleView, size: .square(circleSize))
+                stackView.addSubviewToCenterOnSuperview(iconView, size: .square(24))
             }
 
             if mediaAlbumHasPendingAttachment {
@@ -194,12 +197,7 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
                 let totalSize = pendingManualDownloadAttachments.map { $0.byteCount}.reduce(0, +)
 
                 if totalSize > 0 {
-                    let downloadSizeView = OWSLayerView.pillView()
-                    downloadSizeView.backgroundColor = UIColor.ows_black.withAlphaComponent(0.8)
-                    downloadSizeView.layoutMargins = UIEdgeInsets(hMargin: 8, vMargin: 1)
-
                     var downloadSizeText = [OWSFormat.formatFileSize(UInt(totalSize))]
-
                     if pendingManualDownloadAttachments.count == 1,
                        let firstAttachmentPointer = pendingManualDownloadAttachments.first {
                         if firstAttachmentPointer.isAnimated {
@@ -211,18 +209,31 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
                         }
                     }
 
+                    let downloadSizeView = ManualLayoutViewWithLayer.pillView(name: "downloadSizeView")
+                    downloadSizeView.backgroundColor = UIColor.ows_black.withAlphaComponent(0.8)
+                    downloadSizeView.layoutMargins = UIEdgeInsets(hMargin: 8, vMargin: 1)
+
+                    let downloadSizeLabelConfig = CVLabelConfig(text: downloadSizeText.joined(separator: " • "),
+                                                                font: .ows_dynamicTypeCaption1,
+                                                                textColor: .ows_white)
                     let downloadSizeLabel = UILabel()
-                    downloadSizeLabel.text = downloadSizeText.joined(separator: " • ")
-                    downloadSizeLabel.textColor = UIColor.ows_white
-                    downloadSizeLabel.font = .ows_dynamicTypeCaption1
-                    downloadSizeView.addSubview(downloadSizeLabel)
-                    // TODO:
-                    downloadSizeLabel.autoPinEdgesToSuperviewMargins()
-
-                    componentView.rootView.addSubview(downloadSizeView)
-                    // TODO:
-                    downloadSizeView.autoPinEdge(toSuperviewEdge: .top, withInset: 9)
-                    downloadSizeView.autoPinEdge(toSuperviewEdge: .leading, withInset: 16)
+                    downloadSizeLabelConfig.applyForRendering(label: downloadSizeLabel)
+                    let downloadSizeLabelSize = CVText.measureLabel(config: downloadSizeLabelConfig,
+                                                                    maxWidth: .greatestFiniteMagnitude)
+                    downloadSizeView.addSubviewToFillSuperviewMargins(downloadSizeLabel)
+
+                    let downloadSizeViewSize = downloadSizeLabelSize + downloadSizeView.layoutMargins.asSize
+                    stackView.addSubview(downloadSizeView)
+                    stackView.addLayoutBlock { view in
+                        let hInset: CGFloat = 16
+                        let x = (CurrentAppContext().isRTL
+                                    ? view.width - (downloadSizeViewSize.width - hInset)
+                                    : hInset)
+                        downloadSizeView.frame = CGRect(x: x,
+                                                        y: 9,
+                                                        width: downloadSizeViewSize.width,
+                                                        height: downloadSizeViewSize.height)
+                    }
                 }
             }
         }
diff --git a/Signal/src/ViewControllers/ConversationView/Cells/CVMediaAlbumView.swift b/Signal/src/ViewControllers/ConversationView/Cells/CVMediaAlbumView.swift
index f59d11789dd..04e8a469cad 100644
--- a/Signal/src/ViewControllers/ConversationView/Cells/CVMediaAlbumView.swift
+++ b/Signal/src/ViewControllers/ConversationView/Cells/CVMediaAlbumView.swift
@@ -61,7 +61,6 @@ public class CVMediaAlbumView: ManualStackViewWithLayer {
         }
         self.isBorderless = isBorderless
         self.backgroundColor = isBorderless ? .clear : Theme.backgroundColor
-        self.translatesAutoresizingMaskIntoConstraints = false
 
         createContents(imageArrangement: imageArrangement,
                        cellMeasurement: cellMeasurement)
@@ -115,7 +114,7 @@ public class CVMediaAlbumView: ManualStackViewWithLayer {
                 let tintView = UIView()
                 tintView.backgroundColor = UIColor(white: 0, alpha: 0.4)
                 lastView.addSubview(tintView)
-                subStack2.layoutSubviewToFillSuperviewBounds(tintView)
+                subStack2.layoutSubviewToFillSuperviewEdges(tintView)
 
                 let moreCount = max(1, items.count - CVMediaAlbumView.kMaxItems)
                 let moreCountText = OWSFormat.formatInt(moreCount)
@@ -172,9 +171,16 @@ public class CVMediaAlbumView: ManualStackViewWithLayer {
             }
             let iconView = CVImageView(image: icon)
             itemView.addSubview(iconView)
-            itemView.layoutMargins = .zero
-            iconView.autoPinTopToSuperviewMargin(withInset: 6)
-            iconView.autoPinLeadingToSuperviewMargin(withInset: 6)
+            itemView.addLayoutBlock { view in
+                let inset: CGFloat = 6
+                let x = (CurrentAppContext().isRTL
+                            ? view.width - (icon.size.width + inset)
+                            : inset)
+                iconView.frame = CGRect(x: x,
+                                        y: inset,
+                                        width: icon.size.width,
+                                        height: icon.size.height)
+            }
         }
     }
 
diff --git a/Signal/src/ViewControllers/ConversationView/Cells/CVMediaView.swift b/Signal/src/ViewControllers/ConversationView/Cells/CVMediaView.swift
index 3377b4a907c..8a272128d03 100644
--- a/Signal/src/ViewControllers/ConversationView/Cells/CVMediaView.swift
+++ b/Signal/src/ViewControllers/ConversationView/Cells/CVMediaView.swift
@@ -220,7 +220,7 @@ public class CVMediaView: ManualLayoutViewWithLayer {
         playVideoCircleView.backgroundColor = UIColor.ows_black.withAlphaComponent(0.7)
         playVideoCircleView.isUserInteractionEnabled = false
         playVideoButton.addSubview(playVideoCircleView)
-        layoutSubviewToFillSuperviewBounds(playVideoCircleView)
+        layoutSubviewToFillSuperviewEdges(playVideoCircleView)
 
         let playVideoIconView = CVImageView()
         playVideoIconView.setTemplateImageName("play-solid-32",
@@ -259,6 +259,10 @@ public class CVMediaView: ManualLayoutViewWithLayer {
         guard let reusableMediaView = reusableMediaView else {
             return
         }
+        guard reusableMediaView.owner != nil else {
+            Logger.warn("No longer owner of reusableMediaView.")
+            return
+        }
         guard reusableMediaView.owner == self else {
             owsFailDebug("No longer owner of reusableMediaView.")
             return
diff --git a/Signal/src/ViewControllers/ConversationView/Cells/MessageSelectionView.swift b/Signal/src/ViewControllers/ConversationView/Cells/MessageSelectionView.swift
index 16458e70a17..5fb280ded71 100644
--- a/Signal/src/ViewControllers/ConversationView/Cells/MessageSelectionView.swift
+++ b/Signal/src/ViewControllers/ConversationView/Cells/MessageSelectionView.swift
@@ -52,7 +52,7 @@ public class MessageSelectionView: ManualLayoutView {
         let imageView = CVImageView(image: image)
         imageView.tintColor = .ows_accentBlue
         wrapper.addSubview(imageView)
-        wrapper.layoutSubviewToFillSuperviewBounds(imageView)
+        wrapper.layoutSubviewToFillSuperviewEdges(imageView)
 
         return wrapper
     }()
diff --git a/SignalMessaging/Views/ManualLayoutView.swift b/SignalMessaging/Views/ManualLayoutView.swift
index 9cb69f4d23b..3e603929a42 100644
--- a/SignalMessaging/Views/ManualLayoutView.swift
+++ b/SignalMessaging/Views/ManualLayoutView.swift
@@ -258,10 +258,27 @@ open class ManualLayoutView: UIView {
 
         addSubview(subview)
 
-        layoutSubviewToFillSuperviewBounds(subview)
+        layoutSubviewToFillSuperviewEdges(subview)
     }
 
-    public func layoutSubviewToFillSuperviewBounds(_ subview: UIView) {
+    public func layoutSubviewToFillSuperviewEdges(_ subview: UIView) {
+        layoutSubviewToFillSuperview(subview, honorLayoutsMargins: false)
+    }
+
+    public func addSubviewToFillSuperviewMargins(_ subview: UIView) {
+        owsAssertDebug(subview.superview == nil)
+
+        addSubview(subview)
+
+        layoutSubviewToFillSuperviewMargins(subview)
+    }
+
+    public func layoutSubviewToFillSuperviewMargins(_ subview: UIView) {
+        layoutSubviewToFillSuperview(subview, honorLayoutsMargins: true)
+    }
+
+    public func layoutSubviewToFillSuperview(_ subview: UIView,
+                                             honorLayoutsMargins: Bool) {
         owsAssertDebug(subview.superview != nil)
 
         subview.translatesAutoresizingMaskIntoConstraints = false
@@ -272,7 +289,11 @@ open class ManualLayoutView: UIView {
                 return
             }
 
-            Self.setSubviewFrame(subview: subview, frame: superview.bounds)
+            var subviewFrame = superview.bounds
+            if honorLayoutsMargins {
+                subviewFrame = subviewFrame.inset(by: superview.layoutMargins)
+            }
+            Self.setSubviewFrame(subview: subview, frame: subviewFrame)
         }
     }
 
