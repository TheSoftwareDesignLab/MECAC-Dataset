diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index df75fb729c..70990ba9db 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -1467,6 +1467,7 @@
 		76BB06FA29AD84DB00978856 /* MediaItemViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76BB06F929AD84DB00978856 /* MediaItemViewController.swift */; };
 		76C87F19181EFCE600C4ACAB /* MediaPlayer.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 76C87F18181EFCE600C4ACAB /* MediaPlayer.framework */; };
 		76C87FE128BE8E2400BD8709 /* LinkPreviewAttachmentViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76C87FE028BE8E2400BD8709 /* LinkPreviewAttachmentViewController.swift */; };
+		76CDEB192EAD982000ADCCD6 /* ConversationBottomPanelView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76CDEB182EAD980F00ADCCD6 /* ConversationBottomPanelView.swift */; };
 		76DFBF8C29AE6B80004A771D /* MediaTransitionImageView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76DFBF8B29AE6B80004A771D /* MediaTransitionImageView.swift */; };
 		76E02C1A2A0A1931008BC372 /* DebugUISessionState.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76E02C192A0A1931008BC372 /* DebugUISessionState.swift */; };
 		76E02C1E2A0A1ADD008BC372 /* DebugUIPage.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76E02C1D2A0A1ADD008BC372 /* DebugUIPage.swift */; };
@@ -5358,6 +5359,7 @@
 		76BB06F929AD84DB00978856 /* MediaItemViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MediaItemViewController.swift; sourceTree = "<group>"; };
 		76C87F18181EFCE600C4ACAB /* MediaPlayer.framework */ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = MediaPlayer.framework; path = System/Library/Frameworks/MediaPlayer.framework; sourceTree = SDKROOT; };
 		76C87FE028BE8E2400BD8709 /* LinkPreviewAttachmentViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = LinkPreviewAttachmentViewController.swift; sourceTree = "<group>"; };
+		76CDEB182EAD980F00ADCCD6 /* ConversationBottomPanelView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ConversationBottomPanelView.swift; sourceTree = "<group>"; };
 		76DFBF8B29AE6B80004A771D /* MediaTransitionImageView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MediaTransitionImageView.swift; sourceTree = "<group>"; };
 		76E02C192A0A1931008BC372 /* DebugUISessionState.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = DebugUISessionState.swift; sourceTree = "<group>"; };
 		76E02C1D2A0A1ADD008BC372 /* DebugUIPage.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = DebugUIPage.swift; sourceTree = "<group>"; };
@@ -8167,6 +8169,7 @@
 				45A1684C2A1C308800C2432D /* AudioPresentation.swift */,
 				3491899A269CD68D008A18AF /* BlockingAnnouncementOnlyView.swift */,
 				347DE5BB2548967900C32CDC /* BlockingLegacyGroupView.swift */,
+				76CDEB182EAD980F00ADCCD6 /* ConversationBottomPanelView.swift */,
 				3457794226828A9A00732869 /* ConversationCollectionView.swift */,
 				45DDA6232090CEB500DE97F8 /* ConversationHeaderView.swift */,
 				8851DB4224CCF0EB001EACD2 /* ConversationInputTextView.swift */,
@@ -16926,6 +16929,7 @@
 				F0B872B6269CF6D900D26481 /* ContextMenuInteraction.swift in Sources */,
 				F0EE4DB626A7AC18001DE4ED /* ContextMenuReactionBarAccessory.swift in Sources */,
 				B94E922D2E381478007BA81B /* ContextualActionBuilder.swift in Sources */,
+				76CDEB192EAD982000ADCCD6 /* ConversationBottomPanelView.swift in Sources */,
 				3457794326828A9A00732869 /* ConversationCollectionView.swift in Sources */,
 				34E20D4C24256563002C011E /* ConversationHeaderBuilder.swift in Sources */,
 				45DDA6242090CEB500DE97F8 /* ConversationHeaderView.swift in Sources */,
diff --git a/Signal/ConversationView/BlockingAnnouncementOnlyView.swift b/Signal/ConversationView/BlockingAnnouncementOnlyView.swift
index 32058abe9b..1b5cd6a232 100644
--- a/Signal/ConversationView/BlockingAnnouncementOnlyView.swift
+++ b/Signal/ConversationView/BlockingAnnouncementOnlyView.swift
@@ -6,7 +6,7 @@
 import SignalServiceKit
 import SignalUI
 
-class BlockingAnnouncementOnlyView: UIStackView {
+class BlockingAnnouncementOnlyView: ConversationBottomPanelView {
 
     private let thread: TSThread
     private let forceDarkMode: Bool
@@ -25,26 +25,9 @@ class BlockingAnnouncementOnlyView: UIStackView {
 
         super.init(frame: .zero)
 
-        createDefaultContents()
-    }
-
-    private func createDefaultContents() {
-        // We want the background to extend to the bottom of the screen
-        // behind the safe area, so we add that inset to our bottom inset
-        // instead of pinning this view to the safe area
-        let safeAreaInset = safeAreaInsets.bottom
-
-        autoresizingMask = .flexibleHeight
-
-        axis = .vertical
-        spacing = 11
-        layoutMargins = UIEdgeInsets(top: 16, leading: 16, bottom: 20 + safeAreaInset, trailing: 16)
-        isLayoutMarginsRelativeArrangement = true
-        alignment = .fill
-
-        let blurView = UIVisualEffectView(effect: forceDarkMode ? Theme.darkThemeBarBlurEffect : Theme.barBlurEffect)
-        addSubview(blurView)
-        blurView.autoPinEdgesToSuperviewEdges()
+        if forceDarkMode {
+            overrideUserInterfaceStyle = .dark
+        }
 
         let format = OWSLocalizedString("GROUPS_ANNOUNCEMENT_ONLY_BLOCKING_SEND_OR_CALL_FORMAT",
                                        comment: "Format for indicator that only group administrators can starts a group call and sends messages to an 'announcement-only' group. Embeds {{ a \"admins\" link. }}.")
@@ -52,28 +35,26 @@ class BlockingAnnouncementOnlyView: UIStackView {
                                            comment: "Label for group administrators in the 'announcement-only' group UI.")
         let text = String(format: format, adminsText)
         let attributedString = NSMutableAttributedString(string: text)
-        attributedString.setAttributes([
-            .foregroundColor: forceDarkMode ? .ows_accentBlueDark : Theme.accentBlueColor
-        ],
-        forSubstring: adminsText)
+        attributedString.setAttributes([ .foregroundColor: UIColor.Signal.link ], forSubstring: adminsText)
 
         let label = UILabel()
         label.font = .dynamicTypeSubheadlineClamped
-        label.textColor = forceDarkMode ? Theme.darkThemeSecondaryTextAndIconColor : Theme.secondaryTextAndIconColor
+        label.textColor = .Signal.secondaryLabel
         label.attributedText = attributedString
         label.textAlignment = .center
         label.numberOfLines = 0
         label.lineBreakMode = .byWordWrapping
         label.isUserInteractionEnabled = true
         label.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(didTapContactAdmins)))
-        addArrangedSubview(label)
-
-        let lineView = UIView()
-        lineView.backgroundColor = forceDarkMode ? .ows_gray75 : Theme.hairlineColor
-        addSubview(lineView)
-        lineView.autoSetDimension(.height, toSize: 1)
-        lineView.autoPinWidthToSuperview()
-        lineView.autoPinEdge(toSuperviewEdge: .top)
+        label.translatesAutoresizingMaskIntoConstraints = false
+        contentView.addSubview(label)
+
+        addConstraints([
+            label.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor),
+            label.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor),
+            label.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor),
+            label.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor),
+        ])
     }
 
     private func fetchGroupAdminAddresses(tx: DBReadTransaction) -> [SignalServiceAddress] {
@@ -95,10 +76,6 @@ class BlockingAnnouncementOnlyView: UIStackView {
         fatalError("init(coder:) has not been implemented")
     }
 
-    override var intrinsicContentSize: CGSize {
-        return .zero
-    }
-
     // MARK: -
 
     @objc
diff --git a/Signal/ConversationView/BlockingLegacyGroupView.swift b/Signal/ConversationView/BlockingLegacyGroupView.swift
index 036bb3c881..412c556306 100644
--- a/Signal/ConversationView/BlockingLegacyGroupView.swift
+++ b/Signal/ConversationView/BlockingLegacyGroupView.swift
@@ -6,7 +6,7 @@
 import SignalServiceKit
 import SignalUI
 
-class BlockingLegacyGroupView: UIStackView {
+class BlockingLegacyGroupView: ConversationBottomPanelView {
 
     private weak var fromViewController: UIViewController?
 
@@ -15,28 +15,6 @@ class BlockingLegacyGroupView: UIStackView {
 
         super.init(frame: .zero)
 
-        createContents()
-    }
-
-    private func createContents() {
-        // We want the background to extend to the bottom of the screen
-        // behind the safe area, so we add that inset to our bottom inset
-        // instead of pinning this view to the safe area
-        let safeAreaInset = safeAreaInsets.bottom
-
-        autoresizingMask = .flexibleHeight
-
-        axis = .vertical
-        spacing = 11
-        layoutMargins = UIEdgeInsets(top: 16, leading: 16, bottom: 20 + safeAreaInset, trailing: 16)
-        isLayoutMarginsRelativeArrangement = true
-        alignment = .fill
-
-        let backgroundView = UIView()
-        backgroundView.backgroundColor = Theme.backgroundColor
-        addSubview(backgroundView)
-        backgroundView.autoPinEdgesToSuperviewEdges()
-
         let format = OWSLocalizedString(
             "LEGACY_GROUP_UNSUPPORTED_MESSAGE",
             comment: "Message explaining that this group can no longer be used because it is unsupported. Embeds a {{ learn more link }}."
@@ -45,30 +23,34 @@ class BlockingLegacyGroupView: UIStackView {
 
         let attributedString = NSMutableAttributedString(string: String(format: format, learnMoreText))
         attributedString.setAttributes(
-            [.foregroundColor: Theme.accentBlueColor],
+            [.foregroundColor: UIColor.Signal.link],
             forSubstring: learnMoreText
         )
 
         let label = UILabel()
         label.font = .dynamicTypeSubheadlineClamped
-        label.textColor = Theme.secondaryTextAndIconColor
+        label.textColor = .Signal.secondaryLabel
         label.attributedText = attributedString
         label.numberOfLines = 0
         label.lineBreakMode = .byWordWrapping
         label.textAlignment = .center
         label.isUserInteractionEnabled = true
         label.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(didTapLearnMore)))
-        addArrangedSubview(label)
+        label.translatesAutoresizingMaskIntoConstraints = false
+        contentView.addSubview(label)
+
+        addConstraints([
+            label.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor),
+            label.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor),
+            label.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor),
+            label.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor),
+        ])
     }
 
     required init(coder: NSCoder) {
         fatalError("init(coder:) has not been implemented")
     }
 
-    override var intrinsicContentSize: CGSize {
-        return .zero
-    }
-
     @objc
     public func didTapLearnMore() {
         guard let fromViewController = self.fromViewController else {
diff --git a/Signal/ConversationView/CVViewState.swift b/Signal/ConversationView/CVViewState.swift
index 128820a13b..22a64e6b80 100644
--- a/Signal/ConversationView/CVViewState.swift
+++ b/Signal/ConversationView/CVViewState.swift
@@ -23,7 +23,7 @@ public class CVViewState: NSObject {
     public var inputToolbar: ConversationInputToolbar?
     public let headerView = ConversationHeaderView()
 
-    public var bottomBar = UIView.container()
+    public var bottomBarContainer = UIView.container()
     public var requestView: UIView?
     public var bannerView: UIView?
     public var groupNameCollisionFinder: GroupMembershipNameCollisionFinder?
@@ -195,8 +195,8 @@ extension ConversationViewController {
         set { viewState.inputToolbar = newValue }
     }
 
-    var bottomBar: UIView {
-        viewState.bottomBar
+    var bottomBarContainer: UIView {
+        viewState.bottomBarContainer
     }
 
     var requestView: UIView? {
diff --git a/Signal/ConversationView/ConversationBottomPanelView.swift b/Signal/ConversationView/ConversationBottomPanelView.swift
new file mode 100644
index 0000000000..a6a87eb792
--- /dev/null
+++ b/Signal/ConversationView/ConversationBottomPanelView.swift
@@ -0,0 +1,48 @@
+//
+// Copyright 2025 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import SignalUI
+
+class ConversationBottomPanelView: UIView {
+
+    /// Subclasses must add content here.
+    var contentView: UIView {
+        backgroundView.contentView
+    }
+
+    /// Subclasses must constrain their content to this layout guide.
+    let contentLayoutGuide = UILayoutGuide()
+
+    private lazy var backgroundView = UIVisualEffectView(effect: UIBlurEffect(style: .prominent))
+
+    override init(frame: CGRect) {
+        super.init(frame: frame)
+
+        directionalLayoutMargins = .init(hMargin: 16, vMargin: 16)
+
+        addLayoutGuide(contentLayoutGuide)
+
+        addSubview(backgroundView)
+        backgroundView.translatesAutoresizingMaskIntoConstraints = false
+        addConstraints([
+            backgroundView.topAnchor.constraint(equalTo: topAnchor),
+            backgroundView.leadingAnchor.constraint(equalTo: leadingAnchor),
+            backgroundView.trailingAnchor.constraint(equalTo: trailingAnchor),
+            backgroundView.bottomAnchor.constraint(equalTo: bottomAnchor),
+
+            contentLayoutGuide.topAnchor.constraint(equalTo: layoutMarginsGuide.topAnchor),
+            contentLayoutGuide.leadingAnchor.constraint(equalTo: layoutMarginsGuide.leadingAnchor),
+            contentLayoutGuide.trailingAnchor.constraint(equalTo: layoutMarginsGuide.trailingAnchor),
+            contentLayoutGuide.bottomAnchor.constraint(
+                equalTo: safeAreaLayoutGuide.bottomAnchor,
+                constant: UIDevice.current.hasIPhoneXNotch ? 0 : -12
+            )
+        ])
+    }
+
+    required init?(coder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
+}
diff --git a/Signal/ConversationView/ConversationInputToolbar.swift b/Signal/ConversationView/ConversationInputToolbar.swift
index fcdb4ddea6..73308b9788 100644
--- a/Signal/ConversationView/ConversationInputToolbar.swift
+++ b/Signal/ConversationView/ConversationInputToolbar.swift
@@ -62,7 +62,12 @@ protocol ConversationInputToolbarDelegate: AnyObject {
     func showUnblockConversationUI(completion: ((Bool) -> Void)?)
 }
 
-public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
+protocol ConversationInputPanelWithContentLayoutGuide {
+    /// View controller should use this layout guide to position content above the keyboard.
+    var contentLayoutGuide: UILayoutGuide { get }
+}
+
+public class ConversationInputToolbar: UIView, ConversationInputPanelWithContentLayoutGuide, QuotedReplyPreviewDelegate {
 
     private let spoilerState: SpoilerRenderState
 
@@ -70,6 +75,8 @@ public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
 
     private weak var inputToolbarDelegate: ConversationInputToolbarDelegate?
 
+    public let contentLayoutGuide = UILayoutGuide()
+
     init(
         spoilerState: SpoilerRenderState,
         mediaCache: CVMediaCache,
@@ -117,12 +124,6 @@ public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
 
     // MARK: Layout
 
-    public override var intrinsicContentSize: CGSize {
-        // Since we have `self.autoresizingMask = UIViewAutoresizingFlexibleHeight`, we must specify
-        // an intrinsicContentSize. Specifying CGSize.zero causes the height to be determined by autolayout.
-        .zero
-    }
-
     public override var frame: CGRect {
         didSet {
             guard oldValue.size.height != frame.size.height else { return }
@@ -515,7 +516,18 @@ public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
         // to ensure horizontal stack views layout left-to-right.
         semanticContentAttribute = .forceLeftToRight
 
-        autoresizingMask = .flexibleHeight
+        // `contentLayoutGuide` defines area where all the content lives.
+        addLayoutGuide(contentLayoutGuide)
+        addConstraints([
+            contentLayoutGuide.topAnchor.constraint(equalTo: topAnchor),
+            contentLayoutGuide.leadingAnchor.constraint(equalTo: leadingAnchor),
+            contentLayoutGuide.trailingAnchor.constraint(equalTo: trailingAnchor),
+            {
+                let c = contentLayoutGuide.bottomAnchor.constraint(equalTo: safeAreaLayoutGuide.bottomAnchor)
+                c.priority = .defaultLow
+                return c
+            }()
+        ])
 
         // "Suggested Stickers" horizontal list view will be placed in a wrapper view to allow for slide in / slide out animation.
         updateSuggestedStickersPanelConstraints()
@@ -550,24 +562,21 @@ public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
         outerVStackSuperview.addSubview(outerVStack)
         outerVStack.translatesAutoresizingMaskIntoConstraints = false
         NSLayoutConstraint.activate([
-            outerVStack.topAnchor.constraint(equalTo: outerVStackSuperview.topAnchor),
-            outerVStack.leadingAnchor.constraint(equalTo: outerVStackSuperview.leadingAnchor),
-            outerVStack.trailingAnchor.constraint(equalTo: outerVStackSuperview.trailingAnchor),
-            outerVStack.bottomAnchor.constraint(equalTo: outerVStackSuperview.safeAreaLayoutGuide.bottomAnchor),
+            outerVStack.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor),
+            outerVStack.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor),
+            outerVStack.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor),
+            outerVStack.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor),
         ])
 
         // Background needed on pre-iOS 26 devices.
+        // Background is constrained to `contentViewWrapperView` on all edges except for bottom.
+        // Background is constrained to `self.bottom` to cover any safe area gaps.
         if !iOS26Layout {
-            // When presenting or dismissing the keyboard, there may be a slight
-            // gap between the keyboard and the bottom of the input bar during
-            // the animation. Extend the background below the toolbar's bounds
-            // by this much to mask that extra space.
-            let backgroundExtension: CGFloat = 500
-            let extendedBackgroundView = UIView()
+            let backgroundView = UIView()
             if UIAccessibility.isReduceTransparencyEnabled {
-                extendedBackgroundView.backgroundColor = Theme.toolbarBackgroundColor
+                backgroundView.backgroundColor = Theme.toolbarBackgroundColor
             } else {
-                extendedBackgroundView.backgroundColor = Theme.toolbarBackgroundColor.withAlphaComponent(OWSNavigationBar.backgroundBlurMutingFactor)
+                backgroundView.backgroundColor = Theme.toolbarBackgroundColor.withAlphaComponent(OWSNavigationBar.backgroundBlurMutingFactor)
 
                 let blurEffectView = UIVisualEffectView(effect: Theme.barBlurEffect)
                 // Alter the visual effect view's tint to match our background color
@@ -577,24 +586,25 @@ public class ConversationInputToolbar: UIView, QuotedReplyPreviewDelegate {
                 if let tintingView = blurEffectView.subviews.first(where: {
                     String(describing: type(of: $0)) == "_UIVisualEffectSubview"
                 }) {
-                    tintingView.backgroundColor = extendedBackgroundView.backgroundColor
+                    tintingView.backgroundColor = backgroundView.backgroundColor
                 }
-                extendedBackgroundView.addSubview(blurEffectView)
+                backgroundView.addSubview(blurEffectView)
                 blurEffectView.translatesAutoresizingMaskIntoConstraints = false
                 NSLayoutConstraint.activate([
-                    blurEffectView.topAnchor.constraint(equalTo: extendedBackgroundView.topAnchor),
-                    blurEffectView.leadingAnchor.constraint(equalTo: extendedBackgroundView.leadingAnchor),
-                    blurEffectView.trailingAnchor.constraint(equalTo: extendedBackgroundView.trailingAnchor),
-                    blurEffectView.bottomAnchor.constraint(equalTo: extendedBackgroundView.bottomAnchor),
+                    blurEffectView.topAnchor.constraint(equalTo: backgroundView.topAnchor),
+                    blurEffectView.leadingAnchor.constraint(equalTo: backgroundView.leadingAnchor),
+                    blurEffectView.trailingAnchor.constraint(equalTo: backgroundView.trailingAnchor),
+                    blurEffectView.bottomAnchor.constraint(equalTo: backgroundView.bottomAnchor),
                 ])
             }
-            contentViewWrapperView.addSubview(extendedBackgroundView)
-            extendedBackgroundView.translatesAutoresizingMaskIntoConstraints = false
+            contentViewWrapperView.addSubview(backgroundView)
+            backgroundView.translatesAutoresizingMaskIntoConstraints = false
             NSLayoutConstraint.activate([
-                extendedBackgroundView.topAnchor.constraint(equalTo: contentViewWrapperView.topAnchor),
-                extendedBackgroundView.leadingAnchor.constraint(equalTo: contentViewWrapperView.leadingAnchor),
-                extendedBackgroundView.trailingAnchor.constraint(equalTo: contentViewWrapperView.trailingAnchor),
-                extendedBackgroundView.bottomAnchor.constraint(equalTo: contentViewWrapperView.bottomAnchor, constant: backgroundExtension)
+                backgroundView.topAnchor.constraint(equalTo: contentViewWrapperView.topAnchor),
+                backgroundView.leadingAnchor.constraint(equalTo: contentViewWrapperView.leadingAnchor),
+                backgroundView.trailingAnchor.constraint(equalTo: contentViewWrapperView.trailingAnchor),
+                // Note different anchor here.
+                backgroundView.bottomAnchor.constraint(equalTo: bottomAnchor),
             ])
         }
 
diff --git a/Signal/ConversationView/ConversationViewController+BodyRangesTextViewDelegate.swift b/Signal/ConversationView/ConversationViewController+BodyRangesTextViewDelegate.swift
index d3afa9890e..c16d7c5998 100644
--- a/Signal/ConversationView/ConversationViewController+BodyRangesTextViewDelegate.swift
+++ b/Signal/ConversationView/ConversationViewController+BodyRangesTextViewDelegate.swift
@@ -18,7 +18,7 @@ extension ConversationViewController: BodyRangesTextViewDelegate {
     }
 
     public func textViewMentionPickerReferenceView(_ textView: BodyRangesTextView) -> UIView? {
-        bottomBar
+        bottomBarContainer
     }
 
     public func textViewMentionPickerPossibleAddresses(_ textView: BodyRangesTextView, tx: DBReadTransaction) -> [SignalServiceAddress] {
diff --git a/Signal/ConversationView/ConversationViewController+BottomBar.swift b/Signal/ConversationView/ConversationViewController+BottomBar.swift
index ae8600e23b..480f45b5ed 100644
--- a/Signal/ConversationView/ConversationViewController+BottomBar.swift
+++ b/Signal/ConversationView/ConversationViewController+BottomBar.swift
@@ -128,16 +128,21 @@ public extension ConversationViewController {
             bottomView = announcementOnlyView
         }
 
-        bottomBar.removeAllSubviews()
+        bottomBarContainer.removeAllSubviews()
 
         if let bottomView {
-            bottomBar.addSubview(bottomView)
-            bottomView.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .bottom)
-            if bottomView is UIToolbar {
-                // UIToolbar will extend its background to cover bottom safe area. 
-                bottomView.autoPinEdge(toSuperviewSafeArea: .bottom)
-            } else {
-                bottomView.autoPinEdge(toSuperviewEdge: .bottom)
+            bottomView.translatesAutoresizingMaskIntoConstraints = false
+            bottomBarContainer.addSubview(bottomView)
+            bottomBarContainer.addConstraints([
+                bottomView.topAnchor.constraint(equalTo: bottomBarContainer.topAnchor),
+                bottomView.leadingAnchor.constraint(equalTo: bottomBarContainer.leadingAnchor),
+                bottomView.trailingAnchor.constraint(equalTo: bottomBarContainer.trailingAnchor),
+                bottomView.bottomAnchor.constraint(equalTo: bottomBarContainer.bottomAnchor),
+            ])
+            if let viewWithContentLayoutGuide = bottomView as? ConversationInputPanelWithContentLayoutGuide {
+                NSLayoutConstraint.activate([
+                    viewWithContentLayoutGuide.contentLayoutGuide.bottomAnchor.constraint(equalTo: keyboardLayoutGuide.topAnchor)
+                ])
             }
         }
 
diff --git a/Signal/ConversationView/ConversationViewController+OWS.swift b/Signal/ConversationView/ConversationViewController+OWS.swift
index a9b9666db6..a21494c686 100644
--- a/Signal/ConversationView/ConversationViewController+OWS.swift
+++ b/Signal/ConversationView/ConversationViewController+OWS.swift
@@ -78,7 +78,7 @@ extension ConversationViewController {
         AssertIsOnMainThread()
 
         // Don't update the content insets if an interactive pop is in progress
-        guard let navigationController = self.navigationController else {
+        guard let navigationController else {
             return
         }
         if let interactivePopGestureRecognizer = navigationController.interactivePopGestureRecognizer {
@@ -95,7 +95,7 @@ extension ConversationViewController {
         let oldInsets = collectionView.contentInset
         var newInsets = oldInsets
 
-        newInsets.bottom = keyboardLayoutGuide.layoutFrame.height - view.safeAreaInsets.bottom + (bottomBar.frame.height - bottomBar.safeAreaInsets.bottom)
+        newInsets.bottom = bottomBarContainer.frame.height - bottomBarContainer.safeAreaInsets.bottom
         newInsets.top = (bannerView?.height ?? 0)
 
         let wasScrolledToBottom = self.isScrolledToBottom
@@ -115,12 +115,15 @@ extension ConversationViewController {
             self.collectionView.scrollIndicatorInsets = newInsets
         }
 
+        // If content inset didn't change, no need to update content offset.
+        guard didChangeInsets else { return }
+
+        // UIKit updates collection view's scroll position when user drags with the keyboard
+        // We don't need to do anything.
+        guard !collectionView.isDragging else { return }
+
         // Adjust content offset to prevent the presented keyboard from obscuring content.
-        if !didChangeInsets {
-            // Do nothing.
-            //
-            // If content inset didn't change, no need to update content offset.
-        } else if !hasAppearedAndHasAppliedFirstLoad {
+        if !hasAppearedAndHasAppliedFirstLoad {
             // Do nothing.
         } else if isPresentingContextMenu {
             // Do nothing
diff --git a/Signal/ConversationView/ConversationViewController+UIScrollView.swift b/Signal/ConversationView/ConversationViewController+UIScrollView.swift
index 79ed51cdc7..c7003145f0 100644
--- a/Signal/ConversationView/ConversationViewController+UIScrollView.swift
+++ b/Signal/ConversationView/ConversationViewController+UIScrollView.swift
@@ -283,7 +283,7 @@ extension ConversationViewController {
         view.addSubview(scrollDownButton)
         scrollDownButton.accessibilityIdentifier = "scrollDownButton"
 
-        scrollDownButton.autoPinEdge(.bottom, to: .top, of: bottomBar, withOffset: -24)
+        scrollDownButton.autoPinEdge(.bottom, to: .top, of: bottomBarContainer, withOffset: -24)
         scrollDownButton.autoPinEdge(toSuperviewSafeArea: .trailing, withInset: 15)
 
         scrollToNextMentionButton.addTarget(self, action: #selector(scrollToNextMentionButtonTapped), for: .touchUpInside)
diff --git a/Signal/ConversationView/ConversationViewController.swift b/Signal/ConversationView/ConversationViewController.swift
index d62daff3ff..681c692c78 100644
--- a/Signal/ConversationView/ConversationViewController.swift
+++ b/Signal/ConversationView/ConversationViewController.swift
@@ -262,11 +262,18 @@ public final class ConversationViewController: OWSViewController {
         backgroundContainer.autoPinEdgesToSuperviewEdges()
         setUpWallpaper()
 
-        self.view.addSubview(bottomBar)
-        bottomBar.autoPinWidthToSuperview()
-        NSLayoutConstraint.activate([
-            bottomBar.bottomAnchor.constraint(equalTo: keyboardLayoutGuide.topAnchor)
-        ])
+        self.view.addSubview(bottomBarContainer)
+        bottomBarContainer.autoPinWidthToSuperview()
+        bottomBarContainer.autoPinEdge(toSuperviewEdge: .bottom)
+#if compiler(>=6.2)
+        // Obscures content underneath bottom bar to improve legibility.
+        if #available(iOS 26, *) {
+            let scrollInteraction = UIScrollEdgeElementContainerInteraction()
+            scrollInteraction.scrollView = collectionView
+            scrollInteraction.edge = .bottom
+            bottomBarContainer.addInteraction(scrollInteraction)
+        }
+#endif
 
         self.selectionToolbar = self.buildSelectionToolbar()
 
diff --git a/Signal/ConversationView/MemberRequestView.swift b/Signal/ConversationView/MemberRequestView.swift
index 55ba3ffbd8..8dc4c8076c 100644
--- a/Signal/ConversationView/MemberRequestView.swift
+++ b/Signal/ConversationView/MemberRequestView.swift
@@ -6,7 +6,7 @@
 import SignalServiceKit
 import SignalUI
 
-class MemberRequestView: UIStackView {
+class MemberRequestView: ConversationBottomPanelView {
 
     private let thread: TSThread
 
@@ -15,68 +15,62 @@ class MemberRequestView: UIStackView {
     weak var delegate: MessageRequestDelegate?
 
     init(threadViewModel: ThreadViewModel, fromViewController: UIViewController) {
-        let thread = threadViewModel.threadRecord
-        self.thread = thread
+        self.thread = threadViewModel.threadRecord
         owsAssertDebug(thread is TSGroupThread)
         self.fromViewController = fromViewController
 
         super.init(frame: .zero)
 
-        createContents()
-    }
-
-    private func createContents() {
-        // We want the background to extend to the bottom of the screen
-        // behind the safe area, so we add that inset to our bottom inset
-        // instead of pinning this view to the safe area
-        let safeAreaInset = safeAreaInsets.bottom
-
-        autoresizingMask = .flexibleHeight
-
-        axis = .vertical
-        spacing = 11
-        layoutMargins = UIEdgeInsets(top: 16, leading: 16, bottom: 20 + safeAreaInset, trailing: 16)
-        isLayoutMarginsRelativeArrangement = true
-        alignment = .fill
-
-        let backgroundView = UIView()
-        backgroundView.backgroundColor = Theme.backgroundColor
-        addSubview(backgroundView)
-        backgroundView.autoPinEdgesToSuperviewEdges()
-
         let label = UILabel()
         label.font = .dynamicTypeSubheadlineClamped
         label.textColor = Theme.secondaryTextAndIconColor
         label.text = OWSLocalizedString("MESSAGE_REQUESTS_CONVERSATION_REQUEST_INDICATOR",
                                        comment: "Indicator that you have requested to join this group.")
         label.numberOfLines = 0
+        label.textAlignment = .center
         label.lineBreakMode = .byWordWrapping
-        addArrangedSubview(label)
-
-        let cancelTitle = OWSLocalizedString("MESSAGE_REQUESTS_CANCEL_REQUEST_BUTTON",
-                                            comment: "Label for button to cancel your request to join the group.")
-        let cancelButton = OWSFlatButton.button(title: cancelTitle,
-                                                 font: UIFont.dynamicTypeHeadline,
-                                                 titleColor: Theme.secondaryTextAndIconColor,
-                                                 backgroundColor: Theme.washColor,
-                                                 target: self,
-                                                 selector: #selector(didTapCancelButton))
-        cancelButton.autoSetHeightUsingFont()
-        addArrangedSubview(cancelButton)
+
+        let cancelButton = UIButton(
+            configuration: .largeSecondary(title: OWSLocalizedString(
+                "MESSAGE_REQUESTS_CANCEL_REQUEST_BUTTON",
+                comment: "Label for button to cancel your request to join the group."
+            )),
+            primaryAction: UIAction { [weak self] _ in
+                self?.didTapCancelButton()
+            }
+        )
+        cancelButton.configuration?.baseForegroundColor = .Signal.red
+        cancelButton.translatesAutoresizingMaskIntoConstraints = false
+        let cancelButtonContainer = UIView.container()
+        cancelButtonContainer.addSubview(cancelButton)
+        cancelButtonContainer.addConstraints([
+            cancelButton.topAnchor.constraint(equalTo: cancelButtonContainer.topAnchor),
+            cancelButton.leadingAnchor.constraint(equalTo: cancelButtonContainer.leadingAnchor, constant: 18),
+            cancelButton.centerXAnchor.constraint(equalTo: cancelButtonContainer.centerXAnchor),
+            cancelButton.bottomAnchor.constraint(equalTo: cancelButtonContainer.bottomAnchor),
+        ])
+
+        let stackView = UIStackView(arrangedSubviews: [label, cancelButtonContainer])
+        stackView.axis = .vertical
+        stackView.spacing = 16
+        stackView.translatesAutoresizingMaskIntoConstraints = false
+        contentView.addSubview(stackView)
+
+        addConstraints([
+            stackView.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor),
+            stackView.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor),
+            stackView.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor),
+            stackView.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor),
+        ])
     }
 
     required init(coder: NSCoder) {
         fatalError("init(coder:) has not been implemented")
     }
 
-    override var intrinsicContentSize: CGSize {
-        return .zero
-    }
-
     // MARK: -
 
-    @objc
-    private func didTapCancelButton(_ sender: UIButton) {
+    private func didTapCancelButton() {
         showCancelRequestUI()
     }
 
@@ -95,7 +89,7 @@ class MemberRequestView: UIStackView {
                                                     self?.cancelRequestToJoin()
         })
         actionSheet.addAction(ActionSheetAction(title: CommonStrings.noButton,
-                                                style: .destructive) { _ in
+                                                style: .cancel) { _ in
                                                     // Do nothing.
         })
 
diff --git a/Signal/ConversationView/MessageRequestView.swift b/Signal/ConversationView/MessageRequestView.swift
index f7722288d6..8b68f8f5b3 100644
--- a/Signal/ConversationView/MessageRequestView.swift
+++ b/Signal/ConversationView/MessageRequestView.swift
@@ -37,7 +37,7 @@ public struct MessageRequestType: Equatable {
 
 // MARK: -
 
-class MessageRequestView: UIStackView {
+class MessageRequestView: ConversationBottomPanelView {
 
     enum LocalizedStrings {
         static let block = OWSLocalizedString(
@@ -109,32 +109,32 @@ class MessageRequestView: UIStackView {
 
         super.init(frame: .zero)
 
-        // We want the background to extend to the bottom of the screen
-        // behind the safe area, so we add that inset to our bottom inset
-        // instead of pinning this view to the safe area
-        let safeAreaInset = safeAreaInsets.bottom
-
-        autoresizingMask = .flexibleHeight
-
-        axis = .vertical
-        spacing = 11
-        layoutMargins = UIEdgeInsets(top: 16, leading: 16, bottom: 20 + safeAreaInset, trailing: 16)
-        isLayoutMarginsRelativeArrangement = true
-
-        let backgroundView = UIVisualEffectView(effect: UIBlurEffect(style: .prominent))
-        addSubview(backgroundView)
-        backgroundView.autoPinEdgesToSuperviewEdges()
-
-        switch mode {
-        case .none:
-            owsFailDebug("Invalid mode.")
-        case .contactOrGroupRequest:
-            addArrangedSubview(prepareMessageRequestPrompt())
-            addArrangedSubview(prepareMessageRequestButtons())
-        case .groupInviteRequest:
-            addArrangedSubview(prepareGroupV2InvitePrompt())
-            addArrangedSubview(prepareGroupV2InviteButtons())
-        }
+        let arrangedSubviews: [UIView] = {
+            switch mode {
+            case .none:
+                owsFailDebug("Invalid mode.")
+                return []
+            case .contactOrGroupRequest:
+                return [ prepareMessageRequestPrompt(),
+                         prepareMessageRequestButtons() ]
+            case .groupInviteRequest:
+                return [ prepareGroupV2InvitePrompt(),
+                         prepareGroupV2InviteButtons() ]
+            }
+        }()
+
+        let stackView = UIStackView(arrangedSubviews: arrangedSubviews)
+        stackView.axis = .vertical
+        stackView.spacing = 16
+        stackView.translatesAutoresizingMaskIntoConstraints = false
+        contentView.addSubview(stackView)
+
+        addConstraints([
+            stackView.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor),
+            stackView.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor),
+            stackView.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor),
+            stackView.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor),
+        ])
     }
 
     public static func messageRequestType(forThread thread: TSThread,
@@ -173,10 +173,6 @@ class MessageRequestView: UIStackView {
         fatalError("init(coder:) has not been implemented")
     }
 
-    override var intrinsicContentSize: CGSize {
-        return .zero
-    }
-
     // MARK: - Message Request
 
     // This is used for:
@@ -280,100 +276,67 @@ class MessageRequestView: UIStackView {
 
         if isThreadBlocked {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.delete,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.delete, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapDelete()
                 }
             )
             if !hasReportedSpam {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.report,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.report, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapReport()
                     }
                 )
             }
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.unblock,
-                    titleColor: Theme.primaryTextColor
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.unblock) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapUnblock(mode: mode)
                 }
             )
         } else if isThreadFromHiddenRecipient {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.block,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.block, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapBlock(mode: mode)
                 }
             )
             if !hasReportedSpam {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.report,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.report, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapReport()
                     }
                 )
             } else {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.delete,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.delete, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapDelete()
                     }
                 )
             }
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.accept,
-                    titleColor: Theme.primaryTextColor
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.accept) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapAccept(mode: mode, unblockThread: false, unhideRecipient: true)
                 }
             )
         } else if hasSentMessages {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.block,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.block, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapBlock(mode: mode)
                 }
             )
             if !hasReportedSpam {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.report,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.report, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapReport()
                     }
                 )
             } else {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.delete,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.delete, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapDelete()
                     }
                 )
             }
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.continue,
-                    titleColor: Theme.primaryTextColor
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.continue) { [weak self] in
                     // This is the same action as accepting the message request, but displays
                     // with slightly different visuals if the user has already been messaging
                     // this user in the past but didn't share their profile.
@@ -382,37 +345,25 @@ class MessageRequestView: UIStackView {
             )
         } else {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.block,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.block, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapBlock(mode: mode)
                 }
             )
             if !hasReportedSpam {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.report,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.report, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapReport()
                     }
                 )
             } else {
                 buttons.append(
-                    prepareButton(
-                        title: LocalizedStrings.delete,
-                        titleColor: .ows_accentRed
-                    ) { [weak self] in
+                    prepareButton(title: LocalizedStrings.delete, destructive: true) { [weak self] in
                         self?.delegate?.messageRequestViewDidTapDelete()
                     }
                 )
             }
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.accept,
-                    titleColor: Theme.primaryTextColor
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.accept) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapAccept(mode: mode, unblockThread: false, unhideRecipient: false)
                 }
             )
@@ -443,39 +394,27 @@ class MessageRequestView: UIStackView {
         var buttons = [UIView]()
 
         buttons.append(
-            prepareButton(
-                title: LocalizedStrings.block,
-                titleColor: .ows_accentRed
-            ) { [weak self] in
+            prepareButton(title: LocalizedStrings.block, destructive: true) { [weak self] in
                 self?.delegate?.messageRequestViewDidTapBlock(mode: mode)
             }
         )
 
         if !hasReportedSpam {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.report,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.report, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapReport()
                 }
             )
         } else {
             buttons.append(
-                prepareButton(
-                    title: LocalizedStrings.delete,
-                    titleColor: .ows_accentRed
-                ) { [weak self] in
+                prepareButton(title: LocalizedStrings.delete, destructive: true) { [weak self] in
                     self?.delegate?.messageRequestViewDidTapDelete()
                 }
             )
         }
 
         buttons.append(
-            prepareButton(
-                title: LocalizedStrings.accept,
-                titleColor: Theme.primaryTextColor
-            ) { [weak self] in
+            prepareButton(title: LocalizedStrings.accept) { [weak self] in
                 self?.delegate?.messageRequestViewDidTapAccept(mode: mode, unblockThread: false, unhideRecipient: false)
             }
         )
@@ -484,12 +423,20 @@ class MessageRequestView: UIStackView {
 
     // MARK: -
 
-    private func prepareButton(title: String, titleColor: UIColor, touchHandler: @escaping () -> Void) -> OWSRoundedButton {
-        let button = OWSRoundedButton(title: title, block: touchHandler)
-        button.setTitleColor(titleColor, for: .normal)
-        button.titleLabel?.font = .dynamicTypeHeadlineClamped
-        button.dimsWhenHighlighted = true
-        button.backgroundColor = Theme.isDarkThemeEnabled ? UIColor(white: 1, alpha: 0.16) : UIColor(white: 0, alpha: 0.08)
+    private func prepareButton(
+        title: String,
+        destructive: Bool = false,
+        actionBlock: @escaping () -> Void
+    ) -> UIButton {
+        let button = UIButton(
+            configuration: .mediumSecondary(title: title),
+            primaryAction: UIAction { _ in
+                actionBlock()
+            }
+        )
+        if destructive {
+            button.configuration?.baseForegroundColor = .Signal.red
+        }
         return button
     }
 
@@ -527,8 +474,9 @@ class MessageRequestView: UIStackView {
                     .font(.dynamicTypeSubheadlineClamped)
                 )
             ])
+            .styled(with: .alignment(.center))
         } else {
-            textView.attributedText = attributedString
+            textView.attributedText = attributedString.styled(with: .alignment(.center))
         }
         return textView
     }
diff --git a/Signal/src/UserInterface/ConversationSearch.swift b/Signal/src/UserInterface/ConversationSearch.swift
index 189f53e03c..0fbfd25d55 100644
--- a/Signal/src/UserInterface/ConversationSearch.swift
+++ b/Signal/src/UserInterface/ConversationSearch.swift
@@ -149,7 +149,7 @@ protocol SearchResultsBarDelegate: AnyObject {
                           resultSet: ConversationScreenSearchResultSet)
 }
 
-public class SearchResultsBar: UIView {
+public class SearchResultsBar: UIView, ConversationInputPanelWithContentLayoutGuide {
 
     weak var resultsBarDelegate: SearchResultsBarDelegate?
 
@@ -158,43 +158,58 @@ public class SearchResultsBar: UIView {
 
     let labelItem = UIBarButtonItem(title: nil, style: .plain, target: nil, action: nil)
     let toolbar = UIToolbar.clear()
+    let contentLayoutGuide = UILayoutGuide()
 
     var resultSet: ConversationScreenSearchResultSet?
 
     override init(frame: CGRect) {
         super.init(frame: frame)
 
-        self.layoutMargins = .zero
-
-        // When presenting or dismissing the keyboard, there may be a slight
-        // gap between the keyboard and the bottom of the input bar during
-        // the animation. Extend the background below the toolbar's bounds
-        // by this much to mask that extra space.
-        let backgroundExtension: CGFloat = 100
-
-        if UIAccessibility.isReduceTransparencyEnabled {
-            self.backgroundColor = Theme.toolbarBackgroundColor
+        layoutMargins = .zero
+
+        let isLegacyLayout: Bool = if #unavailable(iOS 26) { true } else { false }
+
+        addLayoutGuide(contentLayoutGuide)
+        addConstraints([
+            contentLayoutGuide.topAnchor.constraint(equalTo: topAnchor),
+            contentLayoutGuide.leadingAnchor.constraint(equalTo: safeAreaLayoutGuide.leadingAnchor),
+            contentLayoutGuide.trailingAnchor.constraint(equalTo: safeAreaLayoutGuide.trailingAnchor),
+            {
+                let c = contentLayoutGuide.bottomAnchor.constraint(equalTo: safeAreaLayoutGuide.bottomAnchor)
+                c.priority = .defaultLow
+                return c
+            }()
+        ])
+
+        if isLegacyLayout {
+            if UIAccessibility.isReduceTransparencyEnabled {
+                backgroundColor = Theme.toolbarBackgroundColor
+
+                let extendedBackground = UIView()
+                extendedBackground.backgroundColor = Theme.toolbarBackgroundColor
+                addSubview(extendedBackground)
+                extendedBackground.autoPinEdgesToSuperviewEdges()
+            } else {
+                let alpha: CGFloat = OWSNavigationBar.backgroundBlurMutingFactor
+                backgroundColor = Theme.toolbarBackgroundColor.withAlphaComponent(alpha)
 
-            let extendedBackground = UIView()
-            extendedBackground.backgroundColor = Theme.toolbarBackgroundColor
-            addSubview(extendedBackground)
-            extendedBackground.autoPinWidthToSuperview()
-            extendedBackground.autoPinEdge(.top, to: .bottom, of: self)
-            extendedBackground.autoSetDimension(.height, toSize: backgroundExtension)
-        } else {
-            let alpha: CGFloat = OWSNavigationBar.backgroundBlurMutingFactor
-            backgroundColor = Theme.toolbarBackgroundColor.withAlphaComponent(alpha)
-
-            let blurEffectView = UIVisualEffectView(effect: Theme.barBlurEffect)
-            blurEffectView.layer.zPosition = -1
-            addSubview(blurEffectView)
-            blurEffectView.autoPinWidthToSuperview()
-            blurEffectView.autoPinEdge(toSuperviewEdge: .top)
-            blurEffectView.autoPinEdge(toSuperviewEdge: .bottom, withInset: -backgroundExtension)
+                let blurEffectView = UIVisualEffectView(effect: Theme.barBlurEffect)
+                blurEffectView.layer.zPosition = -1
+                addSubview(blurEffectView)
+                blurEffectView.autoPinEdgesToSuperviewEdges()
+            }
         }
 
         addSubview(toolbar)
-        toolbar.autoPinEdgesToSuperviewMargins()
+        toolbar.translatesAutoresizingMaskIntoConstraints = false
+        let vMargin: CGFloat = isLegacyLayout ? 0 : 6
+        let hMargin: CGFloat = 0
+        addConstraints([
+            toolbar.topAnchor.constraint(equalTo: contentLayoutGuide.topAnchor, constant: vMargin),
+            toolbar.leadingAnchor.constraint(equalTo: contentLayoutGuide.leadingAnchor, constant: hMargin),
+            toolbar.trailingAnchor.constraint(equalTo: contentLayoutGuide.trailingAnchor, constant: -hMargin),
+            toolbar.bottomAnchor.constraint(equalTo: contentLayoutGuide.bottomAnchor, constant: -vMargin),
+        ])
 
         let leftExteriorChevronMargin: CGFloat
         let leftInteriorChevronMargin: CGFloat
@@ -206,18 +221,28 @@ public class SearchResultsBar: UIView {
             leftInteriorChevronMargin = 8
         }
 
-        showLessRecentButton = UIBarButtonItem(image: Theme.iconImage(.chevronUp), style: .plain, target: self, action: #selector(didTapShowLessRecent))
+        showLessRecentButton = UIBarButtonItem(
+            image: Theme.iconImage(.chevronUp),
+            primaryAction: UIAction { [weak self] _ in
+                self?.didTapShowLessRecent()
+            }
+        )
         showLessRecentButton.imageInsets = UIEdgeInsets(top: 2, left: leftExteriorChevronMargin, bottom: 2, right: leftInteriorChevronMargin)
-        showLessRecentButton.tintColor = Theme.accentBlueColor
 
-        showMoreRecentButton = UIBarButtonItem(image: Theme.iconImage(.chevronDown), style: .plain, target: self, action: #selector(didTapShowMoreRecent))
+        showMoreRecentButton = UIBarButtonItem(
+            image: Theme.iconImage(.chevronDown),
+            primaryAction: UIAction { [weak self] _ in
+                self?.didTapShowMoreRecent()
+            }
+        )
         showMoreRecentButton.imageInsets = UIEdgeInsets(top: 2, left: leftInteriorChevronMargin, bottom: 2, right: leftExteriorChevronMargin)
-        showMoreRecentButton.tintColor = Theme.accentBlueColor
 
-        toolbar.items = [showLessRecentButton, showMoreRecentButton, .flexibleSpace(), labelItem, .flexibleSpace()]
+        if isLegacyLayout {
+            showLessRecentButton.tintColor = .Signal.accent
+            showMoreRecentButton.tintColor = .Signal.accent
+        }
 
-        self.autoresizingMask = .flexibleHeight
-        self.translatesAutoresizingMaskIntoConstraints = false
+        toolbar.items = [showLessRecentButton, showMoreRecentButton, .flexibleSpace(), labelItem, .flexibleSpace()]
 
         updateBarItems()
     }
@@ -226,7 +251,6 @@ public class SearchResultsBar: UIView {
         fatalError("init(coder:) has not been implemented")
     }
 
-    @objc
     private func didTapShowLessRecent() {
         Logger.debug("")
         guard let resultSet = resultSet else {
@@ -250,7 +274,6 @@ public class SearchResultsBar: UIView {
         resultsBarDelegate?.searchResultsBar(self, setCurrentIndex: newIndex, resultSet: resultSet)
     }
 
-    @objc
     private func didTapShowMoreRecent() {
         Logger.debug("")
         guard let resultSet = resultSet else {
@@ -296,7 +319,7 @@ public class SearchResultsBar: UIView {
     }
 
     func updateBarItems() {
-        guard let resultSet = resultSet else {
+        guard let resultSet else {
             labelItem.title = nil
             showMoreRecentButton.isEnabled = false
             showLessRecentButton.isEnabled = false
@@ -309,7 +332,7 @@ public class SearchResultsBar: UIView {
             let format = OWSLocalizedString("CONVERSATION_SEARCH_RESULTS_%d_%d", tableName: "PluralAware",
                                            comment: "keyboard toolbar label when more than one or more messages matches the search string. Embeds {{number/position of the 'currently viewed' result}} and the {{total number of results}}")
 
-            guard let currentIndex = currentIndex else {
+            guard let currentIndex else {
                 owsFailDebug("currentIndex was unexpectedly nil")
                 return
             }
diff --git a/Signal/src/ViewControllers/MessageActionsToolbar.swift b/Signal/src/ViewControllers/MessageActionsToolbar.swift
index 2cd8b584d9..b038c6f762 100644
--- a/Signal/src/ViewControllers/MessageActionsToolbar.swift
+++ b/Signal/src/ViewControllers/MessageActionsToolbar.swift
@@ -120,7 +120,7 @@ public protocol MessageActionsToolbarDelegate: AnyObject {
     var messageActionsToolbarSelectedInteractionCount: Int { get }
 }
 
-public class MessageActionsToolbar: UIToolbar {
+public class MessageActionsToolbar: UIView {
 
     weak var actionDelegate: MessageActionsToolbarDelegate?
 
@@ -131,22 +131,34 @@ public class MessageActionsToolbar: UIToolbar {
     }
     private let mode: Mode
 
+    private let toolbar = UIToolbar()
+
     init(mode: Mode) {
         self.mode = mode
 
         super.init(frame: .zero)
 
-        isTranslucent = false
-        isOpaque = true
-
-        autoresizingMask = .flexibleHeight
-        translatesAutoresizingMaskIntoConstraints = false
-        setShadowImage(UIImage(), forToolbarPosition: .any)
-
-        buildItems()
+        toolbar.translatesAutoresizingMaskIntoConstraints = false
+        addSubview(toolbar)
+        addConstraints([
+            toolbar.topAnchor.constraint(equalTo: topAnchor),
+            toolbar.leadingAnchor.constraint(equalTo: leadingAnchor),
+            toolbar.trailingAnchor.constraint(equalTo: trailingAnchor),
+            toolbar.bottomAnchor.constraint(equalTo: safeAreaLayoutGuide.bottomAnchor),
+        ])
+
+        if #unavailable(iOS 26) {
+            toolbar.setShadowImage(UIImage(), forToolbarPosition: .any)
+
+            NotificationCenter.default.addObserver(
+                self,
+                selector: #selector(themeDidChange),
+                name: .themeDidChange,
+                object: nil
+            )
+        }
 
-        NotificationCenter.default.addObserver(self, selector: #selector(applyTheme), name: .themeDidChange, object: nil)
-        applyTheme()
+        updateContent()
     }
 
     required init?(coder aDecoder: NSCoder) {
@@ -156,15 +168,16 @@ public class MessageActionsToolbar: UIToolbar {
     // MARK: -
 
     @objc
-    private func applyTheme() {
-        AssertIsOnMainThread()
-
-        barTintColor = Theme.isDarkThemeEnabled ? .ows_gray75 : .ows_white
+    @available(iOS, deprecated: 26)
+    private func themeDidChange() {
+        guard #unavailable(iOS 26) else { return }
 
-        buildItems()
+        AssertIsOnMainThread()
+        updateContent()
     }
 
     public func updateContent() {
+        actionItems.removeAll()
         buildItems()
     }
 
@@ -178,22 +191,34 @@ public class MessageActionsToolbar: UIToolbar {
         }
     }
 
-    var actionItems = [MessageActionsToolbarButton]()
+    private var actionItems = [MessageAction.MessageActionType: UIBarButtonItem]()
+
+    private func barButtonItem(for messageAction: MessageAction) -> UIBarButtonItem {
+        let barButtonItem = UIBarButtonItem(
+            image: messageAction.barButtonImage,
+            primaryAction: UIAction { [weak self] _ in
+                guard let self else { return }
+                self.actionDelegate?.messageActionsToolbar(self, executedAction: messageAction)
+            }
+        )
+        if #unavailable(iOS 26) {
+            barButtonItem.tintColor = Theme.primaryIconColor
+        }
+        barButtonItem.accessibilityLabel = messageAction.accessibilityLabel
+        return barButtonItem
+    }
 
     private func buildNormalItems(messagesActions: [MessageAction]) {
         var newItems = [UIBarButtonItem]()
 
-        var actionItems = [MessageActionsToolbarButton]()
-        for action in messagesActions {
+        for messageAction in messagesActions {
             if !newItems.isEmpty {
                 newItems.append(.flexibleSpace())
             }
 
-            let actionItem = MessageActionsToolbarButton(actionsToolbar: self, messageAction: action)
-            actionItem.tintColor = Theme.primaryIconColor
-            actionItem.accessibilityLabel = action.accessibilityLabel
+            let actionItem = barButtonItem(for: messageAction)
             newItems.append(actionItem)
-            actionItems.append(actionItem)
+            actionItems[messageAction.actionType] = actionItem
         }
 
         // If we only have a single button, center it.
@@ -202,15 +227,17 @@ public class MessageActionsToolbar: UIToolbar {
             newItems.append(.flexibleSpace())
         }
 
-        items = newItems
-        self.actionItems = actionItems
+        toolbar.items = newItems
     }
 
     private func buildSelectionItems(deleteMessagesAction: MessageAction,
                                      forwardMessagesAction: MessageAction) {
 
-        let deleteItem = MessageActionsToolbarButton(actionsToolbar: self, messageAction: deleteMessagesAction)
-        let forwardItem = MessageActionsToolbarButton(actionsToolbar: self, messageAction: forwardMessagesAction)
+        let deleteItem = barButtonItem(for: deleteMessagesAction)
+        actionItems[deleteMessagesAction.actionType] = deleteItem
+
+        let forwardItem = barButtonItem(for: forwardMessagesAction)
+        actionItems[forwardMessagesAction.actionType] = forwardItem
 
         let selectedCount: Int = actionDelegate?.messageActionsToolbarSelectedInteractionCount ?? 0
         let labelFormat = OWSLocalizedString("MESSAGE_ACTIONS_TOOLBAR_CAPTION_%d", tableName: "PluralAware",
@@ -242,62 +269,20 @@ public class MessageActionsToolbar: UIToolbar {
         let labelItem = UIBarButtonItem(customView: labelView)
         labelItem.isEnabled = false
 
-        var newItems = [UIBarButtonItem]()
-        newItems.append(deleteItem)
-        newItems.append(.flexibleSpace())
-        newItems.append(labelItem)
-        newItems.append(.flexibleSpace())
-        newItems.append(forwardItem)
-
-        items = newItems
-        self.actionItems = [ deleteItem, forwardItem ]
+        toolbar.items = [
+            deleteItem,
+            .flexibleSpace(),
+            labelItem,
+            .flexibleSpace(),
+            forwardItem,
+        ]
     }
 
     public func buttonItem(for actionType: MessageAction.MessageActionType) -> UIBarButtonItem? {
-        for actionItem in actionItems {
-            if let messageAction = actionItem.messageAction,
-               messageAction.actionType == actionType {
-                return actionItem
-            }
-        }
-        owsFailDebug("Missing action item: \(actionType).")
-        return nil
-    }
-}
-
-// MARK: -
-
-class MessageActionsToolbarButton: UIBarButtonItem {
-    private weak var actionsToolbar: MessageActionsToolbar?
-    fileprivate var messageAction: MessageAction?
-
-    init(actionsToolbar: MessageActionsToolbar, messageAction: MessageAction) {
-        self.actionsToolbar = actionsToolbar
-        self.messageAction = messageAction
-
-        super.init()
-
-        self.image = messageAction.barButtonImage
-        self.style = .plain
-        self.target = self
-        self.action = #selector(didTapItem(_:))
-        self.tintColor = Theme.primaryIconColor
-        self.accessibilityLabel = messageAction.accessibilityLabel
-    }
-
-    required init?(coder: NSCoder) {
-        fatalError("init(coder:) has not been implemented")
-    }
-
-    @objc
-    private func didTapItem(_ item: UIBarButtonItem) {
-        AssertIsOnMainThread()
-
-        guard let messageAction = messageAction,
-              let actionsToolbar = actionsToolbar,
-              let actionDelegate = actionsToolbar.actionDelegate else {
-            return
+        guard let buttonItem = actionItems[actionType] else {
+            owsFailDebug("Missing action item: \(actionType).")
+            return nil
         }
-        actionDelegate.messageActionsToolbar(actionsToolbar, executedAction: messageAction)
+        return buttonItem
     }
 }
