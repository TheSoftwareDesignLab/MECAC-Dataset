diff --git a/Signal/Registration/RegistrationCoordinatorImpl.swift b/Signal/Registration/RegistrationCoordinatorImpl.swift
index 92849d5dfdf..8b7000e0350 100644
--- a/Signal/Registration/RegistrationCoordinatorImpl.swift
+++ b/Signal/Registration/RegistrationCoordinatorImpl.swift
@@ -117,38 +117,42 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
     }
 
     public func submitE164(_ e164: E164) -> Guarantee<RegistrationStep> {
+        let pathway = getPathway()
         db.write { tx in
             updatePersistedState(tx) {
                 $0.e164 = e164
             }
-        }
-        inMemoryState.hasEnteredE164 = true
-        switch getPathway() {
-        case .session(let session):
-            if
-                let sessionState = self.persistedState.sessionState,
-                sessionState.sessionId == session.id
-            {
-                switch sessionState.initialCodeRequestState {
-                case .failedToRequest:
-                    // Reset state so we try again.
-                    db.write { tx in
+            switch pathway {
+            case .session(let session):
+                guard session.e164 == e164 else {
+                    resetSession(tx)
+                    return
+                }
+                if
+                    let sessionState = self.persistedState.sessionState,
+                    sessionState.sessionId == session.id
+                {
+                    switch sessionState.initialCodeRequestState {
+                    case .failedToRequest:
+                        // Reset state so we try again.
                         self.updatePersistedSessionState(session: session, tx) {
                             $0.initialCodeRequestState = .neverRequested
                         }
+                    case .requested, .neverRequested:
+                        break
                     }
-                case .requested, .neverRequested:
-                    break
                 }
+            case
+                    .opening,
+                    .kbsAuthCredential,
+                    .kbsAuthCredentialCandidates,
+                    .registrationRecoveryPassword,
+                    .profileSetup:
+                break
             }
-        case
-                .opening,
-                .kbsAuthCredential,
-                .kbsAuthCredentialCandidates,
-                .registrationRecoveryPassword,
-                .profileSetup:
-            break
         }
+        inMemoryState.hasEnteredE164 = true
+
         return nextStep()
     }
 
@@ -607,6 +611,10 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
             }
 
             var pushChallengeState: PushChallengeState = .notRequested
+
+            /// If non-nil, we created an account with the session but got rate limited
+            /// and can retry at the provided time.
+            var createAccountTimeout: Date?
         }
 
         var sessionState: SessionState?
@@ -1117,7 +1125,13 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                         )
                     }
             }
-            return .value(.showErrorSheet(.todo))
+            // If we get a long timeout, just give up and fall back to the session
+            // path. Reg recovery password based recovery is best effort anyway.
+            // Besides since this is always our first attempt at registering,
+            // this lockout should never happen.
+            Logger.error("Rate limited when registering via recovery password; falling back to session.")
+            wipeInMemoryStateToPreventKBSPathAttempts()
+            return self.startSession(e164: e164)
 
         case .deviceTransferPossible:
             // Device transfer can happen, let the user pick.
@@ -1444,9 +1458,16 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
         }
 
         if let nextVerificationAttemptDate = session.nextVerificationAttemptDate {
+            let validationError: RegistrationVerificationValidationError?
+            if deps.dateProvider() < nextVerificationAttemptDate {
+                validationError = .submitCodeTimeout
+            } else {
+                validationError = nil
+            }
             return .value(.verificationCodeEntry(self.verificationCodeEntryState(
                 session: session,
-                nextVerificationAttemptDate: nextVerificationAttemptDate
+                nextVerificationAttemptDate: nextVerificationAttemptDate,
+                validationError: validationError
             )))
         }
 
@@ -1534,6 +1555,14 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
         _ session: RegistrationSession,
         retriesLeft: Int = Constants.networkErrorRetries
     ) -> Guarantee<RegistrationStep> {
+        if
+            let timeoutDate = persistedState.sessionState?.createAccountTimeout,
+            deps.dateProvider() < timeoutDate
+        {
+            return .value(.phoneNumberEntry(phoneNumberEntryState(
+                validationError: .rateLimited(.init(expiration: timeoutDate))
+            )))
+        }
         return self.makeRegisterOrChangeNumberRequest(
             .sessionId(session.id),
             e164: session.e164,
@@ -1608,8 +1637,13 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                         )
                     }
             }
-            // TODO[Registration] bubble up the error to the ui properly.
-            return .value(.showErrorSheet(.todo))
+            let timeoutDate = self.deps.dateProvider().addingTimeInterval(timeInterval)
+            self.db.write { tx in
+                self.updatePersistedSessionState(session: sessionFromBeforeRequest, tx) {
+                    $0.createAccountTimeout = timeoutDate
+                }
+            }
+            return nextStep()
         case .deviceTransferPossible:
             inMemoryState.needsToAskForDeviceTransfer = true
             return .value(.transferSelection)
diff --git a/Signal/src/ViewControllers/Registration/RegistrationVerificationCodeView.swift b/Signal/src/ViewControllers/Registration/RegistrationVerificationCodeView.swift
index caa62906369..85ad7a3c7ab 100644
--- a/Signal/src/ViewControllers/Registration/RegistrationVerificationCodeView.swift
+++ b/Signal/src/ViewControllers/Registration/RegistrationVerificationCodeView.swift
@@ -106,14 +106,13 @@ class RegistrationVerificationCodeView: UIView {
         textfield.delegate = self
         textfield.codeDelegate = self
 
-        textfield.textColor = Theme.primaryTextColor
         textfield.font = UIFont.ows_dynamicTypeLargeTitle1Clamped
         textfield.keyboardType = .numberPad
         textfield.textContentType = .oneTimeCode
 
         var digitViews = [UIView]()
         (0..<digitCount).forEach { (_) in
-            let (digitView, digitLabel, digitStroke) = makeCellView(text: "", hasStroke: true)
+            let (digitView, digitLabel, digitStroke) = makeCellView(text: "")
 
             digitLabels.append(digitLabel)
             digitStrokes.append(digitStroke)
@@ -131,20 +130,30 @@ class RegistrationVerificationCodeView: UIView {
         stackView.autoHCenterInSuperview()
 
         self.addSubview(textfield)
+
+        updateColors()
+    }
+
+    public func updateColors() {
+        textfield.textColor = Theme.primaryTextColor
+        digitLabels.forEach { $0.textColor = Theme.primaryTextColor }
+        let strokeColor = (hasError ? UIColor.ows_accentRed : Theme.secondaryTextAndIconColor)
+        for digitStroke in digitStrokes {
+            digitStroke.backgroundColor = strokeColor
+        }
     }
 
-    private func makeCellView(text: String, hasStroke: Bool) -> (UIView, UILabel, UIView) {
+    private func makeCellView(text: String) -> (UIView, UILabel, UIView) {
         let digitView = UIView()
 
         let digitLabel = UILabel()
         digitLabel.text = text
         digitLabel.font = cellFont
-        digitLabel.textColor = Theme.primaryTextColor
         digitLabel.textAlignment = .center
         digitView.addSubview(digitLabel)
         digitLabel.autoCenterInSuperview()
 
-        let strokeColor = (hasStroke ? Theme.secondaryTextAndIconColor : UIColor.clear)
+        let strokeColor =  Theme.secondaryTextAndIconColor
         let strokeView = digitView.addBottomStroke(color: strokeColor, strokeWidth: strokeWidth)
         strokeView.layer.cornerRadius = strokeWidth / 2
 
@@ -195,11 +204,11 @@ class RegistrationVerificationCodeView: UIView {
         return textfield.resignFirstResponder()
     }
 
+    private var hasError = false
+
     func setHasError(_ hasError: Bool) {
-        let backgroundColor = (hasError ? UIColor.ows_accentRed : Theme.secondaryTextAndIconColor)
-        for digitStroke in digitStrokes {
-            digitStroke.backgroundColor = backgroundColor
-        }
+        self.hasError = hasError
+        updateColors()
     }
 
     func set(verificationCode: String) {
diff --git a/Signal/src/ViewControllers/Registration/RegistrationVerificationViewController.swift b/Signal/src/ViewControllers/Registration/RegistrationVerificationViewController.swift
index d1d245ede6a..e9b5861538d 100644
--- a/Signal/src/ViewControllers/Registration/RegistrationVerificationViewController.swift
+++ b/Signal/src/ViewControllers/Registration/RegistrationVerificationViewController.swift
@@ -24,7 +24,6 @@ public struct RegistrationVerificationState: Equatable {
     let e164: E164
     let nextSMSDate: Date?
     let nextCallDate: Date?
-    // TODO[Registration]: use this state to render a countdown.
     let nextVerificationAttemptDate: Date
     let validationError: RegistrationVerificationValidationError?
 
@@ -287,9 +286,6 @@ class RegistrationVerificationViewController: OWSViewController {
         renderResendButton(
             button: resendSMSCodeButton,
             date: state.nextSMSDate,
-            // TODO: This copy is ambiguous if you request a voice code. Does "resend code" mean
-            // that you'll get a new SMS code or a new voice code? We should update the wording to
-            // make it clearer that it's an SMS code.
             enabledString: OWSLocalizedString(
                 "ONBOARDING_VERIFICATION_RESEND_CODE_BUTTON",
                 comment: "Label for button to resend SMS verification code."
@@ -320,7 +316,8 @@ class RegistrationVerificationViewController: OWSViewController {
         titleLabel.textColor = .colorForRegistrationTitleLabel
         explanationLabel.textColor = .colorForRegistrationExplanationLabel
         wrongNumberButton.setTitleColor(Theme.accentBlueColor)
-        // TODO: Update colors of `verificationCodeView`, which is relevant if the theme changes.
+
+        verificationCodeView.updateColors()
     }
 
     private lazy var retryAfterFormatter: DateFormatter = {
@@ -378,20 +375,33 @@ class RegistrationVerificationViewController: OWSViewController {
                 comment: "During registration and re-registration, users may have to enter a code to verify ownership of their phone number. If they enter an invalid code, they will see this error message."
             )
         case .smsResendTimeout, .voiceResendTimeout:
-            // This isn't the best error message but this should be a rare case. The UI would have
-            // to allow the user to request a code that the server would not allow. It could happen
-            // if the user changes their clock.
             title = nil
-            message = CommonStrings.somethingWentWrongTryAgainLaterError
-        case .submitCodeTimeout:
-            title = OWSLocalizedString(
-                "REGISTRATION_NETWORK_ERROR_TITLE",
-                comment: "A network error occurred during registration, and an error is shown to the user. This is the title on that error sheet."
-            )
             message = OWSLocalizedString(
-                "REGISTRATION_NETWORK_ERROR_BODY",
-                comment: "A network error occurred during registration, and an error is shown to the user. This is the body on that error sheet."
+                "REGISTER_RATE_LIMITING_ALERT",
+                comment: "Body of action sheet shown when rate-limited during registration."
             )
+        case .submitCodeTimeout:
+            title = nil
+
+            let now = Date()
+            if now >= state.nextVerificationAttemptDate {
+                return
+            }
+            let format = OWSLocalizedString(
+                "REGISTRATION_SUBMIT_CODE_RATE_LIMIT_ALERT_FORMAT",
+                comment: "Alert shown when submitting a verification code too many times. Embeds {{ duration }}, such as \"5:00\""
+            )
+
+            let formatter: DateFormatter = {
+                let result = DateFormatter()
+                result.dateFormat = "m:ss"
+                result.timeZone = TimeZone(identifier: "UTC")!
+                return result
+            }()
+
+            let timeRemaining = max(state.nextVerificationAttemptDate.timeIntervalSince(now), 0)
+            let durationString = formatter.string(from: Date(timeIntervalSinceReferenceDate: timeRemaining))
+            message = String(format: format, durationString)
         }
         OWSActionSheets.showActionSheet(title: title, message: message)
     }
diff --git a/Signal/translations/en.lproj/Localizable.strings b/Signal/translations/en.lproj/Localizable.strings
index e4ae8e1b8cd..7bd6b5d8bea 100644
--- a/Signal/translations/en.lproj/Localizable.strings
+++ b/Signal/translations/en.lproj/Localizable.strings
@@ -5216,6 +5216,9 @@
 /* No comment provided by engineer. */
 "REGISTER_CONTACTS_WELCOME" = "Welcome!";
 
+/* Body of action sheet shown when rate-limited during registration. */
+"REGISTER_RATE_LIMITING_ALERT" = "You have tried too often. Please wait a few minutes before trying again.";
+
 /* action sheet body */
 "REGISTER_RATE_LIMITING_BODY" = "You have tried too often. Please wait a minute before trying again.";
 
@@ -5333,6 +5336,9 @@
 /* No comment provided by engineer. */
 "REGISTRATION_RESTRICTED_MESSAGE" = "You need to register before you can send a message.";
 
+/* Alert shown when submitting a verification code too many times. Embeds {{ duration }}, such as \"5:00\" */
+"REGISTRATION_SUBMIT_CODE_RATE_LIMIT_ALERT_FORMAT" = "Youâ€™ve made too many attempts to enter the code. Try again in %1$@";
+
 /* Error message indicating that device transfer from another device might be possible. */
 "REGISTRATION_TRANSFER_AVAILABLE_DESCRIPTION" = "There was an account previously registered with this number that is available for transfer.";
 
