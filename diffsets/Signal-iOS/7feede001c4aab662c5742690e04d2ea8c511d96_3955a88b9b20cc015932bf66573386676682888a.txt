diff --git a/Signal/src/ViewControllers/Context Menus/ContextMenuActionsAccessory.swift b/Signal/src/ViewControllers/Context Menus/ContextMenuActionsAccessory.swift
index 043b0760f4f..fee48be5a1d 100644
--- a/Signal/src/ViewControllers/Context Menus/ContextMenuActionsAccessory.swift	
+++ b/Signal/src/ViewControllers/Context Menus/ContextMenuActionsAccessory.swift	
@@ -148,6 +148,9 @@ public class ContextMenuActionsView: UIView {
                             let view = UIView(frame: bounds)
                             view.autoresizingMask = [.flexibleWidth, .flexibleHeight]
                             view.backgroundColor = Theme.cellSelectedColor
+                            if Theme.isDarkThemeEnabled {
+                                vibrancyView.backgroundColor = UIColor.ows_whiteAlpha20
+                            }
                             view.alpha = 0.3
                             vibrancyView.contentView.addSubview(view)
                             highlightedView = vibrancyView
@@ -194,6 +197,10 @@ public class ContextMenuActionsView: UIView {
             iconView.tintColor = titleLabel.textColor
 
             seperatorView = UIVisualEffectView(effect: UIVibrancyEffect(blurEffect: hostBlurEffect))
+            if Theme.isDarkThemeEnabled {
+                seperatorView.backgroundColor = UIColor.ows_whiteAlpha20
+            }
+
             let seperator = UIView(frame: seperatorView.bounds)
             seperator.backgroundColor = Theme.cellSeparatorColor
             seperator.autoresizingMask = [.flexibleWidth, .flexibleHeight]
diff --git a/Signal/src/ViewControllers/Context Menus/ContextMenuController.swift b/Signal/src/ViewControllers/Context Menus/ContextMenuController.swift
index 0cf57072ad9..b2c77b8426d 100644
--- a/Signal/src/ViewControllers/Context Menus/ContextMenuController.swift	
+++ b/Signal/src/ViewControllers/Context Menus/ContextMenuController.swift	
@@ -27,10 +27,11 @@ private class ContextMenuHostView: UIView {
 
     private var contentAreaInsets: UIEdgeInsets {
         let constPadding: CGFloat = 22
+        let minHorizPadding: CGFloat = 16
         return UIEdgeInsets(top: safeAreaInsets.top + constPadding,
-                     leading: safeAreaInsets.leading,
+                     leading: max(safeAreaInsets.leading, minHorizPadding),
                      bottom: safeAreaInsets.bottom + constPadding,
-                     trailing: safeAreaInsets.trailing)
+                     trailing: max(safeAreaInsets.trailing, minHorizPadding))
     }
 
     var blurView: UIView? {
@@ -107,6 +108,8 @@ private class ContextMenuHostView: UIView {
         let maxX: CGFloat = accessoryViews?.map { accessoryFrame($0, previewFrame: previewFrame).maxX }.max() ?? 0
         var minY: CGFloat = accessoryViews?.map { accessoryFrame($0, previewFrame: previewFrame).y }.min() ?? 0
         var maxY: CGFloat = accessoryViews?.map { accessoryFrame($0, previewFrame: previewFrame).maxY }.max() ?? 0
+        minY = min(minY, previewFrame.minY)
+        maxY = max(maxY, previewFrame.maxY)
 
         // Vertically shift if necessary
         if maxY > contentRect.maxY {
@@ -163,7 +166,7 @@ private class ContextMenuHostView: UIView {
         accessory.accessoryView.sizeToFit()
         accessoryFrame.size = accessory.accessoryView.frame.size
 
-        let isLandscape = bounds.size.width > bounds.size.height
+        let isLandscape = UIDevice.current.isIPad ? false : bounds.size.width > bounds.size.height
         let defaultAlignments = accessory.accessoryAlignment.alignments
         let alignments = isLandscape ? accessory.landscapeAccessoryAlignment?.alignments ?? defaultAlignments : defaultAlignments
 
@@ -332,7 +335,12 @@ class ContextMenuController: UIViewController, ContextMenuViewDelegate, UIGestur
         animationState = .animateIn
 
         UIView.animate(withDuration: animationDuration / 2.0) {
-            self.blurView.effect = UIBlurEffect(style: UIBlurEffect.Style.regular)
+            if !UIDevice.current.isIPad {
+                self.blurView.effect = UIBlurEffect(style: UIBlurEffect.Style.regular)
+                self.blurView.backgroundColor = Theme.isDarkThemeEnabled ? UIColor.ows_whiteAlpha20 : UIColor.ows_blackAlpha20
+            } else {
+                self.blurView.backgroundColor = UIColor.ows_blackAlpha40
+            }
             self.previewShadowVisible = true
         }
 
@@ -343,6 +351,7 @@ class ContextMenuController: UIViewController, ContextMenuViewDelegate, UIGestur
         // Match initial transform
         previewView.transform = CGAffineTransform.scale(0.95)
         previewView.isHidden = false
+        contextMenuPreview.view?.isHidden = true
 
         if shiftPreview {
             previewView.frame = initialFrame
@@ -405,6 +414,7 @@ class ContextMenuController: UIViewController, ContextMenuViewDelegate, UIGestur
         dispatchGroup.enter()
         UIView.animate(withDuration: animationDuration / 2.0) {
             self.blurView.effect = nil
+            self.blurView.backgroundColor = nil
             self.previewShadowVisible = false
         } completion: { _ in
             dispatchGroup.leave()
@@ -448,6 +458,7 @@ class ContextMenuController: UIViewController, ContextMenuViewDelegate, UIGestur
         }
 
         dispatchGroup.notify(queue: .main) {
+            self.contextMenuPreview.view?.isHidden = false
             self.animationState = .none
             completion()
         }
diff --git a/Signal/src/ViewControllers/Context Menus/ContextMenuInteraction.swift b/Signal/src/ViewControllers/Context Menus/ContextMenuInteraction.swift
index 411127c52d7..67cfed5a988 100644
--- a/Signal/src/ViewControllers/Context Menus/ContextMenuInteraction.swift	
+++ b/Signal/src/ViewControllers/Context Menus/ContextMenuInteraction.swift	
@@ -110,7 +110,7 @@ public class ContextMenuInteraction: NSObject, UIInteraction {
             delay: 0,
             options: [.curveEaseInOut, .beginFromCurrentState],
             animations: {
-                targetedPreview.view?.transform = CGAffineTransform.scale(0.95)
+                targetedPreview.view?.transform = .scale(0.95)
             },
             completion: { finished in
                 let shouldPresent = finished && self.gestureEligibleForMenuPresentation
@@ -174,16 +174,23 @@ public class ContextMenuInteraction: NSObject, UIInteraction {
         return accessory
     }
 
-    public func dismissMenu(completion: @escaping() -> Void ) {
+    public func dismissMenu(animated: Bool, completion: @escaping() -> Void ) {
         if let configuarion = self.configuration {
             delegate?.contextMenuInteraction(self, willEndForConfiguration: configuarion)
         }
 
-        contextMenuController?.animateOut({
+        if animated {
+            contextMenuController?.animateOut({
+                completion()
+                self.contextMenuController?.view.removeFromSuperview()
+                self.contextMenuController = nil
+            })
+        } else {
+            targetedPreview?.view?.isHidden = false
             completion()
             self.contextMenuController?.view.removeFromSuperview()
             self.contextMenuController = nil
-        })
+        }
     }
 
     // MARK: Private
@@ -206,7 +213,7 @@ public class ContextMenuInteraction: NSObject, UIInteraction {
 extension ContextMenuInteraction: ContextMenuControllerDelegate, ContextMenuTargetedPreviewAccessoryInteractionDelegate {
 
     func contextMenuTargetedPreviewAccessoryRequestsDismissal(_ accessory: ContextMenuTargetedPreviewAccessory, completion: @escaping () -> Void) {
-        dismissMenu(completion: completion)
+        dismissMenu(animated: true, completion: completion)
     }
 
     func contextMenuTargetedPreviewAccessoryPreviewAlignment(_ accessory: ContextMenuTargetedPreviewAccessory) -> ContextMenuTargetedPreview.Alignment {
@@ -214,7 +221,7 @@ extension ContextMenuInteraction: ContextMenuControllerDelegate, ContextMenuTarg
     }
 
     func contextMenuControllerRequestsDismissal(_ contextMenuController: ContextMenuController) {
-        dismissMenu(completion: { })
+        dismissMenu(animated: true, completion: { })
     }
 
     func contextMenuTargetedPreviewAccessoryRequestsEmojiPicker(
@@ -270,10 +277,8 @@ public class ChatHistoryContextMenuInteraction: ContextMenuInteraction {
     public func initiatingGestureRecognizerDidEnd() {
         gestureEligibleForMenuPresentation = false
 
-        if contextMenuController == nil {
-            if let configuarion = self.configuration {
-                delegate?.contextMenuInteraction(self, willEndForConfiguration: configuarion)
-            }
+        if contextMenuController == nil, let configuarion = self.configuration {
+            delegate?.contextMenuInteraction(self, willEndForConfiguration: configuarion)
         }
 
         contextMenuController?.gestureDidEnd()
@@ -286,9 +291,11 @@ public class ChatHistoryContextMenuInteraction: ContextMenuInteraction {
     public override func menuAccessory(configuration: ContextMenuConfiguration) -> ContextMenuActionsAccessory {
         let menu = configuration.actionProvider?([]) ?? ContextMenu([])
         let isIncomingMessage = itemViewModel.interaction.interactionType() == .incomingMessage
+        let isMessageType = itemViewModel.interaction.interactionType() == .outgoingMessage || isIncomingMessage
         let alignment = ContextMenuTargetedPreviewAccessory.AccessoryAlignment(alignments: [(.bottom, .exterior), (isIncomingMessage ? .leading : .trailing, .interior)], alignmentOffset: CGPoint(x: 0, y: 12))
         let accessory = ContextMenuActionsAccessory(menu: menu, accessoryAlignment: alignment)
-        accessory.landscapeAccessoryAlignment = ContextMenuTargetedPreviewAccessory.AccessoryAlignment(alignments: [(.top, .interior), (isIncomingMessage ? .trailing : .leading, .exterior)], alignmentOffset: CGPoint(x: isIncomingMessage ? 12 : -12, y: 0))
+        let landscapeAlignmentOffset = isMessageType ? CGPoint(x: isIncomingMessage ? 12 : -12, y: 0) : alignment.alignmentOffset
+        accessory.landscapeAccessoryAlignment = ContextMenuTargetedPreviewAccessory.AccessoryAlignment(alignments: [isMessageType ? (.top, .interior) : (.bottom, .exterior), (isIncomingMessage ? .trailing : .leading, .exterior)], alignmentOffset: landscapeAlignmentOffset)
         accessory.delegate = self
         return accessory
     }
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVC.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVC.swift
index 68157ab1bf1..17d0418d0df 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVC.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+CVC.swift
@@ -150,7 +150,11 @@ extension ConversationViewController: CVLoadCoordinatorDelegate {
         }
 
         // If the message has been deleted / disappeared, we need to dismiss
-        dismissMessageActionsIfNecessary()
+        if FeatureFlags.contextMenus {
+            dismissMessageContextMenuIfNecessary()
+        } else {
+            dismissMessageActionsIfNecessary()
+        }
 
         showMessageRequestDialogIfRequiredAsync()
 
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController+MessageActions.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController+MessageActions.swift
index 35665f6725d..401420a2ef5 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController+MessageActions.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController+MessageActions.swift
@@ -99,6 +99,13 @@ extension ConversationViewController {
         self.messageActionsViewController != nil
     }
 
+    @objc
+    public func dismissMessageContextMenu(animated: Bool) {
+        if let collectionViewActiveContextMenuInteraction = self.collectionViewActiveContextMenuInteraction {
+            collectionViewActiveContextMenuInteraction.dismissMenu(animated: animated, completion: { })
+        }
+    }
+
     @objc
     public func dismissMessageActions(animated: Bool) {
         dismissMessageActions(animated: animated, completion: nil)
@@ -133,6 +140,12 @@ extension ConversationViewController {
         }
     }
 
+    func dismissMessageContextMenuIfNecessary() {
+        if shouldDismissMessageContextMenu {
+            dismissMessageContextMenu(animated: true)
+        }
+    }
+
     var shouldDismissMessageActions: Bool {
         guard let messageActionsViewController = messageActionsViewController else {
             return false
@@ -142,6 +155,16 @@ extension ConversationViewController {
         return self.indexPath(forInteractionUniqueId: messageActionInteractionId) == nil
     }
 
+    var shouldDismissMessageContextMenu: Bool {
+        guard let collectionViewActiveContextMenuInteraction = self.collectionViewActiveContextMenuInteraction else {
+            return false
+        }
+
+        let messageActionInteractionId = collectionViewActiveContextMenuInteraction.itemViewModel.interaction.uniqueId
+        // Check whether there is still a view item for this interaction.
+        return self.indexPath(forInteractionUniqueId: messageActionInteractionId) == nil
+    }
+
     public func reloadReactionsDetailSheet(transaction: SDSAnyReadTransaction) {
         AssertIsOnMainThread()
 
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController.swift b/Signal/src/ViewControllers/ConversationView/ConversationViewController.swift
index 8968b0d8ded..adfd15adfb2 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController.swift
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController.swift
@@ -377,7 +377,12 @@ public class ConversationViewController: OWSViewController {
 
         self.isViewCompletelyAppeared = false
 
-        dismissMessageActions(animated: false)
+        if FeatureFlags.contextMenus {
+            dismissMessageContextMenu(animated: false)
+        } else {
+            dismissMessageActions(animated: false)
+        }
+
         self.dismissReactionsDetailSheet(animated: false)
         self.saveLastVisibleSortIdAndOnScreenPercentage()
     }
@@ -482,7 +487,11 @@ public class ConversationViewController: OWSViewController {
 
         // Re-styling the message actions is tricky,
         // since this happens rarely just dismiss
-        dismissMessageActions(animated: false)
+        if FeatureFlags.contextMenus {
+            dismissMessageContextMenu(animated: false)
+        } else {
+            dismissMessageActions(animated: false)
+        }
         dismissReactionsDetailSheet(animated: false)
     }
 
@@ -528,7 +537,12 @@ public class ConversationViewController: OWSViewController {
 
         super.viewWillTransition(to: size, with: coordinator)
 
-        dismissMessageActions(animated: false)
+        if FeatureFlags.contextMenus {
+            dismissMessageContextMenu(animated: false)
+        } else {
+            dismissMessageActions(animated: false)
+        }
+
         dismissReactionsDetailSheet(animated: false)
 
         guard hasAppearedAndHasAppliedFirstLoad else {
diff --git a/Signal/src/ViewControllers/HomeView/HomeViewController.m b/Signal/src/ViewControllers/HomeView/HomeViewController.m
index cdd49104d30..9b713f8342d 100644
--- a/Signal/src/ViewControllers/HomeView/HomeViewController.m
+++ b/Signal/src/ViewControllers/HomeView/HomeViewController.m
@@ -547,7 +547,12 @@ - (void)showNewConversationView
     OWSLogInfo(@"");
 
     // Dismiss any message actions if they're presented
-    [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    if (SSKFeatureFlags.contextMenus) {
+        [self.conversationSplitViewController.selectedConversationViewController
+            dismissMessageContextMenuWithAnimated:YES];
+    } else {
+        [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    }
 
     ComposeViewController *viewController = [ComposeViewController new];
 
@@ -572,7 +577,12 @@ - (void)showNewGroupView
     OWSLogInfo(@"");
 
     // Dismiss any message actions if they're presented
-    [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    if (SSKFeatureFlags.contextMenus) {
+        [self.conversationSplitViewController.selectedConversationViewController
+            dismissMessageContextMenuWithAnimated:YES];
+    } else {
+        [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    }
 
     UIViewController *newGroupViewController = [NewGroupMembersViewController new];
 
@@ -667,7 +677,12 @@ - (void)unarchiveSelectedConversation
 - (void)showCameraView
 {
     // Dismiss any message actions if they're presented
-    [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    if (SSKFeatureFlags.contextMenus) {
+        [self.conversationSplitViewController.selectedConversationViewController
+            dismissMessageContextMenuWithAnimated:YES];
+    } else {
+        [self.conversationSplitViewController.selectedConversationViewController dismissMessageActionsWithAnimated:YES];
+    }
 
     [self ows_askForCameraPermissions:^(BOOL cameraGranted) {
         if (!cameraGranted) {
diff --git a/Signal/src/ViewControllers/HomeView/HomeViewController.swift b/Signal/src/ViewControllers/HomeView/HomeViewController.swift
index c958821c253..cc68d69db05 100644
--- a/Signal/src/ViewControllers/HomeView/HomeViewController.swift
+++ b/Signal/src/ViewControllers/HomeView/HomeViewController.swift
@@ -252,7 +252,11 @@ public extension HomeViewController {
         Logger.info("")
 
         // Dismiss any message actions if they're presented
-        conversationSplitViewController?.selectedConversationViewController?.dismissMessageActions(animated: true)
+        if FeatureFlags.contextMenus {
+            conversationSplitViewController?.selectedConversationViewController?.dismissMessageContextMenu(animated: true)
+        } else {
+            conversationSplitViewController?.selectedConversationViewController?.dismissMessageActions(animated: true)
+        }
 
         let navigationController = AppSettingsViewController.inModalNavigationController()
 
diff --git a/SignalServiceKit/src/Util/FeatureFlags.swift b/SignalServiceKit/src/Util/FeatureFlags.swift
index 66b8aa72225..1a5141b1906 100644
--- a/SignalServiceKit/src/Util/FeatureFlags.swift
+++ b/SignalServiceKit/src/Util/FeatureFlags.swift
@@ -181,7 +181,7 @@ public class FeatureFlags: BaseFlags {
     public static let chatColors = true
 
     @objc
-    public static let contextMenus = false
+    public static let contextMenus = build.includes(.qa)
 
     @objc
     public static let newLinkDeviceScheme = build.includes(.dev)
