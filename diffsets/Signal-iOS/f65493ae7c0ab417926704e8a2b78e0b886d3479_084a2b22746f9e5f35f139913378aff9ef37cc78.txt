diff --git a/Signal/src/Calls/UserInterface/Group/GroupCallMemberSheet.swift b/Signal/src/Calls/UserInterface/Group/GroupCallMemberSheet.swift
index 743fb854f36..8444bde5022 100644
--- a/Signal/src/Calls/UserInterface/Group/GroupCallMemberSheet.swift
+++ b/Signal/src/Calls/UserInterface/Group/GroupCallMemberSheet.swift
@@ -9,7 +9,6 @@ import SignalMessaging
 @objc
 class GroupCallMemberSheet: InteractiveSheetViewController {
     override var interactiveScrollViews: [UIScrollView] { [tableView] }
-    override var handlePosition: HandlePosition { .outside }
 
     let tableView = UITableView(frame: .zero, style: .grouped)
     let call: SignalCall
diff --git a/Signal/src/ViewControllers/AppSettings/Donations/BoostViewController.swift b/Signal/src/ViewControllers/AppSettings/Donations/BoostViewController.swift
index 729b7c4cd08..9289e49b8c6 100644
--- a/Signal/src/ViewControllers/AppSettings/Donations/BoostViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Donations/BoostViewController.swift
@@ -13,8 +13,6 @@ import SignalUI
 class BoostSheetView: InteractiveSheetViewController {
     let boostVC = BoostViewController()
     override var interactiveScrollViews: [UIScrollView] { [boostVC.tableView] }
-    override var minHeight: CGFloat { min(680, CurrentAppContext().frame.height - (view.safeAreaInsets.top + 32)) }
-    override var maximizedHeight: CGFloat { minHeight }
 
     // MARK: -
 
@@ -24,6 +22,8 @@ class BoostSheetView: InteractiveSheetViewController {
         contentView.addSubview(boostVC.view)
         boostVC.view.autoPinEdgesToSuperviewEdges()
         addChild(boostVC)
+
+        minimizedHeight = 680
     }
 }
 
diff --git a/Signal/src/ViewControllers/AppSettings/Donations/DonationViewsUtil.swift b/Signal/src/ViewControllers/AppSettings/Donations/DonationViewsUtil.swift
index 76b8c3b9d5c..d69a9cc28c4 100644
--- a/Signal/src/ViewControllers/AppSettings/Donations/DonationViewsUtil.swift
+++ b/Signal/src/ViewControllers/AppSettings/Donations/DonationViewsUtil.swift
@@ -58,8 +58,6 @@ public class SubscriptionReadMoreSheet: InteractiveSheetViewController {
     let contentScrollView = UIScrollView()
     let stackView = UIStackView()
     public override var interactiveScrollViews: [UIScrollView] { [contentScrollView] }
-    public override var minHeight: CGFloat { min(740, CurrentAppContext().frame.height - (view.safeAreaInsets.top + 32)) }
-    public override var maximizedHeight: CGFloat { minHeight }
     public override var sheetBackgroundColor: UIColor { Theme.tableView2PresentedBackgroundColor }
 
     // MARK: -
@@ -67,6 +65,8 @@ public class SubscriptionReadMoreSheet: InteractiveSheetViewController {
     override public func viewDidLoad() {
         super.viewDidLoad()
 
+        minimizedHeight = 740
+
         contentView.addSubview(contentScrollView)
 
         stackView.axis = .vertical
diff --git a/Signal/src/ViewControllers/ConversationView/Emoji Picker/EmojiPickerSheet.swift b/Signal/src/ViewControllers/ConversationView/Emoji Picker/EmojiPickerSheet.swift
index fb90d7cc41d..8add7ab338c 100644
--- a/Signal/src/ViewControllers/ConversationView/Emoji Picker/EmojiPickerSheet.swift	
+++ b/Signal/src/ViewControllers/ConversationView/Emoji Picker/EmojiPickerSheet.swift	
@@ -9,7 +9,6 @@ import SignalServiceKit
 @objc
 class EmojiPickerSheet: InteractiveSheetViewController {
     override var interactiveScrollViews: [UIScrollView] { [collectionView] }
-    override var handlePosition: HandlePosition { .outside }
 
     let completionHandler: (EmojiWithSkinTones?) -> Void
 
@@ -117,16 +116,6 @@ class EmojiPickerSheet: InteractiveSheetViewController {
 
     }
 
-    private func expandSheetAnimated() {
-        guard heightConstraint.constant != maximizedHeight else { return }
-
-        UIView.animate(withDuration: maxAnimationDuration, delay: 0, options: .curveEaseOut, animations: {
-            self.heightConstraint.constant = self.maximizedHeight
-            self.view.layoutIfNeeded()
-            self.backdropView?.alpha = 1
-        })
-    }
-
     @objc
     private func didSelectConfigureButton(sender: UIButton) {
         let configVC = EmojiReactionPickerConfigViewController()
@@ -150,7 +139,7 @@ extension EmojiPickerSheet: EmojiPickerSectionToolbarDelegate {
             collectionView.scrollToSectionHeader(section, animated: false)
         }
 
-        expandSheetAnimated()
+        maximizeHeight()
     }
 
     func emojiPickerSectionToolbarShouldShowRecentsSection(_ sectionToolbar: EmojiPickerSectionToolbar) -> Bool {
@@ -175,7 +164,7 @@ extension EmojiPickerSheet: EmojiPickerCollectionViewDelegate {
 
 extension EmojiPickerSheet: UISearchBarDelegate {
     func searchBarTextDidBeginEditing(_ searchBar: UISearchBar) {
-        expandSheetAnimated()
+        maximizeHeight()
     }
 
     func searchBar(_ searchBar: UISearchBar, textDidChange searchText: String) {
diff --git a/Signal/src/ViewControllers/ConversationView/Reactions Details/ReactionsDetailSheet.swift b/Signal/src/ViewControllers/ConversationView/Reactions Details/ReactionsDetailSheet.swift
index 9fff9554190..85aaf069339 100644
--- a/Signal/src/ViewControllers/ConversationView/Reactions Details/ReactionsDetailSheet.swift	
+++ b/Signal/src/ViewControllers/ConversationView/Reactions Details/ReactionsDetailSheet.swift	
@@ -15,7 +15,6 @@ class ReactionsDetailSheet: InteractiveSheetViewController {
     let emojiCountsCollectionView = EmojiCountsCollectionView()
 
     override var interactiveScrollViews: [UIScrollView] { emojiReactorsViews }
-    override var handlePosition: HandlePosition { .outside }
 
     private var emojiCounts: [InteractionReactionState.EmojiCount] {
         reactionState.emojiCounts
diff --git a/Signal/src/ViewControllers/ForwardMessageViewController.swift b/Signal/src/ViewControllers/ForwardMessageViewController.swift
index d503a9ea0eb..ee8e183316e 100644
--- a/Signal/src/ViewControllers/ForwardMessageViewController.swift
+++ b/Signal/src/ViewControllers/ForwardMessageViewController.swift
@@ -45,6 +45,8 @@ class ForwardMessageViewController: InteractiveSheetViewController {
         let placeholderText = NSLocalizedString("FORWARD_MESSAGE_TEXT_PLACEHOLDER",
                                                 comment: "Indicates that the user can add a text message to forwarded messages.")
         pickerVC.approvalTextMode = .active(placeholderText: placeholderText)
+
+        minimizedHeight = 576
     }
 
     required init() {
@@ -162,8 +164,6 @@ class ForwardMessageViewController: InteractiveSheetViewController {
 
         forwardMessageDelegate?.forwardMessageFlowDidCancel()
     }
-
-    override var minHeight: CGFloat { 576 }
 }
 
 // MARK: - Sending
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift
index 3f621f15880..f5e0a849067 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupRepliesAndViewsSheet.swift	
@@ -9,12 +9,7 @@ import SignalUI
 
 class StoryGroupRepliesAndViewsSheet: InteractiveSheetViewController, StoryGroupReplier {
     override var interactiveScrollViews: [UIScrollView] { [groupReplyViewController.tableView, viewsViewController.tableView] }
-    override var minHeight: CGFloat {
-        switch focusedTab {
-        case .views: return CurrentAppContext().frame.height * 0.6
-        case .replies: return maximizedHeight
-        }
-    }
+
     override var sheetBackgroundColor: UIColor { .ows_gray90 }
 
     weak var interactiveTransitionCoordinator: StoryInteractiveTransitionCoordinator?
@@ -59,6 +54,11 @@ class StoryGroupRepliesAndViewsSheet: InteractiveSheetViewController, StoryGroup
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        switch focusedTab {
+        case .views: minimizedHeight = CurrentAppContext().frame.height * 0.6
+        case .replies: minimizedHeight = super.maximizedHeight
+        }
+
         let vStack = UIStackView()
         vStack.axis = .vertical
         vStack.alignment = .center
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift
index 6060b249e43..69326102b85 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/Group Reply Sheet/StoryGroupReplySheet.swift	
@@ -8,7 +8,6 @@ import SignalServiceKit
 
 class StoryGroupReplySheet: InteractiveSheetViewController, StoryGroupReplier {
     override var interactiveScrollViews: [UIScrollView] { [groupReplyViewController.tableView] }
-    override var minHeight: CGFloat { maximizedHeight }
     override var sheetBackgroundColor: UIColor { .ows_gray90 }
 
     weak var interactiveTransitionCoordinator: StoryInteractiveTransitionCoordinator?
@@ -32,6 +31,8 @@ class StoryGroupReplySheet: InteractiveSheetViewController, StoryGroupReplier {
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        minimizedHeight = super.maximizedHeight
+
         addChild(groupReplyViewController)
         contentView.addSubview(groupReplyViewController.view)
         groupReplyViewController.view.autoPinEdgesToSuperviewEdges()
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryPrivateViewsSheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryPrivateViewsSheet.swift
index 34251e6e414..039031679f5 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryPrivateViewsSheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryPrivateViewsSheet.swift	
@@ -7,7 +7,6 @@ import SignalUI
 
 class StoryPrivateViewsSheet: InteractiveSheetViewController {
     override var interactiveScrollViews: [UIScrollView] { [viewsViewController.tableView] }
-    override var minHeight: CGFloat { CurrentAppContext().frame.height * 0.6 }
     override var sheetBackgroundColor: UIColor { .ows_gray90 }
 
     var dismissHandler: (() -> Void)?
@@ -26,6 +25,8 @@ class StoryPrivateViewsSheet: InteractiveSheetViewController {
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        minimizedHeight = CurrentAppContext().frame.height * 0.6
+
         addChild(viewsViewController)
         contentView.addSubview(viewsViewController.view)
         viewsViewController.view.autoPinEdgesToSuperviewEdges()
diff --git a/Signal/src/ViewControllers/LinkPreviewAttachmentViewController.swift b/Signal/src/ViewControllers/LinkPreviewAttachmentViewController.swift
index 05481a3644f..56eb5b5a5c8 100644
--- a/Signal/src/ViewControllers/LinkPreviewAttachmentViewController.swift
+++ b/Signal/src/ViewControllers/LinkPreviewAttachmentViewController.swift
@@ -126,21 +126,10 @@ class LinkPreviewAttachmentViewController: InteractiveSheetViewController {
                                                           verticalFittingPriority: .fittingSizeLevel)
         if sheetHeight != sheetSize.height {
             sheetHeight = sheetSize.height
-            heightConstraint.constant = sheetHeight
-            maxHeightConstraint.constant = sheetHeight
+            minimizedHeight = max(0, sheetHeight)
         }
     }
 
-    override var minHeight: CGFloat {
-        guard sheetHeight > 0 else { return super.minHeight }
-        return sheetHeight
-    }
-
-    override var maximizedHeight: CGFloat {
-        guard sheetHeight > 0 else { return super.maximizedHeight }
-        return sheetHeight
-    }
-
     private func updateUIOnLinkPreviewStateChange() {
         doneButton.isEnabled = linkPreview != nil
         updateSheetHeight()
diff --git a/SignalUI/ViewControllers/InteractiveSheetViewController.swift b/SignalUI/ViewControllers/InteractiveSheetViewController.swift
index 4c6db71752d..3202c5509a2 100644
--- a/SignalUI/ViewControllers/InteractiveSheetViewController.swift
+++ b/SignalUI/ViewControllers/InteractiveSheetViewController.swift
@@ -6,15 +6,35 @@ import Foundation
 import UIKit
 
 open class InteractiveSheetViewController: OWSViewController {
-    private let handleHeight: CGFloat = 5
-    private let handleInsideMargin: CGFloat = 12
 
-    public enum HandlePosition {
-        case outside
-        case inside
+    private enum Constants {
+        static let handleSize = CGSize(width: 36, height: 5)
+        static let handleInsideMargin: CGFloat = 12
+
+        /// Max height of the sheet has its top this far from the safe area top of the screen.
+        static let extraTopPadding: CGFloat = 32
+
+        static let defaultMinHeight: CGFloat = 346
+
+        static let maxAnimationDuration: TimeInterval = 0.3
+
+        /// Any absolute velocity below this amount counts as zero velocity, e.g. just releasing.
+        static let baseVelocityThreshhold: CGFloat = 200
+        /// Any upwards velocity greater this that amount maximizes the sheet.
+        static let maximizeVelocityThreshold: CGFloat = 500
+        /// Any downwards velocity greater than this amount dismisses the sheet.
+        static let dismissVelocityThreshold: CGFloat = 1000
     }
 
-    private let contentContainerView: UIStackView = {
+    private let sheetContainerView: UIView = {
+        let view = UIView()
+        view.layer.cornerRadius = 16
+        view.layer.maskedCorners = [.layerMinXMinYCorner, .layerMaxXMinYCorner]
+        view.layer.masksToBounds = true
+        return view
+    }()
+
+    private let sheetStackView: UIStackView = {
         let view = UIStackView()
         view.axis = .vertical
         return view
@@ -32,9 +52,7 @@ open class InteractiveSheetViewController: OWSViewController {
     public var backdropColor = Theme.backdropColor
 
     public var maxWidth: CGFloat { 512 }
-    open var minHeight: CGFloat { 346 }
 
-    open var handlePosition: HandlePosition { .inside }
     private let handle = UIView()
     private lazy var handleContainer = UIView()
 
@@ -52,41 +70,31 @@ open class InteractiveSheetViewController: OWSViewController {
         view = UIView()
         view.backgroundColor = .clear
 
-        view.addSubview(contentContainerView)
-        contentContainerView.autoPinEdge(toSuperviewEdge: .bottom)
-        contentContainerView.autoHCenterInSuperview()
-        contentContainerView.backgroundColor = sheetBackgroundColor
+        view.addSubview(sheetContainerView)
+        sheetContainerView.autoPinEdge(toSuperviewEdge: .bottom)
+        sheetContainerView.autoHCenterInSuperview()
+        sheetContainerView.backgroundColor = sheetBackgroundColor
 
         // Prefer to be full width, but don't exceed the maximum width
-        contentContainerView.autoSetDimension(.width, toSize: maxWidth, relation: .lessThanOrEqual)
-        contentContainerView.autoPinWidthToSuperview(relation: .lessThanOrEqual)
+        sheetContainerView.autoSetDimension(.width, toSize: maxWidth, relation: .lessThanOrEqual)
+        sheetContainerView.autoPinWidthToSuperview(relation: .lessThanOrEqual)
         NSLayoutConstraint.autoSetPriority(.defaultHigh) {
-            contentContainerView.autoPinWidthToSuperview()
+            sheetContainerView.autoPinWidthToSuperview()
         }
 
-        contentContainerView.layer.cornerRadius = 16
-        contentContainerView.layer.maskedCorners = [.layerMinXMinYCorner, .layerMaxXMinYCorner]
-        contentContainerView.layer.masksToBounds = true
+        sheetContainerView.addSubview(sheetStackView)
+        sheetStackView.autoPinEdgesToSuperviewEdges()
 
-        contentContainerView.addArrangedSubview(contentView)
+        sheetStackView.addArrangedSubview(contentView)
         contentView.autoPinWidthToSuperview()
 
-        handle.autoSetDimensions(to: CGSize(width: 36, height: handleHeight))
-        handle.layer.cornerRadius = handleHeight / 2
-        switch handlePosition {
-        case .outside:
-            view.addSubview(handle)
-            handle.backgroundColor = .ows_whiteAlpha80
-            handle.autoPinEdge(.bottom, to: .top, of: contentContainerView, withOffset: -8)
-        case .inside:
-            contentContainerView.insertArrangedSubview(handleContainer, at: 0)
-            handleContainer.autoPinWidthToSuperview()
-            handleContainer.addSubview(handle)
-            handleContainer.backgroundColor = contentContainerView.backgroundColor
-            handleContainer.isOpaque = true
-            handle.backgroundColor = Theme.tableView2PresentedSeparatorColor
-            handle.autoPinHeightToSuperview(withMargin: handleInsideMargin)
-        }
+        handle.autoSetDimensions(to: Constants.handleSize)
+        handle.layer.cornerRadius = Constants.handleSize.height / 2
+        sheetStackView.insertArrangedSubview(handleContainer, at: 0)
+        handleContainer.autoPinWidthToSuperview()
+        handleContainer.addSubview(handle)
+        handle.backgroundColor = Theme.tableView2PresentedSeparatorColor
+        handle.autoPinHeightToSuperview(withMargin: Constants.handleInsideMargin)
         handle.autoHCenterInSuperview()
 
         // Support tapping the backdrop to cancel the sheet.
@@ -101,15 +109,7 @@ open class InteractiveSheetViewController: OWSViewController {
     open override func themeDidChange() {
         super.themeDidChange()
 
-        contentContainerView.backgroundColor = sheetBackgroundColor
-
-        switch handlePosition {
-        case .outside:
-            break
-        case .inside:
-            handleContainer.backgroundColor = contentContainerView.backgroundColor
-            handle.backgroundColor = Theme.tableView2PresentedSeparatorColor
-        }
+        handle.backgroundColor = Theme.tableView2PresentedSeparatorColor
     }
 
     @objc
@@ -120,26 +120,105 @@ open class InteractiveSheetViewController: OWSViewController {
 
     // MARK: - Resize / Interactive Dismiss
 
-    public private(set) lazy var heightConstraint = contentContainerView.heightAnchor.constraint(equalToConstant: minimizedHeight)
-    public private(set) lazy var maxHeightConstraint = contentContainerView.heightAnchor.constraint(equalToConstant: maximizedHeight)
-    open var minimizedHeight: CGFloat {
-        return min(maximizedHeight, minHeight)
+    public final lazy var minimizedHeight: CGFloat = Constants.defaultMinHeight {
+        didSet {
+            guard isViewLoaded else {
+                return
+            }
+            sheetHeightMinConstraint.constant = minHeightForConstraint
+            if
+                !isInInteractiveTransition,
+                !isDismissingFromPanGesture,
+                sheetCurrentHeightConstraint.constant == oldValue
+                || sheetCurrentHeightConstraint.constant < minHeightForConstraint
+            {
+                sheetCurrentHeightConstraint.constant = minHeightForConstraint
+            }
+        }
     }
-    open var maximizedHeight: CGFloat {
-        return CurrentAppContext().frame.height - (view.safeAreaInsets.top + 32)
+
+    public final lazy var maximizedHeight: CGFloat = defaultMaximizedHeight {
+        didSet {
+            guard isViewLoaded else {
+                return
+            }
+            sheetHeightMaxConstraint.constant = maximizedHeight
+            if
+                !isInInteractiveTransition,
+                !isDismissingFromPanGesture,
+                sheetCurrentHeightConstraint.constant == oldValue
+                || sheetCurrentHeightConstraint.constant > maximizedHeight
+            {
+                sheetCurrentHeightConstraint.constant = maximizedHeight
+            }
+        }
+    }
+
+    private var minHeightForConstraint: CGFloat {
+        return min(minimizedHeight, maximizedHeight)
+    }
+
+    private lazy var sheetHeightMinConstraint = sheetContainerView.autoSetDimension(
+        .height,
+        toSize: minHeightForConstraint,
+        relation: .greaterThanOrEqual
+    )
+
+    private lazy var sheetHeightMaxConstraint = sheetContainerView.autoSetDimension(
+        .height,
+        toSize: maximizedHeight,
+        relation: .lessThanOrEqual
+    )
+
+    private lazy var sheetCurrentHeightConstraint = sheetContainerView.autoSetDimension(.height, toSize: minHeightForConstraint)
+
+    public func minimizeHeight(animated: Bool = true) {
+        sheetCurrentHeightConstraint.constant = minHeightForConstraint
+        guard animated else {
+            view.layoutIfNeeded()
+            return
+        }
+
+        view.setNeedsUpdateConstraints()
+        UIView.animate(
+            withDuration: Constants.maxAnimationDuration,
+            delay: 0,
+            options: .curveEaseOut,
+            animations: {
+                self.view.layoutIfNeeded()
+            }
+        )
     }
 
-    public func maximizeHeight() {
-        heightConstraint.constant = maximizedHeight
-        view.layoutIfNeeded()
+    public func maximizeHeight(animated: Bool = true) {
+        sheetCurrentHeightConstraint.constant = maximizedHeight
+        guard animated else {
+            view.layoutIfNeeded()
+            return
+        }
+
+        view.setNeedsUpdateConstraints()
+        UIView.animate(
+            withDuration: Constants.maxAnimationDuration,
+            delay: 0,
+            options: .curveEaseOut,
+            animations: {
+                self.view.layoutIfNeeded()
+            }
+        )
     }
 
-    public let maxAnimationDuration: TimeInterval = 0.2
+    // If either of these are set, min/max height changes will not take immediate effect.
+    private var isInInteractiveTransition = false
+    private var isDismissingFromPanGesture = false
+
     private var startingHeight: CGFloat?
     private var startingTranslation: CGFloat?
 
     private func setupInteractiveSizing() {
-        view.addConstraints( [ heightConstraint, maxHeightConstraint ] )
+        view.addConstraints([sheetCurrentHeightConstraint, sheetHeightMinConstraint, sheetHeightMaxConstraint])
+
+        sheetContainerView.autoSetDimension(.height, toSize: minimizedHeight, relation: .greaterThanOrEqual)
 
         // Create a pan gesture to handle when the user interacts with the
         // view outside of any scroll views we want to follow.
@@ -154,9 +233,15 @@ open class InteractiveSheetViewController: OWSViewController {
         interactiveScrollViews.forEach { $0.panGestureRecognizer.addTarget(self, action: #selector(handlePan)) }
     }
 
+    private lazy var defaultMaximizedHeight = CurrentAppContext().frame.height - (view.safeAreaInsets.top + Constants.extraTopPadding)
+
     open override func viewSafeAreaInsetsDidChange() {
         super.viewSafeAreaInsetsDidChange()
-        maxHeightConstraint.constant = maximizedHeight
+        let newDefaultMaxHeight = CurrentAppContext().frame.height - (view.safeAreaInsets.top + Constants.extraTopPadding)
+        if maximizedHeight == defaultMaximizedHeight {
+            maximizedHeight = newDefaultMaxHeight
+        }
+        defaultMaximizedHeight = newDefaultMaxHeight
     }
 
     @objc
@@ -194,43 +279,46 @@ open class InteractiveSheetViewController: OWSViewController {
             }
 
             // Update our height to reflect the new position
-            heightConstraint.constant = newHeight
+            sheetCurrentHeightConstraint.constant = newHeight
             view.layoutIfNeeded()
         case .ended, .cancelled, .failed:
-            guard let startingHeight = startingHeight else { break }
-
-            let dismissThreshold = startingHeight * 0.5
-            let growThreshold = startingHeight * 1.5
-            let velocityThreshold: CGFloat = 500
-
-            let currentHeight = contentContainerView.height
+            let currentHeight = sheetContainerView.height
             let currentVelocity = sender.velocity(in: view).y
 
-            enum CompletionState { case growing, dismissing, cancelling }
+            enum CompletionState { case growing, shrinking, dismissing }
             let completionState: CompletionState
 
-            if abs(currentVelocity) >= velocityThreshold {
-                if currentVelocity < 0 {
-                    completionState = .growing
-                } else {
-                    completionState = .dismissing
-                }
-            } else if currentHeight >= growThreshold {
+            if currentVelocity <= -Constants.maximizeVelocityThreshold {
                 completionState = .growing
-            } else if currentHeight <= dismissThreshold {
+            } else if currentVelocity >= Constants.dismissVelocityThreshold {
                 completionState = .dismissing
+            } else if currentHeight >= minHeightForConstraint {
+                if abs(currentVelocity) > Constants.baseVelocityThreshhold {
+                    completionState = currentVelocity > 0 ? .shrinking : .growing
+                } else {
+                    completionState =
+                        currentHeight < (maximizedHeight + minHeightForConstraint) / 2
+                        ? .shrinking : .growing
+                }
             } else {
-                completionState = .cancelling
+                if abs(currentVelocity) > Constants.baseVelocityThreshhold {
+                    completionState = currentVelocity > 0 ? .dismissing : .shrinking
+                } else {
+                    completionState =
+                        currentHeight < minHeightForConstraint / 2
+                        ? .dismissing : .shrinking
+                }
             }
 
             let finalHeight: CGFloat
             switch completionState {
             case .dismissing:
+                isDismissingFromPanGesture = true
                 finalHeight = 0
             case .growing:
                 finalHeight = maximizedHeight
-            case .cancelling:
-                finalHeight = startingHeight
+            case .shrinking:
+                finalHeight = minHeightForConstraint
             }
 
             let remainingDistance = finalHeight - currentHeight
@@ -240,28 +328,24 @@ open class InteractiveSheetViewController: OWSViewController {
             // very slowly) we'll default to `maxAnimationDuration`
             let remainingTime = TimeInterval(abs(remainingDistance / currentVelocity))
 
-            UIView.animate(withDuration: min(remainingTime, maxAnimationDuration), delay: 0, options: .curveEaseOut, animations: {
+            UIView.animate(withDuration: min(remainingTime, Constants.maxAnimationDuration), delay: 0, options: .curveEaseOut, animations: {
                 if remainingDistance < 0 {
-                    self.contentContainerView.frame.origin.y -= remainingDistance
-                    switch self.handlePosition {
-                    case .outside:
-                        self.handle.frame.origin.y -= remainingDistance
-                    case .inside:
-                        break
-                    }
+                    self.sheetContainerView.frame.origin.y -= remainingDistance
                 } else {
-                    self.heightConstraint.constant = finalHeight
+                    self.sheetCurrentHeightConstraint.constant = finalHeight
                     self.view.layoutIfNeeded()
                 }
 
                 self.backdropView?.alpha = completionState == .dismissing ? 0 : 1
             }) { _ in
-                self.heightConstraint.constant = finalHeight
+                self.sheetCurrentHeightConstraint.constant = finalHeight
                 self.view.layoutIfNeeded()
 
                 if completionState == .dismissing {
                     self.willDismissInteractively()
-                    self.dismiss(animated: true, completion: nil)
+                    self.dismiss(animated: true, completion: { [weak self] in
+                        self?.isDismissingFromPanGesture = false
+                    })
                 }
             }
 
@@ -272,7 +356,7 @@ open class InteractiveSheetViewController: OWSViewController {
             backdropView?.alpha = 1
 
             guard let startingHeight = startingHeight else { break }
-            heightConstraint.constant = startingHeight
+            sheetCurrentHeightConstraint.constant = startingHeight
         }
     }
 
@@ -282,24 +366,29 @@ open class InteractiveSheetViewController: OWSViewController {
         // If we're at the top of the scrollView, the view is not
         // currently maximized, or we're panning outside of the scroll
         // view we want to do an interactive transition.
-        guard (panningScrollView != nil && panningScrollView!.contentOffset.y <= 0)
-                || contentContainerView.height < maxHeightConstraint.constant
-                || panningScrollView == nil else { return false }
+        guard
+            (panningScrollView != nil && panningScrollView!.contentOffset.y <= 0)
+            || sheetContainerView.height < maximizedHeight
+            || panningScrollView == nil
+        else {
+            return false
+        }
 
         if startingTranslation == nil {
             startingTranslation = sender.translation(in: view).y
         }
 
         if startingHeight == nil {
-            startingHeight = contentContainerView.height
+            startingHeight = sheetContainerView.height
         }
-
+        isInInteractiveTransition = true
         return true
     }
 
     private func resetInteractiveTransition(panningScrollView: UIScrollView?) {
         startingTranslation = nil
         startingHeight = nil
+        isInInteractiveTransition = false
         panningScrollView?.showsVerticalScrollIndicator = true
     }
 }
@@ -310,7 +399,7 @@ extension InteractiveSheetViewController: UIGestureRecognizerDelegate {
         switch gestureRecognizer {
         case is UITapGestureRecognizer:
             let point = gestureRecognizer.location(in: view)
-            guard !contentContainerView.frame.contains(point) else { return false }
+            guard !sheetContainerView.frame.contains(point) else { return false }
             return true
         default:
             return true
diff --git a/SignalUI/ViewControllers/OWSTableSheetViewController.swift b/SignalUI/ViewControllers/OWSTableSheetViewController.swift
index b9a4d15ca5c..e2e255af20f 100644
--- a/SignalUI/ViewControllers/OWSTableSheetViewController.swift
+++ b/SignalUI/ViewControllers/OWSTableSheetViewController.swift
@@ -13,6 +13,19 @@ open class OWSTableSheetViewController: InteractiveSheetViewController {
         OWSTableViewController2.tableBackgroundColor(isUsingPresentedStyle: true)
     }
 
+    open var bottomSafeAreaContentPadding: CGFloat {
+        var padding = view.safeAreaInsets.bottom
+        if padding == 0 {
+            // For home button devices, add generous bottom padding
+            // so it isn't right up on the edge.
+            padding = 36
+        } else {
+            // For other devices, just add a touch extra.
+            padding += 12
+        }
+        return padding
+    }
+
     private var contentSizeHeight: CGFloat {
         let tableView = tableViewController.tableView
         // The `adjustedContentInset` property diverges from its stable value during
@@ -20,19 +33,26 @@ open class OWSTableSheetViewController: InteractiveSheetViewController {
         // Instead, compute the height using `view.safeAreaInsets`, which remains stable
         // during animations. (Note that `.top` isn't considered here since
         // `maximumHeight` prevents the view's height from extending into top safe area.)
-        return tableView.contentSize.height + tableView.contentInset.totalHeight + view.safeAreaInsets.bottom
-    }
-    public override var minimizedHeight: CGFloat {
-        return min(contentSizeHeight, maximizedHeight)
-    }
-    public override var maximizedHeight: CGFloat {
-        min(contentSizeHeight, CurrentAppContext().frame.height - (view.safeAreaInsets.top + 32))
+        return tableView.contentSize.height
+            + tableView.contentInset.totalHeight
+            + bottomSafeAreaContentPadding
     }
 
+    private var contentSizeObservation: NSKeyValueObservation?
+
     public required init() {
         super.init()
 
         tableViewController.shouldDeferInitialLoad = false
+
+        contentSizeObservation = tableViewController.tableView.observe(\.contentSize, changeHandler: { [weak self] (_, _) in
+            guard let self = self else { return }
+            self.minimizedHeight = self.contentSizeHeight
+        })
+    }
+
+    deinit {
+        contentSizeObservation?.invalidate()
     }
 
     public override func viewDidLoad() {
@@ -42,6 +62,8 @@ open class OWSTableSheetViewController: InteractiveSheetViewController {
         contentView.addSubview(tableViewController.view)
         tableViewController.view.autoPinEdgesToSuperviewEdges()
 
+        minimizedHeight = contentSizeHeight
+
         updateViewState()
     }
 
@@ -61,15 +83,6 @@ open class OWSTableSheetViewController: InteractiveSheetViewController {
         // The table view might not have its final size when this method is called.
         // Run a layout pass so that we compute the correct height constraints.
         self.tableViewController.tableView.layoutIfNeeded()
-        // This comparison isn't redundant: assigning same value to `heightConstraint.constant`
-        // triggers a layout cycle and therefore this method, where height being reset to a previous value,
-        // killing interactive dismiss.
-        let minimizedHeight = minimizedHeight
-        if minimizedHeight != previousMinimizedHeight {
-            heightConstraint.constant = minimizedHeight
-            previousMinimizedHeight = minimizedHeight
-        }
-        maxHeightConstraint.constant = maximizedHeight
     }
 
     public override func themeDidChange() {
