diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index a5bb0c43afe..7725fd96411 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -412,6 +412,7 @@
 		34C3C7922040B0DD0000134C /* OWSAudioPlayer.h in Headers */ = {isa = PBXBuildFile; fileRef = 34C3C7902040B0DC0000134C /* OWSAudioPlayer.h */; settings = {ATTRIBUTES = (Public, ); }; };
 		34C3C7932040B0DD0000134C /* OWSAudioPlayer.m in Sources */ = {isa = PBXBuildFile; fileRef = 34C3C7912040B0DC0000134C /* OWSAudioPlayer.m */; };
 		34C529092361D3540009DB2A /* ApprovalFooterView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34C529082361D3530009DB2A /* ApprovalFooterView.swift */; };
+		34C53A78261E275900B18285 /* OWSVisualEffectView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34C53A77261E275900B18285 /* OWSVisualEffectView.swift */; };
 		34C6B0A91FA0E46F00D35993 /* test-gif.gif in Resources */ = {isa = PBXBuildFile; fileRef = 34C6B0A51FA0E46F00D35993 /* test-gif.gif */; };
 		34C6B0AB1FA0E46F00D35993 /* test-mp3.mp3 in Resources */ = {isa = PBXBuildFile; fileRef = 34C6B0A71FA0E46F00D35993 /* test-mp3.mp3 */; };
 		34C6B0AC1FA0E46F00D35993 /* test-mp4.mp4 in Resources */ = {isa = PBXBuildFile; fileRef = 34C6B0A81FA0E46F00D35993 /* test-mp4.mp4 */; };
@@ -1446,6 +1447,7 @@
 		34C3C7902040B0DC0000134C /* OWSAudioPlayer.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = OWSAudioPlayer.h; sourceTree = "<group>"; };
 		34C3C7912040B0DC0000134C /* OWSAudioPlayer.m */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.objc; path = OWSAudioPlayer.m; sourceTree = "<group>"; };
 		34C529082361D3530009DB2A /* ApprovalFooterView.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = ApprovalFooterView.swift; sourceTree = "<group>"; };
+		34C53A77261E275900B18285 /* OWSVisualEffectView.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = OWSVisualEffectView.swift; sourceTree = "<group>"; };
 		34C6B0A51FA0E46F00D35993 /* test-gif.gif */ = {isa = PBXFileReference; lastKnownFileType = image.gif; path = "test-gif.gif"; sourceTree = "<group>"; };
 		34C6B0A71FA0E46F00D35993 /* test-mp3.mp3 */ = {isa = PBXFileReference; lastKnownFileType = audio.mp3; path = "test-mp3.mp3"; sourceTree = "<group>"; };
 		34C6B0A81FA0E46F00D35993 /* test-mp4.mp4 */ = {isa = PBXFileReference; lastKnownFileType = file; path = "test-mp4.mp4"; sourceTree = "<group>"; };
@@ -2671,6 +2673,7 @@
 				347C381C252CE69400F3D941 /* CVStackView.swift */,
 				3470C8812559B23F00F5847C /* CVUpdate.swift */,
 				345772B5257E4E01001D7D44 /* CVViewStateSnapshot.swift */,
+				34C53A77261E275900B18285 /* OWSVisualEffectView.swift */,
 			);
 			path = CV;
 			sourceTree = "<group>";
@@ -5270,6 +5273,7 @@
 				88D23D2623CEC0C700B0E74B /* CallUIAdapter.swift in Sources */,
 				34FB6A5325D2D10400E599B1 /* PaymentsViewUtils.swift in Sources */,
 				E44AD4E624E98F440035D7B8 /* PhotoCaptureDismiss.swift in Sources */,
+				34C53A78261E275900B18285 /* OWSVisualEffectView.swift in Sources */,
 				3236FCC42592B67B006D33B9 /* NameCollisionReviewCell.swift in Sources */,
 				4542DF54208D40AC007B4E76 /* LoadingViewController.swift in Sources */,
 				347C3832252CE69400F3D941 /* CVCell.swift in Sources */,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponent.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponent.swift
index eb0e80ed194..448abf22683 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponent.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponent.swift
@@ -273,13 +273,13 @@ extension CVComponentBase: CVNode {
 // MARK: -
 
 extension CVComponentBase {
-    public func buildBlurView(conversationStyle: ConversationStyle) -> UIVisualEffectView {
-        let blurView = UIVisualEffectView(effect: UIBlurEffect(style: .regular))
-        let blurOverlay = UIView()
-        blurOverlay.backgroundColor = conversationStyle.isDarkThemeEnabled ? .ows_blackAlpha40 : .ows_whiteAlpha60
-        blurView.contentView.addSubview(blurOverlay)
-        blurOverlay.autoPinEdgesToSuperviewEdges()
-        return blurView
+    public func buildBlurView(conversationStyle: ConversationStyle) -> OWSVisualEffectView {
+        let effect = UIBlurEffect(style: .regular)
+        let overlayBackgroundColor: UIColor = (conversationStyle.isDarkThemeEnabled
+                                                ? .ows_blackAlpha40
+                                                : .ows_whiteAlpha60)
+        return OWSVisualEffectView(effect: effect,
+                                   overlayBackgroundColor: overlayBackgroundColor)
     }
 }
 
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentAudioAttachment.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentAudioAttachment.swift
index ed252218ddb..d6a9541d5d7 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentAudioAttachment.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentAudioAttachment.swift
@@ -63,7 +63,7 @@ public class CVComponentAudioAttachment: CVComponentBase, CVComponent {
                                                  isIncoming: isIncoming,
                                                  conversationStyle: conversationStyle,
                                                  measurementBuilder: measurementBuilder).ceil
-        let audioInfo = ManualStackSubviewInfo(measuredSize: audioSize)
+        let audioInfo = audioSize.asManualSubviewInfo
         let stackMeasurement = ManualStackView.measure(config: stackViewConfig,
                                                        measurementBuilder: measurementBuilder,
                                                        measurementKey: Self.measurementKey_stackView,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
index 81a2a100223..0dca56a6fa8 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyMedia.swift
@@ -269,7 +269,7 @@ public class CVComponentBodyMedia: CVComponentBase, CVComponent {
                                                     minWidth: minWidth,
                                                     items: self.items,
                                                     measurementBuilder: measurementBuilder).ceil
-        let albumInfo = ManualStackSubviewInfo(measuredSize: albumSize)
+        let albumInfo = albumSize.asManualSubviewInfo
         let stackMeasurement = ManualStackView.measure(config: stackConfig,
                                                        measurementBuilder: measurementBuilder,
                                                        measurementKey: Self.measurementKey_stackView,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
index 4506f6db424..aefd3ffe354 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBodyText.swift
@@ -481,7 +481,7 @@ public class CVComponentBodyText: CVComponentBase, CVComponent {
                 return CVText.measureLabel(config: labelConfigForRemotelyDeleted, maxWidth: maxWidth).ceil
             }
         }()
-        let textInfo = ManualStackSubviewInfo(measuredSize: textSize)
+        let textInfo = textSize.asManualSubviewInfo
         let stackMeasurement = ManualStackView.measure(config: stackViewConfig,
                                                         measurementBuilder: measurementBuilder,
                                                         measurementKey: Self.measurementKey_stackView,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBottomButtons.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBottomButtons.swift
index c050b7d04da..856056a7d85 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBottomButtons.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentBottomButtons.swift
@@ -64,7 +64,7 @@ public class CVComponentBottomButtons: CVComponentBase, CVComponent {
         let subviewSize = CGSize(width: maxWidth, height: Self.buttonHeight)
         var subviewInfos = [ManualStackSubviewInfo]()
         for _ in 0 ..< actions.count {
-            subviewInfos.append(ManualStackSubviewInfo(measuredSize: subviewSize))
+            subviewInfos.append(subviewSize.asManualSubviewInfo)
         }
         let stackMeasurement = ManualStackView.measure(config: stackConfig,
                                                        measurementBuilder: measurementBuilder,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentDateHeader.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentDateHeader.swift
index 4b2a0eac6ba..fb1fc857f74 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentDateHeader.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentDateHeader.swift
@@ -41,18 +41,11 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
             owsAssertDebug(cellView.subviews.isEmpty)
 
             cellView.addSubview(rootView)
-            cellView.layoutMargins = cellLayoutMargins
-            rootView.autoPinEdgesToSuperviewMargins()
+            cellView.layoutMargins = .zero
+            rootView.autoPinEdgesToSuperviewEdges()
         }
     }
 
-    private var cellLayoutMargins: UIEdgeInsets {
-        UIEdgeInsets(top: 0,
-                     leading: conversationStyle.headerGutterLeading,
-                     bottom: 0,
-                     trailing: conversationStyle.headerGutterTrailing)
-    }
-
     public func buildComponentView(componentDelegate: CVComponentDelegate) -> CVComponentView {
         CVComponentViewDateHeader()
     }
@@ -65,10 +58,11 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
             return
         }
 
-        titleLabelConfig.applyForRendering(label: componentView.titleLabel)
+        let outerStack = componentView.outerStack
+        let innerStack = componentView.innerStack
 
-        let vStackView = componentView.vStackView
         let titleLabel = componentView.titleLabel
+        titleLabelConfig.applyForRendering(label: titleLabel)
 
         let themeHasChanged = conversationStyle.isDarkThemeEnabled != componentView.isDarkThemeEnabled
         componentView.isDarkThemeEnabled = conversationStyle.isDarkThemeEnabled
@@ -80,34 +74,34 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
         let isReusing = componentView.rootView.superview != nil
 
         if !isReusing || themeHasChanged || wallpaperModeHasChanged {
+            innerStack.reset()
+            outerStack.reset()
             titleLabel.removeFromSuperview()
             componentView.blurView?.removeFromSuperview()
             componentView.blurView = nil
 
             let contentView: UIView = {
                 if hasWallpaper {
+                    // blurView replaces innerStack, using the same size, layoutMargins, etc.
                     let blurView = buildBlurView(conversationStyle: conversationStyle)
                     componentView.blurView = blurView
-                    blurView.autoPinEdgesToSuperviewEdges()
                     blurView.clipsToBounds = true
                     blurView.layer.cornerRadius = 8
-                    blurView.contentView.addSubview(titleLabel)
-                    titleLabel.autoPinEdgesToSuperviewEdges(withInsets: titleMargins)
+                    blurView.addContentSubview(titleLabel,
+                                               withInsets: innerStackConfig.layoutMargins)
                     return blurView
                 } else {
-                    let noBlurView = componentView.noBlurView
-                    noBlurView.reset()
-                    noBlurView.configure(config: noBlurConfig,
+                    innerStack.configure(config: innerStackConfig,
                                          cellMeasurement: cellMeasurement,
-                                         measurementKey: Self.measurementKey_noBlur,
+                                         measurementKey: Self.measurementKey_innerStack,
                                          subviews: [ titleLabel ])
-                    return noBlurView
+                    return innerStack
                 }
             }()
-            vStackView.reset()
-            vStackView.configure(config: vStackConfig,
+
+            outerStack.configure(config: outerStackConfig,
                                  cellMeasurement: cellMeasurement,
-                                 measurementKey: Self.measurementKey_vStackView,
+                                 measurementKey: Self.measurementKey_outerStack,
                                  subviews: [ contentView ])
         }
 
@@ -130,49 +124,45 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
                              textAlignment: .center)
     }
 
-    private var titleMargins: UIEdgeInsets { UIEdgeInsets(hMargin: 10, vMargin: 4) }
-
-    private var vStackConfig: CVStackViewConfig {
+    private var outerStackConfig: CVStackViewConfig {
         CVStackViewConfig(axis: .vertical,
                           alignment: .center,
                           spacing: 0,
-                          layoutMargins: .zero)
+                          layoutMargins: UIEdgeInsets(top: 0,
+                                                      leading: conversationStyle.headerGutterLeading,
+                                                      bottom: 0,
+                                                      trailing: conversationStyle.headerGutterTrailing))
     }
 
-    private var noBlurConfig: CVStackViewConfig {
+    private var innerStackConfig: CVStackViewConfig {
         CVStackViewConfig(axis: .vertical,
                           alignment: .center,
                           spacing: 0,
-                          layoutMargins: titleMargins)
+                          layoutMargins: UIEdgeInsets(hMargin: 10, vMargin: 4))
     }
 
-    private static let measurementKey_vStackView = "CVComponentDateHeader.measurementKey_vStackView"
-    private static let measurementKey_noBlur = "CVComponentDateHeader.measurementKey_noBlur"
+    private static let measurementKey_outerStack = "CVComponentDateHeader.measurementKey_outerStack"
+    private static let measurementKey_innerStack = "CVComponentDateHeader.measurementKey_innerStack"
 
     public func measure(maxWidth: CGFloat, measurementBuilder: CVCellMeasurement.Builder) -> CGSize {
         owsAssertDebug(maxWidth > 0)
 
-        let cellLayoutMargins = self.cellLayoutMargins
-
         let availableWidth = max(0, maxWidth -
-                                    (cellLayoutMargins.totalWidth +
-                                        noBlurConfig.layoutMargins.totalWidth +
-                                        vStackConfig.layoutMargins.totalWidth))
+                                    (innerStackConfig.layoutMargins.totalWidth +
+                                        outerStackConfig.layoutMargins.totalWidth))
         let labelSize = CVText.measureLabel(config: titleLabelConfig, maxWidth: availableWidth)
 
-        let labelInfo = ManualStackSubviewInfo(measuredSize: labelSize)
-        let noBlurMeasurement = ManualStackView.measure(config: noBlurConfig,
+        let labelInfo = labelSize.asManualSubviewInfo
+        let innerStackMeasurement = ManualStackView.measure(config: innerStackConfig,
+                                                            measurementBuilder: measurementBuilder,
+                                                            measurementKey: Self.measurementKey_innerStack,
+                                                            subviewInfos: [ labelInfo ])
+        let innerStackInfo = innerStackMeasurement.measuredSize.asManualSubviewInfo
+        let outerStackMeasurement = ManualStackView.measure(config: outerStackConfig,
                                                         measurementBuilder: measurementBuilder,
-                                                        measurementKey: Self.measurementKey_noBlur,
-                                                        subviewInfos: [ labelInfo ])
-
-        let noBlurInfo = ManualStackSubviewInfo(measuredSize: noBlurMeasurement.measuredSize)
-        let vStackMeasurement = ManualStackView.measure(config: vStackConfig,
-                                                        measurementBuilder: measurementBuilder,
-                                                        measurementKey: Self.measurementKey_vStackView,
-                                                        subviewInfos: [ noBlurInfo ])
-
-        return vStackMeasurement.measuredSize + cellLayoutMargins.totalSize
+                                                        measurementKey: Self.measurementKey_outerStack,
+                                                        subviewInfos: [ innerStackInfo ])
+        return outerStackMeasurement.measuredSize
     }
 
     // MARK: -
@@ -182,11 +172,11 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
     @objc
     public class CVComponentViewDateHeader: NSObject, CVComponentView {
 
-        fileprivate let vStackView = ManualStackView(name: "dateHeader.vStackView")
+        fileprivate let outerStack = ManualStackView(name: "dateHeader.outerStackView")
+        fileprivate let innerStack = ManualStackView(name: "dateHeader.innerStackView")
         fileprivate let titleLabel = UILabel()
 
         fileprivate var blurView: UIVisualEffectView?
-        fileprivate let noBlurView = ManualStackView(name: "dateHeader.noBlurView")
 
         fileprivate var hasWallpaper = false
         fileprivate var isDarkThemeEnabled = false
@@ -194,7 +184,7 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
         public var isDedicatedCellView = false
 
         public var rootView: UIView {
-            vStackView
+            outerStack
         }
 
         // MARK: -
@@ -208,16 +198,14 @@ public class CVComponentDateHeader: CVComponentBase, CVRootComponent {
             owsAssertDebug(isDedicatedCellView)
 
             if !isDedicatedCellView {
-                vStackView.reset()
+                outerStack.reset()
+                innerStack.reset()
 
                 titleLabel.removeFromSuperview()
 
                 blurView?.removeFromSuperview()
                 blurView = nil
 
-                noBlurView.reset()
-                noBlurView.removeFromSuperview()
-
                 hasWallpaper = false
                 isDarkThemeEnabled = false
             }
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
index fb96ee33d21..24044709f2d 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentFooter.swift
@@ -294,39 +294,34 @@ public class CVComponentFooter: CVComponentBase, CVComponent {
             var tapForMoreSize = CVText.measureLabel(config: tapForMoreLabelConfig,
                                                      maxWidth: maxWidth)
             tapForMoreSize.height *= tapForMoreHeightFactor
-            outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: tapForMoreSize,
-                                                            hasFixedWidth: true))
+            outerSubviewInfos.append(tapForMoreSize.asManualSubviewInfo(hasFixedWidth: true))
         }
 
         // We always use a stretching spacer.
-        outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: .zero))
+        outerSubviewInfos.append(ManualStackSubviewInfo.empty)
 
         // The color doesn't matter for measurement.
         let timestampLabelConfig = self.timestampLabelConfig(textColor: UIColor.black)
         let timestampLabelSize = CVText.measureLabel(config: timestampLabelConfig,
                                                  maxWidth: maxWidth)
-        innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: timestampLabelSize,
-                                                        hasFixedWidth: true))
+        innerSubviewInfos.append(timestampLabelSize.asManualSubviewInfo(hasFixedWidth: true))
 
         if hasPerConversationExpiration,
            nil != interaction as? TSMessage {
             let timerSize = OWSMessageTimerView.measureSize()
-            innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: timerSize,
-                                                            hasFixedWidth: true))
+            innerSubviewInfos.append(timerSize.asManualSubviewInfo(hasFixedWidth: true))
         }
 
         if let statusIndicator = self.statusIndicator {
             let statusSize = statusIndicator.imageSize
-            innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: statusSize,
-                                                            hasFixedWidth: true))
+            innerSubviewInfos.append(statusSize.asManualSubviewInfo(hasFixedWidth: true))
         }
 
         let innerStackMeasurement = ManualStackView.measure(config: innerStackConfig,
                                                             measurementBuilder: measurementBuilder,
                                                             measurementKey: Self.measurementKey_innerStack,
                                                             subviewInfos: innerSubviewInfos)
-        outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: innerStackMeasurement.measuredSize,
-                                                        hasFixedWidth: true))
+        outerSubviewInfos.append(innerStackMeasurement.measuredSize.asManualSubviewInfo(hasFixedWidth: true))
         if isIncoming {
             outerSubviewInfos.reverse()
         }
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentThreadDetails.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentThreadDetails.swift
index 503fe1878a1..240c3a7621a 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentThreadDetails.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentThreadDetails.swift
@@ -58,31 +58,30 @@ public class CVComponentThreadDetails: CVComponentBase, CVRootComponent {
             return
         }
 
-        let outerView = componentView.outerView
-        outerView.insetsLayoutMarginsFromSafeArea = false
-        outerView.layoutMargins = outerViewLayoutMargins
+        let outerStackView = componentView.outerStackView
+        let innerStackView = componentView.innerStackView
 
-        let stackView = componentView.stackView
-        stackView.insetsLayoutMarginsFromSafeArea = false
-        stackView.apply(config: stackViewConfig)
+        innerStackView.reset()
+        outerStackView.reset()
 
-        outerView.addSubview(stackView)
-        stackView.autoPinEdgesToSuperviewMargins()
+        outerStackView.insetsLayoutMarginsFromSafeArea = false
+        innerStackView.insetsLayoutMarginsFromSafeArea = false
+
+        var innerViews = [UIView]()
 
         let avatarView = AvatarImageView(image: self.avatarImage)
         componentView.avatarView = avatarView
         avatarView.autoSetDimensions(to: CGSize(square: avatarDiameter))
         avatarView.setContentHuggingHigh()
         avatarView.setCompressionResistanceHigh()
-        stackView.addArrangedSubview(avatarView)
-        stackView.addArrangedSubview(UIView.spacer(withHeight: 1))
+        innerViews.append(avatarView)
+        innerViews.append(UIView.spacer(withHeight: 1))
 
         if conversationStyle.hasWallpaper {
             let blurView = buildBlurView(conversationStyle: conversationStyle)
             componentView.blurView = blurView
 
-            stackView.insertSubview(blurView, at: 0)
-            blurView.autoPinEdgesToSuperviewEdges()
+            innerStackView.addSubviewToFillSuperviewEdges(blurView)
 
             blurView.clipsToBounds = true
             blurView.layer.cornerRadius = 12
@@ -90,28 +89,38 @@ public class CVComponentThreadDetails: CVComponentBase, CVRootComponent {
 
         let titleLabel = componentView.titleLabel
         titleLabelConfig.applyForRendering(label: titleLabel)
-        stackView.addArrangedSubview(titleLabel)
+        innerViews.append(titleLabel)
 
         if let bioText = self.bioText {
             let bioLabel = componentView.bioLabel
             bioLabelConfig(text: bioText).applyForRendering(label: bioLabel)
-            stackView.addArrangedSubview(UIView.spacer(withHeight: vSpacingSubtitle))
-            stackView.addArrangedSubview(bioLabel)
+            innerViews.append(UIView.spacer(withHeight: vSpacingSubtitle))
+            innerViews.append(bioLabel)
         }
 
         if let detailsText = self.detailsText {
             let detailsLabel = componentView.detailsLabel
             detailsLabelConfig(text: detailsText).applyForRendering(label: detailsLabel)
-            stackView.addArrangedSubview(UIView.spacer(withHeight: vSpacingSubtitle))
-            stackView.addArrangedSubview(detailsLabel)
+            innerViews.append(UIView.spacer(withHeight: vSpacingSubtitle))
+            innerViews.append(detailsLabel)
         }
 
         if let mutualGroupsText = self.mutualGroupsText {
             let mutualGroupsLabel = componentView.mutualGroupsLabel
             mutualGroupsLabelConfig(attributedText: mutualGroupsText).applyForRendering(label: mutualGroupsLabel)
-            stackView.addArrangedSubview(UIView.spacer(withHeight: vSpacingMutualGroups))
-            stackView.addArrangedSubview(mutualGroupsLabel)
+            innerViews.append(UIView.spacer(withHeight: vSpacingMutualGroups))
+            innerViews.append(mutualGroupsLabel)
         }
+
+        innerStackView.configure(config: innerStackConfig,
+                                 cellMeasurement: cellMeasurement,
+                                 measurementKey: Self.measurementKey_innerStack,
+                                 subviews: innerViews)
+        let outerViews = [ innerStackView ]
+        outerStackView.configure(config: outerStackConfig,
+                                 cellMeasurement: cellMeasurement,
+                                 measurementKey: Self.measurementKey_outerStack,
+                                 subviews: outerViews)
     }
 
     private let vSpacingSubtitle: CGFloat = 2
@@ -343,52 +352,68 @@ public class CVComponentThreadDetails: CVComponentBase, CVRootComponent {
                                               mutualGroupsText: nil)
     }
 
-    private var stackViewConfig: CVStackViewConfig {
+    private var outerStackConfig: CVStackViewConfig {
+        CVStackViewConfig(axis: .vertical,
+                          alignment: .fill,
+                          spacing: 0,
+                          layoutMargins: UIEdgeInsets(top: 32, left: 32, bottom: 16, right: 32))
+    }
+
+    private var innerStackConfig: CVStackViewConfig {
         CVStackViewConfig(axis: .vertical,
                           alignment: .center,
                           spacing: 3,
                           layoutMargins: UIEdgeInsets(top: 24, leading: 16, bottom: 24, trailing: 16))
     }
 
-    private var outerViewLayoutMargins = UIEdgeInsets(top: 32, left: 32, bottom: 16, right: 32)
+    private static let measurementKey_outerStack = "CVComponentThreadDetails.measurementKey_outerStack"
+    private static let measurementKey_innerStack = "CVComponentThreadDetails.measurementKey_innerStack"
 
     public func measure(maxWidth: CGFloat, measurementBuilder: CVCellMeasurement.Builder) -> CGSize {
         owsAssertDebug(maxWidth > 0)
 
-        let maxContentWidth = maxWidth - (stackViewConfig.layoutMargins.totalWidth + outerViewLayoutMargins.totalWidth)
+        var innerSubviewInfos = [ManualStackSubviewInfo]()
+
+        let maxContentWidth = maxWidth - (outerStackConfig.layoutMargins.totalWidth +
+                                            innerStackConfig.layoutMargins.totalWidth)
 
-        var subviewSizes = [CGSize]()
-        subviewSizes.append(CGSize(square: avatarDiameter))
-        subviewSizes.append(CGSize(square: 1))
+        innerSubviewInfos.append(CGSize(square: avatarDiameter).asManualSubviewInfo)
+        innerSubviewInfos.append(CGSize(square: 1).asManualSubviewInfo)
 
         let titleSize = CVText.measureLabel(config: titleLabelConfig, maxWidth: maxContentWidth)
-        subviewSizes.append(titleSize)
+        innerSubviewInfos.append(titleSize.asManualSubviewInfo)
 
         if let bioText = self.bioText {
             let bioSize = CVText.measureLabel(config: bioLabelConfig(text: bioText),
                                               maxWidth: maxContentWidth)
-            subviewSizes.append(CGSize(square: vSpacingSubtitle))
-            subviewSizes.append(bioSize)
+            innerSubviewInfos.append(CGSize(square: vSpacingSubtitle).asManualSubviewInfo)
+            innerSubviewInfos.append(bioSize.asManualSubviewInfo)
         }
 
         if let detailsText = self.detailsText {
             let detailsSize = CVText.measureLabel(config: detailsLabelConfig(text: detailsText),
                                                   maxWidth: maxContentWidth)
-            subviewSizes.append(CGSize(square: vSpacingSubtitle))
-            subviewSizes.append(detailsSize)
+            innerSubviewInfos.append(CGSize(square: vSpacingSubtitle).asManualSubviewInfo)
+            innerSubviewInfos.append(detailsSize.asManualSubviewInfo)
         }
 
         if let mutualGroupsText = self.mutualGroupsText {
             let mutualGroupsSize = CVText.measureLabel(config: mutualGroupsLabelConfig(attributedText: mutualGroupsText),
                                                        maxWidth: maxContentWidth)
-            subviewSizes.append(CGSize(square: vSpacingMutualGroups))
-            subviewSizes.append(mutualGroupsSize)
+            innerSubviewInfos.append(CGSize(square: vSpacingMutualGroups).asManualSubviewInfo)
+            innerSubviewInfos.append(mutualGroupsSize.asManualSubviewInfo)
         }
 
-        var size = CVStackView.measure(config: stackViewConfig, subviewSizes: subviewSizes)
-        size.height += outerViewLayoutMargins.totalHeight
-        size.width += outerViewLayoutMargins.totalWidth
-        return size.ceil
+        let innerStackMeasurement = ManualStackView.measure(config: innerStackConfig,
+                                                            measurementBuilder: measurementBuilder,
+                                                            measurementKey: Self.measurementKey_innerStack,
+                                                            subviewInfos: innerSubviewInfos)
+        let outerSubviewInfos = [ innerStackMeasurement.measuredSize.asManualSubviewInfo ]
+        let outerStackMeasurement = ManualStackView.measure(config: outerStackConfig,
+                                                            measurementBuilder: measurementBuilder,
+                                                            measurementKey: Self.measurementKey_outerStack,
+                                                            subviewInfos: outerSubviewInfos)
+        return outerStackMeasurement.measuredSize
     }
 
     // MARK: -
@@ -406,15 +431,15 @@ public class CVComponentThreadDetails: CVComponentBase, CVRootComponent {
 
         fileprivate let mutualGroupsLabel = UILabel()
 
-        fileprivate let stackView = OWSStackView(name: "threadDetails")
-        fileprivate let outerView = UIView()
+        fileprivate let outerStackView = ManualStackView(name: "Thread details outer")
+        fileprivate let innerStackView = ManualStackView(name: "Thread details inner")
 
         fileprivate var blurView: UIVisualEffectView?
 
         public var isDedicatedCellView = false
 
         public var rootView: UIView {
-            outerView
+            outerStackView
         }
 
         // MARK: -
@@ -422,7 +447,8 @@ public class CVComponentThreadDetails: CVComponentBase, CVRootComponent {
         public func setIsCellVisible(_ isCellVisible: Bool) {}
 
         public func reset() {
-            stackView.reset()
+            outerStackView.reset()
+            innerStackView.reset()
 
             titleLabel.text = nil
             bioLabel.text = nil
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentTypingIndicator.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentTypingIndicator.swift
index fb338a0c082..80a65e6be97 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentTypingIndicator.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentTypingIndicator.swift
@@ -55,6 +55,8 @@ public class CVComponentTypingIndicator: CVComponentBase, CVRootComponent {
             return
         }
 
+        // TODO: Reuse?
+
         let outerStackView = componentView.outerStackView
         let innerStackView = componentView.innerStackView
 
@@ -71,9 +73,7 @@ public class CVComponentTypingIndicator: CVComponentBase, CVRootComponent {
 
         let bubbleView = componentView.bubbleView
         bubbleView.fillColor = conversationStyle.bubbleColor(isIncoming: true)
-        innerStackView.addSubview(bubbleView) { view in
-            bubbleView.frame = view.bounds
-        }
+        innerStackView.addSubviewToFillSuperviewEdges(bubbleView)
 
         let typingIndicatorView = componentView.typingIndicatorView
 
@@ -121,13 +121,11 @@ public class CVComponentTypingIndicator: CVComponentBase, CVRootComponent {
         var innerSubviewInfos = [ManualStackSubviewInfo]()
 
         if typingIndicator.avatar != nil {
-            let avatarSize = ConversationStyle.groupMessageAvatarDiameter
-            outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: .square(avatarSize),
-                                                            hasFixedSize: true))
+            let avatarSize: CGSize = .square(ConversationStyle.groupMessageAvatarDiameter)
+            outerSubviewInfos.append(avatarSize.asManualSubviewInfo(hasFixedSize: true))
         }
 
-        innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: TypingIndicatorView.measureSize,
-                                                        hasFixedSize: true))
+        innerSubviewInfos.append(TypingIndicatorView.measureSize.asManualSubviewInfo(hasFixedSize: true))
 
         let innerStackMeasurement = ManualStackView.measure(config: innerStackViewConfig,
                                                             measurementBuilder: measurementBuilder,
@@ -135,11 +133,10 @@ public class CVComponentTypingIndicator: CVComponentBase, CVRootComponent {
                                                             subviewInfos: innerSubviewInfos)
         var innerStackSize = innerStackMeasurement.measuredSize
         innerStackSize.height = max(minBubbleHeight, innerStackSize.height)
-        outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: innerStackSize,
-                                                        hasFixedWidth: true))
+        outerSubviewInfos.append(innerStackSize.asManualSubviewInfo(hasFixedWidth: true))
 
         // We always use a stretching spacer.
-        outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: .zero))
+        outerSubviewInfos.append(ManualStackSubviewInfo.empty)
 
         let outerStackMeasurement = ManualStackView.measure(config: outerStackViewConfig,
                                                             measurementBuilder: measurementBuilder,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentUnreadIndicator.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentUnreadIndicator.swift
index 471696017c8..12e2c77f61a 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentUnreadIndicator.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentUnreadIndicator.swift
@@ -121,7 +121,7 @@ public class CVComponentUnreadIndicator: CVComponentBase, CVRootComponent {
 
     private var vStackConfig: CVStackViewConfig {
         CVStackViewConfig(axis: .vertical,
-                          alignment: .fill,
+                          alignment: .center,
                           spacing: 12,
                           layoutMargins: UIEdgeInsets(top: 8, leading: 0, bottom: 8, trailing: 0))
     }
@@ -147,14 +147,14 @@ public class CVComponentUnreadIndicator: CVComponentBase, CVRootComponent {
         let labelSize = CVText.measureLabel(config: titleLabelConfig, maxWidth: availableWidth)
         let strokeSize = CGSize(width: 0, height: 1)
 
-        let labelInfo = ManualStackSubviewInfo(measuredSize: labelSize)
+        let labelInfo = labelSize.asManualSubviewInfo
         let noBlurMeasurement = ManualStackView.measure(config: noBlurConfig,
                                                         measurementBuilder: measurementBuilder,
                                                         measurementKey: Self.measurementKey_noBlur,
         subviewInfos: [ labelInfo ])
 
-        let strokeInfo = ManualStackSubviewInfo(measuredSize: strokeSize, hasFixedHeight: true)
-        let noBlurInfo = ManualStackSubviewInfo(measuredSize: noBlurMeasurement.measuredSize)
+        let strokeInfo = strokeSize.asManualSubviewInfo(hasFixedHeight: true)
+        let noBlurInfo = noBlurMeasurement.measuredSize.asManualSubviewInfo
         let vStackMeasurement = ManualStackView.measure(config: vStackConfig,
                                                         measurementBuilder: measurementBuilder,
                                                         measurementKey: Self.measurementKey_vStackView,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentViewOnce.swift b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentViewOnce.swift
index 1ccdec2e2d5..425e7342c8e 100644
--- a/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentViewOnce.swift
+++ b/Signal/src/ViewControllers/ConversationView/CV/CVComponents/CVComponentViewOnce.swift
@@ -141,11 +141,10 @@ public class CVComponentViewOnce: CVComponentBase, CVComponent {
         var availableWidth = maxWidth
         if hasIconOrProgress {
             availableWidth = max(0, availableWidth - (iconSize + stackViewConfig.spacing))
-            subviewInfos.append(ManualStackSubviewInfo(measuredSize: .square(iconSize),
-                                                       hasFixedSize: true))
+            subviewInfos.append(CGSize.square(iconSize).asManualSubviewInfo(hasFixedSize: true))
         }
         let textSize = CVText.measureLabel(config: labelConfig, maxWidth: availableWidth)
-        subviewInfos.append(ManualStackSubviewInfo(measuredSize: textSize))
+        subviewInfos.append(textSize.asManualSubviewInfo)
 
         let stackMeasurement = ManualStackView.measure(config: stackViewConfig,
                                                        measurementBuilder: measurementBuilder,
diff --git a/Signal/src/ViewControllers/ConversationView/CV/OWSVisualEffectView.swift b/Signal/src/ViewControllers/ConversationView/CV/OWSVisualEffectView.swift
new file mode 100644
index 00000000000..e37e2342f5f
--- /dev/null
+++ b/Signal/src/ViewControllers/ConversationView/CV/OWSVisualEffectView.swift
@@ -0,0 +1,67 @@
+//
+//  Copyright (c) 2021 Open Whisper Systems. All rights reserved.
+//
+
+import Foundation
+
+public class OWSVisualEffectView: UIVisualEffectView {
+    private let blurOverlay = UIView()
+
+    struct ContentSubview {
+        let subview: UIView
+        let insets: UIEdgeInsets
+    }
+
+    private var contentSubviews = [ContentSubview]()
+
+    public required init(effect: UIBlurEffect,
+                         overlayBackgroundColor: UIColor) {
+        super.init(effect: effect)
+
+        blurOverlay.backgroundColor = overlayBackgroundColor
+        addContentSubview(blurOverlay)
+    }
+
+    required init?(coder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
+
+    public func addContentSubview(_ subview: UIView,
+                                  withInsets insets: UIEdgeInsets = .zero) {
+        contentView.addSubview(subview)
+        contentSubviews.append(.init(subview: subview, insets: insets))
+    }
+
+    public override var bounds: CGRect {
+        didSet {
+            if oldValue != bounds {
+                layoutSubviews()
+            }
+        }
+    }
+
+    public override var frame: CGRect {
+        didSet {
+            if oldValue != frame {
+                layoutSubviews()
+            }
+        }
+    }
+
+    public override var center: CGPoint {
+        didSet {
+            if oldValue != center {
+                layoutSubviews()
+            }
+        }
+    }
+
+    public override func layoutSubviews() {
+        super.layoutSubviews()
+
+        contentView.frame = bounds
+        for contentSubview in contentSubviews {
+            contentSubview.subview.frame = contentView.bounds.inset(by: contentSubview.insets)
+        }
+    }
+}
diff --git a/Signal/src/ViewControllers/ConversationView/Cells/AudioMessageView.swift b/Signal/src/ViewControllers/ConversationView/Cells/AudioMessageView.swift
index 5873e4ec174..9260d6dece4 100644
--- a/Signal/src/ViewControllers/ConversationView/Cells/AudioMessageView.swift
+++ b/Signal/src/ViewControllers/ConversationView/Cells/AudioMessageView.swift
@@ -179,26 +179,25 @@ class AudioMessageView: ManualStackView {
                                                     isIncoming: isIncoming,
                                                     conversationStyle: conversationStyle) {
             let topLabelSize = CGSize(width: 0, height: topLabelConfig.font.lineHeight)
-            outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: topLabelSize))
+            outerSubviewInfos.append(topLabelSize.asManualSubviewInfo)
         }
 
         var innerSubviewInfos = [ManualStackSubviewInfo]()
         let leftViewSize = CGSize(square: animationSize)
-        innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: leftViewSize,
-                                                        hasFixedSize: true))
+        innerSubviewInfos.append(leftViewSize.asManualSubviewInfo(hasFixedSize: true))
 
         let waveformAndLabelSize = CGSize(width: 0,
                                           height: max(waveformHeight,
                                                       playbackTimeLabelConfig(isIncoming: isIncoming,
                                                                               conversationStyle: conversationStyle).font.lineHeight))
-        innerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: waveformAndLabelSize))
+        innerSubviewInfos.append(waveformAndLabelSize.asManualSubviewInfo)
 
         let innerStackMeasurement = ManualStackView.measure(config: innerStackConfig,
                                                             measurementBuilder: measurementBuilder,
                                                             measurementKey: Self.measurementKey_innerStack,
                                                             subviewInfos: innerSubviewInfos)
         let innerStackSize = innerStackMeasurement.measuredSize
-        outerSubviewInfos.append(ManualStackSubviewInfo(measuredSize: innerStackSize.ceil))
+        outerSubviewInfos.append(innerStackSize.ceil.asManualSubviewInfo)
 
         let outerStackMeasurement = ManualStackView.measure(config: outerStackConfig,
                                                             measurementBuilder: measurementBuilder,
diff --git a/SignalMessaging/Views/ManualStackView.swift b/SignalMessaging/Views/ManualStackView.swift
index 8517ae60535..9aedc850680 100644
--- a/SignalMessaging/Views/ManualStackView.swift
+++ b/SignalMessaging/Views/ManualStackView.swift
@@ -30,6 +30,10 @@ public struct ManualStackSubviewInfo: Equatable {
         self.hasFixedHeight = subview.contentHuggingPriority(for: .vertical) != .defaultHigh
     }
 
+    public static var empty: ManualStackSubviewInfo {
+        ManualStackSubviewInfo(measuredSize: .zero)
+    }
+
     func hasFixedSizeOnAxis(isHorizontalLayout: Bool) -> Bool {
         isHorizontalLayout ? hasFixedWidth : hasFixedHeight
     }
@@ -41,6 +45,25 @@ public struct ManualStackSubviewInfo: Equatable {
 
 // MARK: -
 
+public extension CGSize {
+    var asManualSubviewInfo: ManualStackSubviewInfo {
+        ManualStackSubviewInfo(measuredSize: self)
+    }
+
+    func asManualSubviewInfo(hasFixedWidth: Bool = false,
+                             hasFixedHeight: Bool = false) -> ManualStackSubviewInfo {
+        ManualStackSubviewInfo(measuredSize: self,
+                               hasFixedWidth: hasFixedWidth,
+                               hasFixedHeight: hasFixedHeight)
+    }
+
+    func asManualSubviewInfo(hasFixedSize: Bool) -> ManualStackSubviewInfo {
+        ManualStackSubviewInfo(measuredSize: self, hasFixedSize: hasFixedSize)
+    }
+}
+
+// MARK: -
+
 public struct ManualStackMeasurement: Equatable {
     public let measuredSize: CGSize
 
@@ -79,8 +102,7 @@ open class ManualStackView: OWSStackView {
 
         func apply() {
             if subview.frame != frame {
-                ManualStackView.setSubviewFrame(subview: subview,
-                                                frame: frame)
+                ManualStackView.setSubviewFrame(subview: subview, frame: frame)
             }
         }
     }
@@ -576,8 +598,7 @@ open class ManualStackView: OWSStackView {
             let subviewFrame = CGRect(origin: CGPoint(x: siblingCenter.x - subview.width * 0.5,
                                                       y: siblingCenter.y - subview.height * 0.5),
                                       size: size)
-            Self.setSubviewFrame(subview: subview,
-                                 frame: subviewFrame)
+            Self.setSubviewFrame(subview: subview, frame: subviewFrame)
         }
     }
 
@@ -605,11 +626,18 @@ open class ManualStackView: OWSStackView {
             let subviewFrame = CGRect(origin: CGPoint(x: (superviewBounds.width - subview.width) * 0.5,
                                                       y: (superviewBounds.height - subview.height) * 0.5),
                                       size: size)
-            Self.setSubviewFrame(subview: subview,
-                                 frame: subviewFrame)
+            Self.setSubviewFrame(subview: subview, frame: subviewFrame)
         }
     }
 
+    public func addSubviewToFillSuperviewEdges(_ subview: UIView) {
+        owsAssertDebug(subview.superview == nil)
+
+        addSubview(subview)
+
+        layoutSubviewToFillSuperviewBoundsWithLayoutBlock(subview)
+    }
+
     public func layoutSubviewToFillSuperviewBoundsWithLayoutBlock(_ subview: UIView) {
         owsAssertDebug(subview.superview != nil)
 
@@ -621,8 +649,7 @@ open class ManualStackView: OWSStackView {
                 return
             }
 
-            Self.setSubviewFrame(subview: subview,
-                                 frame: superview.bounds)
+            Self.setSubviewFrame(subview: subview, frame: superview.bounds)
         }
     }
 }
