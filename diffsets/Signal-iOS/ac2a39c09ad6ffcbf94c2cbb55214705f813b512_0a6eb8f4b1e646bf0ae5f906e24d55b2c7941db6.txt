diff --git a/Signal/Emoji/EmojiPickerSheet.swift b/Signal/Emoji/EmojiPickerSheet.swift
index ac76214008b..b133bf242c2 100644
--- a/Signal/Emoji/EmojiPickerSheet.swift
+++ b/Signal/Emoji/EmojiPickerSheet.swift
@@ -88,32 +88,38 @@ class EmojiPickerSheet: InteractiveSheetViewController {
         topStackView.axis = .horizontal
         topStackView.isLayoutMarginsRelativeArrangement = true
         topStackView.spacing = 8
-
         if allowReactionConfiguration {
             topStackView.layoutMargins = UIEdgeInsets(top: 0, leading: 0, bottom: 0, trailing: 16)
             topStackView.addArrangedSubviews([searchBar, configureButton])
         } else {
             topStackView.addArrangedSubview(searchBar)
         }
-
         contentView.addSubview(topStackView)
+        topStackView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            topStackView.topAnchor.constraint(equalTo: contentView.topAnchor),
+            topStackView.leadingAnchor.constraint(equalTo: contentView.leadingAnchor),
+            topStackView.trailingAnchor.constraint(equalTo: contentView.trailingAnchor),
+        ])
 
-        topStackView.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .bottom)
-
-        contentView.addSubview(collectionView)
-        collectionView.autoPinEdge(.top, to: .bottom, of: searchBar)
-        collectionView.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .top)
         collectionView.pickerDelegate = self
         collectionView.alwaysBounceVertical = true
-
-        // NOTE: the toolbar is a subview of the keyboard layout view so it
-        // properly animates as the keyboard rises. making it part of the content view
-        // cancels those animations and makes it pop into place which looks bad.
-        // might be worth ripping apart at some point.
-        keyboardLayoutGuideView.addSubview(sectionToolbar)
-        sectionToolbar.autoPinEdge(.leading, to: .leading, of: contentView)
-        sectionToolbar.autoPinEdge(.trailing, to: .trailing, of: contentView)
-        sectionToolbar.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideView)
+        contentView.addSubview(collectionView)
+        collectionView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            collectionView.topAnchor.constraint(equalTo: topStackView.bottomAnchor),
+            collectionView.leadingAnchor.constraint(equalTo: contentView.leadingAnchor),
+            collectionView.trailingAnchor.constraint(equalTo: contentView.trailingAnchor),
+            collectionView.bottomAnchor.constraint(equalTo: contentView.bottomAnchor),
+        ])
+
+        contentView.addSubview(sectionToolbar)
+        sectionToolbar.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            sectionToolbar.leadingAnchor.constraint(equalTo: contentView.leadingAnchor),
+            sectionToolbar.trailingAnchor.constraint(equalTo: contentView.trailingAnchor),
+            sectionToolbar.bottomAnchor.constraint(equalTo: contentView.keyboardLayoutGuide.topAnchor),
+        ])
 
 #if compiler(>=6.2)
         // Obscures content underneath the emoji section toolbar to improve legibility.
@@ -147,7 +153,6 @@ class EmojiPickerSheet: InteractiveSheetViewController {
         let contentInset = UIEdgeInsets(top: 0, leading: 0, bottom: bottomInset, trailing: 0)
         collectionView.contentInset = contentInset
         collectionView.scrollIndicatorInsets = contentInset
-
     }
 
     @objc
diff --git a/Signal/Registration/UserInterface/RegistrationChangeNumberSplashViewController.swift b/Signal/Registration/UserInterface/RegistrationChangeNumberSplashViewController.swift
index 50ca6e77bae..fb802091940 100644
--- a/Signal/Registration/UserInterface/RegistrationChangeNumberSplashViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationChangeNumberSplashViewController.swift
@@ -49,24 +49,36 @@ class RegistrationChangeNumberSplashViewController: OWSViewController, OWSNaviga
 
         let scrollView = UIScrollView()
         view.addSubview(scrollView)
-        scrollView.autoPinEdge(toSuperviewSafeArea: .leading)
-        scrollView.autoPinEdge(toSuperviewSafeArea: .trailing)
-        scrollView.autoPin(toTopLayoutGuideOf: self, withInset: 0)
+        scrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            scrollView.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor),
+            scrollView.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor),
+        ])
 
         scrollingStack.axis = .vertical
         scrollingStack.alignment = .fill
         scrollingStack.isLayoutMarginsRelativeArrangement = true
         scrollingStack.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
         scrollView.addSubview(scrollingStack)
-        scrollingStack.autoMatch(.width, to: .width, of: scrollView)
-        scrollingStack.autoPinEdgesToSuperviewEdges()
+        scrollingStack.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollingStack.widthAnchor.constraint(equalTo: scrollView.frameLayoutGuide.widthAnchor),
+            scrollingStack.topAnchor.constraint(equalTo: scrollView.contentLayoutGuide.topAnchor),
+            scrollingStack.leadingAnchor.constraint(equalTo: scrollView.contentLayoutGuide.leadingAnchor),
+            scrollingStack.trailingAnchor.constraint(equalTo: scrollView.contentLayoutGuide.trailingAnchor),
+            scrollingStack.bottomAnchor.constraint(equalTo: scrollView.contentLayoutGuide.bottomAnchor),
+        ])
 
         bottomContainer.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
         view.addSubview(bottomContainer)
-        bottomContainer.autoPinEdge(toSuperviewSafeArea: .leading)
-        bottomContainer.autoPinEdge(toSuperviewSafeArea: .trailing)
-        bottomContainer.autoPinEdge(.top, to: .bottom, of: scrollView)
-        bottomContainer.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        bottomContainer.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            bottomContainer.topAnchor.constraint(equalTo: scrollView.frameLayoutGuide.bottomAnchor),
+            bottomContainer.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor),
+            bottomContainer.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor),
+            bottomContainer.bottomAnchor.constraint(equalTo: view.safeAreaLayoutGuide.bottomAnchor, constant: -16),
+        ])
 
         updateContents()
     }
diff --git a/Signal/Registration/UserInterface/RegistrationChangePhoneNumberConfirmationViewController.swift b/Signal/Registration/UserInterface/RegistrationChangePhoneNumberConfirmationViewController.swift
index 8034ac2d075..e32ce91919b 100644
--- a/Signal/Registration/UserInterface/RegistrationChangePhoneNumberConfirmationViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationChangePhoneNumberConfirmationViewController.swift
@@ -53,7 +53,18 @@ class RegistrationChangePhoneNumberConfirmationViewController: OWSViewController
         title = OWSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_VIEW_TITLE",
                                   comment: "Title for the 'change phone number' views in settings.")
 
-        createContents()
+        rootView.axis = .vertical
+        rootView.alignment = .fill
+        rootView.translatesAutoresizingMaskIntoConstraints = false
+        view.addSubview(rootView)
+        NSLayoutConstraint.activate([
+            rootView.topAnchor.constraint(equalTo: view.layoutMarginsGuide.topAnchor),
+            rootView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            rootView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            rootView.bottomAnchor.constraint(equalTo: view.layoutMarginsGuide.bottomAnchor),
+        ])
+
+        updateContents()
     }
 
     private var rateLimitErrorTimer: Timer?
@@ -77,20 +88,6 @@ class RegistrationChangePhoneNumberConfirmationViewController: OWSViewController
         rateLimitErrorTimer = nil
     }
 
-    private func createContents() {
-        rootView.axis = .vertical
-        rootView.alignment = .fill
-        rootView.isLayoutMarginsRelativeArrangement = true
-        rootView.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
-        view.addSubview(rootView)
-        rootView.autoPinEdge(toSuperviewSafeArea: .leading)
-        rootView.autoPinEdge(toSuperviewSafeArea: .trailing)
-        rootView.autoPin(toTopLayoutGuideOf: self, withInset: 0)
-        rootView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
-
-        updateContents()
-    }
-
     public override func themeDidChange() {
         super.themeDidChange()
 
diff --git a/Signal/Registration/UserInterface/RegistrationChangePhoneNumberViewController.swift b/Signal/Registration/UserInterface/RegistrationChangePhoneNumberViewController.swift
index 203fe19cc3d..65c8a1484d0 100644
--- a/Signal/Registration/UserInterface/RegistrationChangePhoneNumberViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationChangePhoneNumberViewController.swift
@@ -43,6 +43,8 @@ class RegistrationChangePhoneNumberViewController: OWSTableViewController2 {
 
         oldValueViews.delegate = self
         newValueViews.delegate = self
+
+        shouldAvoidKeyboard = true
     }
 
     public func updateState(_ newState: RegistrationPhoneNumberViewState.ChangeNumberInitialEntry) {
diff --git a/Signal/Registration/UserInterface/RegistrationPhoneNumberViewController.swift b/Signal/Registration/UserInterface/RegistrationPhoneNumberViewController.swift
index 183cd73db46..e16e237171d 100644
--- a/Signal/Registration/UserInterface/RegistrationPhoneNumberViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationPhoneNumberViewController.swift
@@ -243,9 +243,12 @@ class RegistrationPhoneNumberViewController: OWSViewController {
 
         stackView.addArrangedSubview(UIView.vStretchingSpacer())
 
-        self.view.addSubview(cancelButton)
-        cancelButton.autoHCenterInSuperview()
-        cancelButton.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea, withOffset: -24)
+        view.addSubview(cancelButton)
+        cancelButton.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            cancelButton.centerXAnchor.constraint(equalTo: view.centerXAnchor),
+            cancelButton.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor, constant: -24),
+        ])
 
         render()
     }
diff --git a/Signal/Registration/UserInterface/RegistrationPinViewController.swift b/Signal/Registration/UserInterface/RegistrationPinViewController.swift
index ecba12c76aa..5f078fc0a56 100644
--- a/Signal/Registration/UserInterface/RegistrationPinViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationPinViewController.swift
@@ -360,9 +360,13 @@ class RegistrationPinViewController: OWSViewController {
 
         let scrollView = UIScrollView()
         view.addSubview(scrollView)
-        scrollView.autoPinWidthToSuperviewMargins()
-        scrollView.autoPinEdge(.top, to: .top, of: keyboardLayoutGuideViewSafeArea)
-        scrollView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        scrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            scrollView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            scrollView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            scrollView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         scrollView.addSubview(stackView)
         stackView.autoPinWidth(toWidthOf: scrollView)
diff --git a/Signal/Registration/UserInterface/RegistrationProfileViewController.swift b/Signal/Registration/UserInterface/RegistrationProfileViewController.swift
index b990b942c97..f21fe8d9b9d 100644
--- a/Signal/Registration/UserInterface/RegistrationProfileViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationProfileViewController.swift
@@ -258,9 +258,13 @@ class RegistrationProfileViewController: OWSViewController {
 
         let scrollView = UIScrollView()
         view.addSubview(scrollView)
-        scrollView.autoPinWidthToSuperviewMargins()
-        scrollView.autoPinEdge(toSuperviewEdge: .top)
-        scrollView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        scrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            scrollView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            scrollView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            scrollView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         let stackView = UIStackView()
         stackView.axis = .vertical
diff --git a/Signal/Registration/UserInterface/RegistrationVerificationViewController.swift b/Signal/Registration/UserInterface/RegistrationVerificationViewController.swift
index f4564044284..c1cb58cb65f 100644
--- a/Signal/Registration/UserInterface/RegistrationVerificationViewController.swift
+++ b/Signal/Registration/UserInterface/RegistrationVerificationViewController.swift
@@ -254,9 +254,13 @@ class RegistrationVerificationViewController: OWSViewController {
     private func initialRender() {
         let scrollView = UIScrollView()
         view.addSubview(scrollView)
-        scrollView.autoPinWidthToSuperview()
-        scrollView.autoPinEdge(.top, to: .top, of: keyboardLayoutGuideViewSafeArea)
-        scrollView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        scrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollView.topAnchor.constraint(equalTo: view.layoutMarginsGuide.topAnchor),
+            scrollView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            scrollView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            scrollView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         let stackView = UIStackView()
         stackView.axis = .vertical
diff --git a/Signal/Usernames/Selection/UsernameSelectionViewController.swift b/Signal/Usernames/Selection/UsernameSelectionViewController.swift
index ef0cbbaa87c..092241b54ed 100644
--- a/Signal/Usernames/Selection/UsernameSelectionViewController.swift
+++ b/Signal/Usernames/Selection/UsernameSelectionViewController.swift
@@ -312,10 +312,13 @@ class UsernameSelectionViewController: OWSViewController, OWSNavigationChildCont
         wrapperScrollView.addSubview(usernameErrorTextView)
         wrapperScrollView.addSubview(usernameFooterTextView)
 
-        wrapperScrollView.autoPinTopToSuperviewMargin()
-        wrapperScrollView.autoPinLeadingToSuperviewMargin()
-        wrapperScrollView.autoPinTrailingToSuperviewMargin()
-        wrapperScrollView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        wrapperScrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            wrapperScrollView.topAnchor.constraint(equalTo: view.layoutMarginsGuide.topAnchor),
+            wrapperScrollView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            wrapperScrollView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            wrapperScrollView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         let contentLayoutGuide = wrapperScrollView.contentLayoutGuide
 
diff --git a/Signal/src/ViewControllers/AppSettings/Account/DeleteAccountConfirmationViewController.swift b/Signal/src/ViewControllers/AppSettings/Account/DeleteAccountConfirmationViewController.swift
index 7fdc1edd646..73457b3bf97 100644
--- a/Signal/src/ViewControllers/AppSettings/Account/DeleteAccountConfirmationViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Account/DeleteAccountConfirmationViewController.swift
@@ -34,10 +34,10 @@ class DeleteAccountConfirmationViewController: OWSTableViewController2 {
     }
 
     override func viewDidLoad() {
-        shouldAvoidKeyboard = true
-
         super.viewDidLoad()
 
+        shouldAvoidKeyboard = true
+
         navigationItem.leftBarButtonItem = .cancelButton(dismissingFrom: self)
         navigationItem.rightBarButtonItem = .init(title: CommonStrings.deleteButton, style: .done, target: self, action: #selector(didTapDelete))
         navigationItem.rightBarButtonItem?.setTitleTextAttributes([.foregroundColor: UIColor.ows_accentRed], for: .normal)
diff --git a/Signal/src/ViewControllers/AppSettings/Donations/BadgeGiftingConfirmationViewController.swift b/Signal/src/ViewControllers/AppSettings/Donations/BadgeGiftingConfirmationViewController.swift
index c27c9743fc4..f892bdbb1f7 100644
--- a/Signal/src/ViewControllers/AppSettings/Donations/BadgeGiftingConfirmationViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Donations/BadgeGiftingConfirmationViewController.swift
@@ -31,13 +31,13 @@ class BadgeGiftingConfirmationViewController: OWSTableViewController2 {
         self.price = price
         self.paymentMethodsConfiguration = paymentMethodsConfiguration
         self.thread = thread
+
+        super.init()
     }
 
     // MARK: - Callbacks
 
     public override func viewDidLoad() {
-        self.shouldAvoidKeyboard = true
-
         super.viewDidLoad()
 
         DependenciesBridge.shared.databaseChangeObserver.appendDatabaseChangeDelegate(self)
@@ -47,10 +47,11 @@ class BadgeGiftingConfirmationViewController: OWSTableViewController2 {
             comment: "Users can donate on a friend's behalf. This is the title on the screen where users confirm the donation, and can write a message for the friend."
         )
 
+        shouldAvoidKeyboard = true
         updateTableContents()
         setUpBottomFooter()
 
-        tableView.keyboardDismissMode = .onDrag
+        tableView.keyboardDismissMode = .interactive
     }
 
     public override func themeDidChange() {
diff --git a/Signal/src/ViewControllers/AppSettings/Payments/PaymentsRestoreWalletWordViewController.swift b/Signal/src/ViewControllers/AppSettings/Payments/PaymentsRestoreWalletWordViewController.swift
index 5fde9ae8a1a..484ae0f376c 100644
--- a/Signal/src/ViewControllers/AppSettings/Payments/PaymentsRestoreWalletWordViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Payments/PaymentsRestoreWalletWordViewController.swift
@@ -57,7 +57,18 @@ public class PaymentsRestoreWalletWordViewController: OWSViewController {
 
         OWSTableViewController2.removeBackButtonText(viewController: self)
 
-        createContents()
+        rootView.axis = .vertical
+        rootView.alignment = .fill
+        rootView.translatesAutoresizingMaskIntoConstraints = false
+        view.addSubview(rootView)
+        NSLayoutConstraint.activate([
+            rootView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            rootView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            rootView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            rootView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
+
+        updateContents()
     }
 
     public override func viewWillAppear(_ animated: Bool) {
@@ -80,17 +91,6 @@ public class PaymentsRestoreWalletWordViewController: OWSViewController {
 
     private let rootView = UIStackView()
 
-    private func createContents() {
-        rootView.axis = .vertical
-        rootView.alignment = .fill
-        view.addSubview(rootView)
-        rootView.autoPin(toTopLayoutGuideOf: self, withInset: 0)
-        rootView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
-        rootView.autoPinWidthToSuperviewMargins()
-
-        updateContents()
-    }
-
     private func updateContents() {
 
         view.backgroundColor = OWSTableViewController2.tableBackgroundColor(isUsingPresentedStyle: true)
diff --git a/Signal/src/ViewControllers/AppSettings/Privacy/ProxySettingsViewController.swift b/Signal/src/ViewControllers/AppSettings/Privacy/ProxySettingsViewController.swift
index e503f478cf3..93474403a7a 100644
--- a/Signal/src/ViewControllers/AppSettings/Privacy/ProxySettingsViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Privacy/ProxySettingsViewController.swift
@@ -12,6 +12,8 @@ class ProxySettingsViewController: OWSTableViewController2 {
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        shouldAvoidKeyboard = true
+
         title = OWSLocalizedString(
             "PROXY_SETTINGS_TITLE",
             comment: "Title for the signal proxy settings"
diff --git a/Signal/src/ViewControllers/AppSettings/Profile/ProfileBioViewController.swift b/Signal/src/ViewControllers/AppSettings/Profile/ProfileBioViewController.swift
index f039e8777e1..8ce3e750b44 100644
--- a/Signal/src/ViewControllers/AppSettings/Profile/ProfileBioViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Profile/ProfileBioViewController.swift
@@ -49,23 +49,18 @@ class ProfileBioViewController: OWSTableViewController2 {
         self.profileDelegate = profileDelegate
 
         super.init()
-
-        self.bioTextField.text = bio
-        self.bioEmojiLabel.text = bioEmoji
-
-        self.shouldAvoidKeyboard = true
     }
 
     // MARK: -
 
-    public override func loadView() {
-        view = UIView()
-        createViews()
-    }
-
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        bioTextField.text = originalBio
+        bioEmojiLabel.text = originalBioEmoji
+
+        shouldAvoidKeyboard = true
+        createViews()
         defaultSeparatorInsetLeading = Self.cellHInnerMargin + Self.bioButtonHeight + OWSTableItem.iconSpacing
 
         updateNavigation()
diff --git a/Signal/src/ViewControllers/AppSettings/Profile/ProfileNameViewController.swift b/Signal/src/ViewControllers/AppSettings/Profile/ProfileNameViewController.swift
index 9f855a813c7..0d13d8855fb 100644
--- a/Signal/src/ViewControllers/AppSettings/Profile/ProfileNameViewController.swift
+++ b/Signal/src/ViewControllers/AppSettings/Profile/ProfileNameViewController.swift
@@ -55,22 +55,19 @@ class ProfileNameViewController: OWSTableViewController2 {
         self.profileDelegate = profileDelegate
 
         super.init()
-
-        self.givenNameTextField.text = givenName
-        self.familyNameTextField.text = familyName
-
-        self.shouldAvoidKeyboard = true
     }
 
     // MARK: -
 
-    public override func loadView() {
-        view = UIView()
-    }
-
     override func viewDidLoad() {
         super.viewDidLoad()
 
+        shouldAvoidKeyboard = true
+        tableView.keyboardDismissMode = .interactive
+
+        givenNameTextField.text = originalGivenName
+        familyNameTextField.text = originalFamilyName
+
         updateNavigation()
         updateTableContents()
     }
diff --git a/Signal/src/ViewControllers/Donations/DonateViewController.swift b/Signal/src/ViewControllers/Donations/DonateViewController.swift
index e663f1d33da..cdc3796c605 100644
--- a/Signal/src/ViewControllers/Donations/DonateViewController.swift
+++ b/Signal/src/ViewControllers/Donations/DonateViewController.swift
@@ -100,9 +100,13 @@ class DonateViewController: OWSViewController, OWSNavigationChildController {
         stackView.isLayoutMarginsRelativeArrangement = true
 
         view.addSubview(scrollView)
-        scrollView.autoPinWidthToSuperview()
-        scrollView.autoPinEdge(toSuperviewEdge: .top)
-        scrollView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        scrollView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            scrollView.topAnchor.constraint(equalTo: view.topAnchor),
+            scrollView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            scrollView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            scrollView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         NotificationCenter.default.addObserver(
             self,
diff --git a/Signal/src/ViewControllers/Donations/DonationPaymentDetailsViewController.swift b/Signal/src/ViewControllers/Donations/DonationPaymentDetailsViewController.swift
index 9707b35da9b..bf7ebde341f 100644
--- a/Signal/src/ViewControllers/Donations/DonationPaymentDetailsViewController.swift
+++ b/Signal/src/ViewControllers/Donations/DonationPaymentDetailsViewController.swift
@@ -70,10 +70,9 @@ class DonationPaymentDetailsViewController: OWSTableViewController2 {
     // MARK: - View callbacks
 
     public override func viewDidLoad() {
-        shouldAvoidKeyboard = true
-
         super.viewDidLoad()
 
+        shouldAvoidKeyboard = true
         render()
 
         let sections = [donationAmountSection] + formSections()
diff --git a/Signal/src/ViewControllers/GifPicker/GifPickerViewController.swift b/Signal/src/ViewControllers/GifPicker/GifPickerViewController.swift
index e09d62ce3c0..f9ab2991a4d 100644
--- a/Signal/src/ViewControllers/GifPicker/GifPickerViewController.swift
+++ b/Signal/src/ViewControllers/GifPicker/GifPickerViewController.swift
@@ -290,10 +290,13 @@ class GifPickerViewController: OWSViewController, UISearchBarDelegate, UICollect
 
         let bottomBanner = UIView()
         bottomBannerContainer.addSubview(bottomBanner)
-
-        bottomBanner.autoPinEdge(toSuperviewEdge: .top)
-        bottomBanner.autoPinWidthToSuperview()
-        bottomBanner.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        bottomBanner.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            bottomBanner.topAnchor.constraint(equalTo: bottomBannerContainer.topAnchor),
+            bottomBanner.leadingAnchor.constraint(equalTo: bottomBannerContainer.leadingAnchor),
+            bottomBanner.trailingAnchor.constraint(equalTo: bottomBannerContainer.trailingAnchor),
+            bottomBanner.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         // The Giphy API requires us to "show their trademark prominently" in our GIF experience.
         let logoImage = UIImage(named: "giphy_logo")
diff --git a/Signal/src/ViewControllers/HomeView/Chat List/ChatListViewController.swift b/Signal/src/ViewControllers/HomeView/Chat List/ChatListViewController.swift
index c6625a6605d..595f00d5b40 100644
--- a/Signal/src/ViewControllers/HomeView/Chat List/ChatListViewController.swift	
+++ b/Signal/src/ViewControllers/HomeView/Chat List/ChatListViewController.swift	
@@ -42,8 +42,6 @@ public class ChatListViewController: OWSViewController, HomeTabViewController {
     public override func viewDidLoad() {
         super.viewDidLoad()
 
-        keyboardObservationBehavior = .never
-
         switch viewState.chatListMode {
         case .inbox:
             title = NSLocalizedString("CHAT_LIST_TITLE_INBOX", comment: "Title for the chat list's default mode.")
diff --git a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift
index 1d532d142a4..b9520302456 100644
--- a/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift	
+++ b/Signal/src/ViewControllers/HomeView/Stories/Replies & Views Sheets/StoryDirectReplySheet.swift	
@@ -17,6 +17,7 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
         }
         let toolbar = StoryReplyInputToolbar(isGroupStory: false, quotedReplyModel: quotedReplyModel, spoilerState: spoilerState)
         toolbar.delegate = self
+        toolbar.translatesAutoresizingMaskIntoConstraints = false
         return toolbar
     }()
     let storyMessage: StoryMessage
@@ -29,6 +30,8 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
 
     let spoilerState: SpoilerRenderState
 
+    private var inputToolbarBottomConstraint: NSLayoutConstraint?
+
     init(storyMessage: StoryMessage, spoilerState: SpoilerRenderState) {
         self.storyMessage = storyMessage
         self.spoilerState = spoilerState
@@ -52,10 +55,15 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
         let tapGesture = UITapGestureRecognizer(target: self, action: #selector(handleTap(_:)))
         view.addGestureRecognizer(tapGesture)
 
+        let inputToolbarBottomConstraint = inputToolbar.topAnchor.constraint(greaterThanOrEqualTo: view.safeAreaLayoutGuide.topAnchor)
         view.addSubview(inputToolbar)
-        inputToolbar.autoPinWidthToSuperview()
-        inputToolbar.autoPin(toTopLayoutGuideOf: self, withInset: 0, relation: .greaterThanOrEqual)
-        inputToolbar.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        NSLayoutConstraint.activate([
+            inputToolbar.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            inputToolbar.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            inputToolbarBottomConstraint,
+            inputToolbar.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
+        self.inputToolbarBottomConstraint = inputToolbarBottomConstraint
     }
 
     @objc
@@ -65,6 +73,19 @@ public class StoryDirectReplySheet: OWSViewController, StoryReplySheet {
     }
 
     public override func dismiss(animated flag: Bool, completion: (() -> Void)? = nil) {
+        // We don't want `inputToolbar` to stay attached to the keyboard's layout guide during dismiss animation
+        // as this creates unpleasant animations where the bar flies across the screen.
+        // To workaround that we freeze vertical position of the `inputToolbar`
+        // just before the animation stars to that the bar is animated with the whole view.
+        if let inputToolbarBottomConstraint {
+            let fixedPositionConstraint = inputToolbar.topAnchor.constraint(
+                equalTo: view.topAnchor, constant: inputToolbar.frame.y)
+
+            NSLayoutConstraint.deactivate([inputToolbarBottomConstraint])
+            NSLayoutConstraint.activate([fixedPositionConstraint])
+
+            self.inputToolbarBottomConstraint = nil
+        }
         super.dismiss(animated: flag) { [dismissHandler] in
             completion?()
             dismissHandler?()
diff --git a/Signal/src/ViewControllers/OWSPinConfirmationViewController.swift b/Signal/src/ViewControllers/OWSPinConfirmationViewController.swift
index 55cde41366b..bf25d8c174d 100644
--- a/Signal/src/ViewControllers/OWSPinConfirmationViewController.swift
+++ b/Signal/src/ViewControllers/OWSPinConfirmationViewController.swift
@@ -86,10 +86,13 @@ public class PinConfirmationViewController: OWSViewController {
         view.backgroundColor = .clear
 
         containerView.backgroundColor = Theme.backgroundColor
-
+        containerView.translatesAutoresizingMaskIntoConstraints = false
         view.addSubview(containerView)
-        containerView.autoPinWidthToSuperview()
-        containerView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        NSLayoutConstraint.activate([
+            containerView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            containerView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            containerView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         // We want the background to extend to the bottom of the screen
         // behind the safe area, so we add that inset to our bottom inset
diff --git a/Signal/src/ViewControllers/OWSPinReminderViewController.swift b/Signal/src/ViewControllers/OWSPinReminderViewController.swift
index b748e5fb8d4..446c826d12a 100644
--- a/Signal/src/ViewControllers/OWSPinReminderViewController.swift
+++ b/Signal/src/ViewControllers/OWSPinReminderViewController.swift
@@ -82,11 +82,14 @@ public class PinReminderViewController: OWSViewController {
         view.backgroundColor = .clear
 
         containerView.backgroundColor = Theme.backgroundColor
-
+        containerView.translatesAutoresizingMaskIntoConstraints = false
         view.addSubview(containerView)
-        containerView.autoPinWidthToSuperview()
-        containerView.autoPin(toTopLayoutGuideOf: self, withInset: 0, relation: .greaterThanOrEqual)
-        containerView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        NSLayoutConstraint.activate([
+            containerView.topAnchor.constraint(greaterThanOrEqualTo: view.safeAreaLayoutGuide.topAnchor),
+            containerView.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            containerView.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            containerView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         // We want the background to extend to the bottom of the screen
         // behind the safe area, so we add that inset to our bottom inset
diff --git a/Signal/src/ViewControllers/OWSPinSetupViewController.swift b/Signal/src/ViewControllers/OWSPinSetupViewController.swift
index 827cff25f04..c8ab2432d6c 100644
--- a/Signal/src/ViewControllers/OWSPinSetupViewController.swift
+++ b/Signal/src/ViewControllers/OWSPinSetupViewController.swift
@@ -246,8 +246,6 @@ public class PinSetupViewController: OWSViewController, OWSNavigationChildContro
         if case .confirming = self.initialMode {
             owsFailDebug("pin setup flow should never start in the confirming state")
         }
-
-        super.keyboardObservationBehavior = .whileLifecycleVisible
     }
 
     public var preferredNavigationBarStyle: OWSNavigationBarStyle {
@@ -321,9 +319,13 @@ public class PinSetupViewController: OWSViewController, OWSNavigationChildContro
         stackView.axis = .vertical
         stackView.alignment = .center
         view.addSubview(stackView)
-
-        stackView.autoPinEdges(toSuperviewMarginsExcludingEdge: .bottom)
-        stackView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        stackView.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            stackView.topAnchor.constraint(equalTo: view.layoutMarginsGuide.topAnchor),
+            stackView.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            stackView.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            stackView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         [pinTextField, validationWarningLabel, recommendationLabel].forEach {
             $0.autoSetDimension(.width, toSize: 227)
diff --git a/Signal/src/ViewControllers/Payments/SendPaymentMemoViewController.swift b/Signal/src/ViewControllers/Payments/SendPaymentMemoViewController.swift
index 598dd729d42..78732082c80 100644
--- a/Signal/src/ViewControllers/Payments/SendPaymentMemoViewController.swift
+++ b/Signal/src/ViewControllers/Payments/SendPaymentMemoViewController.swift
@@ -30,7 +30,25 @@ public class SendPaymentMemoViewController: OWSViewController {
     open override func viewDidLoad() {
         super.viewDidLoad()
 
-        createContents()
+        navigationItem.title = OWSLocalizedString("PAYMENTS_NEW_PAYMENT_ADD_MEMO",
+                                                 comment: "Label for the 'add memo' ui in the 'send payment' UI.")
+        navigationItem.leftBarButtonItem = .cancelButton(poppingFrom: navigationController)
+        navigationItem.rightBarButtonItem = .doneButton { [weak self] in
+            self?.didTapDoneMemo()
+        }
+
+        rootStack.axis = .vertical
+        rootStack.alignment = .fill
+        rootStack.translatesAutoresizingMaskIntoConstraints = false
+        view.addSubview(rootStack)
+        NSLayoutConstraint.activate([
+            rootStack.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            rootStack.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor),
+            rootStack.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor),
+            rootStack.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor, constant: -16),
+        ])
+
+        updateContents()
     }
 
     public override func viewWillAppear(_ animated: Bool) {
@@ -49,27 +67,6 @@ public class SendPaymentMemoViewController: OWSViewController {
         return UIDevice.current.isIPad ? .all : .portrait
     }
 
-    private func createContents() {
-        navigationItem.title = OWSLocalizedString("PAYMENTS_NEW_PAYMENT_ADD_MEMO",
-                                                 comment: "Label for the 'add memo' ui in the 'send payment' UI.")
-        navigationItem.leftBarButtonItem = .cancelButton(poppingFrom: navigationController)
-        navigationItem.rightBarButtonItem = .doneButton { [weak self] in
-            self?.didTapDoneMemo()
-        }
-
-        rootStack.axis = .vertical
-        rootStack.alignment = .fill
-        rootStack.layoutMargins = UIEdgeInsets(top: 0, leading: 0, bottom: 16, trailing: 0)
-        rootStack.isLayoutMarginsRelativeArrangement = true
-        view.addSubview(rootStack)
-        rootStack.autoPinEdge(toSuperviewMargin: .leading)
-        rootStack.autoPinEdge(toSuperviewMargin: .trailing)
-        rootStack.autoPin(toTopLayoutGuideOf: self, withInset: 0)
-        rootStack.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
-
-        updateContents()
-    }
-
     private func updateContents() {
         AssertIsOnMainThread()
 
diff --git a/Signal/src/ViewControllers/Payments/SendPaymentViewController.swift b/Signal/src/ViewControllers/Payments/SendPaymentViewController.swift
index 75bdc71d65e..0335341c335 100644
--- a/Signal/src/ViewControllers/Payments/SendPaymentViewController.swift
+++ b/Signal/src/ViewControllers/Payments/SendPaymentViewController.swift
@@ -702,16 +702,16 @@ public class SendPaymentViewController: OWSViewController {
     // MARK: -
 
     private func createSubviews() {
-
         rootStack.axis = .vertical
         rootStack.alignment = .fill
-        rootStack.layoutMargins = UIEdgeInsets(top: 0, leading: 0, bottom: 24, trailing: 0)
-        rootStack.isLayoutMarginsRelativeArrangement = true
+        rootStack.translatesAutoresizingMaskIntoConstraints = false
         view.addSubview(rootStack)
-        rootStack.autoPinEdge(toSuperviewMargin: .leading, withInset: 20)
-        rootStack.autoPinEdge(toSuperviewMargin: .trailing, withInset: 20)
-        rootStack.autoPin(toTopLayoutGuideOf: self, withInset: 0)
-        rootStack.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+        NSLayoutConstraint.activate([
+            rootStack.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            rootStack.leadingAnchor.constraint(equalTo: view.layoutMarginsGuide.leadingAnchor, constant: 20),
+            rootStack.trailingAnchor.constraint(equalTo: view.layoutMarginsGuide.trailingAnchor, constant: -20),
+            rootStack.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor, constant: -24),
+        ])
 
         bigAmountLabel.font = UIFont.regularFont(ofSize: 60)
         bigAmountLabel.textAlignment = .center
diff --git a/Signal/src/ViewControllers/ThreadSettings/NicknameEditorViewController.swift b/Signal/src/ViewControllers/ThreadSettings/NicknameEditorViewController.swift
index cb289bb23ba..105bc4cacc5 100644
--- a/Signal/src/ViewControllers/ThreadSettings/NicknameEditorViewController.swift
+++ b/Signal/src/ViewControllers/ThreadSettings/NicknameEditorViewController.swift
@@ -205,9 +205,9 @@ class NicknameEditorViewController: OWSTableViewController2 {
     // MARK: Lifecycle
 
     override func viewDidLoad() {
-        self.shouldAvoidKeyboard = true
-
         super.viewDidLoad()
+
+        shouldAvoidKeyboard = true
         self.updateTableContents()
         self.updateFonts()
 
diff --git a/SignalUI/ImageEditor/ImageEditorViewController+Text.swift b/SignalUI/ImageEditor/ImageEditorViewController+Text.swift
index 35c91a3efe4..113100c3f39 100644
--- a/SignalUI/ImageEditor/ImageEditorViewController+Text.swift
+++ b/SignalUI/ImageEditor/ImageEditorViewController+Text.swift
@@ -72,8 +72,14 @@ extension ImageEditorViewController {
         textViewWrapperView.autoPinHeightToSuperviewMargins(relation: .lessThanOrEqual)
 
         view.addSubview(textViewContainer)
+        textViewContainer.translatesAutoresizingMaskIntoConstraints = false
         textViewContainer.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .bottom)
-        textViewContainerBottomConstraint = textViewContainer.autoPinEdge(toSuperviewEdge: .bottom)
+        NSLayoutConstraint.activate([
+            textViewContainer.topAnchor.constraint(equalTo: view.topAnchor),
+            textViewContainer.leadingAnchor.constraint(equalTo: view.leadingAnchor),
+            textViewContainer.trailingAnchor.constraint(equalTo: view.trailingAnchor),
+            textViewContainer.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         textViewContainer.addGestureRecognizer(ImageEditorPinchGestureRecognizer(target: self, action: #selector(handleTextPinchGesture(_:))))
         textViewContainer.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(didTapDimmerView(_:))))
@@ -112,19 +118,6 @@ extension ImageEditorViewController {
         textViewBackgroundView.backgroundColor = textToolbar.textBackgroundColor
     }
 
-    func updateTextViewContainerBottomLayoutConstraint(forKeyboardFrame keyboardFrame: CGRect) {
-        guard mode == .text, let textViewContainerBottomConstraint else {
-            return
-        }
-        let keyboardHeight: CGFloat
-        if keyboardFrame.width >= view.bounds.width {
-            keyboardHeight = keyboardFrame.height
-        } else {
-            keyboardHeight = 0
-        }
-        textViewContainerBottomConstraint.constant = -keyboardHeight
-    }
-
     func updateTextUIVisibility() {
         switch mode {
         case .text:
diff --git a/SignalUI/ImageEditor/ImageEditorViewController.swift b/SignalUI/ImageEditor/ImageEditorViewController.swift
index 2798991e3e8..48b79756c0a 100644
--- a/SignalUI/ImageEditor/ImageEditorViewController.swift
+++ b/SignalUI/ImageEditor/ImageEditorViewController.swift
@@ -190,7 +190,6 @@ class ImageEditorViewController: OWSViewController {
     var discardTextEditsOnEditingEnd = false
     var currentTextItem: (textItem: ImageEditorTextItem, isNewItem: Bool)?
     var pinchFontSizeStart: CGFloat = ImageEditorTextItem.defaultFontSize
-    var textViewContainerBottomConstraint: NSLayoutConstraint? // to bottom of self.view
     lazy var textViewContainer: UIView = {
         let view = UIView(frame: view.bounds)
         view.preservesSuperviewLayoutMargins = true
@@ -281,12 +280,6 @@ class ImageEditorViewController: OWSViewController {
         }
     }
 
-    override func keyboardFrameDidChange(_ newFrame: CGRect, animationDuration: TimeInterval, animationOptions: UIView.AnimationOptions) {
-        super.keyboardFrameDidChange(newFrame, animationDuration: animationDuration, animationOptions: animationOptions)
-
-        updateTextViewContainerBottomLayoutConstraint(forKeyboardFrame: newFrame)
-    }
-
     override var prefersStatusBarHidden: Bool {
         !UIDevice.current.hasIPhoneXNotch && !UIDevice.current.isIPad && !DependenciesBridge.shared.currentCallProvider.hasCurrentCall
     }
diff --git a/SignalUI/RecipientPickers/BaseMemberViewController.swift b/SignalUI/RecipientPickers/BaseMemberViewController.swift
index 31792365f17..1667ce3d703 100644
--- a/SignalUI/RecipientPickers/BaseMemberViewController.swift
+++ b/SignalUI/RecipientPickers/BaseMemberViewController.swift
@@ -92,10 +92,13 @@ open class BaseMemberViewController: RecipientPickerContainerViewController {
         addChild(recipientPicker)
         view.addSubview(recipientPicker.view)
 
-        recipientPicker.view.autoPin(toTopLayoutGuideOf: self, withInset: 0)
-        recipientPicker.view.autoPinEdge(toSuperviewSafeArea: .leading)
-        recipientPicker.view.autoPinEdge(toSuperviewSafeArea: .trailing)
-        recipientPicker.view.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideView)
+        recipientPicker.view.translatesAutoresizingMaskIntoConstraints = false
+        NSLayoutConstraint.activate([
+            recipientPicker.view.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
+            recipientPicker.view.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor),
+            recipientPicker.view.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor),
+            recipientPicker.view.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor),
+        ])
 
         updateMemberCount()
     }
diff --git a/SignalUI/Usernames/FindByUsernameViewController.swift b/SignalUI/Usernames/FindByUsernameViewController.swift
index 618ae56c410..e9007aabca0 100644
--- a/SignalUI/Usernames/FindByUsernameViewController.swift
+++ b/SignalUI/Usernames/FindByUsernameViewController.swift
@@ -58,6 +58,8 @@ public class FindByUsernameViewController: OWSTableViewController2 {
             action: #selector(didTapNext)
         )
         navigationItem.rightBarButtonItem?.isEnabled = false
+
+        shouldAvoidKeyboard = true
     }
 
     public override func viewDidAppear(_ animated: Bool) {
diff --git a/SignalUI/ViewControllers/OWSTableViewController2.swift b/SignalUI/ViewControllers/OWSTableViewController2.swift
index dc1d80e0395..5a47614c9a3 100644
--- a/SignalUI/ViewControllers/OWSTableViewController2.swift
+++ b/SignalUI/ViewControllers/OWSTableViewController2.swift
@@ -44,17 +44,28 @@ open class OWSTableViewController2: OWSViewController {
     // * The top header view's edge align with the edges of the cells.
     open var topHeader: UIView?
 
-    open var bottomFooter: UIView?
+    open var bottomFooter: UIView? {
+        didSet {
+            guard isViewLoaded else { return }
+            updateBottomConstraint()
+        }
+    }
 
     public var forceDarkMode = false {
         didSet {
+            guard isViewLoaded else { return }
             applyTheme()
         }
     }
 
     /// Whether or not this table view should avoid being hidden behind the
     /// keyboard.
-    public var shouldAvoidKeyboard = false
+    public var shouldAvoidKeyboard = false {
+        didSet {
+            guard isViewLoaded else { return }
+            updateBottomConstraint()
+        }
+    }
 
     public enum SelectionBehavior {
         case actionWithAutoDeselect
@@ -175,33 +186,36 @@ open class OWSTableViewController2: OWSViewController {
     public var shouldHideBottomFooter = false {
         didSet {
             let didChange = oldValue != shouldHideBottomFooter
-            if didChange, isViewLoaded {
-                updateBottomConstraint()
-            }
+            guard didChange, isViewLoaded else { return }
+            updateBottomConstraint()
         }
     }
 
     private var bottomFooterConstraint: NSLayoutConstraint?
 
     private func updateBottomConstraint() {
-        bottomFooterConstraint?.autoRemove()
-        bottomFooterConstraint = nil
+        if let bottomFooterConstraint {
+            NSLayoutConstraint.deactivate([bottomFooterConstraint])
+            self.bottomFooterConstraint = nil
+        }
 
         // Pin bottom edge of tableView.
-        if !shouldHideBottomFooter,
-           let bottomFooter = bottomFooter {
+        let bottomFooterConstraint: NSLayoutConstraint
+        if !shouldHideBottomFooter, let bottomFooter {
             if shouldAvoidKeyboard {
-                bottomFooterConstraint = bottomFooter.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+                bottomFooterConstraint = bottomFooter.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor)
             } else {
-                bottomFooterConstraint = bottomFooter.autoPinEdge(toSuperviewEdge: .bottom)
+                bottomFooterConstraint = bottomFooter.bottomAnchor.constraint(equalTo: view.bottomAnchor)
             }
         } else if shouldAvoidKeyboard {
-            bottomFooterConstraint = tableView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+            bottomFooterConstraint = tableView.bottomAnchor.constraint(equalTo: view.keyboardLayoutGuide.topAnchor)
         } else {
-            bottomFooterConstraint = tableView.autoPinEdge(toSuperviewEdge: .bottom)
+            bottomFooterConstraint = tableView.bottomAnchor.constraint(equalTo: view.bottomAnchor)
         }
+        NSLayoutConstraint.activate([bottomFooterConstraint])
 
         bottomFooter?.isHidden = shouldHideBottomFooter
+        self.bottomFooterConstraint = bottomFooterConstraint
 
         guard hasViewAppeared else {
             return
diff --git a/SignalUI/ViewControllers/OWSViewController.swift b/SignalUI/ViewControllers/OWSViewController.swift
index ce4c20b718c..7d757a66dba 100644
--- a/SignalUI/ViewControllers/OWSViewController.swift
+++ b/SignalUI/ViewControllers/OWSViewController.swift
@@ -45,43 +45,6 @@ open class OWSViewController: UIViewController {
     /// All lifecycle states achieved so far in the lifetime of this view controller.
     public private(set) final var achievedLifecycleStates = Set<ViewControllerLifecycle>()
 
-    // MARK: - Keyboard handling
-
-    public enum KeyboardObservationBehavior {
-        /// Don't observe keyboard frame changes.
-        /// WARNING: makes `keyboardFrameDidChange` non-functional.
-        case never
-        /// Only observe keyboard frame changes while the view is between `willAppear` and `didDisappear`.
-        case whileLifecycleVisible
-        /// Always observe keyboard frame changes.
-        case always
-    }
-
-    public final var keyboardObservationBehavior: KeyboardObservationBehavior = .always {
-        didSet {
-            observeKeyboardNotificationsIfNeeded()
-        }
-    }
-
-    /// Subclasses can override this method for a hook on keyboard frame changes.
-    /// NOTE: overrides _must_ call the superclass version of this method, similarly to other view lifecycle methods.
-    /// - Parameter newFrame: The frame of the keyboard _after_ any animations, in the view controller's view's coordinates.
-    open func keyboardFrameDidChange(
-        _ newFrame: CGRect,
-        animationDuration: TimeInterval,
-        animationOptions: UIView.AnimationOptions
-    ) {
-        self.handleKeyboardFrameChange(newFrame, animationDuration, animationOptions)
-    }
-
-    /// A non-rendering spacer view that tracks the space _not_ covered by the keyboard.
-    /// When the keyboard is collapsed, the bottom of this view is the bottom of the root view _not_ respecting safe area.
-    public final var keyboardLayoutGuideView: SpacerView { getOrCreateKeyboardLayoutView(safeArea: false) }
-
-    /// A non-rendering spacer view that tracks the space _not_ covered by the keyboard.
-    /// When the keyboard is collapsed, the bottom of this view is the bottom of the root view respecting safe area.
-    public final var keyboardLayoutGuideViewSafeArea: SpacerView { getOrCreateKeyboardLayoutView(safeArea: true) }
-
     // MARK: - Themeing and content size categories
 
     /// An overridable method for subclasses to hook into theme changes, to
@@ -163,8 +126,6 @@ open class OWSViewController: UIViewController {
         super.viewWillAppear(animated)
 
         self.lifecycle = .willAppear
-
-        observeKeyboardNotificationsIfNeeded()
     }
 
     open override func viewDidAppear(_ animated: Bool) {
@@ -187,29 +148,6 @@ open class OWSViewController: UIViewController {
         super.viewDidDisappear(animated)
 
         self.lifecycle = .notAppeared
-
-        observeKeyboardNotificationsIfNeeded()
-    }
-
-    open override func viewSafeAreaInsetsDidChange() {
-        super.viewSafeAreaInsetsDidChange()
-
-        updateKeyboardLayoutOffsets()
-    }
-
-    open override func viewWillTransition(
-        to size: CGSize,
-        with coordinator: UIViewControllerTransitionCoordinator
-    ) {
-        super.viewWillTransition(to: size, with: coordinator)
-
-        // Whatever keyboard frame we knew about is now invalidated.
-        // They keyboard will update us if its on screen, setting this again.
-        lastKnownKeyboardFrame = nil
-
-        coordinator.animate(alongsideTransition: nil) { [weak self] _ in
-            self?.updateKeyboardLayoutOffsets()
-        }
     }
 
     #if DEBUG
@@ -278,162 +216,6 @@ open class OWSViewController: UIViewController {
         setNeedsStatusBarAppearanceUpdate()
     }
 
-    // MARK: - Keyboard Layout
-
-    private var isObservingKeyboardNotifications = false
-
-    static var keyboardNotificationNames: [Notification.Name] = [
-        UIResponder.keyboardWillShowNotification,
-        UIResponder.keyboardDidShowNotification,
-        UIResponder.keyboardWillHideNotification,
-        UIResponder.keyboardDidHideNotification,
-        UIResponder.keyboardWillChangeFrameNotification,
-        UIResponder.keyboardDidChangeFrameNotification
-    ]
-
-    private func observeKeyboardNotificationsIfNeeded() {
-        switch keyboardObservationBehavior {
-        case .always:
-            break
-        case .never:
-            stopObservingKeyboardNotifications()
-            return
-        case .whileLifecycleVisible:
-            if !lifecycle.isVisible {
-                stopObservingKeyboardNotifications()
-                return
-            }
-        }
-
-        if isObservingKeyboardNotifications { return }
-        isObservingKeyboardNotifications = true
-
-        Self.keyboardNotificationNames.forEach {
-            NotificationCenter.default.addObserver(
-                self,
-                selector: #selector(handleKeyboardNotificationBase(_:)),
-                name: $0,
-                object: nil
-            )
-        }
-    }
-
-    private func stopObservingKeyboardNotifications() {
-        Self.keyboardNotificationNames.forEach {
-            NotificationCenter.default.removeObserver(self, name: $0, object: nil)
-        }
-        isObservingKeyboardNotifications = false
-    }
-
-    private var lastKnownKeyboardFrame: CGRect?
-
-    @objc
-    private func handleKeyboardNotificationBase(_ notification: NSNotification) {
-        let userInfo = notification.userInfo
-
-        guard var keyboardEndFrame = (userInfo?[UIResponder.keyboardFrameEndUserInfoKey] as? NSValue)?.cgRectValue else {
-            owsFailDebug("Missing keyboard end frame")
-            return
-        }
-
-        if keyboardEndFrame == .zero {
-            // If reduce motion+crossfade transitions is on, in iOS 14 UIKit vends out a keyboard end frame
-            // of CGRect zero. This breaks the math below.
-            //
-            // If our keyboard end frame is CGRectZero, build a fake rect that's translated off the bottom edge.
-            let deviceBounds = CurrentAppContext().frame
-            keyboardEndFrame = CGRect(
-                x: deviceBounds.minX,
-                y: deviceBounds.maxY,
-                width: deviceBounds.width,
-                height: 0
-            )
-        }
-
-        let keyboardEndFrameConverted = self.view.convert(keyboardEndFrame, from: nil)
-
-        guard keyboardEndFrameConverted != lastKnownKeyboardFrame else {
-            // No change.
-            return
-        }
-        lastKnownKeyboardFrame = keyboardEndFrameConverted
-
-        let animationOptions: UIView.AnimationOptions
-        if let rawCurve = userInfo?[UIResponder.keyboardAnimationCurveUserInfoKey] as? UInt {
-            animationOptions = .init(rawValue: rawCurve << 16)
-        } else {
-            animationOptions = .curveEaseInOut
-        }
-        let duration = userInfo?[UIResponder.keyboardAnimationDurationUserInfoKey] as? TimeInterval ?? 0
-        // Should we ignore keyboard changes if they're coming from somewhere out-of-process?
-        // BOOL isOurKeyboard = [notification.userInfo[UIKeyboardIsLocalUserInfoKey] boolValue];
-
-        keyboardFrameDidChange(keyboardEndFrameConverted, animationDuration: duration, animationOptions: animationOptions)
-    }
-
-    // This should be able to be a UILayoutGuide instead, but alas, PureLayout doesn't support those.
-    private var _keyboardLayoutView: SpacerView?
-    private var keyboardLayoutViewBottomConstraint: NSLayoutConstraint?
-    private var _keyboardLayoutViewSafeArea: SpacerView?
-    private var keyboardLayoutViewSafeAreaBottomConstraint: NSLayoutConstraint?
-
-    private func getOrCreateKeyboardLayoutView(safeArea: Bool) -> SpacerView {
-        if let keyboardLayoutView = safeArea ? _keyboardLayoutViewSafeArea : _keyboardLayoutView {
-            return keyboardLayoutView
-        }
-        let view = PassthroughTouchSpacerView()
-        self.view.addSubview(view)
-        if safeArea {
-            view.autoPinEdgesToSuperviewSafeArea(with: .zero, excludingEdge: .bottom)
-            keyboardLayoutViewSafeAreaBottomConstraint = view.autoPinEdge(toSuperviewSafeArea: .bottom)
-            _keyboardLayoutViewSafeArea = view
-        } else {
-            view.autoPinEdgesToSuperviewEdges(with: .zero, excludingEdge: .bottom)
-            keyboardLayoutViewBottomConstraint = view.autoPinEdge(.bottom, to: .bottom, of: self.view)
-            _keyboardLayoutView = view
-        }
-        updateKeyboardLayoutOffsets()
-        return view
-    }
-
-    private func handleKeyboardFrameChange(_ keyboardEndFrame: CGRect, _ duration: TimeInterval, _ animationOptions: UIView.AnimationOptions) {
-        guard lifecycle.isVisible, duration > 0, !UIAccessibility.isReduceMotionEnabled else {
-            // UIKit by default (sometimes? never?) animates all changes in response to keyboard events.
-            // We want to suppress those animations if the view isn't visible,
-            // otherwise presentation animations don't work properly.
-            UIView.performWithoutAnimation {
-                self.updateKeyboardLayoutOffsets()
-            }
-            return
-        }
-        updateKeyboardLayoutOffsets()
-        UIView.animate(
-            withDuration: duration,
-            delay: 0,
-            options: animationOptions,
-            animations: {
-                self.view.layoutIfNeeded()
-            }
-        )
-    }
-
-    private func updateKeyboardLayoutOffsets() {
-        guard let lastKnownKeyboardFrame = lastKnownKeyboardFrame else {
-            return
-        }
-        if let keyboardLayoutViewBottomConstraint = self.keyboardLayoutViewBottomConstraint {
-            keyboardLayoutViewBottomConstraint.constant = lastKnownKeyboardFrame.minY - view.bounds.height
-        }
-        if let keyboardLayoutViewSafeAreaBottomConstraint = self.keyboardLayoutViewSafeAreaBottomConstraint {
-            if lastKnownKeyboardFrame.minY < view.height - view.safeAreaInsets.bottom {
-                keyboardLayoutViewSafeAreaBottomConstraint.constant =
-                    lastKnownKeyboardFrame.minY - (view.bounds.height - view.safeAreaInsets.bottom)
-            } else {
-                keyboardLayoutViewSafeAreaBottomConstraint.constant = 0
-            }
-        }
-    }
-
     // MARK: - Orientation
 
     open override var supportedInterfaceOrientations: UIInterfaceOrientationMask {
