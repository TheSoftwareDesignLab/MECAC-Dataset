diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index 0ed81f3b730..c8799da1303 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -158,7 +158,6 @@
 		3402AA9D271D9E180084CBAE /* CircleView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9553F271B510400B05242 /* CircleView.swift */; };
 		3402AA9E271D9E180084CBAE /* ContactsViewHelper.h in Headers */ = {isa = PBXBuildFile; fileRef = 34A95565271B510400B05242 /* ContactsViewHelper.h */; settings = {ATTRIBUTES = (Public, ); }; };
 		3402AA9F271D9E180084CBAE /* ViewOnceTooltip.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9554C271B510400B05242 /* ViewOnceTooltip.swift */; };
-		3402AAA0271D9E180084CBAE /* ImageEditorPaletteView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95561271B510400B05242 /* ImageEditorPaletteView.swift */; };
 		3402AAA1271D9E180084CBAE /* OWSBubbleView.h in Headers */ = {isa = PBXBuildFile; fileRef = 34A95534271B510400B05242 /* OWSBubbleView.h */; settings = {ATTRIBUTES = (Public, ); }; };
 		3402AAA2271D9E180084CBAE /* OWSTextView.m in Sources */ = {isa = PBXBuildFile; fileRef = 34A9550D271B510400B05242 /* OWSTextView.m */; };
 		3402AAA3271D9E180084CBAE /* DirectionalPanGestureRecognizer.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95526271B510400B05242 /* DirectionalPanGestureRecognizer.swift */; };
@@ -791,6 +790,8 @@
 		768A1A2B17FC9CD300E00ED8 /* libz.dylib in Frameworks */ = {isa = PBXBuildFile; fileRef = 768A1A2A17FC9CD300E00ED8 /* libz.dylib */; };
 		768AE8BA280F713C00998C2D /* ImageEditorSliderView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 768AE8B9280F713C00998C2D /* ImageEditorSliderView.swift */; };
 		76995F15283868BD009DD4F4 /* ImageEditorViewController+StrokeWidthSlider.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76995F14283868BD009DD4F4 /* ImageEditorViewController+StrokeWidthSlider.swift */; };
+		76A2EB1028B578B800A29C24 /* MediaTextView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76A2EB0F28B578B800A29C24 /* MediaTextView.swift */; };
+		76A2EB1228B57AEE00A29C24 /* ColorPickerBar.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76A2EB1128B57AEE00A29C24 /* ColorPickerBar.swift */; };
 		76C87F19181EFCE600C4ACAB /* MediaPlayer.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 76C87F18181EFCE600C4ACAB /* MediaPlayer.framework */; };
 		76EB054018170B33006006FC /* AppDelegate.m in Sources */ = {isa = PBXBuildFile; fileRef = 76EB03C318170B33006006FC /* AppDelegate.m */; };
 		76FCCDBC27AB8FBE00BAA7F0 /* MediaControls.swift in Sources */ = {isa = PBXBuildFile; fileRef = 76FCCDBB27AB8FBE00BAA7F0 /* MediaControls.swift */; };
@@ -2576,7 +2577,6 @@
 		34A9555D271B510400B05242 /* ImageEditorCanvasView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorCanvasView.swift; sourceTree = "<group>"; };
 		34A9555E271B510400B05242 /* ImageEditorItem.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorItem.swift; sourceTree = "<group>"; };
 		34A9555F271B510400B05242 /* ImageEditorContents.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorContents.swift; sourceTree = "<group>"; };
-		34A95561271B510400B05242 /* ImageEditorPaletteView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorPaletteView.swift; sourceTree = "<group>"; };
 		34A95562271B510400B05242 /* ImageEditorView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorView.swift; sourceTree = "<group>"; };
 		34A95563271B510400B05242 /* ImageEditorTransform.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorTransform.swift; sourceTree = "<group>"; };
 		34A95564271B510400B05242 /* Toast.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = Toast.swift; sourceTree = "<group>"; };
@@ -3028,6 +3028,8 @@
 		768A1A2A17FC9CD300E00ED8 /* libz.dylib */ = {isa = PBXFileReference; lastKnownFileType = "compiled.mach-o.dylib"; name = libz.dylib; path = usr/lib/libz.dylib; sourceTree = SDKROOT; };
 		768AE8B9280F713C00998C2D /* ImageEditorSliderView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ImageEditorSliderView.swift; sourceTree = "<group>"; };
 		76995F14283868BD009DD4F4 /* ImageEditorViewController+StrokeWidthSlider.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = "ImageEditorViewController+StrokeWidthSlider.swift"; sourceTree = "<group>"; };
+		76A2EB0F28B578B800A29C24 /* MediaTextView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MediaTextView.swift; sourceTree = "<group>"; };
+		76A2EB1128B57AEE00A29C24 /* ColorPickerBar.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ColorPickerBar.swift; sourceTree = "<group>"; };
 		76C87F18181EFCE600C4ACAB /* MediaPlayer.framework */ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = MediaPlayer.framework; path = System/Library/Frameworks/MediaPlayer.framework; sourceTree = SDKROOT; };
 		76EB03C218170B33006006FC /* AppDelegate.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = AppDelegate.h; sourceTree = "<group>"; };
 		76EB03C318170B33006006FC /* AppDelegate.m */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.objc; path = AppDelegate.m; sourceTree = "<group>"; };
@@ -5129,6 +5131,7 @@
 				34A95545271B510400B05242 /* AvatarImageView.swift */,
 				83B9573827C9A1FA00A678FD /* CaptchaView.swift */,
 				34A9553F271B510400B05242 /* CircleView.swift */,
+				76A2EB1128B57AEE00A29C24 /* ColorPickerBar.swift */,
 				451764291DE939FD00EDB8B9 /* ContactCell.swift */,
 				34A9550B271B510400B05242 /* ContactCellView.swift */,
 				34A95565271B510400B05242 /* ContactsViewHelper.h */,
@@ -5147,6 +5150,7 @@
 				34A9552F271B510400B05242 /* LoopingVideoView.swift */,
 				34A9551D271B510400B05242 /* ManualLayoutView.swift */,
 				34A9550C271B510400B05242 /* ManualStackView.swift */,
+				76A2EB0F28B578B800A29C24 /* MediaTextView.swift */,
 				34A9550A271B510400B05242 /* NonContactTableViewCell.swift */,
 				34A9553D271B510400B05242 /* OWSActionSheets.swift */,
 				34F308A01ECB469700BB7697 /* OWSBezierPathView.h */,
@@ -5244,7 +5248,6 @@
 				34A95556271B510400B05242 /* ImageEditorCropViewController.swift */,
 				34A9555E271B510400B05242 /* ImageEditorItem.swift */,
 				34A9555A271B510400B05242 /* ImageEditorModel.swift */,
-				34A95561271B510400B05242 /* ImageEditorPaletteView.swift */,
 				34A95552271B510400B05242 /* ImageEditorPanGestureRecognizer.swift */,
 				34A95558271B510400B05242 /* ImageEditorPinchGestureRecognizer.swift */,
 				768AE8B9280F713C00998C2D /* ImageEditorSliderView.swift */,
@@ -9521,6 +9524,7 @@
 				3402AA9D271D9E180084CBAE /* CircleView.swift in Sources */,
 				34A954E0271B4F3E00B05242 /* ColorOrGradient.swift in Sources */,
 				34A954E2271B4F3E00B05242 /* ColorOrGradientSwatchView.swift in Sources */,
+				76A2EB1228B57AEE00A29C24 /* ColorPickerBar.swift in Sources */,
 				88B9870A28808BF600F8C74D /* CompareSafetyNumbersActivity.swift in Sources */,
 				88B986FD28807F6400F8C74D /* ContactCell.swift in Sources */,
 				3402AA88271D9E180084CBAE /* ContactCellView.swift in Sources */,
@@ -9565,7 +9569,6 @@
 				3402AAB6271D9E180084CBAE /* ImageEditorCropViewController.swift in Sources */,
 				3402AA72271D9E180084CBAE /* ImageEditorItem.swift in Sources */,
 				3402AA90271D9E180084CBAE /* ImageEditorModel.swift in Sources */,
-				3402AAA0271D9E180084CBAE /* ImageEditorPaletteView.swift in Sources */,
 				3402AA98271D9E180084CBAE /* ImageEditorPanGestureRecognizer.swift in Sources */,
 				3402AA89271D9E180084CBAE /* ImageEditorPinchGestureRecognizer.swift in Sources */,
 				768AE8BA280F713C00998C2D /* ImageEditorSliderView.swift in Sources */,
@@ -9590,6 +9593,7 @@
 				3402AA9C271D9E180084CBAE /* ManualLayoutView.swift in Sources */,
 				3402AA8D271D9E180084CBAE /* ManualStackView.swift in Sources */,
 				3402AA57271D9DCD0084CBAE /* MediaMessageView.swift in Sources */,
+				76A2EB1028B578B800A29C24 /* MediaTextView.swift in Sources */,
 				766035A9286CE4CB00F6B71C /* MediaTopBar.swift in Sources */,
 				3402AAAF271D9E180084CBAE /* Mention.swift in Sources */,
 				3402AAA6271D9E180084CBAE /* MentionPicker.swift in Sources */,
diff --git a/SignalUI/Views/ImageEditor/ImageEditorPaletteView.swift b/SignalUI/Views/ColorPickerBar.swift
similarity index 86%
rename from SignalUI/Views/ImageEditor/ImageEditorPaletteView.swift
rename to SignalUI/Views/ColorPickerBar.swift
index d15f4c09cde..83827924f44 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorPaletteView.swift
+++ b/SignalUI/Views/ColorPickerBar.swift
@@ -4,16 +4,15 @@
 
 import UIKit
 
-protocol ImageEditorPaletteViewDelegate: AnyObject {
-    func imageEditorPaletteView(_ paletteView: ImageEditorPaletteView, didSelectColor color: ImageEditorColor)
+public protocol ColorPickerBarViewDelegate: AnyObject {
+    func colorPickerBarView(_ pickerView: ColorPickerBarView, didSelectColor color: ColorPickerBarColor)
 }
 
 // MARK: -
 
-// We represent image editor colors using this (color, phase)
-// tuple so that we can consistently restore palette view
-// state.
-class ImageEditorColor {
+// We represent picker colors using this (color, phase)
+// tuple so that we can consistently restore palette view state.
+public class ColorPickerBarColor {
     let color: UIColor
 
     // Colors are chosen from a spectrum of colors.
@@ -30,8 +29,8 @@ class ImageEditorColor {
         self.palettePhase = palettePhase
     }
 
-    class func defaultColor() -> ImageEditorColor {
-        return ImageEditorColor(color: UIColor(rgbHex: 0xff0000), palettePhase: 1/9)
+    class func defaultColor() -> ColorPickerBarColor {
+        return ColorPickerBarColor(color: UIColor(rgbHex: 0xff0000), palettePhase: 1/9)
     }
 
     static var gradientUIColors: [UIColor] {
@@ -52,14 +51,14 @@ class ImageEditorColor {
         return gradientUIColors.map { $0.cgColor }
     }
 
-    static func == (left: ImageEditorColor, right: ImageEditorColor) -> Bool {
+    static func == (left: ColorPickerBarColor, right: ColorPickerBarColor) -> Bool {
         return left.palettePhase.fuzzyEquals(right.palettePhase)
     }
 }
 
 // MARK: -
 
-private class PalettePreviewView: OWSLayerView {
+private class ColorPreviewView: OWSLayerView {
 
     private static let innerRadius: CGFloat = 32
     // The distance from the "inner circle" to the "teardrop".
@@ -94,9 +93,9 @@ private class PalettePreviewView: OWSLayerView {
         teardropLayer.fillColor = teardropColor.cgColor
 
         layoutCallback = { (view) in
-            PalettePreviewView.updateLayers(view: view,
-                                            circleLayer: circleLayer,
-                                            teardropLayer: teardropLayer)
+            ColorPreviewView.updateLayers(view: view,
+                                          circleLayer: circleLayer,
+                                          teardropLayer: teardropLayer)
         }
 
         // The bounding rect of the teardrop + shadow is non-trivial, so
@@ -104,7 +103,7 @@ private class PalettePreviewView: OWSLayerView {
         //
         // The size doesn't matter since this view is
         // mostly transparent and isn't hot.
-        autoSetDimensions(to: CGSize(square: PalettePreviewView.innerRadius * 4))
+        autoSetDimensions(to: CGSize(square: ColorPreviewView.innerRadius * 4))
     }
 
     @available(*, unavailable, message: "use other init() instead.")
@@ -165,17 +164,17 @@ private class PalettePreviewView: OWSLayerView {
 
 // MARK: -
 
-class ImageEditorPaletteView: UIView {
+public class ColorPickerBarView: UIView {
 
-    weak var delegate: ImageEditorPaletteViewDelegate?
+    weak var delegate: ColorPickerBarViewDelegate?
 
-    var selectedValue: ImageEditorColor {
+    var selectedValue: ColorPickerBarColor {
         didSet {
             updateState()
         }
     }
 
-    required init(currentColor: ImageEditorColor) {
+    required init(currentColor: ColorPickerBarColor) {
         self.selectedValue = currentColor
 
         super.init(frame: .zero)
@@ -208,7 +207,7 @@ class ImageEditorPaletteView: UIView {
     // imageWrapper is used to host the "selection view".
     private let imageWrapper = OWSLayerView()
     private var selectionConstraint: NSLayoutConstraint?
-    private let previewView = PalettePreviewView()
+    private let previewView = ColorPreviewView()
 
     private func createContents() {
         isOpaque = false
@@ -216,13 +215,13 @@ class ImageEditorPaletteView: UIView {
         layoutMargins.trailing = 0
 
         let borderWidth: CGFloat = 2
-        let image = ImageEditorPaletteView.buildPaletteGradientImage()
+        let image = ColorPickerBarView.buildPaletteGradientImage()
         imageView.image = image
         let imageRadius = image.size.height * 0.5
         imageView.layer.cornerRadius = imageRadius
         imageView.clipsToBounds = true
         addSubview(imageView)
-        imageView.autoSetDimension(.height, toSize: ImageEditorPaletteView.colorBarWidth)
+        imageView.autoSetDimension(.height, toSize: ColorPickerBarView.colorBarWidth)
         imageView.autoPinEdgesToSuperviewMargins(with: UIEdgeInsets(margin: borderWidth))
 
         // Create "outer border" that doesn't obscure any colors in the strip.
@@ -265,10 +264,10 @@ class ImageEditorPaletteView: UIView {
         let palettePhase = locationX.inverseLerp(0, imageView.width, shouldClamp: true)
         selectedValue = value(for: palettePhase)
 
-        delegate?.imageEditorPaletteView(self, didSelectColor: selectedValue)
+        delegate?.colorPickerBarView(self, didSelectColor: selectedValue)
     }
 
-    private func value(for palettePhase: CGFloat) -> ImageEditorColor {
+    private func value(for palettePhase: CGFloat) -> ColorPickerBarColor {
         // We find the color in the palette's gradient that corresponds
         // to the "phase".
         //
@@ -281,9 +280,9 @@ class ImageEditorPaletteView: UIView {
             let palettePhase1: CGFloat
         }
         var segments = [GradientSegment]()
-        let segmentCount = ImageEditorColor.gradientUIColors.count - 1
+        let segmentCount = ColorPickerBarColor.gradientUIColors.count - 1
         var prevColor: UIColor?
-        for color in ImageEditorColor.gradientUIColors {
+        for color in ColorPickerBarColor.gradientUIColors {
             if let color0 = prevColor {
                 let index = CGFloat(segments.count)
                 let color1 = color
@@ -301,18 +300,18 @@ class ImageEditorPaletteView: UIView {
         }
         guard let segment = bestSegment else {
             owsFailDebug("Couldn't find matching segment.")
-            return ImageEditorColor.defaultColor()
+            return ColorPickerBarColor.defaultColor()
         }
         guard palettePhase >= segment.palettePhase0,
               palettePhase <= segment.palettePhase1 else {
             owsFailDebug("Invalid segment.")
-            return ImageEditorColor.defaultColor()
+            return ColorPickerBarColor.defaultColor()
         }
         let segmentPhase = palettePhase.inverseLerp(segment.palettePhase0, segment.palettePhase1).clamp01()
         // If CAGradientLayer doesn't do naive RGB color interpolation,
         // this won't be WYSIWYG.
         let color = segment.color0.blended(with: segment.color1, alpha: segmentPhase)
-        return ImageEditorColor(color: color, palettePhase: palettePhase)
+        return ColorPickerBarColor(color: color, palettePhase: palettePhase)
     }
 
     private func updateState() {
@@ -354,7 +353,7 @@ class ImageEditorPaletteView: UIView {
         gradientView.layer.addSublayer(gradientLayer)
         gradientLayer.frame = gradientBounds
         // See: https://github.com/signalapp/Signal-Android/blob/42e94d8f921aba212b1ffebfae4f2590a6f3385a/res/values/arrays.xml#L267-L277
-        gradientLayer.colors = ImageEditorColor.gradientCGColors
+        gradientLayer.colors = ColorPickerBarColor.gradientCGColors
         gradientLayer.startPoint = CGPoint.zero
         gradientLayer.endPoint = CGPoint(x: 1, y: 0)
         return gradientView.renderAsImage(opaque: true, scale: UIScreen.main.scale)
diff --git a/SignalUI/Views/ImageEditor/ImageEditorCanvasView.swift b/SignalUI/Views/ImageEditor/ImageEditorCanvasView.swift
index 221e7fa3fd3..ffbf499878d 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorCanvasView.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorCanvasView.swift
@@ -753,7 +753,7 @@ class ImageEditorCanvasView: AttachmentPrepContentView {
         // We need to adjust the font size to reflect the current output scale,
         // using the image width as reference.
         let fontSize = item.fontSize * imageFrame.size.width / item.fontReferenceImageWidth
-        let font = ImageEditorTextItem.font(forTextStyle: item.textStyle, pointSize: fontSize)
+        let font = MediaTextView.font(forTextStyle: item.textStyle, pointSize: fontSize)
 
         let textColor: UIColor = {
             switch item.decorationStyle {
diff --git a/SignalUI/Views/ImageEditor/ImageEditorModel.swift b/SignalUI/Views/ImageEditor/ImageEditorModel.swift
index adad2387347..d2c138bb8ee 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorModel.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorModel.swift
@@ -52,7 +52,7 @@ class ImageEditorModel: NSObject {
 
     var blurredSourceImage: CGImage?
 
-    var color = ImageEditorColor.defaultColor()
+    var color = ColorPickerBarColor.defaultColor()
 
     // We don't want to allow editing of images if:
     //
diff --git a/SignalUI/Views/ImageEditor/ImageEditorTextItem.swift b/SignalUI/Views/ImageEditor/ImageEditorTextItem.swift
index fcfbffec15f..d8f12e4b96c 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorTextItem.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorTextItem.swift
@@ -8,57 +8,16 @@ class ImageEditorTextItem: ImageEditorItem {
 
     let text: String
 
-    let color: ImageEditorColor
+    let color: ColorPickerBarColor
 
-    enum DecorationStyle: Int {
-        case none = 0
-        case inverted
-        case underline
-        case outline
-    }
-    let decorationStyle: DecorationStyle
+    let decorationStyle: MediaTextView.DecorationStyle
 
-    enum TextStyle: Int {
-        case regular = 0
-        case bold
-        case serif
-        case script
-        case condensed
-    }
-    let textStyle: TextStyle
+    let textStyle: MediaTextView.TextStyle
 
     let fontSize: CGFloat
     static let defaultFontSize: CGFloat = 36
     var font: UIFont {
-        ImageEditorTextItem.font(forTextStyle: textStyle, pointSize: fontSize)
-    }
-
-    class func font(forTextStyle textStyle: TextStyle, pointSize: CGFloat) -> UIFont {
-        // TODO: this is a copy-paste code from TextAttachmentView that needs to be consolidated in one place.
-        let attributes: [UIFontDescriptor.AttributeName: Any]
-
-        switch textStyle {
-        case .regular:
-            attributes = [.name: "Inter-Regular_Bold"]
-        case .bold:
-            attributes = [.name: "Inter-Regular_Black"]
-        case .serif:
-            attributes = [.name: "EBGaramond-Regular"]
-        case .script:
-            attributes = [.name: "Parisienne-Regular"]
-        case .condensed:
-            // TODO: Ideally we could set an attribute to make this font
-            // all caps, but iOS deprecated that ability and didn't add
-            // a new equivalent function.
-            attributes = [.name: "BarlowCondensed-Medium"]
-        }
-
-        // TODO: Eventually we'll want to provide a cascadeList here to fallback
-        // to different fonts for different scripts rather than just relying on
-        // the built in OS fallbacks that don't tend to match the desired style.
-        let descriptor = UIFontDescriptor(fontAttributes: attributes)
-
-        return UIFont(descriptor: descriptor, size: pointSize)
+        MediaTextView.font(forTextStyle: textStyle, pointSize: fontSize)
     }
 
     // In order to render the text at a consistent size
@@ -98,10 +57,10 @@ class ImageEditorTextItem: ImageEditorItem {
     let scaling: CGFloat
 
     init(text: String,
-         color: ImageEditorColor,
+         color: ColorPickerBarColor,
          fontSize: CGFloat,
-         textStyle: TextStyle = .regular,
-         decorationStyle: DecorationStyle = .none,
+         textStyle: MediaTextView.TextStyle = .regular,
+         decorationStyle: MediaTextView.DecorationStyle = .none,
          fontReferenceImageWidth: CGFloat,
          unitCenter: ImageEditorSample = ImageEditorSample(x: 0.5, y: 0.5),
          unitWidth: CGFloat = ImageEditorTextItem.kDefaultUnitWidth,
@@ -123,10 +82,10 @@ class ImageEditorTextItem: ImageEditorItem {
 
     private init(itemId: String,
                  text: String,
-                 color: ImageEditorColor,
+                 color: ColorPickerBarColor,
                  fontSize: CGFloat,
-                 textStyle: TextStyle,
-                 decorationStyle: DecorationStyle,
+                 textStyle: MediaTextView.TextStyle,
+                 decorationStyle: MediaTextView.DecorationStyle,
                  fontReferenceImageWidth: CGFloat,
                  unitCenter: ImageEditorSample,
                  unitWidth: CGFloat,
@@ -146,9 +105,9 @@ class ImageEditorTextItem: ImageEditorItem {
         super.init(itemId: itemId, itemType: .text)
     }
 
-    class func empty(withColor color: ImageEditorColor,
-                     textStyle: TextStyle,
-                     decorationStyle: DecorationStyle,
+    class func empty(withColor color: ColorPickerBarColor,
+                     textStyle: MediaTextView.TextStyle,
+                     decorationStyle: MediaTextView.DecorationStyle,
                      unitWidth: CGFloat,
                      fontReferenceImageWidth: CGFloat,
                      scaling: CGFloat,
@@ -164,7 +123,7 @@ class ImageEditorTextItem: ImageEditorItem {
                                    scaling: scaling)
     }
 
-    func copy(withText newText: String, color newColor: ImageEditorColor) -> ImageEditorTextItem {
+    func copy(withText newText: String, color newColor: ColorPickerBarColor) -> ImageEditorTextItem {
         return ImageEditorTextItem(itemId: itemId,
                                    text: newText,
                                    color: newColor,
@@ -234,7 +193,7 @@ class ImageEditorTextItem: ImageEditorItem {
                                    scaling: scaling)
     }
 
-    func copy(color: ImageEditorColor) -> ImageEditorTextItem {
+    func copy(color: ColorPickerBarColor) -> ImageEditorTextItem {
         return ImageEditorTextItem(itemId: itemId,
                                    text: text,
                                    color: color,
@@ -248,7 +207,7 @@ class ImageEditorTextItem: ImageEditorItem {
                                    scaling: scaling)
     }
 
-    func copy(textStyle: TextStyle, decorationStyle: DecorationStyle) -> ImageEditorTextItem {
+    func copy(textStyle: MediaTextView.TextStyle, decorationStyle: MediaTextView.DecorationStyle) -> ImageEditorTextItem {
         return ImageEditorTextItem(itemId: itemId,
                                    text: text,
                                    color: color,
diff --git a/SignalUI/Views/ImageEditor/ImageEditorView.swift b/SignalUI/Views/ImageEditor/ImageEditorView.swift
index eb0e9bbeaac..051eb5fa7c6 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorView.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorView.swift
@@ -129,7 +129,7 @@ class ImageEditorView: AttachmentPrepContentView {
         }
     }
 
-    func updateSelectedTextItem(withColor color: ImageEditorColor) {
+    func updateSelectedTextItem(withColor color: ColorPickerBarColor) {
         if let selectedTextItemId = selectedTextItemId,
            let textItem = model.item(forId: selectedTextItemId) as? ImageEditorTextItem {
             let newTextItem = textItem.copy(color: color)
@@ -137,9 +137,9 @@ class ImageEditorView: AttachmentPrepContentView {
         }
     }
 
-    func createNewTextItem(withColor color: ImageEditorColor? = nil,
-                           textStyle: ImageEditorTextItem.TextStyle = .regular,
-                           decorationStyle: ImageEditorTextItem.DecorationStyle = .none) -> ImageEditorTextItem {
+    func createNewTextItem(withColor color: ColorPickerBarColor? = nil,
+                           textStyle: MediaTextView.TextStyle = .regular,
+                           decorationStyle: MediaTextView.DecorationStyle = .none) -> ImageEditorTextItem {
         Logger.verbose("")
 
         let viewSize = canvasView.gestureReferenceView.bounds.size
diff --git a/SignalUI/Views/ImageEditor/ImageEditorViewController+Draw.swift b/SignalUI/Views/ImageEditor/ImageEditorViewController+Draw.swift
index 75310887a2e..ed2a540e015 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorViewController+Draw.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorViewController+Draw.swift
@@ -73,7 +73,7 @@ extension ImageEditorViewController {
             self.currentStrokeSamples.append(newSample)
         }
 
-        var strokeColor = drawToolbar.paletteView.selectedValue.color
+        var strokeColor = drawToolbar.colorPickerView.selectedValue.color
         if currentStrokeType == .highlighter {
             strokeColor = strokeColor.withAlphaComponent(Self.highligherStrokeOpacity)
         }
@@ -133,12 +133,12 @@ extension ImageEditorViewController {
 
     class DrawToolbar: UIView {
 
-        let paletteView: ImageEditorPaletteView
+        let colorPickerView: ColorPickerBarView
 
         let strokeTypeButton = RoundMediaButton(image: #imageLiteral(resourceName: "media-editor-draw-pen"), backgroundStyle: .blur)
 
-        init(currentColor: ImageEditorColor) {
-            self.paletteView = ImageEditorPaletteView(currentColor: currentColor)
+        init(currentColor: ColorPickerBarColor) {
+            self.colorPickerView = ColorPickerBarView(currentColor: currentColor)
             super.init(frame: .zero)
 
             layoutMargins.top = 0
@@ -163,7 +163,7 @@ extension ImageEditorViewController {
 
             // I had to use a custom layout guide because stack view isn't centered
             // but instead has slight offset towards the trailing edge.
-            let stackView = UIStackView(arrangedSubviews: [ paletteView, strokeTypeButton ])
+            let stackView = UIStackView(arrangedSubviews: [ colorPickerView, strokeTypeButton ])
             stackView.translatesAutoresizingMaskIntoConstraints = false
             stackView.alignment = .center
             stackView.spacing = 8
diff --git a/SignalUI/Views/ImageEditor/ImageEditorViewController+Text.swift b/SignalUI/Views/ImageEditor/ImageEditorViewController+Text.swift
index 93d3343cc87..925c7e082c6 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorViewController+Text.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorViewController+Text.swift
@@ -85,57 +85,17 @@ extension ImageEditorViewController {
      * This method needs to be called when text item editing is about to begin.
      */
     func updateTextViewAttributes(using textItem: ImageEditorTextItem) {
-        updateTextView(color: textItem.color.color, font: textItem.font, decorationStyle: textItem.decorationStyle)
+        textView.update(withColor: textItem.color.color, font: textItem.font, decorationStyle: textItem.decorationStyle)
     }
 
     // Update UITextView to use style (font, color, decoration) as selected in provided TextToolbar.
     // This method needs to be called whenever user changes text styling while UITextView is active
     // in order to reflect the changes right away.
-    func updateTextViewAttributes(using textToolbar: TextToolbar) {
+    func updateTextViewAttributes(using textToolbar: TextStylingToolbar) {
         let fontPointSize = textView.font?.pointSize ?? ImageEditorTextItem.defaultFontSize
-        updateTextView(color: textToolbar.paletteView.selectedValue.color,
-                       font: ImageEditorTextItem.font(forTextStyle: textToolbar.textStyle, pointSize: fontPointSize),
-                       decorationStyle: textToolbar.decorationStyle)
-    }
-
-    private func updateTextView(color: UIColor, font: UIFont, decorationStyle: ImageEditorTextItem.DecorationStyle) {
-        var attributes: [NSAttributedString.Key: Any] = [ .font: font]
-
-        let textColor: UIColor = {
-            switch decorationStyle {
-            case .none: return color
-            default: return .white
-            }
-        }()
-        attributes[.foregroundColor] = textColor
-
-        if let paragraphStyle = NSParagraphStyle.default.mutableCopy() as? NSMutableParagraphStyle {
-            paragraphStyle.alignment = .center
-            attributes[.paragraphStyle] = paragraphStyle
-        }
-
-        switch decorationStyle {
-        case .underline:
-            attributes[.underlineStyle] = NSUnderlineStyle.single.rawValue
-            attributes[.underlineColor] = color
-
-        case .outline:
-            attributes[.strokeWidth] = -3
-            attributes[.strokeColor] = color
-
-        case .inverted:
-            attributes[.backgroundColor] = color
-
-        default:
-            break
-        }
-
-        textView.attributedText = NSAttributedString(string: textView.text, attributes: attributes)
-
-        // This makes UITextView apply text styling to the text that user enters.
-        textView.typingAttributes = attributes
-
-        textView.invalidateIntrinsicContentSize()
+        textView.update(withColor: textToolbar.colorPickerView.selectedValue.color,
+                        font: MediaTextView.font(forTextStyle: textToolbar.textStyle, pointSize: fontPointSize),
+                        decorationStyle: textToolbar.decorationStyle)
     }
 
     override func updateBottomLayoutConstraint(fromInset before: CGFloat, toInset after: CGFloat) {
@@ -170,8 +130,8 @@ extension ImageEditorViewController {
     func beginTextEditing() {
         guard let textItem = currentTextItem?.textItem else { return }
 
-        textToolbar.paletteView.selectedValue = textItem.color
-        textViewAccessoryToolbar.paletteView.selectedValue = textItem.color
+        textToolbar.colorPickerView.selectedValue = textItem.color
+        textViewAccessoryToolbar.colorPickerView.selectedValue = textItem.color
 
         textToolbar.textStyle = textItem.textStyle
         textViewAccessoryToolbar.textStyle = textItem.textStyle
@@ -243,7 +203,7 @@ extension ImageEditorViewController {
         }
 
         // Update text.
-        textItem = textItem.copy(withText: text, color: textToolbar.paletteView.selectedValue)
+        textItem = textItem.copy(withText: text, color: textToolbar.colorPickerView.selectedValue)
 
         guard currentTextItem.textItem != textItem else {
             // No changes were made.  Cancel to avoid dirtying the undo stack.
@@ -298,7 +258,7 @@ extension ImageEditorViewController {
     @objc
     func didTapTextStyleButton(sender: UIButton) {
         let currentTextStyle = textToolbar.textStyle
-        let nextTextStyle = ImageEditorTextItem.TextStyle(rawValue: currentTextStyle.rawValue + 1) ?? .regular
+        let nextTextStyle = MediaTextView.TextStyle(rawValue: currentTextStyle.rawValue + 1) ?? .regular
 
         // Update selected text object if any.
         if let selectedTextItemId = imageEditorView.selectedTextItemId,
@@ -320,7 +280,7 @@ extension ImageEditorViewController {
     @objc
     func didTapDecorationStyleButton(sender: UIButton) {
         let currentDecorationStyle = textToolbar.decorationStyle
-        var nextDecorationStyle = ImageEditorTextItem.DecorationStyle(rawValue: currentDecorationStyle.rawValue + 1) ?? .none
+        var nextDecorationStyle = MediaTextView.DecorationStyle(rawValue: currentDecorationStyle.rawValue + 1) ?? .none
         if nextDecorationStyle == .outline {
             nextDecorationStyle = .none
         }
@@ -341,66 +301,6 @@ extension ImageEditorViewController {
             updateTextViewAttributes(using: textToolbar)
         }
     }
-
-    // MARK: -
-
-    class TextToolbar: UIView {
-
-        let paletteView: ImageEditorPaletteView
-
-        let textStyleButton = RoundMediaButton(image: #imageLiteral(resourceName: "media-editor-text-font"), backgroundStyle: .blur)
-        var textStyle: ImageEditorTextItem.TextStyle = .regular
-
-        let decorationStyleButton = RoundMediaButton(image: #imageLiteral(resourceName: "media-editor-text-style-1"), backgroundStyle: .blur)
-        var decorationStyle: ImageEditorTextItem.DecorationStyle = .none {
-            didSet {
-                decorationStyleButton.isSelected = (decorationStyle != .none)
-            }
-        }
-
-        init(currentColor: ImageEditorColor) {
-            self.paletteView = ImageEditorPaletteView(currentColor: currentColor)
-            super.init(frame: .zero)
-
-            decorationStyleButton.setContentCompressionResistancePriority(.required, for: .vertical)
-            decorationStyleButton.setImage(#imageLiteral(resourceName: "media-editor-text-style-2"), for: .selected)
-
-            // A container with width capped at a predefined size,
-            // centered in superview and constrained to layout margins.
-            let stackViewLayoutGuide = UILayoutGuide()
-            addLayoutGuide(stackViewLayoutGuide)
-            addConstraints([
-                stackViewLayoutGuide.centerXAnchor.constraint(equalTo: centerXAnchor),
-                stackViewLayoutGuide.leadingAnchor.constraint(greaterThanOrEqualTo: layoutMarginsGuide.leadingAnchor),
-                stackViewLayoutGuide.topAnchor.constraint(equalTo: topAnchor),
-                stackViewLayoutGuide.bottomAnchor.constraint(equalTo: bottomAnchor, constant: -2) ])
-            addConstraint({
-                let constraint = stackViewLayoutGuide.widthAnchor.constraint(equalToConstant: ImageEditorViewController.preferredToolbarContentWidth)
-                constraint.priority = .defaultHigh
-                return constraint
-            }())
-
-            // I had to use a custom layout guide because stack view isn't centered
-            // but instead has slight offset towards the trailing edge.
-            let stackView = UIStackView(arrangedSubviews: [ paletteView, textStyleButton, decorationStyleButton ])
-            stackView.translatesAutoresizingMaskIntoConstraints = false
-            stackView.alignment = .center
-            stackView.spacing = 8
-            stackView.setCustomSpacing(0, after: textStyleButton)
-            addSubview(stackView)
-            addConstraints([
-                stackView.leadingAnchor.constraint(equalTo: stackViewLayoutGuide.leadingAnchor),
-                stackView.trailingAnchor.constraint(equalTo: stackViewLayoutGuide.trailingAnchor,
-                                                    constant: decorationStyleButton.layoutMargins.trailing),
-                stackView.topAnchor.constraint(equalTo: stackViewLayoutGuide.topAnchor),
-                stackView.bottomAnchor.constraint(equalTo: stackViewLayoutGuide.bottomAnchor) ])
-        }
-
-        @available(iOS, unavailable, message: "Use init(currentColor:)")
-        required init(coder: NSCoder) {
-            fatalError("init(coder:) has not been implemented")
-        }
-    }
 }
 
 // MARK: - UITextViewDelegate
@@ -444,8 +344,8 @@ extension ImageEditorViewController: ImageEditorViewDelegate {
            let textItem = model.item(forId: selectedTextItemId) as? ImageEditorTextItem {
             mode = .text
 
-            textToolbar.paletteView.selectedValue = textItem.color
-            textViewAccessoryToolbar.paletteView.selectedValue = textItem.color
+            textToolbar.colorPickerView.selectedValue = textItem.color
+            textViewAccessoryToolbar.colorPickerView.selectedValue = textItem.color
 
             textToolbar.textStyle = textItem.textStyle
             textViewAccessoryToolbar.textStyle = textItem.textStyle
@@ -463,47 +363,3 @@ extension ImageEditorViewController: ImageEditorViewDelegate {
         updateControlsVisibility()
     }
 }
-
-// TODO: Clean up this class.
-class VAlignTextView: UITextView {
-
-    private var kvoObservation: NSKeyValueObservation?
-
-    override init(frame: CGRect, textContainer: NSTextContainer?) {
-        super.init(frame: frame, textContainer: textContainer)
-
-        keyboardAppearance = .dark
-
-        kvoObservation = observe(\.contentSize, options: [.new]) { [weak self] _, _ in
-            guard let self = self else { return }
-            self.adjustFontSizeIfNecessary()
-        }
-    }
-
-    @available(*, unavailable, message: "use other init() instead.")
-    required public init?(coder aDecoder: NSCoder) {
-        fatalError("init(coder:) has not been implemented")
-    }
-
-    @objc
-    private func adjustFontSizeIfNecessary() {
-        // TODO: Figure out correct way to handle long text and implement it.
-    }
-
-    // MARK: - Key Commands
-
-    override var keyCommands: [UIKeyCommand]? {
-        return [
-            UIKeyCommand(input: "\r", modifierFlags: .command, action: #selector(self.modifiedReturnPressed(sender:)), discoverabilityTitle: "Add Text"),
-            UIKeyCommand(input: "\r", modifierFlags: .alternate, action: #selector(self.modifiedReturnPressed(sender:)), discoverabilityTitle: "Add Text")
-        ]
-    }
-
-    @objc
-    private func modifiedReturnPressed(sender: UIKeyCommand) {
-        Logger.verbose("")
-
-        acceptAutocorrectSuggestion()
-        resignFirstResponder()
-    }
-}
diff --git a/SignalUI/Views/ImageEditor/ImageEditorViewController.swift b/SignalUI/Views/ImageEditor/ImageEditorViewController.swift
index d0f4064ee10..40f222a0133 100644
--- a/SignalUI/Views/ImageEditor/ImageEditorViewController.swift
+++ b/SignalUI/Views/ImageEditor/ImageEditorViewController.swift
@@ -59,7 +59,7 @@ class ImageEditorViewController: OWSViewController {
     lazy var drawToolbar: DrawToolbar = {
         let toolbar = DrawToolbar(currentColor: model.color)
         toolbar.preservesSuperviewLayoutMargins = true
-        toolbar.paletteView.delegate = self
+        toolbar.colorPickerView.delegate = self
         toolbar.strokeTypeButton.addTarget(self, action: #selector(strokeTypeButtonTapped(sender:)), for: .touchUpInside)
         return toolbar
     }()
@@ -193,31 +193,23 @@ class ImageEditorViewController: OWSViewController {
         view.alpha = 0
         return view
     }()
-    lazy var textView: VAlignTextView = {
-        let textView = VAlignTextView()
+    lazy var textView: MediaTextView = {
+        let textView = MediaTextView()
         textView.delegate = self
-        textView.isEditable = true
-        textView.backgroundColor = .clear
-        textView.isOpaque = false
-        textView.tintColor = .white
-        textView.isScrollEnabled = false
-        textView.scrollsToTop = false
-        textView.textAlignment = .center
-        textView.textContainer.lineFragmentPadding = 0
         return textView
     }()
-    lazy var textToolbar: TextToolbar = {
-        let toolbar = TextToolbar(currentColor: currentTextItem?.textItem.color ?? model.color)
+    lazy var textToolbar: TextStylingToolbar = {
+        let toolbar = TextStylingToolbar(currentColor: currentTextItem?.textItem.color ?? model.color)
         toolbar.preservesSuperviewLayoutMargins = true
-        toolbar.paletteView.delegate = self
+        toolbar.colorPickerView.delegate = self
         toolbar.textStyleButton.addTarget(self, action: #selector(didTapTextStyleButton(sender:)), for: .touchUpInside)
         toolbar.decorationStyleButton.addTarget(self, action: #selector(didTapDecorationStyleButton(sender:)), for: .touchUpInside)
         return toolbar
     }()
-    lazy var textViewAccessoryToolbar: TextToolbar = {
-        let toolbar = TextToolbar(currentColor: currentTextItem?.textItem.color ?? model.color)
+    lazy var textViewAccessoryToolbar: TextStylingToolbar = {
+        let toolbar = TextStylingToolbar(currentColor: currentTextItem?.textItem.color ?? model.color)
         toolbar.preservesSuperviewLayoutMargins = true
-        toolbar.paletteView.delegate = self
+        toolbar.colorPickerView.delegate = self
         toolbar.textStyleButton.addTarget(self, action: #selector(didTapTextStyleButton(sender:)), for: .touchUpInside)
         toolbar.decorationStyleButton.addTarget(self, action: #selector(didTapDecorationStyleButton(sender:)), for: .touchUpInside)
         return toolbar
@@ -546,7 +538,7 @@ extension ImageEditorViewController {
         Logger.verbose("")
 
         let decorationStyle = textToolbar.decorationStyle
-        let textColor = textToolbar.paletteView.selectedValue
+        let textColor = textToolbar.colorPickerView.selectedValue
         let textItem = imageEditorView.createNewTextItem(withColor: textColor, decorationStyle: decorationStyle)
         selectTextItem(textItem, isNewItem: true, startEditing: true)
     }
@@ -641,9 +633,9 @@ extension ImageEditorViewController: ImageEditorModelObserver {
 
 // MARK: - ImageEditorPaletteViewDelegate
 
-extension ImageEditorViewController: ImageEditorPaletteViewDelegate {
+extension ImageEditorViewController: ColorPickerBarViewDelegate {
 
-    func imageEditorPaletteView(_ paletteView: ImageEditorPaletteView, didSelectColor color: ImageEditorColor) {
+    func colorPickerBarView(_ pickerView: ColorPickerBarView, didSelectColor color: ColorPickerBarColor) {
         switch mode {
         case .draw:
             model.color = color
@@ -651,10 +643,10 @@ extension ImageEditorViewController: ImageEditorPaletteViewDelegate {
 
         case .text:
             imageEditorView.updateSelectedTextItem(withColor: color)
-            if paletteView == textToolbar.paletteView {
-                textViewAccessoryToolbar.paletteView.selectedValue = color
-            } else if paletteView == textViewAccessoryToolbar.paletteView {
-                textToolbar.paletteView.selectedValue = color
+            if pickerView == textToolbar.colorPickerView {
+                textViewAccessoryToolbar.colorPickerView.selectedValue = color
+            } else if pickerView == textViewAccessoryToolbar.colorPickerView {
+                textToolbar.colorPickerView.selectedValue = color
             }
             if textView.isFirstResponder {
                 updateTextViewAttributes(using: textToolbar)
diff --git a/SignalUI/Views/MediaTextView.swift b/SignalUI/Views/MediaTextView.swift
new file mode 100644
index 00000000000..5b99cd6acb3
--- /dev/null
+++ b/SignalUI/Views/MediaTextView.swift
@@ -0,0 +1,194 @@
+//
+//  Copyright (c) 2022 Open Whisper Systems. All rights reserved.
+//
+
+import UIKit
+
+public class MediaTextView: UITextView {
+
+    enum DecorationStyle: Int {
+        case none = 0
+        case inverted
+        case underline
+        case outline
+    }
+
+    enum TextStyle: Int {
+        case regular = 0
+        case bold
+        case serif
+        case script
+        case condensed
+    }
+
+    class func font(forTextStyle textStyle: TextStyle, pointSize: CGFloat) -> UIFont {
+        // TODO: this is a copy-paste code from TextAttachmentView that needs to be consolidated in one place.
+        let attributes: [UIFontDescriptor.AttributeName: Any]
+
+        switch textStyle {
+        case .regular:
+            attributes = [.name: "Inter-Regular_Bold"]
+        case .bold:
+            attributes = [.name: "Inter-Regular_Black"]
+        case .serif:
+            attributes = [.name: "EBGaramond-Regular"]
+        case .script:
+            attributes = [.name: "Parisienne-Regular"]
+        case .condensed:
+            // TODO: Ideally we could set an attribute to make this font
+            // all caps, but iOS deprecated that ability and didn't add
+            // a new equivalent function.
+            attributes = [.name: "BarlowCondensed-Medium"]
+        }
+
+        // TODO: Eventually we'll want to provide a cascadeList here to fallback
+        // to different fonts for different scripts rather than just relying on
+        // the built in OS fallbacks that don't tend to match the desired style.
+        let descriptor = UIFontDescriptor(fontAttributes: attributes)
+
+        return UIFont(descriptor: descriptor, size: pointSize)
+    }
+
+    private var kvoObservation: NSKeyValueObservation?
+
+    override init(frame: CGRect, textContainer: NSTextContainer?) {
+        super.init(frame: frame, textContainer: textContainer)
+
+        backgroundColor = .clear
+        isOpaque = false
+        isScrollEnabled = false
+        keyboardAppearance = .dark
+        scrollsToTop = false
+        textAlignment = .center
+        tintColor = .white
+        self.textContainer.lineFragmentPadding = 0
+
+        kvoObservation = observe(\.contentSize, options: [.new]) { [weak self] _, _ in
+            guard let self = self else { return }
+            self.adjustFontSizeIfNecessary()
+        }
+    }
+
+    required init?(coder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
+
+    private func adjustFontSizeIfNecessary() {
+        // TODO: Figure out correct way to handle long text and implement it.
+    }
+
+    func update(withColor color: UIColor, font: UIFont, decorationStyle: MediaTextView.DecorationStyle) {
+        var attributes: [NSAttributedString.Key: Any] = [ .font: font]
+
+        let textColor: UIColor = {
+            switch decorationStyle {
+            case .none: return color
+            default: return .white
+            }
+        }()
+        attributes[.foregroundColor] = textColor
+
+        if let paragraphStyle = NSParagraphStyle.default.mutableCopy() as? NSMutableParagraphStyle {
+            paragraphStyle.alignment = .center
+            attributes[.paragraphStyle] = paragraphStyle
+        }
+
+        switch decorationStyle {
+        case .underline:
+            attributes[.underlineStyle] = NSUnderlineStyle.single.rawValue
+            attributes[.underlineColor] = color
+
+        case .outline:
+            attributes[.strokeWidth] = -3
+            attributes[.strokeColor] = color
+
+        case .inverted:
+            attributes[.backgroundColor] = color
+
+        default:
+            break
+        }
+
+        attributedText = NSAttributedString(string: text, attributes: attributes)
+
+        // This makes UITextView apply text styling to the text that user enters.
+        typingAttributes = attributes
+
+        invalidateIntrinsicContentSize()
+    }
+
+    // MARK: - Key Commands
+
+    public override var keyCommands: [UIKeyCommand]? {
+        return [
+            UIKeyCommand(input: "\r", modifierFlags: .command, action: #selector(modifiedReturnPressed(sender:)), discoverabilityTitle: "Add Text"),
+            UIKeyCommand(input: "\r", modifierFlags: .alternate, action: #selector(modifiedReturnPressed(sender:)), discoverabilityTitle: "Add Text")
+        ]
+    }
+
+    @objc
+    private func modifiedReturnPressed(sender: UIKeyCommand) {
+        Logger.verbose("")
+
+        acceptAutocorrectSuggestion()
+        resignFirstResponder()
+    }
+}
+
+public class TextStylingToolbar: UIView {
+
+    let colorPickerView: ColorPickerBarView
+
+    let textStyleButton = RoundMediaButton(image: #imageLiteral(resourceName: "media-editor-text-font"), backgroundStyle: .blur)
+    var textStyle: MediaTextView.TextStyle = .regular
+
+    let decorationStyleButton = RoundMediaButton(image: #imageLiteral(resourceName: "media-editor-text-style-1"), backgroundStyle: .blur)
+    var decorationStyle: MediaTextView.DecorationStyle = .none {
+        didSet {
+            decorationStyleButton.isSelected = (decorationStyle != .none)
+        }
+    }
+
+    init(currentColor: ColorPickerBarColor) {
+        self.colorPickerView = ColorPickerBarView(currentColor: currentColor)
+        super.init(frame: .zero)
+
+        decorationStyleButton.setContentCompressionResistancePriority(.required, for: .vertical)
+        decorationStyleButton.setImage(#imageLiteral(resourceName: "media-editor-text-style-2"), for: .selected)
+
+        // A container with width capped at a predefined size,
+        // centered in superview and constrained to layout margins.
+        let stackViewLayoutGuide = UILayoutGuide()
+        addLayoutGuide(stackViewLayoutGuide)
+        addConstraints([
+            stackViewLayoutGuide.centerXAnchor.constraint(equalTo: centerXAnchor),
+            stackViewLayoutGuide.leadingAnchor.constraint(greaterThanOrEqualTo: layoutMarginsGuide.leadingAnchor),
+            stackViewLayoutGuide.topAnchor.constraint(equalTo: topAnchor),
+            stackViewLayoutGuide.bottomAnchor.constraint(equalTo: bottomAnchor, constant: -2) ])
+        addConstraint({
+            let constraint = stackViewLayoutGuide.widthAnchor.constraint(equalToConstant: ImageEditorViewController.preferredToolbarContentWidth)
+            constraint.priority = .defaultHigh
+            return constraint
+        }())
+
+        // I had to use a custom layout guide because stack view isn't centered
+        // but instead has slight offset towards the trailing edge.
+        let stackView = UIStackView(arrangedSubviews: [ colorPickerView, textStyleButton, decorationStyleButton ])
+        stackView.translatesAutoresizingMaskIntoConstraints = false
+        stackView.alignment = .center
+        stackView.spacing = 8
+        stackView.setCustomSpacing(0, after: textStyleButton)
+        addSubview(stackView)
+        addConstraints([
+            stackView.leadingAnchor.constraint(equalTo: stackViewLayoutGuide.leadingAnchor),
+            stackView.trailingAnchor.constraint(equalTo: stackViewLayoutGuide.trailingAnchor,
+                                                constant: decorationStyleButton.layoutMargins.trailing),
+            stackView.topAnchor.constraint(equalTo: stackViewLayoutGuide.topAnchor),
+            stackView.bottomAnchor.constraint(equalTo: stackViewLayoutGuide.bottomAnchor) ])
+    }
+
+    @available(iOS, unavailable, message: "Use init(currentColor:)")
+    required init(coder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
+}
