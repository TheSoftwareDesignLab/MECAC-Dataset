diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index 78a9e8d46fe..727d66eacd3 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -119,7 +119,6 @@
 		3402AA8C271D9E180084CBAE /* LoopingVideoView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9552F271B510400B05242 /* LoopingVideoView.swift */; };
 		3402AA8D271D9E180084CBAE /* ManualStackView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9550C271B510400B05242 /* ManualStackView.swift */; };
 		3402AA8E271D9E180084CBAE /* TextViewWithPlaceholder.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9553E271B510400B05242 /* TextViewWithPlaceholder.swift */; };
-		3402AA8F271D9E180084CBAE /* ThemeHeaderView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95537271B510400B05242 /* ThemeHeaderView.swift */; };
 		3402AA90271D9E180084CBAE /* ImageEditorModel.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A9555A271B510400B05242 /* ImageEditorModel.swift */; };
 		3402AA91271D9E180084CBAE /* GalleryRailView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95548271B510400B05242 /* GalleryRailView.swift */; };
 		3402AA92271D9E180084CBAE /* CVText.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34A95525271B510400B05242 /* CVText.swift */; };
@@ -588,7 +587,6 @@
 		45DDD06729C1365100FD9670 /* MediaGalleryAccessoriesHelper.swift in Sources */ = {isa = PBXBuildFile; fileRef = 45DDD06629C1365100FD9670 /* MediaGalleryAccessoriesHelper.swift */; };
 		45E5A6991F61E6DE001E4A8A /* MarqueeLabel.swift in Sources */ = {isa = PBXBuildFile; fileRef = 45E5A6981F61E6DD001E4A8A /* MarqueeLabel.swift */; };
 		45E7A6A81E71CA7E00D44FB5 /* DisplayableTextFilterTest.swift in Sources */ = {isa = PBXBuildFile; fileRef = 45E7A6A61E71CA7E00D44FB5 /* DisplayableTextFilterTest.swift */; };
-		45EFA8D82A391EE800DB91C6 /* MediaTileCell.swift in Sources */ = {isa = PBXBuildFile; fileRef = 45069FCB29D4FFD200D0DD14 /* MediaTileCell.swift */; };
 		45F32C232057297A00A300D5 /* MediaPageViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 45F32C1D205718B000A300D5 /* MediaPageViewController.swift */; };
 		45F32C242057297A00A300D5 /* MessageDetailViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 34CA1C261F7156F300E51C51 /* MessageDetailViewController.swift */; };
 		4AC4EA13C8A444455DAB351F /* Pods_SignalMessaging.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 264242150E87D10A357DB07B /* Pods_SignalMessaging.framework */; };
@@ -911,6 +909,7 @@
 		7609818C2936EF22008F8300 /* AudioPlayer.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7609818B2936EF22008F8300 /* AudioPlayer.swift */; };
 		7609819429382EFF008F8300 /* UIGeometry+Signal.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7609819329382EFF008F8300 /* UIGeometry+Signal.swift */; };
 		760D93AB27A0E28600F351AC /* CoreServices.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 760D93AA27A0E28600F351AC /* CoreServices.framework */; };
+		7622B3B22A4510D7000E31DA /* MediaGalleryCellItem.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7622B3B12A4510D7000E31DA /* MediaGalleryCellItem.swift */; };
 		7628DDBE2807505D009AA53D /* ImageEditorCropView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7628DDBC28075056009AA53D /* ImageEditorCropView.swift */; };
 		7628DDBF2807505D009AA53D /* RotationControl.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7628DDBD2807505D009AA53D /* RotationControl.swift */; };
 		7628DDC1280750BC009AA53D /* ExpandableContactListView.swift in Sources */ = {isa = PBXBuildFile; fileRef = 7628DDC0280750BC009AA53D /* ExpandableContactListView.swift */; };
@@ -2795,7 +2794,6 @@
 		34A95532271B510400B05242 /* TappableView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = TappableView.swift; sourceTree = "<group>"; };
 		34A95535271B510400B05242 /* OWSBubbleShapeView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = OWSBubbleShapeView.swift; sourceTree = "<group>"; };
 		34A95536271B510400B05242 /* ContactTableViewCell.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ContactTableViewCell.swift; sourceTree = "<group>"; };
-		34A95537271B510400B05242 /* ThemeHeaderView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ThemeHeaderView.swift; sourceTree = "<group>"; };
 		34A95538271B510400B05242 /* OWSLayerView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = OWSLayerView.swift; sourceTree = "<group>"; };
 		34A9553A271B510400B05242 /* CustomKeyboard.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = CustomKeyboard.swift; sourceTree = "<group>"; };
 		34A9553D271B510400B05242 /* OWSActionSheets.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = OWSActionSheets.swift; sourceTree = "<group>"; };
@@ -2968,7 +2966,6 @@
 		45069FC529D3A7C800D0DD14 /* WideMediaTileViewLayout.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = WideMediaTileViewLayout.swift; sourceTree = "<group>"; };
 		45069FC729D3A7E700D0DD14 /* SquareMediaTileViewLayout.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = SquareMediaTileViewLayout.swift; sourceTree = "<group>"; };
 		45069FC929D4FFBB00D0DD14 /* MediaTileDateFormatter.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MediaTileDateFormatter.swift; sourceTree = "<group>"; };
-		45069FCB29D4FFD200D0DD14 /* MediaTileCell.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = MediaTileCell.swift; sourceTree = "<group>"; };
 		45069FCD29D64CB300D0DD14 /* SelectionButton.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = SelectionButton.swift; sourceTree = "<group>"; };
 		450B0FC829FB301700B9A458 /* AudioMessageView.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = AudioMessageView.swift; sourceTree = "<group>"; };
 		451166BF1FD86B98000739BA /* AccountManager.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = AccountManager.swift; sourceTree = "<group>"; };
@@ -3396,6 +3393,7 @@
 		7609818B2936EF22008F8300 /* AudioPlayer.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = AudioPlayer.swift; sourceTree = "<group>"; };
 		7609819329382EFF008F8300 /* UIGeometry+Signal.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = "UIGeometry+Signal.swift"; sourceTree = "<group>"; };
 		760D93AA27A0E28600F351AC /* CoreServices.framework */ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = CoreServices.framework; path = System/Library/Frameworks/CoreServices.framework; sourceTree = SDKROOT; };
+		7622B3B12A4510D7000E31DA /* MediaGalleryCellItem.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = MediaGalleryCellItem.swift; sourceTree = "<group>"; };
 		7628DDBC28075056009AA53D /* ImageEditorCropView.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = ImageEditorCropView.swift; sourceTree = "<group>"; };
 		7628DDBD2807505D009AA53D /* RotationControl.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = RotationControl.swift; sourceTree = "<group>"; };
 		7628DDC0280750BC009AA53D /* ExpandableContactListView.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = ExpandableContactListView.swift; sourceTree = "<group>"; };
@@ -5729,7 +5727,6 @@
 				885275BF27E26775003F2F9B /* TextAttachmentView.swift */,
 				34A95528271B510400B05242 /* TextFieldWithPlaceholder.swift */,
 				34A9553E271B510400B05242 /* TextViewWithPlaceholder.swift */,
-				34A95537271B510400B05242 /* ThemeHeaderView.swift */,
 				34A95564271B510400B05242 /* Toast.swift */,
 				34A95519271B510400B05242 /* VideoPlayerView.swift */,
 			);
@@ -6330,6 +6327,7 @@
 				76AE4D9C2A14611C000D98A4 /* MediaControlPanelView.swift */,
 				452EC6DE205E9E30000E787C /* MediaGallery.swift */,
 				45DDD06629C1365100FD9670 /* MediaGalleryAccessoriesHelper.swift */,
+				7622B3B12A4510D7000E31DA /* MediaGalleryCellItem.swift */,
 				4585B4A2291B2BFB003A8F8E /* MediaGalleryCollectionViewUpdater.swift */,
 				1700E33828B568200073D949 /* MediaGallerySections.swift */,
 				76BB06F929AD84DB00978856 /* MediaItemViewController.swift */,
@@ -6928,7 +6926,6 @@
 				32AC5CE6255B51E900829BD8 /* JoinGroupCallPill.swift */,
 				88A941982409A391000E9700 /* LottieToggleButton.swift */,
 				45E5A6981F61E6DD001E4A8A /* MarqueeLabel.swift */,
-				45069FCB29D4FFD200D0DD14 /* MediaTileCell.swift */,
 				45069FC929D4FFBB00D0DD14 /* MediaTileDateFormatter.swift */,
 				8829883A25B9FD6700DEE1E3 /* MockConversationView.swift */,
 				3236FCC32592B67B006D33B9 /* NameCollisionReviewCell.swift */,
@@ -10947,7 +10944,6 @@
 				34A954DC271B4F3E00B05242 /* Theme+Icons.swift in Sources */,
 				7677E40D29F75C4200AC6A75 /* Theme.swift in Sources */,
 				66FC638429E2201500F00DAC /* ThemedColor+Theme.swift in Sources */,
-				3402AA8F271D9E180084CBAE /* ThemeHeaderView.swift in Sources */,
 				3402AA62271D9DEC0084CBAE /* ThreadUtil+SignalUI.swift in Sources */,
 				3402AA65271D9DEC0084CBAE /* ThreadViewModel.swift in Sources */,
 				3402AA96271D9E180084CBAE /* Toast.swift in Sources */,
@@ -11524,13 +11520,13 @@
 				346C19E125ACE9AE00061D3A /* MediaDownloadSettingsViewController.swift in Sources */,
 				452EC6DF205E9E30000E787C /* MediaGallery.swift in Sources */,
 				45DDD06729C1365100FD9670 /* MediaGalleryAccessoriesHelper.swift in Sources */,
+				7622B3B22A4510D7000E31DA /* MediaGalleryCellItem.swift in Sources */,
 				4585B4A3291B2BFB003A8F8E /* MediaGalleryCollectionViewUpdater.swift in Sources */,
 				1700E33928B568200073D949 /* MediaGallerySections.swift in Sources */,
 				4C8A6DFE22E54AFA00469AE7 /* MediaInteractiveDismiss.swift in Sources */,
 				76BB06FA29AD84DB00978856 /* MediaItemViewController.swift in Sources */,
 				45F32C232057297A00A300D5 /* MediaPageViewController.swift in Sources */,
 				4CD675C722E7D393008010D2 /* MediaPresentationContext.swift in Sources */,
-				45EFA8D82A391EE800DB91C6 /* MediaTileCell.swift in Sources */,
 				45069FCA29D4FFBB00D0DD14 /* MediaTileDateFormatter.swift in Sources */,
 				45D9784229F0B50000BBB3C0 /* MediaTileListModeCell.swift in Sources */,
 				45CADA8B298DD2B4009EBDF5 /* MediaTileScrollFlag.swift in Sources */,
diff --git a/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/Contents.json b/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/Contents.json
new file mode 100644
index 00000000000..18483464fa5
--- /dev/null
+++ b/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/Contents.json
@@ -0,0 +1,15 @@
+{
+  "images" : [
+    {
+      "filename" : "chevron-down-compact-bold.pdf",
+      "idiom" : "universal"
+    }
+  ],
+  "info" : {
+    "author" : "xcode",
+    "version" : 1
+  },
+  "properties" : {
+    "template-rendering-intent" : "template"
+  }
+}
diff --git a/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/chevron-down-compact-bold.pdf b/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/chevron-down-compact-bold.pdf
new file mode 100644
index 00000000000..cb05b26240b
Binary files /dev/null and b/Signal/Symbols.xcassets/chevron/chevron-down-compact-bold.imageset/chevron-down-compact-bold.pdf differ
diff --git a/Signal/src/ViewControllers/MediaGallery/AllMediaViewController.swift b/Signal/src/ViewControllers/MediaGallery/AllMediaViewController.swift
index 71e853cdad7..f1d1027ee23 100644
--- a/Signal/src/ViewControllers/MediaGallery/AllMediaViewController.swift
+++ b/Signal/src/ViewControllers/MediaGallery/AllMediaViewController.swift
@@ -8,9 +8,7 @@ import SignalUI
 
 class AllMediaViewController: OWSViewController {
     private let tileViewController: MediaTileViewController
-    private let name: String?
     private let accessoriesHelper = MediaGalleryAccessoriesHelper()
-    private static let lightModeBackground = UIColor(rgbHex: 0xE5E5E5)
 
     override var navigationItem: UINavigationItem {
         return tileViewController.navigationItem
@@ -21,30 +19,20 @@ class AllMediaViewController: OWSViewController {
         spoilerReveal: SpoilerRevealState,
         name: String?
     ) {
-        self.name = name
         tileViewController = MediaTileViewController(
             thread: thread,
             accessoriesHelper: accessoriesHelper,
             spoilerReveal: spoilerReveal
         )
         super.init()
+        navigationItem.title = name
         accessoriesHelper.viewController = tileViewController
     }
 
     override func viewDidLoad() {
         addChild(tileViewController)
         view.addSubview(tileViewController.view)
-        tileViewController.view.frame = view.bounds
-        view.autoresizesSubviews = true
-        tileViewController.view.autoresizingMask = [.flexibleWidth, .flexibleHeight]
-        if let name {
-            navigationItem.title = name
-        }
-        if #available(iOS 14.0, *) {
-            tileViewController.collectionView.backgroundColor = dynamicDesiredBackgroundColor
-        } else {
-            tileViewController.collectionView.backgroundColor = desiredBackgroundColor
-        }
+        tileViewController.view.autoPinEdgesToSuperviewEdges()
     }
 
     required init?(coder: NSCoder) {
@@ -52,25 +40,12 @@ class AllMediaViewController: OWSViewController {
     }
 
     override func themeDidChange() {
-        if #unavailable(iOS 14.0) {
-            tileViewController.collectionView.backgroundColor = desiredBackgroundColor
-        }
         owsNavigationController?.updateNavbarAppearance()
     }
-
-    @available(iOS 14, *)
-    private var dynamicDesiredBackgroundColor: UIColor {
-        return UIColor(dynamicProvider: { _ in
-            return Theme.isDarkThemeEnabled ? UIColor.ows_gray90 : Self.lightModeBackground
-        })
-    }
-
-    private var desiredBackgroundColor: UIColor {
-        Self.lightModeBackground
-    }
 }
 
 extension AllMediaViewController: MediaPresentationContextProvider {
+
     func mediaPresentationContext(item: Media, in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
         return tileViewController.mediaPresentationContext(item: item, in: coordinateSpace)
     }
@@ -81,11 +56,6 @@ extension AllMediaViewController: MediaPresentationContextProvider {
 }
 
 extension AllMediaViewController: OWSNavigationChildController {
-    var navbarBackgroundColorOverride: UIColor? {
-        if #available(iOS 14.0, *) {
-            return dynamicDesiredBackgroundColor
-        } else {
-            return desiredBackgroundColor
-        }
-    }
+
+    var navbarBackgroundColorOverride: UIColor? { Theme.tableView2PresentedBackgroundColor }
 }
diff --git a/Signal/src/ViewControllers/MediaGallery/Cells/AudioCell.swift b/Signal/src/ViewControllers/MediaGallery/Cells/AudioCell.swift
index ce1da6a587e..e6722a22ee5 100644
--- a/Signal/src/ViewControllers/MediaGallery/Cells/AudioCell.swift
+++ b/Signal/src/ViewControllers/MediaGallery/Cells/AudioCell.swift
@@ -9,9 +9,9 @@ import SignalUI
 
 class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
     static let reuseIdentifier = "AudioCell"
-    private var audioItem: AudioItem?
+    private var audioItem: MediaGalleryCellItemAudio?
     // TODO(george): Add support for dynamic size.
-    override class var desiredHeight: CGFloat { 86.0 }
+    class var desiredHeight: CGFloat { 86.0 }
     private var tapGestureRecognizer: UITapGestureRecognizer!
     private var panGestureRecognizer: UIPanGestureRecognizer!
     private var itemModel: CVItemModel?
@@ -20,10 +20,11 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
     private var conversationStyle: ConversationStyle?
     private var cellMeasurement: CVCellMeasurement?
 
-    private func createAudioMessageView(audioItem: AudioItem?, spoilerReveal: SpoilerRevealState, transaction: SDSAnyReadTransaction) -> AudioMessageView? {
-        guard let audioItem else {
-            return nil
-        }
+    private func createAudioMessageView(
+        audioItem: MediaGalleryCellItemAudio,
+        spoilerReveal: SpoilerRevealState,
+        transaction: SDSAnyReadTransaction
+    ) -> AudioMessageView? {
         guard let attachment = AudioAttachment(attachment: audioItem.attachmentStream,
                                                owningMessage: audioItem.message,
                                                metadata: audioItem.metadata) else {
@@ -130,10 +131,9 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
     private let leadingMargin = 16.0
     private let trailingMargin = 14.0
 
-    static func sizeForItem(_ item: AllMediaItem,
-                            defaultSize: CGSize) -> CGSize {
+    static func sizeForItem(_ item: MediaGalleryCellItem, defaultSize: CGSize) -> CGSize {
         switch item {
-        case .graphic:
+        case .photoVideo:
             return defaultSize
         case .audio(let audioItem):
             if AudioAllMediaPresenter.hasAttachmentLabel(attachment: audioItem.attachmentStream) {
@@ -144,9 +144,8 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
             return defaultSize
         }
     }
-    private func setupViews() {
-        willSetupViews()
 
+    private func setupViews() {
         contentView.addSubview(audioMessageContainerView)
         contentView.layer.cornerRadius = 10.0
         NSLayoutConstraint.activate([
@@ -221,37 +220,35 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
         cvAudioPlayer.togglePlayState(forAudioAttachment: audioAttachment)
     }
 
-    private func setUpAccessibility(item: AudioItem?) {
-        self.isAccessibilityElement = true
+    private func setUpAccessibility(item: MediaGalleryCellItemAudio?) {
+        isAccessibilityElement = true
 
         if let audioItem {
-            self.accessibilityLabel = [
+            accessibilityLabel = [
                 audioItem.localizedString,
                 MediaTileDateFormatter.formattedDateString(for: audioItem.date)
             ]
                 .compactMap { $0 }
                 .joined(separator: ", ")
         } else {
-            self.accessibilityLabel = ""
+            accessibilityLabel = ""
         }
     }
 
     private var audioMessageView: AudioMessageView?
 
     override var cellsAbut: Bool { false }
-    private var allMediaItem: AllMediaItem?
     private var spoilerReveal: SpoilerRevealState?
 
-    override func configure(item: AllMediaItem,
-                            spoilerReveal: SpoilerRevealState) {
+    override func configure(item: MediaGalleryCellItem, spoilerReveal: SpoilerRevealState) {
         super.configure(item: item, spoilerReveal: spoilerReveal)
         guard case let .audio(audioItem) = item else {
             owsFailDebug("Unexpected item type")
             return
         }
         self.audioItem = audioItem
-        self.allMediaItem = item
         self.spoilerReveal = spoilerReveal
+
         audioMessageContainerView.subviews.first?.removeFromSuperview()
 
         SDSDatabaseStorage.shared.read { transaction in
@@ -269,8 +266,8 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
     }
 
     override func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) {
-        if let allMediaItem, let spoilerReveal {
-            configure(item: allMediaItem, spoilerReveal: spoilerReveal)
+        if let item, let spoilerReveal {
+            configure(item: item, spoilerReveal: spoilerReveal)
         }
     }
 
@@ -286,9 +283,8 @@ class AudioCell: MediaTileListModeCell, AudioMessageViewDelegate {
     }
 
     func enqueueReloadWithoutCaches() {
-        if let allMediaItem, let spoilerReveal {
-            configure(item: allMediaItem, spoilerReveal: spoilerReveal)
+        if let item, let spoilerReveal {
+            configure(item: item, spoilerReveal: spoilerReveal)
         }
     }
-
 }
diff --git a/Signal/src/ViewControllers/MediaGallery/Cells/MediaTileListModeCell.swift b/Signal/src/ViewControllers/MediaGallery/Cells/MediaTileListModeCell.swift
index dbf3536c7aa..392a3796988 100644
--- a/Signal/src/ViewControllers/MediaGallery/Cells/MediaTileListModeCell.swift
+++ b/Signal/src/ViewControllers/MediaGallery/Cells/MediaTileListModeCell.swift
@@ -7,12 +7,9 @@ import Foundation
 import SignalMessaging
 import SignalUI
 
-@objc
-class MediaTileListModeCellSeparator: UIView { }
-
 // This is a base class for cells in All Media that have a wide, one-per-row
 // appearance, as opposed to square or grid.
-class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
+class MediaTileListModeCell: UICollectionViewCell, MediaGalleryCollectionViewCell {
     // This determines whether corners are rounded.
     private var isFirstInGroup: Bool = false
     private var isLastInGroup: Bool = false
@@ -21,80 +18,58 @@ class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
     private var constraintWithSelectionButton: NSLayoutConstraint!
     private var constraintWithoutSelectionButton: NSLayoutConstraint!
 
-    var item: AllMediaItem?
+    var item: MediaGalleryCellItem?
 
     /// Since UICollectionView doesn't support separators, we have to do it ourselves. Show the
     /// separator at the bottom of each item except when last in a section.
-    let separator: MediaTileListModeCellSeparator = {
-        let view = MediaTileListModeCellSeparator()
-        view.translatesAutoresizingMaskIntoConstraints = false
-        view.layer.borderWidth = 1.0
-        if #available(iOS 13, *) {
-            view.layer.borderColor = UIColor.separator.cgColor
-        } else {
-            view.layer.borderColor = UIColor(rgbHex: 0x3c3c43).withAlphaComponent(0.3).cgColor
-        }
+    let separator: UIView = {
+        let view = UIView()
+        view.backgroundColor = UIColor(dynamicProvider: { _ in Theme.cellSeparatorColor })
+        view.autoSetDimension(.height, toSize: .hairlineWidth)
         return view
     }()
 
-    let selectionButton = SelectionButton()
+    let selectionButton: SelectionButton = {
+        let button = SelectionButton()
+        button.outlineColor = UIColor(dynamicProvider: { _ in Theme.isDarkThemeEnabled ? .ows_gray25 : .ows_gray22 })
+        button.hidesOutlineWhenSelected = true
+        return button
+    }()
 
     private let selectedMaskView = UIView()
 
-    // TODO(george): This will change when dynamic text support is added.
-    class var desiredHeight: CGFloat { 64.0 }
+    override init(frame: CGRect) {
+        super.init(frame: frame)
 
-    private var dynamicDesiredSelectionOutlineColor: UIColor {
-        return UIColor { _ in
-            Theme.isDarkThemeEnabled ? UIColor.ows_gray25 : UIColor.ows_gray20
-        }
-    }
-
-    private lazy var selectionMaskColor: UIColor = {
-        if #available(iOS 13, *) {
-            return UIColor { _ in
-                Theme.isDarkThemeEnabled ? .ows_gray65 : .ows_gray15
-            }
-        } else {
-            return .ows_gray15
-        }
-    }()
-
-    func willSetupViews() {
         contentView.addSubview(selectedMaskView)
         contentView.addSubview(selectionButton)
         contentView.addSubview(separator)
     }
 
-    func setupViews(constraintWithSelectionButton: NSLayoutConstraint,
-                    constraintWithoutSelectionButton: NSLayoutConstraint) {
+    required init?(coder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
+    }
+
+    func setupViews(constraintWithSelectionButton: NSLayoutConstraint, constraintWithoutSelectionButton: NSLayoutConstraint) {
         self.constraintWithSelectionButton = constraintWithSelectionButton
         self.constraintWithoutSelectionButton = constraintWithoutSelectionButton
 
-        selectionButton.outlineColor = dynamicDesiredSelectionOutlineColor
-
-        if #available(iOS 13.0, *) {
-            contentView.backgroundColor = UIColor(dynamicProvider: { _ in
-                Theme.isDarkThemeEnabled ? .ows_gray80 : .white
-            })
-        } else {
-            contentView.backgroundColor = .white
-        }
+        contentView.backgroundColor = UIColor(dynamicProvider: { _ in Theme.tableCell2PresentedBackgroundColor })
 
-        selectedMaskView.alpha = 0.3
-        selectedMaskView.backgroundColor = selectionMaskColor
+        selectedMaskView.backgroundColor = UIColor(dynamicProvider: { _ in
+            Theme.isDarkThemeEnabled ? .ows_gray65 : .ows_gray15
+        })
         selectedMaskView.isHidden = true
 
         NSLayoutConstraint.activate([
             constraintWithoutSelectionButton,
 
-            selectionButton.leadingAnchor.constraint(equalTo: contentView.leadingAnchor, constant: 8),
+            selectionButton.leadingAnchor.constraint(equalTo: contentView.leadingAnchor, constant: 16),
             selectionButton.centerYAnchor.constraint(equalTo: contentView.centerYAnchor),
             selectionButton.widthAnchor.constraint(equalToConstant: 24),
             selectionButton.heightAnchor.constraint(equalToConstant: 24),
 
-            separator.topAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -1),
-            separator.heightAnchor.constraint(equalToConstant: 0.33),
+            separator.bottomAnchor.constraint(equalTo: contentView.bottomAnchor),
             separator.trailingAnchor.constraint(equalTo: contentView.trailingAnchor)
         ])
         selectedMaskView.autoPinEdgesToSuperviewEdges()
@@ -132,7 +107,11 @@ class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
     }
 
     private var _allowsMultipleSelection = false
-    var allowsMultipleSelection: Bool { _allowsMultipleSelection }
+
+    var allowsMultipleSelection: Bool {
+        get { _allowsMultipleSelection }
+        set { setAllowsMultipleSelection(newValue, animated: false) }
+    }
 
     func setAllowsMultipleSelection(_ allowed: Bool, animated: Bool) {
         _allowsMultipleSelection = allowed
@@ -148,11 +127,11 @@ class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
     private func updateSelectionState(animated: Bool) {
         selectedMaskView.isHidden = !isSelected
         selectionButton.isSelected = isSelected
-        if !_allowsMultipleSelection {
+        if !allowsMultipleSelection {
             selectionButton.allowsMultipleSelection = false
         }
         if animated {
-            UIView.animate(withDuration: 0.15) {
+            UIView.animate(withDuration: 0.2) {
                 self.updateLayoutForSelectionStateChange()
             } completion: { _ in
                 self.didUpdateLayoutForSelectionStateChange()
@@ -164,22 +143,21 @@ class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
     }
 
     private func updateLayoutForSelectionStateChange() {
-        if contentView.subviews.isEmpty {
-            return
-        }
-        if _allowsMultipleSelection {
+        guard !contentView.subviews.isEmpty else { return }
+
+        if allowsMultipleSelection {
             NSLayoutConstraint.deactivate([constraintWithoutSelectionButton])
             NSLayoutConstraint.activate([constraintWithSelectionButton])
         } else {
             NSLayoutConstraint.deactivate([constraintWithSelectionButton])
             NSLayoutConstraint.activate([constraintWithoutSelectionButton])
         }
-        self.layoutIfNeeded()
+        layoutIfNeeded()
     }
 
     private func didUpdateLayoutForSelectionStateChange() {
-        if _allowsMultipleSelection {
-            self.selectionButton.allowsMultipleSelection = true
+        if allowsMultipleSelection {
+            selectionButton.allowsMultipleSelection = true
         }
     }
 
@@ -187,7 +165,7 @@ class MediaTileListModeCell: UICollectionViewCell, MediaTileCell {
         owsFail("Subclass must override")
     }
 
-    func configure(item: AllMediaItem, spoilerReveal: SpoilerRevealState) {
+    func configure(item: MediaGalleryCellItem, spoilerReveal: SpoilerRevealState) {
         self.item = item
     }
 
diff --git a/Signal/src/ViewControllers/MediaGallery/Cells/WidePhotoCell.swift b/Signal/src/ViewControllers/MediaGallery/Cells/WidePhotoCell.swift
index d6a66cf6e02..91bf8d7068c 100644
--- a/Signal/src/ViewControllers/MediaGallery/Cells/WidePhotoCell.swift
+++ b/Signal/src/ViewControllers/MediaGallery/Cells/WidePhotoCell.swift
@@ -8,26 +8,30 @@ import SignalUI
 
 /// This is the collection view cell for "list mode" in All Media.
 class WidePhotoCell: MediaTileListModeCell {
+
     static let reuseIdentifier = "WidePhotoCell"
 
-    private let imageView: UIImageView = {
-        let imageView = UIImageView()
-        imageView.translatesAutoresizingMaskIntoConstraints = false
-        imageView.contentMode = .scaleAspectFit
-        return imageView
+    private let thumbnailView: ThumbnailView = {
+        let thumbnailView = ThumbnailView()
+        thumbnailView.autoSetDimensions(to: .square(48))
+        return thumbnailView
     }()
 
-    /// Wraps two text views. It shows "Filename * Sender Name".
-    private let filenameSenderView: FilenameSenderView = {
-        let view = FilenameSenderView(frame: .zero)
-        view.translatesAutoresizingMaskIntoConstraints = false
-        return view
+    private let titleLabel: UILabel = {
+        let label = UILabel()
+        label.font = .dynamicTypeSubheadlineClamped
+        label.adjustsFontForContentSizeCategory = true
+        label.setCompressionResistanceVerticalHigh()
+        label.textColor = UIColor(dynamicProvider: { _ in Theme.primaryTextColor })
+        return label
     }()
 
     private let subtitleLabel: UILabel = {
         let label = UILabel()
-        label.translatesAutoresizingMaskIntoConstraints = false
-        label.textColor = .secondaryLabel
+        label.font = .dynamicTypeFootnoteClamped
+        label.adjustsFontForContentSizeCategory = true
+        label.setCompressionResistanceVerticalHigh()
+        label.textColor = UIColor(dynamicProvider: { _ in Theme.secondaryTextAndIconColor })
         return label
     }()
 
@@ -41,32 +45,23 @@ class WidePhotoCell: MediaTileListModeCell {
     }
 
     private func setupViews() {
-        willSetupViews()
-
-        contentView.addSubview(imageView)
-        contentView.addSubview(filenameSenderView)
-        contentView.addSubview(subtitleLabel)
-
-        NSLayoutConstraint.activate([
-            imageView.topAnchor.constraint(equalTo: contentView.topAnchor, constant: 8),
-            imageView.bottomAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -8),
-            imageView.widthAnchor.constraint(equalToConstant: 48),
-            imageView.heightAnchor.constraint(greaterThanOrEqualToConstant: 48),
-
-            filenameSenderView.topAnchor.constraint(equalTo: contentView.topAnchor, constant: 13),
-            filenameSenderView.leadingAnchor.constraint(equalTo: imageView.trailingAnchor, constant: 19),
-            filenameSenderView.trailingAnchor.constraint(equalTo: contentView.trailingAnchor, constant: -16),
+        let vStack = UIStackView(arrangedSubviews: [ titleLabel, subtitleLabel ])
+        vStack.alignment = .leading
+        vStack.axis = .vertical
+        vStack.spacing = 2
 
-            subtitleLabel.topAnchor.constraint(equalTo: filenameSenderView.bottomAnchor),
-            subtitleLabel.leadingAnchor.constraint(equalTo: filenameSenderView.leadingAnchor),
-            subtitleLabel.trailingAnchor.constraint(equalTo: contentView.trailingAnchor, constant: -16),
-            subtitleLabel.bottomAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -13),
+        let hStack = UIStackView(arrangedSubviews: [ thumbnailView, vStack ])
+        hStack.alignment = .center
+        hStack.axis = .horizontal
+        hStack.spacing = 12
 
-            separator.leadingAnchor.constraint(equalTo: filenameSenderView.leadingAnchor)
-        ])
+        contentView.addSubview(hStack)
+        hStack.autoPinHeightToSuperview(withMargin: 8)
+        hStack.autoPinTrailingToSuperviewMargin()
+        let constraintWithSelectionButton = hStack.leadingAnchor.constraint(equalTo: selectionButton.trailingAnchor, constant: 16)
+        let constraintWithoutSelectionButton = hStack.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16)
 
-        let constraintWithSelectionButton = imageView.leadingAnchor.constraint(equalTo: selectionButton.trailingAnchor, constant: 13)
-        let constraintWithoutSelectionButton = imageView.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16)
+        separator.autoPinEdge(.leading, to: .leading, of: vStack)
 
         super.setupViews(constraintWithSelectionButton: constraintWithSelectionButton,
                          constraintWithoutSelectionButton: constraintWithoutSelectionButton)
@@ -75,80 +70,63 @@ class WidePhotoCell: MediaTileListModeCell {
     override public func prepareForReuse() {
         super.prepareForReuse()
 
-        imageView.image = nil
+        thumbnailView.image = nil
     }
 
     private func setUpAccessibility(item: PhotoGridItem?) {
-        self.isAccessibilityElement = true
+        isAccessibilityElement = true
 
         if let item {
-            self.accessibilityLabel = [
+            accessibilityLabel = [
                 item.type.localizedString,
                 MediaTileDateFormatter.formattedDateString(for: item.mediaMetadata?.creationDate)
             ]
                 .compactMap { $0 }
                 .joined(separator: ", ")
         } else {
-            self.accessibilityLabel = ""
+            accessibilityLabel = ""
         }
     }
 
     override public func makePlaceholder() {
-        imageView.image = nil
+        thumbnailView.image = nil
         setUpAccessibility(item: nil)
     }
 
-    override public func configure(item allMediaItem: AllMediaItem, spoilerReveal: SpoilerRevealState) {
-        switch allMediaItem {
-        case .graphic(let photoGridItem):
-            super.configure(item: .graphic(photoGridItem), spoilerReveal: spoilerReveal)
-            reallyConfigure(photoGridItem)
+    override public func configure(item: MediaGalleryCellItem, spoilerReveal: SpoilerRevealState) {
+        switch item {
+        case .photoVideo(let photoGridItem):
+            super.configure(item: item, spoilerReveal: spoilerReveal)
+            configure(photoGridItem)
         default:
-            owsFail("Unexpected item type \(allMediaItem)")
+            owsFail("Unexpected item type \(item)")
         }
     }
 
     private var photoGridItem: PhotoGridItem? {
-        switch item {
-        case .graphic(let result):
-            return result
-        case .none:
-            return nil
-        default:
-            return nil
-        }
+        guard case .photoVideo(let photoGridItem) = item else { return nil }
+        return photoGridItem
     }
 
-    private func reallyConfigure(_ item: PhotoGridItem) {
+    private func configure(_ item: PhotoGridItem) {
         // PHCachingImageManager returns multiple progressively better
         // thumbnails in the async block. We want to avoid calling
         // `configure(item:)` multiple times because the high-quality image eventually applied
         // last time it was called will be momentarily replaced by a progression of lower
         // quality images.
-        imageView.image = item.asyncThumbnail { [weak self] image in
+        thumbnailView.image = item.asyncThumbnail { [weak self] image in
             guard let self else { return }
 
-            guard let currentItem = self.photoGridItem else {
-                return
-            }
-
-            guard currentItem === item else {
-                return
-            }
+            guard let currentItem = self.photoGridItem, currentItem === item else { return }
 
             if image == nil {
                 Logger.debug("image == nil")
             }
-            self.imageView.image = image
+            self.thumbnailView.image = image
         }
 
         if let metadata = item.mediaMetadata {
-            filenameSenderView.filename = metadata.filename
-            if filenameSenderView.filename == nil {
-                filenameSenderView.senderName = metadata.sender
-            } else {
-                filenameSenderView.senderName = metadata.abbreviatedSender
-            }
+            titleLabel.text = metadata.sender
 
             if let date = metadata.formattedDate {
                 subtitleLabel.text = "\(metadata.formattedSize) 路 \(item.type.formattedType) 路 \(date)"
@@ -156,32 +134,86 @@ class WidePhotoCell: MediaTileListModeCell {
                 subtitleLabel.text = "\(metadata.formattedSize) 路 \(item.type.formattedType)"
             }
         } else {
-            filenameSenderView.filename = nil
-            filenameSenderView.senderName = nil
+            titleLabel.text = ""
             subtitleLabel.text = ""
         }
         setUpAccessibility(item: item)
     }
 
-    override func mediaPresentationContext(collectionView: UICollectionView,
-                                           in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
-        guard let mediaSuperview = imageView.superview else {
-            owsFailDebug("mediaSuperview was unexpectedly nil")
-            return nil
-        }
+    class func cellHeight() -> CGFloat {
+        let measurementCell = WidePhotoCell(frame: CGRect(origin: .zero, size: .square(100)))
+        measurementCell.titleLabel.text = "M"
+        measurementCell.subtitleLabel.text = "M"
+        let cellSize = measurementCell.contentView.systemLayoutSizeFitting(layoutFittingCompressedSize)
+        return cellSize.height
+    }
 
-        let presentationFrame = coordinateSpace.convert(imageView.frame, from: mediaSuperview)
+    override func mediaPresentationContext(collectionView: UICollectionView, in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
+
+        let presentationFrame = coordinateSpace.convert(thumbnailView.imageView.frame, from: thumbnailView)
         let clippingAreaInsets = UIEdgeInsets(top: collectionView.adjustedContentInset.top, leading: 0, bottom: 0, trailing: 0)
 
         return MediaPresentationContext(
-            mediaView: imageView,
+            mediaView: thumbnailView.imageView,
             presentationFrame: presentationFrame,
             clippingAreaInsets: clippingAreaInsets
         )
     }
+
+    private class ThumbnailView: UIView {
+
+        let imageView: UIImageView = {
+            let imageView = UIImageView()
+            imageView.translatesAutoresizingMaskIntoConstraints = false
+            imageView.contentMode = .scaleAspectFit
+            imageView.layer.masksToBounds = true
+            imageView.layer.cornerRadius = 4
+            return imageView
+        }()
+
+        var image: UIImage? {
+            get { imageView.image }
+            set {
+                imageView.image = newValue
+                setNeedsLayout()
+            }
+        }
+
+        override init(frame: CGRect) {
+            super.init(frame: frame)
+            addSubview(imageView)
+        }
+
+        required init?(coder: NSCoder) {
+            fatalError("init(coder:) has not been implemented")
+        }
+
+        override func layoutSubviews() {
+            super.layoutSubviews()
+
+            guard bounds.size.isNonEmpty else { return }
+
+            guard let imageSize = imageView.image?.size else {
+                imageView.frame = bounds
+                return
+            }
+
+            let scaleX = bounds.width / imageSize.width
+            let scaleY = bounds.height / imageSize.height
+            let scale = min(scaleX, scaleY)
+            let thumbnailSize = imageSize * scale
+            imageView.frame = CGRect(
+                x: 0.5 * (bounds.width - thumbnailSize.width),
+                y: 0.5 * (bounds.height - thumbnailSize.height),
+                width: thumbnailSize.width,
+                height: thumbnailSize.height
+            )
+        }
+    }
 }
 
-extension MediaMetadata {
+private extension MediaMetadata {
+
     var formattedSize: String {
         let byteCount = Int64(byteSize)
         let formatter = ByteCountFormatter()
@@ -201,130 +233,3 @@ extension MediaMetadata {
         return dateFormatter.string(from: creationDate)
     }
 }
-
-class FilenameSenderView: UIView {
-    var filename: String? {
-        didSet {
-            filenameLabel.text = filename ?? ""
-            updateLabelsVisibility()
-        }
-    }
-
-    var senderName: String? {
-        didSet {
-            senderNameLabel.text = senderName ?? ""
-            updateLabelsVisibility()
-        }
-    }
-
-    private let filenameLabel: UILabel = {
-        let label = UILabel()
-        label.translatesAutoresizingMaskIntoConstraints = false
-        label.textColor = Theme.primaryTextColor
-        return label
-    }()
-
-    private let middleDotLabel: UILabel = {
-        let label = UILabel()
-        label.translatesAutoresizingMaskIntoConstraints = false
-        label.text = " 路 "
-        label.textColor = Theme.primaryTextColor
-        return label
-    }()
-
-    private let senderNameLabel: UILabel = {
-        let label = UILabel()
-        label.translatesAutoresizingMaskIntoConstraints = false
-        label.textColor = Theme.primaryTextColor
-        return label
-    }()
-
-    override init(frame: CGRect) {
-        super.init(frame: frame)
-
-        setupLabels()
-        setupConstraints()
-        updateLabelsVisibility()
-
-        NotificationCenter.default.addObserver(self,
-                                               selector: #selector(themeDidChange),
-                                               name: .themeDidChange,
-                                               object: nil)
-    }
-
-    required init?(coder: NSCoder) {
-        fatalError("init(coder:) has not been implemented")
-    }
-
-    private func setupLabels() {
-        addSubview(filenameLabel)
-        addSubview(middleDotLabel)
-        addSubview(senderNameLabel)
-    }
-
-    private lazy var senderLabelToMiddleDotLeadingConstraint: NSLayoutConstraint = {
-        senderNameLabel.leadingAnchor.constraint(equalTo: middleDotLabel.trailingAnchor)
-    }()
-    private lazy var senderLabelToSuperviewLeadingConstraint: NSLayoutConstraint = {
-        senderNameLabel.leadingAnchor.constraint(equalTo: self.leadingAnchor)
-    }()
-
-    private func setupConstraints() {
-        NSLayoutConstraint.activate([
-            filenameLabel.leadingAnchor.constraint(equalTo: self.leadingAnchor),
-            filenameLabel.topAnchor.constraint(equalTo: self.topAnchor),
-            filenameLabel.bottomAnchor.constraint(equalTo: self.bottomAnchor),
-
-            middleDotLabel.leadingAnchor.constraint(equalTo: filenameLabel.trailingAnchor),
-            middleDotLabel.topAnchor.constraint(equalTo: self.topAnchor),
-            middleDotLabel.bottomAnchor.constraint(equalTo: self.bottomAnchor),
-
-            senderNameLabel.topAnchor.constraint(equalTo: self.topAnchor),
-            senderNameLabel.bottomAnchor.constraint(equalTo: self.bottomAnchor),
-            senderNameLabel.trailingAnchor.constraint(equalTo: self.trailingAnchor)
-        ])
-
-        middleDotLabel.setContentHuggingHorizontalHigh()
-        filenameLabel.setContentCompressionResistancePriority(.defaultLow, for: .horizontal)
-    }
-
-    private func updateLabelsVisibility() {
-        if senderName == nil && filename == nil {
-            // Have nothing to show
-            middleDotLabel.isHidden = true
-            senderNameLabel.isHidden = true
-            filenameLabel.isHidden = true
-        } else if senderName != nil && filename != nil {
-            // Have both
-            senderNameLabel.isHidden = false
-            middleDotLabel.isHidden = false
-            filenameLabel.isHidden = false
-
-            NSLayoutConstraint.deactivate([
-                senderLabelToSuperviewLeadingConstraint
-            ])
-            NSLayoutConstraint.activate([
-                senderLabelToMiddleDotLeadingConstraint
-            ])
-        } else {
-            // Show only the sender name. You'd get here if there was a filename but no sender name, but that isn't supported.
-            senderNameLabel.isHidden = false
-            middleDotLabel.isHidden = true
-            filenameLabel.isHidden = true
-
-            NSLayoutConstraint.deactivate([
-                senderLabelToMiddleDotLeadingConstraint
-            ])
-            NSLayoutConstraint.activate([
-                senderLabelToSuperviewLeadingConstraint
-            ])
-        }
-    }
-
-    @objc
-    private func themeDidChange() {
-        filenameLabel.textColor = Theme.primaryTextColor
-        middleDotLabel.textColor = Theme.primaryTextColor
-        senderNameLabel.textColor = Theme.primaryTextColor
-    }
-}
diff --git a/Signal/src/ViewControllers/MediaGallery/MediaGalleryAccessoriesHelper.swift b/Signal/src/ViewControllers/MediaGallery/MediaGalleryAccessoriesHelper.swift
index 22e40cabbcd..b7416d32716 100644
--- a/Signal/src/ViewControllers/MediaGallery/MediaGalleryAccessoriesHelper.swift
+++ b/Signal/src/ViewControllers/MediaGallery/MediaGalleryAccessoriesHelper.swift
@@ -9,7 +9,7 @@ import SignalUI
 fileprivate extension AllMediaFileType {
     var titleString: String {
         switch self {
-        case .media:
+        case .photoVideo:
             return OWSLocalizedString("ALL_MEDIA_FILE_TYPE_MEDIA",
                                       comment: "Media (i.e., graphical) file type in All Meda file type picker.")
         case .audio:
@@ -31,10 +31,10 @@ protocol MediaGalleryPrimaryViewController: UIViewController {
     func deleteSelectedItems()
     func shareSelectedItems(_ sender: Any)
     var fileType: AllMediaFileType { get }
-    func set(fileType: AllMediaFileType, grid: Bool)
+    func set(fileType: AllMediaFileType, isGridLayout: Bool)
 }
 
-public class MediaGalleryAccessoriesHelper: NSObject {
+public class MediaGalleryAccessoriesHelper {
     private var footerBarBottomConstraint: NSLayoutConstraint?
     weak var viewController: MediaGalleryPrimaryViewController?
 
@@ -65,72 +65,56 @@ public class MediaGalleryAccessoriesHelper: NSObject {
             _mode
         }
         set {
-            if newValue == _mode {
-                return
-            }
+            guard newValue != _mode else { return }
             _mode = newValue
             updateModeButton()
-            guard let viewController else {
-                return
-            }
-            guard #available(iOS 13, *) else {
-                return
-            }
+            guard let viewController else { return }
+
             switch mode {
             case .list:
-                viewController.set(fileType: viewController.fileType, grid: false)
+                viewController.set(fileType: viewController.fileType, isGridLayout: false)
             case .grid:
-                viewController.set(fileType: viewController.fileType, grid: true)
+                viewController.set(fileType: viewController.fileType, isGridLayout: true)
             }
         }
     }
 
-    private func updateModeButton() {
-        modeButton = createModeButton()
-        reloadFooter()
-    }
-
-    private let headerView: UISegmentedControl? = {
-        if #available(iOS 13, *) {
-            let items = [
-                AllMediaFileType.media,
-                AllMediaFileType.audio
-            ].map { $0.titleString }
-            let segmentedControl = UISegmentedControl(items: items)
-            segmentedControl.selectedSegmentTintColor = .init(dynamicProvider: { _ in
-                Theme.isDarkThemeEnabled ? UIColor.init(rgbHex: 0x636366) : .white
-            })
-            segmentedControl.backgroundColor = .clear
-            segmentedControl.selectedSegmentIndex = 0
-            return segmentedControl
-        }
-        return nil
+    private lazy var headerView: UISegmentedControl = {
+        let items = [
+            AllMediaFileType.photoVideo,
+            AllMediaFileType.audio
+        ].map { $0.titleString }
+        let segmentedControl = UISegmentedControl(items: items)
+        segmentedControl.selectedSegmentTintColor = .init(dynamicProvider: { _ in
+            Theme.isDarkThemeEnabled ? UIColor.init(rgbHex: 0x636366) : .white
+        })
+        segmentedControl.backgroundColor = .clear
+        segmentedControl.selectedSegmentIndex = 0
+        segmentedControl.addTarget(self, action: #selector(segmentedControlValueChanged), for: .valueChanged)
+        return segmentedControl
     }()
 
-    override init() {
-        super.init()
-
-        if #available(iOS 13, *) {
-            if let view = headerView {
-                view.addTarget(self,
-                               action: #selector(segmentedControlValueChanged(_:)),
-                               for: .valueChanged)
-            }
-        }
+    init() {
+        NotificationCenter.default.addObserver(
+            self,
+            selector: #selector(contentSizeCategoryDidChange),
+            name: UIContentSizeCategory.didChangeNotification,
+            object: nil
+        )
     }
 
     func installViews() {
         guard let viewController else { return }
 
+        headerView.sizeToFit()
+        var frame = headerView.frame
+        frame.size.width += CGFloat(AllMediaFileType.allCases.count) * 20.0
+        headerView.frame = frame
+        viewController.navigationItem.titleView = headerView
+
         viewController.view.addSubview(footerBar)
-        if let headerView {
-            headerView.sizeToFit()
-            var frame = headerView.frame
-            frame.size.width += CGFloat(AllMediaFileType.allCases.count) * 20.0
-            headerView.frame = frame
-            viewController.navigationItem.titleView = headerView
-        }
         footerBar.autoPinWidthToSuperview()
+
         updateDeleteButton()
         updateSelectButton()
     }
@@ -142,6 +126,11 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         shareButton.tintColor = Theme.primaryIconColor
     }
 
+    @objc
+    private func contentSizeCategoryDidChange(_ notification: Notification) {
+        updateModeButton()
+    }
+
     // MARK: - Menu Actions
 
     struct MenuAction {
@@ -195,8 +184,7 @@ public class MediaGalleryAccessoriesHelper: NSObject {
             viewController.navigationItem.rightBarButtonItem = UIBarButtonItem(
                 barButtonSystemItem: .cancel,
                 target: self,
-                action: #selector(didCancelSelect),
-                accessibilityIdentifier: UIView.accessibilityIdentifier(in: self, name: "cancel_select_button")
+                action: #selector(didCancelSelect)
             )
         } else {
             viewController.navigationItem.rightBarButtonItem = UIBarButtonItem(
@@ -205,8 +193,7 @@ public class MediaGalleryAccessoriesHelper: NSObject {
                     comment: "Button text to enable batch selection mode"),
                 style: .plain,
                 target: self,
-                action: #selector(didTapSelect),
-                accessibilityIdentifier: UIView.accessibilityIdentifier(in: self, name: "select_button")
+                action: #selector(didTapSelect)
             )
         }
     }
@@ -221,8 +208,8 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         footerBarState = viewController.isFiltering ? .selectionFiltering : .selection
 
         // Disabled until at least one item is selected.
-        self.deleteButton.isEnabled = false
-        self.shareButton.isEnabled = false
+        deleteButton.isEnabled = false
+        shareButton.isEnabled = false
 
         // Don't allow the user to leave mid-selection, so they realized they have
         // to cancel (lose) their selection if they leave.
@@ -304,23 +291,21 @@ public class MediaGalleryAccessoriesHelper: NSObject {
 
     // MARK: - List/Grid
 
-    private lazy var listMenuAction = {
-        MenuAction(
-            title: Mode.list.titleString,
-            icon: UIImage(named: "list-bullet-light"),
-            handler: { [weak self] in
-                self?.mode = .list
-            })
-    }()
+    private lazy var listMenuAction = MenuAction(
+        title: Mode.list.titleString,
+        icon: UIImage(named: "list-bullet-light"),
+        handler: { [weak self] in
+            self?.mode = .list
+        }
+    )
 
-    private lazy var gridMenuAction = {
-        MenuAction(
-            title: Mode.grid.titleString,
-            icon: UIImage(named: "grid-square-light"),
-            handler: { [weak self] in
-                self?.mode = .grid
-            })
-    }()
+    private lazy var gridMenuAction = MenuAction(
+        title: Mode.grid.titleString,
+        icon: UIImage(named: "grid-square-light"),
+        handler: { [weak self] in
+            self?.mode = .grid
+        }
+    )
 
     private var modeMenuActions: [MenuAction] {
         return [
@@ -329,50 +314,8 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         ]
     }
 
-    private var currentModeString: String {
-        return mode.titleString
-    }
-
-    func createButtonWithImageAndText(image: UIImage, text: String) -> UIButton {
-        let button = UIButton(type: .custom)
-        button.setTitle(text, for: .normal)
-        button.setTitleColor(.label, for: .normal)
-        button.setImage(image, for: .normal)
-        button.imageView?.contentMode = .scaleAspectFit
-        let languageDirection = UIApplication.shared.userInterfaceLayoutDirection
-        let insetBeforeImage = 16.0
-        let insetAfterImage = 8.0
-        let insetBeforeTitle = 8.0
-        switch languageDirection {
-        case .leftToRight:
-            button.semanticContentAttribute = .forceRightToLeft
-            button.imageEdgeInsets = UIEdgeInsets(top: 0, left: insetBeforeImage, bottom: 0, right: insetAfterImage)
-            button.titleEdgeInsets = UIEdgeInsets(top: 0, left: insetBeforeTitle, bottom: 0, right: 0)
-        case .rightToLeft:
-            button.semanticContentAttribute = .forceLeftToRight
-            button.imageEdgeInsets = UIEdgeInsets(top: 0, left: insetAfterImage, bottom: 0, right: insetBeforeImage)
-            button.titleEdgeInsets = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: insetBeforeTitle)
-        @unknown default:
-            owsFailDebug("Unexpected language direction")
-            button.semanticContentAttribute = .forceRightToLeft
-            button.imageEdgeInsets = UIEdgeInsets(top: 0, left: insetBeforeImage, bottom: 0, right: insetAfterImage)
-            button.titleEdgeInsets = UIEdgeInsets(top: 0, left: insetBeforeTitle, bottom: 0, right: 0)
-        }
-
-        button.sizeToFit()
-        var frame = button.frame
-        frame.size.width += insetBeforeImage + insetAfterImage + insetBeforeTitle
-        button.frame = frame
-
-        return button
-    }
-
-    private func createLegacyModeButton() -> UIBarButtonItem {
-        let menuButton = createButtonWithImageAndText(image: UIImage(systemName: "chevron.down")!,
-                                                      text: currentModeString)
-        menuButton.addTarget(self, action: #selector(showModeMenu(_:)), for: .touchUpInside)
-
-        return UIBarButtonItem(customView: menuButton)
+    private var currentModeButtonTitle: NSAttributedString {
+        return NSAttributedString(string: mode.titleString, attributes: [ .font: UIFont.dynamicTypeHeadlineClamped ])
     }
 
     private func createModeMenu() -> UIMenu {
@@ -387,26 +330,42 @@ public class MediaGalleryAccessoriesHelper: NSObject {
                       children: modeMenuActions.map { $0.uiAction })
     }
 
-    @available(iOS 14, *)
-    private func createModernModeButton() -> UIBarButtonItem {
-        let button = createButtonWithImageAndText(image: UIImage(systemName: "chevron.down")!, text: currentModeString)
-        button.contentHorizontalAlignment = .left
-        button.menu = createModeMenu()
-        button.showsMenuAsPrimaryAction = true
-        let barButtonItem = UIBarButtonItem(customView: button)
-
-        return barButtonItem
-    }
+    private lazy var modeButton: UIBarButtonItem = {
+        let chevronImage = UIImage(imageLiteralResourceName: "chevron-down-compact-bold")
+        let button: UIButton
 
-    lazy var modeButton: UIBarButtonItem? = {
-        createModeButton()
+        if #available(iOS 15, *) {
+            var configuration = UIButton.Configuration.plain()
+            configuration.imagePlacement = .trailing
+            configuration.image = chevronImage
+            configuration.imagePadding = 4
+            configuration.attributedTitle = AttributedString(currentModeButtonTitle)
+
+            button = UIButton(configuration: configuration, primaryAction: nil)
+            button.menu = createModeMenu()
+            button.showsMenuAsPrimaryAction = true
+        } else {
+            button = UIButton(type: .system)
+            button.setAttributedTitle(currentModeButtonTitle, for: .normal)
+            button.titleLabel?.adjustsFontForContentSizeCategory = true
+            button.setImage(chevronImage, for: .normal)
+            button.setPaddingBetweenImageAndText(to: 4, isRightToLeft: !CurrentAppContext().isRTL)
+            button.semanticContentAttribute = CurrentAppContext().isRTL ? .forceLeftToRight : .forceRightToLeft
+            if #available(iOS 14, *) {
+                button.menu = createModeMenu()
+                button.showsMenuAsPrimaryAction = true
+            } else {
+                button.addTarget(self, action: #selector(showModeMenu(_:)), for: .touchUpInside)
+            }
+        }
+        return UIBarButtonItem(customView: button)
     }()
 
-    private func createModeButton() -> UIBarButtonItem {
-        if #available(iOS 14, *) {
-            return createModernModeButton()
+    private func updateModeButton() {
+        if let button = modeButton.customView as? UIButton {
+            button.setAttributedTitle(currentModeButtonTitle, for: .normal)
+            button.sizeToFit()
         }
-        return createLegacyModeButton()
     }
 
     @objc
@@ -455,18 +414,15 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         }
     }
 
-    private var gridViewAllowed: Bool {
-        guard #available(iOS 13, *) else {
-            return AllMediaFileType.defaultValue.supportsGridView
-        }
+    private var isGridViewAllowed: Bool {
         return fileType.supportsGridView
     }
 
     private var currentFileTypeSupportsFiltering: Bool {
-        switch AllMediaFileType(rawValue: headerView?.selectedSegmentIndex ?? 0) {
+        switch AllMediaFileType(rawValue: headerView.selectedSegmentIndex) {
         case .audio:
             return false
-        case .media:
+        case .photoVideo:
             return true
         case .none:
             return false
@@ -474,49 +430,38 @@ public class MediaGalleryAccessoriesHelper: NSObject {
     }
 
     private func reloadFooter() {
-        switch footerBarState {
-        case .hidden:
-            break
-        case .selection, .selectionFiltering:
-            let footerItems = [
-                shareButton,
-                UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
-                deleteButton
-            ]
-            footerBar.setItems(footerItems, animated: false)
-        case .regular:
-            if let modeButton, gridViewAllowed {
-                let footerItems = [
-                    currentFileTypeSupportsFiltering ? filterButton : UIBarButtonItem(barButtonSystemItem: .fixedSpace, target: nil, action: nil),
-                    UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
-                    modeButton,
-                    UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
-                    deleteButton
-                ]
-                footerBar.setItems(footerItems, animated: false)
-            } else {
-                let footerItems = [
-                    currentFileTypeSupportsFiltering ? filterButton : UIBarButtonItem(barButtonSystemItem: .fixedSpace, target: nil, action: nil),
-                    UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
-                    deleteButton
-                ]
-                footerBar.setItems(footerItems, animated: false)
+        guard footerBarState != .hidden else { return }
+
+        let fixedSpace = { return UIBarButtonItem(barButtonSystemItem: .fixedSpace, target: nil, action: nil) }
+        let flexibleSpace = { return UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil) }
+        let footerBarItems: [UIBarButtonItem]? = {
+            switch footerBarState {
+            case .hidden:
+                return nil
+            case .selection, .selectionFiltering:
+                return [ shareButton, flexibleSpace(), deleteButton ]
+            case .regular:
+                if isGridViewAllowed {
+                    return [
+                        currentFileTypeSupportsFiltering ? filterButton : fixedSpace(),
+                        flexibleSpace(),
+                        modeButton,
+                        flexibleSpace()
+                    ]
+                } else {
+                    return currentFileTypeSupportsFiltering ? [ filterButton ] : nil
+                }
+            case .filtering:
+                return currentFileTypeSupportsFiltering ? [ selectedFilterButton ] : nil
             }
-        case .filtering:
-            let footerItems = [
-                currentFileTypeSupportsFiltering ? selectedFilterButton : UIBarButtonItem(barButtonSystemItem: .fixedSpace, target: nil, action: nil),
-                UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
-                deleteButton
-            ]
-            footerBar.setItems(footerItems, animated: false)
-        }
+        }()
+        footerBar.setItems(footerBarItems, animated: false)
     }
 
     // You must call this if you transition between having and not having items.
     func updateFooterBarState() {
-        guard let viewController else {
-            return
-        }
+        guard let viewController else { return }
+
         footerBarState = {
             if isInBatchSelectMode {
                 if viewController.isFiltering {
@@ -542,15 +487,15 @@ public class MediaGalleryAccessoriesHelper: NSObject {
 
     private func showToolbar(animated: Bool) {
         guard animated else {
-            _showToolbar()
+            showToolbar()
             return
         }
         UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseInOut) {
-            self._showToolbar()
+            self.showToolbar()
         }
     }
 
-    private func _showToolbar() {
+    private func showToolbar() {
         guard let viewController else { return }
 
         if let footerBarBottomConstraint {
@@ -568,15 +513,15 @@ public class MediaGalleryAccessoriesHelper: NSObject {
 
     private func hideToolbar(animated: Bool) {
         guard animated else {
-            _hideToolbar()
+            hideToolbar()
             return
         }
         UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseInOut) {
-            self._hideToolbar()
+            self.hideToolbar()
         }
     }
 
-    private func _hideToolbar() {
+    private func hideToolbar() {
         guard let viewController else { return }
 
         if let footerBarBottomConstraint {
@@ -597,27 +542,18 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         image: Theme.iconImage(.buttonDelete),
         style: .plain,
         target: self,
-        action: #selector(didPressDelete),
-        accessibilityIdentifier: UIView.accessibilityIdentifier(in: self, name: "delete_button")
+        action: #selector(didPressDelete)
     )
 
     private func updateDeleteButton() {
-        guard let viewController else {
-            return
-        }
-
-        self.deleteButton.isEnabled = viewController.hasSelection
+        guard let viewController else { return }
+        deleteButton.isEnabled = viewController.hasSelection
     }
 
     @objc
     private func didPressDelete(_ sender: Any) {
         Logger.debug("")
         viewController?.deleteSelectedItems()
-
-        guard let viewController else {
-            return
-        }
-        viewController.deleteSelectedItems()
     }
 
     // MARK: - Share
@@ -626,37 +562,27 @@ public class MediaGalleryAccessoriesHelper: NSObject {
         image: Theme.iconImage(.buttonShare),
         style: .plain,
         target: self,
-        action: #selector(didPressShare),
-        accessibilityIdentifier: UIView.accessibilityIdentifier(in: self, name: "share_button")
+        action: #selector(didPressShare)
     )
 
     private func updateShareButton() {
-        guard let viewController else {
-            return
-        }
+        guard let viewController else { return }
 
-        self.shareButton.isEnabled = viewController.hasSelection
+        shareButton.isEnabled = viewController.hasSelection
     }
 
     @objc
     private func didPressShare(_ sender: Any) {
         Logger.debug("")
-        guard let viewController else {
-            return
-        }
-        viewController.shareSelectedItems(sender)
+        viewController?.shareSelectedItems(sender)
     }
 
     private var fileType: AllMediaFileType {
-        guard let control = headerView else {
-            return .media
-        }
-        return AllMediaFileType(rawValue: control.selectedSegmentIndex) ?? .media
+        return AllMediaFileType(rawValue: headerView.selectedSegmentIndex) ?? .photoVideo
     }
 
     @objc
-    @available(iOS 13, *)
-    func segmentedControlValueChanged(_ sender: UISegmentedControl) {
+    private func segmentedControlValueChanged(_ sender: UISegmentedControl) {
         if let fileType = AllMediaFileType(rawValue: sender.selectedSegmentIndex) {
             if let previousFileType = viewController?.fileType {
                 savedModes[previousFileType] = mode
@@ -669,17 +595,17 @@ public class MediaGalleryAccessoriesHelper: NSObject {
                 _mode = .list
             }
             updateModeButton()
-            viewController?.set(fileType: fileType, grid: mode == .grid)
+            viewController?.set(fileType: fileType, isGridLayout: mode == .grid)
         }
     }
 }
 
 extension AllMediaFileType {
-    static var defaultValue = AllMediaFileType.media
+    static var defaultValue = AllMediaFileType.photoVideo
 
     var supportsGridView: Bool {
         switch self {
-        case .media:
+        case .photoVideo:
             return true
         case .audio:
             return false
diff --git a/Signal/src/ViewControllers/MediaGallery/MediaGalleryCellItem.swift b/Signal/src/ViewControllers/MediaGallery/MediaGalleryCellItem.swift
new file mode 100644
index 00000000000..f96bc2b688c
--- /dev/null
+++ b/Signal/src/ViewControllers/MediaGallery/MediaGalleryCellItem.swift
@@ -0,0 +1,128 @@
+//
+// Copyright 2023 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import SignalServiceKit
+import SignalUI
+
+protocol MediaGalleryCollectionViewCell: UICollectionViewCell {
+    var item: MediaGalleryCellItem? { get }
+    var allowsMultipleSelection: Bool { get }
+    func setAllowsMultipleSelection(_ allowed: Bool, animated: Bool)
+
+    func makePlaceholder()
+    func configure(item: MediaGalleryCellItem, spoilerReveal: SpoilerRevealState)
+    func mediaPresentationContext(collectionView: UICollectionView, in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext?
+    func indexPathDidChange(_ indexPath: IndexPath, itemCount: Int)
+}
+
+enum MediaGalleryCellItem {
+    case photoVideo(MediaGalleryCellItemPhotoVideo)
+    case audio(MediaGalleryCellItemAudio)
+
+    var attachmentStream: TSAttachmentStream? {
+        switch self {
+        case .photoVideo(let item):
+            return item.galleryItem.attachmentStream
+        case .audio(let audioItem):
+            return audioItem.attachmentStream
+        }
+    }
+}
+
+extension MediaGalleryCellItem: Equatable {
+    public static func == (lhs: MediaGalleryCellItem, rhs: MediaGalleryCellItem) -> Bool {
+        switch (lhs, rhs) {
+        case let (.photoVideo(lvalue), .photoVideo(rvalue)):
+            return lvalue === rvalue
+        case let (.audio(lvalue), .audio(rvalue)):
+            return lvalue.attachmentStream == rvalue.attachmentStream
+        case (.photoVideo, _), (.audio, _):
+            return false
+        }
+    }
+}
+
+struct MediaGalleryCellItemAudio {
+    var message: TSMessage
+    var interaction: TSInteraction
+    var thread: TSThread
+    var attachmentStream: TSAttachmentStream
+    var mediaCache: CVMediaCache
+    var metadata: MediaMetadata
+
+    var size: UInt {
+        UInt(attachmentStream.byteCount)
+    }
+    var date: Date {
+        attachmentStream.creationTimestamp
+    }
+    var duration: TimeInterval {
+        attachmentStream.audioDurationSeconds()
+    }
+
+    enum AttachmentType {
+        case file
+        case voiceMessage
+    }
+    var attachmentType: AttachmentType {
+        let isVoiceMessage = attachmentStream.isVoiceMessageIncludingLegacyMessages
+        return isVoiceMessage ? .voiceMessage : .file
+    }
+
+    var localizedString: String {
+        switch attachmentType {
+        case .file:
+            return "Audio file"  // ATTACHMENT_TYPE_AUDIO
+        case .voiceMessage:
+            return "Voice message"  // ATTACHMENT_TYPE_VOICE_MESSAGE
+        }
+    }
+}
+
+class MediaGalleryCellItemPhotoVideo: PhotoGridItem {
+    let galleryItem: MediaGalleryItem
+
+    init(galleryItem: MediaGalleryItem) {
+        self.galleryItem = galleryItem
+    }
+
+    var type: PhotoGridItemType {
+        if galleryItem.isVideo {
+            return .video(videoDurationPromise)
+        } else if galleryItem.isAnimated {
+            return .animated
+        } else {
+            return .photo
+        }
+    }
+
+    var isFavorite: Bool { false }
+
+    func asyncThumbnail(completion: @escaping (UIImage?) -> Void) -> UIImage? {
+        return galleryItem.thumbnailImage(async: completion)
+    }
+
+    private var videoDurationPromise: Promise<TimeInterval> {
+        owsAssert(galleryItem.isVideo)
+        return VideoDurationHelper.shared.promisedDuration(attachment: galleryItem.attachmentStream)
+    }
+    var mediaMetadata: MediaMetadata? {
+        return galleryItem.mediaMetadata
+    }
+}
+
+extension MediaGalleryItem {
+    var mediaMetadata: MediaMetadata? {
+        let filename = attachmentStream.originalFilePath.map {
+            ($0 as NSString).lastPathComponent as String
+        }
+        return MediaMetadata(
+            sender: sender?.name ?? "",
+            abbreviatedSender: sender?.abbreviatedName ?? "",
+            filename: filename,
+            byteSize: Int(attachmentStream.byteCount),
+            creationDate: attachmentStream.creationTimestamp)
+    }
+}
diff --git a/Signal/src/ViewControllers/MediaGallery/MediaPageViewController.swift b/Signal/src/ViewControllers/MediaGallery/MediaPageViewController.swift
index ca7e163deec..f2f9d4fb419 100644
--- a/Signal/src/ViewControllers/MediaGallery/MediaPageViewController.swift
+++ b/Signal/src/ViewControllers/MediaGallery/MediaPageViewController.swift
@@ -25,7 +25,7 @@ class MediaPageViewController: UIPageViewController {
     ) {
         self.init(
             initialMediaAttachment: initialMediaAttachment,
-            mediaGallery: MediaGallery(thread: thread, fileType: .media, spoilerReveal: spoilerReveal),
+            mediaGallery: MediaGallery(thread: thread, fileType: .photoVideo, spoilerReveal: spoilerReveal),
             spoilerReveal: spoilerReveal,
             showingSingleMessage: showingSingleMessage
         )
diff --git a/Signal/src/ViewControllers/MediaGallery/MediaTileViewController.swift b/Signal/src/ViewControllers/MediaGallery/MediaTileViewController.swift
index 85cc7c23c25..ae927069aa2 100644
--- a/Signal/src/ViewControllers/MediaGallery/MediaTileViewController.swift
+++ b/Signal/src/ViewControllers/MediaGallery/MediaTileViewController.swift
@@ -8,27 +8,14 @@ import SignalMessaging
 import SignalServiceKit
 import SignalUI
 
-fileprivate extension IndexSet {
-    func shifted(startingAt index: Int? = nil, by amount: Int) -> IndexSet {
-        var result = self
-        result.shift(startingAt: index ?? self.first ?? 0, by: amount)
-        return result
-    }
-}
-
-private extension IndexPath {
-    func shiftingSection(by delta: Int) -> IndexPath {
-        return IndexPath(item: item, section: section + delta)
-    }
-}
-
 extension MediaTileViewController: MediaGalleryCollectionViewUpdaterDelegate {
-    func indexSet(_ mediaGallerySectionIndexSet: MediaGallerySectionIndexSet) -> IndexSet {
+
+    private func indexSet(_ mediaGallerySectionIndexSet: MediaGallerySectionIndexSet) -> IndexSet {
         return mediaGallerySectionIndexSet.indexSet.shifted(by: 1)
     }
 
     func updaterDeleteSections(_ sections: MediaGallerySectionIndexSet) {
-        collectionView?.deleteSections(self.indexSet(sections))
+        collectionView?.deleteSections(indexSet(sections))
     }
 
     func updaterDeleteItems(at indexPaths: [MediaGalleryIndexPath]) {
@@ -38,7 +25,7 @@ extension MediaTileViewController: MediaGalleryCollectionViewUpdaterDelegate {
     }
 
     func updaterInsertSections(_ sections: MediaGallerySectionIndexSet) {
-        collectionView?.insertSections(self.indexSet(sections))
+        collectionView?.insertSections(indexSet(sections))
     }
 
     func updaterReloadItems(at indexPaths: [MediaGalleryIndexPath]) {
@@ -48,7 +35,7 @@ extension MediaTileViewController: MediaGalleryCollectionViewUpdaterDelegate {
     }
 
     func updaterReloadSections(_ sections: MediaGallerySectionIndexSet) {
-        collectionView?.reloadSections(self.indexSet(sections))
+        collectionView?.reloadSections(indexSet(sections))
     }
 
     func updaterDidFinish(numberOfSectionsBefore: Int, numberOfSectionsAfter: Int) {
@@ -66,9 +53,28 @@ extension MediaTileViewController: MediaGalleryCollectionViewUpdaterDelegate {
     }
 }
 
-public class MediaTileViewController: UICollectionViewController, MediaGalleryDelegate, UICollectionViewDelegateFlowLayout {
-    private typealias Cell = (UICollectionViewCell & MediaTileCell)
-    typealias Layout = UICollectionViewFlowLayout & ScrollPositionPreserving
+class MediaTileViewController: UICollectionViewController, MediaGalleryDelegate, UICollectionViewDelegateFlowLayout {
+
+    private typealias Cell = (UICollectionViewCell & MediaGalleryCollectionViewCell)
+    private typealias CollectionViewLayout = UICollectionViewFlowLayout & ScrollPositionPreserving
+    private enum Layout {
+        case list
+        case grid
+
+        func reuseIdentifier(fileType: AllMediaFileType) -> String {
+            switch fileType {
+            case .photoVideo:
+                switch self {
+                case .list:
+                    return WidePhotoCell.reuseIdentifier
+                case .grid:
+                    return MediaTileCollectionViewCell.reuseIdentifier
+                }
+            case .audio:
+                return AudioCell.reuseIdentifier
+            }
+        }
+    }
 
     private let thread: TSThread
     private let accessoriesHelper: MediaGalleryAccessoriesHelper
@@ -79,12 +85,13 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         mediaGallery.addDelegate(self)
         return mediaGallery
     }()
-    fileprivate var mediaTileViewLayout: Layout
+    private var currentCollectionViewLayout: CollectionViewLayout
     private var allCells = WeakArray<UICollectionViewCell>()
 
-    var fileType: AllMediaFileType = AllMediaFileType.defaultValue
+    internal var fileType: AllMediaFileType = AllMediaFileType.defaultValue
+    private var layout = Layout.grid
 
-    func set(fileType: AllMediaFileType, grid: Bool) {
+    func set(fileType: AllMediaFileType, isGridLayout: Bool) {
         UIView.performWithoutAnimation {
             let fileTypeChanged = self.fileType != fileType
             if fileTypeChanged {
@@ -93,11 +100,11 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
                 mediaGallery.addDelegate(self)
                 self.fileType = fileType
             }
-            let desiredMode: Mode = grid ? .grid : .list
-            let modeChanged = self.mode != desiredMode
+            let layout: Layout = isGridLayout ? .grid : .list
+            let layoutChanged = self.layout != layout
             var indexPath: IndexPath?
-            if modeChanged || fileTypeChanged {
-                self.mode = desiredMode
+            if layoutChanged || fileTypeChanged {
+                self.layout = layout
                 indexPath = oldestVisibleIndexPath
                 rebuildLayout()
             }
@@ -110,8 +117,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
                 collectionView.reloadData()
                 if mediaGallery.galleryDates.count > 0 {
                     let lastSectionItemCount = mediaGallery.numberOfItemsInSection(mediaGallery.galleryDates.count - 1)
-                    indexPath = IndexPath(item: lastSectionItemCount - 1,
-                                          section: mediaGallery.galleryDates.count)
+                    indexPath = IndexPath(item: lastSectionItemCount - 1, section: mediaGallery.galleryDates.count)
                 } else {
                     indexPath = nil
                 }
@@ -120,9 +126,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
             collectionView.layoutIfNeeded()
             if let indexPath {
                 if fileTypeChanged {
-                    self.collectionView.scrollToItem(at: indexPath,
-                                                     at: .bottom,
-                                                     animated: false)
+                    collectionView.scrollToItem(at: indexPath, at: .bottom, animated: false)
                 } else {
                     collectionView.scrollToItem(at: indexPath, at: .top, animated: false)
                 }
@@ -132,25 +136,6 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     /// This is used to avoid running two animations concurrently. It doesn't look good on iOS 16 (and probably all other versions).
     private var activeAnimationCount = 0
-    private enum Mode {
-        case list
-        case grid
-
-        func reuseIdentifier(fileType: AllMediaFileType) -> String {
-            switch fileType {
-            case .media:
-                switch self {
-                case .list:
-                    return WidePhotoCell.reuseIdentifier
-                case .grid:
-                    return PhotoGridViewCell.reuseIdentifier
-                }
-            case .audio:
-                return AudioCell.reuseIdentifier
-            }
-        }
-    }
-    private var mode = Mode.grid
 
     public init(
         thread: TSThread,
@@ -160,9 +145,8 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         self.thread = thread
         self.accessoriesHelper = accessoriesHelper
         self.spoilerReveal = spoilerReveal
-        let layout: Layout = Self.buildLayout(mode: mode, fileType: fileType)
-        self.mediaTileViewLayout = layout
-
+        let layout = Self.buildLayout(layout, fileType: fileType)
+        self.currentCollectionViewLayout = layout
         super.init(collectionViewLayout: layout)
     }
 
@@ -230,44 +214,46 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     // MARK: View Lifecycle Overrides
 
-    override public func loadView() {
-        collectionView = MediaTileCollectionView(frame: .zero, collectionViewLayout: collectionViewLayout)
+    override func loadView() {
+        collectionView = UICollectionView(frame: .zero, collectionViewLayout: collectionViewLayout)
     }
 
-    override public func viewDidLoad() {
+    override func viewDidLoad() {
         super.viewDidLoad()
 
-        self.title = MediaStrings.allMedia
+        title = MediaStrings.allMedia
 
-        guard let collectionView = self.collectionView else {
-            owsFailDebug("collectionView was unexpectedly nil")
-            return
-        }
-
-        collectionView.register(PhotoGridViewCell.self, forCellWithReuseIdentifier: PhotoGridViewCell.reuseIdentifier)
+        collectionView.register(MediaTileCollectionViewCell.self, forCellWithReuseIdentifier: MediaTileCollectionViewCell.reuseIdentifier)
         collectionView.register(WidePhotoCell.self, forCellWithReuseIdentifier: WidePhotoCell.reuseIdentifier)
         collectionView.register(AudioCell.self, forCellWithReuseIdentifier: AudioCell.reuseIdentifier)
-        collectionView.register(ThemeCollectionViewSectionHeader.self, forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader, withReuseIdentifier: ThemeCollectionViewSectionHeader.reuseIdentifier)
-        collectionView.register(MediaGalleryStaticHeader.self, forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader, withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier)
-
+        collectionView.register(
+            MediaGalleryDateHeader.self,
+            forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader,
+            withReuseIdentifier: MediaGalleryDateHeader.reuseIdentifier
+        )
+        collectionView.register(
+            MediaGalleryStaticHeader.self,
+            forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader,
+            withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier
+        )
         collectionView.delegate = self
+        collectionView.preservesSuperviewLayoutMargins = true
+        collectionView.backgroundColor = UIColor(dynamicProvider: { _ in Theme.tableView2PresentedBackgroundColor })
 
         accessoriesHelper.installViews()
 
-        self.mediaTileViewLayout.invalidateLayout()
-
-        applyTheme()
-
+        NotificationCenter.default.addObserver(self, selector: #selector(contentSizeCategoryDidChange), name: UIContentSizeCategory.didChangeNotification, object: nil)
         NotificationCenter.default.addObserver(self, selector: #selector(applyTheme), name: .themeDidChange, object: nil)
+        applyTheme()
     }
 
-    override public func viewWillAppear(_ animated: Bool) {
+    override func viewWillAppear(_ animated: Bool) {
         defer { super.viewWillAppear(animated) }
 
         // You must layout before mutating mediaGallery. Otherwise, MediaTileViewLayout.prepare() could be
         // called while processing an update. That will violate the exclusive access rules since it calls
         // (indirectly) into MediaGallerySections.
-        self.view.layoutIfNeeded()
+        view.layoutIfNeeded()
 
         if mediaGallery.galleryDates.isEmpty {
             _ = self.mediaGallery.loadEarlierSections(batchSize: kLoadBatchSize)
@@ -291,25 +277,29 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
             return false
         }
         let lastSectionItemCount = mediaGallery.numberOfItemsInSection(mediaGallery.galleryDates.count - 1)
-        self.collectionView.scrollToItem(at: IndexPath(item: lastSectionItemCount - 1,
-                                                       section: mediaGallery.galleryDates.count),
-                                         at: .bottom,
-                                         animated: false)
+        collectionView.scrollToItem(
+            at: IndexPath(item: lastSectionItemCount - 1, section: mediaGallery.galleryDates.count),
+            at: .bottom,
+            animated: false
+        )
     }
 
-    override public func viewDidDisappear(_ animated: Bool) {
+    override func viewDidDisappear(_ animated: Bool) {
+        super.viewDidDisappear(animated)
+
         cvAudioPlayer.shouldAutoplayNextAudioAttachment = nil
     }
 
-    override public func viewWillTransition(to size: CGSize,
-                                            with coordinator: UIViewControllerTransitionCoordinator) {
-        self.mediaTileViewLayout.invalidateLayout()
+    override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
         super.viewWillTransition(to: size, with: coordinator)
+        coordinator.animate { _ in
+            self.recalculateLayoutMetrics()
+        }
     }
 
-    public override func viewWillLayoutSubviews() {
-        super.viewWillLayoutSubviews()
-        self.updateLayout()
+    override func viewSafeAreaInsetsDidChange() {
+        super.viewSafeAreaInsetsDidChange()
+        recalculateLayoutMetrics()
     }
 
     // MARK: Theme
@@ -319,17 +309,27 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         accessoriesHelper.applyTheme()
     }
 
+    @objc
+    private func contentSizeCategoryDidChange() {
+        cachedDateHeaderHeight = nil
+        cachedLoadingDataHeaderHeight = nil
+        if layout == .list {
+            recalculateListLayoutMetrics()
+        }
+        currentCollectionViewLayout.invalidateLayout()
+    }
+
     // MARK: Orientation
 
-    override public var supportedInterfaceOrientations: UIInterfaceOrientationMask {
+    override var supportedInterfaceOrientations: UIInterfaceOrientationMask {
         return UIDevice.current.defaultSupportedOrientations
     }
 
     // MARK: - List View / Grid View
 
     private func rebuildLayout() {
-        mediaTileViewLayout = Self.buildLayout(mode: mode, fileType: fileType)
-        collectionView.setCollectionViewLayout(mediaTileViewLayout, animated: false)
+        currentCollectionViewLayout = Self.buildLayout(layout, fileType: fileType)
+        collectionView.setCollectionViewLayout(currentCollectionViewLayout, animated: false)
         collectionView.reloadData()
     }
 
@@ -347,28 +347,28 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     private var scrollingToTop = false
 
-    override public func scrollViewShouldScrollToTop(_ scrollView: UIScrollView) -> Bool {
+    override func scrollViewShouldScrollToTop(_ scrollView: UIScrollView) -> Bool {
         scrollingToTop = true
         return true
     }
 
-    override public func scrollViewDidScrollToTop(_ scrollView: UIScrollView) {
+    override func scrollViewDidScrollToTop(_ scrollView: UIScrollView) {
         scrollingToTop = false
         showOrHideScrollFlag()
     }
 
-    override public func scrollViewDidEndDragging(_ scrollView: UIScrollView, willDecelerate decelerate: Bool) {
+    override func scrollViewDidEndDragging(_ scrollView: UIScrollView, willDecelerate decelerate: Bool) {
         willDecelerate = decelerate
     }
 
-    override public func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
+    override func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
         willDecelerate = false
         showOrHideScrollFlag()
     }
 
     private var scrollFlagShouldBeVisible = false
 
-    override public func scrollViewDidScroll(_ scrollView: UIScrollView) {
+    override func scrollViewDidScroll(_ scrollView: UIScrollView) {
         self.autoLoadMoreIfNecessary()
         showOrHideScrollFlag()
         if scrollFlag.superview != nil {
@@ -507,9 +507,9 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         return center
     }
 
-    var previousAdjustedContentInset: UIEdgeInsets = UIEdgeInsets()
+    private var previousAdjustedContentInset: UIEdgeInsets = UIEdgeInsets()
 
-    override public func scrollViewDidChangeAdjustedContentInset(_ scrollView: UIScrollView) {
+    override func scrollViewDidChangeAdjustedContentInset(_ scrollView: UIScrollView) {
         defer { previousAdjustedContentInset = scrollView.adjustedContentInset }
         guard !mediaGallery.galleryDates.isEmpty else {
             return
@@ -527,7 +527,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         updateScrollFlag()
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, shouldSelectItemAt indexPath: IndexPath) -> Bool {
+    override func collectionView(_ collectionView: UICollectionView, shouldSelectItemAt indexPath: IndexPath) -> Bool {
 
         Logger.debug("")
 
@@ -543,7 +543,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         }
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, shouldDeselectItemAt indexPath: IndexPath) -> Bool {
+    override func collectionView(_ collectionView: UICollectionView, shouldDeselectItemAt indexPath: IndexPath) -> Bool {
 
         Logger.debug("")
 
@@ -559,7 +559,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         }
     }
 
-    public override func collectionView(_ collectionView: UICollectionView, shouldHighlightItemAt indexPath: IndexPath) -> Bool {
+    override func collectionView(_ collectionView: UICollectionView, shouldHighlightItemAt indexPath: IndexPath) -> Bool {
 
         Logger.debug("")
 
@@ -575,7 +575,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         }
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
+    override func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
         Logger.info("")
 
         guard let gridCell = self.collectionView(collectionView, cellForItemAt: indexPath) as? Cell else {
@@ -602,7 +602,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         }
     }
 
-    public override func collectionView(_ collectionView: UICollectionView, didDeselectItemAt indexPath: IndexPath) {
+    override func collectionView(_ collectionView: UICollectionView, didDeselectItemAt indexPath: IndexPath) {
         Logger.debug("")
 
         accessoriesHelper.didModifySelection()
@@ -610,7 +610,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     // MARK: UICollectionViewDataSource
 
-    override public func numberOfSections(in collectionView: UICollectionView) -> Int {
+    override func numberOfSections(in collectionView: UICollectionView) -> Int {
         Logger.debug("")
 
         let dates = mediaGallery.galleryDates
@@ -626,7 +626,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         return count + 2
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection sectionIdx: Int) -> Int {
+    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection sectionIdx: Int) -> Int {
         guard !mediaGallery.galleryDates.isEmpty else {
             // empty gallery
             return 0
@@ -646,19 +646,27 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         return count
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -> UICollectionReusableView {
+    override func collectionView(
+        _ collectionView: UICollectionView,
+        viewForSupplementaryElementOfKind kind: String,
+        at indexPath: IndexPath
+    ) -> UICollectionReusableView {
 
-        let defaultView = UICollectionReusableView()
+        let defaultView: (() -> UICollectionReusableView) = { UICollectionReusableView() }
 
         guard !mediaGallery.galleryDates.isEmpty else {
-            guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier, for: indexPath) as? MediaGalleryStaticHeader else {
-
+            guard
+                let sectionHeader = collectionView.dequeueReusableSupplementaryView(
+                    ofKind: kind,
+                    withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier,
+                    for: indexPath
+                ) as? MediaGalleryStaticHeader else {
                 owsFailDebug("unable to build section header for kLoadOlderSectionIdx")
-                return defaultView
+                return defaultView()
             }
             let title: String
             switch fileType {
-            case .media:
+            case .photoVideo:
                 title = OWSLocalizedString("GALLERY_TILES_EMPTY_GALLERY",
                                            comment: "Label indicating media gallery is empty")
             case .audio:
@@ -672,45 +680,55 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         if kind == UICollectionView.elementKindSectionHeader {
             switch indexPath.section {
             case kLoadOlderSectionIdx:
-                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier, for: indexPath) as? MediaGalleryStaticHeader else {
-
-                    owsFailDebug("unable to build section header for kLoadOlderSectionIdx")
-                    return defaultView
+                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(
+                    ofKind: kind,
+                    withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier,
+                    for: indexPath
+                ) as? MediaGalleryStaticHeader else {
+                    owsFailDebug("unable to build section header for \(indexPath)")
+                    return defaultView()
                 }
                 let title = OWSLocalizedString("GALLERY_TILES_LOADING_OLDER_LABEL", comment: "Label indicating loading is in progress")
                 sectionHeader.configure(title: title)
                 return sectionHeader
             case loadNewerSectionIdx:
-                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier, for: indexPath) as? MediaGalleryStaticHeader else {
-
-                    owsFailDebug("unable to build section header for kLoadOlderSectionIdx")
-                    return defaultView
+                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(
+                    ofKind: kind,
+                    withReuseIdentifier: MediaGalleryStaticHeader.reuseIdentifier,
+                    for: indexPath
+                ) as? MediaGalleryStaticHeader else {
+                    owsFailDebug("unable to build section header for \(indexPath)")
+                    return defaultView()
                 }
                 let title = OWSLocalizedString("GALLERY_TILES_LOADING_MORE_RECENT_LABEL", comment: "Label indicating loading is in progress")
                 sectionHeader.configure(title: title)
                 return sectionHeader
             default:
-                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: ThemeCollectionViewSectionHeader.reuseIdentifier, for: indexPath) as? ThemeCollectionViewSectionHeader else {
+                guard let sectionHeader = collectionView.dequeueReusableSupplementaryView(
+                    ofKind: kind,
+                    withReuseIdentifier: MediaGalleryDateHeader.reuseIdentifier,
+                    for: indexPath
+                ) as? MediaGalleryDateHeader else {
                     owsFailDebug("unable to build section header for indexPath: \(indexPath)")
-                    return defaultView
+                    return defaultView()
                 }
                 guard let date = mediaGallery.galleryDates[safe: mediaGallerySection(indexPath.section)] else {
                     owsFailDebug("unknown section for indexPath: \(indexPath)")
-                    return defaultView
+                    return defaultView()
                 }
-
+                sectionHeader.leadingEdgeTextInset = layout == .grid ? 0 : 8
                 sectionHeader.configure(title: date.localizedString)
                 return sectionHeader
             }
         }
 
-        return defaultView
+        return defaultView()
     }
 
-    override public func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
+    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
         Logger.debug("indexPath: \(indexPath)")
 
-        guard let cell = self.collectionView?.dequeueReusableCell(withReuseIdentifier: mode.reuseIdentifier(fileType: fileType), for: indexPath) as? Cell else {
+        guard let cell = collectionView.dequeueReusableCell(withReuseIdentifier: layout.reuseIdentifier(fileType: fileType), for: indexPath) as? Cell else {
             owsFailDebug("unexpected cell for indexPath: \(indexPath)")
             return UICollectionViewCell()
         }
@@ -744,7 +762,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
             }
 
             VideoDurationHelper.shared.with(context: videoDurationContext) {
-                cell.configure(item: allMediaItem(galleryItem: galleryItem), spoilerReveal: spoilerReveal)
+                cell.configure(item: cellItem(for: galleryItem), spoilerReveal: spoilerReveal)
             }
         }
         return cell
@@ -752,24 +770,24 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     private let mediaCache = CVMediaCache()
 
-    private func allMediaItem(galleryItem: MediaGalleryItem) -> AllMediaItem {
+    private func cellItem(for galleryItem: MediaGalleryItem) -> MediaGalleryCellItem {
         switch fileType {
-        case .media:
-            let gridCellItem = GalleryGridCellItem(galleryItem: galleryItem)
-            return .graphic(gridCellItem)
+        case .photoVideo:
+            return .photoVideo(MediaGalleryCellItemPhotoVideo(galleryItem: galleryItem))
         case .audio:
-            return .audio(
-                AudioItem(message: galleryItem.message,
-                          interaction: galleryItem.message,
-                          thread: thread,
-                          attachmentStream: galleryItem.attachmentStream,
-                          mediaCache: mediaCache,
-                          metadata: galleryItem.mediaMetadata!))
+            return .audio(MediaGalleryCellItemAudio(
+                message: galleryItem.message,
+                interaction: galleryItem.message,
+                thread: thread,
+                attachmentStream: galleryItem.attachmentStream,
+                mediaCache: mediaCache,
+                metadata: galleryItem.mediaMetadata!
+            ))
         }
     }
     private lazy var videoDurationContext = { VideoDurationHelper.Context() }()
 
-    override public func collectionView(_ collectionView: UICollectionView, willDisplay cell: UICollectionViewCell, forItemAt indexPath: IndexPath) {
+    override func collectionView(_ collectionView: UICollectionView, willDisplay cell: UICollectionViewCell, forItemAt indexPath: IndexPath) {
         guard let cell = cell as? Cell else {
             owsFailDebug("unexpected cell: \(cell)")
             return
@@ -778,7 +796,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         cell.setAllowsMultipleSelection(collectionView.allowsMultipleSelection, animated: false)
     }
 
-    func galleryItem(at indexPath: IndexPath, loadAsync: Bool = false) -> MediaGalleryItem? {
+    private func galleryItem(at indexPath: IndexPath, loadAsync: Bool = false) -> MediaGalleryItem? {
         let underlyingPath = mediaGalleryIndexPath(indexPath)
         if let loadedGalleryItem = mediaGallery.galleryItem(at: underlyingPath) {
             return loadedGalleryItem
@@ -795,7 +813,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         return mediaGallery.galleryItem(at: underlyingPath)
     }
 
-    func updateVisibleCells() {
+    private func updateVisibleCells() {
         for cell in collectionView.visibleCells {
             guard let cell = cell as? Cell else {
                 owsFailDebug("unexpected cell: \(cell)")
@@ -808,71 +826,64 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
     // MARK: UICollectionViewDelegateFlowLayout
 
-    private class func makeLayout(mode: Mode, fileType: AllMediaFileType) -> Layout {
-        switch mode {
-        case .list:
-            switch fileType {
-            case .media:
-                return WideMediaTileViewLayout(sectionSpacing: 20.0, interItemSpacing: 0.0)
-            case .audio:
-                return WideMediaTileViewLayout(sectionSpacing: 20.0, interItemSpacing: 12.0)
+    private static let invalidLayoutItemSize = CGSize(square: 10)
+
+    private class func buildLayout(_ layout: Layout, fileType: AllMediaFileType) -> CollectionViewLayout {
+        let layout: CollectionViewLayout = {
+            switch layout {
+            case .list:
+                switch fileType {
+                case .photoVideo:
+                    return WideMediaTileViewLayout(interItemSpacing: 0)
+                case .audio:
+                    return WideMediaTileViewLayout(interItemSpacing: 12)
+                }
+            case .grid:
+                return SquareMediaTileViewLayout()
             }
-        case .grid:
-            return SquareMediaTileViewLayout()
-        }
-    }
-
-    private class func buildLayout(mode: Mode, fileType: AllMediaFileType) -> Layout {
-        let layout = makeLayout(mode: mode, fileType: fileType)
+        }()
 
+        layout.itemSize = invalidLayoutItemSize
         layout.sectionInsetReference = .fromSafeArea
-        // Modern design
         layout.sectionHeadersPinToVisibleBounds = false
 
         return layout
     }
 
-    func updateLayout() {
-        switch mode {
+    private func recalculateLayoutMetrics() {
+        switch layout {
         case .grid:
-            updateSquareLayout()
+            recalculateGridLayoutMetrics()
         case .list:
-            updateWideLayout()
+            recalculateListLayoutMetrics()
         }
     }
 
-    private func updateSquareLayout() {
-        let rawSize = view.safeAreaLayoutGuide.layoutFrame.size
-
-        let containerSize = CGSize(width: floor(rawSize.width), height: floor(rawSize.height))
-
+    private func recalculateGridLayoutMetrics() {
         let kItemsPerPortraitRow = 4
+
+        let containerSize = view.safeAreaLayoutGuide.layoutFrame.size
         let minimumViewWidth = min(containerSize.width, containerSize.height)
         let approxItemWidth = minimumViewWidth / CGFloat(kItemsPerPortraitRow)
 
         let itemCount = round(containerSize.width / approxItemWidth)
-        let interSpaceWidth = (itemCount - 1) * mediaTileViewLayout.minimumInteritemSpacing
+        let interSpaceWidth = (itemCount - 1) * currentCollectionViewLayout.minimumInteritemSpacing
         let availableWidth = max(0, containerSize.width - interSpaceWidth)
 
         let itemWidth = floor(availableWidth / CGFloat(itemCount))
         let newItemSize = CGSize(square: itemWidth)
-        let remainingSpace = availableWidth - (itemCount * itemWidth)
-        let hInset = remainingSpace / 2
-        if newItemSize != mediaTileViewLayout.itemSize || hInset != mediaTileViewLayout.sectionInset.left {
-            mediaTileViewLayout.itemSize = newItemSize
-            // Inset any remaining space around the outside edges to ensure all inter-item spacing is exactly equal, otherwise
-            // we may get slightly different gaps between rows vs. columns
-            mediaTileViewLayout.sectionInset = UIEdgeInsets(top: 0, leading: hInset, bottom: 0, trailing: hInset)
-            mediaTileViewLayout.invalidateLayout()
+        if newItemSize != currentCollectionViewLayout.itemSize {
+            currentCollectionViewLayout.itemSize = newItemSize
+            currentCollectionViewLayout.invalidateLayout()
         }
     }
 
-    private func updateWideLayout() {
-        let hInset = 20.0
+    private func recalculateListLayoutMetrics() {
+        let hInset = OWSTableViewController2.defaultHOuterMargin
         let desiredHeight = {
             switch fileType {
-            case .media:
-                return WidePhotoCell.desiredHeight
+            case .photoVideo:
+                return WidePhotoCell.cellHeight()
             case .audio:
                 return AudioCell.desiredHeight
             }
@@ -880,61 +891,130 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 
         let newItemSize = CGSize(
             width: floor(view.safeAreaLayoutGuide.layoutFrame.size.width) - hInset * 2,
-            height: desiredHeight)
-        if newItemSize != mediaTileViewLayout.itemSize || hInset != mediaTileViewLayout.sectionInset.left {
-            mediaTileViewLayout.itemSize = newItemSize
-            // Inset any remaining space around the outside edges to ensure all inter-item spacing is exactly equal, otherwise
-            // we may get slightly different gaps between rows vs. columns
-            mediaTileViewLayout.sectionInset = UIEdgeInsets(top: 0, leading: hInset, bottom: 0, trailing: hInset)
-            mediaTileViewLayout.invalidateLayout()
+            height: desiredHeight
+        )
+        if newItemSize != currentCollectionViewLayout.itemSize || hInset != currentCollectionViewLayout.sectionInset.left {
+            currentCollectionViewLayout.itemSize = newItemSize
+            currentCollectionViewLayout.sectionInset = UIEdgeInsets(top: 0, leading: hInset, bottom: 0, trailing: hInset)
         }
     }
 
-    public func collectionView(_ collectionView: UICollectionView,
-                               layout collectionViewLayout: UICollectionViewLayout,
-                               referenceSizeForHeaderInSection section: Int) -> CGSize {
-
-        let kMonthHeaderSize: CGSize = CGSize(width: 0, height: 50)
-        let kStaticHeaderSize: CGSize = CGSize(width: 0, height: 100)
+    func collectionView(
+        _ collectionView: UICollectionView,
+        layout collectionViewLayout: UICollectionViewLayout,
+        referenceSizeForHeaderInSection section: Int
+    ) -> CGSize {
 
         guard !mediaGallery.galleryDates.isEmpty else {
-            return kStaticHeaderSize
+            // Make section header occupy entire visible collection view heigth so that the text is centered.
+            let collectionViewViewportHeight = collectionView.frame.height - collectionView.adjustedContentInset.totalHeight
+            return CGSize(width: collectionView.frame.height, height: collectionViewViewportHeight)
         }
 
-        switch section {
-        case kLoadOlderSectionIdx:
-            // Show "loading older..." iff there is still older data to be fetched
-            return mediaGallery.hasFetchedOldest ? CGSize.zero : kStaticHeaderSize
-        case loadNewerSectionIdx:
-            // Show "loading newer..." iff there is still more recent data to be fetched
-            return mediaGallery.hasFetchedMostRecent ? CGSize.zero : kStaticHeaderSize
-        default:
-            return kMonthHeaderSize
+        let height: CGFloat = {
+            switch section {
+            case kLoadOlderSectionIdx:
+                // Show "loading older..." iff there is still older data to be fetched
+                return mediaGallery.hasFetchedOldest ? 0 : loadingDataHeaderHeight()
+            case loadNewerSectionIdx:
+                // Show "loading newer..." iff there is still more recent data to be fetched
+                return mediaGallery.hasFetchedMostRecent ? 0 : loadingDataHeaderHeight()
+            default:
+                return dateHeaderHeight()
+            }
+        }()
+        guard height > 0 else {
+            // No section header
+            return .zero
         }
+        return CGSize(width: collectionView.frame.width, height: height)
+    }
+
+    func collectionView(
+        _ collectionView: UICollectionView,
+        layout collectionViewLayout: UICollectionViewLayout,
+        insetForSectionAt section: Int
+    ) -> UIEdgeInsets {
+        guard !mediaGallery.galleryDates.isEmpty else { return .zero }
+
+        guard layout == .list else { return .zero }
+
+        if section == loadNewerSectionIdx {
+            // Additional 16pt margin at the bottom of the list.
+            return UIEdgeInsets(top: 0, leading: 0, bottom: 16, trailing: 0)
+        }
+
+        return currentCollectionViewLayout.sectionInset
     }
 
-    public func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {
-        switch mode {
+    func collectionView(
+        _ collectionView: UICollectionView,
+        layout collectionViewLayout: UICollectionViewLayout,
+        sizeForItemAt indexPath: IndexPath
+    ) -> CGSize {
+        guard currentCollectionViewLayout == collectionViewLayout else {
+            owsFailDebug("Unknown layout")
+            return .zero
+        }
+
+        if currentCollectionViewLayout.itemSize == Self.invalidLayoutItemSize {
+            recalculateLayoutMetrics()
+        }
+
+        switch layout {
         case .grid:
-            return mediaTileViewLayout.itemSize
+            return currentCollectionViewLayout.itemSize
         case .list:
             switch fileType {
-            case .media:
-                return mediaTileViewLayout.itemSize
+            case .photoVideo:
+                return currentCollectionViewLayout.itemSize
             case .audio:
                 if let galleryItem = galleryItem(at: indexPath, loadAsync: true) {
-                    return AudioCell.sizeForItem(allMediaItem(galleryItem: galleryItem),
-                                                 defaultSize: mediaTileViewLayout.itemSize)
+                    return AudioCell.sizeForItem(cellItem(for: galleryItem), defaultSize: currentCollectionViewLayout.itemSize)
                 }
-                return mediaTileViewLayout.itemSize
+                return currentCollectionViewLayout.itemSize
             }
         }
     }
 
+    private var cachedDateHeaderHeight: CGFloat?
+    private var cachedLoadingDataHeaderHeight: CGFloat?
+
+    private func dateHeaderHeight() -> CGFloat {
+        if let cachedDateHeaderHeight {
+            return cachedDateHeaderHeight
+        }
+        let headerView = MediaGalleryDateHeader()
+        headerView.configure(title: "M")
+        let size = headerView.systemLayoutSizeFitting(UIView.layoutFittingExpandedSize)
+        cachedDateHeaderHeight = size.height
+        return size.height
+    }
+
+    private func loadingDataHeaderHeight() -> CGFloat {
+        if let cachedLoadingDataHeaderHeight {
+            return cachedLoadingDataHeaderHeight
+        }
+        let headerView = MediaGalleryStaticHeader()
+        headerView.configure(title: "M")
+        let size = headerView.systemLayoutSizeFitting(UIView.layoutFittingExpandedSize)
+        cachedLoadingDataHeaderHeight = size.height
+        return size.height
+    }
+
     // MARK: MediaGalleryDelegate
 
-    func mediaGallery(_ mediaGallery: MediaGallery,
-                      applyUpdate update: MediaGallery.Update) {
+    private func updateCellIndexPaths() {
+        for cell in allCells.elements {
+            guard let indexPath = collectionView.indexPath(for: cell) else {
+                continue
+            }
+            (cell as? Cell)?.indexPathDidChange(indexPath,
+                                                itemCount: collectionView.numberOfItems(inSection: indexPath.section))
+        }
+    }
+
+    func mediaGallery(_ mediaGallery: MediaGallery, applyUpdate update: MediaGallery.Update) {
         Logger.debug("Will begin batch update. animating=\(activeAnimationCount)")
         let shouldAnimate = activeAnimationCount == 0 && !update.userData.contains(where: { $0.disableAnimations })
 
@@ -942,7 +1022,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         UIView.setAnimationsEnabled(shouldAnimate && UIView.areAnimationsEnabled && saved)
 
         if update.userData.contains(where: { $0.shouldRecordContentSizeBeforeInsertingToTop }) {
-            mediaTileViewLayout.recordContentSizeBeforeInsertingToTop()
+            currentCollectionViewLayout.recordContentSizeBeforeInsertingToTop()
         }
         // Within `performBatchUpdates` and before our closure runs, `UICollectionView` may call `numberOfItemsInSection`
         // and it will expect us to give it "old" values (before any changes are applied).
@@ -975,16 +1055,6 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
         }
     }
 
-    private func updateCellIndexPaths() {
-        for cell in allCells.elements {
-            guard let indexPath = collectionView.indexPath(for: cell) else {
-                continue
-            }
-            (cell as? Cell)?.indexPathDidChange(indexPath,
-                                                itemCount: collectionView.numberOfItems(inSection: indexPath.section))
-        }
-    }
-
     func mediaGallery(_ mediaGallery: MediaGallery, willDelete items: [MediaGalleryItem], initiatedBy: AnyObject) {
         Logger.debug("")
     }
@@ -1114,6 +1184,7 @@ public class MediaTileViewController: UICollectionViewController, MediaGalleryDe
 }
 
 extension MediaTileViewController: MediaPresentationContextProvider {
+
     func mediaPresentationContext(item: Media, in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
         // First time presentation can occur before layout.
         view.layoutIfNeeded()
@@ -1148,24 +1219,27 @@ extension MediaTileViewController: MediaPresentationContextProvider {
 
 // MARK: - Private Helper Classes
 
-private class MediaGalleryStaticHeader: UICollectionViewCell {
+private class MediaGalleryStaticHeader: UICollectionReusableView {
 
     static let reuseIdentifier = "MediaGalleryStaticHeader"
 
-    let label = UILabel()
+    private let label: UILabel = {
+        let label = UILabel()
+        label.adjustsFontForContentSizeCategory = true
+        label.textAlignment = .center
+        label.font = .dynamicTypeBody2
+        label.numberOfLines = 3
+        label.textColor = UIColor(dynamicProvider: { _ in return Theme.primaryTextColor })
+        return label
+    }()
 
     override init(frame: CGRect) {
         super.init(frame: frame)
-        label.textColor = Theme.primaryTextColor
-        label.font = UIFont.dynamicTypeBody
-        addSubview(label)
 
-        label.textAlignment = .center
-        label.numberOfLines = 0
+        addSubview(label)
         label.autoPinEdgesToSuperviewMargins()
     }
 
-    @available(*, unavailable, message: "Unimplemented")
     required public init?(coder aDecoder: NSCoder) {
         fatalError("init(coder:) has not been implemented")
     }
@@ -1173,61 +1247,52 @@ private class MediaGalleryStaticHeader: UICollectionViewCell {
     public func configure(title: String) {
         label.text = title
     }
-
-    public override func prepareForReuse() {
-        label.text = nil
-        label.textColor = Theme.primaryTextColor
-        label.font = UIFont.dynamicTypeBody
-    }
 }
 
-class GalleryGridCellItem: PhotoGridItem {
-    let galleryItem: MediaGalleryItem
+private class MediaGalleryDateHeader: UICollectionReusableView {
 
-    init(galleryItem: MediaGalleryItem) {
-        self.galleryItem = galleryItem
-    }
+    static let reuseIdentifier = "MediaGalleryDateHeader"
 
-    var type: PhotoGridItemType {
-        if galleryItem.isVideo {
-            return .video(videoDurationPromise)
-        } else if galleryItem.isAnimated {
-            return .animated
-        } else {
-            return .photo
+    private let label: UILabel = {
+        let label = UILabel()
+        label.adjustsFontForContentSizeCategory = true
+        label.font = .dynamicTypeHeadlineClamped
+        label.textAlignment = .natural
+        label.textColor = UIColor(dynamicProvider: { _ in return Theme.primaryTextColor })
+        return label
+    }()
+
+    private lazy var labelLeadingEdgeConstraint = label.leadingAnchor.constraint(equalTo: layoutMarginsGuide.leadingAnchor)
+
+    var leadingEdgeTextInset: CGFloat = 0 {
+        didSet {
+            labelLeadingEdgeConstraint.constant = leadingEdgeTextInset
         }
     }
 
-    var isFavorite: Bool { false }
+    override public init(frame: CGRect) {
+        super.init(frame: frame)
 
-    func asyncThumbnail(completion: @escaping (UIImage?) -> Void) -> UIImage? {
-        return galleryItem.thumbnailImage(async: completion)
-    }
+        preservesSuperviewLayoutMargins = true
 
-    private var videoDurationPromise: Promise<TimeInterval> {
-        owsAssert(galleryItem.isVideo)
-        return VideoDurationHelper.shared.promisedDuration(attachment: galleryItem.attachmentStream)
+        addSubview(label)
+        labelLeadingEdgeConstraint.isActive = true
+        label.autoPinTrailingToSuperviewMargin()
+        label.autoPinEdge(toSuperviewEdge: .top, withInset: 32)
+        label.autoPinEdge(toSuperviewEdge: .bottom, withInset: 10)
     }
-    var mediaMetadata: MediaMetadata? {
-        return galleryItem.mediaMetadata
+
+    public required init?(coder aDecoder: NSCoder) {
+        fatalError("init(coder:) has not been implemented")
     }
-}
 
-extension MediaGalleryItem {
-    var mediaMetadata: MediaMetadata? {
-        let filename = attachmentStream.originalFilePath.map {
-            ($0 as NSString).lastPathComponent as String
-        }
-        return MediaMetadata(
-            sender: sender?.name ?? "",
-            abbreviatedSender: sender?.abbreviatedName ?? "",
-            filename: filename,
-            byteSize: Int(attachmentStream.byteCount),
-            creationDate: attachmentStream.creationTimestamp)
+    public func configure(title: String) {
+        label.text = title
     }
 }
 
 extension MediaTileViewController: MediaGalleryPrimaryViewController {
+
     typealias MenuAction = MediaGalleryAccessoriesHelper.MenuAction
 
     var scrollView: UIScrollView { return collectionView }
@@ -1364,5 +1429,36 @@ extension MediaTileViewController: MediaGalleryPrimaryViewController {
     }
 }
 
-class MediaTileCollectionView: UICollectionView {
+private extension IndexSet {
+    func shifted(startingAt index: Int? = nil, by amount: Int) -> IndexSet {
+        var result = self
+        result.shift(startingAt: index ?? self.first ?? 0, by: amount)
+        return result
+    }
+}
+
+private extension IndexPath {
+    func shiftingSection(by delta: Int) -> IndexPath {
+        return IndexPath(item: item, section: section + delta)
+    }
+}
+
+private class MediaTileCollectionViewCell: PhotoGridViewCell, MediaGalleryCollectionViewCell {
+
+    var item: MediaGalleryCellItem?
+
+    func setAllowsMultipleSelection(_ allowed: Bool, animated: Bool) {
+        allowsMultipleSelection = allowed
+    }
+
+    func configure(item: MediaGalleryCellItem, spoilerReveal: SignalServiceKit.SpoilerRevealState) {
+        self.item = item
+        guard case .photoVideo(let mediaGalleryCellItemPhotoVideo) = item else {
+            owsFailDebug("Invalid item.")
+            return
+        }
+        super.configure(item: mediaGalleryCellItemPhotoVideo)
+    }
+
+    func indexPathDidChange(_ indexPath: IndexPath, itemCount: Int) { }
 }
diff --git a/Signal/src/ViewControllers/MediaGallery/WideMediaTileViewLayout.swift b/Signal/src/ViewControllers/MediaGallery/WideMediaTileViewLayout.swift
index e1211e6c495..acefe7a6f18 100644
--- a/Signal/src/ViewControllers/MediaGallery/WideMediaTileViewLayout.swift
+++ b/Signal/src/ViewControllers/MediaGallery/WideMediaTileViewLayout.swift
@@ -29,12 +29,9 @@ class WideMediaTileViewLayout: UICollectionViewFlowLayout, ScrollPositionPreserv
         }
     }
 
-    private var sectionSpacing: CGFloat = 20.0
-
-    init(sectionSpacing: CGFloat, interItemSpacing: CGFloat) {
-        self.sectionSpacing = sectionSpacing
+    init(interItemSpacing: CGFloat) {
         super.init()
-        self.scrollDirection = .vertical
+        scrollDirection = .vertical
         minimumLineSpacing = interItemSpacing
         minimumInteritemSpacing = interItemSpacing
     }
@@ -43,25 +40,6 @@ class WideMediaTileViewLayout: UICollectionViewFlowLayout, ScrollPositionPreserv
         owsFail("init(coder:) has not been implemented")
     }
 
-    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
-        let layoutAttributes = super.layoutAttributesForElements(in: rect)
-
-        layoutAttributes?.forEach { attributes in
-            if attributes.representedElementKind == UICollectionView.elementKindSectionHeader {
-                guard let collectionView = collectionView else { return }
-                let contentInset = collectionView.contentInset
-                let bounds = collectionView.bounds
-
-                let width = bounds.width - contentInset.left - contentInset.right
-                let height = attributes.frame.height
-
-                attributes.frame = CGRect(x: contentInset.left, y: attributes.frame.origin.y, width: width, height: height)
-            }
-        }
-
-        return layoutAttributes
-    }
-
     override func shouldInvalidateLayout(forBoundsChange newBounds: CGRect) -> Bool {
         return true
     }
diff --git a/Signal/src/ViewControllers/Photos/ImagePickerController.swift b/Signal/src/ViewControllers/Photos/ImagePickerController.swift
index 2a16698a53f..38d6991ce58 100644
--- a/Signal/src/ViewControllers/Photos/ImagePickerController.swift
+++ b/Signal/src/ViewControllers/Photos/ImagePickerController.swift
@@ -474,7 +474,7 @@ class ImagePickerGridController: UICollectionViewController, PhotoLibraryDelegat
 
         cell.loadingColor = UIColor(white: 0.2, alpha: 1)
         let assetItem = photoAlbumContents.assetItem(at: indexPath.item, photoMediaSize: photoMediaSize)
-        cell.configure(item: .graphic(assetItem), spoilerReveal: SpoilerRevealState())
+        cell.configure(item: assetItem)
         return cell
     }
 
@@ -492,7 +492,7 @@ class ImagePickerGridController: UICollectionViewController, PhotoLibraryDelegat
             collectionView.deselectItem(at: indexPath, animated: false)
         }
         photoGridViewCell.isSelected = isSelected
-        photoGridViewCell.setAllowsMultipleSelection(collectionView.allowsMultipleSelection, animated: false)
+        photoGridViewCell.allowsMultipleSelection = collectionView.allowsMultipleSelection
     }
 
     private func updateVisibleCells() {
@@ -504,14 +504,13 @@ class ImagePickerGridController: UICollectionViewController, PhotoLibraryDelegat
                 continue
             }
 
-            guard case let .graphic(photoItem) = photoGridViewCell.item,
-                  let assetItem = photoItem as? PhotoPickerAssetItem else {
-                owsFailDebug("unexpected photoGridViewCell.item: \(String(describing: photoGridViewCell.item))")
+            guard let assetItem = photoGridViewCell.photoGridItem as? PhotoPickerAssetItem else {
+                owsFailDebug("unexpected photoGridViewCell.item: \(String(describing: photoGridViewCell.photoGridItem))")
                 continue
             }
 
             photoGridViewCell.isSelected = dataSource.imagePicker(self, isAssetSelected: assetItem.asset)
-            photoGridViewCell.setAllowsMultipleSelection(collectionView.allowsMultipleSelection, animated: true)
+            photoGridViewCell.allowsMultipleSelection = collectionView.allowsMultipleSelection
         }
     }
 }
diff --git a/Signal/src/views/MediaTileCell.swift b/Signal/src/views/MediaTileCell.swift
deleted file mode 100644
index fb133fce756..00000000000
--- a/Signal/src/views/MediaTileCell.swift
+++ /dev/null
@@ -1,19 +0,0 @@
-//
-// Copyright 2023 Signal Messenger, LLC
-// SPDX-License-Identifier: AGPL-3.0-only
-//
-
-import Foundation
-import SignalServiceKit
-
-protocol MediaTileCell: AnyObject {
-    func makePlaceholder()
-    func configure(item: AllMediaItem, spoilerReveal: SpoilerRevealState)
-    var item: AllMediaItem? { get set }
-    var allowsMultipleSelection: Bool { get }
-    func setAllowsMultipleSelection(_ allowed: Bool, animated: Bool)
-    func mediaPresentationContext(
-        collectionView: UICollectionView,
-        in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext?
-    func indexPathDidChange(_ indexPath: IndexPath, itemCount: Int)
-}
diff --git a/Signal/src/views/PhotoGridViewCell.swift b/Signal/src/views/PhotoGridViewCell.swift
index fcfdb24cb8c..d78f44475cf 100644
--- a/Signal/src/views/PhotoGridViewCell.swift
+++ b/Signal/src/views/PhotoGridViewCell.swift
@@ -7,7 +7,7 @@ import SignalMessaging
 import SignalUI
 import UIKit
 
-public enum PhotoGridItemType {
+enum PhotoGridItemType {
     case photo
     case animated
     case video(Promise<TimeInterval>)
@@ -46,69 +46,6 @@ public enum PhotoGridItemType {
     }
 }
 
-public enum AllMediaItem {
-    case graphic(any PhotoGridItem)
-    case audio(AudioItem)
-
-    var attachmentStream: TSAttachmentStream? {
-        switch self {
-        case .graphic(let photoItem):
-            return (photoItem as? GalleryGridCellItem)?.galleryItem.attachmentStream
-        case .audio(let audioItem):
-            return audioItem.attachmentStream
-        }
-    }
-}
-
-extension AllMediaItem: Equatable {
-    public static func == (lhs: AllMediaItem, rhs: AllMediaItem) -> Bool {
-        switch (lhs, rhs) {
-        case let (.graphic(lvalue), .graphic(rvalue)):
-            return lvalue === rvalue
-        case let (.audio(lvalue), .audio(rvalue)):
-            return lvalue.attachmentStream == rvalue.attachmentStream
-        case (.graphic, _), (.audio, _):
-            return false
-        }
-    }
-}
-public struct AudioItem {
-    var message: TSMessage
-    var interaction: TSInteraction
-    var thread: TSThread
-    var attachmentStream: TSAttachmentStream
-    var mediaCache: CVMediaCache
-    var metadata: MediaMetadata
-
-    var size: UInt {
-        UInt(attachmentStream.byteCount)
-    }
-    var date: Date {
-        attachmentStream.creationTimestamp
-    }
-    var duration: TimeInterval {
-        attachmentStream.audioDurationSeconds()
-    }
-
-    enum AttachmentType {
-        case file
-        case voiceMessage
-    }
-    var attachmentType: AttachmentType {
-        let isVoiceMessage = attachmentStream.isVoiceMessageIncludingLegacyMessages
-        return isVoiceMessage ? .voiceMessage : .file
-    }
-
-    var localizedString: String {
-        switch attachmentType {
-        case .file:
-            return "Audio file"  // ATTACHMENT_TYPE_AUDIO
-        case .voiceMessage:
-            return "Voice message"  // ATTACHMENT_TYPE_VOICE_MESSAGE
-        }
-    }
-}
-
 public struct MediaMetadata {
     var sender: String
     var abbreviatedSender: String
@@ -117,14 +54,14 @@ public struct MediaMetadata {
     var creationDate: Date?
 }
 
-public protocol PhotoGridItem: AnyObject {
+protocol PhotoGridItem: AnyObject {
     var type: PhotoGridItemType { get }
     var isFavorite: Bool { get }
     func asyncThumbnail(completion: @escaping (UIImage?) -> Void) -> UIImage?
     var mediaMetadata: MediaMetadata? { get }
 }
 
-public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
+class PhotoGridViewCell: UICollectionViewCell {
 
     static let reuseIdentifier = "PhotoGridViewCell"
 
@@ -140,19 +77,16 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
     private let highlightedMaskView: UIView
     private let selectedMaskView: UIView
 
-    var item: AllMediaItem?
+    private(set) var photoGridItem: PhotoGridItem?
 
     public var loadingColor = Theme.washColor
-    private(set) var allowsMultipleSelection = false {
+
+    var allowsMultipleSelection = false {
         didSet {
             updateSelectionState()
         }
     }
 
-    func setAllowsMultipleSelection(_ allowed: Bool, animated: Bool) {
-        allowsMultipleSelection = allowed
-    }
-
     public override var isHighlighted: Bool {
         didSet {
             highlightedMaskView.isHidden = !isHighlighted
@@ -246,7 +180,7 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
         fatalError("init(coder:) has not been implemented")
     }
 
-    fileprivate func updateSelectionState() {
+    private func updateSelectionState() {
         selectedMaskView.isHidden = !isSelected
         selectionButton.isSelected = isSelected
         selectionButton.allowsMultipleSelection = allowsMultipleSelection
@@ -287,9 +221,9 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
     }
 
     private func updateVideoDurationWhenPromiseFulfilled(_ promisedDuration: Promise<TimeInterval>) {
-        let originalItem = item
+        let originalItem = photoGridItem
         promisedDuration.observe { [weak self] result in
-            guard let self, self.item == originalItem, case .success(let duration) = result else {
+            guard let self, self.photoGridItem === originalItem, case .success(let duration) = result else {
                 return
             }
             self.setCaption(OWSFormat.localizedDurationString(from: duration))
@@ -365,34 +299,15 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
     }
 
     public func makePlaceholder() {
-        self.item = nil
-        self.image = nil
+        photoGridItem = nil
+        image = nil
         setMedia(itemType: .photo)
         setUpAccessibility(item: nil)
     }
 
-    public func configure(item: AllMediaItem, spoilerReveal: SpoilerRevealState) {
-        switch item {
-        case .graphic(let photoGridItem):
-            self.item = item
-            reallyConfigure(photoGridItem)
-        default:
-            owsFailDebug("Unexpected item type \(item)")
-        }
-    }
+    func configure(item: PhotoGridItem) {
+        photoGridItem = item
 
-    private var photoGridItem: PhotoGridItem? {
-        switch item {
-        case .graphic(let result):
-            return result
-        case .none:
-            return nil
-        default:
-            return nil
-        }
-    }
-
-    private func reallyConfigure(_ item: PhotoGridItem) {
         // PHCachingImageManager returns multiple progressively better
         // thumbnails in the async block. We want to avoid calling
         // `configure(item:)` multiple times because the high-quality image eventually applied
@@ -424,7 +339,7 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
     override public func prepareForReuse() {
         super.prepareForReuse()
 
-        item = nil
+        photoGridItem = nil
         imageView.image = nil
         isFavoriteBadge?.isHidden = true
         durationLabel?.isHidden = true
@@ -434,22 +349,17 @@ public class PhotoGridViewCell: UICollectionViewCell, MediaTileCell {
         selectionButton.reset()
     }
 
-    func mediaPresentationContext(
-        collectionView: UICollectionView,
-        in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
-            guard let mediaSuperview = imageView.superview else {
-                owsFailDebug("mediaSuperview was unexpectedly nil")
-                return nil
-            }
-            let presentationFrame = coordinateSpace.convert(imageView.frame, from: mediaSuperview)
-            let clippingAreaInsets = UIEdgeInsets(top: collectionView.adjustedContentInset.top, leading: 0, bottom: 0, trailing: 0)
-            return MediaPresentationContext(
-                mediaView: imageView,
-                presentationFrame: presentationFrame,
-                clippingAreaInsets: clippingAreaInsets
-            )
+    func mediaPresentationContext(collectionView: UICollectionView, in coordinateSpace: UICoordinateSpace) -> MediaPresentationContext? {
+        guard let mediaSuperview = imageView.superview else {
+            owsFailDebug("mediaSuperview was unexpectedly nil")
+            return nil
         }
-
-    func indexPathDidChange(_ indexPath: IndexPath, itemCount: Int) {
+        let presentationFrame = coordinateSpace.convert(imageView.frame, from: mediaSuperview)
+        let clippingAreaInsets = UIEdgeInsets(top: collectionView.adjustedContentInset.top, leading: 0, bottom: 0, trailing: 0)
+        return MediaPresentationContext(
+            mediaView: imageView,
+            presentationFrame: presentationFrame,
+            clippingAreaInsets: clippingAreaInsets
+        )
     }
 }
diff --git a/Signal/src/views/SelectionButton.swift b/Signal/src/views/SelectionButton.swift
index 5180474d0a7..3a320abf18d 100644
--- a/Signal/src/views/SelectionButton.swift
+++ b/Signal/src/views/SelectionButton.swift
@@ -16,18 +16,19 @@ class SelectionButton: UIView {
         return imageView
     }()
     private let selectedBadgeView: UIView = {
-        let imageView = UIImageView(image: UIImage(imageLiteralResourceName: "check-circle"))
+        let imageView = UIImageView(image: UIImage(imageLiteralResourceName: "check-circle-fill"))
         imageView.contentMode = .center
-        imageView.tintColor = .white
+        imageView.tintColor = .ows_accentBlue
 
-        let circleView = CircleView(diameter: 21.5)
-        circleView.backgroundColor = .ows_accentBlue
+        // This will give checkmark it's color.
+        let backgroundView = CircleView(diameter: 18)
+        backgroundView.backgroundColor = .white
 
         let containerView = UIView(frame: imageView.bounds)
         containerView.isHidden = true
 
-        containerView.addSubview(circleView)
-        circleView.autoCenterInSuperview()
+        containerView.addSubview(backgroundView)
+        backgroundView.autoCenterInSuperview()
 
         containerView.addSubview(imageView)
         imageView.autoPinEdgesToSuperviewEdges()
@@ -37,22 +38,25 @@ class SelectionButton: UIView {
 
     var isSelected: Bool = false {
         didSet {
-            updateHidden()
+            updateAppearance()
         }
     }
 
     var allowsMultipleSelection: Bool = false {
         didSet {
-            updateHidden()
+            updateAppearance()
         }
     }
 
-    var outlineColor: UIColor {
-        get {
-            outlineBadgeView.tintColor
+    var outlineColor: UIColor = .white {
+        didSet {
+            outlineBadgeView.tintColor = outlineColor
         }
-        set {
-            outlineBadgeView.tintColor = newValue
+    }
+
+    var hidesOutlineWhenSelected: Bool = false {
+        didSet {
+            updateAppearance()
         }
     }
 
@@ -72,9 +76,9 @@ class SelectionButton: UIView {
         fatalError("init(coder:) has not been implemented")
     }
 
-    private func updateHidden() {
+    private func updateAppearance() {
         if isSelected {
-            outlineBadgeView.isHidden = false
+            outlineBadgeView.isHidden = hidesOutlineWhenSelected
             selectedBadgeView.isHidden = false
         } else if allowsMultipleSelection {
             outlineBadgeView.isHidden = false
diff --git a/SignalServiceKit/src/Storage/MediaGalleryFinder.swift b/SignalServiceKit/src/Storage/MediaGalleryFinder.swift
index b50232de78e..f3167404ac0 100644
--- a/SignalServiceKit/src/Storage/MediaGalleryFinder.swift
+++ b/SignalServiceKit/src/Storage/MediaGalleryFinder.swift
@@ -262,7 +262,7 @@ public final class MediaGalleryManager: NSObject {
 // MARK: - MediaGalleryFinder (GRDB only)
 
 public enum AllMediaFileType: Int, CaseIterable {
-    case media = 0
+    case photoVideo = 0
     case audio = 1
 }
 
@@ -283,7 +283,7 @@ public struct MediaGalleryFinder {
 
         public static func defaultMediaType(for fileType: AllMediaFileType) -> MediaType {
             switch fileType {
-            case .media:
+            case .photoVideo:
                 return .graphicMedia
             case .audio:
                 return .audio
diff --git a/SignalUI/Views/ThemeHeaderView.swift b/SignalUI/Views/ThemeHeaderView.swift
deleted file mode 100644
index 7bed78323b3..00000000000
--- a/SignalUI/Views/ThemeHeaderView.swift
+++ /dev/null
@@ -1,99 +0,0 @@
-//
-// Copyright 2019 Signal Messenger, LLC
-// SPDX-License-Identifier: AGPL-3.0-only
-//
-
-import Foundation
-
-public class ThemeHeaderView: UIView {
-    let label: UILabel
-
-    static var labelFont: UIFont {
-        return UIFont.dynamicTypeBodyClamped.semibold()
-    }
-
-    static var desiredHeight: CGFloat {
-        return labelFont.pointSize / 17 * 28
-    }
-
-    private static var textColor: UIColor {
-        if #available(iOS 14, *) {
-            return UIColor(dynamicProvider: { _ in
-                Theme.isDarkThemeEnabled ? UIColor.ows_gray10 : UIColor.ows_gray90
-            })
-        } else {
-            return Theme.isDarkThemeEnabled ? UIColor.ows_gray05 : UIColor.ows_gray90
-        }
-    }
-
-    init(inset: CGFloat) {
-        label = UILabel()
-        label.font = Self.labelFont
-
-        super.init(frame: .zero)
-        self.preservesSuperviewLayoutMargins = true
-        updateColors()
-
-        self.addSubview(label)
-
-        label.autoPinEdge(toSuperviewMargin: .trailing, withInset: inset)
-        label.autoPinEdge(toSuperviewMargin: .leading, withInset: inset)
-        label.autoVCenterInSuperview()
-    }
-
-    @available(*, unavailable, message: "Unimplemented")
-    required init?(coder aDecoder: NSCoder) {
-        fatalError("init(coder:) has not been implemented")
-    }
-
-    public func configure(title: String) {
-        self.label.text = title
-    }
-
-    public func prepareForReuse() {
-        self.label.text = nil
-    }
-
-    override public func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) {
-        updateColors()
-    }
-
-    private func updateColors() {
-        self.backgroundColor = .clear
-        label.textColor = Self.textColor
-    }
-}
-
-public class ThemeCollectionViewSectionHeader: UICollectionReusableView {
-    public class var reuseIdentifier: String { return "ThemeCollectionViewSectionHeader" }
-    fileprivate var inset: CGFloat { 16.0 }
-
-    fileprivate lazy var headerView = {
-        buildHeaderView(inset: inset)
-    }()
-
-    override public init(frame: CGRect) {
-        super.init(frame: frame)
-        backgroundColor = .clear
-        preservesSuperviewLayoutMargins = true
-        addSubview(headerView)
-        headerView.autoPinEdgesToSuperviewEdges()
-    }
-
-    public required init?(coder aDecoder: NSCoder) {
-        fatalError("init(coder:) has not been implemented")
-    }
-
-    public override func prepareForReuse() {
-        super.prepareForReuse()
-        headerView.prepareForReuse()
-    }
-
-    public func configure(title: String) {
-        headerView.configure(title: title)
-    }
-
-    fileprivate func buildHeaderView(inset: CGFloat) -> ThemeHeaderView {
-        return ThemeHeaderView(inset: inset)
-    }
-}
