diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
index bdbc5e3b84a..5280584f5f5 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewController.m
@@ -4461,7 +4461,14 @@ - (void)setShouldObserveDBModifications:(BOOL)shouldObserveDBModifications
         // Snapshot the scroll state by measuring the "distance from top of view to
         // bottom of content"; if the mapping's "window" size grows, it will grow
         // _upward_.
-        CGFloat viewTopToContentBottom = self.safeContentHeight - self.collectionView.contentOffset.y;
+        CGFloat viewTopToContentBottom = 0;
+        if ([self.collectionView.collectionViewLayout isKindOfClass:[ConversationViewLayout class]]) {
+            ConversationViewLayout *conversationViewLayout
+                = (ConversationViewLayout *)self.collectionView.collectionViewLayout;
+            if (conversationViewLayout.hasLayout) {
+                viewTopToContentBottom = self.safeContentHeight - self.collectionView.contentOffset.y;
+            }
+        }
 
         NSUInteger oldCellCount = [self.messageMappings numberOfItemsInGroup:self.thread.uniqueId];
 
diff --git a/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.h b/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.h
index 538192cf83f..d617c7b6a6c 100644
--- a/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.h
+++ b/Signal/src/ViewControllers/ConversationView/ConversationViewLayout.h
@@ -37,7 +37,7 @@ typedef NS_ENUM(NSInteger, ConversationViewLayoutAlignment) {
 @interface ConversationViewLayout : UICollectionViewLayout
 
 @property (nonatomic, weak) id<ConversationViewLayoutDelegate> delegate;
-
+@property (nonatomic, readonly) BOOL hasLayout;
 @property (nonatomic, readonly) int contentWidth;
 
 @end
