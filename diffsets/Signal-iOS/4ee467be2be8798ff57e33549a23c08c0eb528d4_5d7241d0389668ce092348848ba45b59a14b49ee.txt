diff --git a/Signal.xcodeproj/project.pbxproj b/Signal.xcodeproj/project.pbxproj
index 1195caba049..752b069aeef 100644
--- a/Signal.xcodeproj/project.pbxproj
+++ b/Signal.xcodeproj/project.pbxproj
@@ -876,6 +876,10 @@
 		66A1DF75298C73D900C4E4A7 /* RegistrationServiceResponses.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66A1DF74298C73D900C4E4A7 /* RegistrationServiceResponses.swift */; };
 		66A22C0928A18D49007CD4F5 /* RingerSwitch.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66A22C0828A18D49007CD4F5 /* RingerSwitch.swift */; };
 		66A93A8029940A8200FA0291 /* RegistrationCoordinatorImpl+Service.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66A93A7F29940A8200FA0291 /* RegistrationCoordinatorImpl+Service.swift */; };
+		66AAC2C429CB6F1100566AD6 /* RegistrationChangeNumberSplashViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AAC2C329CB6F1100566AD6 /* RegistrationChangeNumberSplashViewController.swift */; };
+		66AAC2C629CB942F00566AD6 /* RegistrationChangePhoneNumberViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AAC2C529CB942F00566AD6 /* RegistrationChangePhoneNumberViewController.swift */; };
+		66AAC2C829CB9ED900566AD6 /* RegistrationChangePhoneNumberConfirmationViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AAC2C729CB9ED900566AD6 /* RegistrationChangePhoneNumberConfirmationViewController.swift */; };
+		66AAC2CA29CBC07300566AD6 /* RegistrationPhoneNumberViewState.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AAC2C929CBC07300566AD6 /* RegistrationPhoneNumberViewState.swift */; };
 		66AE5779298440A100E40CFA /* ViewControllerContext.swift in Sources */ = {isa = PBXBuildFile; fileRef = 6698FC13297F38BB004EFC30 /* ViewControllerContext.swift */; };
 		66AE57802984AB9F00E40CFA /* ToyExample.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AE577E2984AB8700E40CFA /* ToyExample.swift */; };
 		66AF4D7328D1377E008A156E /* SignalAttachment+VideoSegmenting.swift in Sources */ = {isa = PBXBuildFile; fileRef = 66AF4D7228D1377E008A156E /* SignalAttachment+VideoSegmenting.swift */; };
@@ -3340,6 +3344,10 @@
 		66A1DF74298C73D900C4E4A7 /* RegistrationServiceResponses.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RegistrationServiceResponses.swift; sourceTree = "<group>"; };
 		66A22C0828A18D49007CD4F5 /* RingerSwitch.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RingerSwitch.swift; sourceTree = "<group>"; };
 		66A93A7F29940A8200FA0291 /* RegistrationCoordinatorImpl+Service.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = "RegistrationCoordinatorImpl+Service.swift"; sourceTree = "<group>"; };
+		66AAC2C329CB6F1100566AD6 /* RegistrationChangeNumberSplashViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RegistrationChangeNumberSplashViewController.swift; sourceTree = "<group>"; };
+		66AAC2C529CB942F00566AD6 /* RegistrationChangePhoneNumberViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RegistrationChangePhoneNumberViewController.swift; sourceTree = "<group>"; };
+		66AAC2C729CB9ED900566AD6 /* RegistrationChangePhoneNumberConfirmationViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RegistrationChangePhoneNumberConfirmationViewController.swift; sourceTree = "<group>"; };
+		66AAC2C929CBC07300566AD6 /* RegistrationPhoneNumberViewState.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = RegistrationPhoneNumberViewState.swift; sourceTree = "<group>"; };
 		66AE577E2984AB8700E40CFA /* ToyExample.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ToyExample.swift; sourceTree = "<group>"; };
 		66AF4D7228D1377E008A156E /* SignalAttachment+VideoSegmenting.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = "SignalAttachment+VideoSegmenting.swift"; sourceTree = "<group>"; };
 		66B8B27F28C94C0F005EAFE0 /* DelegatingContextMenuButton.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = DelegatingContextMenuButton.swift; sourceTree = "<group>"; };
@@ -5024,11 +5032,15 @@
 				34404274273C0E41008C9FA4 /* Deprecated_RegistrationPinAttemptsExhaustedViewController.swift */,
 				34ACA7EC2733161000E47AD4 /* Deprecated_RegistrationVerificationViewController.swift */,
 				F9480120299E89F8005442BE /* RegistrationCaptchaViewController.swift */,
+				66AAC2C329CB6F1100566AD6 /* RegistrationChangeNumberSplashViewController.swift */,
+				66AAC2C729CB9ED900566AD6 /* RegistrationChangePhoneNumberConfirmationViewController.swift */,
+				66AAC2C529CB942F00566AD6 /* RegistrationChangePhoneNumberViewController.swift */,
 				F92E4C73299E9A0100C6E6C7 /* RegistrationLoadingViewController.swift */,
 				F9D5C39E2993F9FF004891FC /* RegistrationPermissionsViewController.swift */,
 				F905DFEA29A534F200BAD034 /* RegistrationPhoneNumberDiscoverabilityViewController.swift */,
 				F9198484299AA7FC007FD5E4 /* RegistrationPhoneNumberInputView.swift */,
 				F95A64F429959065007FDBDF /* RegistrationPhoneNumberViewController.swift */,
+				66AAC2C929CBC07300566AD6 /* RegistrationPhoneNumberViewState.swift */,
 				F9E3006029A02D8800DCA219 /* RegistrationPinViewController.swift */,
 				F9EECB00299EC9D8005FDD52 /* RegistrationProfileViewController.swift */,
 				F9440E7129C0FA490016FE95 /* RegistrationReglockTimeoutViewController.swift */,
@@ -11368,6 +11380,9 @@
 				88B688B0238F0D1000286F82 /* ReactionsDetailSheet.swift in Sources */,
 				8809CE8A22F93C2200D38867 /* RecentPhotoCollectionView.swift in Sources */,
 				F9480121299E89F8005442BE /* RegistrationCaptchaViewController.swift in Sources */,
+				66AAC2C429CB6F1100566AD6 /* RegistrationChangeNumberSplashViewController.swift in Sources */,
+				66AAC2C829CB9ED900566AD6 /* RegistrationChangePhoneNumberConfirmationViewController.swift in Sources */,
+				66AAC2C629CB942F00566AD6 /* RegistrationChangePhoneNumberViewController.swift in Sources */,
 				6600F39629919ECC00B1EDB7 /* RegistrationCoodinatorShims.swift in Sources */,
 				66E3C8F62994634E00BB38ED /* RegistrationCoordinator.swift in Sources */,
 				66F0F1DF29C12363008C0ECE /* RegistrationCoordinatorDependencies.swift in Sources */,
@@ -11381,6 +11396,7 @@
 				F905DFEB29A534F200BAD034 /* RegistrationPhoneNumberDiscoverabilityViewController.swift in Sources */,
 				F9198485299AA7FC007FD5E4 /* RegistrationPhoneNumberInputView.swift in Sources */,
 				F95A64F529959065007FDBDF /* RegistrationPhoneNumberViewController.swift in Sources */,
+				66AAC2CA29CBC07300566AD6 /* RegistrationPhoneNumberViewState.swift in Sources */,
 				F9E3006129A02D8800DCA219 /* RegistrationPinViewController.swift in Sources */,
 				F9EECB01299EC9D8005FDD52 /* RegistrationProfileViewController.swift in Sources */,
 				F9440E7229C0FA490016FE95 /* RegistrationReglockTimeoutViewController.swift in Sources */,
diff --git a/Signal/Registration/RegistrationCoordinator.swift b/Signal/Registration/RegistrationCoordinator.swift
index ddbfae2a4f7..6f70a4f44db 100644
--- a/Signal/Registration/RegistrationCoordinator.swift
+++ b/Signal/Registration/RegistrationCoordinator.swift
@@ -37,6 +37,11 @@ public protocol RegistrationCoordinator {
     /// but which attached metadata giving more info on the rejection.
     func requestPermissions() -> Guarantee<RegistrationStep>
 
+    /// Submit an e164 to confirm for change number, returning the next step to take.
+    /// If the e164 is rejected for any reason, the next step will be the same current step
+    /// but with attached metadata giving more info on the rejection.
+    func submitProspectiveChangeNumberE164(_ e164: E164) -> Guarantee<RegistrationStep>
+
     /// Submit an e164 to use, returning the next step to take.
     /// If the e164 is rejected for any reason, the next step will be the same current step
     /// but with attached metadata giving more info on the rejection.
diff --git a/Signal/Registration/RegistrationCoordinatorImpl.swift b/Signal/Registration/RegistrationCoordinatorImpl.swift
index 93a927ce0c6..206f0095dd8 100644
--- a/Signal/Registration/RegistrationCoordinatorImpl.swift
+++ b/Signal/Registration/RegistrationCoordinatorImpl.swift
@@ -101,6 +101,11 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
             }
     }
 
+    public func submitProspectiveChangeNumberE164(_ e164: E164) -> Guarantee<RegistrationStep> {
+        self.inMemoryState.changeNumberProspectiveE164 = e164
+        return nextStep()
+    }
+
     public func submitE164(_ e164: E164) -> Guarantee<RegistrationStep> {
         db.write { tx in
             updatePersistedState(tx) {
@@ -124,6 +129,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
             loadkbsAuthCredentialCandidates(tx)
         }
         inMemoryState.hasEnteredE164 = false
+        inMemoryState.changeNumberProspectiveE164 = nil
         return nextStep()
     }
 
@@ -352,6 +358,11 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
         // we get to that step without asking again.
         var hasEnteredE164 = false
 
+        // When changing number, we ask the user to confirm old number and
+        // enter the new number before confirming the new number.
+        // This tracks that first check before the confirm.
+        var changeNumberProspectiveE164: E164?
+
         var shouldRestoreKBSMasterKeyAfterRegistration = false
         // base64 encoded data
         var regRecoveryPw: String?
@@ -443,9 +454,9 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
     /// Note: `mode` is kept separate; it has a different lifecycle than the rest
     /// of PersistedState even though it is also persisted to disk.
     private struct PersistedState: Codable {
-        /// We only ever want to show the splash once, and only
-        /// for flows possible from new devices.
+        /// We only ever want to show the splash once.
         var hasShownSplash = false
+        var shouldSkipRegistrationSplash = false
 
         /// The e164 the user has entered for this attempt at registration.
         /// Initially the e164 in the UI may be pre-populated (e.g. in re-reg)
@@ -625,37 +636,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
 
         return Guarantee.when(resolved: sessionGuarantee, permissionsGuarantee).asVoid()
             .done(on: schedulers.main) { [weak self] in
-                defer {
-                    self?.inMemoryState.hasRestoredState = true
-                }
-
-                if self?.persistedState.hasShownSplash == false {
-                    var showSplashIfUnshown: Bool
-                    switch self?.mode {
-                    case .reRegistering, .changingNumber:
-                        // For these flows starting from a registered client,
-                        // don't show the splash.
-                        showSplashIfUnshown = false
-                    case .none, .registering:
-                        showSplashIfUnshown = true
-                    }
-                    if self?.inMemoryState.regRecoveryPw != nil {
-                        // If we have a reg recovery pw, it means either
-                        // this is re-reg on a device that already had it,
-                        // or we got past the splash already anyway.
-                        showSplashIfUnshown = false
-                    }
-                    if !showSplashIfUnshown {
-                        // If we won't show it, set it as "shown".
-                        // It was "shown" on this device before we even
-                        // started registration.
-                        self?.db.write { tx in
-                            self?.updatePersistedState(tx) {
-                                $0.hasShownSplash = true
-                            }
-                        }
-                    }
-                }
+                self?.inMemoryState.hasRestoredState = true
             }
     }
 
@@ -801,7 +782,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
     }
 
     private func getPathway() -> Pathway {
-        if !persistedState.hasShownSplash || inMemoryState.needsSomePermissions {
+        if splashStepToShow() != nil || inMemoryState.needsSomePermissions {
             return .opening
         }
         if let session = inMemoryState.session {
@@ -871,8 +852,8 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
     // MARK: - Opening Pathway
 
     private func nextStepForOpeningPath() -> Guarantee<RegistrationStep> {
-        if persistedState.hasShownSplash.negated {
-            return .value(.splash)
+        if let splashStep = splashStepToShow() {
+            return .value(splashStep)
         }
         if inMemoryState.needsSomePermissions {
             // This class is only used for primary device registration
@@ -882,10 +863,24 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
         if inMemoryState.hasEnteredE164, let e164 = persistedState.e164 {
             return self.startSession(e164: e164)
         }
-        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-            mode: phoneNumberEntryStateMode(),
-            validationError: nil
-        )))
+        return .value(.phoneNumberEntry(phoneNumberEntryState()))
+    }
+
+    private func splashStepToShow() -> RegistrationStep? {
+        if persistedState.hasShownSplash {
+            return nil
+        }
+        switch mode {
+        case .registering:
+            if persistedState.shouldSkipRegistrationSplash {
+                return nil
+            }
+            return .splash
+        case .changingNumber:
+            return .changeNumberSplash
+        case .reRegistering:
+            return nil
+        }
     }
 
     // MARK: - Registration Recovery Password Pathway
@@ -896,10 +891,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
     private func nextStepForRegRecoveryPasswordPath(regRecoveryPw: String) -> Guarantee<RegistrationStep> {
         // We need a phone number to proceed; ask the user if unavailable.
         guard let e164 = persistedState.e164 else {
-            return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                mode: phoneNumberEntryStateMode(),
-                validationError: nil
-            )))
+            return .value(.phoneNumberEntry(phoneNumberEntryState()))
         }
 
         guard let pinFromUser = inMemoryState.pinFromUser else {
@@ -1107,7 +1099,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                 case .success:
                     // This step also backs up, no need to do that again later.
                     self.inMemoryState.hasBackedUpToKBS = true
-                    self.db.read { self.loadLocalMasterKey($0) }
+                    self.db.write { self.loadLocalMasterKey($0) }
                     return self.nextStep()
                 case let .invalidPin(remainingAttempts):
                     return .value(.pinEntry(RegistrationPinState(
@@ -1143,9 +1135,13 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
             }
     }
 
-    private func loadLocalMasterKey(_ tx: DBReadTransaction) {
+    private func loadLocalMasterKey(_ tx: DBWriteTransaction) {
         // The hex vs base64 different here is intentional.
-        inMemoryState.regRecoveryPw = deps.kbs.data(for: .registrationRecoveryPassword, transaction: tx)?.base64EncodedString()
+        let regRecoveryPw = deps.kbs.data(for: .registrationRecoveryPassword, transaction: tx)?.base64EncodedString()
+        inMemoryState.regRecoveryPw = regRecoveryPw
+        if regRecoveryPw != nil {
+            updatePersistedState(tx) { $0.shouldSkipRegistrationSplash = true }
+        }
         inMemoryState.reglockToken = deps.kbs.data(for: .registrationLock, transaction: tx)?.hexadecimalString
         // If we have a local master key, theres no need to restore after registration.
         // (we will still back up though)
@@ -1161,10 +1157,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
         guard let e164 = persistedState.e164 else {
             // If we haven't entered a phone number but we have auth
             // credential candidates to check, enter it now.
-            return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                mode: phoneNumberEntryStateMode(),
-                validationError: nil
-            )))
+            return .value(.phoneNumberEntry(phoneNumberEntryState()))
         }
         // Check the candidates.
         return makeKBSAuthCredentialCheckRequest(
@@ -1318,9 +1311,8 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                             validationError: .smsResendTimeout
                         )))
                     } else if let nextSMSDate = session.nextSMSDate {
-                        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                            mode: self.phoneNumberEntryStateMode(),
-                            validationError: .rateLimited(expiration: nextSMSDate)
+                        return .value(.phoneNumberEntry(phoneNumberEntryState(
+                            validationError: .rateLimited(.init(expiration: nextSMSDate))
                         )))
                     } else {
                         return .value(.showErrorSheet(.verificationCodeSubmissionUnavailable))
@@ -1335,9 +1327,8 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                             validationError: .voiceResendTimeout
                         )))
                     } else if let nextSMSDate = session.nextSMSDate {
-                        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                            mode: self.phoneNumberEntryStateMode(),
-                            validationError: .rateLimited(expiration: nextSMSDate)
+                        return .value(.phoneNumberEntry(phoneNumberEntryState(
+                            validationError: .rateLimited(.init(expiration: nextSMSDate))
                         )))
                     } else {
                         return .value(.showErrorSheet(.verificationCodeSubmissionUnavailable))
@@ -1355,10 +1346,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
 
         // Otherwise we have no code awaiting submission and aren't
         // trying to send one yet, so just go to phone number entry.
-        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-            mode: phoneNumberEntryStateMode(),
-            validationError: nil
-        )))
+        return .value(.phoneNumberEntry(phoneNumberEntryState()))
     }
 
     private func processSession(_ session: RegistrationSession?, _ transaction: DBWriteTransaction) {
@@ -1536,9 +1524,8 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
 
                         return strongSelf.nextStep()
                     case .invalidArgument:
-                        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                            mode: strongSelf.phoneNumberEntryStateMode(),
-                            validationError: .invalidNumber(invalidE164: e164)
+                        return .value(.phoneNumberEntry(strongSelf.phoneNumberEntryState(
+                            validationError: .invalidNumber(.init(invalidE164: e164))
                         )))
                     case .retryAfter(let timeInterval):
                         if timeInterval < Constants.autoRetryInterval {
@@ -1553,9 +1540,10 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                                     )
                                 }
                         }
-                        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                            mode: strongSelf.phoneNumberEntryStateMode(),
-                            validationError: .rateLimited(expiration: strongSelf.deps.dateProvider().addingTimeInterval(timeInterval))
+                        return .value(.phoneNumberEntry(strongSelf.phoneNumberEntryState(
+                            validationError: .rateLimited(.init(
+                                expiration: strongSelf.deps.dateProvider().addingTimeInterval(timeInterval))
+                            )
                         )))
                     case .networkFailure:
                         if retriesLeft > 0 {
@@ -1649,10 +1637,11 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
                         )))
                     } else if let timeInterval {
                         // We were trying to resend from the phone number screen.
-                        return .value(.phoneNumberEntry(RegistrationPhoneNumberState(
-                            mode: self.phoneNumberEntryStateMode(),
-                            validationError: .rateLimited(expiration: self.deps.dateProvider().addingTimeInterval(timeInterval))
-                        )))
+                        return .value(.phoneNumberEntry(self.phoneNumberEntryState(
+                            validationError: .rateLimited(.init(
+                                expiration: self.deps.dateProvider().addingTimeInterval(timeInterval)
+                            )
+                        ))))
                     } else {
                         // Can't send a code, session is useless.
                         self.db.write { self.resetSession($0) }
@@ -2419,7 +2408,7 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
             reglockToken = token
         } else {
             // Try loading from KBS.
-            db.read { tx in
+            db.write { tx in
                 loadLocalMasterKey(tx)
             }
             reglockToken = inMemoryState.reglockToken
@@ -2845,14 +2834,49 @@ public class RegistrationCoordinatorImpl: RegistrationCoordinator {
 
     // MARK: - Step State Generation Helpers
 
-    private func phoneNumberEntryStateMode() -> RegistrationPhoneNumberState.RegistrationPhoneNumberMode {
+    private func phoneNumberEntryState(
+        validationError: RegistrationPhoneNumberViewState.ValidationError? = nil
+    ) -> RegistrationPhoneNumberViewState {
         switch mode {
         case .registering:
-            return .initialRegistration(previouslyEnteredE164: persistedState.e164)
+            return .registration(.initialRegistration(.init(
+                previouslyEnteredE164: persistedState.e164,
+                validationError: validationError
+            )))
         case .reRegistering(let state):
-            return .reregistration(e164: state.e164)
+            return .registration(.reregistration(.init(
+                e164: state.e164,
+                validationError: validationError
+            )))
         case .changingNumber(let state):
-            return .changingPhoneNumber(oldE164: state.oldE164)
+            var rateLimitedError: RegistrationPhoneNumberViewState.ValidationError.RateLimited?
+            switch validationError {
+            case .none:
+                break
+            case .rateLimited(let error):
+                rateLimitedError = error
+            case .invalidNumber(let invalidNumberError):
+                return .changingNumber(.initialEntry(.init(
+                    oldE164: state.oldE164,
+                    newE164: inMemoryState.changeNumberProspectiveE164,
+                    hasConfirmed: inMemoryState.changeNumberProspectiveE164 != nil,
+                    invalidNumberError: invalidNumberError
+                )))
+            }
+            if let newE164 = inMemoryState.changeNumberProspectiveE164 {
+                return .changingNumber(.confirmation(.init(
+                    oldE164: state.oldE164,
+                    newE164: newE164,
+                    rateLimitedError: rateLimitedError
+                )))
+            } else {
+                return .changingNumber(.initialEntry(.init(
+                    oldE164: state.oldE164,
+                    newE164: nil,
+                    hasConfirmed: false,
+                    invalidNumberError: nil
+                )))
+            }
         }
     }
 
diff --git a/Signal/Registration/RegistrationStep.swift b/Signal/Registration/RegistrationStep.swift
index 19bef36589b..29966a6f23e 100644
--- a/Signal/Registration/RegistrationStep.swift
+++ b/Signal/Registration/RegistrationStep.swift
@@ -9,6 +9,7 @@ public enum RegistrationStep: Equatable {
 
     // MARK: - Opening Steps
     case splash
+    case changeNumberSplash
     case permissions(RegistrationPermissionsState)
 
     // MARK: - Actually registering
@@ -18,7 +19,7 @@ public enum RegistrationStep: Equatable {
     /// the user to confirm the number at least once before proceeding.
     /// The number may be used to send an SMS or as a way to identify the
     /// account being registered for via KBS backup info.
-    case phoneNumberEntry(RegistrationPhoneNumberState)
+    case phoneNumberEntry(RegistrationPhoneNumberViewState)
 
     /// If registering via session, the step to enter the verification code.
     case verificationCodeEntry(RegistrationVerificationState)
diff --git a/Signal/Registration/ViewControllers/RegistrationNavigationController.swift b/Signal/Registration/ViewControllers/RegistrationNavigationController.swift
index 1b1f66c0502..5fdfc86c03b 100644
--- a/Signal/Registration/ViewControllers/RegistrationNavigationController.swift
+++ b/Signal/Registration/ViewControllers/RegistrationNavigationController.swift
@@ -132,6 +132,15 @@ public class RegistrationNavigationController: OWSNavigationController {
                 // No state to update.
                 update: nil
             )
+        case .changeNumberSplash:
+            return Controller(
+                type: RegistrationChangeNumberSplashViewController.self,
+                make: { presenter in
+                    return RegistrationChangeNumberSplashViewController(presenter: presenter)
+                },
+                // No state to update.
+                update: nil
+            )
         case .permissions(let state):
             return Controller(
                 type: RegistrationPermissionsViewController.self,
@@ -144,16 +153,50 @@ public class RegistrationNavigationController: OWSNavigationController {
                 update: nil
             )
         case .phoneNumberEntry(let state):
-            return Controller(
-                type: RegistrationPhoneNumberViewController.self,
-                make: { presenter in
-                    return RegistrationPhoneNumberViewController(state: state, presenter: presenter)
-                },
-                update: { controller in
-                    controller.updateState(state)
-                    return nil
+            switch state {
+            case .registration(let registrationMode):
+                return Controller(
+                    type: RegistrationPhoneNumberViewController.self,
+                    make: { presenter in
+                        return RegistrationPhoneNumberViewController(state: registrationMode, presenter: presenter)
+                    },
+                    update: { controller in
+                        controller.updateState(registrationMode)
+                        return nil
+                    }
+                )
+            case .changingNumber(let changingNumberMode):
+                switch changingNumberMode {
+                case .initialEntry(let initialEntryState):
+                    return Controller(
+                        type: RegistrationChangePhoneNumberViewController.self,
+                        make: { presenter in
+                            return RegistrationChangePhoneNumberViewController(
+                                state: initialEntryState,
+                                presenter: presenter
+                            )
+                        },
+                        update: { controller in
+                            controller.updateState(initialEntryState)
+                            return nil
+                        }
+                    )
+                case .confirmation(let confirmationState):
+                    return Controller(
+                        type: RegistrationChangePhoneNumberConfirmationViewController.self,
+                        make: { presenter in
+                            return RegistrationChangePhoneNumberConfirmationViewController(
+                                state: confirmationState,
+                                presenter: presenter
+                            )
+                        },
+                        update: { controller in
+                            controller.updateState(confirmationState)
+                            return nil
+                        }
+                    )
                 }
-            )
+            }
         case .verificationCodeEntry(let state):
             return Controller(
                 type: RegistrationVerificationViewController.self,
@@ -299,6 +342,19 @@ extension RegistrationNavigationController: RegistrationPhoneNumberPresenter {
     }
 }
 
+extension RegistrationNavigationController: RegistrationChangePhoneNumberPresenter {
+    func submitProspectiveChangeNumberE164(newE164: E164) {
+        pushNextController(coordinator.submitProspectiveChangeNumberE164(newE164), loadingMode: .submittingPhoneNumber(e164: newE164.stringValue))
+    }
+}
+
+extension RegistrationNavigationController: RegistrationChangePhoneNumberConfirmationPresenter {
+
+    func confirmChangeNumber(newE164: E164) {
+        pushNextController(coordinator.submitE164(newE164), loadingMode: .submittingPhoneNumber(e164: newE164.stringValue))
+    }
+}
+
 extension RegistrationNavigationController: RegistrationCaptchaPresenter {
 
     func submitCaptcha(_ token: String) {
diff --git a/Signal/src/ViewControllers/Registration/ChangePhoneNumber/Deprecated_ChangePhoneNumberInputViewController.swift b/Signal/src/ViewControllers/Registration/ChangePhoneNumber/Deprecated_ChangePhoneNumberInputViewController.swift
index ddd96cbf584..c4483bfaf57 100644
--- a/Signal/src/ViewControllers/Registration/ChangePhoneNumber/Deprecated_ChangePhoneNumberInputViewController.swift
+++ b/Signal/src/ViewControllers/Registration/ChangePhoneNumber/Deprecated_ChangePhoneNumberInputViewController.swift
@@ -89,7 +89,7 @@ class Deprecated_ChangePhoneNumberInputViewController: OWSTableViewController2 {
             self?.showCountryCodePicker(valueViews: valueViews)
         })
         section.add(.item(name: NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_PHONE_NUMBER_FIELD",
-                                                  comment: "Label for the 'country code' row in the 'change phone number' settings."),
+                                                  comment: "Label for the 'phone number' row in the 'change phone number' settings."),
                           textColor: Theme.primaryTextColor,
                           accessoryView: valueViews.phoneNumberTextField,
                           accessibilityIdentifier: valueViews.accessibilityIdentifier_CountryCode))
diff --git a/Signal/src/ViewControllers/Registration/RegistrationChangeNumberSplashViewController.swift b/Signal/src/ViewControllers/Registration/RegistrationChangeNumberSplashViewController.swift
new file mode 100644
index 00000000000..ca7ef899ffa
--- /dev/null
+++ b/Signal/src/ViewControllers/Registration/RegistrationChangeNumberSplashViewController.swift
@@ -0,0 +1,138 @@
+//
+// Copyright 2023 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import Foundation
+import SignalServiceKit
+import UIKit
+import SignalMessaging
+
+class RegistrationChangeNumberSplashViewController: OWSViewController, OWSNavigationChildController {
+
+    private weak var presenter: RegistrationSplashPresenter?
+
+    public init(presenter: RegistrationSplashPresenter) {
+        self.presenter = presenter
+        super.init()
+    }
+
+    public var preferredNavigationBarStyle: OWSNavigationBarStyle {
+        return .solid
+    }
+
+    public var navbarBackgroundColorOverride: UIColor? {
+        return view.backgroundColor
+    }
+
+    private let bottomContainer = UIView()
+    private let scrollingStack = UIStackView()
+
+    override func viewDidLoad() {
+        super.viewDidLoad()
+
+        navigationItem.setHidesBackButton(true, animated: false)
+
+        createContents()
+    }
+
+    private func createContents() {
+        let scrollView = UIScrollView()
+        view.addSubview(scrollView)
+        scrollView.autoPinEdge(toSuperviewSafeArea: .leading)
+        scrollView.autoPinEdge(toSuperviewSafeArea: .trailing)
+        scrollView.autoPin(toTopLayoutGuideOf: self, withInset: 0)
+
+        scrollingStack.axis = .vertical
+        scrollingStack.alignment = .fill
+        scrollingStack.isLayoutMarginsRelativeArrangement = true
+        scrollingStack.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
+        scrollView.addSubview(scrollingStack)
+        scrollingStack.autoMatch(.width, to: .width, of: scrollView)
+        scrollingStack.autoPinEdgesToSuperviewEdges()
+
+        bottomContainer.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
+        view.addSubview(bottomContainer)
+        bottomContainer.autoPinEdge(toSuperviewSafeArea: .leading)
+        bottomContainer.autoPinEdge(toSuperviewSafeArea: .trailing)
+        bottomContainer.autoPinEdge(.top, to: .bottom, of: scrollView)
+        bottomContainer.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+
+        updateContents()
+    }
+
+    public override func themeDidChange() {
+        super.themeDidChange()
+
+        updateContents()
+    }
+
+    private func updateContents() {
+        view.backgroundColor = OWSTableViewController2.tableBackgroundColor(isUsingPresentedStyle: true)
+        owsNavigationController?.updateNavbarAppearance()
+
+        let heroImageName = (Theme.isDarkThemeEnabled
+                             ? "change-number-dark-40"
+                             : "change-number-light-40")
+        let heroImage = UIImage(named: heroImageName)
+        let heroImageView = UIImageView(image: heroImage)
+        heroImageView.autoSetDimension(.width, toSize: 80, relation: .lessThanOrEqual)
+        heroImageView.autoSetDimension(.height, toSize: 80, relation: .lessThanOrEqual)
+        let heroCircleView = OWSLayerView.circleView(size: 112)
+        heroCircleView.backgroundColor = (Theme.isDarkThemeEnabled
+                                          ? UIColor.ows_white
+                                          : UIColor.ows_black).withAlphaComponent(0.05)
+        heroCircleView.addSubview(heroImageView)
+        heroImageView.autoCenterInSuperview()
+        let heroStack = UIStackView(arrangedSubviews: [heroCircleView])
+        heroStack.axis = .vertical
+        heroStack.alignment = .center
+
+        let titleLabel = UILabel()
+        titleLabel.text = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_SPLASH_TITLE",
+                                            comment: "Title text in the 'change phone number splash' view.")
+        titleLabel.font = .ows_dynamicTypeTitle2.ows_semibold
+        titleLabel.textColor = Theme.primaryTextColor
+        titleLabel.textAlignment = .center
+        titleLabel.numberOfLines = 0
+        titleLabel.lineBreakMode = .byWordWrapping
+
+        let descriptionLabel = UILabel()
+        descriptionLabel.text = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_SPLASH_DESCRIPTION",
+                                            comment: "Description text in the 'change phone number splash' view.")
+        descriptionLabel.font = .ows_dynamicTypeBody
+        descriptionLabel.textColor = Theme.secondaryTextAndIconColor
+        descriptionLabel.textAlignment = .center
+        descriptionLabel.numberOfLines = 0
+        descriptionLabel.lineBreakMode = .byWordWrapping
+
+        let continueButton = OWSFlatButton.button(title: CommonStrings.continueButton,
+                                                  font: UIFont.ows_dynamicTypeBody.ows_semibold,
+                                                  titleColor: .ows_white,
+                                                  backgroundColor: .ows_accentBlue,
+                                                  target: self,
+                                                  selector: #selector(didTapContinue))
+        continueButton.autoSetHeightUsingFont()
+        continueButton.cornerRadius = 8
+
+        scrollingStack.removeAllSubviews()
+        scrollingStack.addArrangedSubviews([
+            UIView.spacer(withHeight: 40),
+            heroStack,
+            UIView.spacer(withHeight: 24),
+            titleLabel,
+            UIView.spacer(withHeight: 12),
+            descriptionLabel,
+            UIView.vStretchingSpacer(minHeight: 16)
+        ])
+
+        bottomContainer.removeAllSubviews()
+        bottomContainer.addSubview(continueButton)
+        continueButton.autoPinEdgesToSuperviewMargins()
+    }
+
+    @objc
+    private func didTapContinue(_ sender: UIButton) {
+        presenter?.continueFromSplash()
+    }
+}
diff --git a/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberConfirmationViewController.swift b/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberConfirmationViewController.swift
new file mode 100644
index 00000000000..4bc70aea067
--- /dev/null
+++ b/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberConfirmationViewController.swift
@@ -0,0 +1,210 @@
+//
+// Copyright 2023 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import Foundation
+import SignalServiceKit
+import UIKit
+import SignalMessaging
+import SignalUI
+
+// MARK: - RegistrationChangePhoneNumberConfirmationPresenter
+
+protocol RegistrationChangePhoneNumberConfirmationPresenter: AnyObject {
+    func confirmChangeNumber(newE164: E164)
+
+    func returnToPhoneNumberEntry()
+}
+
+// MARK: - RegistrationChangePhoneNumberConfirmationViewController
+
+class RegistrationChangePhoneNumberConfirmationViewController: OWSViewController, OWSNavigationChildController {
+
+    public var preferredNavigationBarStyle: OWSNavigationBarStyle {
+        return .solid
+    }
+
+    public var navbarBackgroundColorOverride: UIColor? {
+        return view.backgroundColor
+    }
+
+    private var state: RegistrationPhoneNumberViewState.ChangeNumberConfirmation
+    private weak var presenter: RegistrationChangePhoneNumberConfirmationPresenter?
+
+    private let rootView = UIStackView()
+
+    public init(
+        state: RegistrationPhoneNumberViewState.ChangeNumberConfirmation,
+        presenter: RegistrationChangePhoneNumberConfirmationPresenter
+    ) {
+        self.state = state
+        self.presenter = presenter
+        super.init()
+    }
+
+    public func updateState(_ state: RegistrationPhoneNumberViewState.ChangeNumberConfirmation) {
+        self.state = state
+        updateContents()
+    }
+
+    override func viewDidLoad() {
+        super.viewDidLoad()
+
+        title = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_VIEW_TITLE",
+                                  comment: "Title for the 'change phone number' views in settings.")
+
+        createContents()
+    }
+
+    private var rateLimitErrorTimer: Timer?
+
+    override func viewWillAppear(_ animated: Bool) {
+        super.viewWillAppear(animated)
+
+        updateContents()
+
+        // We only need this timer if the user has been rate limited, but it's simpler to always
+        // start it.
+        rateLimitErrorTimer = Timer.scheduledTimer(withTimeInterval: 1, repeats: true) { [weak self] _ in
+            self?.updateContents()
+        }
+    }
+
+    override func viewDidDisappear(_ animated: Bool) {
+        super.viewDidDisappear(animated)
+
+        rateLimitErrorTimer?.invalidate()
+        rateLimitErrorTimer = nil
+    }
+
+    private func createContents() {
+        rootView.axis = .vertical
+        rootView.alignment = .fill
+        rootView.isLayoutMarginsRelativeArrangement = true
+        rootView.layoutMargins = UIEdgeInsets(hMargin: 20, vMargin: 0)
+        view.addSubview(rootView)
+        rootView.autoPinEdge(toSuperviewSafeArea: .leading)
+        rootView.autoPinEdge(toSuperviewSafeArea: .trailing)
+        rootView.autoPin(toTopLayoutGuideOf: self, withInset: 0)
+        rootView.autoPinEdge(.bottom, to: .bottom, of: keyboardLayoutGuideViewSafeArea)
+
+        updateContents()
+    }
+
+    public override func themeDidChange() {
+        super.themeDidChange()
+
+        updateContents()
+    }
+
+    private func updateContents() {
+        view.backgroundColor = OWSTableViewController2.tableBackgroundColor(isUsingPresentedStyle: true)
+
+        let descriptionFormat = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_CONFIRM_DESCRIPTION_FORMAT",
+                                                  comment: "Format for the description text in the 'change phone number splash' view. Embeds: {{ %1$@ the old phone number, %2$@ the new phone number }}.")
+        let oldPhoneNumberFormatted = PhoneNumber.bestEffortLocalizedPhoneNumber(withE164: state.oldE164.stringValue)
+        let newPhoneNumberFormatted = PhoneNumber.bestEffortLocalizedPhoneNumber(withE164: state.newE164.stringValue)
+        let descriptionText = String(
+            format: descriptionFormat,
+            oldPhoneNumberFormatted,
+            newPhoneNumberFormatted
+        )
+        let descriptionAttributedText = NSMutableAttributedString(string: descriptionText)
+        descriptionAttributedText.setAttributes(
+            [.foregroundColor: Theme.primaryTextColor],
+            forSubstring: oldPhoneNumberFormatted
+        )
+        descriptionAttributedText.setAttributes(
+            [.foregroundColor: Theme.primaryTextColor],
+            forSubstring: newPhoneNumberFormatted
+        )
+
+        let descriptionLabel = UILabel()
+        descriptionLabel.font = .ows_dynamicTypeBody
+        descriptionLabel.textColor = Theme.secondaryTextAndIconColor
+        descriptionLabel.attributedText = descriptionAttributedText
+        descriptionLabel.textAlignment = .center
+        descriptionLabel.numberOfLines = 0
+        descriptionLabel.lineBreakMode = .byWordWrapping
+
+        let phoneNumberLabel = UILabel()
+        phoneNumberLabel.font = .ows_dynamicTypeTitle2.ows_semibold
+        phoneNumberLabel.textColor = Theme.primaryTextColor
+        phoneNumberLabel.text = newPhoneNumberFormatted
+        phoneNumberLabel.textAlignment = .center
+        let phoneNumberStack = UIStackView(arrangedSubviews: [phoneNumberLabel])
+        phoneNumberStack.axis = .vertical
+        phoneNumberStack.alignment = .center
+        phoneNumberStack.isLayoutMarginsRelativeArrangement = true
+        phoneNumberStack.layoutMargins = UIEdgeInsets(hMargin: 24, vMargin: 24)
+        let phoneNumberBackground = phoneNumberStack.addBackgroundView(withBackgroundColor: Theme.backgroundColor)
+        phoneNumberBackground.layer.cornerRadius = 10
+
+        let continueButton = OWSFlatButton.button(title: NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_CONFIRM_BUTTON",
+                                                                           comment: "Label for the 'confirm change phone number' button in the 'change phone number' views."),
+                                                  font: UIFont.ows_dynamicTypeBody.ows_semibold,
+                                                  titleColor: .ows_white,
+                                                  backgroundColor: .ows_accentBlue,
+                                                  target: self,
+                                                  selector: #selector(didTapContinue))
+        continueButton.autoSetHeightUsingFont()
+        continueButton.cornerRadius = 8
+        continueButton.setEnabled(state.rateLimitedError?.canSubmit() ?? true)
+
+        let editButton = OWSFlatButton.button(title: NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_BACK_TO_EDIT_BUTTON",
+                                                                         comment: "Label for the 'edit phone number' button in the 'change phone number' views."),
+                                                font: UIFont.ows_dynamicTypeBody,
+                                                titleColor: .ows_accentBlue,
+                                                backgroundColor: .clear,
+                                                target: self,
+                                                selector: #selector(didTapEdit))
+        editButton.autoSetHeightUsingFont()
+        editButton.cornerRadius = 8
+
+        rootView.removeAllSubviews()
+        rootView.addArrangedSubviews([
+            UIView.spacer(withHeight: 24),
+            descriptionLabel,
+            UIView.spacer(withHeight: 20),
+            phoneNumberStack
+        ])
+
+        if let warningLabelText = state.rateLimitedError?.warningLabelText() {
+            let warningLabel = UILabel()
+            warningLabel.textColor = .ows_accentRed
+            warningLabel.numberOfLines = 0
+            warningLabel.font = UIFont.ows_dynamicTypeSubheadlineClamped
+            warningLabel.accessibilityIdentifier = "registration.phonenumber.validationWarningLabel"
+            warningLabel.text = warningLabelText
+
+            rootView.addArrangedSubview(UIView.spacer(withHeight: 12))
+            rootView.addArrangedSubview(warningLabel)
+        }
+
+        rootView.addArrangedSubviews([
+            UIView.vStretchingSpacer(),
+            continueButton,
+            UIView.spacer(withHeight: 20),
+            editButton
+        ])
+    }
+
+    @objc
+    private func didTapEdit(_ sender: UIButton) {
+        AssertIsOnMainThread()
+
+        presenter?.returnToPhoneNumberEntry()
+    }
+
+    @objc
+    private func didTapContinue(_ sender: UIButton) {
+        AssertIsOnMainThread()
+
+        guard state.rateLimitedError?.canSubmit() != false else {
+            return
+        }
+
+        presenter?.confirmChangeNumber(newE164: state.newE164)
+    }
+}
diff --git a/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberViewController.swift b/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberViewController.swift
new file mode 100644
index 00000000000..6f4e4a036d8
--- /dev/null
+++ b/Signal/src/ViewControllers/Registration/RegistrationChangePhoneNumberViewController.swift
@@ -0,0 +1,522 @@
+//
+// Copyright 2023 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import Foundation
+import SignalServiceKit
+
+// MARK: - RegistrationChangePhoneNumberPresenter
+
+protocol RegistrationChangePhoneNumberPresenter: AnyObject {
+
+    func submitProspectiveChangeNumberE164(newE164: E164)
+}
+
+// MARK: - RegistrationChangePhoneNumberViewController
+
+class RegistrationChangePhoneNumberViewController: OWSTableViewController2 {
+
+    private var state: RegistrationPhoneNumberViewState.ChangeNumberInitialEntry
+    private weak var presenter: RegistrationChangePhoneNumberPresenter?
+
+    private let oldValueViews: ChangePhoneNumberValueViews
+    private let newValueViews: ChangePhoneNumberValueViews
+
+    public init(
+        state: RegistrationPhoneNumberViewState.ChangeNumberInitialEntry,
+        presenter: RegistrationChangePhoneNumberPresenter
+    ) {
+        self.state = state
+        self.presenter = presenter
+        if state.hasConfirmed {
+            self.oldValueViews = ChangePhoneNumberValueViews(e164: state.oldE164, type: .oldNumber)
+            self.newValueViews = ChangePhoneNumberValueViews(e164: state.newE164, type: .newNumber)
+        } else {
+            self.oldValueViews = ChangePhoneNumberValueViews(e164: nil, type: .oldNumber)
+            self.newValueViews = ChangePhoneNumberValueViews(e164: nil, type: .newNumber)
+        }
+
+        super.init()
+
+        oldValueViews.delegate = self
+        newValueViews.delegate = self
+    }
+
+    public func updateState(_ newState: RegistrationPhoneNumberViewState.ChangeNumberInitialEntry) {
+        self.state = newState
+        updateTableContents()
+
+        if let invalidNumberError = state.invalidNumberError {
+            showInvalidPhoneNumberAlertIfNecessary(for: invalidNumberError.invalidE164.stringValue)
+        }
+    }
+
+    private var previousInvalidE164: String?
+
+    private func showInvalidPhoneNumberAlertIfNecessary(for e164: String) {
+        let shouldShowAlert = e164 != previousInvalidE164
+        if shouldShowAlert {
+            OWSActionSheets.showActionSheet(
+                title: OWSLocalizedString(
+                    "REGISTRATION_VIEW_INVALID_PHONE_NUMBER_ALERT_TITLE",
+                    comment: "Title of alert indicating that users needs to enter a valid phone number to register."
+                ),
+                message: OWSLocalizedString(
+                    "REGISTRATION_VIEW_INVALID_PHONE_NUMBER_ALERT_MESSAGE",
+                    comment: "Message of alert indicating that users needs to enter a valid phone number to register."
+                )
+            )
+        }
+
+        previousInvalidE164 = e164
+    }
+
+    override func viewDidLoad() {
+        super.viewDidLoad()
+
+        title = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_VIEW_TITLE",
+                                  comment: "Title for the 'change phone number' views in settings.")
+
+        navigationItem.leftBarButtonItem = UIBarButtonItem(
+            barButtonSystemItem: .cancel,
+            target: self,
+            action: #selector(didPressCancel)
+        )
+
+        updateTableContents()
+    }
+
+    fileprivate func updateNavigationBar() {
+        let doneItem = UIBarButtonItem(
+            barButtonSystemItem: .done,
+            target: self,
+            action: #selector(didTapContinue)
+        )
+        navigationItem.rightBarButtonItem = doneItem
+    }
+
+    override func viewWillAppear(_ animated: Bool) {
+        super.viewWillAppear(animated)
+
+        updateTableContents()
+    }
+
+    public override func themeDidChange() {
+        super.themeDidChange()
+
+        updateTableContents()
+    }
+
+    func updateTableContents() {
+        let contents = OWSTableContents()
+
+        contents.addSection(buildTableSection(valueViews: oldValueViews))
+        contents.addSection(buildTableSection(valueViews: newValueViews))
+
+        self.contents = contents
+
+        updateNavigationBar()
+    }
+
+    fileprivate func buildTableSection(valueViews: ChangePhoneNumberValueViews) -> OWSTableSection {
+        let section = OWSTableSection()
+        section.headerTitle = valueViews.sectionHeaderTitle
+
+        let countryCodeFormat = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_COUNTRY_CODE_FORMAT",
+                                                  comment: "Format for the 'country code' in the 'change phone number' settings. Embeds: {{ %1$@ the numeric country code prefix, %2$@ the country code abbreviation }}.")
+        let countryCodeFormatted = String(format: countryCodeFormat, valueViews.callingCode, valueViews.countryCode)
+        section.add(.item(name: NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_COUNTRY_CODE_FIELD",
+                                                  comment: "Label for the 'country code' row in the 'change phone number' settings."),
+                          textColor: Theme.primaryTextColor,
+                          accessoryText: countryCodeFormatted,
+                          accessoryType: .disclosureIndicator,
+                          accessibilityIdentifier: valueViews.accessibilityIdentifier_PhoneNumber) { [weak self] in
+            self?.showCountryCodePicker(valueViews: valueViews)
+        })
+        section.add(.item(name: NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_PHONE_NUMBER_FIELD",
+                                                  comment: "Label for the 'phone number' row in the 'change phone number' settings."),
+                          textColor: Theme.primaryTextColor,
+                          accessoryView: valueViews.phoneNumberTextField,
+                          accessibilityIdentifier: valueViews.accessibilityIdentifier_CountryCode))
+
+        switch valueViews.type {
+        case .newNumber:
+            if let invalidNumberError = state.invalidNumberError {
+                section.add(.init(customCellBlock: {
+                    let cell = OWSTableItem.buildCellWithAccessoryLabel(
+                        itemName: invalidNumberError.warningLabelText,
+                        textColor: .ows_accentRed,
+                        accessoryType: .none
+                    )
+                    cell.isUserInteractionEnabled = false
+                    return cell
+                }))
+            }
+        case .oldNumber:
+            break
+        }
+
+        // The purpose of the example phone number is to indicate to the user that they should enter
+        // their phone number _without_ a country calling code (e.g. +1 or +44) but _with_ area code, etc.
+        func tryToFormatPhoneNumber(_ phoneNumber: String) -> String? {
+            guard let formatted = PhoneNumber.bestEffortFormatPartialUserSpecifiedText(toLookLikeAPhoneNumber: phoneNumber,
+                                                                                       withSpecifiedCountryCodeString: valueViews.countryCode).nilIfEmpty else {
+                owsFailDebug("Invalid phone number. phoneNumber: \(phoneNumber), callingCode: \(valueViews.callingCode).")
+                return nil
+            }
+            // Remove the "country calling code".
+            guard formatted.hasPrefix(valueViews.callingCode) else {
+                owsFailDebug("Example phone number missing calling code. phoneNumber: \(phoneNumber), callingCode: \(valueViews.callingCode).")
+                return nil
+            }
+            guard let formattedWithoutCallingCode = formatted.substring(from: valueViews.callingCode.count).nilIfEmpty else {
+                owsFailDebug("Invalid phone number. phoneNumber: \(phoneNumber), callingCode: \(valueViews.callingCode).")
+                return nil
+            }
+            return formattedWithoutCallingCode
+        }
+        if let examplePhoneNumber = phoneNumberUtil.examplePhoneNumber(forCountryCode: valueViews.countryCode),
+           let formattedPhoneNumber = tryToFormatPhoneNumber(examplePhoneNumber) {
+            let exampleFormat = NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_EXAMPLE_PHONE_NUMBER_FORMAT",
+                                                      comment: "Format for 'example phone numbers' in the 'change phone number' settings. Embeds: {{ the example phone number }}")
+            section.footerTitle = String(format: exampleFormat, formattedPhoneNumber)
+        }
+
+        return section
+    }
+
+    fileprivate func showCountryCodePicker(valueViews: ChangePhoneNumberValueViews) {
+        let countryCodeController = CountryCodeViewController()
+        countryCodeController.countryCodeDelegate = valueViews
+        countryCodeController.interfaceOrientationMask = UIDevice.current.isIPad ? .all : .portrait
+        let navigationController = OWSNavigationController(rootViewController: countryCodeController)
+        self.present(navigationController, animated: true, completion: nil)
+    }
+
+    // MARK: -
+
+    private func tryToParseNewE164() -> E164? {
+        func tryToParse(
+            _ valueViews: ChangePhoneNumberValueViews,
+            isOldValue: Bool
+        ) -> E164? {
+            switch valueViews.tryToParse() {
+            case .noNumber:
+                showInvalidPhoneNumberAlert(isOldValue: isOldValue)
+                return nil
+            case .invalidNumber:
+                showInvalidPhoneNumberAlert(isOldValue: isOldValue)
+                return nil
+            case .validNumber(let e164):
+
+                return e164
+            }
+        }
+
+        guard let oldE164 = tryToParse(oldValueViews, isOldValue: true) else {
+            return nil
+        }
+        guard let newE164 = tryToParse(newValueViews, isOldValue: false) else {
+            return nil
+        }
+
+        guard oldE164 == state.oldE164 else {
+            showIncorrectOldPhoneNumberAlert()
+            return nil
+        }
+
+        guard newE164 != state.oldE164 else {
+            showIdenticalPhoneNumbersAlert()
+            return nil
+        }
+
+        guard state.invalidNumberError?.canSubmit(e164: newE164) != false else {
+            showInvalidPhoneNumberAlert(isOldValue: false)
+            return nil
+        }
+
+        return newE164
+    }
+
+    private func tryToContinue() {
+        AssertIsOnMainThread()
+
+        guard let newE164 = tryToParseNewE164() else {
+            return
+        }
+
+        oldValueViews.phoneNumberTextField.resignFirstResponder()
+        newValueViews.phoneNumberTextField.resignFirstResponder()
+
+        presenter?.submitProspectiveChangeNumberE164(newE164: newE164)
+    }
+
+    private func showInvalidPhoneNumberAlert(isOldValue: Bool) {
+        let message = (isOldValue
+                       ? NSLocalizedString(
+                        "CHANGE_PHONE_NUMBER_INVALID_PHONE_NUMBER_ALERT_MESSAGE_OLD",
+                        comment: "Error indicating that the user's old phone number is not valid.")
+                       : NSLocalizedString(
+                        "CHANGE_PHONE_NUMBER_INVALID_PHONE_NUMBER_ALERT_MESSAGE_NEW",
+                        comment: "Error indicating that the user's new phone number is not valid."))
+        OWSActionSheets.showActionSheet(title: nil, message: message)
+    }
+
+    private func showIncorrectOldPhoneNumberAlert() {
+        let message = NSLocalizedString(
+                        "CHANGE_PHONE_NUMBER_INCORRECT_OLD_PHONE_NUMBER_ALERT_MESSAGE",
+                        comment: "Error indicating that the user's old phone number was not entered correctly.")
+        OWSActionSheets.showActionSheet(title: nil, message: message)
+    }
+
+    private func showIdenticalPhoneNumbersAlert() {
+        let message = NSLocalizedString(
+                        "CHANGE_PHONE_NUMBER_IDENTICAL_PHONE_NUMBERS_ALERT_MESSAGE",
+                        comment: "Error indicating that the user's old and new phone numbers are identical.")
+        OWSActionSheets.showActionSheet(title: nil, message: message)
+    }
+
+    // MARK: - Events
+
+    @objc
+    private func didPressCancel() {
+        AssertIsOnMainThread()
+
+        // TODO
+    }
+
+    @objc
+    private func didTapContinue() {
+        AssertIsOnMainThread()
+
+        tryToContinue()
+    }
+}
+
+// MARK: -
+
+extension RegistrationChangePhoneNumberViewController: ChangePhoneNumberValueViewsDelegate {
+    fileprivate func valueDidChange(valueViews: ChangePhoneNumberValueViews) {
+        AssertIsOnMainThread()
+
+        updateNavigationBar()
+    }
+
+    fileprivate func valueDidPressEnter(valueViews: ChangePhoneNumberValueViews) {
+    }
+
+    fileprivate func valueDidUpdateCountryState(valueViews: ChangePhoneNumberValueViews) {
+        updateTableContents()
+    }
+}
+
+// MARK: -
+
+private protocol ChangePhoneNumberValueViewsDelegate: AnyObject {
+    func valueDidChange(valueViews: ChangePhoneNumberValueViews)
+    func valueDidPressEnter(valueViews: ChangePhoneNumberValueViews)
+    func valueDidUpdateCountryState(valueViews: ChangePhoneNumberValueViews)
+}
+
+// MARK: -
+
+private class ChangePhoneNumberValueViews: NSObject {
+
+    weak var delegate: ChangePhoneNumberValueViewsDelegate?
+
+    var phoneNumber: RegistrationPhoneNumber
+
+    enum `Type` {
+        case oldNumber
+        case newNumber
+    }
+
+    fileprivate let type: `Type`
+
+    public init(e164: E164?, type: `Type`) {
+        if let e164, let number = RegistrationPhoneNumber(e164: e164) {
+            self.phoneNumber = number
+        } else {
+            self.phoneNumber = RegistrationPhoneNumber(countryState: .defaultValue, nationalNumber: "")
+        }
+        self.type = type
+
+        super.init()
+
+        phoneNumberTextField.accessibilityIdentifier = self.accessibilityIdentifier_PhoneNumberTextfield
+        phoneNumberTextField.delegate = self
+        phoneNumberTextField.addTarget(self, action: #selector(textFieldDidChange), for: .editingChanged)
+        phoneNumberTextField.addTarget(self, action: #selector(textFieldDidChange), for: .editingDidBegin)
+        phoneNumberTextField.addTarget(self, action: #selector(textFieldDidChange), for: .editingDidEnd)
+
+        phoneNumberString = phoneNumber.nationalNumber
+    }
+
+    var countryState: RegistrationCountryState {
+        get {
+            return phoneNumber.countryState
+        }
+        set {
+            phoneNumber = RegistrationPhoneNumber(countryState: newValue, nationalNumber: phoneNumber.nationalNumber)
+        }
+    }
+
+    var countryName: String { countryState.countryName }
+    var callingCode: String { countryState.callingCode }
+    var countryCode: String { countryState.countryCode }
+
+    private enum InlineError {
+        case invalidNumber
+        case rateLimit(expiration: Date)
+    }
+
+    private var phoneNumberError: InlineError?
+
+    var phoneNumberString: String? {
+        get { phoneNumberTextField.text }
+        set {
+            phoneNumberTextField.text = newValue
+            applyPhoneNumberFormatting()
+        }
+    }
+
+    let phoneNumberTextField: UITextField = {
+        let field = UITextField()
+        field.font = UIFont.ows_dynamicTypeBodyClamped
+        field.textColor = Theme.primaryTextColor
+        field.textAlignment = (CurrentAppContext().isRTL
+                               ? .left
+                               : .right)
+        field.textContentType = .telephoneNumber
+
+        // There's a bug in iOS 13 where predictions aren't provided for .numberPad
+        // keyboard types. Leaving as number pad for now, but if we want to support
+        // autofill at the expense of a less appropriate keyboard, here's where it'd
+        // be done. See Wisors comment here:
+        // https://developer.apple.com/forums/thread/120703
+        if #available(iOS 14, *) {
+            field.keyboardType = .numberPad
+        } else if #available(iOS 13, *) {
+            field.keyboardType = .numberPad // .numbersAndPunctuation
+        } else {
+            field.keyboardType = .numberPad
+        }
+
+        field.placeholder = NSLocalizedString(
+            "ONBOARDING_PHONE_NUMBER_PLACEHOLDER",
+            comment: "Placeholder string for phone number field during registration")
+
+        return field
+    }()
+
+    private func applyPhoneNumberFormatting() {
+        AssertIsOnMainThread()
+        ViewControllerUtils.reformatPhoneNumber(phoneNumberTextField, callingCode: callingCode)
+    }
+
+    var sectionHeaderTitle: String {
+        switch type {
+        case .oldNumber:
+            return NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_OLD_PHONE_NUMBER_SECTION_TITLE",
+                                     comment: "Title for the 'old phone number' section in the 'change phone number' settings.")
+        case .newNumber:
+            return NSLocalizedString("SETTINGS_CHANGE_PHONE_NUMBER_NEW_PHONE_NUMBER_SECTION_TITLE",
+                                     comment: "Title for the 'new phone number' section in the 'change phone number' settings.")
+        }
+    }
+
+    var accessibilityIdentifierPrefix: String {
+        switch type {
+        case .oldNumber:
+            return "old"
+        case .newNumber:
+            return "new"
+        }
+    }
+
+    var accessibilityIdentifier_PhoneNumberTextfield: String {
+        accessibilityIdentifierPrefix + "_phone_number_textfield"
+    }
+
+    var accessibilityIdentifier_PhoneNumber: String {
+        accessibilityIdentifierPrefix + "_phone_number"
+    }
+
+    var accessibilityIdentifier_CountryCode: String {
+        accessibilityIdentifierPrefix + "_country_code"
+    }
+
+    enum ParsedValue {
+        case noNumber
+        case invalidNumber
+        case validNumber(e164: E164)
+    }
+
+    func tryToParse() -> ParsedValue {
+        guard let phoneNumberWithoutCallingCode = phoneNumberString?.strippedOrNil else {
+            return .noNumber
+        }
+
+        guard
+            let phoneNumber = PhoneNumber.tryParsePhoneNumber(
+                fromUserSpecifiedText: phoneNumberWithoutCallingCode,
+                callingCode: callingCode
+            ),
+            let e164String = phoneNumber.toE164().strippedOrNil,
+            let e164 = E164(e164String),
+            PhoneNumberValidator().isValidForRegistration(phoneNumber: phoneNumber)
+        else {
+            return .invalidNumber
+        }
+
+        return .validNumber(e164: e164)
+    }
+}
+
+// MARK: -
+
+extension ChangePhoneNumberValueViews: UITextFieldDelegate {
+    public func textField(
+        _ textField: UITextField,
+        shouldChangeCharactersIn range: NSRange,
+        replacementString string: String) -> Bool {
+
+            if case .invalidNumber = phoneNumberError {
+                phoneNumberError = nil
+            }
+
+            // If ViewControllerUtils applied the edit on our behalf, inform UIKit
+            // so the edit isn't applied twice.
+            let result = ViewControllerUtils.phoneNumber(
+                textField,
+                shouldChangeCharactersIn: range,
+                replacementString: string,
+                callingCode: callingCode)
+
+            textFieldDidChange(textField)
+
+            return result
+        }
+
+    @objc
+    private func textFieldDidChange(_ textField: UITextField) {
+        applyPhoneNumberFormatting()
+        delegate?.valueDidChange(valueViews: self)
+    }
+
+    public func textFieldShouldReturn(_ textField: UITextField) -> Bool {
+        delegate?.valueDidPressEnter(valueViews: self)
+        return false
+    }
+}
+
+// MARK: -
+
+extension ChangePhoneNumberValueViews: CountryCodeViewControllerDelegate {
+    public func countryCodeViewController(_ vc: CountryCodeViewController,
+                                          didSelectCountry countryState: RegistrationCountryState) {
+        self.countryState = countryState
+        delegate?.valueDidUpdateCountryState(valueViews: self)
+    }
+}
diff --git a/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewController.swift b/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewController.swift
index 217ac10dd94..19289f08f3b 100644
--- a/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewController.swift
+++ b/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewController.swift
@@ -7,30 +7,6 @@ import Foundation
 import UIKit
 import SignalMessaging
 
-// MARK: - RegistrationPhoneNumberValidationError
-
-public enum RegistrationPhoneNumberValidationError: Equatable {
-    case invalidNumber(invalidE164: E164)
-    case rateLimited(expiration: Date)
-}
-
-// MARK: - RegistrationPhoneNumberState
-
-public struct RegistrationPhoneNumberState: Equatable {
-    public enum RegistrationPhoneNumberMode: Equatable {
-        /// previouslyEnteredE164 is if the user entered a number, quit, and came back.
-        /// Will be used to pre-populate the entry field.
-        case initialRegistration(previouslyEnteredE164: E164?)
-        case reregistration(e164: E164)
-        // TODO[Registration]: should also take a previously entered e164.
-        // we also shouldn't default to the old e164.
-        case changingPhoneNumber(oldE164: E164)
-    }
-
-    let mode: RegistrationPhoneNumberMode
-    let validationError: RegistrationPhoneNumberValidationError?
-}
-
 // MARK: - RegistrationPhoneNumberPresenter
 
 protocol RegistrationPhoneNumberPresenter: AnyObject {
@@ -41,33 +17,27 @@ protocol RegistrationPhoneNumberPresenter: AnyObject {
 
 class RegistrationPhoneNumberViewController: OWSViewController {
     public init(
-        state: RegistrationPhoneNumberState,
+        state: RegistrationPhoneNumberViewState.RegistrationMode,
         presenter: RegistrationPhoneNumberPresenter
     ) {
         self.state = state
         self.presenter = presenter
 
         self.phoneNumberInput = RegistrationPhoneNumberInputView(initialPhoneNumber: {
-            switch state.mode {
-            case let .initialRegistration(previouslyEnteredE164):
-                if let e164 = previouslyEnteredE164, let result = RegistrationPhoneNumber(e164: e164) {
+            switch state {
+            case let .initialRegistration(state):
+                if let e164 = state.previouslyEnteredE164, let result = RegistrationPhoneNumber(e164: e164) {
                     return result
                 }
                 return RegistrationPhoneNumber(
                     countryState: .defaultValue,
                     nationalNumber: ""
                 )
-            case let .reregistration(e164):
-                guard let result = RegistrationPhoneNumber(e164: e164) else {
+            case let .reregistration(state):
+                guard let result = RegistrationPhoneNumber(e164: state.e164) else {
                     owsFail("Could not parse re-registration E164")
                 }
                 return result
-            case let .changingPhoneNumber(e164):
-                guard let result = RegistrationPhoneNumber(e164: e164) else {
-                    owsFailBeta("Could not parse re-registration E164. Using fallback")
-                    return RegistrationPhoneNumber(countryState: .defaultValue, nationalNumber: "")
-                }
-                return result
             }
         }())
 
@@ -76,7 +46,7 @@ class RegistrationPhoneNumberViewController: OWSViewController {
         self.phoneNumberInput.delegate = self
     }
 
-    public func updateState(_ state: RegistrationPhoneNumberState) {
+    public func updateState(_ state: RegistrationPhoneNumberViewState.RegistrationMode) {
         self.state = state
     }
 
@@ -92,7 +62,7 @@ class RegistrationPhoneNumberViewController: OWSViewController {
 
     // MARK: Internal state
 
-    private var state: RegistrationPhoneNumberState {
+    private var state: RegistrationPhoneNumberViewState.RegistrationMode {
         didSet { render() }
     }
     private weak var presenter: RegistrationPhoneNumberPresenter?
@@ -105,17 +75,22 @@ class RegistrationPhoneNumberViewController: OWSViewController {
     private var nationalNumber: String { phoneNumberInput.nationalNumber }
     private var e164: E164? { phoneNumberInput.e164 }
 
-    private var localValidationError: RegistrationPhoneNumberValidationError? {
+    private var localValidationError: RegistrationPhoneNumberViewState.ValidationError? {
         didSet { render() }
     }
 
-    private var validationError: RegistrationPhoneNumberValidationError? {
-        return state.validationError ?? localValidationError
+    private var validationError: RegistrationPhoneNumberViewState.ValidationError? {
+        switch state {
+        case .initialRegistration(let initialRegistration):
+            return initialRegistration.validationError ?? localValidationError
+        case .reregistration(let reregistration):
+            return reregistration.validationError ?? localValidationError
+        }
     }
 
     private var canChangePhoneNumber: Bool {
-        switch state.mode {
-        case .initialRegistration, .changingPhoneNumber:
+        switch state {
+        case .initialRegistration:
             return true
         case .reregistration:
             return false
@@ -127,22 +102,15 @@ class RegistrationPhoneNumberViewController: OWSViewController {
             return false
         }
 
-        switch state.mode {
+        switch state {
         case .initialRegistration:
             break
         case .reregistration:
             return true
-        case let .changingPhoneNumber(oldE164):
-            if e164 == oldE164 { return false }
         }
 
-        switch validationError {
-        case nil:
-            break
-        case let .invalidNumber(invalidE164):
-            if e164 == invalidE164 { return false }
-        case let .rateLimited(expiration):
-            if expiration > now { return false }
+        if validationError?.canSubmit(e164: e164) == false {
+            return false
         }
 
         return true
@@ -214,13 +182,6 @@ class RegistrationPhoneNumberViewController: OWSViewController {
         return result
     }()
 
-    private lazy var retryAfterFormatter: DateFormatter = {
-        let result = DateFormatter()
-        result.dateFormat = "m:ss"
-        result.timeZone = TimeZone(identifier: "UTC")!
-        return result
-    }()
-
     public override func viewDidLoad() {
         super.viewDidLoad()
 
@@ -245,14 +206,12 @@ class RegistrationPhoneNumberViewController: OWSViewController {
                 break
             }
 
-            switch state.mode {
+            switch state {
             case .reregistration:
                 return false
-            case .initialRegistration, .changingPhoneNumber:
-                break
+            case .initialRegistration:
+                return true
             }
-
-            return true
         }()
         if shouldBecomeFirstResponder {
             phoneNumberInput.becomeFirstResponder()
@@ -296,29 +255,17 @@ class RegistrationPhoneNumberViewController: OWSViewController {
         phoneNumberInput.render()
 
         // We always render the warning label but sometimes invisibly. This avoids UI jumpiness.
-        switch validationError {
-        case nil:
-            validationWarningLabel.alpha = 0
-            validationWarningLabel.text = OWSLocalizedString(
-                "ONBOARDING_PHONE_NUMBER_VALIDATION_WARNING",
-                comment: "Label indicating that the phone number is invalid in the 'onboarding phone number' view."
-            )
-        case let .invalidNumber(invalidE164):
+        if let warningLabelText = validationError?.warningLabelText() {
             validationWarningLabel.alpha = 1
-            validationWarningLabel.text = OWSLocalizedString(
-                "ONBOARDING_PHONE_NUMBER_VALIDATION_WARNING",
-                comment: "Label indicating that the phone number is invalid in the 'onboarding phone number' view."
-            )
-            showInvalidPhoneNumberAlertIfNecessary(for: invalidE164.stringValue)
-        case let .rateLimited(expiration):
-            validationWarningLabel.alpha = expiration > now ? 1 : 0
-            let rateLimitFormat = OWSLocalizedString(
-                "ONBOARDING_PHONE_NUMBER_RATE_LIMIT_WARNING_FORMAT",
-                comment: "Label indicating that registration has been ratelimited. Embeds {{remaining time string}}."
-            )
-            let timeRemaining = max(expiration.timeIntervalSince(now), 0)
-            let durationString = retryAfterFormatter.string(from: Date(timeIntervalSinceReferenceDate: timeRemaining))
-            validationWarningLabel.text = String(format: rateLimitFormat, durationString)
+            validationWarningLabel.text = warningLabelText
+        } else {
+            validationWarningLabel.alpha = 0
+        }
+        switch validationError {
+        case nil, .rateLimited:
+            break
+        case let .invalidNumber(error):
+            showInvalidPhoneNumberAlertIfNecessary(for: error.invalidE164.stringValue)
         }
 
         view.backgroundColor = Theme.backgroundColor
@@ -377,7 +324,7 @@ class RegistrationPhoneNumberViewController: OWSViewController {
             let phoneNumber = PhoneNumber(fromE164: e164.stringValue),
             PhoneNumberValidator().isValidForRegistration(phoneNumber: phoneNumber)
         else {
-            localValidationError = .invalidNumber(invalidE164: e164)
+            localValidationError = .invalidNumber(.init(invalidE164: e164))
             return
         }
         localValidationError = nil
@@ -389,11 +336,6 @@ class RegistrationPhoneNumberViewController: OWSViewController {
             didRequestEdit: { [weak self] in self?.phoneNumberInput.becomeFirstResponder() }
         ))
     }
-
-    @objc
-    private func didTimeAdvance() {
-        now = Date()
-    }
 }
 
 // MARK: - RegistrationPhoneNumberInputViewDelegate
diff --git a/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewState.swift b/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewState.swift
new file mode 100644
index 00000000000..2a6c59a2d83
--- /dev/null
+++ b/Signal/src/ViewControllers/Registration/RegistrationPhoneNumberViewState.swift
@@ -0,0 +1,124 @@
+//
+// Copyright 2023 Signal Messenger, LLC
+// SPDX-License-Identifier: AGPL-3.0-only
+//
+
+import Foundation
+
+public enum RegistrationPhoneNumberViewState: Equatable {
+
+    case registration(RegistrationMode)
+    case changingNumber(ChangingNumberMode)
+
+    public enum RegistrationMode: Equatable {
+        case initialRegistration(InitialRegistration)
+        case reregistration(Reregistration)
+    }
+
+    public enum ChangingNumberMode: Equatable {
+        case initialEntry(ChangeNumberInitialEntry)
+        case confirmation(ChangeNumberConfirmation)
+    }
+
+    public struct InitialRegistration: Equatable {
+        /// previouslyEnteredE164 is if the user entered a number, quit, and came back.
+        /// Will be used to pre-populate the entry field.
+        let previouslyEnteredE164: E164?
+        let validationError: ValidationError?
+    }
+
+    public struct Reregistration: Equatable {
+        let e164: E164
+        let validationError: ValidationError?
+    }
+
+    public struct ChangeNumberInitialEntry: Equatable {
+        let oldE164: E164
+        let newE164: E164?
+        let hasConfirmed: Bool
+        let invalidNumberError: ValidationError.InvalidNumber?
+    }
+
+    public struct ChangeNumberConfirmation: Equatable {
+        let oldE164: E164
+        let newE164: E164
+        let rateLimitedError: ValidationError.RateLimited?
+    }
+
+    public enum ValidationError: Equatable {
+        case invalidNumber(InvalidNumber)
+        case rateLimited(RateLimited)
+
+        public struct InvalidNumber: Equatable {
+            let invalidE164: E164
+        }
+
+        public struct RateLimited: Equatable {
+            let expiration: Date
+        }
+    }
+}
+
+extension RegistrationPhoneNumberViewState.ValidationError {
+
+    func canSubmit(e164: E164) -> Bool {
+        switch self {
+        case let .invalidNumber(error):
+            return error.canSubmit(e164: e164)
+        case let .rateLimited(error):
+            return error.canSubmit()
+        }
+    }
+
+    func warningLabelText() -> String? {
+        switch self {
+        case .invalidNumber(let error):
+            return error.warningLabelText
+        case let .rateLimited(error):
+            return error.warningLabelText()
+        }
+    }
+}
+
+extension RegistrationPhoneNumberViewState.ValidationError.InvalidNumber {
+
+    func canSubmit(e164: E164) -> Bool {
+        return e164 != invalidE164
+    }
+
+    var warningLabelText: String {
+        return OWSLocalizedString(
+            "ONBOARDING_PHONE_NUMBER_VALIDATION_WARNING",
+            comment: "Label indicating that the phone number is invalid in the 'onboarding phone number' view."
+        )
+    }
+}
+
+extension RegistrationPhoneNumberViewState.ValidationError.RateLimited {
+
+    func canSubmit() -> Bool {
+        return Date() >= expiration
+    }
+
+    func warningLabelText() -> String? {
+        let now = Date()
+        if now >= expiration {
+            return nil
+        }
+        let rateLimitFormat = OWSLocalizedString(
+            "ONBOARDING_PHONE_NUMBER_RATE_LIMIT_WARNING_FORMAT",
+            comment: "Label indicating that registration has been ratelimited. Embeds {{remaining time string}}."
+        )
+
+        let retryAfterFormatter: DateFormatter = {
+            let result = DateFormatter()
+            result.dateFormat = "m:ss"
+            result.timeZone = TimeZone(identifier: "UTC")!
+            return result
+        }()
+
+        let timeRemaining = max(expiration.timeIntervalSince(now), 0)
+        let durationString = retryAfterFormatter.string(from: Date(timeIntervalSinceReferenceDate: timeRemaining))
+        return String(format: rateLimitFormat, durationString)
+    }
+}
diff --git a/Signal/test/Registration/RegistrationCoordinatorTest.swift b/Signal/test/Registration/RegistrationCoordinatorTest.swift
index bdd15cccba1..827c093b577 100644
--- a/Signal/test/Registration/RegistrationCoordinatorTest.swift
+++ b/Signal/test/Registration/RegistrationCoordinatorTest.swift
@@ -2955,33 +2955,60 @@ public class RegistrationCoordinatorTest: XCTestCase {
             mode: RegistrationMode,
             previouslyEnteredE164: E164? = nil,
             withValidationErrorFor response: Registration.BeginSessionResponse = .success(Stubs.session(hasSentVerificationCode: false))
-        ) -> RegistrationPhoneNumberState {
-            let validationError: RegistrationPhoneNumberValidationError?
+        ) -> RegistrationPhoneNumberViewState {
+            let validationError: RegistrationPhoneNumberViewState.ValidationError?
             switch response {
             case .success:
                 validationError = nil
             case .invalidArgument:
-                validationError = .invalidNumber(invalidE164: previouslyEnteredE164 ?? Stubs.e164)
+                validationError = .invalidNumber(.init(invalidE164: previouslyEnteredE164 ?? Stubs.e164))
             case .retryAfter(let timeInterval):
-                validationError = .rateLimited(expiration: self.date.addingTimeInterval(timeInterval))
+                validationError = .rateLimited(.init(expiration: self.date.addingTimeInterval(timeInterval)))
             case .networkFailure, .genericError:
                 XCTFail("Should not be generating phone number state for error responses.")
                 validationError = nil
             }
 
-            let phoneNumberMode: RegistrationPhoneNumberState.RegistrationPhoneNumberMode
             switch mode {
             case .registering:
-                phoneNumberMode = .initialRegistration(previouslyEnteredE164: previouslyEnteredE164)
+                return .registration(.initialRegistration(.init(
+                    previouslyEnteredE164: previouslyEnteredE164,
+                    validationError: validationError
+                )))
             case .reRegistering(let e164):
-                phoneNumberMode = .reregistration(e164: e164)
+                return .registration(.reregistration(.init(e164: e164, validationError: validationError)))
             case .changingNumber(let changeNumberParams):
-                phoneNumberMode = .changingPhoneNumber(oldE164: changeNumberParams.oldE164)
+                switch validationError {
+                case .none:
+                    if let newE164 = previouslyEnteredE164 {
+                        return .changingNumber(.confirmation(.init(
+                            oldE164: changeNumberParams.oldE164,
+                            newE164: newE164,
+                            rateLimitedError: nil
+                        )))
+                    } else {
+                        return .changingNumber(.initialEntry(.init(
+                            oldE164: changeNumberParams.oldE164,
+                            newE164: nil,
+                            hasConfirmed: false,
+                            invalidNumberError: nil
+                        )))
+                    }
+                case .rateLimited(let error):
+                    return .changingNumber(.confirmation(.init(
+                        oldE164: changeNumberParams.oldE164,
+                        newE164: previouslyEnteredE164!,
+                        rateLimitedError: error
+                    )))
+                case .invalidNumber(let error):
+                    return .changingNumber(.initialEntry(.init(
+                        oldE164: changeNumberParams.oldE164,
+                        newE164: previouslyEnteredE164,
+                        hasConfirmed: previouslyEnteredE164 != nil,
+                        invalidNumberError: error
+                    )))
+                }
             }
-            return RegistrationPhoneNumberState(
-                mode: phoneNumberMode,
-                validationError: validationError
-            )
         }
 
         static func verificationCodeEntryState(
diff --git a/Signal/translations/en.lproj/Localizable.strings b/Signal/translations/en.lproj/Localizable.strings
index 05a94e1c7cf..1e75e200fee 100644
--- a/Signal/translations/en.lproj/Localizable.strings
+++ b/Signal/translations/en.lproj/Localizable.strings
@@ -5698,7 +5698,7 @@
 /* Title for the 'old phone number' section in the 'change phone number' settings. */
 "SETTINGS_CHANGE_PHONE_NUMBER_OLD_PHONE_NUMBER_SECTION_TITLE" = "Your Old Number";
 
-/* Label for the 'country code' row in the 'change phone number' settings. */
+/* Label for the 'phone number' row in the 'change phone number' settings. */
 "SETTINGS_CHANGE_PHONE_NUMBER_PHONE_NUMBER_FIELD" = "Phone Number";
 
 /* Format for the 'change phone number' progress view. Embeds: {{ the user's new phone number }}. */
