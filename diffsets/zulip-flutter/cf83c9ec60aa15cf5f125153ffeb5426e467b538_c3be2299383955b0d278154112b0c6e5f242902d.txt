diff --git a/lib/model/channel.dart b/lib/model/channel.dart
index 78080ade95..8ef01054bd 100644
--- a/lib/model/channel.dart
+++ b/lib/model/channel.dart
@@ -5,6 +5,7 @@ import 'package:flutter/foundation.dart';
 import '../api/model/events.dart';
 import '../api/model/initial_snapshot.dart';
 import '../api/model/model.dart';
+import 'realm.dart';
 import 'store.dart';
 import 'user.dart';
 
@@ -139,6 +140,44 @@ mixin ChannelStore on UserStore {
     }
   }
 
+  bool selfHasContentAccess(ZulipStream channel) {
+    // Compare web's stream_data.has_content_access.
+    if (channel.isWebPublic) return true;
+    if (channel is Subscription) return true;
+    // Here web calls has_metadata_access... but that always returns true,
+    // as its comment says.
+    if (selfUser.role == UserRole.guest) return false;
+    if (!channel.inviteOnly) return true;
+    return _selfHasContentAccessViaGroupPermissions(channel);
+  }
+
+  bool _selfHasContentAccessViaGroupPermissions(ZulipStream channel) {
+    // Compare web's stream_data.has_content_access_via_group_permissions.
+    // TODO(#814) try to clean up this logic; perhaps record more explicitly
+    //   what default/fallback value to use for a given group-based permission
+    //   on older servers.
+
+    if (channel.canAddSubscribersGroup != null
+        && selfHasPermissionForGroupSetting(channel.canAddSubscribersGroup!,
+             GroupSettingType.stream, 'can_add_subscribers_group')) {
+      // The behavior before this permission was introduced was equivalent to
+      // the "nobody" group.
+      // TODO(server-10): simplify
+      return true;
+    }
+
+    if (channel.canSubscribeGroup != null
+        && selfHasPermissionForGroupSetting(channel.canSubscribeGroup!,
+             GroupSettingType.stream, 'can_subscribe_group')) {
+      // The behavior before this permission was introduced was equivalent to
+      // the "nobody" group.
+      // TODO(server-10): simplify
+      return true;
+    }
+
+    return false;
+  }
+
   bool hasPostingPermission({
     required ZulipStream inChannel,
     required User user,
diff --git a/lib/widgets/action_sheet.dart b/lib/widgets/action_sheet.dart
index dcf82389bc..ce1be46000 100644
--- a/lib/widgets/action_sheet.dart
+++ b/lib/widgets/action_sheet.dart
@@ -445,10 +445,11 @@ void showChannelActionSheet(BuildContext context, {
     && messageListPageNarrow.streamId == channelId;
 
   final unreadCount = store.unreads.countInChannelNarrow(channelId);
-  final isSubscribed = store.subscriptions[channelId] != null;
+  final channel = store.streams[channelId];
+  final isSubscribed = channel is Subscription;
   final buttonSections = [
-    if (!isSubscribed)
-      // TODO(#1786) check group-based can-subscribe permission
+    if (!isSubscribed
+        && channel != null && store.selfHasContentAccess(channel))
       [SubscribeButton(pageContext: pageContext, channelId: channelId)],
     [
       if (unreadCount > 0)
