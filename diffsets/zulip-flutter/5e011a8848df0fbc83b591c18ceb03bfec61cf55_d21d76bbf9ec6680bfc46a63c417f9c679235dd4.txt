diff --git a/lib/widgets/compose_box.dart b/lib/widgets/compose_box.dart
index a22e4f7c78..16daac4224 100644
--- a/lib/widgets/compose_box.dart
+++ b/lib/widgets/compose_box.dart
@@ -1232,7 +1232,8 @@ class _FixedDestinationComposeBoxState extends State<_FixedDestinationComposeBox
 }
 
 class ComposeBox extends StatelessWidget {
-  const ComposeBox({super.key, this.controllerKey, required this.narrow});
+  ComposeBox({super.key, this.controllerKey, required this.narrow})
+    : assert(ComposeBox.hasComposeBox(narrow));
 
   final GlobalKey<ComposeBoxController>? controllerKey;
   final Narrow narrow;
@@ -1296,6 +1297,7 @@ class ComposeBox extends StatelessWidget {
       case CombinedFeedNarrow():
       case MentionsNarrow():
       case StarredMessagesNarrow():
+        assert(false);
         return const SizedBox.shrink();
     }
   }
diff --git a/lib/widgets/message_list.dart b/lib/widgets/message_list.dart
index b8fcf3adbe..0ac1681172 100644
--- a/lib/widgets/message_list.dart
+++ b/lib/widgets/message_list.dart
@@ -301,7 +301,9 @@ class _MessageListPageState extends State<MessageListPage> implements MessageLis
 
               child: Expanded(
                 child: MessageList(narrow: narrow, onNarrowChanged: _narrowChanged))),
-            ComposeBox(controllerKey: _composeBoxKey, narrow: narrow),
+            if (ComposeBox.hasComposeBox(narrow))
+              ComposeBox(controllerKey: _composeBoxKey, narrow: narrow)
+            else const SizedBox.shrink(),
           ]))));
   }
 }
diff --git a/test/widgets/action_sheet_test.dart b/test/widgets/action_sheet_test.dart
index 3dade81b48..c15c5ac1b5 100644
--- a/test/widgets/action_sheet_test.dart
+++ b/test/widgets/action_sheet_test.dart
@@ -224,8 +224,8 @@ void main() {
 
   group('QuoteAndReplyButton', () {
     ComposeBoxController? findComposeBoxController(WidgetTester tester) {
-      return tester.widget<ComposeBox>(find.byType(ComposeBox))
-        .controllerKey?.currentState;
+      return tester.widgetList<ComposeBox>(find.byType(ComposeBox))
+        .singleOrNull?.controllerKey?.currentState;
     }
 
     Widget? findQuoteAndReplyButton(WidgetTester tester) {
