diff --git a/lib/model/content.dart b/lib/model/content.dart
index 9c37ef5b5e..72c8240133 100644
--- a/lib/model/content.dart
+++ b/lib/model/content.dart
@@ -371,11 +371,14 @@ class MathBlockNode extends BlockContentNode {
 
 class KatexNode extends ContentNode {
   const KatexNode({
+    required this.styles,
     required this.text,
     required this.nodes,
     super.debugHtmlNode,
   }) : assert((text != null) ^ (nodes != null));
 
+  final KatexSpanStyles styles;
+
   /// The text this KaTeX node contains.
   ///
   /// It will be null if [nodes] is non-null.
@@ -389,6 +392,7 @@ class KatexNode extends ContentNode {
   @override
   void debugFillProperties(DiagnosticPropertiesBuilder properties) {
     super.debugFillProperties(properties);
+    properties.add(DiagnosticsProperty<KatexSpanStyles>('styles', styles));
     properties.add(StringProperty('text', text));
   }
 
diff --git a/lib/model/katex.dart b/lib/model/katex.dart
index a1932c281a..fc71025b59 100644
--- a/lib/model/katex.dart
+++ b/lib/model/katex.dart
@@ -1,3 +1,4 @@
+import 'package:flutter/foundation.dart';
 import 'package:html/dom.dart' as dom;
 
 import '../log.dart';
@@ -81,14 +82,21 @@ MathParserResult? parseMath(dom.Element element, { required bool block }) {
     final globalSettings = globalStore.settings;
     final flagRenderKatex =
       globalSettings.getBool(BoolGlobalSetting.renderKatex);
+    final flagForceRenderKatex =
+      globalSettings.getBool(BoolGlobalSetting.forceRenderKatex);
 
     List<KatexNode>? nodes;
     if (flagRenderKatex) {
+      final parser = _KatexParser();
       try {
-        nodes = _KatexParser().parseKatexHtml(katexHtmlElement);
+        nodes = parser.parseKatexHtml(katexHtmlElement);
       } on KatexHtmlParseError catch (e, st) {
         assert(debugLog('$e\n$st'));
       }
+
+      if (parser.hasError && !flagForceRenderKatex) {
+        nodes = null;
+      }
     }
 
     return MathParserResult(nodes: nodes, texSource: texSource);
@@ -98,6 +106,14 @@ MathParserResult? parseMath(dom.Element element, { required bool block }) {
 }
 
 class _KatexParser {
+  bool get hasError => _hasError;
+  bool _hasError = false;
+
+  void _logError(String message) {
+    assert(debugLog(message));
+    _hasError = true;
+  }
+
   List<KatexNode> parseKatexHtml(dom.Element element) {
     assert(element.localName == 'span');
     assert(element.className == 'katex-html');
@@ -114,7 +130,269 @@ class _KatexParser {
     }));
   }
 
+  static final _resetSizeClassRegExp = RegExp(r'^reset-size(\d\d?)$');
+  static final _sizeClassRegExp = RegExp(r'^size(\d\d?)$');
+
   KatexNode _parseSpan(dom.Element element) {
+    // TODO maybe check if the sequence of ancestors matter for spans.
+
+    final spanClasses = List<String>.unmodifiable(element.className.split(' '));
+
+    // Aggregate the CSS styles that apply, in the same order as the CSS
+    // classes specified for this span, mimicking the behaviour on web.
+    //
+    // Each case in the switch blocks below is a separate CSS class definition
+    // in the same order as in katex.scss :
+    //   https://github.com/KaTeX/KaTeX/blob/2fe1941b/src/styles/katex.scss
+    // A copy of class definition (where possible) is accompanied in a comment
+    // with each case statement to keep track of updates.
+    var styles = KatexSpanStyles();
+    var index = 0;
+    while (index < spanClasses.length) {
+      var classFound = false;
+
+      final spanClass = spanClasses[index];
+      switch (spanClass) {
+        case 'base':
+          // .base { ... }
+          // Do nothing, it has properties that don't need special handling.
+          classFound = true;
+
+        case 'strut':
+          // .strut { ... }
+          // Do nothing, it has properties that don't need special handling.
+          classFound = true;
+
+        case 'textbf':
+          // .textbf { font-weight: bold; }
+          styles.fontWeight = KatexSpanFontWeight.bold;
+          classFound = true;
+
+        case 'textit':
+          // .textit { font-style: italic; }
+          styles.fontStyle = KatexSpanFontStyle.italic;
+          classFound = true;
+
+        case 'textrm':
+          // .textrm { font-family: KaTeX_Main; }
+          styles.fontFamily = 'KaTeX_Main';
+          classFound = true;
+
+        case 'textsf':
+          // .textsf { font-family: KaTeX_SansSerif; }
+          styles.fontFamily = 'KaTeX_SansSerif';
+          classFound = true;
+
+        case 'texttt':
+          // .texttt { font-family: KaTeX_Typewriter; }
+          styles.fontFamily = 'KaTeX_Typewriter';
+          classFound = true;
+
+        case 'mathnormal':
+          // .mathnormal { font-family: KaTeX_Math; font-style: italic; }
+          styles.fontFamily = 'KaTeX_Math';
+          styles.fontStyle = KatexSpanFontStyle.italic;
+          classFound = true;
+
+        case 'mathit':
+          // .mathit { font-family: KaTeX_Main; font-style: italic; }
+          styles.fontFamily = 'KaTeX_Main';
+          styles.fontStyle = KatexSpanFontStyle.italic;
+          classFound = true;
+
+        case 'mathrm':
+          // .mathrm { font-style: normal; }
+          styles.fontStyle = KatexSpanFontStyle.normal;
+          classFound = true;
+
+        case 'mathbf':
+          // .mathbf { font-family: KaTeX_Main; font-weight: bold; }
+          styles.fontFamily = 'KaTeX_Main';
+          styles.fontWeight = KatexSpanFontWeight.bold;
+          classFound = true;
+
+        case 'boldsymbol':
+          // .boldsymbol { font-family: KaTeX_Math; font-weight: bold; font-style: italic; }
+          styles.fontFamily = 'KaTeX_Math';
+          styles.fontWeight = KatexSpanFontWeight.bold;
+          styles.fontStyle = KatexSpanFontStyle.italic;
+          classFound = true;
+
+        case 'amsrm':
+          // .amsrm { font-family: KaTeX_AMS; }
+          styles.fontFamily = 'KaTeX_AMS';
+          classFound = true;
+
+        case 'mathbb':
+        case 'textbb':
+          // .mathbb,
+          // .textbb { font-family: KaTeX_AMS; }
+          styles.fontFamily = 'KaTeX_AMS';
+          classFound = true;
+
+        case 'mathcal':
+          // .mathcal { font-family: KaTeX_Caligraphic; }
+          styles.fontFamily = 'KaTeX_Caligraphic';
+          classFound = true;
+
+        case 'mathfrak':
+        case 'textfrak':
+          // .mathfrak,
+          // .textfrak { font-family: KaTeX_Fraktur; }
+          styles.fontFamily = 'KaTeX_Fraktur';
+          classFound = true;
+
+        case 'mathboldfrak':
+        case 'textboldfrak':
+          // .mathboldfrak,
+          // .textboldfrak { font-family: KaTeX_Fraktur; font-weight: bold; }
+          styles.fontFamily = 'KaTeX_Fraktur';
+          styles.fontWeight = KatexSpanFontWeight.bold;
+          classFound = true;
+
+        case 'mathtt':
+          // .mathtt { font-family: KaTeX_Typewriter; }
+          styles.fontFamily = 'KaTeX_Typewriter';
+          classFound = true;
+
+        case 'mathscr':
+        case 'textscr':
+          // .mathscr,
+          // .textscr { font-family: KaTeX_Script; }
+          styles.fontFamily = 'KaTeX_Script';
+          classFound = true;
+      }
+
+      // We can't add the case for the next class (.mathsf, .textsf) in the
+      // above switch block, because there is already a case for .textsf above.
+      // So start a new block, to keep the order of the cases here same as the
+      // CSS class definitions in katex.scss .
+      switch (spanClass) {
+        case 'mathsf':
+        case 'textsf':
+          // .mathsf,
+          // .textsf { font-family: KaTeX_SansSerif; }
+          styles.fontFamily = 'KaTeX_SansSerif';
+          classFound = true;
+
+        case 'mathboldsf':
+        case 'textboldsf':
+          // .mathboldsf,
+          // .textboldsf { font-family: KaTeX_SansSerif; font-weight: bold; }
+          styles.fontFamily = 'KaTeX_SansSerif';
+          styles.fontWeight = KatexSpanFontWeight.bold;
+          classFound = true;
+
+        case 'mathsfit':
+        case 'mathitsf':
+        case 'textitsf':
+          // .mathsfit,
+          // .mathitsf,
+          // .textitsf { font-family: KaTeX_SansSerif; font-style: italic; }
+          styles.fontFamily = 'KaTeX_SansSerif';
+          styles.fontStyle = KatexSpanFontStyle.italic;
+          classFound = true;
+
+        case 'mainrm':
+          // .mainrm { font-family: KaTeX_Main; font-style: normal; }
+          styles.fontFamily = 'KaTeX_Main';
+          styles.fontStyle = KatexSpanFontStyle.normal;
+          classFound = true;
+
+        // TODO handle skipped class declarations between .mainrm and
+        //   .sizing .
+
+        case 'sizing':
+        case 'fontsize-ensurer':
+          // .sizing,
+          // .fontsize-ensurer { ... }
+          if (index + 2 < spanClasses.length) {
+            final resetSizeClass = spanClasses[index + 1];
+            final sizeClass = spanClasses[index + 2];
+
+            final resetSizeClassSuffix = _resetSizeClassRegExp.firstMatch(resetSizeClass)?.group(1);
+            final sizeClassSuffix = _sizeClassRegExp.firstMatch(sizeClass)?.group(1);
+
+            if (resetSizeClassSuffix != null && sizeClassSuffix != null) {
+              const sizes = <double>[0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.2, 1.44, 1.728, 2.074, 2.488];
+
+              final resetSizeIdx = int.parse(resetSizeClassSuffix, radix: 10);
+              final sizeIdx = int.parse(sizeClassSuffix, radix: 10);
+
+              // These indexes start at 1.
+              if (resetSizeIdx <= sizes.length && sizeIdx <= sizes.length) {
+                styles.fontSizeEm = sizes[sizeIdx - 1] / sizes[resetSizeIdx - 1];
+                index += 3;
+                continue;
+              }
+            }
+          }
+
+          throw KatexHtmlParseError();
+
+        case 'delimsizing':
+          // .delimsizing { ... }
+          if (index + 1 < spanClasses.length) {
+            final nextClass = spanClasses[index + 1];
+            switch (nextClass) {
+              case 'size1':
+                styles.fontFamily = 'KaTeX_Size1';
+              case 'size2':
+                styles.fontFamily = 'KaTeX_Size2';
+              case 'size3':
+                styles.fontFamily = 'KaTeX_Size3';
+              case 'size4':
+                styles.fontFamily = 'KaTeX_Size4';
+
+              case 'mult':
+                // TODO handle nested spans with `.delim-size{1,4}` class.
+                break;
+            }
+
+            if (styles.fontFamily == null) throw KatexHtmlParseError();
+
+            index += 2;
+            continue;
+          }
+
+          throw KatexHtmlParseError();
+
+        // TODO handle .nulldelimiter and .delimcenter .
+
+        case 'op-symbol':
+          // .op-symbol { ... }
+          if (index + 1 < spanClasses.length) {
+           final nextClass = spanClasses[index + 1];
+            switch (nextClass) {
+              case 'small-op':
+                styles.fontFamily = 'KaTeX_Size1';
+              case 'large-op':
+                styles.fontFamily = 'KaTeX_Size2';
+            }
+            if (styles.fontFamily == null) throw KatexHtmlParseError();
+
+            index += 2;
+            continue;
+          }
+
+          throw KatexHtmlParseError();
+
+        // TODO handle more classes from katex.scss
+      }
+
+      // Ignore these classes because they don't have a CSS definition
+      // in katex.scss, but we encounter them in the generated HTML.
+      switch (spanClass) {
+        case 'mord':
+        case 'mopen':
+          classFound = true;
+      }
+
+      if (!classFound) _logError('KaTeX: Unsupported CSS class: $spanClass');
+
+      index++;
+    }
+
     String? text;
     List<KatexNode>? spans;
     if (element.nodes case [dom.Text(:final data)]) {
@@ -125,11 +403,74 @@ class _KatexParser {
     if (text == null && spans == null) throw KatexHtmlParseError();
 
     return KatexNode(
+      styles: styles,
       text: text,
       nodes: spans);
   }
 }
 
+enum KatexSpanFontWeight {
+  bold,
+}
+
+enum KatexSpanFontStyle {
+  normal,
+  italic,
+}
+
+enum KatexSpanTextAlign {
+  left,
+  center,
+  right,
+}
+
+class KatexSpanStyles {
+  String? fontFamily;
+  double? fontSizeEm;
+  KatexSpanFontWeight? fontWeight;
+  KatexSpanFontStyle? fontStyle;
+  KatexSpanTextAlign? textAlign;
+
+  KatexSpanStyles({
+    this.fontFamily,
+    this.fontSizeEm,
+    this.fontWeight,
+    this.fontStyle,
+    this.textAlign,
+  });
+
+  @override
+  int get hashCode => Object.hash(
+    'KatexSpanStyles',
+    fontFamily,
+    fontSizeEm,
+    fontWeight,
+    fontStyle,
+    textAlign,
+  );
+
+  @override
+  bool operator ==(Object other) {
+    return other is KatexSpanStyles &&
+      other.fontFamily == fontFamily &&
+      other.fontSizeEm == fontSizeEm &&
+      other.fontWeight == fontWeight &&
+      other.fontStyle == fontStyle &&
+      other.textAlign == textAlign;
+  }
+
+  @override
+  String toString() {
+    final args = <String>[];
+    if (fontFamily != null) args.add('fontFamily: $fontFamily');
+    if (fontSizeEm != null) args.add('fontSizeEm: $fontSizeEm');
+    if (fontWeight != null) args.add('fontWeight: $fontWeight');
+    if (fontStyle != null) args.add('fontStyle: $fontStyle');
+    if (textAlign != null) args.add('textAlign: $textAlign');
+    return '${objectRuntimeType(this, 'KatexSpanStyles')}(${args.join(', ')})';
+  }
+}
+
 class KatexHtmlParseError extends Error {
   final String? message;
   KatexHtmlParseError([this.message]);
diff --git a/lib/model/settings.dart b/lib/model/settings.dart
index 072fb8d7e3..5fd2fec9f8 100644
--- a/lib/model/settings.dart
+++ b/lib/model/settings.dart
@@ -113,6 +113,10 @@ enum BoolGlobalSetting {
   /// An experimental flag to toggle rendering KaTeX content in messages.
   renderKatex(GlobalSettingType.experimentalFeatureFlag, false),
 
+  /// An experimental flag to enable rendering KaTeX even when some
+  /// errors are encountered.
+  forceRenderKatex(GlobalSettingType.experimentalFeatureFlag, false),
+
   // Former settings which might exist in the database,
   // whose names should therefore not be reused:
   // (this list is empty so far)
diff --git a/lib/widgets/content.dart b/lib/widgets/content.dart
index 2bebce042d..4bf6f8adae 100644
--- a/lib/widgets/content.dart
+++ b/lib/widgets/content.dart
@@ -1,6 +1,7 @@
 import 'dart:async';
 
 import 'package:flutter/cupertino.dart';
+import 'package:flutter/foundation.dart';
 import 'package:flutter/gestures.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter/rendering.dart';
@@ -13,6 +14,7 @@ import '../generated/l10n/zulip_localizations.dart';
 import '../model/avatar_url.dart';
 import '../model/content.dart';
 import '../model/internal_link.dart';
+import '../model/katex.dart';
 import 'actions.dart';
 import 'code_block.dart';
 import 'dialog.dart';
@@ -818,6 +820,13 @@ class MathBlock extends StatelessWidget {
   }
 }
 
+// Base text style from .katex class in katex.scss :
+//   https://github.com/KaTeX/KaTeX/blob/613c3da8/src/styles/katex.scss#L13-L15
+const kBaseKatexTextStyle = TextStyle(
+  fontSize: kBaseFontSize * 1.21,
+  fontFamily: 'KaTeX_Main',
+  height: 1.2);
+
 class _Katex extends StatelessWidget {
   const _Katex({
     required this.inline,
@@ -827,13 +836,6 @@ class _Katex extends StatelessWidget {
   final bool inline;
   final List<KatexNode> nodes;
 
-  // Base text style from .katex class in katex.scss :
-  //   https://github.com/KaTeX/KaTeX/blob/613c3da8/src/styles/katex.scss#L13-L15
-  static const _baseKatexTextStyle = TextStyle(
-    fontSize: kBaseFontSize * 1.21,
-    fontFamily: 'KaTeX_Main',
-    height: 1.2);
-
   @override
   Widget build(BuildContext context) {
     Widget widget = Text.rich(TextSpan(
@@ -854,7 +856,7 @@ class _Katex extends StatelessWidget {
     return Directionality(
       textDirection: TextDirection.ltr,
       child: DefaultTextStyle(
-        style: _baseKatexTextStyle.copyWith(
+        style: kBaseKatexTextStyle.copyWith(
           color: ContentTheme.of(context).textStylePlainParagraph.color),
         child: widget));
   }
@@ -867,6 +869,8 @@ class _KatexSpan extends StatelessWidget {
 
   @override
   Widget build(BuildContext context) {
+    final em = DefaultTextStyle.of(context).style.fontSize!;
+
     Widget widget = const SizedBox.shrink();
     if (span.text != null) {
       widget = Text(span.text!);
@@ -879,6 +883,57 @@ class _KatexSpan extends StatelessWidget {
             child: _KatexSpan(e));
         }))));
     }
+
+    final styles = span.styles;
+
+    final fontFamily = styles.fontFamily;
+    final fontSize = switch (styles.fontSizeEm) {
+      double fontSizeEm => fontSizeEm * em,
+      null => null,
+    };
+    final fontWeight = switch (styles.fontWeight) {
+      KatexSpanFontWeight.bold => FontWeight.bold,
+      null => null,
+    };
+    var fontStyle = switch (styles.fontStyle) {
+      KatexSpanFontStyle.normal => FontStyle.normal,
+      KatexSpanFontStyle.italic => FontStyle.italic,
+      null => null,
+    };
+
+    TextStyle? textStyle;
+    if (fontFamily != null ||
+        fontSize != null ||
+        fontWeight != null ||
+        fontStyle != null) {
+      // TODO(upstream) remove this workaround when upstream fixes the broken
+      //   rendering of KaTeX_Math font with italic font style on Android:
+      //     https://github.com/flutter/flutter/issues/167474
+      if (defaultTargetPlatform == TargetPlatform.android &&
+          fontFamily == 'KaTeX_Math') {
+        fontStyle = FontStyle.normal;
+      }
+
+      textStyle = TextStyle(
+        fontFamily: fontFamily,
+        fontSize: fontSize,
+        fontWeight: fontWeight,
+        fontStyle: fontStyle,
+      );
+    }
+    final textAlign = switch (styles.textAlign) {
+      KatexSpanTextAlign.left => TextAlign.left,
+      KatexSpanTextAlign.center => TextAlign.center,
+      KatexSpanTextAlign.right => TextAlign.right,
+      null => null,
+    };
+
+    if (textStyle != null || textAlign != null) {
+      widget = DefaultTextStyle.merge(
+        style: textStyle,
+        textAlign: textAlign,
+        child: widget);
+    }
     return widget;
   }
 }
diff --git a/test/model/content_test.dart b/test/model/content_test.dart
index 8fa30fefcc..5ab60c8e7e 100644
--- a/test/model/content_test.dart
+++ b/test/model/content_test.dart
@@ -7,6 +7,7 @@ import 'package:test/scaffolding.dart';
 import 'package:zulip/model/code_block.dart';
 import 'package:zulip/model/content.dart';
 import 'package:zulip/model/settings.dart';
+import 'package:zulip/model/katex.dart';
 
 import 'binding.dart';
 import 'content_checks.dart';
@@ -516,14 +517,19 @@ class ContentExample {
       '<span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow>'
         '<annotation encoding="application/x-tex"> \\lambda </annotation></semantics></math></span>'
       '<span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></p>',
-    const MathInlineNode(texSource: r'\lambda', nodes: [
-      KatexNode(text: null, nodes: [
-        KatexNode(text: null, nodes: []),
-        KatexNode(text: 'λ', nodes: null),
+    MathInlineNode(texSource: r'\lambda', nodes: [
+      KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+        KatexNode(
+          styles: KatexSpanStyles(
+            fontFamily: 'KaTeX_Math',
+            fontStyle: KatexSpanFontStyle.italic),
+          text: 'λ',
+          nodes: null),
       ]),
     ]));
 
-  static const mathBlock = ContentExample(
+  static final mathBlock = ContentExample(
     'math block',
     "```math\n\\lambda\n```",
     expectedText: r'\lambda',
@@ -532,13 +538,18 @@ class ContentExample {
         '<annotation encoding="application/x-tex">\\lambda</annotation></semantics></math></span>'
       '<span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span></p>',
     [MathBlockNode(texSource: r'\lambda', nodes: [
-      KatexNode(text: null, nodes: [
-        KatexNode(text: null, nodes: []),
-        KatexNode(text: 'λ', nodes: null),
+      KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+        KatexNode(
+          styles: KatexSpanStyles(
+            fontFamily: 'KaTeX_Math',
+            fontStyle: KatexSpanFontStyle.italic),
+          text: 'λ',
+          nodes: null),
       ]),
     ])]);
 
-  static const mathBlocksMultipleInParagraph = ContentExample(
+  static final mathBlocksMultipleInParagraph = ContentExample(
     'math blocks, multiple in paragraph',
     '```math\na\n\nb\n```',
     // https://chat.zulip.org/#narrow/channel/7-test-here/topic/.E2.9C.94.20Rajesh/near/2001490
@@ -552,20 +563,30 @@ class ContentExample {
           '<annotation encoding="application/x-tex">b</annotation></semantics></math></span>'
         '<span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span></p>', [
       MathBlockNode(texSource: 'a', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'a', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'a',
+            nodes: null),
         ]),
       ]),
       MathBlockNode(texSource: 'b', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'b', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'b',
+            nodes: null),
         ]),
       ]),
     ]);
 
-  static const mathBlockInQuote = ContentExample(
+  static final mathBlockInQuote = ContentExample(
     'math block in quote',
     // There's sometimes a quirky extra `<br>\n` at the end of the `<p>` that
     // encloses the math block.  In particular this happens when the math block
@@ -581,14 +602,19 @@ class ContentExample {
       '<br>\n</p>\n</blockquote>',
     [QuotationNode([
       MathBlockNode(texSource: r'\lambda', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'λ', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'λ',
+            nodes: null),
         ]),
       ]),
     ])]);
 
-  static const mathBlocksMultipleInQuote = ContentExample(
+  static final mathBlocksMultipleInQuote = ContentExample(
     'math blocks, multiple in quote',
     "````quote\n```math\na\n\nb\n```\n````",
     // https://chat.zulip.org/#narrow/channel/7-test-here/topic/.E2.9C.94.20Rajesh/near/2029236
@@ -605,20 +631,30 @@ class ContentExample {
       '<br>\n</p>\n</blockquote>',
     [QuotationNode([
       MathBlockNode(texSource: 'a', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'a', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'a',
+            nodes: null),
         ]),
       ]),
       MathBlockNode(texSource: 'b', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'b', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(), text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'b',
+            nodes: null),
         ]),
       ]),
     ])]);
 
-  static const mathBlockBetweenImages = ContentExample(
+  static final mathBlockBetweenImages = ContentExample(
     'math block between images',
     // https://chat.zulip.org/#narrow/channel/7-test-here/topic/Greg/near/2035891
     'https://upload.wikimedia.org/wikipedia/commons/7/78/Verregende_bloem_van_een_Helenium_%27El_Dorado%27._22-07-2023._%28d.j.b%29.jpg\n```math\na\n```\nhttps://upload.wikimedia.org/wikipedia/commons/thumb/7/71/Zaadpluizen_van_een_Clematis_texensis_%27Princess_Diana%27._18-07-2023_%28actm.%29_02.jpg/1280px-Zaadpluizen_van_een_Clematis_texensis_%27Princess_Diana%27._18-07-2023_%28actm.%29_02.jpg',
@@ -644,9 +680,13 @@ class ContentExample {
           originalHeight: null),
       ]),
       MathBlockNode(texSource: 'a', nodes: [
-        KatexNode(text: null, nodes: [
-          KatexNode(text: null, nodes: []),
-          KatexNode(text: 'a', nodes: null),
+        KatexNode(styles: KatexSpanStyles(), text: null, nodes: [
+          KatexNode(styles: KatexSpanStyles(),text: null, nodes: []),
+          KatexNode(
+            styles: KatexSpanStyles(
+              fontFamily: 'KaTeX_Math',
+              fontStyle: KatexSpanFontStyle.italic),
+            text: 'a', nodes: null),
         ]),
       ]),
       ImageNodeList([
@@ -659,6 +699,200 @@ class ContentExample {
       ]),
     ]);
 
+  // The font sizes can be compared using the katex.css generated
+  // from katex.scss :
+  //   https://unpkg.com/katex@0.16.21/dist/katex.css
+  static final mathBlockKatexSizing = ContentExample(
+    'math block; KaTeX different sizing',
+    // https://chat.zulip.org/#narrow/channel/7-test-here/topic/Rajesh/near/2155476
+    '```math\n\\Huge 1\n\\huge 2\n\\LARGE 3\n\\Large 4\n\\large 5\n\\normalsize 6\n\\small 7\n\\footnotesize 8\n\\scriptsize 9\n\\tiny 0\n```',
+    '<p>'
+      '<span class="katex-display"><span class="katex">'
+        '<span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="2.488em"><mn>1</mn><mstyle mathsize="2.074em"><mn>2</mn><mstyle mathsize="1.728em"><mn>3</mn><mstyle mathsize="1.44em"><mn>4</mn><mstyle mathsize="1.2em"><mn>5</mn><mstyle mathsize="1em"><mn>6</mn><mstyle mathsize="0.9em"><mn>7</mn><mstyle mathsize="0.8em"><mn>8</mn><mstyle mathsize="0.7em"><mn>9</mn><mstyle mathsize="0.5em"><mn>0</mn></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow>'
+          '<annotation encoding="application/x-tex">\\Huge 1\n\\huge 2\n\\LARGE 3\n\\Large 4\n\\large 5\n\\normalsize 6\n\\small 7\n\\footnotesize 8\n\\scriptsize 9\n\\tiny 0</annotation></semantics></math></span>'
+        '<span class="katex-html" aria-hidden="true">'
+          '<span class="base">'
+            '<span class="strut" style="height:1.6034em;"></span>'
+            '<span class="mord sizing reset-size6 size11">1</span>'
+            '<span class="mord sizing reset-size6 size10">2</span>'
+            '<span class="mord sizing reset-size6 size9">3</span>'
+            '<span class="mord sizing reset-size6 size8">4</span>'
+            '<span class="mord sizing reset-size6 size7">5</span>'
+            '<span class="mord sizing reset-size6 size6">6</span>'
+            '<span class="mord sizing reset-size6 size5">7</span>'
+            '<span class="mord sizing reset-size6 size4">8</span>'
+            '<span class="mord sizing reset-size6 size3">9</span>'
+            '<span class="mord sizing reset-size6 size1">0</span></span></span></span></span></p>',
+    [
+      MathBlockNode(
+        texSource: "\\Huge 1\n\\huge 2\n\\LARGE 3\n\\Large 4\n\\large 5\n\\normalsize 6\n\\small 7\n\\footnotesize 8\n\\scriptsize 9\n\\tiny 0",
+        nodes: [
+          KatexNode(
+            styles: KatexSpanStyles(),
+            text: null,
+            nodes: [
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: []),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 2.488), // .reset-size6.size11
+                text: '1',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 2.074), // .reset-size6.size10
+                text: '2',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 1.728), // .reset-size6.size9
+                text: '3',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 1.44), // .reset-size6.size8
+                text: '4',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 1.2), // .reset-size6.size7
+                text: '5',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 1.0), // .reset-size6.size6
+                text: '6',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 0.9), // .reset-size6.size5
+                text: '7',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 0.8), // .reset-size6.size4
+                text: '8',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 0.7), // .reset-size6.size3
+                text: '9',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 0.5), // .reset-size6.size1
+                text: '0',
+                nodes: null),
+            ]),
+        ]),
+    ]);
+
+  static final mathBlockKatexNestedSizing = ContentExample(
+    'math block; KaTeX nested sizing',
+    '```math\n\\tiny {1 \\Huge 2}\n```',
+    '<p>'
+      '<span class="katex-display"><span class="katex">'
+        '<span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="0.5em"><mrow><mn>1</mn><mstyle mathsize="2.488em"><mn>2</mn></mstyle></mrow></mstyle></mrow>'
+          '<annotation encoding="application/x-tex">\\tiny {1 \\Huge 2}</annotation></semantics></math></span>'
+        '<span class="katex-html" aria-hidden="true">'
+          '<span class="base">'
+            '<span class="strut" style="height:1.6034em;"></span>'
+            '<span class="mord sizing reset-size6 size1">'
+              '<span class="mord">1</span>'
+              '<span class="mord sizing reset-size1 size11">2</span></span></span></span></span></span></p>',
+    [
+      MathBlockNode(
+        texSource: '\\tiny {1 \\Huge 2}',
+        nodes: [
+          KatexNode(
+            styles: KatexSpanStyles(),
+            text: null,
+            nodes: [
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: []),
+              KatexNode(
+                styles: KatexSpanStyles(fontSizeEm: 0.5), // reset-size6 size1
+                text: null,
+                nodes: [
+                  KatexNode(
+                    styles: KatexSpanStyles(),
+                    text: '1',
+                    nodes: null),
+                  KatexNode(
+                    styles: KatexSpanStyles(fontSizeEm: 4.976), // reset-size1 size11
+                    text: '2',
+                    nodes: null),
+                ]),
+            ]),
+        ]),
+    ]);
+
+  static final mathBlockKatexDelimSizing = ContentExample(
+    'math block; KaTeX delimiter sizing',
+    // https://chat.zulip.org/#narrow/channel/7-test-here/topic/Rajesh/near/2147135
+    '```math\n⟨ \\big( \\Big[ \\bigg⌈ \\Bigg⌊\n```',
+    '<p>'
+      '<span class="katex-display"><span class="katex">'
+        '<span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">⟨</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">[</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">⌈</mo><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">⌊</mo></mrow>'
+          '<annotation encoding="application/x-tex">⟨ \\big( \\Big[ \\bigg⌈ \\Bigg⌊</annotation></semantics></math></span>'
+        '<span class="katex-html" aria-hidden="true">'
+          '<span class="base">'
+            '<span class="strut" style="height:3em;vertical-align:-1.25em;"></span>'
+            '<span class="mopen">⟨</span>'
+            '<span class="mord"><span class="delimsizing size1">(</span></span>'
+            '<span class="mord"><span class="delimsizing size2">[</span></span>'
+            '<span class="mord"><span class="delimsizing size3">⌈</span></span>'
+            '<span class="mord"><span class="delimsizing size4">⌊</span></span></span></span></span></span></p>',
+    [
+      MathBlockNode(
+        texSource: '⟨ \\big( \\Big[ \\bigg⌈ \\Bigg⌊',
+        nodes: [
+          KatexNode(
+            styles: KatexSpanStyles(),
+            text: null,
+            nodes: [
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: []),
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: '⟨',
+                nodes: null),
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: [
+                  KatexNode(
+                    styles: KatexSpanStyles(fontFamily: 'KaTeX_Size1'),
+                    text: '(',
+                    nodes: null),
+                ]),
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: [
+                  KatexNode(
+                    styles: KatexSpanStyles(fontFamily: 'KaTeX_Size2'),
+                    text: '[',
+                    nodes: null),
+                ]),
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: [
+                  KatexNode(
+                    styles: KatexSpanStyles(fontFamily: 'KaTeX_Size3'),
+                    text: '⌈',
+                    nodes: null),
+                ]),
+              KatexNode(
+                styles: KatexSpanStyles(),
+                text: null,
+                nodes: [
+                  KatexNode(
+                    styles: KatexSpanStyles(fontFamily: 'KaTeX_Size4'),
+                    text: '⌊',
+                    nodes: null),
+                ]),
+            ]),
+        ]),
+    ]);
+
   static const imageSingle = ContentExample(
     'single image',
     // https://chat.zulip.org/#narrow/stream/7-test-here/topic/Thumbnails/near/1900103
@@ -1724,6 +1958,9 @@ void main() async {
   testParseExample(ContentExample.mathBlockInQuote);
   testParseExample(ContentExample.mathBlocksMultipleInQuote);
   testParseExample(ContentExample.mathBlockBetweenImages);
+  testParseExample(ContentExample.mathBlockKatexSizing);
+  testParseExample(ContentExample.mathBlockKatexNestedSizing);
+  testParseExample(ContentExample.mathBlockKatexDelimSizing);
 
   testParseExample(ContentExample.imageSingle);
   testParseExample(ContentExample.imageSingleNoDimensions);
diff --git a/test/widgets/content_test.dart b/test/widgets/content_test.dart
index 3bfbe26d63..a788225aac 100644
--- a/test/widgets/content_test.dart
+++ b/test/widgets/content_test.dart
@@ -571,6 +571,95 @@ void main() {
       await prepareContent(tester, plainContent(ContentExample.mathBlock.html));
       tester.widget(find.text('λ', findRichText: true));
     });
+
+    void checkKatexText(
+      WidgetTester tester,
+      String text, {
+      required String fontFamily,
+      required double fontSize,
+      required double fontHeight,
+    }) {
+      check(mergedStyleOf(tester, text)).isNotNull()
+        ..fontFamily.equals(fontFamily)
+        ..fontSize.equals(fontSize);
+      check(tester.getSize(find.text(text)))
+        .height.isCloseTo(fontSize * fontHeight, 0.5);
+    }
+
+    testWidgets('displays KaTeX content with different sizing', (tester) async {
+      addTearDown(testBinding.reset);
+      final globalSettings = testBinding.globalStore.settings;
+      await globalSettings.setBool(BoolGlobalSetting.renderKatex, true);
+      check(globalSettings).getBool(BoolGlobalSetting.renderKatex).isTrue();
+
+      final content = ContentExample.mathBlockKatexSizing;
+      await prepareContent(tester, plainContent(content.html));
+
+      final mathBlockNode = content.expectedNodes.single as MathBlockNode;
+      final baseNode = mathBlockNode.nodes!.single;
+      final nodes = baseNode.nodes!.skip(1); // Skip .strut node.
+      for (final katexNode in nodes) {
+        final fontSize = katexNode.styles.fontSizeEm! * kBaseKatexTextStyle.fontSize!;
+        checkKatexText(tester, katexNode.text!,
+          fontFamily: 'KaTeX_Main',
+          fontSize: fontSize,
+          fontHeight: kBaseKatexTextStyle.height!);
+      }
+    });
+
+    testWidgets('displays KaTeX content with nested sizing', (tester) async {
+      addTearDown(testBinding.reset);
+      final globalSettings = testBinding.globalStore.settings;
+      await globalSettings.setBool(BoolGlobalSetting.renderKatex, true);
+      check(globalSettings).getBool(BoolGlobalSetting.renderKatex).isTrue();
+
+      final content = ContentExample.mathBlockKatexNestedSizing;
+      await prepareContent(tester, plainContent(content.html));
+
+      var fontSize = 0.5 * kBaseKatexTextStyle.fontSize!;
+      checkKatexText(tester, '1',
+        fontFamily: 'KaTeX_Main',
+        fontSize: fontSize,
+        fontHeight: kBaseKatexTextStyle.height!);
+
+      fontSize = 4.976 * fontSize;
+      checkKatexText(tester, '2',
+        fontFamily: 'KaTeX_Main',
+        fontSize: fontSize,
+        fontHeight: kBaseKatexTextStyle.height!);
+    });
+
+    testWidgets('displays KaTeX content with different delimiter sizing', (tester) async {
+      addTearDown(testBinding.reset);
+      final globalSettings = testBinding.globalStore.settings;
+      await globalSettings.setBool(BoolGlobalSetting.renderKatex, true);
+      check(globalSettings).getBool(BoolGlobalSetting.renderKatex).isTrue();
+
+      final content = ContentExample.mathBlockKatexDelimSizing;
+      await prepareContent(tester, plainContent(content.html));
+
+      final mathBlockNode = content.expectedNodes.single as MathBlockNode;
+      final baseNode = mathBlockNode.nodes!.single;
+      var nodes = baseNode.nodes!.skip(1); // Skip .strut node.
+
+      final fontSize = kBaseKatexTextStyle.fontSize!;
+
+      final firstNode = nodes.first;
+      checkKatexText(tester, firstNode.text!,
+        fontFamily: 'KaTeX_Main',
+        fontSize: fontSize,
+        fontHeight: kBaseKatexTextStyle.height!);
+      nodes = nodes.skip(1);
+
+      for (var katexNode in nodes) {
+        katexNode = katexNode.nodes!.single; // Skip empty .mord parent.
+        final fontFamily = katexNode.styles.fontFamily!;
+        checkKatexText(tester, katexNode.text!,
+          fontFamily: fontFamily,
+          fontSize: fontSize,
+          fontHeight: kBaseKatexTextStyle.height!);
+      }
+    });
   });
 
   /// Make a [TargetFontSizeFinder] to pass to [checkFontSizeRatio],
