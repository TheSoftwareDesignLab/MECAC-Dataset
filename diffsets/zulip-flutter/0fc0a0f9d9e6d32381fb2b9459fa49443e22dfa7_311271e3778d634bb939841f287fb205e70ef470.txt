diff --git a/android/app/src/main/kotlin/com/zulip/flutter/Notifications.g.kt b/android/app/src/main/kotlin/com/zulip/flutter/Notifications.g.kt
index 023a6b20a1..5a7879112e 100644
--- a/android/app/src/main/kotlin/com/zulip/flutter/Notifications.g.kt
+++ b/android/app/src/main/kotlin/com/zulip/flutter/Notifications.g.kt
@@ -90,12 +90,15 @@ data class NotificationChannel (
 /**
  * Corresponds to `android.content.Intent`
  *
- * See: https://developer.android.com/reference/android/content/Intent
+ * See:
+ *   https://developer.android.com/reference/android/content/Intent
+ *   https://developer.android.com/reference/android/content/Intent#Intent(java.lang.String,%20android.net.Uri,%20android.content.Context,%20java.lang.Class%3C?%3E)
  *
  * Generated class from Pigeon that represents data sent in messages.
  */
 data class AndroidIntent (
   val action: String,
+  val dataUrl: String,
   val extras: Map<String?, String?>
 
 ) {
@@ -103,13 +106,15 @@ data class AndroidIntent (
     @Suppress("LocalVariableName")
     fun fromList(__pigeon_list: List<Any?>): AndroidIntent {
       val action = __pigeon_list[0] as String
-      val extras = __pigeon_list[1] as Map<String?, String?>
-      return AndroidIntent(action, extras)
+      val dataUrl = __pigeon_list[1] as String
+      val extras = __pigeon_list[2] as Map<String?, String?>
+      return AndroidIntent(action, dataUrl, extras)
     }
   }
   fun toList(): List<Any?> {
     return listOf(
       action,
+      dataUrl,
       extras,
     )
   }
diff --git a/android/app/src/main/kotlin/com/zulip/flutter/ZulipPlugin.kt b/android/app/src/main/kotlin/com/zulip/flutter/ZulipPlugin.kt
index aee3bdd4a8..539b02f4b2 100644
--- a/android/app/src/main/kotlin/com/zulip/flutter/ZulipPlugin.kt
+++ b/android/app/src/main/kotlin/com/zulip/flutter/ZulipPlugin.kt
@@ -3,6 +3,7 @@ package com.zulip.flutter
 import android.annotation.SuppressLint
 import android.content.Context
 import android.content.Intent
+import android.net.Uri
 import android.os.Bundle
 import android.util.Log
 import androidx.annotation.Keep
@@ -97,8 +98,12 @@ private class AndroidNotificationHost(val context: Context)
             contentIntent?.let { setContentIntent(
                 android.app.PendingIntent.getActivity(context,
                     it.requestCode.toInt(),
-                    it.intent.let { intent -> Intent(context, MainActivity::class.java).apply {
-                        action = intent.action
+                    it.intent.let { intent -> Intent(
+                        intent.action,
+                        Uri.parse(intent.dataUrl),
+                        context,
+                        MainActivity::class.java
+                    ).apply {
                         intent.extras.forEach { (k, v) -> putExtra(k!!, v!!) }
                     } },
                     it.flags.toInt())
diff --git a/assets/l10n/app_en.arb b/assets/l10n/app_en.arb
index 0ae6984e41..aea0c83d38 100644
--- a/assets/l10n/app_en.arb
+++ b/assets/l10n/app_en.arb
@@ -558,5 +558,13 @@
   "pollWidgetOptionsMissing": "This poll has no options yet.",
   "@pollWidgetOptionsMissing": {
     "description": "Text to display for a poll when it has no options"
+  },
+  "errorNotificationOpenTitle": "Failed to open notification",
+  "@errorNotificationOpenTitle": {
+    "description": "Error title when notification opening fails"
+  },
+  "errorNotificationOpenAccountMissing": "The account associated with this notification no longer exists.",
+  "@errorNotificationOpenAccountMissing": {
+    "description": "Error message when the account associated with the notification is not found"
   }
 }
diff --git a/lib/host/android_notifications.dart b/lib/host/android_notifications.dart
index e7b998de18..a0cb6fc718 100644
--- a/lib/host/android_notifications.dart
+++ b/lib/host/android_notifications.dart
@@ -60,3 +60,11 @@ abstract class PendingIntentFlag {
   /// Corresponds to `FLAG_ALLOW_UNSAFE_IMPLICIT_INTENT`.
   static const allowUnsafeImplicitIntent = 1 << 24;
 }
+
+/// For use in [AndroidIntent.action].
+///
+/// See: https://developer.android.com/reference/android/content/Intent#constants_1
+abstract class IntentAction {
+  /// Corresponds to `ACTION_VIEW`.
+  static const view = 'android.intent.action.VIEW';
+}
diff --git a/lib/host/android_notifications.g.dart b/lib/host/android_notifications.g.dart
index 83c851a2a2..aa50c4a580 100644
--- a/lib/host/android_notifications.g.dart
+++ b/lib/host/android_notifications.g.dart
@@ -65,20 +65,26 @@ class NotificationChannel {
 
 /// Corresponds to `android.content.Intent`
 ///
-/// See: https://developer.android.com/reference/android/content/Intent
+/// See:
+///   https://developer.android.com/reference/android/content/Intent
+///   https://developer.android.com/reference/android/content/Intent#Intent(java.lang.String,%20android.net.Uri,%20android.content.Context,%20java.lang.Class%3C?%3E)
 class AndroidIntent {
   AndroidIntent({
     required this.action,
+    required this.dataUrl,
     required this.extras,
   });
 
   String action;
 
+  String dataUrl;
+
   Map<String?, String?> extras;
 
   Object encode() {
     return <Object?>[
       action,
+      dataUrl,
       extras,
     ];
   }
@@ -87,7 +93,8 @@ class AndroidIntent {
     result as List<Object?>;
     return AndroidIntent(
       action: result[0]! as String,
-      extras: (result[1] as Map<Object?, Object?>?)!.cast<String?, String?>(),
+      dataUrl: result[1]! as String,
+      extras: (result[2] as Map<Object?, Object?>?)!.cast<String?, String?>(),
     );
   }
 }
diff --git a/lib/notifications/display.dart b/lib/notifications/display.dart
index 618eacdc58..82160c6fbf 100644
--- a/lib/notifications/display.dart
+++ b/lib/notifications/display.dart
@@ -5,9 +5,9 @@ import 'dart:io';
 import 'package:http/http.dart' as http;
 import 'package:collection/collection.dart';
 import 'package:crypto/crypto.dart';
+import 'package:flutter_gen/gen_l10n/zulip_localizations.dart';
 import 'package:flutter/foundation.dart';
 import 'package:flutter/widgets.dart' hide Notification;
-import 'package:flutter_local_notifications/flutter_local_notifications.dart' hide Person;
 
 import '../api/notifications.dart';
 import '../host/android_notifications.dart';
@@ -17,6 +17,7 @@ import '../model/localizations.dart';
 import '../model/narrow.dart';
 import '../widgets/app.dart';
 import '../widgets/color.dart';
+import '../widgets/dialog.dart';
 import '../widgets/message_list.dart';
 import '../widgets/page.dart';
 import '../widgets/store.dart';
@@ -95,16 +96,6 @@ class NotificationChannelManager {
 /// Service for managing the notifications shown to the user.
 class NotificationDisplayManager {
   static Future<void> init() async {
-    await ZulipBinding.instance.notifications.initialize(
-      const InitializationSettings(
-        android: AndroidInitializationSettings('zulip_notification'),
-      ),
-      onDidReceiveNotificationResponse: _onNotificationOpened,
-    );
-    final launchDetails = await ZulipBinding.instance.notifications.getNotificationAppLaunchDetails();
-    if (launchDetails?.didNotificationLaunchApp ?? false) {
-      _handleNotificationAppLaunch(launchDetails!.notificationResponse);
-    }
     await NotificationChannelManager.ensureChannel();
   }
 
@@ -168,6 +159,16 @@ class NotificationDisplayManager {
         name: data.senderFullName,
         iconBitmap: await _fetchBitmap(data.senderAvatarUrl))));
 
+    final intentDataUrl = NotificationOpenPayload(
+      realmUrl: data.realmUrl,
+      userId: data.userId,
+      narrow: switch (data.recipient) {
+        FcmMessageChannelRecipient(:var streamId, :var topic) =>
+          TopicNarrow(streamId, topic),
+        FcmMessageDmRecipient(:var allRecipientIds) =>
+          DmNarrow(allRecipientIds: allRecipientIds, selfUserId: data.userId),
+      }).buildUrl();
+
     await _androidHost.notify(
       // TODO the notification ID can be constant, instead of matching requestCode
       //   (This is a legacy of `flutter_local_notifications`.)
@@ -205,13 +206,9 @@ class NotificationDisplayManager {
         //   (That's a legacy of `flutter_local_notifications`.)
         flags: PendingIntentFlag.immutable | PendingIntentFlag.updateCurrent,
         intent: AndroidIntent(
-          // This action name and extra name are special to
-          // FlutterLocalNotificationsPlugin, which handles receiving the Intent.
-          // TODO take care of receiving the notification-opened Intent ourselves
-          action: 'SELECT_NOTIFICATION',
-          extras: <String, String>{
-            'payload': jsonEncode(dataJson),
-          }),
+          action: IntentAction.view,
+          dataUrl: intentDataUrl.toString(),
+          extras: {}),
         // TODO this doesn't set the Intent flags we set in zulip-mobile; is that OK?
         //   (This is a legacy of `flutter_local_notifications`.)
         ),
@@ -348,46 +345,36 @@ class NotificationDisplayManager {
 
   static String _personKey(Uri realmUrl, int userId) => "$realmUrl|$userId";
 
-  static void _onNotificationOpened(NotificationResponse response) async {
-    final payload = jsonDecode(response.payload!) as Map<String, dynamic>;
-    final data = MessageFcmMessage.fromJson(payload);
-    assert(debugLog('opened notif: message ${data.zulipMessageId}, content ${data.content}'));
-    _navigateForNotification(data);
-  }
-
-  static void _handleNotificationAppLaunch(NotificationResponse? response) async {
-    assert(response != null);
-    if (response == null) return; // TODO(log) seems like a bug in flutter_local_notifications if this can happen
+  /// Navigates to the [MessageListPage] of the specific conversation
+  /// given the `zulip://notification/…` Android intent data URL,
+  /// generated with [NotificationOpenPayload.buildUrl] while creating
+  /// the notification.
+  static Future<void> navigateForNotification(Uri url) async {
+    assert(debugLog('opened notif: url: $url'));
 
-    final payload = jsonDecode(response.payload!) as Map<String, dynamic>;
-    final data = MessageFcmMessage.fromJson(payload);
-    assert(debugLog('launched from notif: message ${data.zulipMessageId}, content ${data.content}'));
-    _navigateForNotification(data);
-  }
+    assert(url.scheme == 'zulip' && url.host == 'notification');
+    final payload = NotificationOpenPayload.parseUrl(url);
 
-  static void _navigateForNotification(MessageFcmMessage data) async {
     NavigatorState navigator = await ZulipApp.navigator;
     final context = navigator.context;
     assert(context.mounted);
     if (!context.mounted) return; // TODO(linter): this is impossible as there's no actual async gap, but the use_build_context_synchronously lint doesn't see that
 
+    final zulipLocalizations = ZulipLocalizations.of(context);
     final globalStore = GlobalStoreWidget.of(context);
     final account = globalStore.accounts.firstWhereOrNull((account) =>
-      account.realmUrl == data.realmUrl && account.userId == data.userId);
-    if (account == null) return; // TODO(log)
-
-    final narrow = switch (data.recipient) {
-      FcmMessageChannelRecipient(:var streamId, :var topic) =>
-        TopicNarrow(streamId, topic),
-      FcmMessageDmRecipient(:var allRecipientIds) =>
-        DmNarrow(allRecipientIds: allRecipientIds, selfUserId: account.userId),
-    };
+      account.realmUrl == payload.realmUrl && account.userId == payload.userId);
+    if (account == null) { // TODO(log)
+      showErrorDialog(context: context,
+        title: zulipLocalizations.errorNotificationOpenTitle,
+        message: zulipLocalizations.errorNotificationOpenAccountMissing);
+      return;
+    }
 
-    assert(debugLog('  account: $account, narrow: $narrow'));
     // TODO(nav): Better interact with existing nav stack on notif open
     unawaited(navigator.push(MaterialAccountWidgetRoute<void>(accountId: account.id,
       // TODO(#82): Open at specific message, not just conversation
-      page: MessageListPage(initNarrow: narrow))));
+      page: MessageListPage(initNarrow: payload.narrow))));
   }
 
   static Future<Uint8List?> _fetchBitmap(Uri url) async {
@@ -403,3 +390,86 @@ class NotificationDisplayManager {
     return null;
   }
 }
+
+/// The information contained in 'zulip://notification/…' internal
+/// Android intent data URL, used for notification-open flow.
+class NotificationOpenPayload {
+  final Uri realmUrl;
+  final int userId;
+  final Narrow narrow;
+
+  NotificationOpenPayload({
+    required this.realmUrl,
+    required this.userId,
+    required this.narrow,
+  });
+
+  factory NotificationOpenPayload.parseUrl(Uri url) {
+    if (url case Uri(
+      scheme: 'zulip',
+      host: 'notification',
+      queryParameters: {
+        'realm_url': var realmUrlStr,
+        'user_id': var userIdStr,
+        'narrow_type': var narrowType,
+        // In case of narrowType == 'topic':
+        // 'channel_id' and 'topic' handled below.
+
+        // In case of narrowType == 'dm':
+        // 'all_recipient_ids' handled below.
+      },
+    )) {
+      final realmUrl = Uri.parse(realmUrlStr);
+      final userId = int.parse(userIdStr, radix: 10);
+
+      final Narrow narrow;
+      switch (narrowType) {
+        case 'topic':
+          final channelIdStr = url.queryParameters['channel_id']!;
+          final channelId = int.parse(channelIdStr, radix: 10);
+          final topic = url.queryParameters['topic']!;
+          narrow = TopicNarrow(channelId, topic);
+        case 'dm':
+          final allRecipientIdsStr = url.queryParameters['all_recipient_ids']!;
+          final allRecipientIds = allRecipientIdsStr.split(',')
+            .map((idStr) => int.parse(idStr, radix: 10))
+            .toList(growable: false);
+          narrow = DmNarrow(allRecipientIds: allRecipientIds, selfUserId: userId);
+        default:
+          throw const FormatException();
+      }
+
+      return NotificationOpenPayload(
+        realmUrl: realmUrl,
+        userId: userId,
+        narrow: narrow,
+      );
+    } else {
+      // TODO(dart): simplify after https://github.com/dart-lang/language/issues/2537
+      throw const FormatException();
+    }
+  }
+
+  Uri buildUrl() {
+    return Uri(
+      scheme: 'zulip',
+      host: 'notification',
+      queryParameters: <String, String>{
+        'realm_url': realmUrl.toString(),
+        'user_id': userId.toString(),
+        ...(switch (narrow) {
+          TopicNarrow(streamId: var channelId, :var topic) => {
+            'narrow_type': 'topic',
+            'channel_id': channelId.toString(),
+            'topic': topic,
+          },
+          DmNarrow(:var allRecipientIds) => {
+            'narrow_type': 'dm',
+            'all_recipient_ids': allRecipientIds.join(','),
+          },
+          _ => throw UnsupportedError('Found an unexpected Narrow of type ${narrow.runtimeType}.'),
+        })
+      },
+    );
+  }
+}
diff --git a/lib/widgets/app.dart b/lib/widgets/app.dart
index fac501da4b..7091a2a927 100644
--- a/lib/widgets/app.dart
+++ b/lib/widgets/app.dart
@@ -8,6 +8,7 @@ import 'package:flutter_gen/gen_l10n/zulip_localizations.dart';
 import '../log.dart';
 import '../model/localizations.dart';
 import '../model/narrow.dart';
+import '../notifications/display.dart';
 import 'about_zulip.dart';
 import 'app_bar.dart';
 import 'dialog.dart';
@@ -144,19 +145,29 @@ class ZulipApp extends StatefulWidget {
 class _ZulipAppState extends State<ZulipApp> with WidgetsBindingObserver {
   @override
   Future<bool> didPushRouteInformation(routeInformation) async {
-    if (routeInformation case RouteInformation(
-      uri: Uri(scheme: 'zulip', host: 'login') && var url)
-    ) {
-      await LoginPage.handleWebAuthUrl(url);
-      return true;
+    switch (routeInformation.uri) {
+      case Uri(scheme: 'zulip', host: 'login') && var url:
+        await LoginPage.handleWebAuthUrl(url);
+        return true;
+      case Uri(scheme: 'zulip', host: 'notification') && var url:
+        await NotificationDisplayManager.navigateForNotification(url);
+        return true;
     }
     return super.didPushRouteInformation(routeInformation);
   }
 
+  Future<void> _handleInitialRoute() async {
+    final initialRouteUrl = Uri.parse(WidgetsBinding.instance.platformDispatcher.defaultRouteName);
+    if (initialRouteUrl case Uri(scheme: 'zulip', host: 'notification')) {
+      await NotificationDisplayManager.navigateForNotification(initialRouteUrl);
+    }
+  }
+
   @override
   void initState() {
     super.initState();
     WidgetsBinding.instance.addObserver(this);
+    _handleInitialRoute();
   }
 
   @override
diff --git a/pigeon/notifications.dart b/pigeon/notifications.dart
index 78c442fa9d..f34c0f8187 100644
--- a/pigeon/notifications.dart
+++ b/pigeon/notifications.dart
@@ -38,11 +38,14 @@ class NotificationChannel {
 
 /// Corresponds to `android.content.Intent`
 ///
-/// See: https://developer.android.com/reference/android/content/Intent
+/// See:
+///   https://developer.android.com/reference/android/content/Intent
+///   https://developer.android.com/reference/android/content/Intent#Intent(java.lang.String,%20android.net.Uri,%20android.content.Context,%20java.lang.Class%3C?%3E)
 class AndroidIntent {
-  AndroidIntent({required this.action, required this.extras});
+  AndroidIntent({required this.action, required this.dataUrl, required this.extras});
 
   final String action;
+  final String dataUrl;
   final Map<String?, String?> extras;
 }
 
diff --git a/test/model/narrow_checks.dart b/test/model/narrow_checks.dart
index 9d299a8a27..241547d782 100644
--- a/test/model/narrow_checks.dart
+++ b/test/model/narrow_checks.dart
@@ -11,3 +11,8 @@ extension DmNarrowChecks on Subject<DmNarrow> {
   Subject<List<int>> get allRecipientIds => has((x) => x.allRecipientIds, 'allRecipientIds');
   Subject<List<int>> get otherRecipientIds => has((x) => x.otherRecipientIds, 'otherRecipientIds');
 }
+
+extension TopicNarrowChecks on Subject<TopicNarrow> {
+  Subject<int> get streamId => has((x) => x.streamId, 'streamId');
+  Subject<String> get topic => has((x) => x.topic, 'topic');
+}
diff --git a/test/notifications/display_test.dart b/test/notifications/display_test.dart
index 8ad48b29aa..1f6d897237 100644
--- a/test/notifications/display_test.dart
+++ b/test/notifications/display_test.dart
@@ -1,4 +1,4 @@
-import 'dart:convert';
+import 'dart:async';
 import 'dart:io';
 import 'dart:typed_data';
 
@@ -6,8 +6,7 @@ import 'package:checks/checks.dart';
 import 'package:collection/collection.dart';
 import 'package:fake_async/fake_async.dart';
 import 'package:firebase_messaging/firebase_messaging.dart';
-import 'package:flutter/widgets.dart' hide Notification;
-import 'package:flutter_local_notifications/flutter_local_notifications.dart' hide Message, Person;
+import 'package:flutter/material.dart' hide Notification;
 import 'package:flutter_test/flutter_test.dart';
 import 'package:http/http.dart' as http;
 import 'package:http/testing.dart' as http_testing;
@@ -29,8 +28,11 @@ import 'package:zulip/widgets/theme.dart';
 import '../fake_async.dart';
 import '../model/binding.dart';
 import '../example_data.dart' as eg;
+import '../model/narrow_checks.dart';
+import '../stdlib_checks.dart';
 import '../test_images.dart';
 import '../test_navigation.dart';
+import '../widgets/dialog_checks.dart';
 import '../widgets/message_list_checks.dart';
 import '../widgets/page_checks.dart';
 
@@ -226,6 +228,15 @@ void main() {
       const expectedIntentFlags =
         PendingIntentFlag.immutable | PendingIntentFlag.updateCurrent;
       final expectedSelfUserKey = '${data.realmUrl}|${data.userId}';
+      final expectedIntentDataUrl = NotificationOpenPayload(
+        realmUrl: data.realmUrl,
+        userId: data.userId,
+        narrow: switch (data.recipient) {
+        FcmMessageChannelRecipient(:var streamId, :var topic) =>
+          TopicNarrow(streamId, topic),
+        FcmMessageDmRecipient(:var allRecipientIds) =>
+          DmNarrow(allRecipientIds: allRecipientIds, selfUserId: data.userId),
+      }).buildUrl();
 
       final messageStyleMessagesChecks =
         messageStyleMessages.mapIndexed((i, messageData) {
@@ -273,10 +284,9 @@ void main() {
               ..requestCode.equals(expectedId)
               ..flags.equals(expectedIntentFlags)
               ..intent.which((it) => it
-                ..action.equals('SELECT_NOTIFICATION')
-                ..extras.deepEquals({
-                  'payload': jsonEncode(data.toJson()),
-                }))),
+                ..action.equals(IntentAction.view)
+                ..dataUrl.equals(expectedIntentDataUrl.toString())
+                ..extras.deepEquals({}))),
           (it) => it.isA<AndroidNotificationHostApiNotifyCall>()
             ..id.equals(NotificationDisplayManager.notificationIdAsHashOf(expectedGroupKey))
             ..tag.equals(expectedGroupKey)
@@ -715,7 +725,6 @@ void main() {
       check(testBinding.androidNotificationHost.activeNotifications).isEmpty();
     })));
 
-
     test('remove: different realm URLs but same user-ids and same message-ids', () => runWithHttpClient(() => awaitFakeAsync((async) async {
       await init();
       final stream = eg.stream();
@@ -838,11 +847,19 @@ void main() {
     }
 
     Future<void> openNotification(WidgetTester tester, Account account, Message message) async {
-      final fcmMessage = messageFcmMessage(message, account: account);
-      testBinding.notifications.receiveNotificationResponse(NotificationResponse(
-        notificationResponseType: NotificationResponseType.selectedNotification,
-        payload: jsonEncode(fcmMessage)));
-      await tester.idle(); // let _navigateForNotification find navigator
+      final data = messageFcmMessage(message, account: account);
+      final intentDataUrl = NotificationOpenPayload(
+        realmUrl: data.realmUrl,
+        userId: data.userId,
+        narrow: switch (data.recipient) {
+        FcmMessageChannelRecipient(:var streamId, :var topic) =>
+          TopicNarrow(streamId, topic),
+        FcmMessageDmRecipient(:var allRecipientIds) =>
+          DmNarrow(allRecipientIds: allRecipientIds, selfUserId: data.userId),
+      }).buildUrl();
+      unawaited(
+        WidgetsBinding.instance.handlePushRoute(intentDataUrl.toString()));
+      await tester.idle(); // let navigateForNotification find navigator
     }
 
     void matchesNavigation(Subject<Route<void>> route, Account account, Message message) {
@@ -877,7 +894,11 @@ void main() {
     testWidgets('no accounts', (tester) async {
       await prepare(tester, withAccount: false);
       await openNotification(tester, eg.selfAccount, eg.streamMessage());
-      check(pushedRoutes).isEmpty();
+      await tester.pump();
+      check(pushedRoutes.single).isA<DialogRoute<void>>();
+      await tester.tap(find.byWidget(checkErrorDialog(tester,
+        expectedTitle: zulipLocalizations.errorNotificationOpenTitle,
+        expectedMessage: zulipLocalizations.errorNotificationOpenAccountMissing)));
     });
 
     testWidgets('mismatching account', (tester) async {
@@ -885,7 +906,11 @@ void main() {
       await testBinding.globalStore.add(eg.selfAccount, eg.initialSnapshot());
       await prepare(tester);
       await openNotification(tester, eg.otherAccount, eg.streamMessage());
-      check(pushedRoutes).isEmpty();
+      await tester.pump();
+      check(pushedRoutes.single).isA<DialogRoute<void>>();
+      await tester.tap(find.byWidget(checkErrorDialog(tester,
+        expectedTitle: zulipLocalizations.errorNotificationOpenTitle,
+        expectedMessage: zulipLocalizations.errorNotificationOpenAccountMissing)));
     });
 
     testWidgets('find account among several', (tester) async {
@@ -933,14 +958,21 @@ void main() {
 
     testWidgets('at app launch', (tester) async {
       addTearDown(testBinding.reset);
-      // Set up a value for `getNotificationLaunchDetails` to return.
+      // Set up a value for `PlatformDispatcher.defaultRouteName` to return,
+      // for determining the intial route.
       final account = eg.selfAccount;
       final message = eg.streamMessage();
-      final response = NotificationResponse(
-        notificationResponseType: NotificationResponseType.selectedNotification,
-        payload: jsonEncode(messageFcmMessage(message, account: account)));
-      testBinding.notifications.appLaunchDetails =
-        NotificationAppLaunchDetails(true, notificationResponse: response);
+      final data = messageFcmMessage(message, account: account);
+      final intentDataUrl = NotificationOpenPayload(
+        realmUrl: data.realmUrl,
+        userId: data.userId,
+        narrow: switch (data.recipient) {
+        FcmMessageChannelRecipient(:var streamId, :var topic) =>
+          TopicNarrow(streamId, topic),
+        FcmMessageDmRecipient(:var allRecipientIds) =>
+          DmNarrow(allRecipientIds: allRecipientIds, selfUserId: data.userId),
+      }).buildUrl();
+      tester.binding.platformDispatcher.defaultRouteNameTestValue = intentDataUrl.toString();
 
       // Now start the app.
       await testBinding.globalStore.add(account, eg.initialSnapshot());
@@ -953,6 +985,202 @@ void main() {
       matchesNavigation(check(pushedRoutes).single, account, message);
     });
   });
+
+  group('NotificationOpenPayload', () {
+    test('smoke round-trip', () {
+      // DM narrow
+      var payload = NotificationOpenPayload(
+        realmUrl: Uri.parse('http://chat.example'),
+        userId: 1001,
+        narrow: DmNarrow(allRecipientIds: [1001, 1002], selfUserId: 1001),
+      );
+      var url = payload.buildUrl();
+      check(NotificationOpenPayload.parseUrl(url))
+        ..realmUrl.equals(payload.realmUrl)
+        ..userId.equals(payload.userId)
+        ..narrow.equals(payload.narrow);
+
+      // Topic narrow
+      payload = NotificationOpenPayload(
+        realmUrl: Uri.parse('http://chat.example'),
+        userId: 1001,
+        narrow: const TopicNarrow(1, 'topic A'),
+      );
+      url = payload.buildUrl();
+      check(NotificationOpenPayload.parseUrl(url))
+        ..realmUrl.equals(payload.realmUrl)
+        ..userId.equals(payload.userId)
+        ..narrow.equals(payload.narrow);
+    });
+
+    test('buildUrl: smoke DM', () {
+      final url = NotificationOpenPayload(
+        realmUrl: Uri.parse('http://chat.example'),
+        userId: 1001,
+        narrow: DmNarrow(allRecipientIds: [1001, 1002], selfUserId: 1001),
+      ).buildUrl();
+      check(url)
+        ..scheme.equals('zulip')
+        ..host.equals('notification')
+        ..queryParameters.deepEquals({
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'dm',
+          'all_recipient_ids': '1001,1002',
+        });
+    });
+
+    test('buildUrl: smoke topic', () {
+      final url = NotificationOpenPayload(
+        realmUrl: Uri.parse('http://chat.example'),
+        userId: 1001,
+        narrow: const TopicNarrow(1, 'topic A'),
+      ).buildUrl();
+      check(url)
+        ..scheme.equals('zulip')
+        ..host.equals('notification')
+        ..queryParameters.deepEquals({
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        });
+    });
+
+    test('parse: smoke DM', () {
+      final url = Uri(
+        scheme: 'zulip',
+        host: 'notification',
+        queryParameters: <String, String>{
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'dm',
+          'all_recipient_ids': '1001,1002',
+        });
+      check(NotificationOpenPayload.parseUrl(url))
+        ..realmUrl.equals(Uri.parse('http://chat.example'))
+        ..userId.equals(1001)
+        ..narrow.which((it) => it.isA<DmNarrow>()
+          ..allRecipientIds.deepEquals([1001, 1002])
+          ..otherRecipientIds.deepEquals([1002]));
+    });
+
+    test('parse: smoke topic', () {
+      final url = Uri(
+        scheme: 'zulip',
+        host: 'notification',
+        queryParameters: <String, String>{
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        });
+      check(NotificationOpenPayload.parseUrl(url))
+        ..realmUrl.equals(Uri.parse('http://chat.example'))
+        ..userId.equals(1001)
+        ..narrow.which((it) => it.isA<TopicNarrow>()
+          ..streamId.equals(1)
+          ..topic.equals('topic A'));
+    });
+
+    test('parse: fails when missing any expected query parameters', () {
+      final testCases = <Map<String, String>>[
+        {
+          // 'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          // 'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          // 'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          // 'channel_id': '1',
+          'topic': 'topic A',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          // 'topic': 'topic A',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          // 'narrow_type': 'dm',
+          'all_recipient_ids': '1001,1002',
+        },
+        {
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'dm',
+          // 'all_recipient_ids': '1001,1002',
+        },
+      ];
+      for (final params in testCases) {
+        check(() => NotificationOpenPayload.parseUrl(Uri(
+          scheme: 'zulip',
+          host: 'notification',
+          queryParameters: params,
+        )))
+          // Missing 'realm_url', 'user_id' and 'narrow_type'
+          // throws 'FormatException'.
+          // Missing 'channel_id', 'topic', when narrow_type == 'topic'
+          // throws 'TypeError'.
+          // Missing 'all_recipient_ids', when narrow_type == 'dm'
+          // throws 'TypeError'.
+          .throws<Object>();
+      }
+    });
+
+    test('parse: fails when scheme is not "zulip"', () {
+      final url = Uri(
+        scheme: 'http',
+        host: 'notification',
+        queryParameters: <String, String>{
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        });
+      check(() => NotificationOpenPayload.parseUrl(url))
+        .throws<FormatException>();
+    });
+
+    test('parse: fails when host is not "notification"', () {
+      final url = Uri(
+        scheme: 'zulip',
+        host: 'example',
+        queryParameters: <String, String>{
+          'realm_url': 'http://chat.example',
+          'user_id': '1001',
+          'narrow_type': 'topic',
+          'channel_id': '1',
+          'topic': 'topic A',
+        });
+      check(() => NotificationOpenPayload.parseUrl(url))
+        .throws<FormatException>();
+    });
+  });
 }
 
 extension NotificationChannelChecks on Subject<NotificationChannel> {
@@ -989,6 +1217,7 @@ extension on Subject<PendingIntent> {
 
 extension on Subject<AndroidIntent> {
   Subject<String> get action => has((x) => x.action, 'action');
+  Subject<String> get dataUrl => has((x) => x.dataUrl, 'dataUrl');
   Subject<Map<String?, String?>> get extras => has((x) => x.extras, 'extras');
 }
 
@@ -1025,3 +1254,9 @@ extension on Subject<StatusBarNotification> {
   Subject<Notification> get notification => has((x) => x.notification, 'notification');
   Subject<String> get tag => has((x) => x.tag, 'tag');
 }
+
+extension on Subject<NotificationOpenPayload> {
+  Subject<Uri> get realmUrl => has((x) => x.realmUrl, 'realmUrl');
+  Subject<int> get userId => has((x) => x.userId, 'userId');
+  Subject<Narrow> get narrow => has((x) => x.narrow, 'narrow');
+}
