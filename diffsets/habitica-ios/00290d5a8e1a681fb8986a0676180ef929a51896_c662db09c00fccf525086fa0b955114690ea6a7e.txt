diff --git a/HabitRPG/CollectionViewController/HRPGBaseCollectionViewController.m b/HabitRPG/CollectionViewController/HRPGBaseCollectionViewController.m
index 154917e99..5104c81e5 100644
--- a/HabitRPG/CollectionViewController/HRPGBaseCollectionViewController.m
+++ b/HabitRPG/CollectionViewController/HRPGBaseCollectionViewController.m
@@ -7,7 +7,6 @@
 //
 
 #import "HRPGBaseCollectionViewController.h"
-#import "HRPGNavigationController.h"
 #import "UIViewcontroller+TutorialSteps.h"
 #import "UIViewController+HRPGTopHeaderNavigationController.h"
 
@@ -45,13 +44,4 @@ - (void)preferredContentSizeChanged:(NSNotification *)notification {
     [self.collectionView reloadData];
 }
 
-- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
-    UIViewController *destViewController = segue.destinationViewController;
-    if ([destViewController isKindOfClass:[HRPGNavigationController class]]) {
-        HRPGNavigationController *destNavigationController =
-            (HRPGNavigationController *)destViewController;
-        destNavigationController.sourceViewController = self;
-    }
-}
-
 @end
diff --git a/HabitRPG/Generated/Storyboard Scenes.swift b/HabitRPG/Generated/Storyboard Scenes.swift
index d4c948895..0d29a861d 100644
--- a/HabitRPG/Generated/Storyboard Scenes.swift	
+++ b/HabitRPG/Generated/Storyboard Scenes.swift	
@@ -47,7 +47,7 @@ internal enum StoryboardScene {
 
     internal static let gemPurchaseViewController = SceneType<Habitica.GemViewController>(storyboard: Main.self, identifier: "GemPurchaseViewController")
 
-    internal static let giftSubscriptionNavController = SceneType<UIKit.UINavigationController>(storyboard: Main.self, identifier: "GiftSubscriptionNavController")
+    internal static let giftSubscriptionNavController = SceneType<Habitica.ThemedNavigationController>(storyboard: Main.self, identifier: "GiftSubscriptionNavController")
 
     internal static let giftSubscriptionViewController = SceneType<Habitica.GiftSubscriptionViewController>(storyboard: Main.self, identifier: "GiftSubscriptionViewController")
 
@@ -61,7 +61,7 @@ internal enum StoryboardScene {
 
     internal static let newsViewController = SceneType<Habitica.NewsViewController>(storyboard: Main.self, identifier: "NewsViewController")
 
-    internal static let notificationsNavigationController = SceneType<UIKit.UINavigationController>(storyboard: Main.self, identifier: "NotificationsNavigationController")
+    internal static let notificationsNavigationController = SceneType<Habitica.ThemedNavigationController>(storyboard: Main.self, identifier: "NotificationsNavigationController")
 
     internal static let petsOverviewViewController = SceneType<Habitica.PetOverviewViewController>(storyboard: Main.self, identifier: "PetsOverviewViewController")
 
@@ -77,12 +77,12 @@ internal enum StoryboardScene {
 
     internal static let spellTaskNavigationController = SceneType<UIKit.UINavigationController>(storyboard: Main.self, identifier: "spellTaskNavigationController")
 
-    internal static let tagNavigationController = SceneType<HRPGNavigationController>(storyboard: Main.self, identifier: "tagNavigationController")
+    internal static let tagNavigationController = SceneType<Habitica.ThemedNavigationController>(storyboard: Main.self, identifier: "tagNavigationController")
   }
   internal enum Settings: StoryboardType {
     internal static let storyboardName = "Settings"
 
-    internal static let initialScene = InitialSceneType<UIKit.UINavigationController>(storyboard: Settings.self)
+    internal static let initialScene = InitialSceneType<Habitica.ThemedNavigationController>(storyboard: Settings.self)
 
     internal static let authenticationSettingsViewController = SceneType<Habitica.AuthenticationSettingsViewController>(storyboard: Settings.self, identifier: "AuthenticationSettingsViewController")
 
@@ -103,13 +103,13 @@ internal enum StoryboardScene {
 
     internal static let challengeDetailViewController = SceneType<Habitica.ChallengeDetailsTableViewController>(storyboard: Social.self, identifier: "ChallengeDetailViewController")
 
-    internal static let challengeNavigationViewController = SceneType<UIKit.UINavigationController>(storyboard: Social.self, identifier: "ChallengeNavigationViewController")
+    internal static let challengeNavigationViewController = SceneType<Habitica.ThemedNavigationController>(storyboard: Social.self, identifier: "ChallengeNavigationViewController")
 
     internal static let challengeTableViewController = SceneType<Habitica.ChallengeTableViewController>(storyboard: Social.self, identifier: "ChallengeTableViewController")
 
     internal static let groupTableViewController = SceneType<Habitica.SplitSocialViewController>(storyboard: Social.self, identifier: "GroupTableViewController")
 
-    internal static let guidelinesNavigationViewController = SceneType<UIKit.UINavigationController>(storyboard: Social.self, identifier: "GuidelinesNavigationViewController")
+    internal static let guidelinesNavigationViewController = SceneType<Habitica.ThemedNavigationController>(storyboard: Social.self, identifier: "GuidelinesNavigationViewController")
 
     internal static let guidelinesViewController = SceneType<Habitica.GuidelinesViewController>(storyboard: Social.self, identifier: "GuidelinesViewController")
 
@@ -117,11 +117,11 @@ internal enum StoryboardScene {
 
     internal static let inboxChatViewController = SceneType<Habitica.InboxChatViewController>(storyboard: Social.self, identifier: "InboxChatViewController")
 
-    internal static let inboxNavigationViewController = SceneType<UIKit.UINavigationController>(storyboard: Social.self, identifier: "InboxNavigationViewController")
+    internal static let inboxNavigationViewController = SceneType<Habitica.ThemedNavigationController>(storyboard: Social.self, identifier: "InboxNavigationViewController")
 
     internal static let inboxViewController = SceneType<Habitica.InboxOverviewViewController>(storyboard: Social.self, identifier: "InboxViewController")
 
-    internal static let partyNavigationViewController = SceneType<UIKit.UINavigationController>(storyboard: Social.self, identifier: "PartyNavigationViewController")
+    internal static let partyNavigationViewController = SceneType<Habitica.ThemedNavigationController>(storyboard: Social.self, identifier: "PartyNavigationViewController")
 
     internal static let partyViewController = SceneType<Habitica.PartyViewController>(storyboard: Social.self, identifier: "PartyViewController")
 
@@ -129,7 +129,7 @@ internal enum StoryboardScene {
 
     internal static let tavernChatViewController = SceneType<Habitica.GroupChatViewController>(storyboard: Social.self, identifier: "TavernChatViewController")
 
-    internal static let tavernNavigationViewController = SceneType<UIKit.UINavigationController>(storyboard: Social.self, identifier: "TavernNavigationViewController")
+    internal static let tavernNavigationViewController = SceneType<Habitica.ThemedNavigationController>(storyboard: Social.self, identifier: "TavernNavigationViewController")
 
     internal static let tavernViewController = SceneType<Habitica.TavernViewController>(storyboard: Social.self, identifier: "TavernViewController")
 
diff --git a/HabitRPG/HRPGNavigationController.h b/HabitRPG/HRPGNavigationController.h
deleted file mode 100644
index 34068db42..000000000
--- a/HabitRPG/HRPGNavigationController.h
+++ /dev/null
@@ -1,15 +0,0 @@
-//
-//  HRPGNavigationController.h
-//  Habitica
-//
-//  Created by viirus on 07/09/14.
-//  Copyright © 2017 HabitRPG Inc. All rights reserved.
-//
-
-#import <UIKit/UIKit.h>
-
-@interface HRPGNavigationController : UINavigationController
-
-@property(nonatomic, weak) UIViewController *sourceViewController;
-
-@end
diff --git a/HabitRPG/HRPGNavigationController.m b/HabitRPG/HRPGNavigationController.m
deleted file mode 100644
index 6ef3c5bc5..000000000
--- a/HabitRPG/HRPGNavigationController.m
+++ /dev/null
@@ -1,38 +0,0 @@
-//
-//  HRPGNavigationController.m
-//  Habitica
-//
-//  Created by viirus on 07/09/14.
-//  Copyright © 2017 HabitRPG Inc. All rights reserved.
-//
-
-#import "HRPGNavigationController.h"
-
-@interface HRPGNavigationController ()
-
-@end
-
-@implementation HRPGNavigationController
-
-- (UIViewController *)viewControllerForUnwindSegueAction:(SEL)action
-                                      fromViewController:(UIViewController *)fromViewController
-                                              withSender:(id)sender {
-    if ([self.sourceViewController canPerformUnwindSegueAction:action
-                                            fromViewController:fromViewController
-                                                    withSender:sender])
-        return self.sourceViewController;
-    for (UIViewController *vc in self.viewControllers) {
-        // Always use -canPerformUnwindSegueAction:fromViewController:withSender:
-        // to determine if a view controller wants to handle an unwind action.
-        if ([vc canPerformUnwindSegueAction:action
-                         fromViewController:fromViewController
-                                 withSender:sender])
-            return vc;
-    }
-
-    return [super viewControllerForUnwindSegueAction:action
-                                  fromViewController:fromViewController
-                                          withSender:sender];
-}
-
-@end
diff --git a/HabitRPG/Storyboards/Base.lproj/Main.storyboard b/HabitRPG/Storyboards/Base.lproj/Main.storyboard
index 9e1e30a73..bec6f16f4 100644
--- a/HabitRPG/Storyboards/Base.lproj/Main.storyboard
+++ b/HabitRPG/Storyboards/Base.lproj/Main.storyboard
@@ -2377,10 +2377,10 @@
             </objects>
             <point key="canvasLocation" x="1035" y="5827"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="9Qs-Im-7zO">
             <objects>
-                <navigationController storyboardIdentifier="tagNavigationController" definesPresentationContext="YES" id="6vN-Em-JCA" customClass="HRPGNavigationController" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="tagNavigationController" definesPresentationContext="YES" id="6vN-Em-JCA" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="biY-dp-rGo">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -2462,10 +2462,10 @@
             </objects>
             <point key="canvasLocation" x="1982" y="-815"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="EPA-gN-a0D">
             <objects>
-                <navigationController automaticallyAdjustsScrollViewInsets="NO" id="tLB-b1-3s8" customClass="HRPGNavigationController" sceneMemberID="viewController">
+                <navigationController automaticallyAdjustsScrollViewInsets="NO" id="tLB-b1-3s8" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <toolbarItems/>
                     <navigationItem key="navigationItem" id="GEg-Ct-SF3"/>
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="AhC-6Z-AYO">
@@ -2573,10 +2573,10 @@
             </objects>
             <point key="canvasLocation" x="343" y="2641"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="5Un-yC-qQm">
             <objects>
-                <navigationController definesPresentationContext="YES" id="IOk-9k-SGo" customClass="HRPGNavigationController" sceneMemberID="viewController">
+                <navigationController definesPresentationContext="YES" id="IOk-9k-SGo" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="fUl-qS-mY6">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -2839,10 +2839,10 @@
             </objects>
             <point key="canvasLocation" x="2804" y="10417.241379310346"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="WeW-04-8lU">
             <objects>
-                <navigationController storyboardIdentifier="GiftSubscriptionNavController" id="KOH-m5-9hA" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="GiftSubscriptionNavController" id="KOH-m5-9hA" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="frT-yt-SsM">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -2855,10 +2855,10 @@
             </objects>
             <point key="canvasLocation" x="1993" y="10418"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="9x6-O0-kDN">
             <objects>
-                <navigationController storyboardIdentifier="NotificationsNavigationController" useStoryboardIdentifierAsRestorationIdentifier="YES" id="nb1-qt-uKV" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="NotificationsNavigationController" useStoryboardIdentifierAsRestorationIdentifier="YES" id="nb1-qt-uKV" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" insetsLayoutMarginsFromSafeArea="NO" id="ZYy-Vi-MXT">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
diff --git a/HabitRPG/Storyboards/Base.lproj/Settings.storyboard b/HabitRPG/Storyboards/Base.lproj/Settings.storyboard
index b86e9bf01..906a6a0f8 100644
--- a/HabitRPG/Storyboards/Base.lproj/Settings.storyboard
+++ b/HabitRPG/Storyboards/Base.lproj/Settings.storyboard
@@ -1,21 +1,19 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<document type="com.apple.InterfaceBuilder3.CocoaTouch.Storyboard.XIB" version="3.0" toolsVersion="14460.31" targetRuntime="iOS.CocoaTouch" propertyAccessControl="none" useAutolayout="YES" useTraitCollections="YES" useSafeAreas="YES" colorMatched="YES" initialViewController="Mxq-5y-Lb4">
-    <device id="retina4_7" orientation="portrait">
-        <adaptation id="fullscreen"/>
-    </device>
+<document type="com.apple.InterfaceBuilder3.CocoaTouch.Storyboard.XIB" version="3.0" toolsVersion="14865.1" targetRuntime="iOS.CocoaTouch" propertyAccessControl="none" useAutolayout="YES" useTraitCollections="YES" useSafeAreas="YES" colorMatched="YES" initialViewController="Mxq-5y-Lb4">
+    <device id="retina4_7" orientation="portrait" appearance="light"/>
     <dependencies>
         <deployment identifier="iOS"/>
-        <plugIn identifier="com.apple.InterfaceBuilder.IBCocoaTouchPlugin" version="14460.20"/>
+        <plugIn identifier="com.apple.InterfaceBuilder.IBCocoaTouchPlugin" version="14819.2"/>
         <capability name="Safe area layout guides" minToolsVersion="9.0"/>
         <capability name="documents saved in the Xcode 8 format" minToolsVersion="8.0"/>
     </dependencies>
     <scenes>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="dGW-NW-L6M">
             <objects>
-                <navigationController id="Mxq-5y-Lb4" sceneMemberID="viewController">
+                <navigationController id="Mxq-5y-Lb4" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" insetsLayoutMarginsFromSafeArea="NO" id="Klt-Yp-IvD">
-                        <rect key="frame" x="0.0" y="20" width="375" height="44"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
                     </navigationBar>
                     <connections>
@@ -72,7 +70,7 @@
                                 <rect key="frame" x="0.0" y="55.5" width="375" height="44"/>
                                 <autoresizingMask key="autoresizingMask"/>
                                 <tableViewCellContentView key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center" tableViewCell="i9j-Wr-mZF" id="jYM-Jj-GVI">
-                                    <rect key="frame" x="0.0" y="0.0" width="375" height="43.5"/>
+                                    <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <label opaque="NO" multipleTouchEnabled="YES" tag="1" contentMode="left" insetsLayoutMarginsFromSafeArea="NO" text="Title" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" id="JzQ-Jc-eSJ">
@@ -96,7 +94,7 @@
                                 <rect key="frame" x="0.0" y="99.5" width="375" height="44"/>
                                 <autoresizingMask key="autoresizingMask"/>
                                 <tableViewCellContentView key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center" tableViewCell="5YT-ZZ-fxC" id="X0W-Ex-Zfn">
-                                    <rect key="frame" x="0.0" y="0.0" width="375" height="43.5"/>
+                                    <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <label opaque="NO" userInteractionEnabled="NO" tag="1" contentMode="left" horizontalHuggingPriority="251" verticalHuggingPriority="251" text="" textAlignment="center" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="c5C-c8-WLD">
@@ -118,7 +116,7 @@
                                 <rect key="frame" x="0.0" y="143.5" width="375" height="320"/>
                                 <autoresizingMask key="autoresizingMask"/>
                                 <tableViewCellContentView key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center" tableViewCell="7os-8x-XfP" id="UT0-ba-e5Z">
-                                    <rect key="frame" x="0.0" y="0.0" width="375" height="319.5"/>
+                                    <rect key="frame" x="0.0" y="0.0" width="375" height="320"/>
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <view tag="1" contentMode="scaleToFill" translatesAutoresizingMaskIntoConstraints="NO" id="LAx-3w-uwb" customClass="HRPGQRCodeView">
@@ -165,7 +163,7 @@
             <objects>
                 <tableViewController id="Ph2-GT-Uhf" customClass="FixCharacterViewController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <tableView key="view" clipsSubviews="YES" contentMode="scaleToFill" alwaysBounceVertical="YES" dataMode="prototypes" style="plain" separatorStyle="none" allowsSelection="NO" rowHeight="-1" estimatedRowHeight="-1" sectionHeaderHeight="28" sectionFooterHeight="28" id="GOR-V4-lOf">
-                        <rect key="frame" x="0.0" y="0.0" width="375" height="667"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="647"/>
                         <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                         <color key="backgroundColor" white="1" alpha="1" colorSpace="calibratedWhite"/>
                         <prototypes>
@@ -196,7 +194,6 @@
                                                 </imageView>
                                                 <textField opaque="NO" tag="2" contentMode="scaleToFill" contentHorizontalAlignment="left" contentVerticalAlignment="center" textAlignment="natural" minimumFontSize="17" translatesAutoresizingMaskIntoConstraints="NO" id="94b-bq-IEo">
                                                     <rect key="frame" x="10" y="0.0" width="293" height="40"/>
-                                                    <nil key="textColor"/>
                                                     <fontDescription key="fontDescription" type="system" pointSize="14"/>
                                                     <textInputTraits key="textInputTraits" keyboardType="numbersAndPunctuation"/>
                                                     <connections>
@@ -262,7 +259,7 @@
             <objects>
                 <navigationController storyboardIdentifier="ClassSelectionNavigationController" id="J06-Jv-RSc" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" insetsLayoutMarginsFromSafeArea="NO" id="Gf6-Yw-Lx5">
-                        <rect key="frame" x="0.0" y="20" width="375" height="44"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
                         <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
                         <color key="barTintColor" white="1" alpha="1" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
@@ -377,7 +374,7 @@
             <objects>
                 <navigationController id="dIG-in-z1e" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" insetsLayoutMarginsFromSafeArea="NO" id="g7t-ee-dAo">
-                        <rect key="frame" x="0.0" y="20" width="375" height="44"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
                     </navigationBar>
                     <connections>
@@ -401,7 +398,7 @@
                                 <rect key="frame" x="0.0" y="55.5" width="375" height="44"/>
                                 <autoresizingMask key="autoresizingMask"/>
                                 <tableViewCellContentView key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center" tableViewCell="9AQ-G0-hE6" id="LYh-7u-FTX">
-                                    <rect key="frame" x="0.0" y="0.0" width="375" height="43.5"/>
+                                    <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <label opaque="NO" multipleTouchEnabled="YES" contentMode="left" text="" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" id="63Z-pb-uQz">
@@ -446,7 +443,7 @@
                                 <rect key="frame" x="0.0" y="55.5" width="375" height="44"/>
                                 <autoresizingMask key="autoresizingMask"/>
                                 <tableViewCellContentView key="contentView" opaque="NO" clipsSubviews="YES" multipleTouchEnabled="YES" contentMode="center" tableViewCell="BVQ-I3-Ozj" id="jeK-bp-DXC">
-                                    <rect key="frame" x="0.0" y="0.0" width="375" height="43.5"/>
+                                    <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <label opaque="NO" multipleTouchEnabled="YES" contentMode="left" text="Title" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" id="zlj-cZ-ex6">
diff --git a/HabitRPG/Storyboards/Base.lproj/Social.storyboard b/HabitRPG/Storyboards/Base.lproj/Social.storyboard
index 7d3938a68..eda6738c4 100644
--- a/HabitRPG/Storyboards/Base.lproj/Social.storyboard
+++ b/HabitRPG/Storyboards/Base.lproj/Social.storyboard
@@ -24,7 +24,7 @@
                                     <autoresizingMask key="autoresizingMask"/>
                                     <subviews>
                                         <label opaque="NO" userInteractionEnabled="NO" tag="1" contentMode="left" horizontalHuggingPriority="251" verticalHuggingPriority="1000" verticalCompressionResistancePriority="1000" text="" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="m6q-Ji-EAr" customClass="UsernameLabel" customModule="Habitica" customModuleProvider="target">
-                                            <rect key="frame" x="16" y="17" width="0.0" height="0.0"/>
+                                            <rect key="frame" x="60" y="11" width="0.0" height="0.0"/>
                                             <constraints>
                                                 <constraint firstAttribute="height" priority="501" constant="21" id="5uE-AJ-wfw"/>
                                             </constraints>
@@ -33,7 +33,7 @@
                                             <nil key="highlightedColor"/>
                                         </label>
                                         <label opaque="NO" userInteractionEnabled="NO" tag="2" contentMode="left" horizontalHuggingPriority="251" verticalHuggingPriority="1000" verticalCompressionResistancePriority="1000" text="" textAlignment="natural" lineBreakMode="tailTruncation" numberOfLines="3" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="e2S-uS-OIt">
-                                            <rect key="frame" x="16" y="44" width="323.5" height="112"/>
+                                            <rect key="frame" x="60" y="38" width="279.5" height="118"/>
                                             <constraints>
                                                 <constraint firstAttribute="height" priority="500" constant="18" id="E3i-j7-ITV"/>
                                             </constraints>
@@ -42,7 +42,7 @@
                                             <nil key="highlightedColor"/>
                                         </label>
                                         <label opaque="NO" userInteractionEnabled="NO" tag="3" contentMode="left" horizontalHuggingPriority="1000" verticalHuggingPriority="1000" horizontalCompressionResistancePriority="1000" verticalCompressionResistancePriority="1000" text="" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="HwB-Xq-If7">
-                                            <rect key="frame" x="347.5" y="17" width="0.0" height="0.0"/>
+                                            <rect key="frame" x="339.5" y="17" width="0.0" height="0.0"/>
                                             <constraints>
                                                 <constraint firstAttribute="width" priority="500" constant="40" id="riW-vf-B9F"/>
                                             </constraints>
@@ -51,7 +51,7 @@
                                             <nil key="highlightedColor"/>
                                         </label>
                                         <label opaque="NO" userInteractionEnabled="NO" tag="4" contentMode="left" horizontalHuggingPriority="1000" verticalHuggingPriority="1000" horizontalCompressionResistancePriority="1000" verticalCompressionResistancePriority="1000" text="" textAlignment="natural" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" adjustsFontSizeToFit="NO" translatesAutoresizingMaskIntoConstraints="NO" id="jAO-b2-Iy9">
-                                            <rect key="frame" x="16" y="21" width="0.0" height="19"/>
+                                            <rect key="frame" x="60" y="15" width="0.0" height="19"/>
                                             <constraints>
                                                 <constraint firstAttribute="height" priority="501" constant="19" id="ZpD-vC-wkU"/>
                                                 <constraint firstAttribute="width" priority="500" constant="42" id="qFL-LM-xZ9"/>
@@ -60,11 +60,11 @@
                                             <color key="textColor" red="0.64723795650000004" green="0.63275462390000003" blue="0.67308568950000003" alpha="1" colorSpace="custom" customColorSpace="sRGB"/>
                                             <nil key="highlightedColor"/>
                                         </label>
-                                        <view clipsSubviews="YES" contentMode="scaleToFill" translatesAutoresizingMaskIntoConstraints="NO" id="0vJ-cS-5P7">
-                                            <rect key="frame" x="8" y="11" width="0.0" height="36"/>
+                                        <view clipsSubviews="YES" tag="6" contentMode="scaleToFill" translatesAutoresizingMaskIntoConstraints="NO" id="0vJ-cS-5P7">
+                                            <rect key="frame" x="16" y="11" width="36" height="36"/>
                                             <subviews>
                                                 <view tag="5" contentMode="scaleToFill" translatesAutoresizingMaskIntoConstraints="NO" id="cOn-Go-iHY" customClass="AvatarView" customModule="Habitica" customModuleProvider="target">
-                                                    <rect key="frame" x="-29" y="-2" width="50" height="50"/>
+                                                    <rect key="frame" x="-12" y="-2" width="50" height="50"/>
                                                     <color key="backgroundColor" white="0.0" alpha="0.0" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
                                                     <constraints>
                                                         <constraint firstAttribute="height" constant="50" id="MHL-Ed-BXi"/>
@@ -75,8 +75,8 @@
                                             <color key="backgroundColor" white="0.0" alpha="0.0" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
                                             <constraints>
                                                 <constraint firstAttribute="height" constant="36" id="4Nw-m9-ixa"/>
-                                                <constraint firstItem="cOn-Go-iHY" firstAttribute="centerX" secondItem="0vJ-cS-5P7" secondAttribute="centerX" constant="-4" id="9Yq-Is-agM"/>
-                                                <constraint firstAttribute="width" id="PXy-ZU-VHe"/>
+                                                <constraint firstItem="cOn-Go-iHY" firstAttribute="centerX" secondItem="0vJ-cS-5P7" secondAttribute="centerX" constant="-5" id="9Yq-Is-agM"/>
+                                                <constraint firstAttribute="width" constant="36" id="PXy-ZU-VHe"/>
                                                 <constraint firstItem="cOn-Go-iHY" firstAttribute="centerY" secondItem="0vJ-cS-5P7" secondAttribute="centerY" constant="5" id="e2q-BK-07f"/>
                                             </constraints>
                                             <userDefinedRuntimeAttributes>
@@ -92,15 +92,15 @@
                                         <constraint firstItem="m6q-Ji-EAr" firstAttribute="leading" secondItem="0vJ-cS-5P7" secondAttribute="trailing" constant="8" id="NAz-or-qrg"/>
                                         <constraint firstItem="0vJ-cS-5P7" firstAttribute="top" secondItem="Kx6-Wm-aAQ" secondAttribute="top" constant="11" id="Pv0-vb-W4x"/>
                                         <constraint firstItem="HwB-Xq-If7" firstAttribute="height" secondItem="m6q-Ji-EAr" secondAttribute="height" id="Q6I-cU-1dm"/>
-                                        <constraint firstItem="m6q-Ji-EAr" firstAttribute="top" secondItem="Kx6-Wm-aAQ" secondAttribute="topMargin" constant="6" id="R7G-Vq-4Tj"/>
+                                        <constraint firstItem="m6q-Ji-EAr" firstAttribute="top" secondItem="Kx6-Wm-aAQ" secondAttribute="topMargin" id="R7G-Vq-4Tj"/>
                                         <constraint firstItem="HwB-Xq-If7" firstAttribute="leading" relation="greaterThanOrEqual" secondItem="m6q-Ji-EAr" secondAttribute="trailing" constant="8" id="RDW-sK-dA6"/>
-                                        <constraint firstItem="0vJ-cS-5P7" firstAttribute="leading" secondItem="Kx6-Wm-aAQ" secondAttribute="leading" constant="8" id="SMh-RN-SwS"/>
+                                        <constraint firstItem="0vJ-cS-5P7" firstAttribute="leading" secondItem="Kx6-Wm-aAQ" secondAttribute="leadingMargin" id="SMh-RN-SwS"/>
                                         <constraint firstItem="HwB-Xq-If7" firstAttribute="top" secondItem="Kx6-Wm-aAQ" secondAttribute="topMargin" constant="6" id="Ua5-1v-GNb"/>
                                         <constraint firstItem="e2S-uS-OIt" firstAttribute="leading" secondItem="0vJ-cS-5P7" secondAttribute="trailing" constant="8" id="b0y-T2-hNQ"/>
                                         <constraint firstAttribute="bottomMargin" secondItem="e2S-uS-OIt" secondAttribute="bottom" constant="6" id="bz0-3y-OmP"/>
                                         <constraint firstItem="jAO-b2-Iy9" firstAttribute="top" secondItem="m6q-Ji-EAr" secondAttribute="bottom" constant="4" id="qAH-iN-j7a"/>
                                         <constraint firstItem="e2S-uS-OIt" firstAttribute="top" secondItem="jAO-b2-Iy9" secondAttribute="bottom" constant="4" id="vW5-Iy-MSv"/>
-                                        <constraint firstAttribute="trailing" secondItem="HwB-Xq-If7" secondAttribute="trailing" id="wDO-vU-66r"/>
+                                        <constraint firstAttribute="trailingMargin" secondItem="HwB-Xq-If7" secondAttribute="trailing" id="wDO-vU-66r"/>
                                     </constraints>
                                 </tableViewCellContentView>
                                 <connections>
@@ -131,10 +131,10 @@
             </objects>
             <point key="canvasLocation" x="1772" y="14.842578710644679"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="Bi9-YF-GrW">
             <objects>
-                <navigationController id="jza-oe-b8O" sceneMemberID="viewController">
+                <navigationController id="jza-oe-b8O" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="Mt7-2s-336">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -147,10 +147,10 @@
             </objects>
             <point key="canvasLocation" x="1773" y="-664"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="p7g-2a-sQ3">
             <objects>
-                <navigationController id="hQu-VZ-lTI" sceneMemberID="viewController">
+                <navigationController id="hQu-VZ-lTI" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="54r-sm-b3w">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -203,7 +203,7 @@
                         <viewControllerLayoutGuide type="bottom" id="ucE-b4-Own"/>
                     </layoutGuides>
                     <view key="view" contentMode="scaleToFill" id="43x-Iu-HK8">
-                        <rect key="frame" x="0.0" y="0.0" width="375" height="667"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="627"/>
                         <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                         <color key="backgroundColor" red="0.97636467218399048" green="0.97653168439865112" blue="0.97635418176651001" alpha="1" colorSpace="custom" customColorSpace="sRGB"/>
                     </view>
@@ -230,10 +230,10 @@
             </objects>
             <point key="canvasLocation" x="2646" y="15"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="G4S-sI-syf">
             <objects>
-                <navigationController storyboardIdentifier="InboxNavigationViewController" id="07o-eS-nNQ" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="InboxNavigationViewController" id="07o-eS-nNQ" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="JdR-7G-nlt">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -246,10 +246,10 @@
             </objects>
             <point key="canvasLocation" x="1019" y="15"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="o2G-h7-0FB">
             <objects>
-                <navigationController storyboardIdentifier="TavernNavigationViewController" id="dMb-sr-5MN" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="TavernNavigationViewController" id="dMb-sr-5MN" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="2be-FU-1J8">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -336,10 +336,10 @@
             </objects>
             <point key="canvasLocation" x="1228" y="1171"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="Ad9-wI-iiJ">
             <objects>
-                <navigationController storyboardIdentifier="PartyNavigationViewController" id="SxV-sR-3AL" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="PartyNavigationViewController" id="SxV-sR-3AL" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="0Fj-LL-eYa">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -803,7 +803,7 @@
             <objects>
                 <tableViewController storyboardIdentifier="ChallengeDetailViewController" useStoryboardIdentifierAsRestorationIdentifier="YES" id="LJL-4h-PRX" customClass="ChallengeDetailsTableViewController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <tableView key="view" clipsSubviews="YES" contentMode="scaleToFill" alwaysBounceVertical="YES" dataMode="prototypes" style="plain" separatorStyle="default" allowsSelection="NO" rowHeight="-1" estimatedRowHeight="-1" sectionHeaderHeight="28" sectionFooterHeight="28" id="mSs-Sh-idc">
-                        <rect key="frame" x="0.0" y="0.0" width="375" height="603"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="667"/>
                         <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                         <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
                         <inset key="separatorInset" minX="0.0" minY="0.0" maxX="0.0" maxY="0.0"/>
@@ -872,7 +872,7 @@
             <objects>
                 <tableViewController storyboardIdentifier="UserProfileViewController" id="MTH-Re-wqo" customClass="UserProfileViewController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <tableView key="view" opaque="NO" clipsSubviews="YES" clearsContextBeforeDrawing="NO" contentMode="scaleToFill" alwaysBounceVertical="YES" dataMode="prototypes" style="grouped" separatorStyle="default" rowHeight="44" sectionHeaderHeight="10" sectionFooterHeight="10" id="WTt-7r-yfN">
-                        <rect key="frame" x="0.0" y="0.0" width="375" height="667"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="627"/>
                         <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                         <color key="backgroundColor" red="0.93725490199999995" green="0.93725490199999995" blue="0.95686274510000002" alpha="1" colorSpace="custom" customColorSpace="sRGB"/>
                         <prototypes>
@@ -1272,10 +1272,10 @@
             </objects>
             <point key="canvasLocation" x="4328" y="2121"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="oPz-d7-ciS">
             <objects>
-                <navigationController storyboardIdentifier="GuidelinesNavigationViewController" useStoryboardIdentifierAsRestorationIdentifier="YES" id="qim-an-Lm9" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="GuidelinesNavigationViewController" useStoryboardIdentifierAsRestorationIdentifier="YES" id="qim-an-Lm9" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <nil key="simulatedTopBarMetrics"/>
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="D6q-kU-EGb">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="56"/>
@@ -1336,7 +1336,7 @@
             <objects>
                 <tableViewController storyboardIdentifier="ChallengeTableViewController" automaticallyAdjustsScrollViewInsets="NO" id="BE2-xn-Wwl" customClass="ChallengeTableViewController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <tableView key="view" clipsSubviews="YES" contentMode="scaleToFill" alwaysBounceVertical="YES" dataMode="prototypes" style="plain" separatorStyle="default" rowHeight="86" sectionHeaderHeight="28" sectionFooterHeight="28" id="SWx-Y1-cyG">
-                        <rect key="frame" x="0.0" y="0.0" width="375" height="603"/>
+                        <rect key="frame" x="0.0" y="0.0" width="375" height="667"/>
                         <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                         <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="genericGamma22GrayColorSpace"/>
                         <connections>
@@ -1353,10 +1353,10 @@
             </objects>
             <point key="canvasLocation" x="741.60000000000002" y="5028.9355322338834"/>
         </scene>
-        <!--Navigation Controller-->
+        <!--Themed Navigation Controller-->
         <scene sceneID="naS-vc-IRN">
             <objects>
-                <navigationController storyboardIdentifier="ChallengeNavigationViewController" id="dON-DT-k7p" sceneMemberID="viewController">
+                <navigationController storyboardIdentifier="ChallengeNavigationViewController" id="dON-DT-k7p" customClass="ThemedNavigationController" customModule="Habitica" customModuleProvider="target" sceneMemberID="viewController">
                     <navigationBar key="navigationBar" contentMode="scaleToFill" id="Hf8-3d-Loz">
                         <rect key="frame" x="0.0" y="0.0" width="375" height="44"/>
                         <autoresizingMask key="autoresizingMask"/>
@@ -2721,12 +2721,12 @@
     <inferredMetricsTieBreakers>
         <segue reference="71z-UW-WBb"/>
         <segue reference="gAH-Zh-PJ3"/>
-        <segue reference="lgk-R4-zXr"/>
+        <segue reference="wNf-J0-D2P"/>
         <segue reference="9hs-wq-6bn"/>
         <segue reference="jXp-j5-lvy"/>
         <segue reference="Hfa-0k-B92"/>
         <segue reference="Nsp-ag-Sds"/>
-        <segue reference="wif-V9-Mcy"/>
+        <segue reference="C12-ty-sO4"/>
         <segue reference="rs9-Lf-2VQ"/>
     </inferredMetricsTieBreakers>
     <color key="tintColor" red="0.6058621407" green="0.38462612029999999" blue="0.99835687880000001" alpha="1" colorSpace="custom" customColorSpace="sRGB"/>
diff --git a/HabitRPG/TableViewController/HRPGBaseViewController.h b/HabitRPG/TableViewController/HRPGBaseViewController.h
index 4b426d253..395aa14b9 100644
--- a/HabitRPG/TableViewController/HRPGBaseViewController.h
+++ b/HabitRPG/TableViewController/HRPGBaseViewController.h
@@ -22,6 +22,8 @@
 @property BOOL displayedTutorialStep;
 @property TutorialStepView *activeTutorialView;
 
+@property BOOL isVisible;
+
 @property TopHeaderCoordinator *topHeaderCoordinator;
 @property (nonatomic, readonly) UINavigationController<TopHeaderNavigationControllerProtocol> *topHeaderNavigationController;
 
diff --git a/HabitRPG/TableViewController/HRPGBaseViewController.m b/HabitRPG/TableViewController/HRPGBaseViewController.m
index 18749e03e..f78a3e78e 100644
--- a/HabitRPG/TableViewController/HRPGBaseViewController.m
+++ b/HabitRPG/TableViewController/HRPGBaseViewController.m
@@ -8,7 +8,6 @@
 
 #import "HRPGBaseViewController.h"
 #import "Amplitude+HRPGHelpers.h"
-#import "HRPGNavigationController.h"
 #import "UIViewController+TutorialSteps.h"
 #import "UIViewController+HRPGTopHeaderNavigationController.h"
 #import "Habitica-Swift.h"
@@ -53,6 +52,7 @@ - (void)viewWillLayoutSubviews {
 }
 
 - (void)viewWillAppear:(BOOL)animated {
+    self.isVisible = YES;
     [super viewWillAppear:animated];
 
     [[NSNotificationCenter defaultCenter] addObserver:self
@@ -98,6 +98,7 @@ - (void)scrollViewDidScroll:(UIScrollView *)scrollView {
 }
 
 - (void)viewWillDisappear:(BOOL)animated {
+    self.isVisible = NO;
     [super viewWillDisappear:animated];
     [self.topHeaderCoordinator viewWillDisappear];
 }
@@ -123,15 +124,6 @@ - (IBAction)unwindToListSave:(UIStoryboardSegue *)segue {
     // Skeletton method, so that it can be referenced from IB
 }
 
-- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
-    UIViewController *destViewController = segue.destinationViewController;
-    if ([destViewController isKindOfClass:[HRPGNavigationController class]]) {
-        HRPGNavigationController *destNavigationController =
-            (HRPGNavigationController *)destViewController;
-        destNavigationController.sourceViewController = self;
-    }
-}
-
 - (BOOL)isIndexPathVisible:(NSIndexPath *)indexPath {
     NSArray *indexes = [self.tableView indexPathsForVisibleRows];
     for (NSIndexPath *index in indexes) {
diff --git a/HabitRPG/TableViewController/Tasks/TaskTableViewController.swift b/HabitRPG/TableViewController/Tasks/TaskTableViewController.swift
index 46eafccaa..95389ad4a 100644
--- a/HabitRPG/TableViewController/Tasks/TaskTableViewController.swift
+++ b/HabitRPG/TableViewController/Tasks/TaskTableViewController.swift
@@ -445,9 +445,8 @@ class TaskTableViewController: BaseTableViewController, UISearchBarDelegate, UIT
             }
         } else if segue.identifier == "FilterSegue" {
             if let tabVC = tabBarController as? MainTabBarController,
-                let navVC = segue.destination as? HRPGNavigationController,
+                let navVC = segue.destination as? UINavigationController,
                 let filterVC = navVC.topViewController as? FilterViewController {
-                navVC.sourceViewController = self
                 filterVC.selectedTags = tabVC.selectedTags
                 filterVC.taskType = typeName
             }
diff --git a/HabitRPG/TableViewDataSources/InboxOverviewDataSource.swift b/HabitRPG/TableViewDataSources/InboxOverviewDataSource.swift
index 354bbfadc..76f966339 100644
--- a/HabitRPG/TableViewDataSources/InboxOverviewDataSource.swift
+++ b/HabitRPG/TableViewDataSources/InboxOverviewDataSource.swift
@@ -53,28 +53,33 @@ class InboxOverviewDataSource: BaseReactiveTableViewDataSource<InboxMessageProto
         let cell = tableView.dequeueReusableCell(withIdentifier: "Cell", for: indexPath)
         
         if let message = item(at: indexPath) {
+            cell.backgroundColor = ThemeService.shared.theme.contentBackgroundColor
             let displayNameLabel = cell.viewWithTag(1) as? UsernameLabel
             displayNameLabel?.text = message.displayName
             displayNameLabel?.contributorLevel = message.contributor?.level ?? 0
             displayNameLabel?.font = CustomFontMetrics.scaledSystemFont(ofSize: 17)
             let textLabel = cell.viewWithTag(2) as? UILabel
             textLabel?.text = message.text
+            textLabel?.textColor = ThemeService.shared.theme.secondaryTextColor
             let timeLabel = cell.viewWithTag(3) as? UILabel
             timeLabel?.text = (message.timestamp as NSDate?)?.timeAgoSinceNow()
+            timeLabel?.textColor = ThemeService.shared.theme.secondaryTextColor
             let usernameLabel = cell.viewWithTag(4) as? UILabel
             if let username = message.username {
                 usernameLabel?.text = "@\(username)"
             } else {
                 usernameLabel?.text = nil
             }
+            usernameLabel?.textColor = ThemeService.shared.theme.secondaryTextColor
             let avatarView = cell.viewWithTag(5) as? AvatarView
             avatarView?.size = .compact
             avatarView?.showMount = false
             avatarView?.showPet = false
             if let userStyle = message.userStyles {
                 avatarView?.avatar = AvatarViewModel(avatar: userStyle)
-                //temporarily hide this until it is sorted out whose avatar is stored in the messge
-                avatarView?.isHidden = true
+                let avatarWrapper = cell.viewWithTag(6)
+                avatarWrapper?.borderColor = ThemeService.shared.theme.offsetBackgroundColor
+                avatarView?.isHidden = false
             } else {
                 avatarView?.isHidden = true
             }
diff --git a/HabitRPG/TableViewDataSources/NotificationsDataSource.swift b/HabitRPG/TableViewDataSources/NotificationsDataSource.swift
index 635321183..4d187d0cd 100644
--- a/HabitRPG/TableViewDataSources/NotificationsDataSource.swift
+++ b/HabitRPG/TableViewDataSources/NotificationsDataSource.swift
@@ -76,6 +76,7 @@ class NotificationsDataSource: BaseReactiveTableViewDataSource<NotificationProto
             return UITableViewCell()
         }
         let cell = tableView.dequeueReusableCell(withIdentifier: notification.type.rawValue, for: indexPath)
+        cell.backgroundColor = ThemeService.shared.theme.contentBackgroundColor
         
         switch notification.type {
         case .unallocatedStatsPoints:
diff --git a/HabitRPG/ThemedNavigationController.swift b/HabitRPG/ThemedNavigationController.swift
new file mode 100644
index 000000000..9b3710716
--- /dev/null
+++ b/HabitRPG/ThemedNavigationController.swift
@@ -0,0 +1,26 @@
+//
+//  ThemedNavigationController.swift
+//  Habitica
+//
+//  Created by Phillip Thelen on 10.09.19.
+//  Copyright © 2019 HabitRPG Inc. All rights reserved.
+//
+
+import Foundation
+
+class ThemedNavigationController: UINavigationController, Themeable {
+    
+    override func viewDidLoad() {
+        super.viewDidLoad()
+        ThemeService.shared.addThemeable(themable: self)
+    }
+    
+    func applyTheme(theme: Theme) {
+        navigationBar.tintColor = theme.tintColor
+        navigationBar.titleTextAttributes = [
+            NSAttributedString.Key.foregroundColor: theme.primaryTextColor
+        ]
+        navigationBar.backgroundColor = theme.contentBackgroundColor
+        navigationBar.barTintColor = theme.contentBackgroundColor
+    }
+}
diff --git a/HabitRPG/TopHeaderNavigationController.swift b/HabitRPG/TopHeaderNavigationController.swift
index d6590e7d1..75a2dbcb6 100644
--- a/HabitRPG/TopHeaderNavigationController.swift
+++ b/HabitRPG/TopHeaderNavigationController.swift
@@ -204,11 +204,10 @@ class TopHeaderViewController: UINavigationController, TopHeaderNavigationContro
         defaultNavbarHiddenColor = theme.navbarHiddenColor
         defaultNavbarVisibleColor = theme.contentBackgroundColor
         visibleTintColor = theme.tintColor
-        setNavigationBarColors(navbarColorBlendingAlpha)
         bottomBorderView.backgroundColor = theme.separatorColor
         backgroundView.backgroundColor = theme.contentBackgroundColorDimmed
         upperBackgroundView.backgroundColor = theme.contentBackgroundColor
-        
+        setNavigationBarColors(navbarColorBlendingAlpha)
     }
     
     override func viewWillLayoutSubviews() {
diff --git a/HabitRPG/UI/General/MainMenuViewController.swift b/HabitRPG/UI/General/MainMenuViewController.swift
index 014ad7717..2514fefd6 100644
--- a/HabitRPG/UI/General/MainMenuViewController.swift
+++ b/HabitRPG/UI/General/MainMenuViewController.swift
@@ -45,7 +45,9 @@ class MainMenuViewController: BaseTableViewController {
     private var navbarColor = ThemeService.shared.theme.navbarHiddenColor {
         didSet {
             topHeaderCoordinator.navbarVisibleColor = navbarColor
-            navbarView.backgroundColor = navbarColor
+            if isVisible {
+                navbarView.backgroundColor = navbarColor
+            }
         }
     }
     private var worldBossTintColor: UIColor?
diff --git a/HabitRPG/UI/Habitica-Bridging-Header.h b/HabitRPG/UI/Habitica-Bridging-Header.h
index dce823d22..b8b3a72d8 100644
--- a/HabitRPG/UI/Habitica-Bridging-Header.h
+++ b/HabitRPG/UI/Habitica-Bridging-Header.h
@@ -24,7 +24,6 @@
 #import <SlackTextViewController/SLKTextViewController.h>
 #import "HRPGFlagInformationOverlayView.h"
 #import "HRPGLabeledProgressBar.h"
-#import "HRPGNavigationController.h"
 #import "HRPGShopOverviewViewController.h"
 #import "HRPGSpellViewController.h"
 #import "HRPGSharingManager.h"
diff --git a/HabitRPG/UI/Settings/SettingsViewController.swift b/HabitRPG/UI/Settings/SettingsViewController.swift
index a2c292021..42d05de14 100644
--- a/HabitRPG/UI/Settings/SettingsViewController.swift
+++ b/HabitRPG/UI/Settings/SettingsViewController.swift
@@ -366,13 +366,6 @@ class SettingsViewController: FormViewController, Themeable {
     func applyTheme(theme: Theme) {
         tableView.backgroundColor = theme.windowBackgroundColor
         tableView.reloadData()
-        
-        navigationController?.navigationBar.tintColor = theme.tintColor
-        navigationController?.navigationBar.titleTextAttributes = [
-            NSAttributedString.Key.foregroundColor: theme.primaryTextColor
-        ]
-        navigationController?.navigationBar.backgroundColor = theme.contentBackgroundColor
-        navigationController?.navigationBar.barTintColor = theme.contentBackgroundColor
     }
     
     private func setupForm() {
diff --git a/HabitRPG/UI/Social/InboxChatViewController.swift b/HabitRPG/UI/Social/InboxChatViewController.swift
index ff11f15c7..b664354fb 100644
--- a/HabitRPG/UI/Social/InboxChatViewController.swift
+++ b/HabitRPG/UI/Social/InboxChatViewController.swift
@@ -53,6 +53,9 @@ class InboxChatViewController: SLKTextViewController, Themeable {
         textView.placeholder = L10n.writeAMessage
         textInputbar.maxCharCount = UInt(configRepository.integer(variable: .maxChatLength))
         textInputbar.charCountLabel.font = UIFont.systemFont(ofSize: 11, weight: .bold)
+        textInputbar.textView.isDynamicTypeEnabled = true
+        textInputbar.textView.placeholderFont = CustomFontMetrics.scaledSystemFont(ofSize: 13)
+        textInputbar.textView.font = CustomFontMetrics.scaledSystemFont(ofSize: 13)
         
         hrpgTopHeaderNavigationController()?.shouldHideTopHeader = true
         hrpgTopHeaderNavigationController()?.hideNavbar = false
@@ -68,6 +71,7 @@ class InboxChatViewController: SLKTextViewController, Themeable {
         textInputbar.charCountLabelNormalColor = theme.dimmedTextColor
         textInputbar.textView.backgroundColor = theme.contentBackgroundColor
         textInputbar.textView.textColor = theme.primaryTextColor
+        tableView?.reloadData()
     }
     
     @objc
diff --git a/HabitRPG/UI/User/AchievementsCollectionViewController.swift b/HabitRPG/UI/User/AchievementsCollectionViewController.swift
index 23dc57336..bebe8509d 100644
--- a/HabitRPG/UI/User/AchievementsCollectionViewController.swift
+++ b/HabitRPG/UI/User/AchievementsCollectionViewController.swift
@@ -30,6 +30,7 @@ class AchievementsCollectionViewController: BaseCollectionViewController {
     }
     
     override func applyTheme(theme: Theme) {
+        super.applyTheme(theme: theme)
         collectionView.backgroundColor = ThemeService.shared.theme.contentBackgroundColor
     }
     
diff --git a/HabitRPG/Utilities/TopHeaderCoordinator.swift b/HabitRPG/Utilities/TopHeaderCoordinator.swift
index 33612bef8..00d1f49f6 100644
--- a/HabitRPG/Utilities/TopHeaderCoordinator.swift
+++ b/HabitRPG/Utilities/TopHeaderCoordinator.swift
@@ -33,7 +33,7 @@ class TopHeaderCoordinator: NSObject {
     }
     @objc var navbarVisibleColor: UIColor? {
         didSet {
-            if didAppear {
+            if isVisible {
                 if let navbarVisibleColor = self.navbarVisibleColor ?? topHeaderNavigationController?.defaultNavbarVisibleColor {
                     topHeaderNavigationController?.navbarVisibleColor = navbarVisibleColor
                 }
@@ -42,6 +42,7 @@ class TopHeaderCoordinator: NSObject {
     }
     
     private var didAppear = false
+    private var isVisible = false
     
     @objc
     init(topHeaderNavigationController: UINavigationController & TopHeaderNavigationControllerProtocol) {
@@ -114,6 +115,7 @@ class TopHeaderCoordinator: NSObject {
             scrollView?.contentOffset = CGPoint(x: 0, y: 0)
         }
         didAppear = true
+        isVisible = true
     }
     
     @objc
@@ -139,6 +141,7 @@ class TopHeaderCoordinator: NSObject {
             return
         }
         navController.stopFollowingScrollView()
+        isVisible = false
     }
     
     @objc
diff --git a/Habitica.xcodeproj/project.pbxproj b/Habitica.xcodeproj/project.pbxproj
index 9d15c4f9f..4075c6949 100644
--- a/Habitica.xcodeproj/project.pbxproj
+++ b/Habitica.xcodeproj/project.pbxproj
@@ -30,7 +30,7 @@
 		2907F99E1F694C4000328AEE /* GemViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 2907F99D1F694C4000328AEE /* GemViewController.swift */; };
 		2908784A220210CF0010820A /* Strings-objcBridge.swift in Sources */ = {isa = PBXBuildFile; fileRef = 29087849220210CF0010820A /* Strings-objcBridge.swift */; };
 		2908D8742232D45D00DDECA1 /* BaseTableViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 2908D8732232D45D00DDECA1 /* BaseTableViewController.swift */; };
-		2908E3512217255600D246CD /* BuildFile in Resources */ = {isa = PBXBuildFile; };
+		2908E3512217255600D246CD /* (null) in Resources */ = {isa = PBXBuildFile; };
 		290922F02242628600645D0E /* LanguageHandler.swift in Sources */ = {isa = PBXBuildFile; fileRef = 290922EF2242628600645D0E /* LanguageHandler.swift */; };
 		290A405421FA175800A409BA /* Purple@2x.png in Resources */ = {isa = PBXBuildFile; fileRef = 290A405221FA175700A409BA /* Purple@2x.png */; };
 		290A405521FA175800A409BA /* Purple@3x.png in Resources */ = {isa = PBXBuildFile; fileRef = 290A405321FA175800A409BA /* Purple@3x.png */; };
@@ -251,6 +251,7 @@
 		2986EB0B1FCC63F900B316F6 /* AttributePointsViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 2986EB0A1FCC63F900B316F6 /* AttributePointsViewController.swift */; };
 		29951A1E2326670500918FC8 /* InboxOverviewViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 29951A1D2326670500918FC8 /* InboxOverviewViewController.swift */; };
 		29951A20232669C600918FC8 /* InboxChatViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 29951A1F232669C500918FC8 /* InboxChatViewController.swift */; };
+		29951A222327E94F00918FC8 /* ThemedNavigationController.swift in Sources */ = {isa = PBXBuildFile; fileRef = 29951A212327E94F00918FC8 /* ThemedNavigationController.swift */; };
 		2996AA1F22EB157800033D92 /* AppIntentVocabulary.plist in Resources */ = {isa = PBXBuildFile; fileRef = 2996AA2122EB157800033D92 /* AppIntentVocabulary.plist */; };
 		299BD6221F505DFA00E22935 /* PaddedLabel.swift in Sources */ = {isa = PBXBuildFile; fileRef = 299BD6211F505DFA00E22935 /* PaddedLabel.swift */; };
 		299BD6351F54346F00E22935 /* QuestDetailRewardView.xib in Resources */ = {isa = PBXBuildFile; fileRef = 299BD6341F54346F00E22935 /* QuestDetailRewardView.xib */; };
@@ -486,7 +487,6 @@
 		D9709A541E8051DC0005F35B /* TaskRepeatablesSummaryInteractor.swift in Sources */ = {isa = PBXBuildFile; fileRef = D9709A531E8051DC0005F35B /* TaskRepeatablesSummaryInteractor.swift */; };
 		D9709A581E8053A00005F35B /* TaskRepeatablesSummaryInteractorTests.swift in Sources */ = {isa = PBXBuildFile; fileRef = D9709A571E8053A00005F35B /* TaskRepeatablesSummaryInteractorTests.swift */; };
 		D9709A5A1E82E4470005F35B /* ChallengeFormViewController.swift in Sources */ = {isa = PBXBuildFile; fileRef = D9709A591E82E4470005F35B /* ChallengeFormViewController.swift */; };
-		D9722B8019BD041E009D8AD3 /* HRPGNavigationController.m in Sources */ = {isa = PBXBuildFile; fileRef = D9722B7F19BD041E009D8AD3 /* HRPGNavigationController.m */; };
 		D97C71E418ECE09A0089FDC6 /* HRPGSpellViewController.m in Sources */ = {isa = PBXBuildFile; fileRef = D97C71E318ECE09A0089FDC6 /* HRPGSpellViewController.m */; };
 		D97ED0AE1E6DBB97006C2A26 /* JoinChallengeInteractor.swift in Sources */ = {isa = PBXBuildFile; fileRef = D97ED0AD1E6DBB97006C2A26 /* JoinChallengeInteractor.swift */; };
 		D97ED0B01E6DBC87006C2A26 /* Interactor.swift in Sources */ = {isa = PBXBuildFile; fileRef = D97ED0AF1E6DBC87006C2A26 /* Interactor.swift */; };
@@ -899,6 +899,7 @@
 		2986EB0A1FCC63F900B316F6 /* AttributePointsViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = AttributePointsViewController.swift; sourceTree = "<group>"; };
 		29951A1D2326670500918FC8 /* InboxOverviewViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; name = InboxOverviewViewController.swift; path = HabitRPG/UI/Social/InboxOverviewViewController.swift; sourceTree = SOURCE_ROOT; };
 		29951A1F232669C500918FC8 /* InboxChatViewController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = InboxChatViewController.swift; sourceTree = "<group>"; };
+		29951A212327E94F00918FC8 /* ThemedNavigationController.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ThemedNavigationController.swift; sourceTree = "<group>"; };
 		2996AA2022EB157800033D92 /* Base */ = {isa = PBXFileReference; lastKnownFileType = text.plist.xml; name = Base; path = Base.lproj/AppIntentVocabulary.plist; sourceTree = "<group>"; };
 		2996AA2222EB158300033D92 /* cs */ = {isa = PBXFileReference; lastKnownFileType = text.plist.xml; name = cs; path = cs.lproj/AppIntentVocabulary.plist; sourceTree = "<group>"; };
 		2996AA2422EB159300033D92 /* ja */ = {isa = PBXFileReference; lastKnownFileType = text.plist.xml; name = ja; path = ja.lproj/AppIntentVocabulary.plist; sourceTree = "<group>"; };
@@ -1219,8 +1220,6 @@
 		D9709A531E8051DC0005F35B /* TaskRepeatablesSummaryInteractor.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = TaskRepeatablesSummaryInteractor.swift; sourceTree = "<group>"; };
 		D9709A571E8053A00005F35B /* TaskRepeatablesSummaryInteractorTests.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; path = TaskRepeatablesSummaryInteractorTests.swift; sourceTree = "<group>"; };
 		D9709A591E82E4470005F35B /* ChallengeFormViewController.swift */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.swift; name = ChallengeFormViewController.swift; path = ../../Interactors/Challenges/ChallengeFormViewController.swift; sourceTree = "<group>"; };
-		D9722B7E19BD041E009D8AD3 /* HRPGNavigationController.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; lineEnding = 0; path = HRPGNavigationController.h; sourceTree = "<group>"; xcLanguageSpecificationIdentifier = xcode.lang.objcpp; };
-		D9722B7F19BD041E009D8AD3 /* HRPGNavigationController.m */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.objc; lineEnding = 0; path = HRPGNavigationController.m; sourceTree = "<group>"; xcLanguageSpecificationIdentifier = xcode.lang.objc; };
 		D976DEBF1CB65BF6002BB69F /* zh-Hans */ = {isa = PBXFileReference; lastKnownFileType = text.plist.strings; name = "zh-Hans"; path = "zh-Hans.lproj/InfoPlist.strings"; sourceTree = "<group>"; };
 		D976DEC01CB65BF6002BB69F /* zh-Hans */ = {isa = PBXFileReference; lastKnownFileType = text.plist.strings; name = "zh-Hans"; path = "zh-Hans.lproj/InfoPlist.strings"; sourceTree = "<group>"; };
 		D976DEC41CB65C05002BB69F /* pt-BR */ = {isa = PBXFileReference; lastKnownFileType = text.plist.strings; name = "pt-BR"; path = "pt-BR.lproj/InfoPlist.strings"; sourceTree = "<group>"; };
@@ -2704,11 +2703,10 @@
 				D9EB4E9E18CB4A9400BB2094 /* HRPGAppDelegate.m */,
 				29255E461F3E14920094A3E3 /* AppDelegate.swift */,
 				29A77B1E22EED4CE00FE41E4 /* NetworkIndicatorController.swift */,
-				D9722B7E19BD041E009D8AD3 /* HRPGNavigationController.h */,
-				D9722B7F19BD041E009D8AD3 /* HRPGNavigationController.m */,
 				29E1630A200D050E00685640 /* TopHeaderNavigationController.swift */,
 				D9E46AFB1DAB98D700E390D7 /* HRPGGemHeaderNavigationController.h */,
 				D9E46AFC1DAB98D700E390D7 /* HRPGGemHeaderNavigationController.m */,
+				29951A212327E94F00918FC8 /* ThemedNavigationController.swift */,
 				D9AEEA711ACEDD470076951B /* HRPGWebViewController.h */,
 				D9AEEA721ACEDD470076951B /* HRPGWebViewController.m */,
 				29FC5A6A20406932008E88C8 /* GuidelinesViewController.swift */,
@@ -3024,7 +3022,7 @@
 				49E378532009542C00E0DA3D /* ChallengeTableViewHeaderView.xib in Resources */,
 				498E4D001FA17C1A006933FF /* ChallengeCategoriesTableViewCell.xib in Resources */,
 				2914487A20864A3300F3A6B5 /* EquipmentOverviewView.xib in Resources */,
-				2908E3512217255600D246CD /* BuildFile in Resources */,
+				2908E3512217255600D246CD /* (null) in Resources */,
 				29028C442037132A00B7F704 /* SystemMessageTableViewCell.xib in Resources */,
 				29AAA1611F2B597400029737 /* SpeechbubbleView.xib in Resources */,
 				29FC885E2018D858002B3D3F /* WorldBossDescription.xib in Resources */,
@@ -3475,7 +3473,8 @@
 			);
 			runOnlyForDeploymentPostprocessing = 0;
 			shellPath = /bin/sh;
-			shellScript = "\n";
+			shellScript = "
+";
 		};
 /* End PBXShellScriptBuildPhase section */
 
@@ -3800,7 +3799,6 @@
 				D9CE90491E4DCF7D00702578 /* SubscriptionDetailView.swift in Sources */,
 				2932821A1F39E28000D42961 /* TypingTextViewController.swift in Sources */,
 				498E4CF71FA17B7F006933FF /* ChallengeButtonTableViewCell.swift in Sources */,
-				D9722B8019BD041E009D8AD3 /* HRPGNavigationController.m in Sources */,
 				494E54101F2EEF810003683C /* Amplitude+HRPGHelpers.m in Sources */,
 				29DBFEF720C997D100DF9CF2 /* CalculateUserStatsInteractor.swift in Sources */,
 				29255E4D1F3E25910094A3E3 /* CGRect-Extensions.swift in Sources */,
@@ -3854,6 +3852,7 @@
 				293282181F39E1A400D42961 /* WelcomeViewController.swift in Sources */,
 				2931150622D745A700E4A9E3 /* AchievementsViewDataSource.swift in Sources */,
 				29144876208648D500F3A6B5 /* EquipmentOverviewViewController.swift in Sources */,
+				29951A222327E94F00918FC8 /* ThemedNavigationController.swift in Sources */,
 				491C6E5B2020FE64005030A2 /* Challenge-Extensions.swift in Sources */,
 				D96C85451DCBAC90003E3616 /* HRPGStreakAchievementNotification.m in Sources */,
 				490864301F45318600BD9896 /* HRPGInsufficientHourglassesViewController.swift in Sources */,
