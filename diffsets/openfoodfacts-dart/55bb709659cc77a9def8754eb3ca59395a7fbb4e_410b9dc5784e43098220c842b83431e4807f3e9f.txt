diff --git a/lib/openfoodfacts.dart b/lib/openfoodfacts.dart
index f907533776..48d043e762 100644
--- a/lib/openfoodfacts.dart
+++ b/lib/openfoodfacts.dart
@@ -5,6 +5,7 @@ import 'dart:async';
 
 import 'package:http/http.dart';
 import 'package:openfoodfacts/model/OcrIngredientsResult.dart';
+import 'package:openfoodfacts/utils/AbstractQueryConfiguration.dart';
 import 'package:openfoodfacts/utils/OcrField.dart';
 import 'package:openfoodfacts/utils/PnnsGroupQueryConfiguration.dart';
 import 'package:openfoodfacts/utils/PnnsGroups.dart';
@@ -184,9 +185,7 @@ class OpenFoodAPIClient {
     final jsonStr = _replaceQuotes(response.body);
     var result = SearchResult.fromJson(json.decode(jsonStr));
 
-    result.products!.asMap().forEach((index, product) {
-      ProductHelper.removeImages(product, configuration.language);
-    });
+    _removeImages(result, configuration);
 
     return result;
   }
@@ -209,9 +208,7 @@ class OpenFoodAPIClient {
     final String jsonStr = _replaceQuotes(response.body);
     final SearchResult result = SearchResult.fromJson(json.decode(jsonStr));
 
-    result.products!.asMap().forEach((index, product) {
-      ProductHelper.removeImages(product, configuration.language);
-    });
+    _removeImages(result, configuration);
 
     return result;
   }
@@ -233,13 +230,22 @@ class OpenFoodAPIClient {
     final jsonStr = _replaceQuotes(response.body);
     var result = SearchResult.fromJson(json.decode(jsonStr));
 
-    result.products!.asMap().forEach((index, product) {
-      ProductHelper.removeImages(product, configuration.language);
-    });
+    _removeImages(result, configuration);
 
     return result;
   }
 
+  static void _removeImages(
+    final SearchResult searchResult,
+    final AbstractQueryConfiguration configuration,
+  ) {
+    if (searchResult.products != null) {
+      searchResult.products!.asMap().forEach((index, product) {
+        ProductHelper.removeImages(product, configuration.language);
+      });
+    }
+  }
+
   /// By default the query will hit the PROD DB
   static Future<InsightsResult> getRandomInsight(User user,
       {InsightType? type,
diff --git a/lib/utils/AbstractQueryConfiguration.dart b/lib/utils/AbstractQueryConfiguration.dart
index de92f0e620..5f25114603 100644
--- a/lib/utils/AbstractQueryConfiguration.dart
+++ b/lib/utils/AbstractQueryConfiguration.dart
@@ -34,13 +34,9 @@ abstract class AbstractQueryConfiguration {
     }
 
     if (fields != null) {
-      bool ignoreFieldsFilter = false;
-      for (ProductField field in fields!) {
-        if (field == ProductField.ALL) {
-          ignoreFieldsFilter = true;
-          break;
-        }
-      }
+      final bool ignoreFieldsFilter = fields!.any(
+        (field) => field == ProductField.ALL,
+      );
       if (!ignoreFieldsFilter) {
         final fieldsStrings = convertFieldsToStrings(fields!, language);
         result.putIfAbsent('fields', () => fieldsStrings.join(','));
diff --git a/lib/utils/PnnsGroupQueryConfiguration.dart b/lib/utils/PnnsGroupQueryConfiguration.dart
index a427842398..8225eda298 100644
--- a/lib/utils/PnnsGroupQueryConfiguration.dart
+++ b/lib/utils/PnnsGroupQueryConfiguration.dart
@@ -1,14 +1,24 @@
 import 'package:openfoodfacts/openfoodfacts.dart';
+import 'package:openfoodfacts/utils/AbstractQueryConfiguration.dart';
 import 'package:openfoodfacts/utils/PnnsGroups.dart';
 
-class PnnsGroupQueryConfiguration {
+class PnnsGroupQueryConfiguration extends AbstractQueryConfiguration {
   PnnsGroup2 group;
-  OpenFoodFactsLanguage? language;
-  List<ProductField>? fields;
   int page;
 
-  PnnsGroupQueryConfiguration(this.group,
-      {this.language, this.fields, this.page = 1});
+  PnnsGroupQueryConfiguration(
+    this.group, {
+    final OpenFoodFactsLanguage? language,
+    final String? lc,
+    final String? cc,
+    final List<ProductField>? fields,
+    this.page = 1,
+  }) : super(
+          language: language,
+          lc: lc,
+          cc: cc,
+          fields: fields,
+        );
 
   List<String> getFieldsKeys() {
     List<String> result = [];
@@ -20,26 +30,9 @@ class PnnsGroupQueryConfiguration {
     return result;
   }
 
+  @override
   Map<String, String> getParametersMap() {
-    Map<String, String> result = {};
-
-    if (language != null) {
-      result.putIfAbsent('lc', () => language.code);
-    }
-
-    if (fields != null) {
-      bool ignoreFieldsFilter = false;
-      for (ProductField field in fields!) {
-        if (field == ProductField.ALL) {
-          ignoreFieldsFilter = true;
-          break;
-        }
-      }
-
-      if (!ignoreFieldsFilter) {
-        result.putIfAbsent('fields', () => getFieldsKeys().join(','));
-      }
-    }
+    final Map<String, String> result = super.getParametersMap();
 
     // explicit json output
     result.putIfAbsent('json', () => '1');
