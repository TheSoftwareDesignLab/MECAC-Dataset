diff --git a/budget/lib/pages/activityPage.dart b/budget/lib/pages/activityPage.dart
index 4339af8c8..7a03757fc 100644
--- a/budget/lib/pages/activityPage.dart
+++ b/budget/lib/pages/activityPage.dart
@@ -150,183 +150,172 @@ class ActivityPage extends StatelessWidget {
           return true;
         }
       },
-      child: Stack(
-        children: [
-          PageFramework(
-            dragDownToDismiss: true,
-            title: "activity-log".tr(),
-            listID: pageId,
-            floatingActionButton: AnimateFABDelayed(
-              fab: AddFAB(
-                tooltip: "add-transaction".tr(),
-                openPage: AddTransactionPage(
-                  routesToPopAfterDelete: RoutesToPopAfterDelete.None,
-                ),
-              ),
+      child: PageFramework(
+        dragDownToDismiss: true,
+        title: "activity-log".tr(),
+        listID: pageId,
+        floatingActionButton: AnimateFABDelayed(
+          fab: AddFAB(
+            tooltip: "add-transaction".tr(),
+            openPage: AddTransactionPage(
+              routesToPopAfterDelete: RoutesToPopAfterDelete.None,
             ),
-            slivers: [
-              StreamBuilder<List<TransactionActivityLog>>(
-                stream: database.watchAllTransactionActivityLog(limit: 30),
-                builder: (context, snapshot1) {
-                  return Container(
-                    child: StreamBuilder<List<TransactionActivityLog>>(
-                      stream: database.watchAllTransactionDeleteActivityLog(
-                          limit: 30),
-                      builder: (context, snapshot2) {
-                        // print(snapshot1.data);
-                        // print(snapshot2.data);
-                        if (snapshot1.hasData == false &&
-                            snapshot2.hasData == false) {
-                          return SliverToBoxAdapter();
-                        }
-                        List<TransactionActivityLog> activityLogList = [
-                          ...(snapshot1.data ?? []),
-                          ...(snapshot2.data ?? [])
-                        ]..sort((a, b) => b.dateTime.compareTo(a.dateTime));
-                        if (activityLogList.length <= 0) {
-                          return SliverToBoxAdapter(
-                            child: Center(
-                              child: NoResults(
-                                  message: "no-transactions-found".tr()),
-                            ),
-                          );
-                        }
-                        return SliverList(
-                          delegate: SliverChildBuilderDelegate(
-                            childCount: activityLogList.length,
-                            (BuildContext context, int index) {
-                              TransactionActivityLog item =
-                                  activityLogList[index];
-                              bool wasADeletedTransaction =
-                                  item.deleteLog != null;
-                              Transaction? transaction = item.transaction;
-                              TransactionCategory? category =
-                                  item.transactionWithCategory?.category;
-                              TransactionCategory? subCategory =
-                                  item.transactionWithCategory?.subCategory;
-                              Budget? budget =
-                                  item.transactionWithCategory?.budget;
-                              Objective? objective =
-                                  item.transactionWithCategory?.objective;
-                              Widget noTransactionFound = Padding(
-                                padding: EdgeInsetsDirectional.symmetric(
-                                    horizontal: getHorizontalPaddingConstrained(
-                                            context) +
+          ),
+        ),
+        slivers: [
+          StreamBuilder<List<TransactionActivityLog>>(
+            stream: database.watchAllTransactionActivityLog(limit: 30),
+            builder: (context, snapshot1) {
+              return Container(
+                child: StreamBuilder<List<TransactionActivityLog>>(
+                  stream:
+                      database.watchAllTransactionDeleteActivityLog(limit: 30),
+                  builder: (context, snapshot2) {
+                    // print(snapshot1.data);
+                    // print(snapshot2.data);
+                    if (snapshot1.hasData == false &&
+                        snapshot2.hasData == false) {
+                      return SliverToBoxAdapter();
+                    }
+                    List<TransactionActivityLog> activityLogList = [
+                      ...(snapshot1.data ?? []),
+                      ...(snapshot2.data ?? [])
+                    ]..sort((a, b) => b.dateTime.compareTo(a.dateTime));
+                    if (activityLogList.length <= 0) {
+                      return SliverToBoxAdapter(
+                        child: Center(
+                          child:
+                              NoResults(message: "no-transactions-found".tr()),
+                        ),
+                      );
+                    }
+                    return SliverList(
+                      delegate: SliverChildBuilderDelegate(
+                        childCount: activityLogList.length,
+                        (BuildContext context, int index) {
+                          TransactionActivityLog item = activityLogList[index];
+                          bool wasADeletedTransaction = item.deleteLog != null;
+                          Transaction? transaction = item.transaction;
+                          TransactionCategory? category =
+                              item.transactionWithCategory?.category;
+                          TransactionCategory? subCategory =
+                              item.transactionWithCategory?.subCategory;
+                          Budget? budget = item.transactionWithCategory?.budget;
+                          Objective? objective =
+                              item.transactionWithCategory?.objective;
+                          Widget noTransactionFound = Padding(
+                            padding: EdgeInsetsDirectional.symmetric(
+                                horizontal:
+                                    getHorizontalPaddingConstrained(context) +
                                         16,
-                                    vertical: 5),
-                                child: Row(
-                                  children: [
-                                    Expanded(
-                                      child: Tappable(
-                                        color: Theme.of(context)
-                                            .colorScheme
-                                            .secondaryContainer
-                                            .withOpacity(0.2),
-                                        borderRadius: 5,
-                                        child: Padding(
-                                          padding: const EdgeInsetsDirectional
-                                              .symmetric(
+                                vertical: 5),
+                            child: Row(
+                              children: [
+                                Expanded(
+                                  child: Tappable(
+                                    color: Theme.of(context)
+                                        .colorScheme
+                                        .secondaryContainer
+                                        .withOpacity(0.2),
+                                    borderRadius: 5,
+                                    child: Padding(
+                                      padding:
+                                          const EdgeInsetsDirectional.symmetric(
                                               vertical: 8.0, horizontal: 10),
-                                          child: TextFont(
-                                            text:
-                                                "transaction-no-longer-available"
-                                                    .tr(),
-                                            textColor:
-                                                getColor(context, "textLight"),
-                                            fontSize: 15,
-                                            maxLines: 2,
-                                          ),
-                                        ),
+                                      child: TextFont(
+                                        text: "transaction-no-longer-available"
+                                            .tr(),
+                                        textColor:
+                                            getColor(context, "textLight"),
+                                        fontSize: 15,
+                                        maxLines: 2,
                                       ),
                                     ),
-                                  ],
+                                  ),
                                 ),
-                              );
-                              Widget transactionEntry = transaction != null
-                                  ? Tappable(
-                                      color: Colors.transparent,
-                                      // Disable required for iOS so we can still use the pointer
-                                      disable: wasADeletedTransaction == false,
-                                      onTap: wasADeletedTransaction
-                                          ? () {
-                                              if (wasADeletedTransaction &&
-                                                  item.deleteLog != null &&
-                                                  item.transaction != null)
-                                                restoreTransaction(
-                                                  context,
-                                                  item.deleteLog!,
-                                                  item.transaction!,
-                                                );
-                                            }
-                                          : null,
+                              ],
+                            ),
+                          );
+                          Widget transactionEntry = transaction != null
+                              ? Tappable(
+                                  color: Colors.transparent,
+                                  // Disable required for iOS so we can still use the pointer
+                                  disable: wasADeletedTransaction == false,
+                                  onTap: wasADeletedTransaction
+                                      ? () {
+                                          if (wasADeletedTransaction &&
+                                              item.deleteLog != null &&
+                                              item.transaction != null)
+                                            restoreTransaction(
+                                              context,
+                                              item.deleteLog!,
+                                              item.transaction!,
+                                            );
+                                        }
+                                      : null,
 
-                                      child: Opacity(
-                                        opacity:
-                                            wasADeletedTransaction ? 0.4 : 1,
-                                        child: IgnorePointer(
-                                          ignoring: wasADeletedTransaction,
-                                          child: TransactionEntry(
-                                            containerColor:
-                                                wasADeletedTransaction
-                                                    ? Colors.transparent
-                                                    : null,
-                                            openPage: AddTransactionPage(
-                                              transaction: transaction,
-                                              routesToPopAfterDelete:
-                                                  RoutesToPopAfterDelete.One,
-                                            ),
-                                            transaction: transaction,
-                                            category: category,
-                                            subCategory: subCategory,
-                                            budget: budget,
-                                            objective: objective,
-                                            listID: pageId,
-                                          ),
+                                  child: Opacity(
+                                    opacity: wasADeletedTransaction ? 0.4 : 1,
+                                    child: IgnorePointer(
+                                      ignoring: wasADeletedTransaction,
+                                      child: TransactionEntry(
+                                        containerColor: wasADeletedTransaction
+                                            ? Colors.transparent
+                                            : null,
+                                        openPage: AddTransactionPage(
+                                          transaction: transaction,
+                                          routesToPopAfterDelete:
+                                              RoutesToPopAfterDelete.One,
                                         ),
+                                        transaction: transaction,
+                                        category: category,
+                                        subCategory: subCategory,
+                                        budget: budget,
+                                        objective: objective,
+                                        listID: pageId,
                                       ),
-                                    )
-                                  : SizedBox.shrink();
-                              return Column(
-                                key: ValueKey(
-                                    (item.transaction?.transactionPk ?? "") +
-                                        (item.deleteLog?.deleteLogPk ?? "")),
-                                crossAxisAlignment: CrossAxisAlignment.start,
-                                children: [
-                                  DateDivider(
-                                    date: transaction?.dateCreated ??
-                                        item.dateTime,
-                                    maxLines: 2,
-                                    afterDate: " • " +
-                                        (wasADeletedTransaction
-                                                ? "deleted"
-                                                : "modified")
-                                            .tr()
-                                            .capitalizeFirst +
-                                        " " +
-                                        getTimeAgo(item.dateTime),
+                                    ),
                                   ),
-                                  transaction == null
-                                      ? noTransactionFound
-                                      : transactionEntry,
-                                ],
-                              );
-                            },
-                          ),
-                        );
-                      },
-                    ),
-                  );
-                },
-              ),
-              SliverToBoxAdapter(
-                child: SizedBox(height: 75),
-              ),
-            ],
+                                )
+                              : SizedBox.shrink();
+                          return Column(
+                            key: ValueKey(
+                                (item.transaction?.transactionPk ?? "") +
+                                    (item.deleteLog?.deleteLogPk ?? "")),
+                            crossAxisAlignment: CrossAxisAlignment.start,
+                            children: [
+                              DateDivider(
+                                date: transaction?.dateCreated ?? item.dateTime,
+                                maxLines: 2,
+                                afterDate: " • " +
+                                    (wasADeletedTransaction
+                                            ? "deleted"
+                                            : "modified")
+                                        .tr()
+                                        .capitalizeFirst +
+                                    " " +
+                                    getTimeAgo(item.dateTime),
+                              ),
+                              transaction == null
+                                  ? noTransactionFound
+                                  : transactionEntry,
+                            ],
+                          );
+                        },
+                      ),
+                    );
+                  },
+                ),
+              );
+            },
           ),
-          SelectedTransactionsAppBar(
-            pageID: pageId,
+          SliverToBoxAdapter(
+            child: SizedBox(height: 75),
           ),
         ],
+        selectedTransactionsAppBar: SelectedTransactionsAppBar(
+          pageID: pageId,
+        ),
       ),
     );
   }
diff --git a/budget/lib/pages/budgetPage.dart b/budget/lib/pages/budgetPage.dart
index 5ffb4cc40..f70cab185 100644
--- a/budget/lib/pages/budgetPage.dart
+++ b/budget/lib/pages/budgetPage.dart
@@ -249,591 +249,562 @@ class _BudgetPageContentState extends State<_BudgetPageContent> {
           return true;
         }
       },
-      child: Stack(
-        children: [
-          PageFramework(
-            belowAppBarPaddingWhenCenteredTitleSmall: 0,
-            subtitle: StreamBuilder<List<CategoryWithTotal>>(
-              stream: database
-                  .watchTotalSpentInEachCategoryInTimeRangeFromCategories(
-                allWallets: Provider.of<AllWallets>(context),
-                start: budgetRange.start,
-                end: budgetRange.end,
-                categoryFks: widget.budget.categoryFks,
-                categoryFksExclude: widget.budget.categoryFksExclude,
-                budgetTransactionFilters:
-                    widget.budget.budgetTransactionFilters,
-                memberTransactionFilters:
-                    widget.budget.memberTransactionFilters,
-                member: selectedMember,
-                onlyShowTransactionsBelongingToBudgetPk:
-                    widget.budget.sharedKey != null ||
-                            widget.budget.addedTransactionsOnly == true
-                        ? widget.budget.budgetPk
-                        : null,
-                budget: widget.budget,
-              ),
-              builder: (context, snapshot) {
-                double totalSpent = 0;
-                if (snapshot.hasData) {
-                  snapshot.data!.forEach((category) {
-                    totalSpent = totalSpent + category.total;
-                  });
-                  totalSpent =
-                      totalSpent * determineBudgetPolarity(widget.budget);
-                }
+      child: PageFramework(
+        belowAppBarPaddingWhenCenteredTitleSmall: 0,
+        subtitle: StreamBuilder<List<CategoryWithTotal>>(
+          stream:
+              database.watchTotalSpentInEachCategoryInTimeRangeFromCategories(
+            allWallets: Provider.of<AllWallets>(context),
+            start: budgetRange.start,
+            end: budgetRange.end,
+            categoryFks: widget.budget.categoryFks,
+            categoryFksExclude: widget.budget.categoryFksExclude,
+            budgetTransactionFilters: widget.budget.budgetTransactionFilters,
+            memberTransactionFilters: widget.budget.memberTransactionFilters,
+            member: selectedMember,
+            onlyShowTransactionsBelongingToBudgetPk:
+                widget.budget.sharedKey != null ||
+                        widget.budget.addedTransactionsOnly == true
+                    ? widget.budget.budgetPk
+                    : null,
+            budget: widget.budget,
+          ),
+          builder: (context, snapshot) {
+            double totalSpent = 0;
+            if (snapshot.hasData) {
+              snapshot.data!.forEach((category) {
+                totalSpent = totalSpent + category.total;
+              });
+              totalSpent = totalSpent * determineBudgetPolarity(widget.budget);
+            }
 
-                if (snapshot.hasData) {
-                  return TotalSpent(
-                    budget: widget.budget,
-                    totalSpent: totalSpent,
-                  );
-                } else {
-                  return SizedBox.shrink();
-                }
-              },
-            ),
-            subtitleAlignment: AlignmentDirectional.bottomStart,
-            subtitleSize: 10,
-            backgroundColor: pageBackgroundColor,
-            listID: pageId,
-            floatingActionButton: AnimateFABDelayed(
-              fab: AddFAB(
-                tooltip: "add-transaction".tr(),
-                openPage: AddTransactionPage(
-                  selectedBudget: widget.budget.sharedKey != null ||
-                          widget.budget.addedTransactionsOnly == true
-                      ? widget.budget
-                      : null,
-                  routesToPopAfterDelete: RoutesToPopAfterDelete.One,
-                ),
-                color: Theme.of(context).colorScheme.secondary,
-                colorIcon: Theme.of(context).colorScheme.onSecondary,
-              ),
+            if (snapshot.hasData) {
+              return TotalSpent(
+                budget: widget.budget,
+                totalSpent: totalSpent,
+              );
+            } else {
+              return SizedBox.shrink();
+            }
+          },
+        ),
+        subtitleAlignment: AlignmentDirectional.bottomStart,
+        subtitleSize: 10,
+        backgroundColor: pageBackgroundColor,
+        listID: pageId,
+        floatingActionButton: AnimateFABDelayed(
+          fab: AddFAB(
+            tooltip: "add-transaction".tr(),
+            openPage: AddTransactionPage(
+              selectedBudget: widget.budget.sharedKey != null ||
+                      widget.budget.addedTransactionsOnly == true
+                  ? widget.budget
+                  : null,
+              routesToPopAfterDelete: RoutesToPopAfterDelete.One,
             ),
-            actions: [
-              CustomPopupMenuButton(
-                showButtons: enableDoubleColumn(context),
-                keepOutFirst: true,
-                items: [
-                  DropdownItemMenu(
-                    id: "edit-budget",
-                    label: "edit-budget".tr(),
-                    icon: appStateSettings["outlinedIcons"]
-                        ? Icons.edit_outlined
-                        : Icons.edit_rounded,
-                    action: () {
-                      pushRoute(
-                        context,
-                        AddBudgetPage(
-                          budget: widget.budget,
-                          routesToPopAfterDelete: RoutesToPopAfterDelete.All,
-                        ),
-                      );
-                    },
-                  ),
-                  if (widget.budget.reoccurrence != BudgetReoccurence.custom &&
-                      widget.isPastBudget == false &&
-                      widget.isPastBudgetButCurrentPeriod == false)
-                    DropdownItemMenu(
-                      id: "budget-history",
-                      label: "budget-history".tr(),
-                      icon: appStateSettings["outlinedIcons"]
-                          ? Icons.history_outlined
-                          : Icons.history_rounded,
-                      action: () {
-                        pushRoute(
-                          context,
-                          PastBudgetsPage(budgetPk: widget.budget.budgetPk),
-                        );
-                      },
+            color: Theme.of(context).colorScheme.secondary,
+            colorIcon: Theme.of(context).colorScheme.onSecondary,
+          ),
+        ),
+        actions: [
+          CustomPopupMenuButton(
+            showButtons: enableDoubleColumn(context),
+            keepOutFirst: true,
+            items: [
+              DropdownItemMenu(
+                id: "edit-budget",
+                label: "edit-budget".tr(),
+                icon: appStateSettings["outlinedIcons"]
+                    ? Icons.edit_outlined
+                    : Icons.edit_rounded,
+                action: () {
+                  pushRoute(
+                    context,
+                    AddBudgetPage(
+                      budget: widget.budget,
+                      routesToPopAfterDelete: RoutesToPopAfterDelete.All,
                     ),
-                  // DropdownItemMenu(
-                  //   id: "spending-goals",
-                  //   label: widget.budget.income == true
-                  //    ? "saving-goals".tr()
-                  //    : "spending-goals".tr(),
-                  //   icon: appStateSettings["outlinedIcons"]
-                  //       ? Icons.fact_check_outlined
-                  //       : Icons.fact_check_rounded,
-                  //   action: () {
-                  //     pushRoute(
-                  //       context,
-                  //       EditBudgetLimitsPage(
-                  //         budget: widget.budget,
-                  //       ),
-                  //     );
-                  //   },
-                  // ),
-                ],
+                  );
+                },
               ),
+              if (widget.budget.reoccurrence != BudgetReoccurence.custom &&
+                  widget.isPastBudget == false &&
+                  widget.isPastBudgetButCurrentPeriod == false)
+                DropdownItemMenu(
+                  id: "budget-history",
+                  label: "budget-history".tr(),
+                  icon: appStateSettings["outlinedIcons"]
+                      ? Icons.history_outlined
+                      : Icons.history_rounded,
+                  action: () {
+                    pushRoute(
+                      context,
+                      PastBudgetsPage(budgetPk: widget.budget.budgetPk),
+                    );
+                  },
+                ),
+              // DropdownItemMenu(
+              //   id: "spending-goals",
+              //   label: widget.budget.income == true
+              //    ? "saving-goals".tr()
+              //    : "spending-goals".tr(),
+              //   icon: appStateSettings["outlinedIcons"]
+              //       ? Icons.fact_check_outlined
+              //       : Icons.fact_check_rounded,
+              //   action: () {
+              //     pushRoute(
+              //       context,
+              //       EditBudgetLimitsPage(
+              //         budget: widget.budget,
+              //       ),
+              //     );
+              //   },
+              // ),
             ],
-            title: widget.budget.name,
-            appBarBackgroundColor:
-                Theme.of(context).colorScheme.secondaryContainer,
-            appBarBackgroundColorStart:
-                Theme.of(context).colorScheme.secondaryContainer,
-            textColor: getColor(context, "black"),
-            dragDownToDismiss: true,
-            slivers: [
-              StreamBuilder<List<CategoryWithTotal>>(
-                  stream: database.watchAllCategoryLimitsInBudgetWithCategory(
-                      widget.budget.budgetPk),
-                  builder: (context, allCategoryLimitsSnap) {
-                    return StreamBuilder<List<CategoryWithTotal>>(
-                      stream: database
-                          .watchTotalSpentInEachCategoryInTimeRangeFromCategories(
-                        allWallets: Provider.of<AllWallets>(context),
-                        start: budgetRange.start,
-                        end: budgetRange.end,
-                        categoryFks: widget.budget.categoryFks,
-                        categoryFksExclude: widget.budget.categoryFksExclude,
-                        budgetTransactionFilters:
-                            widget.budget.budgetTransactionFilters,
-                        memberTransactionFilters:
-                            widget.budget.memberTransactionFilters,
-                        member: selectedMember,
-                        onlyShowTransactionsBelongingToBudgetPk:
-                            widget.budget.sharedKey != null ||
-                                    widget.budget.addedTransactionsOnly == true
-                                ? widget.budget.budgetPk
-                                : null,
-                        budget: widget.budget,
-                        // Set to countUnassignedTransactons: false for the pie chart
-                        //  includeAllSubCategories: showAllSubcategories,
-                        // If implementing pie chart summary for subcategories, also need to implement ability to tap a subcategory from the pie chart
-                        countUnassignedTransactions: true,
-                        includeAllSubCategories: true,
-                      ),
-                      builder: (context, categoryWithTotalsSnap) {
-                        //Ensure the main category always gets bundled in
-                        List<CategoryWithTotal> allCategoryLimits =
-                            (allCategoryLimitsSnap.data ?? []).where((c) {
-                          if (c.categoryBudgetLimit != null) {
-                            return true;
-                          }
-                          return (allCategoryLimitsSnap.data ?? []).any(
-                              (other) =>
-                                  other.categoryBudgetLimit != null &&
-                                  other.category.mainCategoryPk ==
-                                      c.category.categoryPk);
-                        }).toList();
+          ),
+        ],
+        title: widget.budget.name,
+        appBarBackgroundColor: Theme.of(context).colorScheme.secondaryContainer,
+        appBarBackgroundColorStart:
+            Theme.of(context).colorScheme.secondaryContainer,
+        textColor: getColor(context, "black"),
+        dragDownToDismiss: true,
+        slivers: [
+          StreamBuilder<List<CategoryWithTotal>>(
+              stream: database.watchAllCategoryLimitsInBudgetWithCategory(
+                  widget.budget.budgetPk),
+              builder: (context, allCategoryLimitsSnap) {
+                return StreamBuilder<List<CategoryWithTotal>>(
+                  stream: database
+                      .watchTotalSpentInEachCategoryInTimeRangeFromCategories(
+                    allWallets: Provider.of<AllWallets>(context),
+                    start: budgetRange.start,
+                    end: budgetRange.end,
+                    categoryFks: widget.budget.categoryFks,
+                    categoryFksExclude: widget.budget.categoryFksExclude,
+                    budgetTransactionFilters:
+                        widget.budget.budgetTransactionFilters,
+                    memberTransactionFilters:
+                        widget.budget.memberTransactionFilters,
+                    member: selectedMember,
+                    onlyShowTransactionsBelongingToBudgetPk:
+                        widget.budget.sharedKey != null ||
+                                widget.budget.addedTransactionsOnly == true
+                            ? widget.budget.budgetPk
+                            : null,
+                    budget: widget.budget,
+                    // Set to countUnassignedTransactons: false for the pie chart
+                    //  includeAllSubCategories: showAllSubcategories,
+                    // If implementing pie chart summary for subcategories, also need to implement ability to tap a subcategory from the pie chart
+                    countUnassignedTransactions: true,
+                    includeAllSubCategories: true,
+                  ),
+                  builder: (context, categoryWithTotalsSnap) {
+                    //Ensure the main category always gets bundled in
+                    List<CategoryWithTotal> allCategoryLimits =
+                        (allCategoryLimitsSnap.data ?? []).where((c) {
+                      if (c.categoryBudgetLimit != null) {
+                        return true;
+                      }
+                      return (allCategoryLimitsSnap.data ?? []).any((other) =>
+                          other.categoryBudgetLimit != null &&
+                          other.category.mainCategoryPk ==
+                              c.category.categoryPk);
+                    }).toList();
 
-                        // Remove all duplicates
-                        Set<String> existingCategoryPks =
-                            (categoryWithTotalsSnap.data ?? [])
-                                .map((c) => c.category.categoryPk)
-                                .toSet();
-                        List<CategoryWithTotal> categoryWithTotals = [
-                          ...(categoryWithTotalsSnap.data ?? []),
-                          ...(allCategoryLimits).where((c) =>
-                              !existingCategoryPks
-                                  .contains(c.category.categoryPk)),
-                        ];
+                    // Remove all duplicates
+                    Set<String> existingCategoryPks =
+                        (categoryWithTotalsSnap.data ?? [])
+                            .map((c) => c.category.categoryPk)
+                            .toSet();
+                    List<CategoryWithTotal> categoryWithTotals = [
+                      ...(categoryWithTotalsSnap.data ?? []),
+                      ...(allCategoryLimits).where((c) =>
+                          !existingCategoryPks.contains(c.category.categoryPk)),
+                    ];
 
-                        //Count number of categories that have a spending limit, but no spending
-                        int extraCategoriesCountWithSpendingLimit =
-                            (allCategoryLimits)
-                                .where((c) => !existingCategoryPks
-                                    .contains(c.category.categoryPk))
-                                .length;
+                    //Count number of categories that have a spending limit, but no spending
+                    int extraCategoriesCountWithSpendingLimit =
+                        (allCategoryLimits)
+                            .where((c) => !existingCategoryPks
+                                .contains(c.category.categoryPk))
+                            .length;
 
-                        TotalSpentCategoriesSummary s =
-                            watchTotalSpentInTimeRangeHelper(
-                          dataInput: categoryWithTotals,
-                          showAllSubcategories: showAllSubcategories,
-                          multiplyTotalBy:
-                              determineBudgetPolarity(widget.budget),
+                    TotalSpentCategoriesSummary s =
+                        watchTotalSpentInTimeRangeHelper(
+                      dataInput: categoryWithTotals,
+                      showAllSubcategories: showAllSubcategories,
+                      multiplyTotalBy: determineBudgetPolarity(widget.budget),
+                    );
+                    List<Widget> categoryEntries = [];
+                    double totalSpentPercent = 45 / 360;
+                    categoryWithTotals.asMap().forEach(
+                      (index, category) {
+                        categoryEntries.add(
+                          CategoryEntry(
+                            alwaysHide:
+                                showAllCategoriesWithCategoryLimit == false &&
+                                    category.transactionCount == -1,
+                            percentageOffset: totalSpentPercent,
+                            getPercentageAfterText: (double categorySpent) {
+                              if (widget.budget.income == true) {
+                                return categorySpent < 0 &&
+                                        showIncomeExpenseIcons
+                                    ? "of-total".tr().toLowerCase()
+                                    : "of-saving".tr().toLowerCase();
+                              } else {
+                                return categorySpent > 0 &&
+                                        showIncomeExpenseIcons
+                                    ? "of-total".tr().toLowerCase()
+                                    : "of-spending".tr().toLowerCase();
+                              }
+                            },
+                            selectedSubCategoryPk: selectedCategory?.categoryPk,
+                            expandSubcategories: showAllSubcategories ||
+                                category.category.categoryPk ==
+                                    selectedCategory?.categoryPk ||
+                                category.category.categoryPk ==
+                                    selectedCategory?.mainCategoryPk,
+                            subcategoriesWithTotalMap:
+                                s.subCategorySpendingIndexedByMainCategoryPk,
+                            todayPercent: todayPercent,
+                            overSpentColor: category.total > 0
+                                ? getColor(context, "incomeAmount")
+                                : getColor(context, "expenseAmount"),
+                            showIncomeExpenseIcons: showIncomeExpenseIcons,
+                            onLongPress: (TransactionCategory category,
+                                CategoryBudgetLimit? categoryBudgetLimit) {
+                              enterCategoryLimitPopup(
+                                context,
+                                category,
+                                categoryBudgetLimit,
+                                widget.budget.budgetPk,
+                                (p0) => null,
+                                widget.budget.isAbsoluteSpendingLimit,
+                              );
+                            },
+                            isAbsoluteSpendingLimit:
+                                widget.budget.isAbsoluteSpendingLimit,
+                            budgetLimit: budgetAmount,
+                            categoryBudgetLimit: category.categoryBudgetLimit,
+                            category: category.category,
+                            totalSpent: s.totalSpent,
+                            transactionCount: category.transactionCount,
+                            categorySpent: showIncomeExpenseIcons == true
+                                ? category.total
+                                : category.total.abs(),
+                            onTap: (TransactionCategory tappedCategory, _) {
+                              if (selectedCategory?.categoryPk ==
+                                  tappedCategory.categoryPk) {
+                                setState(() {
+                                  selectedCategory = null;
+                                });
+                                _pieChartDisplayStateKey.currentState
+                                    ?.setTouchedIndex(-1);
+                              } else {
+                                if (showAllSubcategories ||
+                                    tappedCategory.mainCategoryPk == null) {
+                                  setState(() {
+                                    selectedCategory = tappedCategory;
+                                  });
+                                  _pieChartDisplayStateKey.currentState
+                                      ?.setTouchedCategoryPk(
+                                          tappedCategory.categoryPk);
+                                } else {
+                                  // We are tapping a subcategoryEntry and it is not in the pie chart
+                                  // because showAllSubcategories is false and mainCategoryPk is not null
+                                  setState(() {
+                                    selectedCategory = tappedCategory;
+                                  });
+                                  _pieChartDisplayStateKey.currentState
+                                      ?.setTouchedCategoryPk(
+                                          tappedCategory.mainCategoryPk);
+                                }
+                              }
+                            },
+                            selected: category.category.categoryPk ==
+                                    selectedCategory?.mainCategoryPk ||
+                                selectedCategory?.categoryPk ==
+                                    category.category.categoryPk,
+                            allSelected: selectedCategory == null,
+                          ),
                         );
-                        List<Widget> categoryEntries = [];
-                        double totalSpentPercent = 45 / 360;
-                        categoryWithTotals.asMap().forEach(
-                          (index, category) {
-                            categoryEntries.add(
-                              CategoryEntry(
-                                alwaysHide:
-                                    showAllCategoriesWithCategoryLimit ==
-                                            false &&
-                                        category.transactionCount == -1,
-                                percentageOffset: totalSpentPercent,
-                                getPercentageAfterText: (double categorySpent) {
-                                  if (widget.budget.income == true) {
-                                    return categorySpent < 0 &&
-                                            showIncomeExpenseIcons
-                                        ? "of-total".tr().toLowerCase()
-                                        : "of-saving".tr().toLowerCase();
-                                  } else {
-                                    return categorySpent > 0 &&
-                                            showIncomeExpenseIcons
-                                        ? "of-total".tr().toLowerCase()
-                                        : "of-spending".tr().toLowerCase();
-                                  }
-                                },
-                                selectedSubCategoryPk:
-                                    selectedCategory?.categoryPk,
-                                expandSubcategories: showAllSubcategories ||
-                                    category.category.categoryPk ==
-                                        selectedCategory?.categoryPk ||
-                                    category.category.categoryPk ==
-                                        selectedCategory?.mainCategoryPk,
-                                subcategoriesWithTotalMap: s
-                                    .subCategorySpendingIndexedByMainCategoryPk,
-                                todayPercent: todayPercent,
-                                overSpentColor: category.total > 0
-                                    ? getColor(context, "incomeAmount")
-                                    : getColor(context, "expenseAmount"),
-                                showIncomeExpenseIcons: showIncomeExpenseIcons,
-                                onLongPress: (TransactionCategory category,
-                                    CategoryBudgetLimit? categoryBudgetLimit) {
-                                  enterCategoryLimitPopup(
-                                    context,
-                                    category,
-                                    categoryBudgetLimit,
-                                    widget.budget.budgetPk,
-                                    (p0) => null,
-                                    widget.budget.isAbsoluteSpendingLimit,
-                                  );
-                                },
-                                isAbsoluteSpendingLimit:
-                                    widget.budget.isAbsoluteSpendingLimit,
-                                budgetLimit: budgetAmount,
-                                categoryBudgetLimit:
-                                    category.categoryBudgetLimit,
-                                category: category.category,
-                                totalSpent: s.totalSpent,
-                                transactionCount: category.transactionCount,
-                                categorySpent: showIncomeExpenseIcons == true
-                                    ? category.total
-                                    : category.total.abs(),
-                                onTap: (TransactionCategory tappedCategory, _) {
-                                  if (selectedCategory?.categoryPk ==
-                                      tappedCategory.categoryPk) {
+                        if (s.totalSpent != 0)
+                          totalSpentPercent +=
+                              category.total.abs() / s.totalSpent;
+                      },
+                    );
+                    // print(s.totalSpent);
+                    return SliverToBoxAdapter(
+                      child: Column(
+                        children: [
+                          Transform.translate(
+                            offset: Offset(0, -10).withDirectionality(context),
+                            child: WidgetSize(
+                              onChange: (Size size) {
+                                budgetHeaderHeight = size.height - 20;
+                              },
+                              child: Container(
+                                padding: EdgeInsetsDirectional.only(
+                                  top: 10,
+                                  bottom: 22,
+                                  start: 22,
+                                  end: 22,
+                                ),
+                                decoration: BoxDecoration(
+                                  // borderRadius: BorderRadiusDirectional.vertical(
+                                  //     bottom: Radius.circular(10)),
+                                  color: Theme.of(context)
+                                      .colorScheme
+                                      .secondaryContainer,
+                                ),
+                                child: Column(
+                                  children: [
+                                    Transform.scale(
+                                      alignment:
+                                          AlignmentDirectional.bottomCenter,
+                                      scale: 1500,
+                                      child: Container(
+                                        height: 10,
+                                        width: 100,
+                                        color: Theme.of(context)
+                                            .colorScheme
+                                            .secondaryContainer,
+                                      ),
+                                    ),
+                                    Padding(
+                                      padding: EdgeInsetsDirectional.symmetric(
+                                        horizontal:
+                                            getHorizontalPaddingConstrained(
+                                                context),
+                                      ),
+                                      child: StreamBuilder<double?>(
+                                        stream: database.watchTotalOfBudget(
+                                          allWallets:
+                                              Provider.of<AllWallets>(context),
+                                          start: budgetRange.start,
+                                          end: budgetRange.end,
+                                          categoryFks:
+                                              widget.budget.categoryFks,
+                                          categoryFksExclude:
+                                              widget.budget.categoryFksExclude,
+                                          budgetTransactionFilters: widget
+                                              .budget.budgetTransactionFilters,
+                                          memberTransactionFilters: widget
+                                              .budget.memberTransactionFilters,
+                                          member: selectedMember,
+                                          onlyShowTransactionsBelongingToBudgetPk:
+                                              widget.budget.sharedKey != null ||
+                                                      widget.budget
+                                                              .addedTransactionsOnly ==
+                                                          true
+                                                  ? widget.budget.budgetPk
+                                                  : null,
+                                          budget: widget.budget,
+                                          searchFilters: SearchFilters(
+                                              paidStatus: [PaidStatus.notPaid]),
+                                          paidOnly: false,
+                                        ),
+                                        builder: (context, snapshot) {
+                                          return BudgetTimeline(
+                                            dateForRange: dateForRange,
+                                            budget: widget.budget,
+                                            large: true,
+                                            percent: budgetAmount == 0
+                                                ? 0
+                                                : s.totalSpent /
+                                                    budgetAmount *
+                                                    100,
+                                            yourPercent: 0,
+                                            todayPercent:
+                                                widget.isPastBudget == true
+                                                    ? -1
+                                                    : todayPercent,
+                                            ghostPercent: budgetAmount == 0
+                                                ? 0
+                                                : (((snapshot.data ?? 0) *
+                                                            determineBudgetPolarity(
+                                                                widget
+                                                                    .budget)) /
+                                                        budgetAmount) *
+                                                    100,
+                                          );
+                                        },
+                                      ),
+                                    ),
+                                    widget.isPastBudget == true
+                                        ? SizedBox.shrink()
+                                        : DaySpending(
+                                            budget: widget.budget,
+                                            totalAmount: s.totalSpent,
+                                            large: true,
+                                            budgetRange: budgetRange,
+                                            padding: const EdgeInsetsDirectional
+                                                .only(top: 15, bottom: 0),
+                                          ),
+                                  ],
+                                ),
+                              ),
+                            ),
+                          ),
+                          appStateSettings["sharedBudgets"]
+                              ? BudgetSpenderSummary(
+                                  budget: widget.budget,
+                                  budgetRange: budgetRange,
+                                  setSelectedMember: (member) {
                                     setState(() {
+                                      selectedMember = member;
                                       selectedCategory = null;
                                     });
                                     _pieChartDisplayStateKey.currentState
                                         ?.setTouchedIndex(-1);
-                                  } else {
-                                    if (showAllSubcategories ||
-                                        tappedCategory.mainCategoryPk == null) {
-                                      setState(() {
-                                        selectedCategory = tappedCategory;
-                                      });
-                                      _pieChartDisplayStateKey.currentState
-                                          ?.setTouchedCategoryPk(
-                                              tappedCategory.categoryPk);
-                                    } else {
-                                      // We are tapping a subcategoryEntry and it is not in the pie chart
-                                      // because showAllSubcategories is false and mainCategoryPk is not null
-                                      setState(() {
-                                        selectedCategory = tappedCategory;
-                                      });
-                                      _pieChartDisplayStateKey.currentState
-                                          ?.setTouchedCategoryPk(
-                                              tappedCategory.mainCategoryPk);
-                                    }
-                                  }
-                                },
-                                selected: category.category.categoryPk ==
-                                        selectedCategory?.mainCategoryPk ||
-                                    selectedCategory?.categoryPk ==
-                                        category.category.categoryPk,
-                                allSelected: selectedCategory == null,
-                              ),
-                            );
-                            if (s.totalSpent != 0)
-                              totalSpentPercent +=
-                                  category.total.abs() / s.totalSpent;
-                          },
-                        );
-                        // print(s.totalSpent);
-                        return SliverToBoxAdapter(
-                          child: Column(
-                            children: [
-                              Transform.translate(
-                                offset:
-                                    Offset(0, -10).withDirectionality(context),
-                                child: WidgetSize(
-                                  onChange: (Size size) {
-                                    budgetHeaderHeight = size.height - 20;
                                   },
-                                  child: Container(
-                                    padding: EdgeInsetsDirectional.only(
-                                      top: 10,
-                                      bottom: 22,
-                                      start: 22,
-                                      end: 22,
-                                    ),
-                                    decoration: BoxDecoration(
-                                      // borderRadius: BorderRadiusDirectional.vertical(
-                                      //     bottom: Radius.circular(10)),
-                                      color: Theme.of(context)
-                                          .colorScheme
-                                          .secondaryContainer,
-                                    ),
-                                    child: Column(
-                                      children: [
-                                        Transform.scale(
-                                          alignment:
-                                              AlignmentDirectional.bottomCenter,
-                                          scale: 1500,
-                                          child: Container(
-                                            height: 10,
-                                            width: 100,
-                                            color: Theme.of(context)
-                                                .colorScheme
-                                                .secondaryContainer,
-                                          ),
-                                        ),
-                                        Padding(
-                                          padding:
-                                              EdgeInsetsDirectional.symmetric(
-                                            horizontal:
-                                                getHorizontalPaddingConstrained(
-                                                    context),
-                                          ),
-                                          child: StreamBuilder<double?>(
-                                            stream: database.watchTotalOfBudget(
-                                              allWallets:
-                                                  Provider.of<AllWallets>(
-                                                      context),
-                                              start: budgetRange.start,
-                                              end: budgetRange.end,
-                                              categoryFks:
-                                                  widget.budget.categoryFks,
-                                              categoryFksExclude: widget
-                                                  .budget.categoryFksExclude,
-                                              budgetTransactionFilters: widget
-                                                  .budget
-                                                  .budgetTransactionFilters,
-                                              memberTransactionFilters: widget
-                                                  .budget
-                                                  .memberTransactionFilters,
-                                              member: selectedMember,
-                                              onlyShowTransactionsBelongingToBudgetPk:
-                                                  widget.budget.sharedKey !=
-                                                              null ||
-                                                          widget.budget
-                                                                  .addedTransactionsOnly ==
-                                                              true
-                                                      ? widget.budget.budgetPk
-                                                      : null,
-                                              budget: widget.budget,
-                                              searchFilters: SearchFilters(
-                                                  paidStatus: [
-                                                    PaidStatus.notPaid
-                                                  ]),
-                                              paidOnly: false,
-                                            ),
-                                            builder: (context, snapshot) {
-                                              return BudgetTimeline(
-                                                dateForRange: dateForRange,
-                                                budget: widget.budget,
-                                                large: true,
-                                                percent: budgetAmount == 0
-                                                    ? 0
-                                                    : s.totalSpent /
-                                                        budgetAmount *
-                                                        100,
-                                                yourPercent: 0,
-                                                todayPercent:
-                                                    widget.isPastBudget == true
-                                                        ? -1
-                                                        : todayPercent,
-                                                ghostPercent: budgetAmount == 0
-                                                    ? 0
-                                                    : (((snapshot.data ?? 0) *
-                                                                determineBudgetPolarity(
-                                                                    widget
-                                                                        .budget)) /
-                                                            budgetAmount) *
-                                                        100,
-                                              );
-                                            },
-                                          ),
-                                        ),
-                                        widget.isPastBudget == true
-                                            ? SizedBox.shrink()
-                                            : DaySpending(
-                                                budget: widget.budget,
-                                                totalAmount: s.totalSpent,
-                                                large: true,
-                                                budgetRange: budgetRange,
-                                                padding:
-                                                    const EdgeInsetsDirectional
-                                                        .only(
-                                                        top: 15, bottom: 0),
-                                              ),
-                                      ],
-                                    ),
-                                  ),
-                                ),
-                              ),
-                              appStateSettings["sharedBudgets"]
-                                  ? BudgetSpenderSummary(
-                                      budget: widget.budget,
-                                      budgetRange: budgetRange,
-                                      setSelectedMember: (member) {
-                                        setState(() {
-                                          selectedMember = member;
-                                          selectedCategory = null;
-                                        });
-                                        _pieChartDisplayStateKey.currentState
-                                            ?.setTouchedIndex(-1);
-                                      },
-                                    )
-                                  : SizedBox.shrink(),
-                              if (categoryWithTotals.length > 0)
-                                SizedBox(height: 30),
+                                )
+                              : SizedBox.shrink(),
+                          if (categoryWithTotals.length > 0)
+                            SizedBox(height: 30),
 
-                              if (categoryWithTotals.length > 0)
-                                pieChart(
-                                  budgetRange: budgetRange,
-                                  totalSpent: s.totalSpent,
-                                  showAllSubcategories: showAllSubcategories,
-                                  toggleAllSubCategories:
-                                      toggleAllSubcategories,
-                                  dataFilterUnassignedTransactions:
-                                      s.dataFilterUnassignedTransactions,
-                                  hasSubCategories: s.hasSubCategories,
-                                  pageBackgroundColor: pageBackgroundColor,
-                                ),
-                              // if (snapshot.data!.length > 0)
-                              //   SizedBox(height: 35),
-                              ...categoryEntries,
-                              if (categoryWithTotals.length > 0)
-                                SizedBox(height: 15),
-                              AnimatedExpanded(
-                                expand: selectedCategory == null &&
-                                    extraCategoriesCountWithSpendingLimit > 0,
-                                child: Padding(
-                                  padding: const EdgeInsetsDirectional.only(
-                                      bottom: 15),
-                                  child: AnimatedSizeSwitcher(
-                                    child: Center(
-                                      key: ValueKey(
-                                          "showAllCategoriesWithCategoryLimit" +
-                                              showAllCategoriesWithCategoryLimit
-                                                  .toString()),
-                                      child: LowKeyButton(
-                                        onTap: () {
-                                          toggleShowAllCategoriesWithCategoryLimit();
-                                        },
-                                        text: showAllCategoriesWithCategoryLimit
-                                            ? "collapse-empty-categories".tr()
-                                            : "expand-all-with-spending-goals"
-                                                .tr(),
-                                        extraWidgetAtBeginning: true,
-                                        extraWidget: Padding(
-                                          padding:
-                                              const EdgeInsetsDirectional.only(
-                                                  end: 3),
-                                          child: Transform.scale(
-                                            scale: 1.6,
-                                            child: Icon(
-                                              showAllCategoriesWithCategoryLimit
-                                                  ? appStateSettings[
-                                                          "outlinedIcons"]
-                                                      ? Icons
-                                                          .arrow_drop_up_outlined
-                                                      : Icons
-                                                          .arrow_drop_up_rounded
-                                                  : appStateSettings[
-                                                          "outlinedIcons"]
-                                                      ? Icons
-                                                          .arrow_drop_down_outlined
-                                                      : Icons
-                                                          .arrow_drop_down_rounded,
-                                              size: 15,
-                                              color: getColor(context, "black")
-                                                  .withOpacity(0.5),
-                                            ),
-                                          ),
+                          if (categoryWithTotals.length > 0)
+                            pieChart(
+                              budgetRange: budgetRange,
+                              totalSpent: s.totalSpent,
+                              showAllSubcategories: showAllSubcategories,
+                              toggleAllSubCategories: toggleAllSubcategories,
+                              dataFilterUnassignedTransactions:
+                                  s.dataFilterUnassignedTransactions,
+                              hasSubCategories: s.hasSubCategories,
+                              pageBackgroundColor: pageBackgroundColor,
+                            ),
+                          // if (snapshot.data!.length > 0)
+                          //   SizedBox(height: 35),
+                          ...categoryEntries,
+                          if (categoryWithTotals.length > 0)
+                            SizedBox(height: 15),
+                          AnimatedExpanded(
+                            expand: selectedCategory == null &&
+                                extraCategoriesCountWithSpendingLimit > 0,
+                            child: Padding(
+                              padding:
+                                  const EdgeInsetsDirectional.only(bottom: 15),
+                              child: AnimatedSizeSwitcher(
+                                child: Center(
+                                  key: ValueKey(
+                                      "showAllCategoriesWithCategoryLimit" +
+                                          showAllCategoriesWithCategoryLimit
+                                              .toString()),
+                                  child: LowKeyButton(
+                                    onTap: () {
+                                      toggleShowAllCategoriesWithCategoryLimit();
+                                    },
+                                    text: showAllCategoriesWithCategoryLimit
+                                        ? "collapse-empty-categories".tr()
+                                        : "expand-all-with-spending-goals".tr(),
+                                    extraWidgetAtBeginning: true,
+                                    extraWidget: Padding(
+                                      padding: const EdgeInsetsDirectional.only(
+                                          end: 3),
+                                      child: Transform.scale(
+                                        scale: 1.6,
+                                        child: Icon(
+                                          showAllCategoriesWithCategoryLimit
+                                              ? appStateSettings[
+                                                      "outlinedIcons"]
+                                                  ? Icons.arrow_drop_up_outlined
+                                                  : Icons.arrow_drop_up_rounded
+                                              : appStateSettings[
+                                                      "outlinedIcons"]
+                                                  ? Icons
+                                                      .arrow_drop_down_outlined
+                                                  : Icons
+                                                      .arrow_drop_down_rounded,
+                                          size: 15,
+                                          color: getColor(context, "black")
+                                              .withOpacity(0.5),
                                         ),
                                       ),
                                     ),
                                   ),
                                 ),
                               ),
-                            ],
+                            ),
                           ),
-                        );
-                      },
-                    );
-                  }),
-              SliverToBoxAdapter(
-                child: AnimatedExpanded(
-                  expand: selectedCategory != null,
-                  child: Padding(
-                    key: ValueKey(1),
-                    padding: const EdgeInsetsDirectional.only(
-                        start: 13, end: 15, top: 5, bottom: 15),
-                    child: Center(
-                      child: TextFont(
-                        text: "transactions-for-selected-category".tr(),
-                        maxLines: 10,
-                        textAlign: TextAlign.center,
-                        fontSize: 13,
-                        textColor: getColor(context, "textLight"),
-                        // fontWeight: FontWeight.bold,
+                        ],
                       ),
-                    ),
+                    );
+                  },
+                );
+              }),
+          SliverToBoxAdapter(
+            child: AnimatedExpanded(
+              expand: selectedCategory != null,
+              child: Padding(
+                key: ValueKey(1),
+                padding: const EdgeInsetsDirectional.only(
+                    start: 13, end: 15, top: 5, bottom: 15),
+                child: Center(
+                  child: TextFont(
+                    text: "transactions-for-selected-category".tr(),
+                    maxLines: 10,
+                    textAlign: TextAlign.center,
+                    fontSize: 13,
+                    textColor: getColor(context, "textLight"),
+                    // fontWeight: FontWeight.bold,
                   ),
                 ),
               ),
-              SliverToBoxAdapter(
-                child: Padding(
-                  padding: const EdgeInsetsDirectional.only(bottom: 13),
-                  child: Container(
-                    margin: EdgeInsetsDirectional.symmetric(horizontal: 13),
-                    decoration: BoxDecoration(
-                      borderRadius:
-                          BorderRadiusDirectional.all(Radius.circular(15)),
-                      color: appStateSettings["materialYou"]
-                          ? dynamicPastel(context,
-                              Theme.of(context).colorScheme.secondaryContainer,
-                              amount: 0.5)
-                          : getColor(context, "lightDarkAccentHeavyLight"),
-                      boxShadow: boxShadowCheck(boxShadowGeneral(context)),
-                    ),
-                    child: BudgetLineGraph(
-                      budget: widget.budget,
-                      dateForRange: dateForRange,
-                      isPastBudget: widget.isPastBudget,
-                      selectedCategory: selectedCategory,
-                      budgetRange: budgetRange,
-                      showIfNone: false,
-                    ),
-                  ),
+            ),
+          ),
+          SliverToBoxAdapter(
+            child: Padding(
+              padding: const EdgeInsetsDirectional.only(bottom: 13),
+              child: Container(
+                margin: EdgeInsetsDirectional.symmetric(horizontal: 13),
+                decoration: BoxDecoration(
+                  borderRadius:
+                      BorderRadiusDirectional.all(Radius.circular(15)),
+                  color: appStateSettings["materialYou"]
+                      ? dynamicPastel(context,
+                          Theme.of(context).colorScheme.secondaryContainer,
+                          amount: 0.5)
+                      : getColor(context, "lightDarkAccentHeavyLight"),
+                  boxShadow: boxShadowCheck(boxShadowGeneral(context)),
+                ),
+                child: BudgetLineGraph(
+                  budget: widget.budget,
+                  dateForRange: dateForRange,
+                  isPastBudget: widget.isPastBudget,
+                  selectedCategory: selectedCategory,
+                  budgetRange: budgetRange,
+                  showIfNone: false,
                 ),
               ),
-              TransactionEntries(
-                budgetRange.start,
-                budgetRange.end,
-                categoryFks: selectedCategory != null
-                    ? [selectedCategory!.categoryPk]
-                    : widget.budget.categoryFks,
-                categoryFksExclude: selectedCategory != null
-                    ? null
-                    : widget.budget.categoryFksExclude,
-                listID: pageId,
-                budgetTransactionFilters:
-                    widget.budget.budgetTransactionFilters,
-                memberTransactionFilters:
-                    widget.budget.memberTransactionFilters,
-                member: selectedMember,
-                onlyShowTransactionsBelongingToBudgetPk:
-                    widget.budget.sharedKey != null ||
-                            widget.budget.addedTransactionsOnly == true
-                        ? widget.budget.budgetPk
-                        : null,
-                walletFks: widget.budget.walletFks ?? [],
-                budget: widget.budget,
-                dateDividerColor: pageBackgroundColor,
-                transactionBackgroundColor: pageBackgroundColor,
-                categoryTintColor: Theme.of(context).colorScheme.primary,
-                noResultsExtraWidget: widget.budget.reoccurrence !=
-                            BudgetReoccurence.custom &&
+            ),
+          ),
+          TransactionEntries(
+            budgetRange.start,
+            budgetRange.end,
+            categoryFks: selectedCategory != null
+                ? [selectedCategory!.categoryPk]
+                : widget.budget.categoryFks,
+            categoryFksExclude: selectedCategory != null
+                ? null
+                : widget.budget.categoryFksExclude,
+            listID: pageId,
+            budgetTransactionFilters: widget.budget.budgetTransactionFilters,
+            memberTransactionFilters: widget.budget.memberTransactionFilters,
+            member: selectedMember,
+            onlyShowTransactionsBelongingToBudgetPk:
+                widget.budget.sharedKey != null ||
+                        widget.budget.addedTransactionsOnly == true
+                    ? widget.budget.budgetPk
+                    : null,
+            walletFks: widget.budget.walletFks ?? [],
+            budget: widget.budget,
+            dateDividerColor: pageBackgroundColor,
+            transactionBackgroundColor: pageBackgroundColor,
+            categoryTintColor: Theme.of(context).colorScheme.primary,
+            noResultsExtraWidget:
+                widget.budget.reoccurrence != BudgetReoccurence.custom &&
                         widget.isPastBudget == false &&
                         widget.isPastBudgetButCurrentPeriod == false
                     ? Padding(
@@ -873,45 +844,43 @@ class _BudgetPageContentState extends State<_BudgetPageContent> {
                         ),
                       )
                     : SizedBox.shrink(),
-                showTotalCashFlow: true,
-                showExcludedBudgetTag: (Transaction transaction) =>
-                    transaction.budgetFksExclude
-                        ?.contains(widget.budget.budgetPk) ==
-                    true,
-              ),
-              SliverToBoxAdapter(
-                child: widget.budget.sharedDateUpdated == null
-                    ? SizedBox.shrink()
-                    : Padding(
-                        padding: const EdgeInsetsDirectional.only(
-                            start: 10, end: 10, bottom: 0),
-                        child: TextFont(
-                          text: "synced".tr() +
-                              " " +
-                              getTimeAgo(
-                                widget.budget.sharedDateUpdated!,
-                              ).toLowerCase() +
-                              "\n Created by " +
-                              getMemberNickname(
-                                  (widget.budget.sharedMembers ?? [""])[0]),
-                          fontSize: 13,
-                          textColor: getColor(context, "textLight"),
-                          textAlign: TextAlign.center,
-                          maxLines: 4,
-                        ),
-                      ),
-              ),
-              // Wipe all remaining pixels off - sometimes graphics artifacts are left behind
-              SliverToBoxAdapter(
-                child: Container(height: 1, color: pageBackgroundColor),
-              ),
-              SliverToBoxAdapter(child: SizedBox(height: 45))
-            ],
+            showTotalCashFlow: true,
+            showExcludedBudgetTag: (Transaction transaction) =>
+                transaction.budgetFksExclude
+                    ?.contains(widget.budget.budgetPk) ==
+                true,
           ),
-          SelectedTransactionsAppBar(
-            pageID: pageId,
+          SliverToBoxAdapter(
+            child: widget.budget.sharedDateUpdated == null
+                ? SizedBox.shrink()
+                : Padding(
+                    padding: const EdgeInsetsDirectional.only(
+                        start: 10, end: 10, bottom: 0),
+                    child: TextFont(
+                      text: "synced".tr() +
+                          " " +
+                          getTimeAgo(
+                            widget.budget.sharedDateUpdated!,
+                          ).toLowerCase() +
+                          "\n Created by " +
+                          getMemberNickname(
+                              (widget.budget.sharedMembers ?? [""])[0]),
+                      fontSize: 13,
+                      textColor: getColor(context, "textLight"),
+                      textAlign: TextAlign.center,
+                      maxLines: 4,
+                    ),
+                  ),
+          ),
+          // Wipe all remaining pixels off - sometimes graphics artifacts are left behind
+          SliverToBoxAdapter(
+            child: Container(height: 1, color: pageBackgroundColor),
           ),
+          SliverToBoxAdapter(child: SizedBox(height: 45))
         ],
+        selectedTransactionsAppBar: SelectedTransactionsAppBar(
+          pageID: pageId,
+        ),
       ),
     );
   }
diff --git a/budget/lib/pages/creditDebtTransactionsPage.dart b/budget/lib/pages/creditDebtTransactionsPage.dart
index 2094b0a35..a3b52b09b 100644
--- a/budget/lib/pages/creditDebtTransactionsPage.dart
+++ b/budget/lib/pages/creditDebtTransactionsPage.dart
@@ -320,264 +320,250 @@ class CreditDebtTransactionsState extends State<CreditDebtTransactions>
           return true;
         }
       },
-      child: Stack(
-        children: [
-          StreamBuilder<List<Objective?>>(
-              stream: database.watchAllObjectives(
-                objectiveType: ObjectiveType.loan,
-                hideArchived: true,
-                showDifferenceLoans: null,
+      child: StreamBuilder<List<Objective?>>(
+          stream: database.watchAllObjectives(
+            objectiveType: ObjectiveType.loan,
+            hideArchived: true,
+            showDifferenceLoans: null,
+          ),
+          builder: (context, allLoanObjectivesSnapshot) {
+            return PageFramework(
+              key: pageState,
+              scrollController: _scrollController,
+              resizeToAvoidBottomInset: true,
+              actions: [
+                (allLoanObjectivesSnapshot.data?.length ?? 0) <= 0
+                    ? StreamBuilder<List<Objective?>>(
+                        stream: database.watchAllObjectives(
+                            objectiveType: ObjectiveType.loan,
+                            hideArchived: false,
+                            showDifferenceLoans: null,
+                            limit: 1),
+                        builder: (context, snapshot) {
+                          if (snapshot.hasData == false)
+                            return SizedBox.shrink();
+                          if ((snapshot.data?.length ?? 0) <= 0)
+                            return SizedBox.shrink();
+                          return CustomPopupMenuButton(
+                            showButtons: enableDoubleColumn(context),
+                            keepOutFirst: true,
+                            items: [
+                              DropdownItemMenu(
+                                id: "edit-loans",
+                                label: "edit".tr(),
+                                icon: appStateSettings["outlinedIcons"]
+                                    ? Icons.edit_outlined
+                                    : Icons.edit_rounded,
+                                action: () {
+                                  pushRoute(
+                                    context,
+                                    EditObjectivesPage(
+                                      objectiveType: ObjectiveType.loan,
+                                    ),
+                                  );
+                                },
+                              ),
+                            ],
+                          );
+                        },
+                      )
+                    : SizedBox.shrink(),
+              ],
+              floatingActionButton: AnimateFABDelayed(
+                enabled: true,
+                fab: AddFAB(
+                  tooltip: isCredit == true || isCredit == null
+                      ? "add-credit".tr()
+                      : "add-debt".tr(),
+                  onTap: () {
+                    openBottomSheet(
+                      context,
+                      AddLoanPopup(
+                        selectedTransactionType:
+                            isCredit == true || isCredit == null
+                                ? TransactionSpecialType.credit
+                                : TransactionSpecialType.debt,
+                      ),
+                    );
+                  },
+                ),
               ),
-              builder: (context, allLoanObjectivesSnapshot) {
-                return PageFramework(
-                  key: pageState,
-                  scrollController: _scrollController,
-                  resizeToAvoidBottomInset: true,
-                  actions: [
-                    (allLoanObjectivesSnapshot.data?.length ?? 0) <= 0
-                        ? StreamBuilder<List<Objective?>>(
-                            stream: database.watchAllObjectives(
-                                objectiveType: ObjectiveType.loan,
-                                hideArchived: false,
-                                showDifferenceLoans: null,
-                                limit: 1),
-                            builder: (context, snapshot) {
-                              if (snapshot.hasData == false)
-                                return SizedBox.shrink();
-                              if ((snapshot.data?.length ?? 0) <= 0)
-                                return SizedBox.shrink();
-                              return CustomPopupMenuButton(
-                                showButtons: enableDoubleColumn(context),
-                                keepOutFirst: true,
-                                items: [
-                                  DropdownItemMenu(
-                                    id: "edit-loans",
-                                    label: "edit".tr(),
-                                    icon: appStateSettings["outlinedIcons"]
-                                        ? Icons.edit_outlined
-                                        : Icons.edit_rounded,
-                                    action: () {
-                                      pushRoute(
-                                        context,
-                                        EditObjectivesPage(
-                                          objectiveType: ObjectiveType.loan,
-                                        ),
-                                      );
-                                    },
+              listID: pageId,
+              title: "loans".tr(),
+              dragDownToDismiss: true,
+              bodyBuilder: (scrollController, scrollPhysics, sliverAppBar) {
+                if (allLoanObjectivesSnapshot.hasData == false)
+                  return SizedBox.shrink();
+                if ((allLoanObjectivesSnapshot.data?.length ?? 0) <= 0) {
+                  numberLongTerm = 0;
+                  _tabController.index = 0;
+                  return CustomScrollView(
+                    controller: _scrollController,
+                    slivers: [
+                      sliverAppBar,
+                      ...loanInfoAppBar,
+                      ...oneTimeLoanList(false)
+                    ],
+                  );
+                }
+                // Set the tab to long term if none were added previously, but one was added
+                if (numberLongTerm == 0) {
+                  _tabController.index = 1;
+                  numberLongTerm = allLoanObjectivesSnapshot.data?.length ?? 0;
+                }
+                return NestedScrollView(
+                  controller: _scrollController,
+                  headerSliverBuilder:
+                      (BuildContext contextHeader, bool innerBoxIsScrolled) {
+                    return <Widget>[
+                      SliverOverlapAbsorber(
+                        handle: NestedScrollView.sliverOverlapAbsorberHandleFor(
+                            contextHeader),
+                        sliver: MultiSliver(
+                          children: [
+                            sliverAppBar,
+                            SliverToBoxAdapter(
+                              child: Padding(
+                                padding: EdgeInsetsDirectional.only(bottom: 13),
+                                child: Padding(
+                                  padding: EdgeInsetsDirectional.symmetric(
+                                    horizontal: getHorizontalPaddingConstrained(
+                                          context,
+                                          enabled:
+                                              enableDoubleColumn(context) ==
+                                                  false,
+                                        ) +
+                                        13,
                                   ),
-                                ],
-                              );
-                            },
-                          )
-                        : SizedBox.shrink(),
-                  ],
-                  floatingActionButton: AnimateFABDelayed(
-                    enabled: true,
-                    fab: AddFAB(
-                      tooltip: isCredit == true || isCredit == null
-                          ? "add-credit".tr()
-                          : "add-debt".tr(),
-                      onTap: () {
-                        openBottomSheet(
-                          context,
-                          AddLoanPopup(
-                            selectedTransactionType:
-                                isCredit == true || isCredit == null
-                                    ? TransactionSpecialType.credit
-                                    : TransactionSpecialType.debt,
-                          ),
-                        );
-                      },
-                    ),
-                  ),
-                  listID: pageId,
-                  title: "loans".tr(),
-                  dragDownToDismiss: true,
-                  bodyBuilder: (scrollController, scrollPhysics, sliverAppBar) {
-                    if (allLoanObjectivesSnapshot.hasData == false)
-                      return SizedBox.shrink();
-                    if ((allLoanObjectivesSnapshot.data?.length ?? 0) <= 0) {
-                      numberLongTerm = 0;
-                      _tabController.index = 0;
-                      return CustomScrollView(
-                        controller: _scrollController,
-                        slivers: [
-                          sliverAppBar,
-                          ...loanInfoAppBar,
-                          ...oneTimeLoanList(false)
-                        ],
-                      );
-                    }
-                    // Set the tab to long term if none were added previously, but one was added
-                    if (numberLongTerm == 0) {
-                      _tabController.index = 1;
-                      numberLongTerm =
-                          allLoanObjectivesSnapshot.data?.length ?? 0;
-                    }
-                    return NestedScrollView(
-                      controller: _scrollController,
-                      headerSliverBuilder: (BuildContext contextHeader,
-                          bool innerBoxIsScrolled) {
-                        return <Widget>[
-                          SliverOverlapAbsorber(
-                            handle:
-                                NestedScrollView.sliverOverlapAbsorberHandleFor(
-                                    contextHeader),
-                            sliver: MultiSliver(
-                              children: [
-                                sliverAppBar,
-                                SliverToBoxAdapter(
                                   child: Padding(
-                                    padding:
-                                        EdgeInsetsDirectional.only(bottom: 13),
-                                    child: Padding(
-                                      padding: EdgeInsetsDirectional.symmetric(
-                                        horizontal:
-                                            getHorizontalPaddingConstrained(
-                                                  context,
-                                                  enabled: enableDoubleColumn(
-                                                          context) ==
-                                                      false,
-                                                ) +
-                                                13,
-                                      ),
-                                      child: Padding(
-                                        padding:
-                                            EdgeInsetsDirectional.symmetric(
-                                          horizontal:
-                                              getHorizontalPaddingConstrained(
-                                                  context),
-                                        ),
-                                        child: Row(
-                                          children: [
-                                            Expanded(
-                                              child: IncomeExpenseTabSelector(
-                                                hasBorderRadius: true,
-                                                onTabChanged: (_) {},
-                                                initialTabIsIncome: false,
-                                                showIcons: false,
-                                                tabController: _tabController,
-                                                expenseLabel: "one-time".tr(),
-                                                expenseCustomIcon: Icon(
-                                                  appStateSettings[
-                                                          "outlinedIcons"]
-                                                      ? Icons
-                                                          .event_available_outlined
-                                                      : Icons
-                                                          .event_available_rounded,
-                                                ),
-                                                incomeLabel: "long-term".tr(),
-                                                incomeCustomIcon: Icon(
-                                                  appStateSettings[
-                                                          "outlinedIcons"]
-                                                      ? Icons.av_timer_outlined
-                                                      : Icons.av_timer_rounded,
-                                                ),
-                                              ),
+                                    padding: EdgeInsetsDirectional.symmetric(
+                                      horizontal:
+                                          getHorizontalPaddingConstrained(
+                                              context),
+                                    ),
+                                    child: Row(
+                                      children: [
+                                        Expanded(
+                                          child: IncomeExpenseTabSelector(
+                                            hasBorderRadius: true,
+                                            onTabChanged: (_) {},
+                                            initialTabIsIncome: false,
+                                            showIcons: false,
+                                            tabController: _tabController,
+                                            expenseLabel: "one-time".tr(),
+                                            expenseCustomIcon: Icon(
+                                              appStateSettings["outlinedIcons"]
+                                                  ? Icons
+                                                      .event_available_outlined
+                                                  : Icons
+                                                      .event_available_rounded,
+                                            ),
+                                            incomeLabel: "long-term".tr(),
+                                            incomeCustomIcon: Icon(
+                                              appStateSettings["outlinedIcons"]
+                                                  ? Icons.av_timer_outlined
+                                                  : Icons.av_timer_rounded,
                                             ),
-                                            AnimatedBuilder(
-                                              animation:
-                                                  _tabController.animation!,
-                                              builder: (BuildContext context,
-                                                  Widget? child) {
-                                                return ClipRRect(
-                                                  borderRadius:
-                                                      BorderRadiusDirectional
-                                                          .circular(15),
-                                                  child: SizeTransition(
-                                                    sizeFactor: _tabController
-                                                        .animation!,
-                                                    axis: Axis.horizontal,
-                                                    child: FadeTransition(
-                                                      opacity: _tabController
-                                                          .animation!,
-                                                      child: Padding(
-                                                        padding:
-                                                            const EdgeInsetsDirectional
-                                                                .only(start: 7),
-                                                        child: ButtonIcon(
-                                                          size: 48,
-                                                          iconPadding: 25,
-                                                          key: ValueKey(2),
-                                                          onTap: () {
-                                                            pushRoute(
-                                                              context,
-                                                              EditObjectivesPage(
-                                                                objectiveType:
-                                                                    ObjectiveType
-                                                                        .loan,
-                                                              ),
-                                                            );
-                                                          },
-                                                          icon: appStateSettings[
-                                                                  "outlinedIcons"]
-                                                              ? Icons
-                                                                  .edit_outlined
-                                                              : Icons
-                                                                  .edit_rounded,
-                                                        ),
-                                                      ),
+                                          ),
+                                        ),
+                                        AnimatedBuilder(
+                                          animation: _tabController.animation!,
+                                          builder: (BuildContext context,
+                                              Widget? child) {
+                                            return ClipRRect(
+                                              borderRadius:
+                                                  BorderRadiusDirectional
+                                                      .circular(15),
+                                              child: SizeTransition(
+                                                sizeFactor:
+                                                    _tabController.animation!,
+                                                axis: Axis.horizontal,
+                                                child: FadeTransition(
+                                                  opacity:
+                                                      _tabController.animation!,
+                                                  child: Padding(
+                                                    padding:
+                                                        const EdgeInsetsDirectional
+                                                            .only(start: 7),
+                                                    child: ButtonIcon(
+                                                      size: 48,
+                                                      iconPadding: 25,
+                                                      key: ValueKey(2),
+                                                      onTap: () {
+                                                        pushRoute(
+                                                          context,
+                                                          EditObjectivesPage(
+                                                            objectiveType:
+                                                                ObjectiveType
+                                                                    .loan,
+                                                          ),
+                                                        );
+                                                      },
+                                                      icon: appStateSettings[
+                                                              "outlinedIcons"]
+                                                          ? Icons.edit_outlined
+                                                          : Icons.edit_rounded,
                                                     ),
                                                   ),
-                                                );
-                                              },
-                                            ),
-                                          ],
+                                                ),
+                                              ),
+                                            );
+                                          },
                                         ),
-                                      ),
+                                      ],
                                     ),
                                   ),
                                 ),
-                                ...loanInfoAppBar,
-                              ],
+                              ),
                             ),
+                            ...loanInfoAppBar,
+                          ],
+                        ),
+                      ),
+                    ];
+                  },
+                  body: Builder(
+                    builder: (contextPageView) {
+                      return TabBarView(
+                        controller: _tabController,
+                        children: [
+                          CustomScrollView(
+                            slivers: [
+                              SliverPinnedOverlapInjector(
+                                handle: NestedScrollView
+                                    .sliverOverlapAbsorberHandleFor(
+                                  contextPageView,
+                                ),
+                              ),
+                              ...oneTimeLoanList(true)
+                            ],
                           ),
-                        ];
-                      },
-                      body: Builder(
-                        builder: (contextPageView) {
-                          return TabBarView(
-                            controller: _tabController,
-                            children: [
-                              CustomScrollView(
-                                slivers: [
-                                  SliverPinnedOverlapInjector(
-                                    handle: NestedScrollView
-                                        .sliverOverlapAbsorberHandleFor(
-                                      contextPageView,
-                                    ),
-                                  ),
-                                  ...oneTimeLoanList(true)
-                                ],
+                          CustomScrollView(
+                            slivers: [
+                              SliverPinnedOverlapInjector(
+                                handle: NestedScrollView
+                                    .sliverOverlapAbsorberHandleFor(
+                                  contextPageView,
+                                ),
                               ),
-                              CustomScrollView(
-                                slivers: [
-                                  SliverPinnedOverlapInjector(
-                                    handle: NestedScrollView
-                                        .sliverOverlapAbsorberHandleFor(
-                                      contextPageView,
-                                    ),
-                                  ),
-                                  ObjectiveListDifferenceLoan(
-                                    searchFor: searchValue,
-                                  ),
-                                  ...longTermLoansList
-                                ],
+                              ObjectiveListDifferenceLoan(
+                                searchFor: searchValue,
                               ),
+                              ...longTermLoansList
                             ],
-                          );
-                        },
-                      ),
-                    );
-                  },
+                          ),
+                        ],
+                      );
+                    },
+                  ),
                 );
-              }),
-          SelectedTransactionsAppBar(
-            pageID: pageId,
-            enableSettleAllButton: true,
-          ),
-        ],
-      ),
+              },
+              selectedTransactionsAppBar: SelectedTransactionsAppBar(
+                pageID: pageId,
+                enableSettleAllButton: true,
+              ),
+            );
+          }),
     );
   }
 }
diff --git a/budget/lib/pages/objectivePage.dart b/budget/lib/pages/objectivePage.dart
index 260c9aaa8..82ab27ced 100644
--- a/budget/lib/pages/objectivePage.dart
+++ b/budget/lib/pages/objectivePage.dart
@@ -652,9 +652,9 @@ class _ObjectivePageContentState extends State<_ObjectivePageContent> {
               ),
               SliverToBoxAdapter(child: SizedBox(height: 45))
             ],
-          ),
-          SelectedTransactionsAppBar(
-            pageID: pageId,
+            selectedTransactionsAppBar: SelectedTransactionsAppBar(
+              pageID: pageId,
+            ),
           ),
           IgnorePointer(
             child: Align(
diff --git a/budget/lib/pages/subscriptionsPage.dart b/budget/lib/pages/subscriptionsPage.dart
index 4d0a18506..9dc1f5c0f 100644
--- a/budget/lib/pages/subscriptionsPage.dart
+++ b/budget/lib/pages/subscriptionsPage.dart
@@ -63,120 +63,116 @@ class SubscriptionsPageState extends State<SubscriptionsPage> {
           return true;
         }
       },
-      child: Stack(
-        children: [
-          PageFramework(
-            key: pageState,
-            listID: "Subscriptions",
-            floatingActionButton: AnimateFABDelayed(
-              fab: AddFAB(
-                tooltip: "add-subscription".tr(),
-                openPage: AddTransactionPage(
-                  selectedType: TransactionSpecialType.subscription,
-                  routesToPopAfterDelete: RoutesToPopAfterDelete.None,
-                ),
-              ),
+      child: PageFramework(
+        key: pageState,
+        listID: "Subscriptions",
+        floatingActionButton: AnimateFABDelayed(
+          fab: AddFAB(
+            tooltip: "add-subscription".tr(),
+            openPage: AddTransactionPage(
+              selectedType: TransactionSpecialType.subscription,
+              routesToPopAfterDelete: RoutesToPopAfterDelete.None,
             ),
-            dragDownToDismiss: true,
-            title: "subscriptions".tr(),
-            actions: [
-              CustomPopupMenuButton(
-                showButtons: enableDoubleColumn(context),
-                keepOutFirst: true,
-                items: [
-                  DropdownItemMenu(
-                    id: "settings",
-                    label: "settings".tr(),
-                    icon: appStateSettings["outlinedIcons"]
-                        ? Icons.settings_outlined
-                        : Icons.settings_rounded,
-                    action: () {
-                      openBottomSheet(
-                        context,
-                        PopupFramework(
-                          hasPadding: false,
-                          child: SubscriptionSettings(),
-                        ),
-                      );
-                    },
-                  ),
-                ],
-              ),
-            ],
-            slivers: [
-              SliverToBoxAdapter(
-                child: TotalUpcomingHeaderPeriodSwitcher(
-                  transactionListStream: database.getAllSubscriptions().$1,
-                  selectedType: selectedType,
-                  setSelectedType: (chosenType) {
-                    setState(() {
-                      selectedType = chosenType;
-                    });
-                  },
-                  selectedSubtitleTranslation: (selectedType) {
-                    return selectedType == SelectedSubscriptionsType.yearly
-                        ? "yearly-subscriptions".tr()
-                        : selectedType == SelectedSubscriptionsType.monthly
-                            ? "monthly-subscriptions".tr()
-                            : "total-subscriptions".tr();
-                  },
-                ),
-              ),
-              StreamBuilder<List<Transaction>>(
-                stream: database.getAllSubscriptions().$1,
-                builder: (context, snapshot) {
-                  if (snapshot.hasData) {
-                    if (snapshot.data!.length <= 0) {
-                      return SliverToBoxAdapter(
-                          child: NoResults(
-                              padding: const EdgeInsetsDirectional.only(
-                                top: 15,
-                                end: 30,
-                                start: 30,
-                              ),
-                              message: "no-subscription-transactions".tr()));
-                    }
-                    return SliverList(
-                      delegate: SliverChildBuilderDelegate(
-                        (BuildContext context, int index) {
-                          Transaction transaction = snapshot.data![index];
-                          return Column(
-                            crossAxisAlignment: CrossAxisAlignment.start,
-                            children: [
-                              HorizontalBreak(
-                                  padding: EdgeInsetsDirectional.only(
-                                      top: 4, bottom: 6)),
-                              TransactionEntry(
-                                aboveWidget: UpcomingTransactionDateHeader(
-                                  selectedType: selectedType,
-                                  transaction: transaction,
-                                ),
-                                openPage: AddTransactionPage(
-                                  transaction: transaction,
-                                  routesToPopAfterDelete:
-                                      RoutesToPopAfterDelete.One,
-                                ),
-                                transaction: transaction,
-                                listID: "Subscriptions",
-                              ),
-                            ],
-                          );
-                        },
-                        childCount: snapshot.data?.length,
-                      ),
-                    );
-                  } else {
-                    return SliverToBoxAdapter();
-                  }
+          ),
+        ),
+        dragDownToDismiss: true,
+        title: "subscriptions".tr(),
+        actions: [
+          CustomPopupMenuButton(
+            showButtons: enableDoubleColumn(context),
+            keepOutFirst: true,
+            items: [
+              DropdownItemMenu(
+                id: "settings",
+                label: "settings".tr(),
+                icon: appStateSettings["outlinedIcons"]
+                    ? Icons.settings_outlined
+                    : Icons.settings_rounded,
+                action: () {
+                  openBottomSheet(
+                    context,
+                    PopupFramework(
+                      hasPadding: false,
+                      child: SubscriptionSettings(),
+                    ),
+                  );
                 },
               ),
-              SliverToBoxAdapter(child: SizedBox(height: 55)),
             ],
           ),
-          SelectedTransactionsAppBar(
-            pageID: "Subscriptions",
+        ],
+        slivers: [
+          SliverToBoxAdapter(
+            child: TotalUpcomingHeaderPeriodSwitcher(
+              transactionListStream: database.getAllSubscriptions().$1,
+              selectedType: selectedType,
+              setSelectedType: (chosenType) {
+                setState(() {
+                  selectedType = chosenType;
+                });
+              },
+              selectedSubtitleTranslation: (selectedType) {
+                return selectedType == SelectedSubscriptionsType.yearly
+                    ? "yearly-subscriptions".tr()
+                    : selectedType == SelectedSubscriptionsType.monthly
+                        ? "monthly-subscriptions".tr()
+                        : "total-subscriptions".tr();
+              },
+            ),
+          ),
+          StreamBuilder<List<Transaction>>(
+            stream: database.getAllSubscriptions().$1,
+            builder: (context, snapshot) {
+              if (snapshot.hasData) {
+                if (snapshot.data!.length <= 0) {
+                  return SliverToBoxAdapter(
+                      child: NoResults(
+                          padding: const EdgeInsetsDirectional.only(
+                            top: 15,
+                            end: 30,
+                            start: 30,
+                          ),
+                          message: "no-subscription-transactions".tr()));
+                }
+                return SliverList(
+                  delegate: SliverChildBuilderDelegate(
+                    (BuildContext context, int index) {
+                      Transaction transaction = snapshot.data![index];
+                      return Column(
+                        crossAxisAlignment: CrossAxisAlignment.start,
+                        children: [
+                          HorizontalBreak(
+                              padding: EdgeInsetsDirectional.only(
+                                  top: 4, bottom: 6)),
+                          TransactionEntry(
+                            aboveWidget: UpcomingTransactionDateHeader(
+                              selectedType: selectedType,
+                              transaction: transaction,
+                            ),
+                            openPage: AddTransactionPage(
+                              transaction: transaction,
+                              routesToPopAfterDelete:
+                                  RoutesToPopAfterDelete.One,
+                            ),
+                            transaction: transaction,
+                            listID: "Subscriptions",
+                          ),
+                        ],
+                      );
+                    },
+                    childCount: snapshot.data?.length,
+                  ),
+                );
+              } else {
+                return SliverToBoxAdapter();
+              }
+            },
           ),
+          SliverToBoxAdapter(child: SizedBox(height: 55)),
         ],
+        selectedTransactionsAppBar: SelectedTransactionsAppBar(
+          pageID: "Subscriptions",
+        ),
       ),
     );
   }
diff --git a/budget/lib/pages/transactionsSearchPage.dart b/budget/lib/pages/transactionsSearchPage.dart
index 56709d154..cbba5de16 100644
--- a/budget/lib/pages/transactionsSearchPage.dart
+++ b/budget/lib/pages/transactionsSearchPage.dart
@@ -163,225 +163,216 @@ class TransactionsSearchPageState extends State<TransactionsSearchPage>
           return true;
         }
       },
-      child: Stack(
-        children: [
-          Listener(
-            onPointerDown: (_) {
-              _searchFocusNode.unfocus();
-              minimizeKeyboard(context);
-            },
-            child: PageFramework(
-              scrollToTopButton: true,
-              scrollToBottomButton: true,
-              listID: "TransactionsSearch",
-              dragDownToDismiss: true,
-              onScroll: _scrollListener,
-              title: "search".tr(),
-              floatingActionButton: AnimateFABDelayed(
-                fab: AddFAB(
-                  tooltip: "add-transaction".tr(),
-                  openPage: AddTransactionPage(
-                    routesToPopAfterDelete: RoutesToPopAfterDelete.None,
-                  ),
-                ),
+      child: Listener(
+        onPointerDown: (_) {
+          _searchFocusNode.unfocus();
+          minimizeKeyboard(context);
+        },
+        child: PageFramework(
+          scrollToTopButton: true,
+          scrollToBottomButton: true,
+          listID: "TransactionsSearch",
+          dragDownToDismiss: true,
+          onScroll: _scrollListener,
+          title: "search".tr(),
+          floatingActionButton: AnimateFABDelayed(
+            fab: AddFAB(
+              tooltip: "add-transaction".tr(),
+              openPage: AddTransactionPage(
+                routesToPopAfterDelete: RoutesToPopAfterDelete.None,
               ),
-              slivers: [
-                SliverToBoxAdapter(
-                  child: Padding(
-                    padding: EdgeInsetsDirectional.symmetric(
-                        horizontal: getHorizontalPaddingConstrained(context)),
-                    child: AnimatedBuilder(
-                      animation: _animationControllerSearch,
-                      builder: (_, child) {
-                        return Transform.translate(
-                          offset: Offset(0,
-                              6.5 - 6.5 * (_animationControllerSearch.value)),
-                          child: child,
-                        );
-                      },
-                      child: Row(
-                        children: [
-                          SizedBox(width: 20),
-                          Expanded(
-                            child: TextInput(
-                              labelText: "search-placeholder".tr(),
-                              icon: appStateSettings["outlinedIcons"]
-                                  ? Icons.search_outlined
-                                  : Icons.search_rounded,
-                              onSubmitted: (value) {
-                                searchFilters.searchQuery = value;
-                              },
-                              onChanged: (value) {
-                                _debouncer.run(() {
-                                  if (searchFilters.searchQuery != value)
-                                    setState(() {
-                                      searchFilters.searchQuery = value;
-                                    });
+            ),
+          ),
+          slivers: [
+            SliverToBoxAdapter(
+              child: Padding(
+                padding: EdgeInsetsDirectional.symmetric(
+                    horizontal: getHorizontalPaddingConstrained(context)),
+                child: AnimatedBuilder(
+                  animation: _animationControllerSearch,
+                  builder: (_, child) {
+                    return Transform.translate(
+                      offset: Offset(
+                          0, 6.5 - 6.5 * (_animationControllerSearch.value)),
+                      child: child,
+                    );
+                  },
+                  child: Row(
+                    children: [
+                      SizedBox(width: 20),
+                      Expanded(
+                        child: TextInput(
+                          labelText: "search-placeholder".tr(),
+                          icon: appStateSettings["outlinedIcons"]
+                              ? Icons.search_outlined
+                              : Icons.search_rounded,
+                          onSubmitted: (value) {
+                            searchFilters.searchQuery = value;
+                          },
+                          onChanged: (value) {
+                            _debouncer.run(() {
+                              if (searchFilters.searchQuery != value)
+                                setState(() {
+                                  searchFilters.searchQuery = value;
                                 });
-                              },
-                              padding: EdgeInsetsDirectional.all(0),
-                              focusNode: _searchFocusNode,
-                            ),
-                          ),
-                          SizedBox(width: 7),
-                          AnimatedSwitcher(
-                            duration: Duration(milliseconds: 500),
-                            child: ButtonIcon(
-                              key: ValueKey(
-                                (searchFilters.dateTimeRange == null)
-                                    .toString(),
-                              ),
-                              color: searchFilters.dateTimeRange == null
-                                  ? null
-                                  : Theme.of(context)
-                                      .colorScheme
-                                      .tertiaryContainer,
-                              iconColor: searchFilters.dateTimeRange == null
-                                  ? null
-                                  : Theme.of(context)
-                                      .colorScheme
-                                      .onTertiaryContainer,
-                              onTap: () {
-                                selectDateRange(context);
-                              },
-                              icon: appStateSettings["outlinedIcons"]
-                                  ? Icons.calendar_month_outlined
-                                  : Icons.calendar_month_rounded,
-                            ),
+                            });
+                          },
+                          padding: EdgeInsetsDirectional.all(0),
+                          focusNode: _searchFocusNode,
+                        ),
+                      ),
+                      SizedBox(width: 7),
+                      AnimatedSwitcher(
+                        duration: Duration(milliseconds: 500),
+                        child: ButtonIcon(
+                          key: ValueKey(
+                            (searchFilters.dateTimeRange == null).toString(),
                           ),
-                          SizedBox(width: 7),
-                          AnimatedSwitcher(
-                            duration: Duration(milliseconds: 500),
-                            child: ButtonIcon(
-                              key: ValueKey(
-                                searchFilters.isClear(
-                                  ignoreDateTimeRange: true,
-                                  ignoreSearchQuery: true,
-                                ),
-                              ),
-                              color: searchFilters.isClear(
-                                ignoreDateTimeRange: true,
-                                ignoreSearchQuery: true,
-                              )
-                                  ? null
-                                  : Theme.of(context)
-                                      .colorScheme
-                                      .tertiaryContainer,
-                              iconColor: searchFilters.isClear(
-                                ignoreDateTimeRange: true,
-                                ignoreSearchQuery: true,
-                              )
-                                  ? null
-                                  : Theme.of(context)
-                                      .colorScheme
-                                      .onTertiaryContainer,
-                              onTap: () {
-                                selectFilters(context);
-                              },
-                              icon: appStateSettings["outlinedIcons"]
-                                  ? Icons.filter_alt_outlined
-                                  : Icons.filter_alt_rounded,
+                          color: searchFilters.dateTimeRange == null
+                              ? null
+                              : Theme.of(context).colorScheme.tertiaryContainer,
+                          iconColor: searchFilters.dateTimeRange == null
+                              ? null
+                              : Theme.of(context)
+                                  .colorScheme
+                                  .onTertiaryContainer,
+                          onTap: () {
+                            selectDateRange(context);
+                          },
+                          icon: appStateSettings["outlinedIcons"]
+                              ? Icons.calendar_month_outlined
+                              : Icons.calendar_month_rounded,
+                        ),
+                      ),
+                      SizedBox(width: 7),
+                      AnimatedSwitcher(
+                        duration: Duration(milliseconds: 500),
+                        child: ButtonIcon(
+                          key: ValueKey(
+                            searchFilters.isClear(
+                              ignoreDateTimeRange: true,
+                              ignoreSearchQuery: true,
                             ),
                           ),
-                          SizedBox(width: 20),
-                        ],
+                          color: searchFilters.isClear(
+                            ignoreDateTimeRange: true,
+                            ignoreSearchQuery: true,
+                          )
+                              ? null
+                              : Theme.of(context).colorScheme.tertiaryContainer,
+                          iconColor: searchFilters.isClear(
+                            ignoreDateTimeRange: true,
+                            ignoreSearchQuery: true,
+                          )
+                              ? null
+                              : Theme.of(context)
+                                  .colorScheme
+                                  .onTertiaryContainer,
+                          onTap: () {
+                            selectFilters(context);
+                          },
+                          icon: appStateSettings["outlinedIcons"]
+                              ? Icons.filter_alt_outlined
+                              : Icons.filter_alt_rounded,
+                        ),
                       ),
-                    ),
+                      SizedBox(width: 20),
+                    ],
                   ),
                 ),
-                SliverToBoxAdapter(
-                  child: SizedBox(height: 13),
+              ),
+            ),
+            SliverToBoxAdapter(
+              child: SizedBox(height: 13),
+            ),
+            SliverToBoxAdapter(
+              child: Padding(
+                padding: EdgeInsetsDirectional.symmetric(
+                    horizontal: getHorizontalPaddingConstrained(context)),
+                child: AppliedFilterChips(
+                  searchFilters: searchFilters,
+                  openFiltersSelection: () {
+                    selectFilters(context);
+                  },
+                  clearSearchFilters: clearSearchFilters,
+                  //openSelectDate: () => selectDateRange(context),
                 ),
-                SliverToBoxAdapter(
-                  child: Padding(
-                    padding: EdgeInsetsDirectional.symmetric(
-                        horizontal: getHorizontalPaddingConstrained(context)),
-                    child: AppliedFilterChips(
-                      searchFilters: searchFilters,
-                      openFiltersSelection: () {
-                        selectFilters(context);
-                      },
-                      clearSearchFilters: clearSearchFilters,
-                      //openSelectDate: () => selectDateRange(context),
-                    ),
+              ),
+            ),
+            Builder(builder: (context) {
+              Widget dateRangeWidget = Tappable(
+                borderRadius: 10,
+                onTap: () {
+                  selectDateRange(context);
+                },
+                color: Colors.transparent,
+                child: Padding(
+                  padding: const EdgeInsetsDirectional.only(
+                    start: 10,
+                    end: 10,
+                    top: 10,
+                    bottom: 8,
+                  ),
+                  child: TextFont(
+                    text: searchFilters.dateTimeRange == null
+                        ? "all-time".tr()
+                        : getWordedDateShortMore(
+                                searchFilters.dateTimeRange?.start ??
+                                    DateTime.now(),
+                                includeYear: true) +
+                            " – " +
+                            getWordedDateShortMore(
+                                searchFilters.dateTimeRange?.end ??
+                                    DateTime.now(),
+                                includeYear: true),
+                    fontSize: 13,
+                    textAlign: TextAlign.center,
+                    textColor: getColor(context, "textLight"),
                   ),
                 ),
-                Builder(builder: (context) {
-                  Widget dateRangeWidget = Tappable(
-                    borderRadius: 10,
-                    onTap: () {
-                      selectDateRange(context);
-                    },
-                    color: Colors.transparent,
-                    child: Padding(
-                      padding: const EdgeInsetsDirectional.only(
-                        start: 10,
-                        end: 10,
-                        top: 10,
-                        bottom: 8,
-                      ),
-                      child: TextFont(
-                        text: searchFilters.dateTimeRange == null
-                            ? "all-time".tr()
-                            : getWordedDateShortMore(
-                                    searchFilters.dateTimeRange?.start ??
-                                        DateTime.now(),
-                                    includeYear: true) +
-                                " – " +
-                                getWordedDateShortMore(
-                                    searchFilters.dateTimeRange?.end ??
-                                        DateTime.now(),
-                                    includeYear: true),
-                        fontSize: 13,
-                        textAlign: TextAlign.center,
-                        textColor: getColor(context, "textLight"),
-                      ),
-                    ),
-                  );
-                  return TransactionEntries(
-                    renderType: TransactionEntriesRenderType.slivers,
-                    null, null,
-                    listID: "TransactionsSearch",
-                    noResultsMessage: "no-transactions-found".tr(),
-                    noSearchResultsVariation: true,
-                    searchFilters: searchFilters,
-                    // limit: 250,
-                    noResultsExtraWidget: dateRangeWidget,
-                    totalCashFlowExtraWidget: Transform.translate(
-                        offset: Offset(0, -15), child: dateRangeWidget),
-                    showTotalCashFlow: true,
-                  );
-                }),
-                // TransactionEntries(
-                //   simpleListRender: true,
-                //   null, null,
-                //   listID: "TransactionsSearch",
-                //   noResultsMessage: "no-transactions-found".tr(),
-                //   noSearchResultsVariation: true,
-                //   searchFilters: searchFilters,
-                //   // limit: 250,
-                //   showTotalCashFlow: true,
-                //   extraCashFlowInformation: getWordedDateShortMore(
-                //           searchFilters.dateTimeRange?.start ?? DateTime.now(),
-                //           includeYear: true) +
-                //       " - " +
-                //       getWordedDateShortMore(
-                //           searchFilters.dateTimeRange?.end ?? DateTime.now(),
-                //           includeYear: true),
-                //   onTapCashFlow: () {
-                //     selectDateRange(context);
-                //   },
-                // ),
-                SliverToBoxAdapter(
-                  child: SizedBox(height: 50),
-                ),
-              ],
+              );
+              return TransactionEntries(
+                renderType: TransactionEntriesRenderType.slivers,
+                null, null,
+                listID: "TransactionsSearch",
+                noResultsMessage: "no-transactions-found".tr(),
+                noSearchResultsVariation: true,
+                searchFilters: searchFilters,
+                // limit: 250,
+                noResultsExtraWidget: dateRangeWidget,
+                totalCashFlowExtraWidget: Transform.translate(
+                    offset: Offset(0, -15), child: dateRangeWidget),
+                showTotalCashFlow: true,
+              );
+            }),
+            // TransactionEntries(
+            //   simpleListRender: true,
+            //   null, null,
+            //   listID: "TransactionsSearch",
+            //   noResultsMessage: "no-transactions-found".tr(),
+            //   noSearchResultsVariation: true,
+            //   searchFilters: searchFilters,
+            //   // limit: 250,
+            //   showTotalCashFlow: true,
+            //   extraCashFlowInformation: getWordedDateShortMore(
+            //           searchFilters.dateTimeRange?.start ?? DateTime.now(),
+            //           includeYear: true) +
+            //       " - " +
+            //       getWordedDateShortMore(
+            //           searchFilters.dateTimeRange?.end ?? DateTime.now(),
+            //           includeYear: true),
+            //   onTapCashFlow: () {
+            //     selectDateRange(context);
+            //   },
+            // ),
+            SliverToBoxAdapter(
+              child: SizedBox(height: 50),
             ),
-          ),
-          SelectedTransactionsAppBar(
+          ],
+          selectedTransactionsAppBar: SelectedTransactionsAppBar(
             pageID: "TransactionsSearch",
           ),
-        ],
+        ),
       ),
     );
   }
diff --git a/budget/lib/pages/upcomingOverdueTransactionsPage.dart b/budget/lib/pages/upcomingOverdueTransactionsPage.dart
index af96d44a2..4218bec01 100644
--- a/budget/lib/pages/upcomingOverdueTransactionsPage.dart
+++ b/budget/lib/pages/upcomingOverdueTransactionsPage.dart
@@ -71,248 +71,240 @@ class UpcomingOverdueTransactionsState
           return true;
         }
       },
-      child: Stack(
-        children: [
-          PageFramework(
-            key: pageState,
-            resizeToAvoidBottomInset: true,
-            floatingActionButton: AnimateFABDelayed(
-              enabled: overdueTransactions == null,
-              fab: AnimateFABDelayed(
-                fab: AddFAB(
-                  tooltip: "add-upcoming".tr(),
-                  openPage: AddTransactionPage(
-                    selectedType: TransactionSpecialType.upcoming,
-                    routesToPopAfterDelete: RoutesToPopAfterDelete.None,
-                  ),
-                ),
+      child: PageFramework(
+        key: pageState,
+        resizeToAvoidBottomInset: true,
+        floatingActionButton: AnimateFABDelayed(
+          enabled: overdueTransactions == null,
+          fab: AnimateFABDelayed(
+            fab: AddFAB(
+              tooltip: "add-upcoming".tr(),
+              openPage: AddTransactionPage(
+                selectedType: TransactionSpecialType.upcoming,
+                routesToPopAfterDelete: RoutesToPopAfterDelete.None,
               ),
             ),
-            listID: pageId,
-            title: "scheduled".tr(),
-            dragDownToDismiss: true,
-            actions: [
-              CustomPopupMenuButton(
-                showButtons: enableDoubleColumn(context),
-                keepOutFirst: true,
-                items: [
-                  DropdownItemMenu(
-                    id: "settings",
-                    label: "settings".tr(),
-                    icon: appStateSettings["outlinedIcons"]
-                        ? Icons.settings_outlined
-                        : Icons.settings_rounded,
-                    action: () {
-                      openBottomSheet(
-                          context,
-                          PopupFramework(
-                            hasPadding: false,
-                            child: UpcomingOverdueSettings(),
-                          ));
-                    },
-                  ),
-                ],
+          ),
+        ),
+        listID: pageId,
+        title: "scheduled".tr(),
+        dragDownToDismiss: true,
+        actions: [
+          CustomPopupMenuButton(
+            showButtons: enableDoubleColumn(context),
+            keepOutFirst: true,
+            items: [
+              DropdownItemMenu(
+                id: "settings",
+                label: "settings".tr(),
+                icon: appStateSettings["outlinedIcons"]
+                    ? Icons.settings_outlined
+                    : Icons.settings_rounded,
+                action: () {
+                  openBottomSheet(
+                      context,
+                      PopupFramework(
+                        hasPadding: false,
+                        child: UpcomingOverdueSettings(),
+                      ));
+                },
               ),
             ],
-            slivers: [
-              SliverToBoxAdapter(
-                  child: AnimatedSizeSwitcher(
-                child: overdueTransactions == null
-                    ? TotalUpcomingHeaderPeriodSwitcher(
-                        transactionListStream:
-                            database.watchAllOverdueUpcomingTransactions(
-                                overdueTransactions,
-                                searchString: searchValue),
-                        selectedType: selectedType,
-                        setSelectedType: (chosenType) {
-                          setState(() {
-                            selectedType = chosenType;
-                          });
-                        },
-                        selectedSubtitleTranslation: (selectedType) {
-                          return selectedType ==
-                                  SelectedSubscriptionsType.yearly
-                              ? "yearly-upcoming".tr()
-                              : selectedType ==
-                                      SelectedSubscriptionsType.monthly
-                                  ? "monthly-upcoming".tr()
-                                  : "total-upcoming".tr();
+          ),
+        ],
+        slivers: [
+          SliverToBoxAdapter(
+              child: AnimatedSizeSwitcher(
+            child: overdueTransactions == null
+                ? TotalUpcomingHeaderPeriodSwitcher(
+                    transactionListStream:
+                        database.watchAllOverdueUpcomingTransactions(
+                            overdueTransactions,
+                            searchString: searchValue),
+                    selectedType: selectedType,
+                    setSelectedType: (chosenType) {
+                      setState(() {
+                        selectedType = chosenType;
+                      });
+                    },
+                    selectedSubtitleTranslation: (selectedType) {
+                      return selectedType == SelectedSubscriptionsType.yearly
+                          ? "yearly-upcoming".tr()
+                          : selectedType == SelectedSubscriptionsType.monthly
+                              ? "monthly-upcoming".tr()
+                              : "total-upcoming".tr();
+                    },
+                  )
+                : CenteredAmountAndNumTransactions(
+                    totalWithCountStream:
+                        database.watchTotalWithCountOfUpcomingOverdue(
+                      allWallets: Provider.of<AllWallets>(context),
+                      isOverdueTransactions: overdueTransactions,
+                      searchString: searchValue,
+                    ),
+                    textColor: overdueTransactions == null
+                        ? getColor(context, "black")
+                        : overdueTransactions == true
+                            ? getColor(context, "unPaidOverdue")
+                            : getColor(context, "unPaidUpcoming"),
+                  ),
+          )),
+          SliverToBoxAdapter(
+            child: Padding(
+              padding: EdgeInsetsDirectional.symmetric(
+                  horizontal: getHorizontalPaddingConstrained(context)),
+              child: Row(
+                children: [
+                  SizedBox(width: 13),
+                  Flexible(
+                    child: AnimatedSize(
+                      clipBehavior: Clip.none,
+                      duration: Duration(milliseconds: 500),
+                      child: SlidingSelectorIncomeExpense(
+                        useHorizontalPaddingConstrained: false,
+                        initialIndex: overdueTransactions == null
+                            ? 0
+                            : overdueTransactions == false
+                                ? 1
+                                : 2,
+                        onSelected: (int index) {
+                          if (index == 1)
+                            overdueTransactions = null;
+                          else if (index == 2)
+                            overdueTransactions = false;
+                          else if (index == 3) overdueTransactions = true;
+                          setState(() {});
                         },
-                      )
-                    : CenteredAmountAndNumTransactions(
-                        totalWithCountStream:
-                            database.watchTotalWithCountOfUpcomingOverdue(
-                          allWallets: Provider.of<AllWallets>(context),
-                          isOverdueTransactions: overdueTransactions,
-                          searchString: searchValue,
-                        ),
-                        textColor: overdueTransactions == null
-                            ? getColor(context, "black")
-                            : overdueTransactions == true
-                                ? getColor(context, "unPaidOverdue")
-                                : getColor(context, "unPaidUpcoming"),
+                        options: ["all", "upcoming", "overdue"],
+                        customPadding: EdgeInsetsDirectional.zero,
                       ),
-              )),
-              SliverToBoxAdapter(
-                child: Padding(
-                  padding: EdgeInsetsDirectional.symmetric(
-                      horizontal: getHorizontalPaddingConstrained(context)),
-                  child: Row(
-                    children: [
-                      SizedBox(width: 13),
-                      Flexible(
-                        child: AnimatedSize(
-                          clipBehavior: Clip.none,
-                          duration: Duration(milliseconds: 500),
-                          child: SlidingSelectorIncomeExpense(
-                            useHorizontalPaddingConstrained: false,
-                            initialIndex: overdueTransactions == null
-                                ? 0
-                                : overdueTransactions == false
-                                    ? 1
-                                    : 2,
-                            onSelected: (int index) {
-                              if (index == 1)
-                                overdueTransactions = null;
-                              else if (index == 2)
-                                overdueTransactions = false;
-                              else if (index == 3) overdueTransactions = true;
-                              setState(() {});
-                            },
-                            options: ["all", "upcoming", "overdue"],
-                            customPadding: EdgeInsetsDirectional.zero,
+                    ),
+                  ),
+                  AnimatedSizeSwitcher(
+                    child: searchValue == null
+                        ? Padding(
+                            padding:
+                                const EdgeInsetsDirectional.only(start: 7.0),
+                            child: ButtonIcon(
+                              key: ValueKey(1),
+                              onTap: () {
+                                setState(() {
+                                  searchValue = "";
+                                });
+                                _searchFocusNode.requestFocus();
+                              },
+                              icon: appStateSettings["outlinedIcons"]
+                                  ? Icons.search_outlined
+                                  : Icons.search_rounded,
+                            ),
+                          )
+                        : Container(
+                            key: ValueKey(2),
                           ),
-                        ),
-                      ),
-                      AnimatedSizeSwitcher(
-                        child: searchValue == null
-                            ? Padding(
-                                padding: const EdgeInsetsDirectional.only(
-                                    start: 7.0),
-                                child: ButtonIcon(
-                                  key: ValueKey(1),
-                                  onTap: () {
-                                    setState(() {
-                                      searchValue = "";
-                                    });
-                                    _searchFocusNode.requestFocus();
-                                  },
-                                  icon: appStateSettings["outlinedIcons"]
-                                      ? Icons.search_outlined
-                                      : Icons.search_rounded,
-                                ),
-                              )
-                            : Container(
-                                key: ValueKey(2),
-                              ),
-                      ),
-                      SizedBox(width: 13),
-                    ],
                   ),
-                ),
+                  SizedBox(width: 13),
+                ],
               ),
-              SliverToBoxAdapter(
+            ),
+          ),
+          SliverToBoxAdapter(
+            child: Padding(
+              padding: EdgeInsetsDirectional.symmetric(
+                  horizontal: getHorizontalPaddingConstrained(context)),
+              child: AnimatedExpanded(
+                expand: searchValue != null,
                 child: Padding(
-                  padding: EdgeInsetsDirectional.symmetric(
-                      horizontal: getHorizontalPaddingConstrained(context)),
-                  child: AnimatedExpanded(
-                    expand: searchValue != null,
-                    child: Padding(
-                      padding:
-                          const EdgeInsetsDirectional.only(bottom: 4.0, top: 8),
-                      child: TextInput(
-                        labelText: "search-transactions-placeholder".tr(),
-                        icon: appStateSettings["outlinedIcons"]
-                            ? Icons.search_outlined
-                            : Icons.search_rounded,
-                        focusNode: _searchFocusNode,
-                        onSubmitted: (value) {
-                          setState(() {
-                            searchValue = value == "" ? null : value;
-                          });
-                        },
-                        onChanged: (value) {
-                          setState(() {
-                            searchValue = value == "" ? null : value;
-                          });
-                        },
-                        autoFocus: false,
-                      ),
-                    ),
+                  padding:
+                      const EdgeInsetsDirectional.only(bottom: 4.0, top: 8),
+                  child: TextInput(
+                    labelText: "search-transactions-placeholder".tr(),
+                    icon: appStateSettings["outlinedIcons"]
+                        ? Icons.search_outlined
+                        : Icons.search_rounded,
+                    focusNode: _searchFocusNode,
+                    onSubmitted: (value) {
+                      setState(() {
+                        searchValue = value == "" ? null : value;
+                      });
+                    },
+                    onChanged: (value) {
+                      setState(() {
+                        searchValue = value == "" ? null : value;
+                      });
+                    },
+                    autoFocus: false,
                   ),
                 ),
               ),
-              SliverToBoxAdapter(
-                child: SizedBox(height: 15),
-              ),
-              StreamBuilder<List<Transaction>>(
-                stream: database.watchAllOverdueUpcomingTransactions(
-                    overdueTransactions,
-                    searchString: searchValue),
-                builder: (context, snapshot) {
-                  if (snapshot.hasData) {
-                    if (snapshot.data!.length <= 0) {
-                      return SliverToBoxAdapter(
-                        child: Center(
-                          child:
-                              NoResults(message: "no-transactions-found".tr()),
-                        ),
-                      );
-                    }
-                    return SliverImplicitlyAnimatedList<Transaction>(
-                      items: snapshot.data!,
-                      areItemsTheSame: (a, b) =>
-                          a.transactionPk == b.transactionPk,
-                      insertDuration: Duration(milliseconds: 500),
-                      removeDuration: Duration(milliseconds: 500),
-                      updateDuration: Duration(milliseconds: 500),
-                      itemBuilder: (BuildContext context,
-                          Animation<double> animation,
-                          Transaction item,
-                          int index) {
-                        return SizeFadeTransition(
-                          sizeFraction: 0.7,
-                          curve: Curves.easeInOut,
-                          animation: animation,
-                          child: Column(
-                            key: ValueKey(item.transactionPk),
-                            crossAxisAlignment: CrossAxisAlignment.start,
-                            children: [
-                              HorizontalBreak(
-                                  padding: EdgeInsetsDirectional.only(
-                                      top: 4, bottom: 6)),
-                              TransactionEntry(
-                                aboveWidget: UpcomingTransactionDateHeader(
-                                  selectedType: selectedType,
-                                  transaction: item,
-                                ),
-                                openPage: AddTransactionPage(
-                                  transaction: item,
-                                  routesToPopAfterDelete:
-                                      RoutesToPopAfterDelete.One,
-                                ),
-                                transaction: item,
-                                listID: pageId,
-                              ),
-                            ],
+            ),
+          ),
+          SliverToBoxAdapter(
+            child: SizedBox(height: 15),
+          ),
+          StreamBuilder<List<Transaction>>(
+            stream: database.watchAllOverdueUpcomingTransactions(
+                overdueTransactions,
+                searchString: searchValue),
+            builder: (context, snapshot) {
+              if (snapshot.hasData) {
+                if (snapshot.data!.length <= 0) {
+                  return SliverToBoxAdapter(
+                    child: Center(
+                      child: NoResults(message: "no-transactions-found".tr()),
+                    ),
+                  );
+                }
+                return SliverImplicitlyAnimatedList<Transaction>(
+                  items: snapshot.data!,
+                  areItemsTheSame: (a, b) => a.transactionPk == b.transactionPk,
+                  insertDuration: Duration(milliseconds: 500),
+                  removeDuration: Duration(milliseconds: 500),
+                  updateDuration: Duration(milliseconds: 500),
+                  itemBuilder: (BuildContext context,
+                      Animation<double> animation,
+                      Transaction item,
+                      int index) {
+                    return SizeFadeTransition(
+                      sizeFraction: 0.7,
+                      curve: Curves.easeInOut,
+                      animation: animation,
+                      child: Column(
+                        key: ValueKey(item.transactionPk),
+                        crossAxisAlignment: CrossAxisAlignment.start,
+                        children: [
+                          HorizontalBreak(
+                              padding: EdgeInsetsDirectional.only(
+                                  top: 4, bottom: 6)),
+                          TransactionEntry(
+                            aboveWidget: UpcomingTransactionDateHeader(
+                              selectedType: selectedType,
+                              transaction: item,
+                            ),
+                            openPage: AddTransactionPage(
+                              transaction: item,
+                              routesToPopAfterDelete:
+                                  RoutesToPopAfterDelete.One,
+                            ),
+                            transaction: item,
+                            listID: pageId,
                           ),
-                        );
-                      },
+                        ],
+                      ),
                     );
-                  } else {
-                    return SliverToBoxAdapter();
-                  }
-                },
-              ),
-              SliverToBoxAdapter(
-                child: SizedBox(height: 75),
-              ),
-            ],
+                  },
+                );
+              } else {
+                return SliverToBoxAdapter();
+              }
+            },
           ),
-          SelectedTransactionsAppBar(
-            pageID: pageId,
+          SliverToBoxAdapter(
+            child: SizedBox(height: 75),
           ),
         ],
+        selectedTransactionsAppBar: SelectedTransactionsAppBar(
+          pageID: pageId,
+        ),
       ),
     );
   }
diff --git a/budget/lib/pages/walletDetailsPage.dart b/budget/lib/pages/walletDetailsPage.dart
index c792b77f9..b38018c51 100644
--- a/budget/lib/pages/walletDetailsPage.dart
+++ b/budget/lib/pages/walletDetailsPage.dart
@@ -1247,434 +1247,417 @@ class WalletDetailsPageState extends State<WalletDetailsPage>
           return true;
         }
       },
-      child: Stack(
-        children: [
-          PageFramework(
-            appBarBackgroundColor:
-                enableDoubleColumn(context) == true && widget.wallet == null
-                    ? Theme.of(context).colorScheme.secondaryContainer
-                    : null,
-            appBarBackgroundColorStart:
-                enableDoubleColumn(context) == true && widget.wallet == null
-                    ? Theme.of(context).colorScheme.secondaryContainer
-                    : null,
-            backgroundColor: Theme.of(context).canvasColor,
-            scrollController: _scrollController,
-            key: pageState,
-            listID: listID,
-            floatingActionButton: AnimateFABDelayed(
-              fab: AddFAB(
-                tooltip: "add-transaction".tr(),
-                openPage: AddTransactionPage(
-                  routesToPopAfterDelete: RoutesToPopAfterDelete.One,
-                ),
-              ),
+      child: PageFramework(
+        appBarBackgroundColor:
+            enableDoubleColumn(context) == true && widget.wallet == null
+                ? Theme.of(context).colorScheme.secondaryContainer
+                : null,
+        appBarBackgroundColorStart:
+            enableDoubleColumn(context) == true && widget.wallet == null
+                ? Theme.of(context).colorScheme.secondaryContainer
+                : null,
+        backgroundColor: Theme.of(context).canvasColor,
+        scrollController: _scrollController,
+        key: pageState,
+        listID: listID,
+        floatingActionButton: AnimateFABDelayed(
+          fab: AddFAB(
+            tooltip: "add-transaction".tr(),
+            openPage: AddTransactionPage(
+              routesToPopAfterDelete: RoutesToPopAfterDelete.One,
             ),
-            title: widget.wallet == null
-                ? "all-spending".tr()
-                : widget.wallet!.name,
-            actions: [
-              if (widget.wallet != null)
-                CustomPopupMenuButton(
-                  showButtons: enableDoubleColumn(context),
-                  keepOutFirst: true,
-                  items: [
-                    DropdownItemMenu(
-                      id: "edit-account",
-                      label: "edit-account".tr(),
-                      icon: appStateSettings["outlinedIcons"]
-                          ? Icons.edit_outlined
-                          : Icons.edit_rounded,
-                      action: () {
-                        pushRoute(
-                          context,
-                          AddWalletPage(
-                            wallet: widget.wallet,
-                            routesToPopAfterDelete: RoutesToPopAfterDelete.All,
-                          ),
-                        );
-                      },
-                    ),
-                    DropdownItemMenu(
-                      id: "correct-total-balance",
-                      label: "correct-total-balance".tr(),
-                      icon: appStateSettings["outlinedIcons"]
-                          ? Icons.library_add_outlined
-                          : Icons.library_add_rounded,
-                      action: () {
-                        openBottomSheet(
-                          context,
-                          fullSnap: true,
-                          CorrectBalancePopup(wallet: widget.wallet!),
-                        );
-                      },
-                    ),
-                    DropdownItemMenu(
-                      id: "transfer-balance",
-                      label: "transfer-balance".tr(),
-                      icon: appStateSettings["outlinedIcons"]
-                          ? Icons.compare_arrows_outlined
-                          : Icons.compare_arrows_rounded,
-                      action: () {
-                        openBottomSheet(
-                          context,
-                          fullSnap: true,
-                          TransferBalancePopup(
-                              wallet: widget.wallet!, allowEditWallet: false),
-                        );
-                      },
-                    ),
-                  ],
-                ),
-              if (widget.wallet == null)
-                AppBarIconAppear(
-                  scrollController: _scrollController,
-                  child: CustomPopupMenuButton(
-                    showButtons: true,
-                    keepOutFirst: true,
-                    items: [
-                      // DropdownItemMenu(
-                      //   id: "select-period",
-                      //   label: "select-period-tooltip".tr(),
-                      //   icon: appStateSettings["outlinedIcons"]
-                      //       ? Icons.timelapse_outlined
-                      //       : Icons.timelapse_rounded,
-                      //   action: () async {
-                      //     selectAllSpendingPeriod();
-                      //   },
-                      // ),
-                      DropdownItemMenu(
-                        id: "filters",
-                        label: "filters".tr(),
-                        icon: appStateSettings["outlinedIcons"]
-                            ? Icons.filter_alt_outlined
-                            : Icons.filter_alt_rounded,
-                        action: () async {
-                          selectAllSpendingFilters();
-                        },
-                        selected:
-                            searchFilters?.isClear(ignoreDateTimeRange: true) ==
-                                false,
+          ),
+        ),
+        title:
+            widget.wallet == null ? "all-spending".tr() : widget.wallet!.name,
+        actions: [
+          if (widget.wallet != null)
+            CustomPopupMenuButton(
+              showButtons: enableDoubleColumn(context),
+              keepOutFirst: true,
+              items: [
+                DropdownItemMenu(
+                  id: "edit-account",
+                  label: "edit-account".tr(),
+                  icon: appStateSettings["outlinedIcons"]
+                      ? Icons.edit_outlined
+                      : Icons.edit_rounded,
+                  action: () {
+                    pushRoute(
+                      context,
+                      AddWalletPage(
+                        wallet: widget.wallet,
+                        routesToPopAfterDelete: RoutesToPopAfterDelete.All,
                       ),
-                    ],
-                  ),
+                    );
+                  },
                 ),
-            ],
-            dragDownToDismiss: true,
-            bodyBuilder: (scrollController, scrollPhysics, sliverAppBar) {
-              if (widget.wallet == null && enableDoubleColumn(context)) {
-                double heightOfBanner = 56;
-                double topPaddingOfBanner =
-                    MediaQuery.viewPaddingOf(context).top;
-                double totalHeaderHeight = heightOfBanner + topPaddingOfBanner;
-                return Column(
+                DropdownItemMenu(
+                  id: "correct-total-balance",
+                  label: "correct-total-balance".tr(),
+                  icon: appStateSettings["outlinedIcons"]
+                      ? Icons.library_add_outlined
+                      : Icons.library_add_rounded,
+                  action: () {
+                    openBottomSheet(
+                      context,
+                      fullSnap: true,
+                      CorrectBalancePopup(wallet: widget.wallet!),
+                    );
+                  },
+                ),
+                DropdownItemMenu(
+                  id: "transfer-balance",
+                  label: "transfer-balance".tr(),
+                  icon: appStateSettings["outlinedIcons"]
+                      ? Icons.compare_arrows_outlined
+                      : Icons.compare_arrows_rounded,
+                  action: () {
+                    openBottomSheet(
+                      context,
+                      fullSnap: true,
+                      TransferBalancePopup(
+                          wallet: widget.wallet!, allowEditWallet: false),
+                    );
+                  },
+                ),
+              ],
+            ),
+          if (widget.wallet == null)
+            AppBarIconAppear(
+              scrollController: _scrollController,
+              child: CustomPopupMenuButton(
+                showButtons: true,
+                keepOutFirst: true,
+                items: [
+                  // DropdownItemMenu(
+                  //   id: "select-period",
+                  //   label: "select-period-tooltip".tr(),
+                  //   icon: appStateSettings["outlinedIcons"]
+                  //       ? Icons.timelapse_outlined
+                  //       : Icons.timelapse_rounded,
+                  //   action: () async {
+                  //     selectAllSpendingPeriod();
+                  //   },
+                  // ),
+                  DropdownItemMenu(
+                    id: "filters",
+                    label: "filters".tr(),
+                    icon: appStateSettings["outlinedIcons"]
+                        ? Icons.filter_alt_outlined
+                        : Icons.filter_alt_rounded,
+                    action: () async {
+                      selectAllSpendingFilters();
+                    },
+                    selected:
+                        searchFilters?.isClear(ignoreDateTimeRange: true) ==
+                            false,
+                  ),
+                ],
+              ),
+            ),
+        ],
+        dragDownToDismiss: true,
+        bodyBuilder: (scrollController, scrollPhysics, sliverAppBar) {
+          if (widget.wallet == null && enableDoubleColumn(context)) {
+            double heightOfBanner = 56;
+            double topPaddingOfBanner = MediaQuery.viewPaddingOf(context).top;
+            double totalHeaderHeight = heightOfBanner + topPaddingOfBanner;
+            return Column(
+              children: [
+                Stack(
+                  alignment: AlignmentDirectional.centerEnd,
                   children: [
-                    Stack(
-                      alignment: AlignmentDirectional.centerEnd,
+                    Row(
+                      crossAxisAlignment: CrossAxisAlignment.center,
                       children: [
-                        Row(
-                          crossAxisAlignment: CrossAxisAlignment.center,
-                          children: [
-                            Expanded(
-                              child: Container(
-                                height: totalHeaderHeight,
-                                padding: EdgeInsetsDirectional.only(
-                                    top: topPaddingOfBanner),
-                                color: Theme.of(context)
+                        Expanded(
+                          child: Container(
+                            height: totalHeaderHeight,
+                            padding: EdgeInsetsDirectional.only(
+                                top: topPaddingOfBanner),
+                            color: Theme.of(context)
+                                .colorScheme
+                                .secondaryContainer,
+                            child: Center(
+                              child: TextFont(
+                                text: "all-spending".tr(),
+                                textColor: Theme.of(context)
                                     .colorScheme
-                                    .secondaryContainer,
-                                child: Center(
-                                  child: TextFont(
-                                    text: "all-spending".tr(),
-                                    textColor: Theme.of(context)
-                                        .colorScheme
-                                        .onSecondaryContainer,
-                                    fontSize: 25,
-                                    fontWeight: FontWeight.bold,
-                                    textAlign: TextAlign.center,
-                                  ),
-                                ),
+                                    .onSecondaryContainer,
+                                fontSize: 25,
+                                fontWeight: FontWeight.bold,
+                                textAlign: TextAlign.center,
                               ),
                             ),
-                          ],
-                        ),
-                        PositionedDirectional(
-                          top: topPaddingOfBanner + 5,
-                          end: 55,
-                          child: historySettingsButtonAlwaysShow,
-                        ),
-                        PositionedDirectional(
-                          top: topPaddingOfBanner + 5,
-                          end: 10,
-                          child: selectFiltersButton,
+                          ),
                         ),
                       ],
                     ),
-                    ConstrainedBox(
-                      constraints: BoxConstraints(maxWidth: 1800),
-                      child: Row(
-                        children: [
-                          Expanded(
-                            child: Container(
-                              height: MediaQuery.sizeOf(context).height -
-                                  totalHeaderHeight,
-                              child: Row(
-                                mainAxisSize: MainAxisSize.min,
-                                mainAxisAlignment:
-                                    MainAxisAlignment.spaceEvenly,
-                                children: [
-                                  Flexible(
-                                    child: ConstrainedBox(
-                                      constraints:
-                                          BoxConstraints(maxWidth: 700),
-                                      child: SwipeToSelectTransactions(
-                                        listID: listID,
-                                        child: ScrollbarWrap(
-                                          child: CustomScrollView(
-                                            controller: _scrollController,
-                                            slivers: [
-                                              SliverToBoxAdapter(
-                                                  child: SizedBox(height: 20)),
-                                              SliverToBoxAdapter(
-                                                child: Padding(
-                                                  padding:
-                                                      const EdgeInsetsDirectional
-                                                          .symmetric(
-                                                          horizontal: 13),
-                                                  child: Stack(
-                                                    alignment:
-                                                        AlignmentDirectional
-                                                            .center,
-                                                    children: [
-                                                      selectedTabCurrent,
-                                                      selectedTabPeriodSelected(
-                                                        () {
-                                                          selectAllSpendingPeriod(
-                                                              onlyShowCycleOption:
-                                                                  false);
-                                                        },
-                                                      ),
-                                                      PositionedDirectional(
-                                                        end: 0,
-                                                        child:
-                                                            clearSelectedPeriodButton,
-                                                      )
-                                                    ],
+                    PositionedDirectional(
+                      top: topPaddingOfBanner + 5,
+                      end: 55,
+                      child: historySettingsButtonAlwaysShow,
+                    ),
+                    PositionedDirectional(
+                      top: topPaddingOfBanner + 5,
+                      end: 10,
+                      child: selectFiltersButton,
+                    ),
+                  ],
+                ),
+                ConstrainedBox(
+                  constraints: BoxConstraints(maxWidth: 1800),
+                  child: Row(
+                    children: [
+                      Expanded(
+                        child: Container(
+                          height: MediaQuery.sizeOf(context).height -
+                              totalHeaderHeight,
+                          child: Row(
+                            mainAxisSize: MainAxisSize.min,
+                            mainAxisAlignment: MainAxisAlignment.spaceEvenly,
+                            children: [
+                              Flexible(
+                                child: ConstrainedBox(
+                                  constraints: BoxConstraints(maxWidth: 700),
+                                  child: SwipeToSelectTransactions(
+                                    listID: listID,
+                                    child: ScrollbarWrap(
+                                      child: CustomScrollView(
+                                        controller: _scrollController,
+                                        slivers: [
+                                          SliverToBoxAdapter(
+                                              child: SizedBox(height: 20)),
+                                          SliverToBoxAdapter(
+                                            child: Padding(
+                                              padding:
+                                                  const EdgeInsetsDirectional
+                                                      .symmetric(
+                                                      horizontal: 13),
+                                              child: Stack(
+                                                alignment:
+                                                    AlignmentDirectional.center,
+                                                children: [
+                                                  selectedTabCurrent,
+                                                  selectedTabPeriodSelected(
+                                                    () {
+                                                      selectAllSpendingPeriod(
+                                                          onlyShowCycleOption:
+                                                              false);
+                                                    },
                                                   ),
-                                                ),
-                                              ),
-                                              SliverToBoxAdapter(
-                                                child: appliedFilterChipsWidget,
+                                                  PositionedDirectional(
+                                                    end: 0,
+                                                    child:
+                                                        clearSelectedPeriodButton,
+                                                  )
+                                                ],
                                               ),
-                                              ...currentTabPage,
-                                            ],
+                                            ),
                                           ),
-                                        ),
+                                          SliverToBoxAdapter(
+                                            child: appliedFilterChipsWidget,
+                                          ),
+                                          ...currentTabPage,
+                                        ],
                                       ),
                                     ),
                                   ),
-                                  Flexible(
-                                    child: ConstrainedBox(
-                                      constraints:
-                                          BoxConstraints(maxWidth: 700),
-                                      child: SwipeToSelectTransactions(
-                                        listID: listID,
-                                        child: ScrollbarWrap(
-                                          child: CustomScrollView(
-                                            slivers: [
-                                              SliverToBoxAdapter(
-                                                  child: SizedBox(height: 20)),
-                                              SliverToBoxAdapter(
-                                                child: Padding(
-                                                  padding:
-                                                      const EdgeInsetsDirectional
-                                                          .symmetric(
-                                                          horizontal: 13),
-                                                  child: selectedTabHistory,
-                                                ),
-                                              ),
-                                              ...historyTabPage,
-                                            ],
+                                ),
+                              ),
+                              Flexible(
+                                child: ConstrainedBox(
+                                  constraints: BoxConstraints(maxWidth: 700),
+                                  child: SwipeToSelectTransactions(
+                                    listID: listID,
+                                    child: ScrollbarWrap(
+                                      child: CustomScrollView(
+                                        slivers: [
+                                          SliverToBoxAdapter(
+                                              child: SizedBox(height: 20)),
+                                          SliverToBoxAdapter(
+                                            child: Padding(
+                                              padding:
+                                                  const EdgeInsetsDirectional
+                                                      .symmetric(
+                                                      horizontal: 13),
+                                              child: selectedTabHistory,
+                                            ),
                                           ),
-                                        ),
+                                          ...historyTabPage,
+                                        ],
                                       ),
                                     ),
                                   ),
-                                ],
+                                ),
                               ),
-                            ),
+                            ],
                           ),
+                        ),
+                      ),
+                    ],
+                  ),
+                ),
+              ],
+            );
+          }
+          return Stack(
+            children: [
+              NestedScrollView(
+                controller: _scrollController,
+                headerSliverBuilder:
+                    (BuildContext contextHeader, bool innerBoxIsScrolled) {
+                  return <Widget>[
+                    SliverOverlapAbsorber(
+                      handle: NestedScrollView.sliverOverlapAbsorberHandleFor(
+                          contextHeader),
+                      sliver: MultiSliver(
+                        children: [
+                          sliverAppBar,
+                          if (widget.wallet != null)
+                            SliverToBoxAdapter(
+                              child: Padding(
+                                padding: EdgeInsetsDirectional.symmetric(
+                                  horizontal:
+                                      getHorizontalPaddingConstrained(context),
+                                ),
+                                child: Padding(
+                                  padding:
+                                      const EdgeInsetsDirectional.only(top: 8),
+                                  child: totalNetContainer,
+                                ),
+                              ),
+                            ),
+                          if (widget.wallet == null)
+                            SliverToBoxAdapter(
+                                child: tabDateFilterSelectorHeader),
+                          if (searchFilters != null && widget.wallet == null)
+                            SliverToBoxAdapter(child: appliedFilterChipsWidget),
                         ],
                       ),
                     ),
-                  ],
-                );
-              }
-              return Stack(
-                children: [
-                  NestedScrollView(
-                    controller: _scrollController,
-                    headerSliverBuilder:
-                        (BuildContext contextHeader, bool innerBoxIsScrolled) {
-                      return <Widget>[
-                        SliverOverlapAbsorber(
-                          handle:
-                              NestedScrollView.sliverOverlapAbsorberHandleFor(
-                                  contextHeader),
-                          sliver: MultiSliver(
-                            children: [
-                              sliverAppBar,
-                              if (widget.wallet != null)
-                                SliverToBoxAdapter(
-                                  child: Padding(
-                                    padding: EdgeInsetsDirectional.symmetric(
-                                      horizontal:
-                                          getHorizontalPaddingConstrained(
-                                              context),
-                                    ),
-                                    child: Padding(
-                                      padding: const EdgeInsetsDirectional.only(
-                                          top: 8),
-                                      child: totalNetContainer,
-                                    ),
-                                  ),
+                  ];
+                },
+                body: Builder(
+                  builder: (contextPageView) {
+                    return TabBarView(
+                      controller: _tabController,
+                      children: [
+                        SwipeToSelectTransactions(
+                          listID: listID,
+                          child: ScrollbarWrap(
+                            child: CustomScrollView(
+                              slivers: [
+                                SliverPinnedOverlapInjector(
+                                  handle: NestedScrollView
+                                      .sliverOverlapAbsorberHandleFor(
+                                          contextPageView),
                                 ),
-                              if (widget.wallet == null)
-                                SliverToBoxAdapter(
-                                    child: tabDateFilterSelectorHeader),
-                              if (searchFilters != null &&
-                                  widget.wallet == null)
-                                SliverToBoxAdapter(
-                                    child: appliedFilterChipsWidget),
-                            ],
+                                ...currentTabPage,
+                              ],
+                            ),
                           ),
                         ),
-                      ];
-                    },
-                    body: Builder(
-                      builder: (contextPageView) {
-                        return TabBarView(
-                          controller: _tabController,
-                          children: [
-                            SwipeToSelectTransactions(
-                              listID: listID,
-                              child: ScrollbarWrap(
-                                child: CustomScrollView(
-                                  slivers: [
-                                    SliverPinnedOverlapInjector(
-                                      handle: NestedScrollView
-                                          .sliverOverlapAbsorberHandleFor(
-                                              contextPageView),
-                                    ),
-                                    ...currentTabPage,
-                                  ],
-                                ),
+                        if (widget.wallet == null)
+                          SwipeToSelectTransactions(
+                            listID: listID,
+                            child: ScrollbarWrap(
+                              child: CustomScrollView(
+                                slivers: [
+                                  SliverPinnedOverlapInjector(
+                                    handle: NestedScrollView
+                                        .sliverOverlapAbsorberHandleFor(
+                                            contextPageView),
+                                  ),
+                                  ...historyTabPage,
+                                ],
                               ),
                             ),
-                            if (widget.wallet == null)
-                              SwipeToSelectTransactions(
-                                listID: listID,
-                                child: ScrollbarWrap(
-                                  child: CustomScrollView(
-                                    slivers: [
-                                      SliverPinnedOverlapInjector(
-                                        handle: NestedScrollView
-                                            .sliverOverlapAbsorberHandleFor(
-                                                contextPageView),
-                                      ),
-                                      ...historyTabPage,
-                                    ],
-                                  ),
-                                ),
+                          ),
+                      ],
+                    );
+                  },
+                ),
+              ),
+              // Selected period dropdown switcher
+              AnimatedBuilder(
+                animation: _tabController.animation!,
+                builder: (BuildContext context, Widget? child) {
+                  double animationProgress = _tabController.animation!.value;
+                  return SelectedPeriodAppBar(
+                    scrollController: _scrollController,
+                    forceHide: selectedDateTimeRange == null,
+                    animationProgress: animationProgress,
+                    selectPeriodContent: Padding(
+                      padding:
+                          const EdgeInsetsDirectional.only(bottom: 3, top: 3),
+                      child: Row(
+                        mainAxisAlignment: MainAxisAlignment.center,
+                        children: [
+                          Padding(
+                            padding: const EdgeInsetsDirectional.symmetric(
+                                horizontal: 10),
+                            child: IconButtonScaled(
+                              iconData: appStateSettings["outlinedIcons"]
+                                  ? Icons.chevron_left_outlined
+                                  : Icons.chevron_left_rounded,
+                              iconSize: 18,
+                              scale: 1,
+                              onTap: () {
+                                changeSelectedDateRange(-1);
+                              },
+                            ),
+                          ),
+                          Flexible(
+                            child: AnimatedSizeSwitcher(
+                              child: TextFont(
+                                key: ValueKey(timeRangeString),
+                                text: timeRangeString,
+                                fontWeight: FontWeight.bold,
+                                fontSize: 18,
+                                textAlign: TextAlign.center,
+                                textColor: Theme.of(context)
+                                    .colorScheme
+                                    .onSecondaryContainer,
+                                maxLines: 2,
                               ),
-                          ],
-                        );
-                      },
-                    ),
-                  ),
-                  // Selected period dropdown switcher
-                  AnimatedBuilder(
-                    animation: _tabController.animation!,
-                    builder: (BuildContext context, Widget? child) {
-                      double animationProgress =
-                          _tabController.animation!.value;
-                      return SelectedPeriodAppBar(
-                        scrollController: _scrollController,
-                        forceHide: selectedDateTimeRange == null,
-                        animationProgress: animationProgress,
-                        selectPeriodContent: Padding(
-                          padding: const EdgeInsetsDirectional.only(
-                              bottom: 3, top: 3),
-                          child: Row(
-                            mainAxisAlignment: MainAxisAlignment.center,
-                            children: [
-                              Padding(
+                            ),
+                          ),
+                          IgnorePointer(
+                            ignoring: selectedDateTimeRangeIndex == 0,
+                            child: AnimatedOpacity(
+                              duration: Duration(milliseconds: 200),
+                              opacity:
+                                  selectedDateTimeRangeIndex == 0 ? 0.5 : 1,
+                              child: Padding(
                                 padding: const EdgeInsetsDirectional.symmetric(
                                     horizontal: 10),
                                 child: IconButtonScaled(
                                   iconData: appStateSettings["outlinedIcons"]
-                                      ? Icons.chevron_left_outlined
-                                      : Icons.chevron_left_rounded,
+                                      ? Icons.chevron_right_outlined
+                                      : Icons.chevron_right_rounded,
                                   iconSize: 18,
                                   scale: 1,
                                   onTap: () {
-                                    changeSelectedDateRange(-1);
+                                    changeSelectedDateRange(1);
                                   },
                                 ),
                               ),
-                              Flexible(
-                                child: AnimatedSizeSwitcher(
-                                  child: TextFont(
-                                    key: ValueKey(timeRangeString),
-                                    text: timeRangeString,
-                                    fontWeight: FontWeight.bold,
-                                    fontSize: 18,
-                                    textAlign: TextAlign.center,
-                                    textColor: Theme.of(context)
-                                        .colorScheme
-                                        .onSecondaryContainer,
-                                    maxLines: 2,
-                                  ),
-                                ),
-                              ),
-                              IgnorePointer(
-                                ignoring: selectedDateTimeRangeIndex == 0,
-                                child: AnimatedOpacity(
-                                  duration: Duration(milliseconds: 200),
-                                  opacity:
-                                      selectedDateTimeRangeIndex == 0 ? 0.5 : 1,
-                                  child: Padding(
-                                    padding:
-                                        const EdgeInsetsDirectional.symmetric(
-                                            horizontal: 10),
-                                    child: IconButtonScaled(
-                                      iconData:
-                                          appStateSettings["outlinedIcons"]
-                                              ? Icons.chevron_right_outlined
-                                              : Icons.chevron_right_rounded,
-                                      iconSize: 18,
-                                      scale: 1,
-                                      onTap: () {
-                                        changeSelectedDateRange(1);
-                                      },
-                                    ),
-                                  ),
-                                ),
-                              ),
-                            ],
+                            ),
                           ),
-                        ),
-                      );
-                    },
-                  ),
-                ],
-              );
-            },
-          ),
-          SelectedTransactionsAppBar(
-            pageID: listID,
-          ),
-        ],
+                        ],
+                      ),
+                    ),
+                  );
+                },
+              ),
+            ],
+          );
+        },
+        selectedTransactionsAppBar: SelectedTransactionsAppBar(
+          pageID: listID,
+        ),
       ),
     );
   }
diff --git a/budget/lib/widgets/framework/pageFramework.dart b/budget/lib/widgets/framework/pageFramework.dart
index 826f1281b..5a69c1262 100644
--- a/budget/lib/widgets/framework/pageFramework.dart
+++ b/budget/lib/widgets/framework/pageFramework.dart
@@ -68,6 +68,7 @@ class PageFramework extends StatefulWidget {
     this.customScrollViewBuilder,
     this.bodyBuilder,
     this.scrollController,
+    this.selectedTransactionsAppBar,
   }) : super(key: key);
 
   final String title;
@@ -113,6 +114,7 @@ class PageFramework extends StatefulWidget {
   final Widget Function(ScrollController scrollController,
       ScrollPhysics? scrollPhysics, Widget sliverAppBar)? bodyBuilder;
   final ScrollController? scrollController;
+  final Widget? selectedTransactionsAppBar;
 
   @override
   State<PageFramework> createState() => PageFrameworkState();
@@ -218,7 +220,7 @@ class PageFrameworkState extends State<PageFramework>
   //   measurement = MediaQuery.of(context).viewInsets.bottom;
   // }
 
-  _scrollListener() {
+  void _scrollListener() {
     if (widget.onScroll != null) {
       widget.onScroll!(_scrollController.offset);
     }
@@ -449,7 +451,7 @@ class PageFrameworkState extends State<PageFramework>
                           ],
                         ),
                 ),
-                widget.overlay ?? SizedBox.shrink(),
+                if (widget.overlay != null) widget.overlay ?? SizedBox.shrink(),
               ],
             ),
     );
@@ -462,34 +464,30 @@ class PageFrameworkState extends State<PageFramework>
         behavior: HitTestBehavior.opaque,
         child: Stack(
           children: [
-            Stack(
-              children: [
-                if (widget.transparentAppBar != true)
-                  ...getAppBarBackgroundColorLayers(
-                    animationControllerOpacity: _animationControllerOpacity,
-                    percent: null,
-                    appBarBackgroundColor: widget.appBarBackgroundColor,
-                    appBarBackgroundColorStart:
-                        widget.appBarBackgroundColorStart,
-                    centeredTitle: centeredTitle,
-                    centeredTitleSmall: centeredTitleSmall,
-                    context: context,
-                  ),
-                AnimatedBuilder(
-                  animation: _animationControllerDragY,
-                  builder: (_, child) {
-                    return Transform.translate(
-                      offset: Offset(
-                          0,
-                          _animationControllerDragY.value *
-                              ((1 + 1 - _animationControllerDragY.value) * 50)),
-                      child: scaffold,
-                    );
-                  },
-                ),
-                widget.staticOverlay ?? SizedBox.shrink(),
-              ],
+            if (widget.transparentAppBar != true)
+              ...getAppBarBackgroundColorLayers(
+                animationControllerOpacity: _animationControllerOpacity,
+                percent: null,
+                appBarBackgroundColor: widget.appBarBackgroundColor,
+                appBarBackgroundColorStart: widget.appBarBackgroundColorStart,
+                centeredTitle: centeredTitle,
+                centeredTitleSmall: centeredTitleSmall,
+                context: context,
+              ),
+            AnimatedBuilder(
+              animation: _animationControllerDragY,
+              builder: (_, child) {
+                return Transform.translate(
+                  offset: Offset(
+                      0,
+                      _animationControllerDragY.value *
+                          ((1 + 1 - _animationControllerDragY.value) * 50)),
+                  child: scaffold,
+                );
+              },
             ),
+            if (widget.staticOverlay != null)
+              widget.staticOverlay ?? SizedBox.shrink(),
           ],
         ),
       );
@@ -694,6 +692,14 @@ class PageFrameworkState extends State<PageFramework>
       child: child,
     );
 
+    if (widget.selectedTransactionsAppBar != null)
+      child = Stack(
+        children: [
+          child,
+          widget.selectedTransactionsAppBar ?? SizedBox.shrink(),
+        ],
+      );
+
     Widget childListener = ValueListenableBuilder(
       valueListenable: callRefreshToPages,
       builder: (context, callRefreshToPagesValue, _) {
@@ -704,7 +710,7 @@ class PageFrameworkState extends State<PageFramework>
       },
     );
 
-    if (widget.backButton == false) {
+    if (backButtonEnabled == false) {
       return PullDownToRefreshSync(
         child: childListener,
         scrollController: _scrollController,
diff --git a/budget/lib/widgets/pullDownToRefreshSync.dart b/budget/lib/widgets/pullDownToRefreshSync.dart
index 7336c555f..0f1eaf86e 100644
--- a/budget/lib/widgets/pullDownToRefreshSync.dart
+++ b/budget/lib/widgets/pullDownToRefreshSync.dart
@@ -3,7 +3,7 @@ import 'package:budget/functions.dart';
 import 'package:budget/struct/settings.dart';
 import 'package:budget/widgets/navigationFramework.dart';
 import 'package:budget/widgets/navigationSidebar.dart';
-import 'package:budget/widgets/openBottomSheet.dart';
+import 'package:budget/widgets/transactionEntry/swipeToSelectTransactions.dart';
 import 'package:budget/widgets/textWidgets.dart';
 import 'package:easy_localization/easy_localization.dart';
 import 'package:flutter/foundation.dart';
@@ -12,7 +12,8 @@ import 'package:flutter/services.dart';
 import 'package:timer_builder/timer_builder.dart';
 
 bool enableSwipeDownToRefresh(BuildContext context) {
-  return runningCloudFunctions == false &&
+  return selectingTransactionsActive == 0 &&
+      runningCloudFunctions == false &&
       appStateSettings["hasSignedIn"] != false &&
       appStateSettings["backupSync"] == true;
   // && getIsFullScreen(context) == false;
diff --git a/budget/pubspec.yaml b/budget/pubspec.yaml
index 3920fd780..cd781184b 100644
--- a/budget/pubspec.yaml
+++ b/budget/pubspec.yaml
@@ -15,7 +15,7 @@ publish_to: "none" # Remove this line if you wish to publish to pub.dev
 # In iOS, build-name is used as CFBundleShortVersionString while build-number used as CFBundleVersion.
 # Read more about iOS versioning at
 # https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html
-version: 5.3.1+382
+version: 5.3.2+382
 
 environment:
   sdk: ">= 3.0.0"
