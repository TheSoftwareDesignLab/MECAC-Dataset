diff --git a/budget/lib/database/generatePreviewData.dart b/budget/lib/database/generatePreviewData.dart
index 7b7f849b7..aa38da96a 100644
--- a/budget/lib/database/generatePreviewData.dart
+++ b/budget/lib/database/generatePreviewData.dart
@@ -406,8 +406,9 @@ void generatePreviewData() async {
     List<int> moreCommonCommonCategories = [1, 2, 4];
     await database.createOrUpdateTransaction(
       updateSharedEntry: false,
+      insert: true,
       Transaction(
-        transactionPk: DateTime.now().millisecondsSinceEpoch,
+        transactionPk: -1,
         name: "",
         amount: (1 + Random().nextDouble() * 45) * -1,
         note: "",
@@ -430,8 +431,9 @@ void generatePreviewData() async {
   for (int i = 90; i < 320; i = i + 25 + Random().nextInt(10)) {
     await database.createOrUpdateTransaction(
       updateSharedEntry: false,
+      insert: true,
       Transaction(
-        transactionPk: DateTime.now().millisecondsSinceEpoch,
+        transactionPk: -1,
         name: "",
         amount: 300 + Random().nextDouble() * 200,
         note: "",
diff --git a/budget/lib/database/tables.dart b/budget/lib/database/tables.dart
index 6f1f1b44c..759bf49ca 100644
--- a/budget/lib/database/tables.dart
+++ b/budget/lib/database/tables.dart
@@ -1343,7 +1343,7 @@ class FinanceDatabase extends _$FinanceDatabase {
         dateTimeModified: Value(DateTime.now()),
       ),
     );
-    print((await getAllDeleteLogs()).length);
+    // print((await getAllDeleteLogs()).length);
     return true;
   }
 
@@ -1377,22 +1377,53 @@ class FinanceDatabase extends _$FinanceDatabase {
 
   //create or update a new wallet
   Future<int> createOrUpdateWallet(TransactionWallet wallet,
-      {DateTime? customDateTimeModified}) {
-    return into(wallets).insert(
-        wallet.copyWith(
-            dateTimeModified: Value(customDateTimeModified ?? DateTime.now())),
-        mode: InsertMode.insertOrReplace);
+      {DateTime? customDateTimeModified, bool insert = false}) {
+    wallet = wallet.copyWith(
+        dateTimeModified: Value(customDateTimeModified ?? DateTime.now()));
+    WalletsCompanion companionToInsert = wallet.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert = companionToInsert.copyWith(walletPk: Value.absent());
+    }
+
+    return into(wallets)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
   }
 
   //create or update a new wallet
-  Future<int> createOrUpdateScannerTemplate(ScannerTemplate scannerTemplate) {
-    return into(scannerTemplates).insertOnConflictUpdate(
-        scannerTemplate.copyWith(dateTimeModified: Value(DateTime.now())));
+  Future<int> createOrUpdateScannerTemplate(ScannerTemplate scannerTemplate,
+      {bool insert = false}) {
+    scannerTemplate =
+        scannerTemplate.copyWith(dateTimeModified: Value(DateTime.now()));
+    ScannerTemplatesCompanion companionToInsert =
+        scannerTemplate.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert =
+          companionToInsert.copyWith(scannerTemplatePk: Value.absent());
+    }
+
+    return into(scannerTemplates)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
   }
 
-  Future<int> createOrUpdateCategoryLimit(CategoryBudgetLimit categoryLimit) {
-    return into(categoryBudgetLimits).insertOnConflictUpdate(
-        categoryLimit.copyWith(dateTimeModified: Value(DateTime.now())));
+  Future<int> createOrUpdateCategoryLimit(CategoryBudgetLimit categoryLimit,
+      {bool insert = false}) {
+    categoryLimit =
+        categoryLimit.copyWith(dateTimeModified: Value(DateTime.now()));
+    CategoryBudgetLimitsCompanion companionToInsert =
+        categoryLimit.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert =
+          companionToInsert.copyWith(categoryLimitPk: Value.absent());
+    }
+
+    return into(categoryBudgetLimits)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
   }
 
   Stream<List<TransactionAssociatedTitle>> watchAllAssociatedTitles(
@@ -1455,17 +1486,23 @@ class FinanceDatabase extends _$FinanceDatabase {
   }
 
   Stream<List<TransactionAssociatedTitle>> watchAllAssociatedTitlesInCategory(
-      int categoryFk,
-      {int? limit,
-      int? offset}) {
+    int categoryFk,
+  ) {
     return (select(associatedTitles)
           ..where((t) => t.categoryFk.equals(categoryFk))
-          ..orderBy([(t) => OrderingTerm.asc(t.order)])
-        // ..limit(limit ?? DEFAULT_LIMIT, offset: offset ?? DEFAULT_OFFSET)
-        )
+          ..orderBy([(t) => OrderingTerm.asc(t.order)]))
         .watch();
   }
 
+  Future<List<TransactionAssociatedTitle>> getAllAssociatedTitlesInCategory(
+    int categoryFk,
+  ) {
+    return (select(associatedTitles)
+          ..where((t) => t.categoryFk.equals(categoryFk))
+          ..orderBy([(t) => OrderingTerm.asc(t.order)]))
+        .get();
+  }
+
   Stream<List<CategoryBudgetLimit>> watchAllCategoryLimitsInBudget(int budgetPk,
       {int? limit, int? offset}) {
     return (select(categoryBudgetLimits)
@@ -1547,10 +1584,22 @@ class FinanceDatabase extends _$FinanceDatabase {
 
   //create or update a new associatedTitle
   Future<int> createOrUpdateAssociatedTitle(
-      TransactionAssociatedTitle associatedTitle) {
-    return into(associatedTitles).insert(
-        associatedTitle.copyWith(dateTimeModified: Value(DateTime.now())),
-        mode: InsertMode.insertOrReplace);
+    TransactionAssociatedTitle associatedTitle, {
+    insert = false,
+  }) {
+    associatedTitle =
+        associatedTitle.copyWith(dateTimeModified: Value(DateTime.now()));
+    AssociatedTitlesCompanion companionToInsert =
+        associatedTitle.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert =
+          companionToInsert.copyWith(associatedTitlePk: Value.absent());
+    }
+
+    return into(associatedTitles)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
   }
 
   Future moveAssociatedTitle(
@@ -1692,10 +1741,12 @@ class FinanceDatabase extends _$FinanceDatabase {
   }
 
   // create or update a new transaction
-  Future<int>? createOrUpdateTransaction(Transaction transaction,
-      {bool insert = false,
-      bool updateSharedEntry = true,
-      Transaction? originalTransaction}) async {
+  Future<int>? createOrUpdateTransaction(
+    Transaction transaction, {
+    bool insert = false,
+    bool updateSharedEntry = true,
+    Transaction? originalTransaction,
+  }) async {
     if (updateSharedEntry == true && appStateSettings["sharedBudgets"] == false)
       updateSharedEntry = false;
     double maxAmount = 10000000;
@@ -1728,8 +1779,9 @@ class FinanceDatabase extends _$FinanceDatabase {
               transaction.sharedReferenceBudgetPk) {
             await deleteTransaction(transaction.transactionPk);
             await createOrUpdateTransaction(
+              insert: true,
               transaction.copyWith(
-                transactionPk: DateTime.now().millisecondsSinceEpoch,
+                transactionPk: -1,
                 sharedKey: Value(null),
                 // transactionOwnerEmail: Value(null),
                 // transactionOriginalOwnerEmail: Value(null),
@@ -1763,8 +1815,9 @@ class FinanceDatabase extends _$FinanceDatabase {
             print(e.toString());
           }
           await createOrUpdateTransaction(
+              insert: true,
               transaction.copyWith(
-                transactionPk: DateTime.now().millisecondsSinceEpoch,
+                transactionPk: -1,
                 sharedKey: Value(null),
                 transactionOwnerEmail: Value(null),
                 transactionOriginalOwnerEmail: Value(null),
@@ -2029,15 +2082,15 @@ class FinanceDatabase extends _$FinanceDatabase {
   //   return true;
   // }
 
-  // // This doesn't handle order of titles!
-  // Future<bool> createOrUpdateBatchAssociatedTitlesOnly(
-  //     List<TransactionAssociatedTitle> associatedTitlesInserting) async {
-  //   await batch((batch) {
-  //     batch.insertAll(associatedTitles, associatedTitlesInserting,
-  //         mode: InsertMode.insertOrReplace);
-  //   });
-  //   return true;
-  // }
+  // This doesn't handle order of titles!
+  Future<bool> createOrUpdateBatchAssociatedTitlesOnly(
+      List<TransactionAssociatedTitle> associatedTitlesInserting) async {
+    await batch((batch) {
+      batch.insertAll(associatedTitles, associatedTitlesInserting,
+          mode: InsertMode.insertOrReplace);
+    });
+    return true;
+  }
 
   // Future<int> deleteBatchWalletsGivenPks(List<int> walletPks) async {
   //   return (delete(wallets)..where((tbl) => tbl.walletPk.isIn(walletPks))).go();
@@ -2151,21 +2204,36 @@ class FinanceDatabase extends _$FinanceDatabase {
   // ************************************************************
 
   // create or update a category
-  Future<int> createOrUpdateCategory(TransactionCategory category,
-      {bool updateSharedEntry = true, DateTime? customDateTimeModified}) async {
+  Future<int> createOrUpdateCategory(
+    TransactionCategory category, {
+    bool updateSharedEntry = true,
+    DateTime? customDateTimeModified,
+    bool insert = false,
+  }) async {
     if (updateSharedEntry == true && appStateSettings["sharedBudgets"] == false)
       updateSharedEntry = false;
+
+    category = category.copyWith(
+        dateTimeModified: Value(customDateTimeModified ?? DateTime.now()));
+    CategoriesCompanion companionToInsert = category.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert =
+          companionToInsert.copyWith(categoryPk: Value.absent());
+    }
+
     // We need to ensure the value is set back to null, so insert/replace
-    int result = await into(categories).insert(
-        category.copyWith(
-            dateTimeModified: Value(customDateTimeModified ?? DateTime.now())),
-        mode: InsertMode.insertOrReplace);
+    int result = await into(categories)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
+
     if (updateSharedEntry)
       updateTransactionOnServerAfterChangingCategoryInformation(category);
     return result;
   }
 
-  Future<int> createOrUpdateFromSharedBudget(Budget budget) async {
+  Future<int> createOrUpdateFromSharedBudget(Budget budget,
+      {insert = false}) async {
     if (budget.sharedKey != null) {
       Budget sharedBudget;
 
@@ -2183,11 +2251,17 @@ class FinanceDatabase extends _$FinanceDatabase {
         return into(budgets).insertOnConflictUpdate(
             sharedBudget.copyWith(dateTimeModified: Value(DateTime.now())));
       } catch (e) {
-        // new entry is needed
         int numberOfBudgets = (await database.getAmountOfBudgets());
-        sharedBudget = budget.copyWith(order: numberOfBudgets);
-        return into(budgets).insertOnConflictUpdate(
-            sharedBudget.copyWith(dateTimeModified: Value(DateTime.now())));
+        // new entry is needed
+        sharedBudget = budget.copyWith(
+            dateTimeModified: Value(DateTime.now()), order: numberOfBudgets);
+        BudgetsCompanion companionToInsert = sharedBudget.toCompanion(true);
+        if (insert) {
+          // Use auto incremented ID when inserting
+          companionToInsert =
+              companionToInsert.copyWith(budgetPk: Value.absent());
+        }
+        return into(budgets).insert((companionToInsert));
       }
     } else {
       return 0;
@@ -2220,8 +2294,8 @@ class FinanceDatabase extends _$FinanceDatabase {
         .get();
   }
 
-  Future<int> createOrUpdateFromSharedTransaction(
-      Transaction transaction) async {
+  Future<int> createOrUpdateFromSharedTransaction(Transaction transaction,
+      {insert = false}) async {
     if (transaction.sharedKey != null) {
       Transaction sharedTransaction;
       try {
@@ -2240,8 +2314,15 @@ class FinanceDatabase extends _$FinanceDatabase {
       } catch (e) {
         print(e.toString());
         // new entry is needed
-        return into(transactions).insertOnConflictUpdate(
-            transaction.copyWith(dateTimeModified: Value(DateTime.now())));
+        transaction =
+            transaction.copyWith(dateTimeModified: Value(DateTime.now()));
+        TransactionsCompanion companionToInsert = transaction.toCompanion(true);
+        if (insert) {
+          // Use auto incremented ID when inserting
+          companionToInsert =
+              companionToInsert.copyWith(transactionPk: Value.absent());
+        }
+        return into(transactions).insert((companionToInsert));
       }
     } else {
       return 0;
@@ -2270,8 +2351,9 @@ class FinanceDatabase extends _$FinanceDatabase {
   // }
 
   // create or update a budget
+
   Future<int> createOrUpdateBudget(Budget budget,
-      {bool updateSharedEntry = true}) async {
+      {bool updateSharedEntry = true, bool insert = false}) async {
     if (updateSharedEntry == true && appStateSettings["sharedBudgets"] == false)
       updateSharedEntry = false;
     print(budget);
@@ -2293,9 +2375,16 @@ class FinanceDatabase extends _$FinanceDatabase {
       });
     }
 
-    return into(budgets).insert(
-        budget.copyWith(dateTimeModified: Value(DateTime.now())),
-        mode: InsertMode.replace);
+    budget = budget.copyWith(dateTimeModified: Value(DateTime.now()));
+    BudgetsCompanion companionToInsert = budget.toCompanion(true);
+
+    if (insert) {
+      // Use auto incremented ID when inserting
+      companionToInsert = companionToInsert.copyWith(budgetPk: Value.absent());
+    }
+
+    return into(budgets)
+        .insert((companionToInsert), mode: InsertMode.insertOrReplace);
   }
 
   // get category given key
@@ -2705,16 +2794,33 @@ class FinanceDatabase extends _$FinanceDatabase {
         .go();
   }
 
-  Future mergeAndDeleteCategory(TransactionCategory category) async {
+  Future mergeAndDeleteCategory(
+      TransactionCategory categoryFrom, TransactionCategory categoryTo) async {
     List<Transaction> transactionsToUpdate =
-        await getAllTransactionsFromCategory(category.categoryPk);
+        await getAllTransactionsFromCategory(categoryFrom.categoryPk);
+    // This is good for shared budgets, but shared is discontinued
+    // for (Transaction transaction in transactionsToUpdate) {
+    //   Transaction transactionEdited =
+    //       transaction.copyWith(categoryFk: categoryTo.categoryPk);
+    //   await database.createOrUpdateTransaction(transactionEdited);
+    // }
+    List<Transaction> transactionsEdited = [];
     for (Transaction transaction in transactionsToUpdate) {
-      await Future.delayed(Duration(milliseconds: 1));
-      Transaction transactionEdited =
-          transaction.copyWith(categoryFk: category.categoryPk);
-      await database.createOrUpdateTransaction(transactionEdited);
+      transactionsEdited
+          .add(transaction.copyWith(categoryFk: categoryTo.categoryPk));
     }
-    await database.deleteCategory(category.categoryPk, category.order);
+    await createOrUpdateBatchTransactionsOnly(transactionsEdited);
+
+    List<TransactionAssociatedTitle> associatedTitlesToUpdate =
+        await getAllAssociatedTitlesInCategory(categoryFrom.categoryPk);
+    List<TransactionAssociatedTitle> associatedTitlesEdited = [];
+    for (TransactionAssociatedTitle title in associatedTitlesToUpdate) {
+      associatedTitlesEdited
+          .add(title.copyWith(categoryFk: categoryTo.categoryPk));
+    }
+    await createOrUpdateBatchAssociatedTitlesOnly(associatedTitlesEdited);
+
+    await database.deleteCategory(categoryFrom.categoryPk, categoryFrom.order);
   }
 
   Stream<double?> totalDoubleStream(List<Stream<double?>> mergedStreams) {
diff --git a/budget/lib/functions.dart b/budget/lib/functions.dart
index 6bcfd03dc..6456d5e02 100644
--- a/budget/lib/functions.dart
+++ b/budget/lib/functions.dart
@@ -65,20 +65,51 @@ String removeLastCharacter(String text) {
   return text.substring(0, text.length - 1);
 }
 
+int countDecimalDigits(String value) {
+  int decimalIndex = value.indexOf('.');
+  if (decimalIndex == -1) {
+    return 0;
+  }
+
+  int count = 0;
+  for (int i = decimalIndex + 1; i < value.length; i++) {
+    count++;
+  }
+  return count;
+}
+
+bool hasDecimalPoints(double? value) {
+  if (value == null) return false;
+  String stringValue = value.toString();
+  int dotIndex = stringValue.indexOf('.');
+
+  if (dotIndex != -1) {
+    for (int i = dotIndex + 1; i < stringValue.length; i++) {
+      if (stringValue[i] != '0') {
+        return true;
+      }
+    }
+  }
+
+  return false;
+}
+
 String convertToMoney(
   AllWallets allWallets,
   double amount, {
   String? currencyKey,
-  bool showCurrency = true,
   double? finalNumber,
   int? decimals,
+  bool? allDecimals,
+  bool? addCurrencyName,
 }) {
   int numberDecimals = decimals ??
       allWallets.indexedByPk[appStateSettings["selectedWallet"]]?.decimals ??
       2;
-  numberDecimals = numberDecimals > 2 && amount.toString().split('.').length > 1
-      ? amount.toString().split('.')[1].length < numberDecimals
-          ? amount.toString().split('.')[1].length
+  numberDecimals = numberDecimals > 2 &&
+          (finalNumber ?? amount).toString().split('.').length > 1
+      ? (finalNumber ?? amount).toString().split('.')[1].length < numberDecimals
+          ? (finalNumber ?? amount).toString().split('.')[1].length
           : numberDecimals
       : numberDecimals;
 
@@ -88,36 +119,42 @@ String convertToMoney(
   if (amount == double.infinity) {
     return "Infinity";
   }
-  NumberFormat currency = new NumberFormat.currency(
-    decimalDigits: numberDecimals,
+  NumberFormat currency = NumberFormat.currency(
+    decimalDigits: allDecimals == true ||
+            hasDecimalPoints(finalNumber) ||
+            hasDecimalPoints(amount)
+        ? numberDecimals
+        : 0,
     locale: Platform.localeName,
-    symbol: (showCurrency
-        ? getCurrencyString(allWallets, currencyKey: currencyKey)
-        : ''),
+    symbol: getCurrencyString(allWallets, currencyKey: currencyKey),
   );
-  String formatOutput = currency.format(amount);
-
-  if (finalNumber != null &&
-      !finalNumber
-          .abs()
-          .toStringAsFixed(numberDecimals)
-          .split(".")[1]
-          .startsWith("0" * numberDecimals)) {
-    return currency.format(amount);
-  }
-  if ((finalNumber != null &&
-          finalNumber
-              .abs()
-              .toStringAsFixed(numberDecimals)
-              .split(".")[1]
-              .startsWith("0" * numberDecimals)) ||
-      formatOutput.substring(formatOutput.length - numberDecimals) ==
-          "0" * numberDecimals) {
-    // Do not show the zeroes
-    return formatOutput.replaceRange(
-        formatOutput.length - numberDecimals - 1, formatOutput.length, '');
-  }
-  return currency.format(amount);
+  String formatOutput = currency.format(amount).trim();
+  if (addCurrencyName == true)
+    formatOutput = formatOutput +
+        " " +
+        (currencyKey ?? "Missing Currency Key").toUpperCase();
+  return formatOutput;
+  // if (finalNumber != null &&
+  //     !finalNumber
+  //         .abs()
+  //         .toStringAsFixed(numberDecimals)
+  //         .split(".")[1]
+  //         .startsWith("0" * numberDecimals)) {
+  //   return currency.format(amount);
+  // }
+  // if ((finalNumber != null &&
+  //         finalNumber
+  //             .abs()
+  //             .toStringAsFixed(numberDecimals)
+  //             .split(".")[1]
+  //             .startsWith("0" * numberDecimals)) ||
+  //     formatOutput.substring(formatOutput.length - numberDecimals) ==
+  //         "0" * numberDecimals) {
+  //   // Do not show the zeroes
+  //   return formatOutput.replaceRange(
+  //       formatOutput.length - numberDecimals - 1, formatOutput.length, '');
+  // }
+  // return currency.format(amount);
 }
 
 String getMonth(int monthIndex) {
diff --git a/budget/lib/main.dart b/budget/lib/main.dart
index 73ee7cf43..ff72a5dd3 100644
--- a/budget/lib/main.dart
+++ b/budget/lib/main.dart
@@ -33,7 +33,7 @@ import 'firebase_options.dart';
 import 'package:easy_localization/easy_localization.dart';
 
 // Requires hot reload when changed
-bool enableDevicePreview = false;
+bool enableDevicePreview = false && kDebugMode;
 
 void main() async {
   WidgetsFlutterBinding.ensureInitialized();
diff --git a/budget/lib/pages/addAssociatedTitlePage.dart b/budget/lib/pages/addAssociatedTitlePage.dart
index 40e2068cd..9ede0636a 100644
--- a/budget/lib/pages/addAssociatedTitlePage.dart
+++ b/budget/lib/pages/addAssociatedTitlePage.dart
@@ -50,10 +50,11 @@ class _AddAssociatedTitlePageState extends State<AddAssociatedTitlePage> {
     print("Added Title");
     int length = await database.getAmountOfAssociatedTitles();
     await database.createOrUpdateAssociatedTitle(
+      insert: widget.associatedTitle == null,
       TransactionAssociatedTitle(
         associatedTitlePk: widget.associatedTitle != null
             ? widget.associatedTitle!.associatedTitlePk
-            : DateTime.now().millisecondsSinceEpoch,
+            : -1,
         categoryFk: selectedCategory == null ? 0 : selectedCategory!.categoryPk,
         isExactMatch: false,
         title: selectedTitle?.trim() ?? "",
diff --git a/budget/lib/pages/addBudgetPage.dart b/budget/lib/pages/addBudgetPage.dart
index 1613f288b..ec9fda8b2 100644
--- a/budget/lib/pages/addBudgetPage.dart
+++ b/budget/lib/pages/addBudgetPage.dart
@@ -13,12 +13,10 @@ import 'package:budget/widgets/framework/pageFramework.dart';
 import 'package:budget/widgets/selectChips.dart';
 import 'package:budget/widgets/framework/popupFramework.dart';
 import 'package:budget/widgets/radioItems.dart';
-import 'package:budget/widgets/categoryLimits.dart';
 import 'package:budget/widgets/saveBottomButton.dart';
 import 'package:budget/widgets/selectAmount.dart';
 import 'package:budget/widgets/selectCategory.dart';
 import 'package:budget/widgets/selectColor.dart';
-import 'package:budget/widgets/settingsContainers.dart';
 import 'package:budget/widgets/tappable.dart';
 import 'package:budget/widgets/textInput.dart';
 import 'package:budget/widgets/textWidgets.dart';
@@ -88,7 +86,6 @@ dynamic enumRecurrence = {
 
 class _AddBudgetPageState extends State<AddBudgetPage> {
   bool? canAddBudget;
-  int setBudgetPk = DateTime.now().millisecondsSinceEpoch;
   List<int>? selectedCategories;
   double? selectedAmount;
   String? selectedAmountCalculation;
@@ -207,8 +204,11 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
     loadingIndeterminateKey.currentState!.setVisibility(true);
     Budget createdBudget = await createBudget();
     print("Added budget");
-    int result = await database.createOrUpdateBudget(createdBudget);
-    if (selectedShared == true && widget.budget == null) {
+    int result = await database.createOrUpdateBudget(
+        insert: widget.budget == null, createdBudget);
+    if (selectedShared == true &&
+        widget.budget == null &&
+        appStateSettings["sharedBudgets"] == true) {
       openLoadingPopup(context);
       bool result2 = await shareBudget(createdBudget, context);
       Navigator.pop(context);
@@ -231,7 +231,7 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
       }
     }
     loadingIndeterminateKey.currentState!.setVisibility(false);
-    if (result == -1) {
+    if (result == -1 && appStateSettings["sharedBudgets"] == true) {
       openPopup(
         context,
         title: "No Connection",
@@ -260,7 +260,7 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
           await database.getBudgetInstance(widget.budget!.budgetPk);
     }
     return await Budget(
-      budgetPk: widget.budget != null ? widget.budget!.budgetPk : setBudgetPk,
+      budgetPk: widget.budget != null ? widget.budget!.budgetPk : -1,
       name: selectedTitle ?? "",
       amount: selectedAmount ?? 0,
       colour: toHexString(selectedColor),
@@ -420,10 +420,7 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
         if (widget.budget != null) {
           discardChangesPopupIfBudgetPassed();
         } else {
-          // remove budget category limits created for a budget that has not been made yet
-          discardChangesPopup(context, onDiscard: () {
-            database.deleteCategoryBudgetLimitsInBudget(setBudgetPk);
-          });
+          discardChangesPopup(context, forceShow: true);
         }
         return false;
       },
@@ -443,18 +440,14 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
             if (widget.budget != null) {
               discardChangesPopupIfBudgetPassed();
             } else {
-              discardChangesPopup(context, onDiscard: () {
-                database.deleteCategoryBudgetLimitsInBudget(setBudgetPk);
-              });
+              discardChangesPopup(context, forceShow: true);
             }
           },
           onDragDownToDissmiss: () async {
             if (widget.budget != null) {
               discardChangesPopupIfBudgetPassed();
             } else {
-              discardChangesPopup(context, onDiscard: () {
-                database.deleteCategoryBudgetLimitsInBudget(setBudgetPk);
-              });
+              discardChangesPopup(context, forceShow: true);
             }
           },
           actions: [
@@ -489,7 +482,7 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
             alignment: Alignment.bottomCenter,
             child: selectedTitle == "" || selectedTitle == null
                 ? SaveBottomButton(
-                    label: "set-title".tr(),
+                    label: "set-name".tr(),
                     onTap: () async {
                       FocusScope.of(context).unfocus();
                       Future.delayed(Duration(milliseconds: 100), () {
@@ -863,46 +856,28 @@ class _AddBudgetPageState extends State<AddBudgetPage> {
                             ),
                     ),
                   ),
+                  widget.budget != null && widget.budget!.addedTransactionsOnly
+                      ? Row(
+                          children: [
+                            Expanded(
+                              child: Padding(
+                                padding: const EdgeInsets.only(
+                                    left: 15, right: 15, top: 25),
+                                child: TextFont(
+                                  text: "added-budget-description".tr(),
+                                  fontSize: 14,
+                                  textColor: getColor(context, "textLight"),
+                                  maxLines: 5,
+                                  textAlign: TextAlign.center,
+                                ),
+                              ),
+                            ),
+                          ],
+                        )
+                      : SizedBox.shrink(),
                 ],
               ),
             ),
-            SliverToBoxAdapter(child: SizedBox(height: 8)),
-            CategoryLimits(
-              isAbsoluteSpendingLimit: selectedIsAbsoluteSpendingLimit,
-              selectedCategories: selectedCategories ?? [],
-              budgetPk:
-                  widget.budget == null ? setBudgetPk : widget.budget!.budgetPk,
-              budgetLimit: selectedAmount ?? 0,
-              showAddCategoryButton: selectedAllCategories,
-            ),
-            SliverToBoxAdapter(
-              child: Padding(
-                padding: EdgeInsets.symmetric(
-                    horizontal: getHorizontalPaddingConstrained(context)),
-                child: SettingsContainerSwitch(
-                  onSwitched: (value) async {
-                    await database
-                        .toggleAbsolutePercentSpendingCategoryBudgetLimits(
-                      widget.budget != null
-                          ? widget.budget!.budgetPk
-                          : setBudgetPk,
-                      selectedAmount ?? 1,
-                      selectedIsAbsoluteSpendingLimit,
-                    );
-                    setState(() {
-                      selectedIsAbsoluteSpendingLimit =
-                          !selectedIsAbsoluteSpendingLimit;
-                    });
-                    determineBottomButton();
-                  },
-                  initialValue: selectedIsAbsoluteSpendingLimit,
-                  syncWithInitialValue: true,
-                  title: "absolute-spending-limits".tr(),
-                  description: "absolute-spending-limits-description".tr(),
-                  icon: Icons.numbers_rounded,
-                ),
-              ),
-            ),
           ],
           listWidgets: [
             widget.budget != null && widget.budget!.sharedKey != null
diff --git a/budget/lib/pages/addCategoryPage.dart b/budget/lib/pages/addCategoryPage.dart
index 215527cf5..eeed8403b 100644
--- a/budget/lib/pages/addCategoryPage.dart
+++ b/budget/lib/pages/addCategoryPage.dart
@@ -42,7 +42,6 @@ class _AddCategoryPageState extends State<AddCategoryPage>
   String? selectedImage = "image.png";
   Color? selectedColor;
   bool selectedIncome = false;
-  int setCategoryPk = DateTime.now().millisecondsSinceEpoch;
   bool? canAddCategory;
   TransactionCategory? widgetCategory;
   List<String>? selectedMembers;
@@ -115,7 +114,10 @@ class _AddCategoryPageState extends State<AddCategoryPage>
 
   Future addCategory() async {
     TransactionCategory createdCategory = await createTransactionCategory();
-    await database.createOrUpdateCategory(createdCategory);
+    await database.createOrUpdateCategory(
+      insert: widget.category == null,
+      createdCategory,
+    );
     Navigator.pop(context);
   }
 
@@ -126,8 +128,7 @@ class _AddCategoryPageState extends State<AddCategoryPage>
           await database.getCategoryInstance(widget.category!.categoryPk);
     }
     return TransactionCategory(
-      categoryPk:
-          widget.category != null ? widget.category!.categoryPk : setCategoryPk,
+      categoryPk: widget.category != null ? widget.category!.categoryPk : -1,
       name: (selectedTitle ?? "").trim(),
       dateCreated: widget.category != null
           ? widget.category!.dateCreated
@@ -250,7 +251,7 @@ class _AddCategoryPageState extends State<AddCategoryPage>
             alignment: Alignment.bottomCenter,
             child: selectedTitle == "" || selectedTitle == null
                 ? SaveBottomButton(
-                    label: "set-title".tr(),
+                    label: "set-name".tr(),
                     onTap: () async {
                       FocusScope.of(context).unfocus();
                       Future.delayed(Duration(milliseconds: 100), () {
@@ -447,112 +448,123 @@ class _AddCategoryPageState extends State<AddCategoryPage>
                     ),
                   ),
             widgetCategory == null ? SizedBox.shrink() : SizedBox(height: 13),
-            Padding(
-              padding: const EdgeInsets.symmetric(horizontal: 20),
-              child: TextFont(
-                text: "associated-titles".tr(),
-                textColor: getColor(context, "textLight"),
-                fontSize: 16,
-              ),
-            ),
-            SizedBox(height: 5),
-            Padding(
-              padding: const EdgeInsets.symmetric(horizontal: 20),
-              child: TextFont(
-                text: "associated-titles-description".tr(),
-                textColor: getColor(context, "textLight"),
-                fontSize: 13,
-                maxLines: 10,
-              ),
-            ),
-            SizedBox(height: 10),
-            AddButton(
-                padding: EdgeInsets.only(
-                  left: 15,
-                  right: 15,
-                  bottom: 9,
-                  top: 4,
-                ),
-                onTap: () {
-                  openBottomSheet(
-                    context,
-                    PopupFramework(
-                      title: "set-title".tr(),
-                      child: SelectText(
-                        setSelectedText: (_) {},
-                        labelText: "set-title".tr(),
-                        placeholder: "title-placeholder".tr(),
-                        nextWithInput: (text) async {
-                          int length =
-                              await database.getAmountOfAssociatedTitles();
-
-                          await database.createOrUpdateAssociatedTitle(
-                            TransactionAssociatedTitle(
-                              associatedTitlePk:
-                                  DateTime.now().millisecondsSinceEpoch,
-                              categoryFk: widget.category == null
-                                  ? setCategoryPk
-                                  : widget.category!.categoryPk,
-                              isExactMatch: false,
-                              title: text.trim(),
-                              dateCreated: DateTime.now(),
-                              dateTimeModified: null,
-                              order: length,
-                            ),
-                          );
-                        },
-                      ),
+            widget.category == null
+                ? SizedBox.shrink()
+                : Padding(
+                    padding: const EdgeInsets.symmetric(horizontal: 20),
+                    child: TextFont(
+                      text: "associated-titles".tr(),
+                      textColor: getColor(context, "textLight"),
+                      fontSize: 16,
                     ),
-                  );
-                }),
-            StreamBuilder<List<TransactionAssociatedTitle>>(
-                stream: database.watchAllAssociatedTitlesInCategory(
-                  widget.category == null
-                      ? setCategoryPk
-                      : widget.category!.categoryPk,
-                ),
-                builder: (context, snapshot) {
-                  if (snapshot.hasData && (snapshot.data ?? []).length > 0) {
-                    List<Widget> associatedTitleWidgets = [];
-                    for (int i = 0; i < snapshot.data!.length; i++) {
-                      TransactionAssociatedTitle associatedTitle =
-                          snapshot.data![i];
-                      associatedTitleWidgets.add(
-                        Padding(
-                          padding: const EdgeInsets.symmetric(horizontal: 15),
-                          child: AssociatedTitleContainer(
-                            title: associatedTitle.title,
-                            setTitle: (text) async {
+                  ),
+            widget.category == null ? SizedBox.shrink() : SizedBox(height: 5),
+            widget.category == null
+                ? SizedBox.shrink()
+                : Padding(
+                    padding: const EdgeInsets.symmetric(horizontal: 20),
+                    child: TextFont(
+                      text: "associated-titles-description".tr(),
+                      textColor: getColor(context, "textLight"),
+                      fontSize: 13,
+                      maxLines: 10,
+                    ),
+                  ),
+            widget.category == null ? SizedBox.shrink() : SizedBox(height: 10),
+            widget.category == null
+                ? SizedBox.shrink()
+                : AddButton(
+                    padding: EdgeInsets.only(
+                      left: 15,
+                      right: 15,
+                      bottom: 9,
+                      top: 4,
+                    ),
+                    onTap: () {
+                      openBottomSheet(
+                        context,
+                        PopupFramework(
+                          title: "set-title".tr(),
+                          child: SelectText(
+                            setSelectedText: (_) {},
+                            labelText: "set-title".tr(),
+                            placeholder: "title-placeholder".tr(),
+                            nextWithInput: (text) async {
+                              int length =
+                                  await database.getAmountOfAssociatedTitles();
+
                               await database.createOrUpdateAssociatedTitle(
+                                insert: true,
                                 TransactionAssociatedTitle(
-                                  associatedTitlePk:
-                                      associatedTitle.associatedTitlePk,
+                                  associatedTitlePk: -1,
                                   categoryFk: widget.category == null
-                                      ? setCategoryPk
+                                      ? -1
                                       : widget.category!.categoryPk,
-                                  isExactMatch: associatedTitle.isExactMatch,
+                                  isExactMatch: false,
                                   title: text.trim(),
                                   dateCreated: DateTime.now(),
                                   dateTimeModified: null,
-                                  order: associatedTitle.order,
+                                  order: length,
                                 ),
                               );
                             },
-                            onDelete: () async {
-                              await database.deleteAssociatedTitle(
-                                  snapshot.data![i].associatedTitlePk,
-                                  snapshot.data![i].order);
-                            },
                           ),
                         ),
                       );
-                    }
-                    return Column(
-                      children: [...associatedTitleWidgets],
-                    );
-                  }
-                  return SizedBox();
-                }),
+                    }),
+            widget.category == null
+                ? SizedBox.shrink()
+                : StreamBuilder<List<TransactionAssociatedTitle>>(
+                    stream: database.watchAllAssociatedTitlesInCategory(
+                      widget.category == null
+                          ? -1
+                          : widget.category!.categoryPk,
+                    ),
+                    builder: (context, snapshot) {
+                      if (snapshot.hasData &&
+                          (snapshot.data ?? []).length > 0) {
+                        List<Widget> associatedTitleWidgets = [];
+                        for (int i = 0; i < snapshot.data!.length; i++) {
+                          TransactionAssociatedTitle associatedTitle =
+                              snapshot.data![i];
+                          associatedTitleWidgets.add(
+                            Padding(
+                              padding:
+                                  const EdgeInsets.symmetric(horizontal: 15),
+                              child: AssociatedTitleContainer(
+                                title: associatedTitle.title,
+                                setTitle: (text) async {
+                                  await database.createOrUpdateAssociatedTitle(
+                                    TransactionAssociatedTitle(
+                                      associatedTitlePk:
+                                          associatedTitle.associatedTitlePk,
+                                      categoryFk: widget.category == null
+                                          ? -1
+                                          : widget.category!.categoryPk,
+                                      isExactMatch:
+                                          associatedTitle.isExactMatch,
+                                      title: text.trim(),
+                                      dateCreated: DateTime.now(),
+                                      dateTimeModified: null,
+                                      order: associatedTitle.order,
+                                    ),
+                                  );
+                                },
+                                onDelete: () async {
+                                  await database.deleteAssociatedTitle(
+                                      snapshot.data![i].associatedTitlePk,
+                                      snapshot.data![i].order);
+                                },
+                              ),
+                            ),
+                          );
+                        }
+                        return Column(
+                          children: [...associatedTitleWidgets],
+                        );
+                      }
+                      return SizedBox();
+                    }),
             SizedBox(height: 80),
           ],
         ),
diff --git a/budget/lib/pages/addEmailTemplate.dart b/budget/lib/pages/addEmailTemplate.dart
index d954cab73..0616ba116 100644
--- a/budget/lib/pages/addEmailTemplate.dart
+++ b/budget/lib/pages/addEmailTemplate.dart
@@ -2,7 +2,6 @@ import 'package:budget/database/tables.dart';
 import 'package:budget/pages/autoTransactionsPageEmail.dart';
 import 'package:budget/struct/databaseGlobal.dart';
 import 'package:budget/widgets/button.dart';
-import 'package:budget/widgets/navigationSidebar.dart';
 import 'package:budget/widgets/openBottomSheet.dart';
 import 'package:budget/widgets/openPopup.dart';
 import 'package:budget/widgets/framework/pageFramework.dart';
@@ -339,7 +338,10 @@ class _AddEmailTemplateState extends State<AddEmailTemplate> {
 
   Future addTemplate() async {
     print("Added template");
-    await database.createOrUpdateScannerTemplate(createTemplate());
+    await database.createOrUpdateScannerTemplate(
+      insert: widget.scannerTemplate == null,
+      createTemplate(),
+    );
     Navigator.pop(context);
   }
 
diff --git a/budget/lib/pages/addTransactionPage.dart b/budget/lib/pages/addTransactionPage.dart
index fbfd1e3f0..9e8792c05 100644
--- a/budget/lib/pages/addTransactionPage.dart
+++ b/budget/lib/pages/addTransactionPage.dart
@@ -33,7 +33,6 @@ import 'package:flutter/material.dart';
 import 'dart:async';
 import 'package:budget/colors.dart';
 import 'package:provider/provider.dart';
-import 'package:budget/widgets/countNumber.dart';
 import 'package:budget/widgets/util/showTimePicker.dart';
 import 'package:budget/widgets/framework/pageFramework.dart';
 import 'package:budget/widgets/framework/popupFramework.dart';
@@ -346,6 +345,7 @@ class _AddTransactionPageState extends State<AddTransactionPage>
     }
 
     await database.createOrUpdateTransaction(
+      insert: widget.transaction == null,
       await createTransaction(),
       originalTransaction: widget.transaction,
     );
@@ -385,9 +385,8 @@ class _AddTransactionPageState extends State<AddTransactionPage>
       }
     }
     Transaction createdTransaction = Transaction(
-      transactionPk: widget.transaction != null
-          ? widget.transaction!.transactionPk
-          : DateTime.now().millisecondsSinceEpoch,
+      transactionPk:
+          widget.transaction != null ? widget.transaction!.transactionPk : -1,
       name: (selectedTitle ?? "").trim(),
       amount: (selectedIncome
           ? (selectedAmount ?? 0).abs()
@@ -771,7 +770,6 @@ class _AddTransactionPageState extends State<AddTransactionPage>
                           convertToMoney(
                             Provider.of<AllWallets>(context, listen: false),
                             selectedAmount ?? 0,
-                            showCurrency: false,
                             finalNumber: selectedAmount ?? 0,
                             decimals: selectedWallet?.decimals,
                           ),
@@ -877,16 +875,9 @@ class _AddTransactionPageState extends State<AddTransactionPage>
                                   text: convertToMoney(
                                     Provider.of<AllWallets>(context),
                                     selectedAmount ?? 0,
-                                    showCurrency: false,
-                                    finalNumber: selectedAmount ?? 0,
                                     decimals: selectedWallet?.decimals,
+                                    currencyKey: selectedWallet?.currency,
                                   ),
-                                  walletPkForCurrency: selectedWalletPk,
-                                  onlyShowCurrencyIcon:
-                                      Provider.of<AllWallets>(context)
-                                              .list
-                                              .length <=
-                                          1,
                                   fontSize: 32,
                                   fontWeight: FontWeight.bold,
                                   maxLines: 1,
@@ -920,59 +911,23 @@ class _AddTransactionPageState extends State<AddTransactionPage>
                                   )
                                 : AnimatedSwitcher(
                                     duration: Duration(milliseconds: 350),
-                                    child: CountNumber(
-                                      key: ValueKey(selectedWalletPk),
-                                      count: (selectedAmount ?? 0) *
-                                          (amountRatioToPrimaryCurrencyGivenPk(
-                                                  Provider.of<AllWallets>(
-                                                      context),
-                                                  selectedWalletPk) ??
-                                              1),
-                                      duration: Duration(milliseconds: 1000),
-                                      dynamicDecimals: true,
-                                      decimals: Provider.of<AllWallets>(context)
-                                          .indexedByPk[appStateSettings[
-                                              "selectedWallet"]]
-                                          ?.decimals,
-                                      initialCount: (selectedAmount ?? 0) *
-                                          (amountRatioToPrimaryCurrencyGivenPk(
-                                                  Provider.of<AllWallets>(
-                                                      context),
-                                                  selectedWalletPk) ??
-                                              1),
-                                      textBuilder: (number) {
-                                        return Align(
-                                          alignment: Alignment.centerRight,
-                                          child: TextFont(
-                                            textAlign: TextAlign.right,
-                                            text: convertToMoney(
-                                                Provider.of<AllWallets>(
-                                                    context),
-                                                number,
-                                                showCurrency: false,
-                                                finalNumber: (selectedAmount ??
-                                                        0) *
-                                                    (amountRatioToPrimaryCurrencyGivenPk(
-                                                            Provider.of<
-                                                                    AllWallets>(
-                                                                context),
-                                                            selectedWalletPk) ??
-                                                        1),
-                                                decimals: Provider.of<
-                                                        AllWallets>(context)
-                                                    .indexedByPk[
-                                                        appStateSettings[
-                                                            "selectedWallet"]]
-                                                    ?.decimals),
-                                            walletPkForCurrency:
-                                                appStateSettings[
-                                                    "selectedWallet"],
-                                            fontSize: 18,
-                                            maxLines: 1,
-                                            autoSizeText: true,
-                                          ),
-                                        );
-                                      },
+                                    child: Align(
+                                      alignment: Alignment.centerRight,
+                                      child: TextFont(
+                                        textAlign: TextAlign.right,
+                                        text: convertToMoney(
+                                          Provider.of<AllWallets>(context),
+                                          (selectedAmount ?? 0) *
+                                              (amountRatioToPrimaryCurrencyGivenPk(
+                                                      Provider.of<AllWallets>(
+                                                          context),
+                                                      selectedWalletPk) ??
+                                                  1),
+                                        ),
+                                        fontSize: 18,
+                                        maxLines: 1,
+                                        autoSizeText: true,
+                                      ),
                                     ),
                                   ),
                           ],
@@ -1534,6 +1489,22 @@ class _AddTransactionPageState extends State<AddTransactionPage>
                                       onSelected: (TransactionWallet wallet) {
                                         setSelectedWalletPk(wallet);
                                       },
+                                      getCustomBorderColor:
+                                          (TransactionWallet item) {
+                                        return dynamicPastel(
+                                          context,
+                                          lightenPastel(
+                                            HexColor(
+                                              item.colour,
+                                              defaultColor: Theme.of(context)
+                                                  .colorScheme
+                                                  .primary,
+                                            ),
+                                            amount: 0.3,
+                                          ),
+                                          amount: 0.4,
+                                        );
+                                      },
                                       getLabel: (TransactionWallet wallet) {
                                         return wallet.name ==
                                                 wallet.currency
@@ -2344,8 +2315,9 @@ Future<bool> addAssociatedTitles(
       //it makes sense to add a new title if the exisitng one is from a different category, it will bump this one down and take priority
 
       await database.createOrUpdateAssociatedTitle(
+        insert: true,
         TransactionAssociatedTitle(
-          associatedTitlePk: DateTime.now().millisecondsSinceEpoch,
+          associatedTitlePk: -1,
           categoryFk: selectedCategory.categoryPk,
           isExactMatch: false,
           title: selectedTitle.trim(),
diff --git a/budget/lib/pages/addWalletPage.dart b/budget/lib/pages/addWalletPage.dart
index 858ca0b24..ea5be4b6c 100644
--- a/budget/lib/pages/addWalletPage.dart
+++ b/budget/lib/pages/addWalletPage.dart
@@ -93,7 +93,8 @@ class _AddWalletPageState extends State<AddWalletPage> {
 
   Future addWallet() async {
     print("Added wallet");
-    await database.createOrUpdateWallet(await createTransactionWallet());
+    await database.createOrUpdateWallet(
+        insert: widget.wallet == null, await createTransactionWallet());
     Navigator.pop(context);
   }
 
@@ -321,7 +322,7 @@ class _AddWalletPageState extends State<AddWalletPage> {
             alignment: Alignment.bottomCenter,
             child: selectedTitle == "" || selectedTitle == null
                 ? SaveBottomButton(
-                    label: "set-title".tr(),
+                    label: "set-name".tr(),
                     onTap: () async {
                       FocusScope.of(context).unfocus();
                       Future.delayed(Duration(milliseconds: 100), () {
diff --git a/budget/lib/pages/autoTransactionsPageEmail.dart b/budget/lib/pages/autoTransactionsPageEmail.dart
index 38a3d54dc..6045b4ade 100644
--- a/budget/lib/pages/autoTransactionsPageEmail.dart
+++ b/budget/lib/pages/autoTransactionsPageEmail.dart
@@ -299,7 +299,7 @@ Future<void> parseEmailsInBackground(context,
         await addAssociatedTitles(title, selectedCategory);
 
         Transaction transactionToAdd = Transaction(
-          transactionPk: messageDate.millisecondsSinceEpoch,
+          transactionPk: -1,
           name: title,
           amount: (amountDouble).abs() * -1,
           note: "",
@@ -345,7 +345,7 @@ Future<void> parseEmailsInBackground(context,
             Duration(milliseconds: 2500) - stopwatch.elapsed, () {});
       }
       for (Transaction transaction in transactionsToAdd) {
-        await database.createOrUpdateTransaction(transaction);
+        await database.createOrUpdateTransaction(insert: true, transaction);
       }
       List<dynamic> emails = [
         ...emailsParsed
diff --git a/budget/lib/pages/budgetPage.dart b/budget/lib/pages/budgetPage.dart
index 8132871a4..c5795e8c1 100644
--- a/budget/lib/pages/budgetPage.dart
+++ b/budget/lib/pages/budgetPage.dart
@@ -2,10 +2,12 @@ import 'package:budget/database/tables.dart';
 import 'package:budget/functions.dart';
 import 'package:budget/pages/addBudgetPage.dart';
 import 'package:budget/pages/addTransactionPage.dart';
+import 'package:budget/pages/editBudgetLimitsPage.dart';
 import 'package:budget/pages/pastBudgetsPage.dart';
 import 'package:budget/pages/premiumPage.dart';
 import 'package:budget/struct/databaseGlobal.dart';
 import 'package:budget/struct/settings.dart';
+import 'package:budget/widgets/dropdownSelect.dart';
 import 'package:budget/widgets/selectedTransactionsActionBar.dart';
 import 'package:budget/widgets/budgetContainer.dart';
 import 'package:budget/widgets/categoryEntry.dart';
@@ -200,39 +202,48 @@ class _BudgetPageContentState extends State<_BudgetPageContent> {
               ),
             ),
             actions: [
-              widget.budget.reoccurrence == BudgetReoccurence.custom ||
-                      widget.isPastBudget == true ||
-                      widget.isPastBudgetButCurrentPeriod == true
-                  ? SizedBox.shrink()
-                  : IconButton(
-                      padding: EdgeInsets.all(15),
-                      tooltip: "past-budget-cycles".tr(),
-                      onPressed: () {
-                        pushRoute(
-                          context,
-                          PastBudgetsPage(budgetPk: widget.budget.budgetPk),
-                        );
-                      },
-                      icon: Icon(
-                        Icons.history_rounded,
-                        color: budgetColorScheme.onSecondaryContainer,
-                      ),
-                    ),
-              IconButton(
-                padding: EdgeInsets.all(15),
-                tooltip: "edit-budget".tr(),
-                onPressed: () {
-                  pushRoute(
-                    context,
-                    AddBudgetPage(
-                      budget: widget.budget,
-                    ),
-                  );
-                },
-                icon: Icon(
-                  Icons.edit_rounded,
-                  color: budgetColorScheme.onSecondaryContainer,
-                ),
+              CustomPopupMenuButton(
+                showButtons: enableDoubleColumn(context),
+                keepOutFirst: true,
+                items: [
+                  DropdownItemMenu(
+                    id: "edit-budget",
+                    label: "edit-budget".tr(),
+                    icon: Icons.edit_rounded,
+                    action: () {
+                      pushRoute(
+                        context,
+                        AddBudgetPage(
+                          budget: widget.budget,
+                        ),
+                      );
+                    },
+                  ),
+                  DropdownItemMenu(
+                    id: "budget-history",
+                    label: "budget-history".tr(),
+                    icon: Icons.history_rounded,
+                    action: () {
+                      pushRoute(
+                        context,
+                        PastBudgetsPage(budgetPk: widget.budget.budgetPk),
+                      );
+                    },
+                  ),
+                  DropdownItemMenu(
+                    id: "spending-goals",
+                    label: "spending-goals".tr(),
+                    icon: Icons.fact_check_rounded,
+                    action: () {
+                      pushRoute(
+                        context,
+                        EditBudgetLimitsPage(
+                          budget: widget.budget,
+                        ),
+                      );
+                    },
+                  ),
+                ],
               ),
             ],
             title: widget.budget.name,
@@ -322,133 +333,164 @@ class _BudgetPageContentState extends State<_BudgetPageContent> {
                           ));
                         });
                         return SliverToBoxAdapter(
-                          child: Column(children: [
-                            Transform.translate(
-                              offset: Offset(0, -10),
-                              child: WidgetSize(
-                                onChange: (Size size) {
-                                  budgetHeaderHeight = size.height - 20;
-                                },
-                                child: Container(
-                                  padding: EdgeInsets.only(
-                                    top: 10,
-                                    bottom: 22,
-                                    left: 22,
-                                    right: 22,
-                                  ),
-                                  decoration: BoxDecoration(
-                                    // borderRadius: BorderRadius.vertical(
-                                    //     bottom: Radius.circular(10)),
-                                    color: budgetColorScheme.secondaryContainer,
-                                  ),
-                                  child: Column(
-                                    children: [
-                                      Transform.scale(
-                                        alignment: Alignment.bottomCenter,
-                                        scale: 1500,
-                                        child: Container(
-                                          height: 10,
-                                          width: 100,
-                                          color: budgetColorScheme
-                                              .secondaryContainer,
-                                        ),
-                                      ),
-                                      Padding(
-                                        padding: EdgeInsets.symmetric(
-                                          horizontal:
-                                              getHorizontalPaddingConstrained(
-                                                  context),
+                          child: Column(
+                            children: [
+                              Transform.translate(
+                                offset: Offset(0, -10),
+                                child: WidgetSize(
+                                  onChange: (Size size) {
+                                    budgetHeaderHeight = size.height - 20;
+                                  },
+                                  child: Container(
+                                    padding: EdgeInsets.only(
+                                      top: 10,
+                                      bottom: 22,
+                                      left: 22,
+                                      right: 22,
+                                    ),
+                                    decoration: BoxDecoration(
+                                      // borderRadius: BorderRadius.vertical(
+                                      //     bottom: Radius.circular(10)),
+                                      color:
+                                          budgetColorScheme.secondaryContainer,
+                                    ),
+                                    child: Column(
+                                      children: [
+                                        Transform.scale(
+                                          alignment: Alignment.bottomCenter,
+                                          scale: 1500,
+                                          child: Container(
+                                            height: 10,
+                                            width: 100,
+                                            color: budgetColorScheme
+                                                .secondaryContainer,
+                                          ),
                                         ),
-                                        child: BudgetTimeline(
-                                          dateForRange: dateForRange,
-                                          budget: widget.budget,
-                                          large: true,
-                                          percent: widget.budget.amount == 0
-                                              ? 0
-                                              : totalSpent /
-                                                  widget.budget.amount *
-                                                  100,
-                                          yourPercent: totalSpent == 0
-                                              ? 0
-                                              : snapshotTotalSpentByCurrentUserOnly
-                                                          .data! ==
-                                                      null
-                                                  ? 0
-                                                  : (snapshotTotalSpentByCurrentUserOnly
-                                                              .data! /
-                                                          totalSpent *
-                                                          100)
-                                                      .abs(),
-                                          todayPercent: widget.isPastBudget ==
-                                                  true
-                                              ? -1
-                                              : getPercentBetweenDates(
-                                                  budgetRange, dateForRange),
+                                        Padding(
+                                          padding: EdgeInsets.symmetric(
+                                            horizontal:
+                                                getHorizontalPaddingConstrained(
+                                                    context),
+                                          ),
+                                          child: BudgetTimeline(
+                                            dateForRange: dateForRange,
+                                            budget: widget.budget,
+                                            large: true,
+                                            percent: widget.budget.amount == 0
+                                                ? 0
+                                                : totalSpent /
+                                                    widget.budget.amount *
+                                                    100,
+                                            yourPercent: totalSpent == 0
+                                                ? 0
+                                                : snapshotTotalSpentByCurrentUserOnly
+                                                            .data! ==
+                                                        null
+                                                    ? 0
+                                                    : (snapshotTotalSpentByCurrentUserOnly
+                                                                .data! /
+                                                            totalSpent *
+                                                            100)
+                                                        .abs(),
+                                            todayPercent: widget.isPastBudget ==
+                                                    true
+                                                ? -1
+                                                : getPercentBetweenDates(
+                                                    budgetRange, dateForRange),
+                                          ),
                                         ),
-                                      ),
-                                      widget.isPastBudget == true
-                                          ? SizedBox.shrink()
-                                          : DaySpending(
-                                              budget: widget.budget,
-                                              amount: (widget.budget.amount -
-                                                      totalSpent) /
-                                                  daysBetween(dateForRange,
-                                                      budgetRange.end),
-                                              large: true,
-                                              budgetRange: budgetRange,
-                                              padding: const EdgeInsets.only(
-                                                  top: 15, bottom: 0),
-                                            ),
-                                    ],
+                                        widget.isPastBudget == true
+                                            ? SizedBox.shrink()
+                                            : DaySpending(
+                                                budget: widget.budget,
+                                                amount: (widget.budget.amount -
+                                                        totalSpent) /
+                                                    daysBetween(dateForRange,
+                                                        budgetRange.end),
+                                                large: true,
+                                                budgetRange: budgetRange,
+                                                padding: const EdgeInsets.only(
+                                                    top: 15, bottom: 0),
+                                              ),
+                                      ],
+                                    ),
                                   ),
                                 ),
                               ),
-                            ),
-                            BudgetSpenderSummary(
-                              budget: widget.budget,
-                              budgetRange: budgetRange,
-                              budgetColorScheme: budgetColorScheme,
-                              setSelectedMember: (member) {
-                                setState(() {
-                                  selectedMember = member;
-                                  selectedCategory = null;
-                                  selectedCategoryPk = -1;
-                                });
-                                _pieChartDisplayStateKey.currentState!
-                                    .setTouchedIndex(-1);
-                              },
-                            ),
-                            if (snapshot.data!.length > 0) SizedBox(height: 30),
-                            if (snapshot.data!.length > 0)
-                              Container(
-                                decoration: BoxDecoration(
-                                    boxShadow: boxShadowCheck(
-                                      boxShadowGeneral(context),
+                              BudgetSpenderSummary(
+                                budget: widget.budget,
+                                budgetRange: budgetRange,
+                                budgetColorScheme: budgetColorScheme,
+                                setSelectedMember: (member) {
+                                  setState(() {
+                                    selectedMember = member;
+                                    selectedCategory = null;
+                                    selectedCategoryPk = -1;
+                                  });
+                                  _pieChartDisplayStateKey.currentState!
+                                      .setTouchedIndex(-1);
+                                },
+                              ),
+                              if (snapshot.data!.length > 0)
+                                SizedBox(height: 30),
+                              if (snapshot.data!.length > 0)
+                                Container(
+                                  decoration: BoxDecoration(
+                                      boxShadow: boxShadowCheck(
+                                        boxShadowGeneral(context),
+                                      ),
+                                      borderRadius: BorderRadius.circular(200)),
+                                  child: PieChartWrapper(
+                                    pieChartDisplayStateKey:
+                                        _pieChartDisplayStateKey,
+                                    data: snapshot.data ?? [],
+                                    totalSpent: totalSpent,
+                                    setSelectedCategory:
+                                        (categoryPk, category) {
+                                      setState(() {
+                                        selectedCategoryPk = categoryPk;
+                                        selectedCategory = category;
+                                      });
+                                    },
+                                    isPastBudget: widget.isPastBudget ?? false,
+                                    middleColor: appStateSettings["materialYou"]
+                                        ? dynamicPastel(
+                                            context, budgetColorScheme.primary,
+                                            amount: 0.92)
+                                        : null,
+                                  ),
+                                ),
+                              Tooltip(
+                                message: "edit-spending-goals".tr(),
+                                child: Align(
+                                  alignment: Alignment.bottomRight,
+                                  child: Transform.translate(
+                                    offset: Offset(-9, 10),
+                                    child: IconButton(
+                                      padding: EdgeInsets.all(15),
+                                      onPressed: () {
+                                        pushRoute(
+                                          context,
+                                          EditBudgetLimitsPage(
+                                            budget: widget.budget,
+                                          ),
+                                        );
+                                      },
+                                      icon: Icon(
+                                        Icons.fact_check_rounded,
+                                        color: budgetColorScheme.secondary,
+                                      ),
                                     ),
-                                    borderRadius: BorderRadius.circular(200)),
-                                child: PieChartWrapper(
-                                  pieChartDisplayStateKey:
-                                      _pieChartDisplayStateKey,
-                                  data: snapshot.data ?? [],
-                                  totalSpent: totalSpent,
-                                  setSelectedCategory: (categoryPk, category) {
-                                    setState(() {
-                                      selectedCategoryPk = categoryPk;
-                                      selectedCategory = category;
-                                    });
-                                  },
-                                  isPastBudget: widget.isPastBudget ?? false,
-                                  middleColor: appStateSettings["materialYou"]
-                                      ? dynamicPastel(
-                                          context, budgetColorScheme.primary,
-                                          amount: 0.92)
-                                      : null,
+                                  ),
                                 ),
                               ),
-                            if (snapshot.data!.length > 0) SizedBox(height: 35),
-                            ...categoryEntries,
-                            if (snapshot.data!.length > 0) SizedBox(height: 15),
-                          ]),
+                              // if (snapshot.data!.length > 0)
+                              //   SizedBox(height: 35),
+                              ...categoryEntries,
+                              if (snapshot.data!.length > 0)
+                                SizedBox(height: 15),
+                            ],
+                          ),
                         );
                       }
                       return SliverToBoxAdapter(child: Container());
@@ -967,7 +1009,6 @@ class _TotalSpentState extends State<TotalSpent> {
                                 ? widget.totalSpent
                                 : widget.budget.amount - widget.totalSpent,
                             duration: Duration(milliseconds: 400),
-                            dynamicDecimals: true,
                             initialCount: (0),
                             textBuilder: (number) {
                               return TextFont(
@@ -1016,7 +1057,6 @@ class _TotalSpentState extends State<TotalSpent> {
                             ? widget.totalSpent
                             : -1 * (widget.budget.amount - widget.totalSpent),
                         duration: Duration(milliseconds: 400),
-                        dynamicDecimals: true,
                         initialCount: (0),
                         textBuilder: (number) {
                           return TextFont(
diff --git a/budget/lib/pages/creditDebtTransactionsPage.dart b/budget/lib/pages/creditDebtTransactionsPage.dart
index 8b7f76942..bc81308f2 100644
--- a/budget/lib/pages/creditDebtTransactionsPage.dart
+++ b/budget/lib/pages/creditDebtTransactionsPage.dart
@@ -73,7 +73,6 @@ class CreditDebtTransactions extends StatelessWidget {
                                   ? 0
                                   : (snapshot.data ?? 0).abs(),
                           duration: Duration(milliseconds: 700),
-                          dynamicDecimals: true,
                           initialCount: (0),
                           textBuilder: (number) {
                             return TextFont(
diff --git a/budget/lib/pages/debugPage.dart b/budget/lib/pages/debugPage.dart
index 2b01bf7e9..c91e15412 100644
--- a/budget/lib/pages/debugPage.dart
+++ b/budget/lib/pages/debugPage.dart
@@ -253,8 +253,9 @@ class DebugPage extends StatelessWidget {
                   await database.getAllCategories();
               for (int i = 0; i < 10; i++) {
                 await database.createOrUpdateTransaction(
+                  insert: true,
                   Transaction(
-                    transactionPk: DateTime.now().millisecondsSinceEpoch,
+                    transactionPk: -1,
                     name: "Test" + randomDouble[i].toString(),
                     amount: randomInt[i].toDouble(),
                     note: "",
diff --git a/budget/lib/pages/editBudgetLimitsPage.dart b/budget/lib/pages/editBudgetLimitsPage.dart
new file mode 100644
index 000000000..429d78dd0
--- /dev/null
+++ b/budget/lib/pages/editBudgetLimitsPage.dart
@@ -0,0 +1,75 @@
+import 'package:budget/database/tables.dart';
+import 'package:budget/struct/databaseGlobal.dart';
+import 'package:budget/widgets/categoryLimits.dart';
+import 'package:budget/widgets/framework/pageFramework.dart';
+import 'package:budget/widgets/openBottomSheet.dart';
+import 'package:budget/widgets/settingsContainers.dart';
+import 'package:easy_localization/easy_localization.dart';
+import 'package:flutter/material.dart';
+
+class EditBudgetLimitsPage extends StatefulWidget {
+  const EditBudgetLimitsPage({required this.budget, Key? key})
+      : super(key: key);
+  final Budget budget;
+
+  @override
+  State<EditBudgetLimitsPage> createState() => _EditBudgetLimitsPageState();
+}
+
+class _EditBudgetLimitsPageState extends State<EditBudgetLimitsPage> {
+  late bool selectedIsAbsoluteSpendingLimit =
+      widget.budget.isAbsoluteSpendingLimit;
+
+  @override
+  Widget build(BuildContext context) {
+    return Stack(
+      children: [
+        PageFramework(
+          dragDownToDismiss: true,
+          title: "spending-goals".tr(),
+          appBarBackgroundColor:
+              Theme.of(context).colorScheme.secondaryContainer,
+          appBarBackgroundColorStart: Theme.of(context).canvasColor,
+          slivers: [
+            SliverToBoxAdapter(
+              child: Padding(
+                padding: EdgeInsets.symmetric(
+                    horizontal: getHorizontalPaddingConstrained(context)),
+                child: SettingsContainerSwitch(
+                  onSwitched: (value) async {
+                    await database
+                        .toggleAbsolutePercentSpendingCategoryBudgetLimits(
+                      widget.budget.budgetPk,
+                      widget.budget.amount,
+                      selectedIsAbsoluteSpendingLimit,
+                    );
+                    await database.createOrUpdateBudget(widget.budget.copyWith(
+                        isAbsoluteSpendingLimit:
+                            !selectedIsAbsoluteSpendingLimit));
+                    setState(() {
+                      selectedIsAbsoluteSpendingLimit =
+                          !selectedIsAbsoluteSpendingLimit;
+                    });
+                  },
+                  initialValue: selectedIsAbsoluteSpendingLimit,
+                  syncWithInitialValue: true,
+                  title: "absolute-spending-limits".tr(),
+                  description: "absolute-spending-limits-description".tr(),
+                  icon: Icons.numbers_rounded,
+                ),
+              ),
+            ),
+            CategoryLimits(
+              isAbsoluteSpendingLimit: selectedIsAbsoluteSpendingLimit,
+              selectedCategories: widget.budget.categoryFks ?? [],
+              budgetPk: widget.budget.budgetPk,
+              budgetLimit: widget.budget.amount,
+              showAddCategoryButton: widget.budget.categoryFks == null ||
+                  widget.budget.categoryFks?.isEmpty == true,
+            ),
+          ],
+        ),
+      ],
+    );
+  }
+}
diff --git a/budget/lib/pages/editCategoriesPage.dart b/budget/lib/pages/editCategoriesPage.dart
index fd565a0a7..4966efccc 100644
--- a/budget/lib/pages/editCategoriesPage.dart
+++ b/budget/lib/pages/editCategoriesPage.dart
@@ -3,6 +3,7 @@ import 'dart:math';
 
 import 'package:budget/colors.dart';
 import 'package:budget/database/tables.dart';
+import 'package:budget/main.dart';
 import 'package:budget/pages/addCategoryPage.dart';
 import 'package:budget/struct/databaseGlobal.dart';
 import 'package:budget/struct/settings.dart';
@@ -395,13 +396,15 @@ void deleteCategoryPopup(context, TransactionCategory category,
   }
 }
 
-void mergeCategoryPopup(BuildContext context, TransactionCategory category) {
+void mergeCategoryPopup(
+    BuildContext context, TransactionCategory categoryOriginal) {
   openBottomSheet(
     context,
     PopupFramework(
       title: "select-category".tr(),
       subtitle: "category-to-transfer-all-transactions-to".tr(),
       child: SelectCategory(
+        hideCategoryFks: [categoryOriginal.categoryPk],
         popRoute: true,
         setSelectedCategory: (category) async {
           Future.delayed(Duration(milliseconds: 90), () async {
@@ -420,13 +423,13 @@ void mergeCategoryPopup(BuildContext context, TransactionCategory category) {
               },
             );
             if (result == true) {
-              openLoadingPopup(context);
-              database.mergeAndDeleteCategory(category);
               Navigator.pop(context);
+              openLoadingPopup(context);
+              await database.mergeAndDeleteCategory(categoryOriginal, category);
               openSnackbar(
                   SnackbarMessage(title: "Merged into " + category.name));
+              Navigator.pop(navigatorKey.currentContext!);
             }
-            Navigator.of(context).popUntil((route) => route.isFirst);
           });
         },
       ),
diff --git a/budget/lib/pages/homePage/homePage.dart b/budget/lib/pages/homePage/homePage.dart
index 89f1199c8..497fa744a 100644
--- a/budget/lib/pages/homePage/homePage.dart
+++ b/budget/lib/pages/homePage/homePage.dart
@@ -67,10 +67,12 @@ class HomePageState extends State<HomePage>
 
   _scrollListener() {
     double percent = _scrollController.offset / (200);
-    if (percent >= 0 && percent <= 1) {
-      _animationControllerHeader.value = 1 - _scrollController.offset / (200);
-      _animationControllerHeader2.value =
-          1 - _scrollController.offset * 2 / (200);
+    print(percent);
+    if (percent <= 1) {
+      double offset = _scrollController.offset;
+      if (percent >= 1) offset = 0;
+      _animationControllerHeader.value = 1 - offset / (200);
+      _animationControllerHeader2.value = 1 - offset * 2 / (200);
     }
   }
 
diff --git a/budget/lib/pages/onBoardingPage.dart b/budget/lib/pages/onBoardingPage.dart
index 13855290a..3ecc2ee65 100644
--- a/budget/lib/pages/onBoardingPage.dart
+++ b/budget/lib/pages/onBoardingPage.dart
@@ -57,8 +57,9 @@ class OnBoardingPageBodyState extends State<OnBoardingPageBody> {
     if (selectedAmount != null && selectedAmount != 0) {
       int order = await database.getAmountOfBudgets();
       await database.createOrUpdateBudget(
+        insert: true,
         Budget(
-          budgetPk: DateTime.now().millisecondsSinceEpoch,
+          budgetPk: -1,
           name: "default-budget-name".tr(),
           amount: selectedAmount ?? 0,
           startDate: selectedStartDate,
@@ -304,93 +305,116 @@ class OnBoardingPageBodyState extends State<OnBoardingPageBody> {
             ),
           ),
           SizedBox(height: 25),
-          SettingsContainerOutlined(
-            onTap: () async {
-              loadingIndeterminateKey.currentState?.setVisibility(true);
-              try {
-                await signInGoogle(
-                  context: context,
-                  waitForCompletion: false,
-                  drivePermissions: true,
-                  next: () {},
-                );
-                if (appStateSettings["username"] == "" && googleUser != null) {
-                  updateSettings("username", googleUser?.displayName ?? "",
-                      pagesNeedingRefresh: [0], updateGlobalState: false);
-                }
+          getPlatform() == PlatformOS.isIOS
+              ? IntrinsicWidth(
+                  child: Button(
+                    label: "Let's go!",
+                    onTap: () {},
+                    expandedLayout: false,
+                  ),
+                )
+              : SizedBox.shrink(),
+          getPlatform() == PlatformOS.isIOS
+              ? SizedBox.shrink()
+              : SettingsContainerOutlined(
+                  onTap: () async {
+                    loadingIndeterminateKey.currentState?.setVisibility(true);
+                    try {
+                      await signInGoogle(
+                        context: context,
+                        waitForCompletion: false,
+                        drivePermissions: true,
+                        next: () {},
+                      );
+                      if (appStateSettings["username"] == "" &&
+                          googleUser != null) {
+                        updateSettings(
+                            "username", googleUser?.displayName ?? "",
+                            pagesNeedingRefresh: [0], updateGlobalState: false);
+                      }
 
-                // If user has sync backups, but no real backups it will show up here
-                // For now disable restoring of a backup popup, the sync backups will be restored automatically using the function call below
-                // var result;
-                // List<drive.File>? files = (await getDriveFiles()).$2;
-                // if ((files?.length ?? 0) > 0) {
-                //   result = await openPopup(
-                //     context,
-                //     icon: Icons.cloud_sync_rounded,
-                //     title: "backup-found".tr(),
-                //     description: "backup-found-description".tr(),
-                //     onSubmit: () {
-                //       Navigator.pop(context, true);
-                //     },
-                //     onCancel: () {
-                //       Navigator.pop(context, false);
-                //     },
-                //     onSubmitLabel: "restore".tr(),
-                //     onCancelLabel: "cancel".tr(),
-                //   );
-                // }
-                // if (result == true) {
-                //   chooseBackup(context, hideDownloadButton: true);
-                // } else if (result == false && googleUser != null) {
-                //   openLoadingPopup(context);
-                //   // set this to true so cloud functions run
-                //   entireAppLoaded = true;
-                //   await runAllCloudFunctions(
-                //     context,
-                //     forceSignIn: true,
-                //   );
-                //   Navigator.pop(context);
-                //   nextNavigation();
-                // }
-                // else {
-                //   nextNavigation();
-                // }
-                openLoadingPopup(context);
-                // set this to true so cloud functions run
-                entireAppLoaded = true;
-                await runAllCloudFunctions(
-                  context,
-                  forceSignIn: true,
-                );
-                Navigator.pop(context);
-                nextNavigation();
-                loadingIndeterminateKey.currentState?.setVisibility(false);
-              } catch (e) {
-                print("Error signing in: " + e.toString());
-                loadingIndeterminateKey.currentState?.setVisibility(false);
-              }
-            },
-            title: "sign-in-with-google".tr(),
-            icon: MoreIcons.google,
-            isExpanded: false,
-          ),
-          SizedBox(height: 8),
-          Padding(
-            padding: const EdgeInsets.symmetric(horizontal: 25),
-            child: TextFont(
-              text: "onboarding-info-3".tr(),
-              textAlign: TextAlign.center,
-              fontSize: 16,
-              maxLines: 5,
-            ),
-          ),
-          SizedBox(height: 35),
-          LowKeyButton(
-            onTap: () {
-              nextNavigation();
-            },
-            text: "continue-without-sign-in".tr(),
-          ),
+                      // If user has sync backups, but no real backups it will show up here
+                      // For now disable restoring of a backup popup, the sync backups will be restored automatically using the function call below
+                      // var result;
+                      // List<drive.File>? files = (await getDriveFiles()).$2;
+                      // if ((files?.length ?? 0) > 0) {
+                      //   result = await openPopup(
+                      //     context,
+                      //     icon: Icons.cloud_sync_rounded,
+                      //     title: "backup-found".tr(),
+                      //     description: "backup-found-description".tr(),
+                      //     onSubmit: () {
+                      //       Navigator.pop(context, true);
+                      //     },
+                      //     onCancel: () {
+                      //       Navigator.pop(context, false);
+                      //     },
+                      //     onSubmitLabel: "restore".tr(),
+                      //     onCancelLabel: "cancel".tr(),
+                      //   );
+                      // }
+                      // if (result == true) {
+                      //   chooseBackup(context, hideDownloadButton: true);
+                      // } else if (result == false && googleUser != null) {
+                      //   openLoadingPopup(context);
+                      //   // set this to true so cloud functions run
+                      //   entireAppLoaded = true;
+                      //   await runAllCloudFunctions(
+                      //     context,
+                      //     forceSignIn: true,
+                      //   );
+                      //   Navigator.pop(context);
+                      //   nextNavigation();
+                      // }
+                      // else {
+                      //   nextNavigation();
+                      // }
+                      openLoadingPopup(context);
+                      // set this to true so cloud functions run
+                      entireAppLoaded = true;
+                      await runAllCloudFunctions(
+                        context,
+                        forceSignIn: true,
+                      );
+                      Navigator.pop(context);
+                      nextNavigation();
+                      loadingIndeterminateKey.currentState
+                          ?.setVisibility(false);
+                    } catch (e) {
+                      print("Error signing in: " + e.toString());
+                      loadingIndeterminateKey.currentState
+                          ?.setVisibility(false);
+                    }
+                  },
+                  title: "sign-in-with-google".tr(),
+                  icon: MoreIcons.google,
+                  isExpanded: false,
+                ),
+          getPlatform() == PlatformOS.isIOS
+              ? SizedBox.shrink()
+              : SizedBox(height: 8),
+          getPlatform() == PlatformOS.isIOS
+              ? SizedBox.shrink()
+              : Padding(
+                  padding: const EdgeInsets.symmetric(horizontal: 25),
+                  child: TextFont(
+                    text: "onboarding-info-3".tr(),
+                    textAlign: TextAlign.center,
+                    fontSize: 16,
+                    maxLines: 5,
+                  ),
+                ),
+          getPlatform() == PlatformOS.isIOS
+              ? SizedBox.shrink()
+              : SizedBox(height: 35),
+          getPlatform() == PlatformOS.isIOS
+              ? SizedBox.shrink()
+              : LowKeyButton(
+                  onTap: () {
+                    nextNavigation();
+                  },
+                  text: "continue-without-sign-in".tr(),
+                ),
           // IntrinsicWidth(
           //   child: Button(
           //     label: "Let's go!",
@@ -507,11 +531,16 @@ class OnBoardingPageBodyState extends State<OnBoardingPageBody> {
                       ],
                     ),
                     AnimatedOpacity(
-                      opacity: currentIndex >= children.length - 1 ? 0 : 1,
+                      opacity: getPlatform() == PlatformOS.isIOS
+                          ? 1
+                          : currentIndex >= children.length - 1
+                              ? 0
+                              : 1,
                       duration: Duration(milliseconds: 200),
                       child: ButtonIcon(
                         onTap: () {
-                          if (currentIndex < children.length - 1)
+                          if (currentIndex < children.length - 1 ||
+                              getPlatform() == PlatformOS.isIOS)
                             nextOnBoardPage(children.length);
                         },
                         icon: getPlatform() == PlatformOS.isIOS
diff --git a/budget/lib/pages/pastBudgetsPage.dart b/budget/lib/pages/pastBudgetsPage.dart
index e45c7c772..accfbcb7d 100644
--- a/budget/lib/pages/pastBudgetsPage.dart
+++ b/budget/lib/pages/pastBudgetsPage.dart
@@ -201,7 +201,7 @@ class __PastBudgetsPageContentState extends State<_PastBudgetsPageContent> {
     return PageFramework(
       backgroundColor: backgroundColor,
       key: budgetHistoryKey,
-      title: "budget-history".tr(),
+      title: "history".tr(),
       subtitle: Padding(
         padding: EdgeInsets.only(
             left: enableDoubleColumn(context) ? 0 : 20, bottom: 6),
@@ -1012,7 +1012,6 @@ class PastBudgetContainer extends StatelessWidget {
                                                 : budget.amount - totalSpent,
                                             duration:
                                                 Duration(milliseconds: 700),
-                                            dynamicDecimals: true,
                                             initialCount: (0),
                                             textBuilder: (number) {
                                               return TextFont(
@@ -1071,7 +1070,6 @@ class PastBudgetContainer extends StatelessWidget {
                                             ? totalSpent
                                             : -1 * (budget.amount - totalSpent),
                                         duration: Duration(milliseconds: 700),
-                                        dynamicDecimals: true,
                                         initialCount: (0),
                                         textBuilder: (number) {
                                           return TextFont(
@@ -1129,7 +1127,6 @@ class PastBudgetContainer extends StatelessWidget {
                                   ? 0
                                   : (totalSpent / budget.amount * 100),
                               duration: Duration(milliseconds: 1000),
-                              dynamicDecimals: false,
                               initialCount: (0),
                               textBuilder: (value) {
                                 return TextFont(
@@ -1279,7 +1276,6 @@ class CategoryAverageSpent extends StatelessWidget {
                             child: CountNumber(
                               count: (amountSpent / amountPeriods).abs(),
                               duration: Duration(milliseconds: 400),
-                              dynamicDecimals: true,
                               initialCount: (amountSpent / amountPeriods).abs(),
                               textBuilder: (number) {
                                 return TextFont(
@@ -1317,7 +1313,6 @@ class CategoryAverageSpent extends StatelessWidget {
               CountNumber(
                 count: amountSpent.abs(),
                 duration: Duration(milliseconds: 400),
-                dynamicDecimals: true,
                 initialCount: amountSpent.abs(),
                 textBuilder: (number) {
                   return TextFont(
diff --git a/budget/lib/pages/subscriptionsPage.dart b/budget/lib/pages/subscriptionsPage.dart
index a687dbf46..baa290998 100644
--- a/budget/lib/pages/subscriptionsPage.dart
+++ b/budget/lib/pages/subscriptionsPage.dart
@@ -87,7 +87,6 @@ class _SubscriptionsPageState extends State<SubscriptionsPage> {
                           return CountNumber(
                             count: total.abs(),
                             duration: Duration(milliseconds: 700),
-                            dynamicDecimals: true,
                             initialCount: (0),
                             textBuilder: (number) {
                               return TextFont(
diff --git a/budget/lib/pages/transactionsSearchPage.dart b/budget/lib/pages/transactionsSearchPage.dart
index b3c1b08c0..d6fbcb880 100644
--- a/budget/lib/pages/transactionsSearchPage.dart
+++ b/budget/lib/pages/transactionsSearchPage.dart
@@ -725,13 +725,17 @@ class _TransactionFiltersSelectionState
           builder: ((context, snapshot) {
             if (snapshot.hasData) {
               RangeValues rangeLimit = RangeValues(
-                  (snapshot.data?.start ?? 0) - 0.00000001,
-                  (snapshot.data?.end ?? 0) + 0.00000001);
+                  (snapshot.data?.start ?? -0.00000001),
+                  (snapshot.data?.end ?? 0.00000001));
               if ((selectedFilters.amountRange?.start ?? 0) <
                       rangeLimit.start ||
                   (selectedFilters.amountRange?.end ?? 0) > rangeLimit.end) {
                 selectedFilters.amountRange = rangeLimit;
               }
+              if (selectedFilters.amountRange?.end == rangeLimit.end &&
+                  selectedFilters.amountRange?.start == rangeLimit.start) {
+                selectedFilters.amountRange = null;
+              }
               return AmountRangeSlider(
                 rangeLimit: rangeLimit,
                 initialRange: selectedFilters.amountRange,
diff --git a/budget/lib/pages/upcomingOverdueTransactionsPage.dart b/budget/lib/pages/upcomingOverdueTransactionsPage.dart
index 22232b19b..9f7240589 100644
--- a/budget/lib/pages/upcomingOverdueTransactionsPage.dart
+++ b/budget/lib/pages/upcomingOverdueTransactionsPage.dart
@@ -137,7 +137,6 @@ class CenteredAmountAndNumTransactions extends StatelessWidget {
                   ? 0
                   : (snapshot.data ?? 0).abs(),
               duration: Duration(milliseconds: 700),
-              dynamicDecimals: true,
               initialCount: (0),
               textBuilder: (number) {
                 return TextFont(
diff --git a/budget/lib/struct/shareBudget.dart b/budget/lib/struct/shareBudget.dart
index d62f3dcf2..cdfc16929 100644
--- a/budget/lib/struct/shareBudget.dart
+++ b/budget/lib/struct/shareBudget.dart
@@ -337,8 +337,9 @@ Future<int> downloadTransactionsFromBudgets(
     Set<String> allMembersEver = {};
     Map<dynamic, dynamic> budgetDecoded = budget.data() as Map;
     await database.createOrUpdateFromSharedBudget(
+      insert: true,
       Budget(
-        budgetPk: DateTime.now().millisecondsSinceEpoch,
+        budgetPk: -1,
         name: budgetDecoded["name"],
         amount: budgetDecoded["amount"].toDouble(),
         colour: budgetDecoded["colour"],
@@ -400,8 +401,9 @@ Future<int> downloadTransactionsFromBudgets(
           int numberOfCategories =
               (await database.getTotalCountOfCategories())[0] ?? 0;
           await database.createOrUpdateCategory(
+            insert: true,
             TransactionCategory(
-              categoryPk: DateTime.now().millisecondsSinceEpoch,
+              categoryPk: -1,
               name: transactionDecoded["categoryName"],
               dateCreated: DateTime.now(),
               dateTimeModified: null,
@@ -417,8 +419,9 @@ Future<int> downloadTransactionsFromBudgets(
         }
 
         await database.createOrUpdateFromSharedTransaction(
+          insert: true,
           Transaction(
-            transactionPk: DateTime.now().millisecondsSinceEpoch,
+            transactionPk: -1,
             name: transactionDecoded["name"],
             amount: transactionDecoded["amount"].toDouble(),
             note: transactionDecoded["note"],
diff --git a/budget/lib/struct/upcomingTransactionsFunctions.dart b/budget/lib/struct/upcomingTransactionsFunctions.dart
index fa09c80e9..a22a91daa 100644
--- a/budget/lib/struct/upcomingTransactionsFunctions.dart
+++ b/budget/lib/struct/upcomingTransactionsFunctions.dart
@@ -42,11 +42,11 @@ createNewSubscriptionTransaction(context, Transaction transaction) async {
       );
       Transaction newTransaction = transaction.copyWith(
         paid: false,
-        transactionPk: DateTime.now().millisecondsSinceEpoch,
+        transactionPk: -1,
         dateCreated: newDate,
         createdAnotherFutureTransaction: Value(false),
       );
-      await database.createOrUpdateTransaction(newTransaction);
+      await database.createOrUpdateTransaction(insert: true, newTransaction);
 
       if (context != null) {
         openSnackbar(
diff --git a/budget/lib/widgets/SelectedTransactionsActionBar.dart b/budget/lib/widgets/SelectedTransactionsActionBar.dart
index 9b07bfe1f..4940c2e3e 100644
--- a/budget/lib/widgets/SelectedTransactionsActionBar.dart
+++ b/budget/lib/widgets/SelectedTransactionsActionBar.dart
@@ -89,7 +89,6 @@ class SelectedTransactionsActionBar extends StatelessWidget {
                                     count:
                                         snapshot.hasData ? snapshot.data! : 0,
                                     duration: Duration(milliseconds: 250),
-                                    dynamicDecimals: true,
                                     initialCount: (0),
                                     textBuilder: (number) {
                                       return Wrap(
@@ -124,7 +123,6 @@ class SelectedTransactionsActionBar extends StatelessWidget {
                                                         snapshot.hasData
                                                             ? snapshot.data!
                                                             : 0,
-                                                    showCurrency: false,
                                                   ),
                                                 );
                                               },
diff --git a/budget/lib/widgets/accountAndBackup.dart b/budget/lib/widgets/accountAndBackup.dart
index 80faa316b..2fa5fc39e 100644
--- a/budget/lib/widgets/accountAndBackup.dart
+++ b/budget/lib/widgets/accountAndBackup.dart
@@ -505,6 +505,25 @@ class _GoogleAccountLoginButtonState extends State<GoogleAccountLoginButton> {
   @override
   Widget build(BuildContext context) {
     Function login = () async {
+      dynamic result = true;
+      if (getPlatform() == PlatformOS.isIOS) {
+        result = await openPopup(
+          context,
+          icon: Icons.badge_rounded,
+          title: "google-login".tr(),
+          description: "google-login-apple-disclaimer".tr(),
+          onSubmitLabel: "continue".tr(),
+          onSubmit: () {
+            Navigator.pop(context, true);
+          },
+          onCancel: () {
+            Navigator.pop(context);
+          },
+          onCancelLabel: "cancel".tr(),
+        );
+      }
+
+      if (result != true) return;
       loadingIndeterminateKey.currentState!.setVisibility(true);
       try {
         await signInGoogle(
diff --git a/budget/lib/widgets/bottomNavBar.dart b/budget/lib/widgets/bottomNavBar.dart
index 18b28e4b6..6d47c2b83 100644
--- a/budget/lib/widgets/bottomNavBar.dart
+++ b/budget/lib/widgets/bottomNavBar.dart
@@ -4,6 +4,7 @@ import 'package:budget/widgets/fadeIn.dart';
 import 'package:budget/widgets/moreIcons.dart';
 import 'package:budget/widgets/navigationFramework.dart';
 import 'package:budget/widgets/openBottomSheet.dart';
+import 'package:budget/widgets/framework/pageFramework.dart';
 import 'package:easy_localization/easy_localization.dart';
 import 'package:flutter/material.dart';
 import 'package:budget/colors.dart';
@@ -45,55 +46,57 @@ class BottomNavBarState extends State<BottomNavBar> {
   Widget build(BuildContext context) {
     if (getIsFullScreen(context)) return SizedBox.shrink();
     if (getPlatform() == PlatformOS.isIOS) {
-      return Container(
-        decoration: BoxDecoration(
-          color: getColor(context, "lightDarkAccent"),
-          boxShadow: boxShadowSharp(context),
-        ),
-        child: Column(
-          crossAxisAlignment: CrossAxisAlignment.end,
-          mainAxisAlignment: MainAxisAlignment.end,
-          mainAxisSize: MainAxisSize.min,
-          children: [
-            Container(
-              padding: EdgeInsets.symmetric(horizontal: 25, vertical: 2),
-              child: Column(
-                children: [
-                  Row(
-                    mainAxisAlignment: MainAxisAlignment.spaceEvenly,
-                    children: [
-                      NavBarIcon(
-                        onItemTapped: onItemTapped,
-                        icon: Icons.home_rounded,
-                        index: 0,
-                        currentIndex: selectedIndex,
-                      ),
-                      NavBarIcon(
-                        onItemTapped: onItemTapped,
-                        icon: Icons.payments_rounded,
-                        index: 1,
-                        currentIndex: selectedIndex,
-                      ),
-                      NavBarIcon(
-                        onItemTapped: onItemTapped,
-                        icon: MoreIcons.chart_pie,
-                        index: 2,
-                        currentIndex: selectedIndex,
-                        customIconScale: 0.87,
-                      ),
-                      NavBarIcon(
-                        onItemTapped: onItemTapped,
-                        icon: Icons.more_horiz_rounded,
-                        index: 3,
-                        currentIndex: selectedIndex,
-                      ),
-                    ],
-                  ),
-                  SizedBox(height: MediaQuery.of(context).padding.bottom)
-                ],
-              ),
-            )
-          ],
+      return BlurBehindAppBar(
+        child: Container(
+          decoration: BoxDecoration(
+            color: getColor(context, "lightDarkAccent").withOpacity(0.6),
+            boxShadow: boxShadowSharp(context),
+          ),
+          child: Column(
+            crossAxisAlignment: CrossAxisAlignment.end,
+            mainAxisAlignment: MainAxisAlignment.end,
+            mainAxisSize: MainAxisSize.min,
+            children: [
+              Container(
+                padding: EdgeInsets.symmetric(horizontal: 25, vertical: 2),
+                child: Column(
+                  children: [
+                    Row(
+                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,
+                      children: [
+                        NavBarIcon(
+                          onItemTapped: onItemTapped,
+                          icon: Icons.home_rounded,
+                          index: 0,
+                          currentIndex: selectedIndex,
+                        ),
+                        NavBarIcon(
+                          onItemTapped: onItemTapped,
+                          icon: Icons.payments_rounded,
+                          index: 1,
+                          currentIndex: selectedIndex,
+                        ),
+                        NavBarIcon(
+                          onItemTapped: onItemTapped,
+                          icon: MoreIcons.chart_pie,
+                          index: 2,
+                          currentIndex: selectedIndex,
+                          customIconScale: 0.87,
+                        ),
+                        NavBarIcon(
+                          onItemTapped: onItemTapped,
+                          icon: Icons.more_horiz_rounded,
+                          index: 3,
+                          currentIndex: selectedIndex,
+                        ),
+                      ],
+                    ),
+                    SizedBox(height: MediaQuery.of(context).padding.bottom)
+                  ],
+                ),
+              )
+            ],
+          ),
         ),
       );
     }
@@ -220,16 +223,10 @@ class NavBarIcon extends StatelessWidget {
                     shape: BoxShape.circle,
                     color: Theme.of(context).brightness == Brightness.dark
                         ? Theme.of(context).colorScheme.secondaryContainer
-                        : appStateSettings["materialYou"]
-                            ? dynamicPastel(
-                                context,
-                                Theme.of(context)
-                                    .colorScheme
-                                    .secondaryContainer,
-                                inverse: true,
-                                amount: 0.13,
-                              )
-                            : Theme.of(context).colorScheme.secondaryContainer,
+                        : Theme.of(context)
+                            .colorScheme
+                            .secondary
+                            .withOpacity(0.3),
                   ),
                   height: 52,
                   width: 52,
diff --git a/budget/lib/widgets/budgetContainer.dart b/budget/lib/widgets/budgetContainer.dart
index 8d2184677..0c4ef024a 100644
--- a/budget/lib/widgets/budgetContainer.dart
+++ b/budget/lib/widgets/budgetContainer.dart
@@ -131,7 +131,6 @@ class BudgetContainer extends StatelessWidget {
                                                   : budget.amount - totalSpent,
                                               duration:
                                                   Duration(milliseconds: 700),
-                                              dynamicDecimals: true,
                                               initialCount: (0),
                                               textBuilder: (number) {
                                                 return TextFont(
@@ -194,7 +193,6 @@ class BudgetContainer extends StatelessWidget {
                                                           totalSpent),
                                               duration:
                                                   Duration(milliseconds: 700),
-                                              dynamicDecimals: true,
                                               initialCount: (0),
                                               textBuilder: (number) {
                                                 return TextFont(
diff --git a/budget/lib/widgets/budgetHistoryLineGraph.dart b/budget/lib/widgets/budgetHistoryLineGraph.dart
index b6357ff97..1304ff234 100644
--- a/budget/lib/widgets/budgetHistoryLineGraph.dart
+++ b/budget/lib/widgets/budgetHistoryLineGraph.dart
@@ -1,7 +1,6 @@
 import 'package:budget/colors.dart';
 import 'package:budget/database/tables.dart';
 import 'package:budget/functions.dart';
-import 'package:budget/widgets/navigationSidebar.dart';
 import 'package:budget/widgets/openBottomSheet.dart';
 import 'package:budget/widgets/textWidgets.dart';
 import 'package:easy_localization/easy_localization.dart';
@@ -126,7 +125,7 @@ class _BudgetHistoryLineGraphState extends State<BudgetHistoryLineGraph> {
               return FlDotCirclePainter(
                 radius: 3,
                 color: lightenPastel(
-                        HexColor(widget.categoriesMapped[categoryPk]!.colour),
+                        HexColor(widget.categoriesMapped[categoryPk]?.colour),
                         amount: 0.3)
                     .withOpacity(0.6),
                 strokeWidth: 0,
@@ -134,7 +133,7 @@ class _BudgetHistoryLineGraphState extends State<BudgetHistoryLineGraph> {
             },
           ),
           color: lightenPastel(
-                  HexColor(widget.categoriesMapped[categoryPk]!.colour),
+                  HexColor(widget.categoriesMapped[categoryPk]?.colour),
                   amount: 0.3)
               .withOpacity(0.8),
         ),
diff --git a/budget/lib/widgets/categoryLimits.dart b/budget/lib/widgets/categoryLimits.dart
index 839b179e4..79dd73b4f 100644
--- a/budget/lib/widgets/categoryLimits.dart
+++ b/budget/lib/widgets/categoryLimits.dart
@@ -62,7 +62,6 @@ class _CategoryLimitsState extends State<CategoryLimits> {
                   return CountNumber(
                     count: snapshot.data ?? 0,
                     duration: Duration(milliseconds: 700),
-                    dynamicDecimals: true,
                     initialCount: (0),
                     textBuilder: (number) {
                       return TextFont(
@@ -358,8 +357,9 @@ void enterCategoryLimitPopup(
     }
   } else if (categoryLimit == null) {
     database.createOrUpdateCategoryLimit(
+      insert: true,
       CategoryBudgetLimit(
-        categoryLimitPk: DateTime.now().millisecondsSinceEpoch,
+        categoryLimitPk: -1,
         categoryFk: category.categoryPk,
         budgetFk: budgetPk,
         amount: amount,
diff --git a/budget/lib/widgets/countNumber.dart b/budget/lib/widgets/countNumber.dart
index b4e4edc4b..21391cac5 100644
--- a/budget/lib/widgets/countNumber.dart
+++ b/budget/lib/widgets/countNumber.dart
@@ -4,7 +4,6 @@ import 'package:budget/database/tables.dart';
 import 'package:budget/struct/settings.dart';
 import 'package:budget/widgets/textWidgets.dart';
 import 'package:flutter/material.dart';
-import 'dart:async';
 
 import 'package:provider/provider.dart';
 
@@ -55,7 +54,6 @@ class _CountUpState extends State<CountUp> {
         textAlign: widget.textAlign,
         textColor: widget.textColor,
         maxLines: widget.maxLines,
-        walletPkForCurrency: widget.walletPkForCurrency,
       );
     }
     return TweenAnimationBuilder<int>(
@@ -81,7 +79,6 @@ class _CountUpState extends State<CountUp> {
           textAlign: widget.textAlign,
           textColor: widget.textColor,
           maxLines: widget.maxLines,
-          walletPkForCurrency: widget.walletPkForCurrency,
         );
       },
     );
@@ -98,7 +95,6 @@ class CountNumber extends StatefulWidget {
     this.curve = Curves.easeOutQuint,
     this.initialCount = 0,
     this.decimals,
-    this.dynamicDecimals = false,
     this.lazyFirstRender = true,
   }) : super(key: key);
 
@@ -109,7 +105,6 @@ class CountNumber extends StatefulWidget {
   final Curve curve;
   final double initialCount;
   final int? decimals;
-  final bool dynamicDecimals;
   final bool lazyFirstRender;
 
   @override
@@ -117,73 +112,45 @@ class CountNumber extends StatefulWidget {
 }
 
 class _CountNumberState extends State<CountNumber> {
-  int finalDecimalPlaces = 2;
-  double previousAmount = 0;
-  int decimals = 2;
-  bool lazyFirstRender = true;
-  @override
-  void initState() {
-    super.initState();
-    Future.delayed(Duration.zero, () {
-      if (mounted)
-        setState(() {
-          int currentSelectedDecimals =
-              Provider.of<AllWallets>(context, listen: false)
-                      .indexedByPk[appStateSettings["selectedWallet"]]
-                      ?.decimals ??
-                  2;
-          finalDecimalPlaces = ((widget.decimals ?? currentSelectedDecimals) > 2
-              ? widget.count.toString().split('.')[1].length <
-                      (widget.decimals ?? currentSelectedDecimals)
-                  ? widget.count.toString().split('.')[1].length
-                  : (widget.decimals ?? currentSelectedDecimals)
-              : (widget.decimals ?? currentSelectedDecimals));
-          previousAmount = widget.initialCount;
-          decimals = finalDecimalPlaces;
-          lazyFirstRender = widget.lazyFirstRender;
-        });
-    });
-  }
+  late double previousAmount = widget.initialCount;
+  late bool lazyFirstRender = widget.lazyFirstRender;
 
   @override
   Widget build(BuildContext context) {
-    if (widget.dynamicDecimals) {
-      if (widget.count % 1 == 0) {
-        decimals = 0;
-      } else {
-        int currentSelectedDecimals = Provider.of<AllWallets>(context)
-                .indexedByPk[appStateSettings["selectedWallet"]]
-                ?.decimals ??
-            2;
-        decimals = ((widget.decimals ?? currentSelectedDecimals) > 2
-            ? widget.count.toString().split('.')[1].length <
-                    (widget.decimals ?? currentSelectedDecimals)
-                ? widget.count.toString().split('.')[1].length
-                : (widget.decimals ?? currentSelectedDecimals)
-            : (widget.decimals ?? currentSelectedDecimals));
-      }
+    int decimals = 0;
+
+    if (widget.count % 1 == 0) {
+      decimals = 0;
+    } else {
+      int currentSelectedDecimals = Provider.of<AllWallets>(context)
+              .indexedByPk[appStateSettings["selectedWallet"]]
+              ?.decimals ??
+          2;
+      decimals = ((widget.decimals ?? currentSelectedDecimals) > 2
+          ? widget.count.toString().split('.')[1].length <
+                  (widget.decimals ?? currentSelectedDecimals)
+              ? widget.count.toString().split('.')[1].length
+              : (widget.decimals ?? currentSelectedDecimals)
+          : (widget.decimals ?? currentSelectedDecimals));
     }
 
     if (appStateSettings["batterySaver"]) {
-      return widget.textBuilder(
-        double.parse((widget.count).toStringAsFixed(finalDecimalPlaces)),
-      );
+      return widget.textBuilder(widget.count);
     }
 
     if (lazyFirstRender && widget.initialCount == widget.count) {
       lazyFirstRender = false;
       return widget.textBuilder(
-        double.parse((widget.count).toStringAsFixed(finalDecimalPlaces)),
+        double.parse((widget.count).toStringAsFixed(decimals)),
       );
     }
 
     Widget builtWidget = TweenAnimationBuilder<int>(
       tween: IntTween(
-        begin: (double.parse(
-                    (previousAmount).toStringAsFixed(finalDecimalPlaces)) *
+        begin: (double.parse((previousAmount).toStringAsFixed(decimals)) *
                 pow(10, decimals))
             .toInt(),
-        end: (double.parse((widget.count).toStringAsFixed(finalDecimalPlaces)) *
+        end: (double.parse((widget.count).toStringAsFixed(decimals)) *
                 pow(10, decimals))
             .toInt(),
       ),
diff --git a/budget/lib/widgets/dropdownSelect.dart b/budget/lib/widgets/dropdownSelect.dart
index fdb73d731..cbc2299e4 100644
--- a/budget/lib/widgets/dropdownSelect.dart
+++ b/budget/lib/widgets/dropdownSelect.dart
@@ -113,3 +113,114 @@ class DropdownSelectState extends State<DropdownSelect> {
     );
   }
 }
+
+class DropdownItemMenu {
+  final String id;
+  final String label;
+  final IconData icon;
+  final Function action;
+
+  DropdownItemMenu({
+    required this.id,
+    required this.label,
+    required this.icon,
+    required this.action,
+  });
+}
+
+class CustomPopupMenuButton extends StatelessWidget {
+  final List<DropdownItemMenu> items;
+  final EdgeInsetsGeometry padding;
+  final ShapeBorder shape;
+  final bool showButtons;
+  final bool keepOutFirst;
+
+  CustomPopupMenuButton({
+    required this.items,
+    this.padding = const EdgeInsets.all(15),
+    this.shape = const RoundedRectangleBorder(
+      borderRadius: BorderRadius.all(
+        Radius.circular(10),
+      ),
+    ),
+    this.showButtons = false,
+    this.keepOutFirst = true,
+  });
+
+  @override
+  Widget build(BuildContext context) {
+    List<DropdownItemMenu> itemsFiltered = [...items];
+    if (keepOutFirst) itemsFiltered.removeAt(0);
+
+    if (showButtons) {
+      return Row(
+        children: [
+          ...(items).asMap().entries.map((item) {
+            int idx = item.key;
+            int length = items.length;
+            double offsetX = (length - 1 - idx) * 7;
+            return Transform.translate(
+              offset: Offset(offsetX, 0),
+              child: IconButton(
+                padding: EdgeInsets.all(15),
+                onPressed: () {
+                  item.value.action();
+                },
+                icon: Icon(
+                  item.value.icon,
+                ),
+              ),
+            );
+          })
+        ],
+      );
+    }
+
+    return Row(
+      children: [
+        if (keepOutFirst)
+          Transform.translate(
+            offset: Offset(7, 0),
+            child: IconButton(
+              padding: EdgeInsets.all(15),
+              onPressed: () {
+                items[0].action();
+              },
+              icon: Icon(
+                items[0].icon,
+              ),
+            ),
+          ),
+        PopupMenuButton<String>(
+          padding: padding,
+          shape: shape,
+          onSelected: (value) {
+            for (DropdownItemMenu item in items) {
+              if (item.id == value) {
+                item.action();
+                break;
+              }
+            }
+          },
+          itemBuilder: (BuildContext context) {
+            return itemsFiltered.map((item) {
+              return PopupMenuItem<String>(
+                value: item.id,
+                child: Row(
+                  children: [
+                    Icon(item.icon),
+                    SizedBox(width: 7),
+                    Text(
+                      item.label,
+                      style: TextStyle(fontSize: 14.5),
+                    ),
+                  ],
+                ),
+              );
+            }).toList();
+          },
+        ),
+      ],
+    );
+  }
+}
diff --git a/budget/lib/widgets/framework/pageFramework.dart b/budget/lib/widgets/framework/pageFramework.dart
index fa62e117f..1a2d9c892 100644
--- a/budget/lib/widgets/framework/pageFramework.dart
+++ b/budget/lib/widgets/framework/pageFramework.dart
@@ -6,6 +6,7 @@ import 'package:budget/struct/settings.dart';
 import 'package:budget/struct/shareBudget.dart';
 import 'package:budget/widgets/button.dart';
 import 'package:budget/widgets/navigationSidebar.dart';
+import 'package:budget/widgets/openBottomSheet.dart';
 import 'package:budget/widgets/scrollbarWrap.dart';
 import 'package:budget/widgets/textWidgets.dart';
 import 'package:budget/widgets/transactionEntry/swipeToSelectTransactions.dart';
@@ -633,7 +634,10 @@ class PageFrameworkSliverAppBar extends StatelessWidget {
                   scale: percent * 0.15 + 1,
                   child: titleWidget ??
                       TextFont(
-                        text: title,
+                        text: getIsFullScreen(context) == false &&
+                                title.length > 20
+                            ? title.split(" ")[0]
+                            : title,
                         fontSize: 22,
                         fontWeight: FontWeight.bold,
                         textColor: textColor == null
diff --git a/budget/lib/widgets/framework/popupFramework.dart b/budget/lib/widgets/framework/popupFramework.dart
index a730a5d5d..329e1de95 100644
--- a/budget/lib/widgets/framework/popupFramework.dart
+++ b/budget/lib/widgets/framework/popupFramework.dart
@@ -38,52 +38,54 @@ class PopupFramework extends StatelessWidget {
             children: [
               Container(height: 17),
               getPlatform() == PlatformOS.isIOS
-                  ? Row(
-                      crossAxisAlignment: CrossAxisAlignment.start,
-                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
+                  ? Stack(
+                      alignment: Alignment.topLeft,
                       children: [
-                        Expanded(
-                          child: Column(
-                            crossAxisAlignment: CrossAxisAlignment.center,
-                            mainAxisAlignment: MainAxisAlignment.center,
-                            mainAxisSize: MainAxisSize.min,
-                            children: [
-                              title == null
-                                  ? SizedBox.shrink()
-                                  : Padding(
-                                      padding:
-                                          EdgeInsets.symmetric(horizontal: 18),
-                                      child: TextFont(
-                                        text: title ?? "",
-                                        fontSize: 23,
-                                        fontWeight: FontWeight.bold,
-                                        maxLines: 5,
-                                        textAlign: TextAlign.center,
-                                      ),
+                        Column(
+                          crossAxisAlignment: CrossAxisAlignment.center,
+                          mainAxisAlignment: MainAxisAlignment.center,
+                          mainAxisSize: MainAxisSize.min,
+                          children: [
+                            title == null
+                                ? SizedBox.shrink()
+                                : Padding(
+                                    padding:
+                                        EdgeInsets.symmetric(horizontal: 18),
+                                    child: TextFont(
+                                      text: title ?? "",
+                                      fontSize: 23,
+                                      fontWeight: FontWeight.bold,
+                                      maxLines: 5,
+                                      textAlign: TextAlign.center,
                                     ),
-                              subtitle == null
-                                  ? SizedBox.shrink()
-                                  : Padding(
-                                      padding:
-                                          EdgeInsets.symmetric(horizontal: 18),
-                                      child: TextFont(
-                                        text: subtitle ?? "",
-                                        fontSize: 14,
-                                        maxLines: 5,
-                                        textAlign: TextAlign.center,
-                                      ),
+                                  ),
+                            subtitle == null
+                                ? SizedBox.shrink()
+                                : Padding(
+                                    padding:
+                                        EdgeInsets.symmetric(horizontal: 18),
+                                    child: TextFont(
+                                      text: subtitle ?? "",
+                                      fontSize: 14,
+                                      maxLines: 5,
+                                      textAlign: TextAlign.center,
                                     ),
-                              Container(
-                                height: 1.5,
-                                color: Theme.of(context)
-                                    .colorScheme
-                                    .secondaryContainer,
-                                margin: EdgeInsets.only(top: 10, bottom: 5),
-                              )
-                            ],
-                          ),
+                                  ),
+                            Container(
+                              height: 1.5,
+                              color: Theme.of(context)
+                                  .colorScheme
+                                  .secondaryContainer,
+                              margin: EdgeInsets.only(top: 10, bottom: 5),
+                            )
+                          ],
                         ),
-                        icon ?? SizedBox.shrink()
+                        Padding(
+                          padding: const EdgeInsets.only(
+                            left: 10,
+                          ),
+                          child: icon ?? SizedBox.shrink(),
+                        )
                       ],
                     )
                   : Padding(
diff --git a/budget/lib/widgets/importCSV.dart b/budget/lib/widgets/importCSV.dart
index deb5d5dd5..d71f23606 100644
--- a/budget/lib/widgets/importCSV.dart
+++ b/budget/lib/widgets/importCSV.dart
@@ -494,9 +494,6 @@ class _ImportingEntriesPopupState extends State<ImportingEntriesPopup> {
 
   Future<void> _importEntry(Map<String, Map<String, dynamic>> assignedColumns,
       String dateFormat, List<String> row, int i) async {
-    int transactionPk = 0;
-    transactionPk = DateTime.now().millisecondsSinceEpoch;
-
     String name = "";
     if (assignedColumns["name"]!["setHeaderIndex"] != -1) {
       name = row[assignedColumns["name"]!["setHeaderIndex"]].toString();
@@ -537,8 +534,9 @@ class _ImportingEntriesPopupState extends State<ImportingEntriesPopup> {
       int numberOfCategories =
           (await database.getTotalCountOfCategories())[0] ?? 0;
       await database.createOrUpdateCategory(
+        insert: true,
         TransactionCategory(
-          categoryPk: DateTime.now().millisecondsSinceEpoch,
+          categoryPk: -1,
           name: row[assignedColumns["category"]!["setHeaderIndex"]],
           dateCreated: DateTime.now(),
           dateTimeModified: null,
@@ -598,8 +596,9 @@ class _ImportingEntriesPopupState extends State<ImportingEntriesPopup> {
     bool income = amount > 0;
 
     await database.createOrUpdateTransaction(
+      insert: true,
       Transaction(
-        transactionPk: transactionPk,
+        transactionPk: -1,
         name: name,
         amount: amount,
         note: note,
diff --git a/budget/lib/widgets/navigationFramework.dart b/budget/lib/widgets/navigationFramework.dart
index 2c0a2d14e..d21483911 100644
--- a/budget/lib/widgets/navigationFramework.dart
+++ b/budget/lib/widgets/navigationFramework.dart
@@ -276,7 +276,9 @@ class PageNavigationFrameworkState extends State<PageNavigationFramework> {
                 bottom: (getIsFullScreen(context) == false
                         ? 75 +
                             MediaQuery.of(context).viewPadding.bottom -
-                            (MediaQuery.of(context).viewPadding.bottom > 10
+                            (getPlatform() != PlatformOS.isIOS &&
+                                    MediaQuery.of(context).viewPadding.bottom >
+                                        10
                                 ? 10
                                 : 0)
                         : 15 + MediaQuery.of(context).viewPadding.bottom) +
diff --git a/budget/lib/widgets/openPopup.dart b/budget/lib/widgets/openPopup.dart
index 2d4d8954d..71bae8b11 100644
--- a/budget/lib/widgets/openPopup.dart
+++ b/budget/lib/widgets/openPopup.dart
@@ -376,24 +376,29 @@ Future<T?> openLoadingPopup<T extends Object?>(context) {
 }
 
 void discardChangesPopup(context,
-    {previousObject, currentObject, Function? onDiscard}) async {
+    {previousObject,
+    currentObject,
+    Function? onDiscard,
+    bool forceShow = false}) async {
   print(previousObject);
   print(currentObject);
 
-  if (previousObject == currentObject &&
+  if (forceShow == false &&
+      previousObject == currentObject &&
       previousObject != null &&
       currentObject != null) {
     Navigator.pop(context);
     return;
   }
-  if (previousObject == null) {
+  if (forceShow == false && previousObject == null) {
     Navigator.pop(context);
     return;
   }
 
   previousObject = previousObject?.copyWith(dateTimeModified: Value(null));
 
-  if (previousObject != null &&
+  if (forceShow == false &&
+      previousObject != null &&
       currentObject != null &&
       previousObject.toString() == currentObject.toString()) {
     print(previousObject.toString());
diff --git a/budget/lib/widgets/selectAmount.dart b/budget/lib/widgets/selectAmount.dart
index 6d8ffbfd7..3a221877a 100644
--- a/budget/lib/widgets/selectAmount.dart
+++ b/budget/lib/widgets/selectAmount.dart
@@ -1,3 +1,6 @@
+import 'dart:io';
+import 'dart:math';
+
 import 'package:budget/database/tables.dart';
 import 'package:budget/functions.dart';
 import 'package:budget/pages/addCategoryPage.dart';
@@ -14,11 +17,17 @@ import 'package:budget/widgets/util/contextMenu.dart';
 import 'package:easy_localization/easy_localization.dart';
 import 'package:flutter/material.dart';
 import 'package:flutter/services.dart';
+import 'package:intl/number_symbols_data.dart';
 import 'package:math_expressions/math_expressions.dart';
 import 'package:budget/colors.dart';
 import 'package:provider/provider.dart';
 import 'package:budget/struct/currencyFunctions.dart';
 
+String getDecimalSeparator() {
+  return numberFormatSymbols[Platform.localeName.split("-")[0]]?.DECIMAL_SEP ??
+      ".";
+}
+
 class SelectAmount extends StatefulWidget {
   SelectAmount({
     Key? key,
@@ -197,6 +206,8 @@ class _SelectAmountState extends State<SelectAmount> {
       } else if (keyIsPressed &&
           event.logicalKey == LogicalKeyboardKey.numpadDecimal) {
         addToAmount(".");
+      } else if (keyIsPressed && event.logicalKey == LogicalKeyboardKey.comma) {
+        addToAmount(".");
       } else if (keyIsPressed &&
           event.logicalKey == LogicalKeyboardKey.backspace) {
         removeToAmount();
@@ -402,34 +413,25 @@ class _SelectAmountState extends State<SelectAmount> {
   @override
   Widget build(BuildContext context) {
     _focusAttachment.reparent();
-    String amountConverted = amount == ""
-        ? "0"
-        : numberDecimals > 2
-            ? includesOperations(amount, false)
-                ? calculateResult(amount).toString()
-                : amount
-            : includesOperations(amount, false)
-                ? convertToMoney(
-                    Provider.of<AllWallets>(context), calculateResult(amount),
-                    showCurrency: false)
-                : convertToMoney(
-                        Provider.of<AllWallets>(context),
-                        double.tryParse(
-                                amount.substring(amount.length - 1) == "." ||
-                                        (amount.length > numberDecimals &&
-                                            amount.substring(amount.length -
-                                                    numberDecimals) ==
-                                                ".0")
-                                    ? amount.substring(0, amount.length - 1)
-                                    : amount) ??
-                            0,
-                        showCurrency: false) +
-                    (amount.substring(amount.length - 1) == "." ? "." : "") +
-                    (amount.length > numberDecimals &&
-                            amount.substring(amount.length - numberDecimals) ==
-                                ".0"
-                        ? ".0"
-                        : "");
+    String amountConverted = amount;
+    if (amountConverted == "") amountConverted = "0";
+    amountConverted = convertToMoney(
+      Provider.of<AllWallets>(context),
+      calculateResult(amountConverted),
+      currencyKey: selectedWallet?.currency,
+      allDecimals: true,
+      decimals:
+          selectedWallet?.decimals == 2 && includesOperations(amount, true)
+              ? 2
+              : min(
+                  selectedWallet?.decimals ?? 1000,
+                  includesOperations(amount, false)
+                      ? countDecimalDigits(
+                          calculateResult(amountConverted).toString())
+                      : countDecimalDigits(amount),
+                ),
+    );
+    amountConverted = amountConverted.replaceAll(".", getDecimalSeparator());
     return Column(
       children: [
         Center(
@@ -464,7 +466,7 @@ class _SelectAmountState extends State<SelectAmount> {
                     AnimatedSwitcher(
                       duration: Duration(milliseconds: 200),
                       child: FractionallySizedBox(
-                        key: ValueKey(amountConverted),
+                        key: ValueKey(amount),
                         widthFactor: 0.5,
                         child: Row(
                           mainAxisAlignment: MainAxisAlignment.end,
@@ -505,12 +507,7 @@ class _SelectAmountState extends State<SelectAmount> {
                                       autoSizeText: true,
                                       maxLines: 1,
                                       minFontSize: 16,
-                                      walletPkForCurrency:
-                                          walletPkForCurrency ??
-                                              appStateSettings[
-                                                  "selectedWallet"],
-                                      onlyShowCurrencyIcon:
-                                          widget.onlyShowCurrencyIcon,
+
                                       text: amountConverted,
                                       // text: amount,
                                       textAlign: TextAlign.right,
@@ -532,7 +529,7 @@ class _SelectAmountState extends State<SelectAmount> {
                                       padding: const EdgeInsets.symmetric(
                                           vertical: 3.0),
                                       child: AnimatedSize(
-                                        duration: Duration(milliseconds: 600),
+                                        duration: Duration(milliseconds: 300),
                                         curve: Curves.easeInOutCubicEmphasized,
                                         child: AnimatedSwitcher(
                                           duration: Duration(milliseconds: 200),
@@ -555,6 +552,8 @@ class _SelectAmountState extends State<SelectAmount> {
                                                   key: ValueKey(1),
                                                 )
                                               : Tappable(
+                                                  key: ValueKey(
+                                                      selectedWallet?.walletPk),
                                                   color: Theme.of(context)
                                                       .colorScheme
                                                       .secondaryContainer,
@@ -727,6 +726,20 @@ class _SelectAmountState extends State<SelectAmount> {
                                   wallet.currency.toString().toUpperCase() +
                                   ")";
                         },
+                        getCustomBorderColor: (TransactionWallet item) {
+                          return dynamicPastel(
+                            context,
+                            lightenPastel(
+                              HexColor(
+                                item.colour,
+                                defaultColor:
+                                    Theme.of(context).colorScheme.primary,
+                              ),
+                              amount: 0.3,
+                            ),
+                            amount: 0.4,
+                          );
+                        },
                         extraWidget: AddButton(
                           onTap: () {},
                           width: 40,
@@ -835,7 +848,7 @@ class _SelectAmountState extends State<SelectAmount> {
                           children: [
                             CalculatorButton(
                               disabled: !canChange(),
-                              label: ".",
+                              label: getDecimalSeparator(),
                               editAmount: () {
                                 addToAmount(".");
                               },
@@ -1088,6 +1101,8 @@ class _SelectAmountValueState extends State<SelectAmountValue> {
       } else if (keyIsPressed &&
           event.logicalKey == LogicalKeyboardKey.numpadDecimal) {
         addToAmount(".");
+      } else if (keyIsPressed && event.logicalKey == LogicalKeyboardKey.comma) {
+        addToAmount(".");
       } else if (keyIsPressed &&
           event.logicalKey == LogicalKeyboardKey.backspace) {
         removeToAmount();
@@ -1152,6 +1167,7 @@ class _SelectAmountValueState extends State<SelectAmountValue> {
   @override
   Widget build(BuildContext context) {
     _focusAttachment.reparent();
+    String amountConverted = amount.replaceAll(".", getDecimalSeparator());
     return Column(
       crossAxisAlignment: CrossAxisAlignment.end,
       children: [
@@ -1166,7 +1182,7 @@ class _SelectAmountValueState extends State<SelectAmountValue> {
                 autoSizeText: true,
                 maxLines: 1,
                 minFontSize: 16,
-                text: amount + widget.suffix,
+                text: amountConverted + widget.suffix,
                 textAlign: TextAlign.right,
                 fontSize: 35,
                 fontWeight: FontWeight.bold,
@@ -1239,7 +1255,7 @@ class _SelectAmountValueState extends State<SelectAmountValue> {
         Row(
           children: [
             CalculatorButton(
-              label: ".",
+              label: getDecimalSeparator(),
               editAmount: () {
                 addToAmount(".");
               },
diff --git a/budget/lib/widgets/selectCategory.dart b/budget/lib/widgets/selectCategory.dart
index b237ecdb7..560147883 100644
--- a/budget/lib/widgets/selectCategory.dart
+++ b/budget/lib/widgets/selectCategory.dart
@@ -30,6 +30,7 @@ class SelectCategory extends StatefulWidget {
     this.addButton = true,
     this.scaleWhenSelected = false,
     this.categoryFks,
+    this.hideCategoryFks,
   }) : super(key: key);
   final Function(TransactionCategory)? setSelectedCategory;
   final Function(List<int>)? setSelectedCategories;
@@ -45,6 +46,7 @@ class SelectCategory extends StatefulWidget {
   final bool addButton;
   final bool scaleWhenSelected;
   final List<int>? categoryFks;
+  final List<int>? hideCategoryFks;
 
   @override
   _SelectCategoryState createState() => _SelectCategoryState();
@@ -118,6 +120,9 @@ class _SelectCategoryState extends State<SelectCategory> {
                 if (widget.categoryFks != null &&
                     !widget.categoryFks!.contains(category.categoryPk)) {
                   continue;
+                } else if (widget.hideCategoryFks != null &&
+                    widget.hideCategoryFks!.contains(category.categoryPk)) {
+                  continue;
                 }
 
                 children.add(AnimatedScale(
@@ -288,6 +293,9 @@ class _SelectCategoryState extends State<SelectCategory> {
               if (widget.categoryFks != null &&
                   !widget.categoryFks!.contains(category.categoryPk)) {
                 continue;
+              } else if (widget.hideCategoryFks != null &&
+                  widget.hideCategoryFks!.contains(category.categoryPk)) {
+                continue;
               }
               categoryIcons.add(
                 AnimatedScale(
diff --git a/budget/lib/widgets/showChangelog.dart b/budget/lib/widgets/showChangelog.dart
index f41d479a9..62e67345c 100644
--- a/budget/lib/widgets/showChangelog.dart
+++ b/budget/lib/widgets/showChangelog.dart
@@ -10,6 +10,18 @@ import 'package:flutter/material.dart';
 
 Future<void> showChangelog(context, {forceShow = false}) async {
   String changelog = """
+    < 3.7.4
+    Improved decimal precisions and support for comma locale
+    Fixed animations in enter amount
+    Added border color to wallet pickers
+    iOS homepage scroll animation fix
+    Fixed amount range filters getting added on first open
+    Spending goals moved to separate page
+    New dropdown menu actions for app bar
+    Fixed merge category
+    Google login warning on iOS
+    Add element to database key generation uses auto increment
+    Done for: wallets, budgets, transactions, categories, titles, scanner templates
     < 3.7.3
     Edit row action button animated scale switcher
     iOS notification configurations
diff --git a/budget/lib/widgets/textWidgets.dart b/budget/lib/widgets/textWidgets.dart
index 5b78c44c7..aead89163 100644
--- a/budget/lib/widgets/textWidgets.dart
+++ b/budget/lib/widgets/textWidgets.dart
@@ -1,11 +1,7 @@
 import 'package:budget/colors.dart';
-import 'package:budget/database/tables.dart';
-import 'package:budget/functions.dart';
-import 'package:budget/main.dart';
 import 'package:budget/struct/settings.dart';
 import 'package:flutter/material.dart';
 import 'package:auto_size_text/auto_size_text.dart';
-import 'package:provider/provider.dart';
 
 class TextFont extends StatelessWidget {
   final String text;
@@ -22,9 +18,6 @@ class TextFont extends StatelessWidget {
   final TextOverflow? overflow;
   final Widget? overflowReplacement;
   final bool? softWrap;
-  final int? walletPkForCurrency;
-  // Only show the currency icon and not the currency code afterwards
-  final bool onlyShowCurrencyIcon;
   final List<TextSpan>? richTextSpan;
   final bool selectableText;
   final Widget Function(BuildContext, EditableTextState)? contextMenuBuilder;
@@ -47,8 +40,6 @@ class TextFont extends StatelessWidget {
     this.minFontSize,
     this.overflow,
     this.softWrap,
-    this.walletPkForCurrency,
-    this.onlyShowCurrencyIcon = false,
     this.overflowReplacement,
   }) : super(key: key);
 
@@ -124,17 +115,6 @@ class TextFont extends StatelessWidget {
                       ),
       );
     }
-
-    if (walletPkForCurrency != null) {
-      String? currency = Provider.of<AllWallets>(context)
-          .indexedByPk[walletPkForCurrency]
-          ?.currency;
-      if (currency == null || currenciesJSON[currency] == null)
-        return textWidget(text);
-      return textWidget(currenciesJSON[currency]["Symbol"] +
-          text +
-          (onlyShowCurrencyIcon ? '' : ' ' + currency.toString().allCaps));
-    }
     return textWidget(text);
   }
 }
diff --git a/budget/lib/widgets/transactionEntry/transactionEntryAmount.dart b/budget/lib/widgets/transactionEntry/transactionEntryAmount.dart
index 9d6c44edf..8d30ef6e4 100644
--- a/budget/lib/widgets/transactionEntry/transactionEntryAmount.dart
+++ b/budget/lib/widgets/transactionEntry/transactionEntryAmount.dart
@@ -1,7 +1,6 @@
 import 'package:budget/database/tables.dart';
 import 'package:budget/functions.dart';
 import 'package:budget/struct/currencyFunctions.dart';
-import 'package:budget/struct/settings.dart';
 import 'package:budget/widgets/countNumber.dart';
 import 'package:budget/widgets/textWidgets.dart';
 import 'package:flutter/src/material/icons.dart';
@@ -39,7 +38,6 @@ class TransactionEntryAmount extends StatelessWidget {
             CountNumber(
               count: count,
               duration: Duration(milliseconds: 1000),
-              dynamicDecimals: true,
               initialCount: count,
               textBuilder: (number) {
                 return Row(
@@ -70,14 +68,11 @@ class TransactionEntryAmount extends StatelessWidget {
                       text: convertToMoney(
                         Provider.of<AllWallets>(context),
                         number,
-                        showCurrency: false,
                         finalNumber: count,
                       ),
                       fontSize: 19 - (showOtherCurrency ? 1 : 0),
                       fontWeight: FontWeight.bold,
                       textColor: textColor,
-                      walletPkForCurrency: appStateSettings["selectedWallet"],
-                      onlyShowCurrencyIcon: true,
                     ),
                   ],
                 );
@@ -94,17 +89,16 @@ class TransactionEntryAmount extends StatelessWidget {
                     text: convertToMoney(
                       Provider.of<AllWallets>(context),
                       transaction.amount.abs(),
-                      showCurrency: false,
                       decimals: Provider.of<AllWallets>(context)
                               .indexedByPk[transaction.walletFk]
                               ?.decimals ??
                           2,
+                      currencyKey: Provider.of<AllWallets>(context)
+                          .indexedByPk[transaction.walletFk]
+                          ?.currency,
                     ),
                     fontSize: 12,
                     textColor: textColor.withOpacity(0.6),
-                    walletPkForCurrency: transaction.walletFk,
-                    onlyShowCurrencyIcon: transaction.walletFk ==
-                        appStateSettings["selectedWallet"],
                   ),
                 )
               : SizedBox.shrink(),
diff --git a/budget/lib/widgets/transactionsAmountBox.dart b/budget/lib/widgets/transactionsAmountBox.dart
index 6c1402481..7aa2e6724 100644
--- a/budget/lib/widgets/transactionsAmountBox.dart
+++ b/budget/lib/widgets/transactionsAmountBox.dart
@@ -65,7 +65,6 @@ class TransactionsAmountBox extends StatelessWidget {
                                   ? 0
                                   : (snapshot.data ?? 0).abs(),
                           duration: Duration(milliseconds: 1000),
-                          dynamicDecimals: true,
                           initialCount: (0),
                           textBuilder: (number) {
                             return TextFont(
diff --git a/budget/lib/widgets/walletEntry.dart b/budget/lib/widgets/walletEntry.dart
index af7bd9ec3..62b002b7f 100644
--- a/budget/lib/widgets/walletEntry.dart
+++ b/budget/lib/widgets/walletEntry.dart
@@ -90,18 +90,18 @@ class WalletEntry extends StatelessWidget {
                                 lazyFirstRender: false,
                                 count: (snapshot.data ?? 0 * -1),
                                 duration: Duration(milliseconds: 1000),
-                                dynamicDecimals: true,
                                 decimals: wallet.decimals,
                                 initialCount: (snapshot.data ?? 0 * -1),
                                 textBuilder: (number) {
                                   return TextFont(
-                                    walletPkForCurrency: wallet.walletPk,
                                     textAlign: TextAlign.left,
                                     text: convertToMoney(
                                       Provider.of<AllWallets>(context),
                                       number,
-                                      showCurrency: false,
                                       finalNumber: snapshot.data ?? 0 * -1,
+                                      currencyKey: wallet.currency,
+                                      decimals: wallet.decimals,
+                                      addCurrencyName: true,
                                     ),
                                     fontSize: 17,
                                     fontWeight: FontWeight.bold,
diff --git a/budget/pubspec.yaml b/budget/pubspec.yaml
index f671287b2..43f2fe608 100644
--- a/budget/pubspec.yaml
+++ b/budget/pubspec.yaml
@@ -15,7 +15,7 @@ publish_to: "none" # Remove this line if you wish to publish to pub.dev
 # In iOS, build-name is used as CFBundleShortVersionString while build-number used as CFBundleVersion.
 # Read more about iOS versioning at
 # https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html
-version: 3.7.3+119
+version: 3.7.4+120
 
 environment:
   sdk: ">= 3.0.0"
